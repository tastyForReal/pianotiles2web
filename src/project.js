(function(){var Re=function(Pe){return typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(Pe,{get:function(Ce,ve){return(typeof require!="undefined"?require:Ce)[ve]}}):Pe}(function(Pe){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+Pe+'" is not supported')});(function(){var Pe=function(Ce){return typeof Re!="undefined"?Re:typeof Proxy!="undefined"?new Proxy(Ce,{get:function(ve,Ie){return(typeof Re!="undefined"?Re:ve)[Ie]}}):Ce}(function(Ce){if(typeof Re!="undefined")return Re.apply(this,arguments);throw Error('Dynamic require of "'+Ce+'" is not supported')});(function(){var Ce=function(ve){return typeof Pe!="undefined"?Pe:typeof Proxy!="undefined"?new Proxy(ve,{get:function(Ie,Ee){return(typeof Pe!="undefined"?Pe:Ie)[Ee]}}):ve}(function(ve){if(typeof Pe!="undefined")return Pe.apply(this,arguments);throw Error('Dynamic require of "'+ve+'" is not supported')});(function(){var ve=function(Ie){return typeof Ce!="undefined"?Ce:typeof Proxy!="undefined"?new Proxy(Ie,{get:function(Ee,l){return(typeof Ce!="undefined"?Ce:Ee)[l]}}):Ie}(function(Ie){if(typeof Ce!="undefined")return Ce.apply(this,arguments);throw Error('Dynamic require of "'+Ie+'" is not supported')});(function(){var Ie=function(Ee){return typeof ve!="undefined"?ve:typeof Proxy!="undefined"?new Proxy(Ee,{get:function(l,P){return(typeof ve!="undefined"?ve:l)[P]}}):Ee}(function(Ee){if(typeof ve!="undefined")return ve.apply(this,arguments);throw Error('Dynamic require of "'+Ee+'" is not supported')});(function(){var Ee=function(l){return typeof Ie!="undefined"?Ie:typeof Proxy!="undefined"?new Proxy(l,{get:function(P,m){return(typeof Ie!="undefined"?Ie:P)[m]}}):l}(function(l){if(typeof Ie!="undefined")return Ie.apply(this,arguments);throw Error('Dynamic require of "'+l+'" is not supported')});Ee=function l(P,m,d){function s(e,n){if(!m[e]){if(!P[e]){var t=typeof Ee=="function"&&Ee;if(!n&&t)return t(e,!0);if(r)return r(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var a=m[e]={exports:{}};P[e][0].call(a.exports,function(u){return s(P[e][1][u]||u)},a,a.exports,l,P,m,d)}return m[e].exports}for(var r=typeof Ee=="function"&&Ee,o=0;o<d.length;o++)s(d[o]);return s}({Activator:[function(l,P,m){"use strict";cc._RF.push(P,"7db411tZ3pO1LLEgguoEmSW","Activator"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../runtime/ClassType"),s=function(){function r(){}return r.createInstance=function(o){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var t,i=this._types;if(d.Type.isString(o))if(o=o,i.has(o))t=i.get(o);else{if((t=d.Type.getClassType(o))===String)throw new TypeError("Can not found the type '"+o+"'.");i.set(o,t)}else d.Type.isFunction(o)&&(t=o);return new(t.bind.apply(t,[void 0].concat(e)))},r._types=new Map,r}();m.Activator=s,cc._RF.pop()},{"../runtime/ClassType":"ClassType"}],ActivityBean:[function(l,P,m){"use strict";cc._RF.push(P,"75a70Cc0vZMCYgMQCZHmqd4","ActivityBean"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function o(){}return o.ACTIVITY_ID_SHARE_FOR_SKIN="share_for_skin",o.ACTIVITY_ID_SHARE_FOR_SONG="share_for_song",o.ACTIVITY_ID_SHARE_FOR_SKIN_PIECE="share_for_piece",o.ACTIVITY_ID_SHARE_FOR_UNLOCK_TONE="share_for_unlock_tone_",o.SHARE_FOR_SKIN_INVITE_PEOPLE_MAX_NUM=3,o.SHARE_FOR_SKIN_BE_INVITE_PEOPLE_MAX_NUM=99,o.SHARE_FOR_SONG_INVITE_PEOPLE_MAX_NUM=1,o.SHARE_FOR_SONG_BE_INVITE_PEOPLE_MAX_NUM=99,o.SHARE_FOR_SKIN_PIECE_INVITE_PEOPLE_MAX_NUM=99,o.SHARE_FOR_SKIN_PIECE_BE_INVITE_PEOPLE_MAX_NUM=99,o.SHARE_FOR_TONE_INVITE_PEOPLE_MAX_NUM=99,o.SHARE_FOR_TONE_BE_INVITE_PEOPLE_MAX_NUM=99,o}();m.ActivityConstantConfig=d;var s=function(){};m.ActivityInviteeBean=s;var r=function(){function o(){this.isConsume=!1,this.needMark=!1}return o.prototype.toString=function(){return this.hd_id+"+"+this.invitee_playerid+"+"+this.is_new_player+"+"+this.nickname+"+"+this.avatar_url+"+"+(this.isConsume?"1":"0")},o.prototype.parseFrom=function(e){if(e!=null){var n=e.split("+");if(n!=null&&n!=null&&n.length!=0)if(n.length<6)console.error("ActivityInviterBean parseFrom \u89E3\u6790\u9519\u8BEF => values`s lenght is incorrect, length should be 6 current length = "+n.length);else try{this.hd_id=n[0],this.invitee_playerid=n[1],this.is_new_player=n[2]==="true",this.nickname=n[3],this.avatar_url=n[4],this.isConsume=n[5]=="1"}catch(t){console.error("ActivityInviterBean parseFrom \u89E3\u6790\u9519\u8BEF!"),console.error(t)}else console.error("ActivityInviterBean parseFrom \u89E3\u6790\u9519\u8BEF => values is null or lenght is 0")}},o.prototype.toLogString=function(){return"hd_id:"+this.hd_id+" invitee_playerid:"+this.invitee_playerid+" is_new_player:"+this.is_new_player+" nickname:"+this.nickname+" avatar_url:"+this.avatar_url},o}();m.ActivityInviterBean=r,cc._RF.pop()},{}],ActivityInviteTipsPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"20d5c8nljRLwqk8uC6Y8iYh","ActivityInviteTipsPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BasicTouchEvent"),s=l("../../keypad/KeypadNavigator"),r=cc._decorator,o=r.ccclass,e=r.property,n=function(t){function i(){var a=t!==null&&t.apply(this,arguments)||this;return a.title=null,a.content=null,a.bottomTips=null,a.confirmButton=null,a.closeBtn=null,a.mConfirmClickCallback=null,a.mCloseClickCallback=null,a.mResolve=null,a.mCloseCallback=null,a}return __extends(i,t),i.prototype.onLoad=function(){var a=this;this.node.on(cc.Node.EventType.TOUCH_START,function(u){u.stopPropagation()}),this.confirmButton&&(this.mConfirmClickCallback=new d.default(function(){a.onTapConfirm()}),this.confirmButton.node.on(cc.Node.EventType.TOUCH_END,this.mConfirmClickCallback.click,this.mConfirmClickCallback)),this.closeBtn&&(this.mCloseClickCallback=new d.default(function(){a.onTapClose(),s.default.getInstance().popDialog(a.node,"InviteTipsPrefab")}),this.closeBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback)),s.default.getInstance().pushDialog(this.node,"InviteTipsPrefab")},i.prototype.onTapClose=function(){this.mCloseCallback&&this.mCloseCallback()},i.prototype.onTapConfirm=function(){this.mResolve&&this.mResolve()},i.prototype.setTitle=function(a){this.title&&(this.title.string=a)},i.prototype.setContent=function(a){this.content&&(this.content.string=a)},i.prototype.setCloseActive=function(a){this.closeBtn&&(this.closeBtn.node.active=a)},i.prototype.setBottomTips=function(a){this.bottomTips&&(this.bottomTips.string=a)},i.prototype.setConfirmCallback=function(a){this.mResolve=a},i.prototype.setCloseCallback=function(a){this.mCloseCallback=a},__decorate([e(cc.Label)],i.prototype,"title",void 0),__decorate([e(cc.Label)],i.prototype,"content",void 0),__decorate([e(cc.Label)],i.prototype,"bottomTips",void 0),__decorate([e(cc.Button)],i.prototype,"confirmButton",void 0),__decorate([e(cc.Button)],i.prototype,"closeBtn",void 0),i=__decorate([o],i)}(cc.Component);m.default=n,cc._RF.pop()},{"../../keypad/KeypadNavigator":"KeypadNavigator","./BasicTouchEvent":"BasicTouchEvent"}],ActivityLooper:[function(l,P,m){"use strict";cc._RF.push(P,"df9b6/89pZGcZx6PAPZYg2I","ActivityLooper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Looper"),s=function(){function r(){var o=this;this.mLooper=null,this.mLooper=new d.default,this.func=function(){o.mCallback&&o.mCallback()},this.mLooper.setWork(this.func)}return r.prototype.start=function(o){this.mCallback=o,this.mLooper&&this.mLooper.start()},r.prototype.stop=function(){this.mLooper&&this.mLooper.stop()},r.prototype.release=function(){this.mLooper&&(this.mLooper.stop(),this.mLooper.destroy(),this.mLooper=null)},r}();m.default=s,cc._RF.pop()},{"./Looper":"Looper"}],ActivityManager:[function(l,P,m){"use strict";cc._RF.push(P,"15eebAGnptD3oT/3FW4fa9F","ActivityManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./LevelMgr"),s=l("../Core/GameDefine"),r=l("./Level"),o=l("../DB/CSV/LevelConsumeData"),e=l("../DB/DBMgr"),n=function(){function t(){this.mShowLevelList=[],this.mChoicenessList=[],this.mAllLevelList=[],this.mChoicenseeLevelList=null,this.mChoicenseeMidList=null,this.setMusicLevelMap()}return t.getInstance=function(){return t.mInstance||(t.mInstance=new t),t.mInstance},t.prototype.clearChoicenseeTempData=function(){this.mChoicenseeLevelList==null?this.mChoicenseeLevelList=[]:this.mChoicenseeLevelList.splice(0,this.mChoicenseeLevelList.length),this.mChoicenseeMidList==null?this.mChoicenseeMidList=[]:this.mChoicenseeMidList.splice(0,this.mChoicenseeMidList.length)},t.prototype.setMusicLevelMap=function(){console.log("[ActivityActivity] setMusicLevelMap"),this.mShowLevelList=[];var i=d.LevelMgr.Ins().getShowLevels();this.clearChoicenseeTempData();for(var a=0;a<i.length;++a){var u=i[a];if(u<s.Constant.DIAMONDSONG_STARTID&&u!=s.Constant.TRIAL_SONG_ID&&(this.mShowLevelList.push(u),this.mAllLevelList.push(u)),u>s.Constant.CHOICENESS_STARTID){var c=d.LevelMgr.Ins().getLevel(u);if(c&&c.type==r.eLevelKind.eLevel_Choiceness){var p=d.LevelMgr.Ins().getLevel(u);p&&p.music&&(this.mChoicenseeLevelList.push(u),this.mChoicenseeMidList.push(p.music.mid))}}}this.sortChoicenessList(),this.mAllLevelList=this.mAllLevelList.concat(this.mChoicenessList)},t.prototype.sortChoicenessList=function(){this.mChoicenessList.splice(0,this.mChoicenessList.length);var i=e.default.Ins().getDBRows(e.eDataBase.eDB_LevelConsume);if(i)for(var a=0;a<i.length;a++){var u=i[a];if(u&&u instanceof o.LevelConsumeRow){var c=u;if(c){var p=this.getIndexFromMidList(c.getMid());0<=p&&this.mChoicenessList.push(this.mChoicenseeLevelList[p])}}}this.mChoicenseeLevelList=null,this.mChoicenseeMidList=null},t.prototype.getIndexFromMidList=function(i){for(var a=0;a<this.mChoicenseeMidList.length;a++)if(this.mChoicenseeMidList[a]==i)return a;return-1},t.prototype.getAllLevels=function(){return this.mAllLevelList},t.prototype.getShowLevels=function(){return this.mShowLevelList},t.prototype.getChoicenessLevels=function(){return this.mChoicenessList},t}();m.default=n,cc._RF.pop()},{"../Core/GameDefine":"GameDefine","../DB/CSV/LevelConsumeData":"LevelConsumeData","../DB/DBMgr":"DBMgr","./Level":"Level","./LevelMgr":"LevelMgr"}],ActivityRewardManager:[function(l,P,m){"use strict";cc._RF.push(P,"5271bFT5YhIEpUdCgNTT9u3","ActivityRewardManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Network/Protocol/StorageUtil"),s=l("../../config/LSKey"),r=l("../../util/StringUtil"),o=l("./ActivityBean"),e=l("./ActivityRewardRequest"),n=l("../../util/Dictionary"),t=l("../../base/Log"),i=function(){function u(){this.mActivityRewardBeanDic=new n.Dictionary,this.initFromCache()}return u.Ins=function(){return this.sInstance==null&&(this.sInstance=new u),this.sInstance},u.prototype.initFromCache=function(){var c=this,p=d.default.read(s.default.ACTIVITY_INVITE_BEAN_DIC);if(p){var h=p.split(u.ACTIVITY_SEPERATE_STR);h&&(h.forEach(function(f){var g=f.split(u.SEPERATE_STR),_=g.pop(),y=[];g.forEach(function(S){var I=new o.ActivityInviterBean;I.parseFrom(S),y.push(I)}),c.mActivityRewardBeanDic.put(_,y)}),console.log("[ActivityRewardManager] \u7F13\u5B58\u8BFB\u53D6\u51FA\u6765\u9080\u8BF7\u8FC7\u7684\u6570\u636E hd_id = ",this.mActivityRewardBeanDic))}},u.prototype.getCacheInviteRewardList=function(c){return this.mActivityRewardBeanDic.get(c)},u.prototype.getCacheInviteRewardListSize=function(c){var p=this.mActivityRewardBeanDic.get(c);return p&&0<p.length?p.length:0},u.prototype.getInviteSuccessListComplete=function(c,p){var h=this;p&&(console.log("[ActivityRewardManager] \u4ECE\u670D\u52A1\u5668\u83B7\u53D6\u5168\u91CF\u9080\u8BF7\u6210\u529F\u5217\u8868,"+c),e.ActivityRewardRequester.queryActivity(c,function(f,g){f?(h.mergeWithCache(c,g),h.updateInviteDateFileCache(),p(g)):(console.error("[ActivityRewardManager] \u67E5\u8BE2\u6D3B\u52A8\u9080\u8BF7\u5168\u91CF\u5217\u8868 \u7F51\u7EDC\u8BF7\u6C42\u9519\u8BEF\u4E86,"+c),p(null))}))},u.prototype.getInviteList=function(c,p){p&&e.ActivityRewardRequester.queryActivityCM(c,function(h,f){h?(t.default.i("CMPlayShare: ActivityRewardManager===> getInviteList\u4ECE\u670D\u52A1\u5668\u83B7\u53D6\u5168\u91CF\u9080\u8BF7\u6210\u529F\u5217\u8868,"+c),p(f)):(t.default.e("CMPlayShare: ActivityRewardManager===> getInviteList \u67E5\u8BE2\u6D3B\u52A8\u9080\u8BF7\u5168\u91CF\u5217\u8868 \u7F51\u7EDC\u8BF7\u6C42\u9519\u8BEF\u4E86,"+c),p(null))})},u.prototype.mergeWithCache=function(c,p){if(p){for(var h=this.mActivityRewardBeanDic.get(c),f=0;f<p.length;f++){var g=p[f];g&&(g.isConsume=this.isConsume(h,g))}this.mActivityRewardBeanDic.put(c,p)}},u.prototype.isConsume=function(c,p){for(var h=!1,f=0;f<c.length;f++)if(p.invitee_playerid==c[f].invitee_playerid){c[f].isConsume==1&&(h=!0);break}return h},u.prototype.cosumeInviteRewardInfo=function(c){for(var p=[],h=1;h<arguments.length;h++)p[h-1]=arguments[h];if(!r.StringUtil.isEmpty(c)&&(console.log("[ActivityRewardManager] cosumeInviteRewardInfo: "+c,p),p!=null&&p!=null&&0<p.length)){var f=this.mActivityRewardBeanDic.get(c),g=!1;f.forEach(function(_){for(var y=0;y<p.length;y++){var S=p[y];if(S&&S instanceof o.ActivityInviterBean){var I=S;if(I&&I.invitee_playerid==_.invitee_playerid&&I.isConsume!=1){g=!0,I.isConsume=!0;break}}}}),g&&this.updateInviteDateFileCache(),console.log("[ActivityRewardManager] cosumeInviteRewardInfo isChanged= "+g)}},u.prototype.getBatchInviteSuccessListComplete=function(c,p){var h=this;p&&(console.log("[ActivityRewardManager] \u4ECE\u670D\u52A1\u5668\u83B7\u53D6\u591A\u4E2A\u6D3B\u52A8\u5168\u91CF\u9080\u8BF7\u6210\u529F\u5217\u8868",c),e.ActivityRewardRequester.queryActivities(c,function(f,g){f?(g.getPairs().forEach(function(_){h.mergeWithCache(_.key,_.value)}),h.updateInviteDateFileCache(),p(g)):(console.error("[ActivityRewardManager] \u67E5\u8BE2\u6D3B\u52A8\u9080\u8BF7\u5168\u91CF\u5217\u8868 \u7F51\u7EDC\u8BF7\u6C42\u9519\u8BEF\u4E86"),p(null))}))},u.prototype.updateInviteDateFileCache=function(){for(var c="",p=this.mActivityRewardBeanDic.size(),h=0;h<p;h++){for(var f=this.mActivityRewardBeanDic.getPairs()[h],g=f.key,_=f.value,y=0;y<_.length;y++)c+=_[y].toString()+u.SEPERATE_STR;c+=g,h!=p-1&&(c+=u.ACTIVITY_SEPERATE_STR)}d.default.save(s.default.ACTIVITY_INVITE_BEAN_DIC,c)},u.prototype.acceptInvite=function(c,p,h){var f=this;h&&(t.default.i("[ActivityRewardManager] \u88AB\u9080\u8BF7\u8005\u70B9\u51FB\u5206\u4EAB\u7684\u5361\u7247\u63A5\u53D7\u9080\u8BF7",c,p),e.ActivityRewardRequester.reportActivity(c,p,function(g,_){g?(f.mActivityRewardBeanDic.put(c,_),h(g,_)):h(!1,null)},a.getHdInviteNum(c),a.getHdBeInviteNum(c)))},u.SEPERATE_STR="&#&",u.ACTIVITY_SEPERATE_STR="$*$",u.sInstance=null,u}();m.ActivityRewardMgr=i;var a=function(){function u(){}return u.getHdInviteNum=function(c){var p=0;return c==o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN?p=o.ActivityConstantConfig.SHARE_FOR_SKIN_INVITE_PEOPLE_MAX_NUM:!r.StringUtil.isEmpty(c)&&c.startsWith(o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG)?p=o.ActivityConstantConfig.SHARE_FOR_SONG_INVITE_PEOPLE_MAX_NUM:!r.StringUtil.isEmpty(c)&&c.startsWith(o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN_PIECE)?p=o.ActivityConstantConfig.SHARE_FOR_SKIN_PIECE_INVITE_PEOPLE_MAX_NUM:!r.StringUtil.isEmpty(c)&&c.startsWith(o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_UNLOCK_TONE)&&(p=o.ActivityConstantConfig.SHARE_FOR_TONE_INVITE_PEOPLE_MAX_NUM),p},u.getHdBeInviteNum=function(c){var p=0;return c==o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN?p=o.ActivityConstantConfig.SHARE_FOR_SKIN_BE_INVITE_PEOPLE_MAX_NUM:!r.StringUtil.isEmpty(c)&&c.startsWith(o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG)?p=o.ActivityConstantConfig.SHARE_FOR_SONG_BE_INVITE_PEOPLE_MAX_NUM:!r.StringUtil.isEmpty(c)&&c.startsWith(o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN_PIECE)?p=o.ActivityConstantConfig.SHARE_FOR_SKIN_PIECE_BE_INVITE_PEOPLE_MAX_NUM:!r.StringUtil.isEmpty(c)&&c.startsWith(o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_UNLOCK_TONE)&&(p=o.ActivityConstantConfig.SHARE_FOR_TONE_BE_INVITE_PEOPLE_MAX_NUM),p},u}();m.ActivityBeanMgr=a,cc._RF.pop()},{"../../base/Log":"Log","../../config/LSKey":"LSKey","../../util/Dictionary":"Dictionary","../../util/StringUtil":"StringUtil","../Network/Protocol/StorageUtil":"StorageUtil","./ActivityBean":"ActivityBean","./ActivityRewardRequest":"ActivityRewardRequest"}],ActivityRewardRequest:[function(l,P,m){"use strict";cc._RF.push(P,"220f8BO/+tFuIpyNlMBPgfR","ActivityRewardRequest"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/Log"),s=l("./ActivityBean"),r=l("../../util/Dictionary"),o=l("../../../modules/MGUtils/NetworkUtils"),e=l("../../../modules/MGUtils/TypeDefinition"),n=function(){function t(){}return t.reportActivity=function(i,a,u,c,p){d.default.i("[cmg] reportShareHdReport=> hd_id "+i+" inviter_playerid "+a),cmg.platform.reportShareHdReport(i,a,c,p,function(h,f,g,_,y,S){if(d.default.i("[cmg] reportShareHdReport result=> hd_id "+i+" inviter_playerid "+a+" result "+h+" isValid "+f+" msg "+g+" count "+_+" inviter_nickname "+y+" inviter_avatar_url "+S),h){var I=new s.ActivityInviteeBean;I.valid=f,I.count=_,I.hd_id=i,I.inviter_avatar_url=S,I.inviter_nickname=y,u(h,I)}else u(h,null)})},t.queryActivity=function(i,a){d.default.i("[cmg] shareHdQuery=> hd_id "+i),cmg.platform.shareHdQuery(i,function(u,c){var p=new Array;if(u)for(var h=0;h<c.length;h++){var f=new s.ActivityInviterBean;f.hd_id=i,f.avatar_url=c[h].avatar_url,f.invitee_playerid=c[h].invitee_playerid,f.is_new_player=c[h].is_new_player,f.nickname=c[h].nickname,p.push(f)}d.default.i("[cmg] shareHdQuery=> hd_id result: "+i,p),a(u,p)})},t.queryActivityCM=function(i,a){var u={},c=window.getUserUid(),p=d.default.isDebug()?this.URL_FUNNYGAME_LISTINFO_DEBUG:this.URL_FUNNYGAME_LISTINFO_RELEASE;u.common={uid:c},u.scene_ids=i,u.share_uid=c;var h={platform:e.PlatformType.PLATFORM_CMPLAY,url:p,method:"POST",data:u,dataType:"json",success:function(f){var g=new r.Dictionary;if(f&&f.assistance_info_list)for(var _=f.assistance_info_list,y=0;y<i.length;y++){var S=i[y];if(_[S]&&_[S].assistance_info){for(var I=_[S].assistance_info,v=[],C=0;C<I.length;C++){var T=new s.ActivityInviterBean;try{T.hd_id=S,T.avatar_url=I[C].avatar_url,T.invitee_playerid=I[C].uid,T.is_new_player=I[C].is_new_user,T.nickname=I[C].nickname,v.push(T)}catch(E){d.default.w("CMPlayShare: ActivityRewardRequest parse assistance_info",E)}}g.put(S,v)}}a(!0,g)},fail:function(f,g){d.default.w("CMPlayShare: ActivityRewardRequest===>query activityCM failed. code:"+f),a(!1,null)}};o.default.request(h)},t.queryActivities=function(i,a){d.default.i("[cmg] shareQueryBatch=> hd_id ",i),i==null||i==null||i.length==0?a(!1,new r.Dictionary):cmg.platform.shareQueryBatch(i,function(u,c){d.default.i("[cmg] shareQueryBatch=> hd_ids "+i+",result ="+u+",data=",c);var p=new r.Dictionary;if(u&&c)for(var h=0;h<i.length;h++){var f=i[h],g=c[f];if(g){for(var _=[],y=0;y<g.length;y++){var S=new s.ActivityInviterBean;S.hd_id=f,S.avatar_url=g[y].avatar_url,S.invitee_playerid=g[y].invitee_playerid,S.is_new_player=g[y].is_new_player,S.nickname=g[y].nickname,_.push(S)}p.put(f,_)}}console.info("[cmg] shareQueryBatch=> hd_id result ",p),a(u,p)})},t.URL_FUNNYGAME_LISTINFO_DEBUG="http://funnygame.cmzhtest2.hellocwd.com/funny/assistance/info_list",t.URL_FUNNYGAME_LISTINFO_FAKE="http://apix.kisops.com/mock/349/funny/assistance/info_list",t.URL_FUNNYGAME_LISTINFO_RELEASE="https://funnygame.cmcm.com/funny/assistance/info_list",t}();m.ActivityRewardRequester=n,cc._RF.pop()},{"../../../modules/MGUtils/NetworkUtils":"NetworkUtils","../../../modules/MGUtils/TypeDefinition":"TypeDefinition","../../base/Log":"Log","../../util/Dictionary":"Dictionary","./ActivityBean":"ActivityBean"}],AddShortcutPrefb:[function(l,P,m){"use strict";cc._RF.push(P,"ff6f6InsxFEY5W3ZrwR226p","AddShortcutPrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.mCloseBtn=null,i.mAddBtn=null,i}return __extends(t,n),t.prototype.onLoad=function(){var i=this;this.node.on(cc.Node.EventType.TOUCH_START,function(c){c.stopPropagation()});var a=new d.default(function(){i.mCloseCallBack()});this.mCloseBtn.node.on(cc.Node.EventType.TOUCH_END,a.click,a);var u=new d.default(function(){i.mAddCallBack()});this.mAddBtn.node.on(cc.Node.EventType.TOUCH_END,u.click,u)},t.prototype.start=function(){},t.prototype.setCallBack=function(i,a){this.mCloseCallBack=i,this.mAddCallBack=a},__decorate([o(cc.Button)],t.prototype,"mCloseBtn",void 0),__decorate([o(cc.Button)],t.prototype,"mAddBtn",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"./BasicTouchEvent":"BasicTouchEvent"}],AdditionData:[function(l,P,m){"use strict";cc._RF.push(P,"2eb0eqKamJD84cx5NzWGf2U","AdditionData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("Id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.AdditionData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("Id")},e.prototype.getItemId=function(){return this.getString("itemId")},e.prototype.getSceneId=function(){return this.getString("sceneId")},e.prototype.getEffectId=function(){return this.getString("effectId")},e.prototype.getDesc=function(){return this.getString("desc")},e}(d.default);m.AdditionRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],AdvGetPropertyDialog:[function(l,P,m){"use strict";cc._RF.push(P,"6734aWWGU9COKeHVMcfTAkU","AdvGetPropertyDialog"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../property/PropertyDefines"),s=l("../GameEntraScene/ImgCache"),r=l("../GameEntraScene/BasicTouchEvent"),o=l("../../Logic/I18nManager"),e=l("../../keypad/KeypadNavigator"),n=cc._decorator,t=n.ccclass,i=n.property,a=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.mContentLabel=null,p.mPropertyIcon=null,p.mPropertyCountLabel=null,p.mOKBtn=null,p.mContentTxt="",p.mSpriteIconPath="",p.mOKCallback=null,p.mCloseCallback=null,p}return __extends(c,u),c.prototype.onLoad=function(){this.initViews(),this.initEvents(),e.default.getInstance().pushDialog(this.node,"AdvGetPropertyDialog")},c.prototype.initViews=function(){this.mContentLabel.string=this.mContentTxt,s.default.get2(this.mSpriteIconPath,this.mPropertyIcon)},c.prototype.initEvents=function(){var p=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){},this),this.mOKCallback=new r.default(function(){p.mCloseCallback&&p.mCloseCallback(),p.node.destroy(),e.default.getInstance().popDialog(p.node,"AdvGetPropertyDialog")}),this.mOKBtn.node.on(cc.Node.EventType.TOUCH_END,this.mOKCallback.click,this.mOKCallback)},c.prototype.setCloseCallback=function(p){this.mCloseCallback=p},c.prototype.setProp=function(p){if(p){var h="The falling speed of the piano block is reduced by 50% within 15 seconds after resurrection.",f="Beginning sprint 12 seconds",g="Cancellation of a mistake and no enemy for 8 seconds";switch(o.default.getInstance().isEnglish()&&(g=f=h=""),p.type){case d.PROPERTYTYPE.GAME_SLOW:this.mContentTxt=h,this.mSpriteIconPath="/static_res/property/slow";break;case d.PROPERTYTYPE.GAME_DASH:this.mContentTxt=f,this.mSpriteIconPath="/static_res/property/dash";break;case d.PROPERTYTYPE.GAME_SHIELD:this.mContentTxt=g,this.mSpriteIconPath="/static_res/property/shield"}}},__decorate([i(cc.Label)],c.prototype,"mContentLabel",void 0),__decorate([i(cc.Sprite)],c.prototype,"mPropertyIcon",void 0),__decorate([i(cc.Label)],c.prototype,"mPropertyCountLabel",void 0),__decorate([i(cc.Button)],c.prototype,"mOKBtn",void 0),c=__decorate([t],c)}(cc.Component);m.default=a,cc._RF.pop()},{"../../../property/PropertyDefines":"PropertyDefines","../../Logic/I18nManager":"I18nManager","../../keypad/KeypadNavigator":"KeypadNavigator","../GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../GameEntraScene/ImgCache":"ImgCache"}],AdvHelperCMplay:[function(l,P,m){"use strict";cc._RF.push(P,"69b44TcMY5JgJ0LdwBFr4Or","AdvHelperCMplay"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MgAdvHelper"),s=l("../Logic/MGAdvDefine"),r=l("../../../../scripts/business/UI/GameEntraScene/ToastMgr"),o=l("../../../../scripts/business/keypad/KeypadNavigator"),e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.mIsDebugMode=!0,i.showPokiBanner=!1,i}return __extends(t,n),t.prototype.isOverPageBannerShowed=function(){return!1},t.prototype.showBanner=function(i,a,u,c){CMPlay.showBanner(),i&&i(s.ADStat.SHOWING_PAGE)},t.prototype.isBannerCached=function(){return!0},t.prototype.loadBanner=function(i,a,u,c,p,h){c&&c(s.ADStat.LOAD_SUCCESS)},t.prototype.hideBanner=function(){CMPlay.hideBanner()},t.prototype.destoryBanner=function(){CMPlay.hideBanner()},t.prototype.isNetWorkConnected=function(){return!0},t.prototype.init=function(){this.mIsDebugMode=CMPlay.getQueryString("_cm_debug_","false")=="true"},t.prototype.load=function(i,a){a&&a(s.ADStat.LOAD_SUCCESS)},t.prototype.destroy=function(){},t.prototype.isEnable=function(){return console.log("lll isEnable=true"),!0},t.prototype.isADCached=function(i){return!0},t.prototype.show=function(i,a,u){var c=this;this.lock(),this.mIsDebugMode?r.ToastMgr.showToast("[\u6D4B\u8BD5] \u8FD9\u662FRewardVideo\u5E7F\u544A",function(){a&&a(s.ADStat.SHOW_SUCCESS_CLOSE),c.unlock()},!0):CMPlay.startRewardVideo(function(p){a&&a(p?s.ADStat.SHOW_SUCCESS_CLOSE:s.ADStat.SHOW_NOT_ENED_CLOSE,"",0),c.unlock()})},t.prototype.commercialBreak=function(i,a,u){var c=this;return this.lock(),this.mIsDebugMode?r.ToastMgr.showToast("[\u6D4B\u8BD5] \u8FD9\u662FCommercialBreak\u5E7F\u544A",function(){a&&a(s.ADStat.SHOW_SUCCESS_CLOSE),c.unlock()},!0):window.PokiSDK?window.PokiSDK.commercialBreak().then(function(){a&&a(s.ADStat.SHOW_SUCCESS_CLOSE),c.unlock()}):this.unlock(),!0},t.prototype.lock=function(){o.default.getInstance().setEnable(!1),t.mIsRewardVideoPlayed=!0},t.prototype.unlock=function(){setTimeout(function(){o.default.getInstance().setEnable(!0),t.mIsRewardVideoPlayed=!1},800)},t.prototype.gameplayStart=function(){this.mIsDebugMode?r.ToastMgr.showToast("[\u5185\u90E8\u6D4B\u8BD5] \u63D0\u4EA4\u6570\u636E \u4E0A\u62A5gameplayStart"):window.PokiSDK?(window.PokiSDK.gameplayStart(),console.warn("PokiSDK----------------gameplayStart------------------")):r.ToastMgr.showToast("Load Poki failed")},t.prototype.gameplayStop=function(){this.mIsDebugMode?r.ToastMgr.showToast("[\u5185\u90E8\u6D4B\u8BD5] \u63D0\u4EA4\u6570\u636E \u4E0A\u62A5gameplayStop"):window.PokiSDK?(window.PokiSDK.gameplayStop(),console.warn("PokiSDK----------------gameplayStop------------------")):r.ToastMgr.showToast("Load Poki failed")},t.prototype.roundStart=function(i){this.mIsDebugMode?r.ToastMgr.showToast("[\u5185\u90E8\u6D4B\u8BD5] \u63D0\u4EA4\u6570\u636E \u4E0A\u62A5roundStart"):window.PokiSDK?(console.warn("PokiSDK----------------roundStart------------------:level_"+i),window.PokiSDK.roundStart("Level_"+i)):r.ToastMgr.showToast("Load Poki failed")},t.prototype.roundEnd=function(i){this.mIsDebugMode?r.ToastMgr.showToast("[\u5185\u90E8\u6D4B\u8BD5] \u63D0\u4EA4\u6570\u636E \u4E0A\u62A5roundEnd"):window.PokiSDK?(console.warn("PokiSDK----------------roundEnd------------------:level_"+i),window.PokiSDK.roundEnd("Level_"+i)):r.ToastMgr.showToast("Load Poki failed")},t.prototype.customEvent=function(i,a,u){this.mIsDebugMode?r.ToastMgr.showToast("[\u5185\u90E8\u6D4B\u8BD5] \u63D0\u4EA4\u6570\u636E \u4E0A\u62A5\u73A9\u5BB6\u89E3\u9501\u76AE\u80A4\u65F6\uFF0C\u4E0A\u62A5customEvent"):window.PokiSDK?(window.PokiSDK.customEvent(i,a,u),console.warn("PokiSDK---------------customEvent------------------:"+i+" "+a+" "+u)):r.ToastMgr.showToast("Load Poki failed")},t.prototype.creatAdContainer=function(i){var a=document.createElement(i);return a.id=i,a.style.width="320",a.style.height="50",a.style.width="320",a.style.zIndex="0",a.style.position="absolute",a.style.backgroundColor="#990000",document.getElementById("div").insertBefore(a,null),a},t.prototype.displayAD=function(i){i===void 0&&(i=!0);var a=document.getElementById("adContainer");this.showPokiBanner!=i&&(this.showPokiBanner=i,a!=null?(!i&&a&&(a.style.zIndex="0"),this.mIsDebugMode?(r.ToastMgr.showToast("[\u5185\u90E8\u6D4B\u8BD5] \u8FD9\u662F\u5546\u4E1A\u5E7F\u544Abanner"),console.warn("PokiSDK----------------displayAD------------------"+a)):window.PokiSDK?i&&(console.warn("PokiSDK----------------displayAD------------------"+a),a.style.zIndex="100",a.style.left=.5*(window.innerWidth-320)+"px",window.PokiSDK.displayAd(a,"320x50")):r.ToastMgr.showToast("Load Poki failed")):console.error("PokiSDK----------------need new div (adContainer) with displayAD------------------"+i))},t.mIsRewardVideoPlayed=!1,t}(d.default);m.default=e,cc._RF.pop()},{"../../../../scripts/business/UI/GameEntraScene/ToastMgr":"ToastMgr","../../../../scripts/business/keypad/KeypadNavigator":"KeypadNavigator","../Logic/MGAdvDefine":"MGAdvDefine","../Logic/MgAdvHelper":"MGAdvHelper"}],AdvHelperWeb:[function(l,P,m){"use strict";cc._RF.push(P,"b9975OgrYJBYLtK4nlVVhQ8","AdvHelperWeb"),cc._RF.pop()},{}],AnimationBackground:[function(l,P,m){"use strict";cc._RF.push(P,"2261b6PJ6hLKoxosxM8Z2Te","AnimationBackground"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/G"),s=l("../gamescene/MUI/MUIBoard"),r=l("../gamescene/animation/MAnimationMgr"),o=l("./Background"),e=l("../gamescene/MUI/MUIDefines"),n=function(t){function i(){var a=t.call(this)||this;return a.androidRenderLimit=0,a.uiBoard=new s.default,a.animationMgr=new r.default,a.sprite=null,a.spriteCanvas=null,a.spriteContext=null,a.spriteTexture=null,a.uiBoard.initilize(e.MUI.global.ctx),a}return __extends(i,t),i.prototype.attachSprite=function(a,u){this.androidRenderLimit=10,a.active=!1,u.active=!0,this.sprite=u.getComponent(cc.Sprite),this.spriteTexture||this.createRenderTarget(),this.sprite.spriteFrame=new cc.SpriteFrame(this.spriteTexture);var c=e.MUI.global.rttViewPort;this.sprite.type=cc.Sprite.Type.TILED,this.sprite.spriteFrame.setRect(new cc.Rect(c[0],c[1],c[2],c[3])),this.sprite.node.setContentSize(c[2],c[3]),this.sprite.node.setScale((d.G.Ap.config.presentWidth+1)/c[2],-(d.G.Ap.config.presentHeight+1)/c[3]),e.MUI.global.renderType===e.MUI.RenderType.CANVAS?this.sprite.node.scaleY=(d.G.Ap.config.presentHeight+1)/c[3]:this.sprite.node.scaleY=-(d.G.Ap.config.presentHeight+1)/c[3];var p=e.MUI.global.ctx;this.sprite.srcBlendFactor=p.ONE,this.sprite.dstBlendFactor=p.ONE_MINUS_SRC_ALPHA},i.prototype.load=function(a){if(this.animationMgr.stopAllActions(),this.animationMgr.update(0),this.uiBoard.getRootNode().removeAllChildren(),this.uiBoard.getRootNode().setScale(d.G.Ap.config.presentScale),this.uiBoard.getRootNode().addChild(a.node),a.actions)for(var u=0,c=a.actions.length;u<c;++u)this.animationMgr.runActionRepeat(a.node,a.actions[u]);return!0},i.prototype.update=function(a){this.animationMgr.update(a),cc.sys.os===cc.sys.OS_ANDROID&&e.MUI.global.renderType===e.MUI.RenderType.CANVAS?6<=this.androidRenderLimit?(this.androidRenderLimit=0,this.render()):this.androidRenderLimit++:this.render()},i.prototype.render=function(){if(e.MUI.global.renderType===e.MUI.RenderType.CANVAS)this.uiBoard.renderToTexture(this.spriteContext,null),this.spriteTexture.handleLoadedTexture();else if(this.spriteTexture){var a=this.spriteTexture._glID;this.uiBoard.renderToTexture(e.MUI.global.ctx,a)}},i.prototype.createRenderTarget=function(){if(e.MUI.global.renderType===e.MUI.RenderType.CANVAS)this.sprite.node.scaleY=1,this.spriteCanvas=document.createElement("canvas"),this.spriteCanvas.width=cc.game.canvas.width,this.spriteCanvas.height=cc.game.canvas.height,this.spriteContext=this.spriteCanvas.getContext("2d"),this.spriteTexture=new cc.Texture2D,this.spriteTexture.releaseTexture(),this.spriteTexture.initWithElement(this.spriteCanvas),this.spriteTexture.handleLoadedTexture();else{this.spriteTexture=new cc.Texture2D,this.sprite.node.scaleY=-1;for(var a=new cc.Size(e.MUI.global.rttWidth,e.MUI.global.rttHeight),u=a.width*a.height*4,c=new Uint8Array(u),p=0;p<u;p++)c[p]=0;this.spriteTexture.initWithData(c,cc.Texture2D.PixelFormat.RGBA8888,a.width,a.height,null)}},i.prototype.destroy=function(){this.uiBoard.uninitilize(e.MUI.global.ctx)},i}(o.default);m.default=n,cc._RF.pop()},{"../base/G":"G","../gamescene/MUI/MUIBoard":"MUIBoard","../gamescene/MUI/MUIDefines":"MUIDefines","../gamescene/animation/MAnimationMgr":"MAnimationMgr","./Background":"Background"}],AnimationWork:[function(l,P,m){"use strict";cc._RF.push(P,"55016Zroy1CEY6+8xbHqG4d","AnimationWork"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this._data=null,this._duration=0,this._name=0,this._paths=null,this._rootProps=null,this._execTime=0,this._value=0,this._run=!1,this._allValues={}}return s.prototype.load=function(r){if(this._data=r,this._name=r._name,this._duration=r._duration,r.curveData.paths)for(var o in this._paths=r.curveData.paths,this._paths)this._allValues[o]={};r.curveData.props&&(this._rootProps=r.curveData.props,this._allValues.root={})},s.prototype.start=function(){this._execTime=0,this._run=!0},s.prototype.pause=function(){this._run=!1},s.prototype.resume=function(){this._run=!0},s.prototype.stop=function(){this._execTime=0,this._run=!1},s.prototype.update=function(r){this._run&&this._execTime<this._duration&&(this._execTime+=r,this.sample())},s.prototype.sample=function(){if(this._paths)for(var r in this._paths){var o=this._paths[r].props;for(var e in o)this.sampleValue(r,o,e)}if(this._rootProps)for(var e in this._rootProps)this.sampleValue("root",this._rootProps,e)},s.prototype.sampleValue=function(r,o,e){for(var n=o[e],t=n.length,i=-1,a=-1,u=null,c=this._execTime,p=0,h=0;h<t;h++){var f=n[h];if(this._execTime<=f.frame){i=(a=h)-1;break}}if(a===-1?(i=a=t-1,c=n[a].frame,p=0):a===0?(c=n[i=a].frame,p=0):p=(c-n[i].frame)/(n[a].frame-n[i].frame),e==="scale"){var g={x:0,y:0};g.x=p*(n[a].value.x-n[i].value.x)+n[i].value.x,g.y=p*(n[a].value.y-n[i].value.y)+n[i].value.y,u=g}else if(e==="position"){var _={x:0,y:0};_.x=p*(n[a].value[0]-n[i].value[0])+n[i].value[0],_.y=p*(n[a].value[1]-n[i].value[1])+n[i].value[1],u=_}else u=p*(n[a].value-n[i].value)+n[i].value;this._allValues[r][e]=u},s.prototype.getValue=function(r,o){return this._allValues[r][o]},s.prototype.getAllValues=function(){return this._allValues},s.prototype.dbgPrint=function(r,o){var e=this.getValue(r,o);console.log(r,o,e)},s.prototype.dbgPrintAll=function(){for(var r in console.log(this._execTime),this._allValues)for(var o in this._allValues[r])this.dbgPrint(r,o)},s}();m.default=d,cc._RF.pop()},{}],AntiCheatProbe:[function(l,P,m){"use strict";cc._RF.push(P,"ccc6d8mHsxGpoS8PhKIeIpQ","AntiCheatProbe"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("./OperatingCount"),o=l("../base/Log"),e=l("../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),n=l("../business/keypad/KeypadUtil");(s=d=m.STATUS||(m.STATUS={}))[s.Begin=0]="Begin",s[s.End=1]="End",s[s.Fail=2]="Fail";var t=function(){function i(){this.speedThreshold=8,this.probability=0,this.operatingCount=new r.default,this.hit=!1,this.skipReset=!1,this.postCb=null}return i.prototype.initilize=function(){var a=this;cc.sys.isBrowser||e.MGBasic.networkRequest({url:"https://gamecdn.cmcm.com/cn/piano_tiles2/wx/config/acprobe2.json",data:"",header:{},method:"GET",dataType:"json",checkAuthorization:!1,complete:function(u,c){console.log("k initilize result = "+u),c&&a.applyConfig(c)}})},i.prototype.begin=function(){this.reset(),this.probability===0?this.hit=!1:this.hit=Math.random()<=this.probability,this.setStatus(d.Begin)},i.prototype.end=function(){var a=this;console.log("k end");var u=this.getSkipReset();this.isHit()&&this.setPostCb(function(c,p){!c&&a.setStatus(d.Fail)}).post(),this.hit=!1,!u&&this.reset(),this.setStatus(d.End)},i.prototype.setPostCb=function(a){return this.postCb=a,this},i.prototype.getPostCb=function(){return this.postCb},i.prototype.getOperatingCount=function(){return this.operatingCount},i.prototype.getSpeedThreshold=function(){return this.speedThreshold},i.prototype.isHit=function(){return this.hit},i.prototype.getStatus=function(){return this.status},i.prototype.setStatus=function(a){this.status=a},i.prototype.getSkipReset=function(){return this.skipReset},i.prototype.setSkipReset=function(a){this.skipReset=a},i.prototype.applyConfig=function(a){var u=a.version;if(u!==void 0&&u==2){var c=a.speedThreshold;c!==void 0&&(this.speedThreshold=c);var p=a.probability;p!==void 0&&(this.probability=p);var h=a.itemlimit;h!==void 0&&this.operatingCount.setItemLimit(h)}else console.warn("acprobe applyConfig version not 1")},i.prototype.post=function(){var a=this.getPostCb();try{if(!this.operatingCount.usefull())return void(a&&a(!1,null));var u=this.operatingCount.serialize(),c=o.default.isDebug()?"https://pianotiles-minigame.cmcm.com/warty/report/play_data":"https://minigame.cmcm.com/warty/report/play_data";n.default.isOversea()&&(c="https://h5game_oversea.cmcm.com/warty/report/play_data"),cmg.platform.pushCommonMessage(c,u,1,a),console.log("k hit")}catch(p){console.log("--- POST ERROR ---",p),a&&a(!1,null)}},i.prototype.reset=function(){this.operatingCount&&this.operatingCount.reset()},i}();m.default=t,cc._RF.pop()},{"../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../base/Log":"Log","../business/keypad/KeypadUtil":"KeypadUtil","./OperatingCount":"OperatingCount"}],AttendChallengeTask:[function(l,P,m){"use strict";cc._RF.push(P,"0655fLG7LtH/Z+mcOS5e6iR","AttendChallengeTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TaskItemImpl"),s=l("../TaskItem"),r=l("../../../config/LSKey"),o=l("../../Network/Protocol/StorageUtil"),e=l("../../../util/StringUtil"),n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.update=function(){var a=o.default.read(r.default.HAS_FIGHT_WIN);e.StringUtil.isEmpty(a)?(this.currentStep=0,this.status=s.TaskStatus.TASK_STATUS_DOING):(this.currentStep=this.totalStep,this.status=s.TaskStatus.TASK_STATUS_SUCCESS)},i}(d.default);m.default=n,cc._RF.pop()},{"../../../config/LSKey":"LSKey","../../../util/StringUtil":"StringUtil","../../Network/Protocol/StorageUtil":"StorageUtil","../TaskItem":"TaskItem","./TaskItemImpl":"TaskItemImpl"}],AttentionPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"8dd9ehx/8FL6qIdraMaNibw","AttentionPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../Logic/SkinDataManager"),s=l("../BasicTouchEvent"),r=l("../../../daily/AttentionUtil"),o=l("../../../../base/G"),e=l("../ImgCache"),n=l("./MainpageBaseComponent"),t=l("../../../../util/PU"),i=l("../../../../infoc/m_p2_daily_activity"),a=l("../../../Logic/NotifyEvent"),u=l("../../../Logic/EventBus"),c=cc._decorator,p=c.ccclass,h=c.property,f=function(g){function _(){var S=g!==null&&g.apply(this,arguments)||this;return S.mGainBtn=null,S.mGainTouchCb=null,S.statusPic={enable:"mainpage/gain_normal",disable:"mainpage/gain_disable",press:"mainpage/gain_press"},S}var y;return __extends(_,g),(y=_).prototype.onLoad=function(){this.initEvent(),this.initUI()},_.prototype.onUnlockSkin=function(S,I){S==a.default.UNLOCK_NORMAL_SKIN_EVENT&&I[0]==y.skinName&&(u.default.remove(a.default.UNLOCK_NORMAL_SKIN_EVENT,this.onUnlockSkin,this),this.invokeCloseCb())},_.prototype.initEvent=function(){var S=this;u.default.register(a.default.UNLOCK_NORMAL_SKIN_EVENT,this.onUnlockSkin,this),t.default.isWeiXin()?(this.mWxSprite.node.active=!0,this.mQQSprite.node.active=!1):(this.mWxSprite.node.active=!1,this.mQQSprite.node.active=!0),this.mGainTouchCb=new s.default(function(){d.SkinDataMgr.Ins().unlockSkin(y.skinName),S.disableGainBtn(),u.default.remove(a.default.UNLOCK_NORMAL_SKIN_EVENT,S.onUnlockSkin,S),S.invokeCloseCb(),i.default.report(S.mSource,i.default.ACTION_CLICK_GET)})},_.prototype.unInitEvent=function(){this.mGainBtn.node.off(cc.Node.EventType.TOUCH_END,this.mGainTouchCb.click,this.mGainTouchCb)},_.prototype.initUI=function(){var S=d.SkinDataMgr.Ins().getOwnedSkin(y.skinName);S&&S.isOwnedPermanent()||!r.AttentionUtil.isLauchFromAttention(o.G.getLaunchOption())?this.disableGainBtn():(this.loadPic(this.statusPic.enable),this.mGainBtn.node.on(cc.Node.EventType.TOUCH_END,this.mGainTouchCb.click,this.mGainTouchCb))},_.prototype.loadPic=function(S){e.default.get2(S,this.mGainBtn)},_.prototype.disableGainBtn=function(){this.loadPic(this.statusPic.disable),this.unInitEvent()},_.prototype.refreshUi=function(){this.initUI()},_.skinName="sakura",__decorate([h(cc.Sprite)],_.prototype,"mWxSprite",void 0),__decorate([h(cc.Sprite)],_.prototype,"mQQSprite",void 0),__decorate([h(cc.Sprite)],_.prototype,"mGainBtn",void 0),_=y=__decorate([p],_)}(n.default);m.default=f,cc._RF.pop()},{"../../../../base/G":"G","../../../../infoc/m_p2_daily_activity":"m_p2_daily_activity","../../../../util/PU":"PU","../../../Logic/EventBus":"EventBus","../../../Logic/NotifyEvent":"NotifyEvent","../../../Logic/SkinDataManager":"SkinDataManager","../../../daily/AttentionUtil":"AttentionUtil","../BasicTouchEvent":"BasicTouchEvent","../ImgCache":"ImgCache","./MainpageBaseComponent":"MainpageBaseComponent"}],AttentionUtil:[function(l,P,m){"use strict";cc._RF.push(P,"6943e3gHztDt7rTtob0gdjy","AttentionUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/PU"),s=l("../../base/Log"),r=l("../Network/Protocol/StorageUtil"),o=l("../../config/LSKey"),e=function(){function n(){}return n.isLauchFromAttention=function(t){s.default.i(n.TAG+"isLauchFromAttention lauchOption =",t);var i=!1;return t&&t.scene&&(d.default.isWeiXin()?"6.7.0"<=d.default.wxVersion&&t.scene==n.OPEN_FROM_MY_MINI_GAME&&(r.default.save(o.default.HAS_ENTER_FROM_ATTENTION,"true"),i=!0):d.default.isQQ()&&t.scene==n.OPEN_FROM_DESK_ANROID_QQ&&(r.default.save(o.default.HAS_ENTER_FROM_ATTENTION,"true"),i=!0)),i},n.TAG="[AttentionUtil]====>>>",n.OPEN_FROM_MY_MINI_GAME=1104,n.OPEN_FROM_DESK_ANROID_QQ=222,n}();m.AttentionUtil=e,cc._RF.pop()},{"../../base/Log":"Log","../../config/LSKey":"LSKey","../../util/PU":"PU","../Network/Protocol/StorageUtil":"StorageUtil"}],AutomaticTest:[function(l,P,m){"use strict";cc._RF.push(P,"eee72WaSgdHJbL5NXRVs8Zq","AutomaticTest"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Performance"),s=l("../base/G"),r=l("../music/MusicPlayCompat"),o=function(){function e(){this.items=[],this.running=!1,this.game=null,this.loop=-1,this.timeSpace=60,this.markTime=0,this.counter=new d.Performance.CounterImpl(.022)}return e.prototype.initTestItems=function(){var n=s.G.Ap.config;this.items.push({name:"\u4E0B\u843D+\u81EA\u52A8\u70B9+\u58F0\u97F3\u9636\u6BB5\uFF08\u5E76\u53D1\uFF0C\u666E\u901A\uFF09",initilize:function(){n.debugNoDetectMission=!1,n.debugNoBlockAnim=!1,n.debugNoBlockSound=!1,n.debugNoScoreAnim=!1,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoPullParent=!1,n.debugNoComplicatedPlayMode=!1,r.default.getInstance().updateCompatEnabled(!1)}}),this.items.push({name:"\u4E0B\u843D+\u81EA\u52A8\u70B9+\u58F0\u97F3\u9636\u6BB5\uFF08\u5E76\u53D1\uFF0C\u5FAE\u4FE1\uFF09",initilize:function(){n.debugNoDetectMission=!1,n.debugNoBlockAnim=!1,n.debugNoBlockSound=!1,n.debugNoScoreAnim=!1,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoPullParent=!1,n.debugNoComplicatedPlayMode=!1,r.default.getInstance().updateCompatEnabled(!0)}}),this.items.push({name:"\u4E0B\u843D+\u81EA\u52A8\u70B9+\u58F0\u97F3\u9636\u6BB5\uFF08\u5E76\u53D1\uFF09",initilize:function(){n.debugNoDetectMission=!1,n.debugNoBlockAnim=!1,n.debugNoBlockSound=!1,n.debugNoScoreAnim=!1,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoPullParent=!1,n.debugNoComplicatedPlayMode=!1}}),this.items.push({name:"\u4E0B\u843D+\u81EA\u52A8\u70B9+\u58F0\u97F3\u9636\u6BB5\uFF08\u72EC\u7ACB\uFF09",initilize:function(){n.debugNoDetectMission=!1,n.debugNoBlockAnim=!1,n.debugNoBlockSound=!1,n.debugNoScoreAnim=!1,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoPullParent=!1,n.debugNoComplicatedPlayMode=!0}}),this.items.push({name:"\u4E0B\u843D+\u81EA\u52A8\u70B9+\u58F0\u97F3\u9636\u6BB5\uFF08\u72EC\u7ACB\uFF092",initilize:function(){n.debugNoDetectMission=!1,n.debugNoBlockAnim=!1,n.debugNoBlockSound=!1,n.debugNoScoreAnim=!1,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoPullParent=!1,n.debugNoComplicatedPlayMode=!0}}),this.items.push({name:"\u4E0B\u843D+\u81EA\u52A8\u70B9+\u58F0\u97F3\u9636\u6BB5\uFF08\u5E76\u53D1\uFF092",initilize:function(){n.debugNoDetectMission=!1,n.debugNoBlockAnim=!1,n.debugNoBlockSound=!1,n.debugNoScoreAnim=!1,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoPullParent=!1,n.debugNoComplicatedPlayMode=!1}}),this.items.push({name:"\u4E0B\u843D\uFF08\u5B50\u8282\u70B9\u62C9\u52A8\uFF09+\u81EA\u52A8\u70B9",initilize:function(){n.debugNoDetectMission=!0,n.debugNoBlockAnim=!0,n.debugNoBlockSound=!0,n.debugNoScoreAnim=!0,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoComplicatedPlayMode=!1,n.debugNoPullParent=!0}}),this.items.push({name:"\u4E0B\u843D\uFF08\u7236\u8282\u70B9\u62C9\u52A8\uFF09+\u81EA\u52A8\u70B9",initilize:function(){n.debugNoDetectMission=!0,n.debugNoBlockAnim=!0,n.debugNoBlockSound=!0,n.debugNoScoreAnim=!0,n.debugNoTouchResponse=!0,n.debugAutoTouchBlock=!0,n.debugNoComplicatedPlayMode=!1,n.debugNoPullParent=!1}})},e.prototype.isStart=function(){return this.running},e.prototype.startTest=function(){this.initTestItems(),console.log("5s\u540E\u5F00\u59CB\u6D4B\u8BD5"),this.markTime=5,this.running=!0},e.prototype.attachGame=function(n){this.game||(this.game=n,0<=this.loop&&this.game.testStartGame())},e.prototype.update=function(n){this.counter.update(n),this.counter.runDuration>=this.markTime&&this.startLoop(this.loop+1)},e.prototype.startLoop=function(n){this.loop=n,this.markTime=this.timeSpace;var t=s.G.Ap.config;if(t.debugNoBlockSound=!1,t.debugNoBlockAnim=!1,t.debugNoDetectMission=!1,t.debugNoTouchResponse=!1,t.debugNoScoreAnim=!1,t.debugAutoTouchBlock=!1,t.debugAutoLog=!1,t.debugNoHonorAnim=!1,t.debugNoBackgroundSwitch=!1,t.debugNoLongBlocks=!1,t.debugNoPullParent=!1,t.debugNoComplicatedPlayMode=!1,t.debugNoFlyMoneyAnim=!1,0<=this.loop&&this.loop<=this.items.length){if(1<=this.loop&&this.loop<=this.items.length){var i=this.items[this.loop-1];console.log("\u7ED3\u675F\u3010"+i.name+"\u3011"),this.counter.reportAndReset()}this.loop<this.items.length?(this.restartGame(),(i=this.items[this.loop]).initilize(),console.log("\u5F00\u59CB\u3010"+i.name+"\u3011")):(console.log("\u62A5\u544A\u7ED3\u675F"),this.game.testPauseGame())}},e.prototype.restartGame=function(){var n=this;this.running=!1,this.game=null,s.G.Ap.state.reset(!1),s.G.Ap.config.loadMusic(s.G.Ap.state.mission.musicId,function(t){n.running=!0,s.G.Ap.presenter.enterScene(s.G.GAME_SCENE_NAME,s.G.Ap.state.mission.musicId)})},e}();m.default=o,cc._RF.pop()},{"../base/G":"G","../music/MusicPlayCompat":"MusicPlayCompat","./Performance":"Performance"}],AvatarUtil:[function(l,P,m){"use strict";cc._RF.push(P,"1e2065qJNRIsL+902AB5j8t","AvatarUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),s=l("../LogicPlatform/SpriteCacheLoader"),r=l("../util/PU"),o=l("../util/StringUtil"),e=function(){function n(){}return n.showUserAvatarAndName=function(t,i){d.MGUser.getUserBasicInfo({complete:function(a){if(a!=null){t&&t(a.nickName);var u=a.avatarUrl;n.showUserAvatar(u,i,!0)}}})},n.showUserAvatarForOther=function(t,i,a,u){var c;u===void 0&&(u=null),o.StringUtil.isEmpty(t)||(r.default.isWeiXin()?c=wx.createImage():(c=document.createElement("img")).crossOrigin="anonymous",c.src=t,c.onload=function(){var p;p=r.default.isWeiXin()?wx.createCanvas():document.createElement("canvas");var h=i.node.width,f=i.node.height;p.width=h,p.height=f;var g=p.getContext("2d",null);if(g.clearRect(0,0,p.width,p.height),g.imageSmoothingEnabled=!0,g.mozImageSmoothingEnabled=!0,a){var _=p.width/2,y=p.height/2;g.beginPath(),g.arc(_,y,p.width/2,0,2*Math.PI),g.closePath(),g.save(),g.clip(),g.drawImage(c,0,0,p.width,p.height),g.restore()}else g.drawImage(c,0,0,p.width,p.height);u&&u(p);var S=new cc.Texture2D;S.releaseTexture(),S.initWithElement(p),S.handleLoadedTexture();var I=new cc.SpriteFrame;I.setTexture(S),i.spriteFrame=I})},n.showUserAvatarForQQ=function(t,i,a,u){u===void 0&&(u=null);var c=document.createElement("canvas"),p=i.node.width,h=i.node.height;c.width=p,c.height=h;var f=c.getContext("2d",null);if(f.clearRect(0,0,c.width,c.height),f.imageSmoothingEnabled=!0,f.mozImageSmoothingEnabled=!0,a){var g=c.width/2,_=c.height/2;f.beginPath(),f.arc(g,_,c.width/2,0,2*Math.PI),f.closePath(),f.save(),f.clip(),f.drawImage(t,0,0,c.width,c.height),f.restore()}else f.drawImage(t,0,0,c.width,c.height);u&&u(c);var y=new cc.Texture2D;y.releaseTexture(),y.initWithElement(c),y.handleLoadedTexture();var S=new cc.SpriteFrame;S.setTexture(y),i.spriteFrame=S},n.showUserAvatar=function(t,i,a,u){var c=this;u===void 0&&(u=null);try{r.default.isQQ()?a?s.default.loadImageAsyncForQQ(t,function(p,h){p&&c.showUserAvatarForQQ(h,i,!0,u)}):s.default.load(t,i,u):this.showUserAvatarForOther(t,i,a,u)}catch(p){console.log("usrInfo getUserInfo catch err = "+p)}},n.initSpriteFromDisk=function(t,i){var a=document.createElement("canvas"),u=i.node.width,c=i.node.height;a.width=u,a.height=c;var p=a.getContext("2d",null);p.clearRect(0,0,a.width,a.height),p.imageSmoothingEnabled=!0,p.mozImageSmoothingEnabled=!0,p.drawImage(t,0,0,a.width,a.height);var h=new cc.Texture2D;h.releaseTexture(),h.initWithElement(a),h.handleLoadedTexture();var f=new cc.SpriteFrame;f.setTexture(h),i.spriteFrame=f},n}();m.default=e,cc._RF.pop()},{"../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../LogicPlatform/SpriteCacheLoader":"SpriteCacheLoader","../util/PU":"PU","../util/StringUtil":"StringUtil"}],AwardController:[function(l,P,m){"use strict";cc._RF.push(P,"f2ceage/WhPJqw9BEOaeLiQ","AwardController"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/ToastPopManager"),s=l("../UI/dailyattendance/AwardResultCommonPrefab"),r=l("../Logic/MoneySystem"),o=l("../Logic/GameItemsManager"),e=l("../skin/SkinManager"),n=l("../../base/Log"),t=l("../../base/G"),i=l("../Logic/EventBus"),a=l("../Logic/NotifyEvent"),u=l("../../property/PropertyDefines"),c=l("../skin/SkinPieceMgr"),p=l("../Logic/SkinDataManager"),h=l("../../business/Logic/I18nManager"),f=l("../keypad/KeypadNavigator"),g=function(){function I(){this.AwardPrefab="prefab/AwardCommonResultPrefab"}return I.getIns=function(){return this.sInstance||(this.sInstance=new I),this.sInstance},I.filterAwardsForDouble=function(v){n.default.i("before fillter awards, size="+v.length);for(var C=[],T=0,E=0;E<v.length;E++){var A=v[E];A.awardType!=o.GameItemType.TYPE_SKIN&&(C[T]=A,T++)}return n.default.i("after fillter awards, size="+C.length),C},I.shouldDoubleAward=function(v){return v&&v.awardType!=o.GameItemType.TYPE_SKIN},I.shouldDoubleAwards=function(v){var C=!1;if(v&&0<v.length){if(v.length==1)C=v[0].awardType!=o.GameItemType.TYPE_SKIN;else for(var T=0;T<v.length;T++)if(v[T].awardType!=o.GameItemType.TYPE_SKIN){C=!0;break}}return C},I.getAwardsToastTip=function(v,C){var T=C||"\u606D\u559C\u60A8\uFF0C\u770B\u89C6\u9891\u989D\u5916\u83B7\u5F97\uFF1A";if(h.default.getInstance().isEnglish()&&(T=C||"Congratulations, Rerward\uFF1A"),v&&0<v.length){for(var E=0;E<v.length;E++){var A=v[E],M=o.GameItemsManager.getIns().getItemNameSplitTime(A.id);M||A.awardType==o.GameItemType.TYPE_PIECE&&(M="\u788E\u7247",h.default.getInstance().isEnglish()&&(M=" puzzle")),T+=M+"x"+A.count+"\uFF0C"}T=T.slice(0,T.length-1)}return T},I.hasOwnAwardSkin=function(v){for(var C=v.getAwardContentList(),T=0;T<C.length;T++){var E=C[T];if(E.awardType==o.GameItemType.TYPE_SKIN&&e.SkinMgr.isOwnedPermanent(E.id))return!0}return!1},I.skinConvertToDiamond=function(v){var C=0;if(e.SkinMgr.isOwnedPermanent(v)){var T=o.GameItemsManager.getIns().getItemById(v),E=o.GameItemsManager.getIns().getItemTimeLimitDay(T.getItemId());switch(E){case 1:C=10;break;case 2:C=20;break;case 3:C=30;break;case 0:C=199}n.default.i("AwardController skinConvertToDiamond limitsDay: "+E+" diamondNum: "+C)}return C},I.prototype.showCommonAwardResultPage=function(v,C){n.default.i("AwardController showAwardResultPage",v),I.divTipsShowIsUserContainSkin(v)&&I.mergeAwardContentIfNeed(v),this.mergeSKinPieceIfNedd(v),v.isNeedGiveAwardInfo()&&I.giveAwardInfo(v.getAwardContentList()),d.ToastPopManager.getIns().showDynamic(this.AwardPrefab,function(T){var E=T.getComponent(s.default);v.setOnCloseCallback(function(){d.ToastPopManager.getIns().dismiss(T),C&&f.default.getInstance().gotoPage(C)}),C&&(E.setDoubleBtn=!1),E.initData(v)})},I.prototype.showAwardResultPage=function(v){n.default.i("AwardController showAwardResultPage",v),v.isMergeAward()&&(I.mergeAwardContentIfNeed(v),this.mergeSKinPieceIfNedd(v)),v.isNeedGiveAwardInfo()&&I.giveAwardInfo(v.getAwardContentList()),d.ToastPopManager.getIns().showDynamic(this.AwardPrefab,function(C){var T=C.getComponent(s.default);v.setOnCloseCallback(function(){d.ToastPopManager.getIns().dismiss(C)}),T.initData(v)})},I.prototype.showAwardVipPage=function(v){n.default.i("AwardController showAwardVipPage",v),h.default.getInstance().isEnglish()?I.mergeAwardContentIfNeed(v,"the skin have transformed into %s diamond","use it at skin stroe"):I.mergeAwardContentIfNeed(v,"\u8D60\u9001\u76AE\u80A4\u5DF2\u62E5\u6709\uFF0C\u8F6C\u4E3A%s\u94BB\u77F3\u5956\u52B1","\u8D60\u9001\u76AE\u80A4\u8BF7\u5230\u76AE\u80A4\u5546\u5E97\u8BBE\u7F6E"),v.isNeedGiveAwardInfo()&&I.giveAwardInfo(v.getAwardContentList()),d.ToastPopManager.getIns().showDynamic(this.AwardPrefab,function(C){var T=C.getComponent(s.default);v.setOnCloseCallback(function(){d.ToastPopManager.getIns().dismiss(C)}),T.initData(v)})},I.prototype.mergeSKinPieceIfNedd=function(v){for(var C=v.getAwardContentList(),T=v.getAwardItems(),E=0;E<C.length;E++){var A=C[E];if(A.awardType==o.GameItemType.TYPE_PIECE)break;A.awardType==o.GameItemType.TYPE_GOLD&&T[E]}},I.divTipsShowIsUserContainSkin=function(v){for(var C=!1,T=!1,E=v.getAwardContentList(),A=0;A<E.length;A++){var M=E[A];if(M.awardType==o.GameItemType.TYPE_SKIN){if(C=!0,0<I.skinConvertToDiamond(M.id))return!0;var k="\u60A8\u53EF\u4EE5\u5728\u76AE\u80A4\u5546\u5E97\u8BBE\u7F6E\u4F7F\u7528\u76AE\u80A4 ",D="\u53BB\u8BBE\u7F6E";h.default.getInstance().isEnglish()&&(k="You can use it at skin stroe ",D="use it"),v.setBottomLeftText(k).setBottomRightText(D,function(){I.getIns().dismissAwardResultPage(v),i.default.fire(a.default.REWARTDPANEL_SHOW_SKINSTORE),v.callCloseParent()})}else if(M.awardType==o.GameItemType.TYPE_PIECE){var L=0,b=p.SkinDataMgr.Ins().getOwnedSkin(p.SkinDataMgr.Ins().getSkinByPieceId(M.id).name);if(b!=null&&b.isOwnedPermanent()&&(L=M.count),0<L)return!1;C||(T=!0)}else if(M.awardType==o.GameItemType.TYPE_PROP){k="\u83B7\u5F97\u51B2\u523A\u9053\u5177\uFF0C\u53EF\u5728\u6E38\u620F\u4E2D\u4F7F\u7528",D="\u83B7\u5F97\u51CF\u901F\u9053\u5177\uFF0C\u53EF\u5728\u6E38\u620F\u4E2D\u4F7F\u7528";var N="\u83B7\u5F97\u62A4\u76FE\u9053\u5177\uFF0C\u53EF\u5728\u6E38\u620F\u4E2D\u4F7F\u7528";h.default.getInstance().isEnglish()&&(k="Recieve Auto tap props, use in game",D="Recieve slowDown props\uFF0Cto use it in game",N="Recieve shield props, use in game");var H=t.G.Ap.propertyPack.getConfig().getParamByItemId(M.id).key;if(H)switch(H.type){case u.PROPERTYTYPE.GAME_DASH:v.setBottomLeftText(k);break;case u.PROPERTYTYPE.GAME_SLOW:v.setBottomLeftText(D);break;case u.PROPERTYTYPE.GAME_SHIELD:v.setBottomLeftText(N)}}else if(M.awardType==o.GameItemType.TYPE_DIAMONDS){var R=v.getBottomLeftText(),F=R&&0<R.length;C||T||F||(h.default.getInstance().isEnglish()?v.setBottomLeftText("to get more reward in game"):v.setBottomLeftText("\u53BB\u6E38\u620F\u4E2D\u8D62\u53D6\u66F4\u591A\u793C\u5305\u5427"))}}return!1},I.mergeAwardContentIfNeed=function(v,C,T){for(var E,A,M=v.getAwardContentList(),k=v.getAwardItems(),D=-1,L=0,b=!1,N=0;N<M.length;N++){var H=M[N];H.awardType==o.GameItemType.TYPE_SKIN?(b=!0,D=N,L=I.skinConvertToDiamond(H.id)):H.awardType==o.GameItemType.TYPE_DIAMONDS&&(E=H,A=k[N])}if(0<L){try{M.splice(D,1),v.getAwardItems().splice(D,1)}catch(R){n.default.i("mergeAwardContentIfNeed error",R)}n.default.i("mergeAwardContentIfNeed",v),C?v.setBottomSecondTip(cc.js.formatStr(C,L)):v.setBottomSecondTip("\u5956\u52B1\u7684\u76AE\u80A4\u4E3A\u4F60\u8F6C\u4E3A"+L+"\u4E2A\u94BB\u77F3"),E?(E.count+=L,A.itemText=E.count+""):v.addAwardContent(o.GameItemType.TYPE_DIAMONDS,L)}else b&&(T?v.setBottomSecondTip(T):h.default.getInstance().isEnglish()?v.setBottomSecondTip("use it at skin stroe"):v.setBottomSecondTip("\u76AE\u80A4\u5546\u5E97\u53EF\u8BBE\u7F6E\u4F7F\u7528\u65B0\u83B7\u5F97\u76AE\u80A4"))},I.giveAwardInfo=function(v){if(v)for(var C=0;C<v.length;C++){var T=v[C];this.giveAwardContent(T)}},I.giveAwardContent=function(v){switch(n.default.i("giveAwardContent",v.toString()),v.awardType){case o.GameItemType.TYPE_DIAMONDS:r.MoneySystem.increaseDiamond(v.count);break;case o.GameItemType.TYPE_GOLD:r.MoneySystem.increaseGold(v.count);break;case o.GameItemType.TYPE_HP:r.MoneySystem.increaseHp(v.count);break;case o.GameItemType.TYPE_SKIN:e.SkinMgr.Ins().receiveSkin(v.id);break;case o.GameItemType.TYPE_PIECE:this.addAChip(v.id,v.count);break;case o.GameItemType.TYPE_PROP:this.addProp(v.id,v.count)}},I.addAChip=function(v,C){var T=new c.Piece(v,C);c.default.Ins().addPiece([T])},I.addProp=function(v,C){var T=t.G.Ap.propertyPack.getPlayProperty(),E=t.G.Ap.propertyPack.getConfig().getParamByItemId(v).key;E&&(T.addProperty(E,C),t.G.Ap.propertyPack.save())},I.prototype.dismissAwardResultPage=function(v){var C=v.getOnCloseCb();C&&C()},I.sInstance=null,I}();m.AwardController=g;var _=function(){function I(){this.mSource=I.SOURCE_NONE,this.mergeAward=!0,this.isGiveAwardInfo=!1,this.titlePicPath="/static_res/share_gift_congratulation_title",this.okBtnText="\u597D\u7684",this.okBtnSpriteNormal="/static_res/share_gift_ok_normal",this.okBtnSpritePressed="/static_res/share_gift_ok_press",this.bottomLeftText="",this.isBottomRightTipVisible=!1,this.leftNeedLabelString="",this.leftNeedIconPath="",this.bottomRightText="",this.bottomSecondTipText="",this.awardContentList=[],this.awardItems=[],this.isSkipLabelVisible=!1,this.isShowText=!0,h.default.getInstance().isEnglish()&&(this.titlePicPath="/static_res/share_gift_congratulation_title_en",this.okBtnText="ok")}return I.prototype.getSource=function(){return this.mSource},I.prototype.steSource=function(v){return this.mSource=v,this},I.prototype.isSkipLableVisible=function(){return this.isSkipLabelVisible},I.prototype.getSkipLabelClickCb=function(){return this.onSkipLabelClick},I.prototype.getTitlePicPath=function(){return this.titlePicPath},I.prototype.getOkBtnText=function(){return this.okBtnText},I.prototype.getOkBtnNormalSprite=function(){return this.okBtnSpriteNormal},I.prototype.getOkBtnPressedSprite=function(){return this.okBtnSpritePressed},I.prototype.getBottomLeftText=function(){return this.bottomLeftText},I.prototype.getLeftNeedLabelText=function(){return this.leftNeedLabelString},I.prototype.getNeedIconSpritePath=function(){return this.leftNeedIconPath},I.prototype.isBottomRightTextVisible=function(){return this.isBottomRightTipVisible},I.prototype.getBottomRightText=function(){return this.bottomRightText},I.prototype.getBottomRightTextClickCb=function(){return this.onBottomRightTipClick},I.prototype.getBottomSecondTipText=function(){return this.bottomSecondTipText},I.prototype.getDoubleBtnClickCb=function(){return this.onDoubleBtnClick},I.prototype.getOkBtnClickCb=function(){return this.onOkBtnClick},I.prototype.getOnCloseCb=function(){return this.onCloseCallback},I.prototype.getAwardItems=function(){return this.awardItems},I.prototype.getAwardContentList=function(){return this.awardContentList},I.prototype.isNeedGiveAwardInfo=function(){return this.isGiveAwardInfo},I.prototype.isMergeAward=function(){return this.mergeAward},I.prototype.setMergeAward=function(v){return this.mergeAward=v,this},I.prototype.setTitlePicPath=function(v){return v&&(this.titlePicPath=v),this},I.prototype.setIsNeedGiveAwardInfo=function(v){return this.isGiveAwardInfo=v,this},I.prototype.addAwardContentItem=function(v){return v&&(this.awardContentList.push(v),this.addAwardItem(v)),this},I.prototype.addAwardContent=function(v,C,T){var E=new y(v,C,T);return this.awardContentList.push(E),this.addAwardItem(E),this},I.prototype.addAwardItem=function(v){var C=new S;switch(C.itemText="x"+v.count,v.awardType){case o.GameItemType.TYPE_DIAMONDS:C.itemPicPath=o.GameItemsManager.getIns().getSmallPicByItemId(o.GameItemsDefine.ID_DIAMOND);break;case o.GameItemType.TYPE_GOLD:C.itemPicPath=o.GameItemsManager.getIns().getSmallPicByItemId(o.GameItemsDefine.ID_GOLD);break;case o.GameItemType.TYPE_HP:C.itemPicPath=o.GameItemsManager.getIns().getSmallPicByItemId(o.GameItemsDefine.ID_POWER);break;case o.GameItemType.TYPE_SKIN:C.itemPicPath=o.GameItemsManager.getIns().getSmallPicByItemId(v.id),C.itemText=o.GameItemsManager.getIns().getItemNameSplitTime(v.id)+" x"+v.count;var T=o.GameItemsManager.getIns().getItemTimeLimitDay(v.id);0<T&&(h.default.getInstance().isEnglish()?C.itemSecondText="(Limited time\uFF1A"+T+" days)":C.itemSecondText="(\u9650\u65F6"+T+"\u5929)");break;case o.GameItemType.TYPE_PIECE:return void(C.itemPicPath=o.GameItemsManager.getIns().getSmallPicByItemId(v.id));case o.GameItemType.TYPE_PROP:C.itemPicPath=o.GameItemsManager.getIns().getBigPicByItemId(v.id),C.plistPath=o.GameItemsManager.getPropPlistPath()}this.awardItems.push(C)},I.prototype.getSkinPieceIconPath=function(v){},I.prototype.setLeftNeedLabel=function(v){return v&&(v.indexOf("color=")==-1&&(v="<color=#ffffff>"+v+"</c>"),this.leftNeedLabelString=v),this},I.prototype.setLeftNeedIconPath=function(v){return this.leftNeedIconPath=v||"",this},I.prototype.setBottomLeftText=function(v){return v&&(v.indexOf("color=")==-1&&(v="<color=#ffffff>"+v+"</c>"),this.bottomLeftText=v),this},I.prototype.setBottomRightText=function(v,C){return this.isBottomRightTipVisible=!0,v&&(this.bottomRightText=v),C&&(this.onBottomRightTipClick=C),this},I.prototype.setBottomSecondTip=function(v){return v&&(this.bottomSecondTipText=v),this},I.prototype.enableSkipLabel=function(v,C){return C&&(this.isSkipLabelVisible=!0,this.onSkipLabelClick=C),this},I.prototype.setDoubleBtn=function(v,C){return this.onDoubleBtnClick=C,this},I.prototype.setOkBtn=function(v,C){return this.setRichOkBtn(v,null,null,C),this},I.prototype.setIsShowText=function(v){this.isShowText=v},I.prototype.getIsShowText=function(){return this.isShowText},I.prototype.setRichOkBtn=function(v,C,T,E){return v&&(this.okBtnText=v),v!=""&&v!=" "||(this.okBtnText=""),C&&(this.okBtnSpriteNormal=C),T&&(this.okBtnSpritePressed=T),E&&(this.onOkBtnClick=E),this},I.prototype.callCloseParent=function(){this.onCloseParentCallback&&this.onCloseParentCallback()},I.prototype.setCloseParentCallback=function(v){return this.onCloseParentCallback=v,this},I.prototype.setOnCloseCallback=function(v){v&&(this.onCloseCallback=v)},I.SOURCE_NONE=0,I.SOURCE_LOTTERY=1,I.SOURCE_DAILY_ATTENDANCE=2,I.SOURCE_GAME_CHEST=3,I}();m.AwardResultInfo=_;var y=function(){function I(v,C,T){this.awardType=-1,this.count=0,this.id="",this.awardType=v,this.count=C,this.id=T}return I.prototype.toString=function(){return"awardType: "+this.awardType+" count: "+this.count+" id: "+this.id},I}();m.AwardContent=y;var S=function(){this.plistPath="",this.itemPicPath="",this.itemText="",this.itemSecondText=""};m.AwardResultItem=S,cc._RF.pop()},{"../../base/G":"G","../../base/Log":"Log","../../business/Logic/I18nManager":"I18nManager","../../property/PropertyDefines":"PropertyDefines","../Logic/EventBus":"EventBus","../Logic/GameItemsManager":"GameItemsManager","../Logic/MoneySystem":"MoneySystem","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/ToastPopManager":"ToastPopManager","../UI/dailyattendance/AwardResultCommonPrefab":"AwardResultCommonPrefab","../keypad/KeypadNavigator":"KeypadNavigator","../skin/SkinManager":"SkinManager","../skin/SkinPieceMgr":"SkinPieceMgr"}],AwardInfoFactory:[function(l,P,m){"use strict";cc._RF.push(P,"68216iKnhxME5ZFSJMkjXFm","AwardInfoFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./DailyAwardBens"),s=l("../Logic/LoginRewardManager"),r=l("../../util/StringUtil"),o=function(){function e(){this.mNewbieRewardList=null,this.mNormalRewardList=null}return e.getInstance=function(){return e.mInstance||(e.mInstance=new e),e.mInstance},e.prototype.generateUIData=function(n){for(var t=new Array,i=1;i<=7;i++){var a=!1;(i==3&&n==d.AwardCfg.SIGN_TYPE_NEWBIE||i==7&&n==d.AwardCfg.SIGN_TYPE_NORMAL)&&(a=!0);var u=new d.DailyDayUIBean(i,a,this.generate(i,n),n);t.push(u)}return t},e.prototype.getRewardList=function(n){return n==d.AwardCfg.SIGN_TYPE_NEWBIE?(this.mNewbieRewardList==null&&(this.mNewbieRewardList=s.LoginRewardMgr.Ins().getLoginRewardVM(1)),this.mNewbieRewardList):(this.mNormalRewardList==null&&(this.mNormalRewardList=s.LoginRewardMgr.Ins().getLoginRewardVM(0)),this.mNormalRewardList)},e.prototype.generate=function(n,t){var i=new Array,a=this.getRewardList(t)[n-1];return a.skins!=0?i.push(d.AwardInfo.createSkinInfo()):(a.diamonds!=0&&i.push(d.AwardInfo.createDiamondInfo(a.diamonds)),r.StringUtil.isEmpty(a.skinPiece)||i.push(d.AwardInfo.createPieceInfo(a.skinPiece))),i},e}();m.AwardInfoFactory=o,cc._RF.pop()},{"../../util/StringUtil":"StringUtil","../Logic/LoginRewardManager":"LoginRewardManager","./DailyAwardBens":"DailyAwardBens"}],AwardResultCommonPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"e18deyTt3xAKb/ttw9o26mZ","AwardResultCommonPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../GameEntraScene/ImgCache"),s=l("../GameEntraScene/BasicTouchEvent"),r=l("../../../util/SceneMusicMgr"),o=l("../../../util/ParticleSystemVM"),e=l("../../../util/StringUtil"),n=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),t=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),i=l("../../../base/Log"),a=l("../../../upgrade/BannerDelayShowToggle"),u=l("../../../upgrade/ToggleBean"),c=l("../../../util/PU"),p=l("../../../util/SUtil"),h=l("../../../../modules/MGUtils/MGPlatform"),f=l("../../keypad/KeypadNavigator"),g=l("../../Logic/I18nManager"),_=cc._decorator,y=_.ccclass,S=_.property,I=function(v){function C(){var T=v!==null&&v.apply(this,arguments)||this;return T.mMainNode=null,T.titleSprite=null,T.awardItem1RootNode=null,T.awardItem2RootNode=null,T.awardItem3RootNode=null,T.awardItem1Sprite=null,T.awardItem2Sprite=null,T.awardItem3Sprite=null,T.awardItem1Label=null,T.awardItem1SecondLabel=null,T.awardItem2Label=null,T.awardItem2SecondLabel=null,T.awardItem3Label=null,T.awardItem3SecondLabel=null,T.bottomTipLeftLabel=null,T.bottomTipRightLabel=null,T.bottomSecondTipLable=null,T.leftNeedlabel=null,T.leftneedIcon=null,T.okButton=null,T.doubleButton=null,T.closeButton=null,T.okLabel=null,T.skipLabel=null,T.ParticleSystemNode=null,T.destoryBanner=!0,T.setDoubleBtn=!0,T}return __extends(C,v),C.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(D){D.stopPropagation()});var T=new s.default(this.onBottomRightLableClick.bind(this));this.bottomTipRightLabel.node.on(cc.Node.EventType.TOUCH_END,T.click,T);var E=new s.default(this.onOkBtnClick.bind(this));this.okButton.node.on(cc.Node.EventType.TOUCH_END,E.click,E);var A=new s.default(this.onCloseClick.bind(this));this.closeButton.on(cc.Node.EventType.TOUCH_END,A.click,A);var M=new s.default(this.onSkipLabelClick.bind(this));this.skipLabel.node.on(cc.Node.EventType.TOUCH_END,M.click,M),this.setDoubleBtn&&(this.okButton.node.active=!g.default.getInstance().isEnglish(),this.doubleButton.node.active=g.default.getInstance().isEnglish());var k=new s.default(this.onDoubleBtnClick.bind(this));this.doubleButton.node.on(cc.Node.EventType.TOUCH_END,k.click,k),f.default.getInstance().pushDialog(this.node)},C.prototype.onSkipLabelClick=function(){this.onSkipLabelClickCb&&this.onSkipLabelClickCb()},C.prototype.onBottomRightLableClick=function(){this.onBottomRightTipClickCb&&this.onBottomRightTipClickCb()},C.prototype.onDoubleBtnClick=function(){this.onDoubleBtnClickCb&&this.onDoubleBtnClickCb()},C.prototype.onOkBtnClick=function(){this.onOkBtnClickCb&&this.onOkBtnClickCb()},C.prototype.onCloseClick=function(){this.onCloseBtnClickCB&&this.onCloseBtnClickCB()},C.prototype.initData=function(T){var E=this;if(T){r.default.play(r.default.PATH_SHORT,r.default.PATH_SHORT,!1),d.default.get(T.getOkBtnNormalSprite(),function(D,L){cc.isValid(E,!0)&&(E.okButton.normalSprite=L)}),d.default.get(T.getOkBtnPressedSprite(),function(D,L){cc.isValid(E,!0)&&(E.okButton.pressedSprite=L)}),d.default.get2(T.getTitlePicPath(),this.titleSprite);for(var A=0;A<T.getAwardItems().length;A++){var M=T.getAwardItems()[A];switch(A){case 0:e.StringUtil.isEmpty(M.plistPath)?d.default.get2(M.itemPicPath,this.awardItem1Sprite):d.default.loadAtlasSpriteFrames(M.plistPath,M.itemPicPath,function(D,L){cc.isValid(E,!0)&&(E.awardItem1Sprite.spriteFrame=L)}),this.awardItem1RootNode.active=!0,this.awardItem1Label.string=M.itemText,this.awardItem1SecondLabel.string=M.itemSecondText;break;case 1:e.StringUtil.isEmpty(M.plistPath)?d.default.get2(M.itemPicPath,this.awardItem2Sprite):d.default.loadAtlasSpriteFrames(M.plistPath,M.itemPicPath,function(D,L){cc.isValid(E,!0)&&(E.awardItem2Sprite.spriteFrame=L)}),this.awardItem2RootNode.active=!0,this.awardItem2Label.string=M.itemText,this.awardItem2SecondLabel.string=M.itemSecondText;break;case 2:e.StringUtil.isEmpty(M.plistPath)?d.default.get2(M.itemPicPath,this.awardItem3Sprite):d.default.loadAtlasSpriteFrames(M.plistPath,M.itemPicPath,function(D,L){cc.isValid(E,!0)&&(E.awardItem3Sprite.spriteFrame=L)}),this.awardItem3RootNode.active=!0,this.awardItem3Label.string=M.itemText,this.awardItem3SecondLabel.string=M.itemSecondText}}this.bottomSecondTipLable.string=T.getBottomSecondTipText(),this.bottomTipLeftLabel.string=T.getBottomLeftText(),this.leftNeedlabel.string=T.getLeftNeedLabelText(),this.leftneedIcon.node.active=!1,this.leftNeedlabel.node.active=!1;var k=T.getNeedIconSpritePath();k!=""&&d.default.get(k,function(D,L){cc.isValid(E,!0)&&(E.leftneedIcon.node.active=!0,E.leftNeedlabel.node.active=!0,E.leftneedIcon.spriteFrame=L)}),T.isBottomRightTextVisible()&&(this.bottomTipRightLabel.node.active=!0,this.bottomTipRightLabel.string=T.getBottomRightText(),this.onBottomRightTipClickCb=T.getBottomRightTextClickCb()),this.onOkBtnClickCb=T.getOkBtnClickCb(),this.onDoubleBtnClickCb=T.getDoubleBtnClickCb(),this.onCloseBtnClickCB=T.getOkBtnClickCb(),this.okLabel.string=T.getOkBtnText(),T.getIsShowText()?this.okLabel.node.active=!0:this.okLabel.node.active=!1,T.isSkipLableVisible()&&(this.skipLabel.node.active=!0,this.onSkipLabelClickCb=T.getSkipLabelClickCb(),this.onCloseBtnClickCB=T.getSkipLabelClickCb()),c.default.isWeiXin()&&this.ShowADs()}},C.prototype.moveMainNode=function(){var T=cc.moveTo(.2,0,100);this.mMainNode.runAction(T)},C.prototype.ShowADs=function(){var T=this;if(i.default.l("show ads!!!!!"),n.MGAdv.isBannerShow())i.default.l("\u5DF2\u7ECF\u6709banner\u5E7F\u544A\u4E86");else{var E,A=h.MGPlatform.getSystemInfoSync();this.skipLabel.node.active?(E=25-p.SUtil.ins().getChlidViewPositionInScreen(this.skipLabel.node,this.node).y,i.default.l("the skipLabel.node height is "+E)):(E=45-p.SUtil.ins().getChlidViewPositionInScreen(this.okButton.node,this.node).y,i.default.l("the okButton.node height is "+E));var M=A.screenHeight/2+E*A.screenHeight/p.SUtil.ins().mScreenHeight;n.MGAdv.loadBanner(300,0,M,function(k,D){if(k==t.ADStat.LOAD_SUCCESS)if(T.destoryBanner){T.destoryBanner=!1;var L=a.default.getBannerDelayTime(u.ToggleKey.BANNER_DELAY_REWARD_PAGE);i.default.l("call the shwoADS !!!!! the dalaytime is  "+L.normalDelayTime),T.scheduleOnce(function(){cc.isValid(T,!0)&&n.MGAdv.showBanner(t.ADScene.SOURCE_SHOW_AWARD)},L.normalDelayTime/1e3)}else T.destoryBannerAd()},t.ADScene.SOURCE_SHOW_AWARD)}},C.prototype.destoryBannerAd=function(){this.destoryBanner||(this.destoryBanner=!0,n.MGAdv.hideBanner(t.ADScene.SOURCE_SHOW_AWARD),n.MGAdv.destroyBanner(t.ADScene.SOURCE_SHOW_AWARD))},C.prototype.showParticleSystem=function(){if(this.ParticleSystemNode){var T=this.ParticleSystemNode.getChildByName("L-node"),E=this.ParticleSystemNode.getChildByName("R-node"),A=new o.ParticleSystemChild(!0,!0,"green","particle_levelupgreen_l.plist"),M=new o.ParticleSystemChild(!0,!0,"red","particle_levelupred_l.plist"),k=new o.ParticleSystemChild(!0,!0,"blue","particle_levelupblue_r.plist"),D=new o.ParticleSystemChild(!0,!0,"yellow","particle_yellow_r.plist"),L=[],b=[];L.push(A),L.push(M),b.push(k),b.push(D);var N=new o.ParticleSystemVM(T,L),H=new o.ParticleSystemVM(E,b);N.start(),H.start()}},C.prototype.onDestroy=function(){r.default.stop(r.default.NAME_SHORT),this.destoryBannerAd()},__decorate([S(cc.Node)],C.prototype,"mMainNode",void 0),__decorate([S(cc.Sprite)],C.prototype,"titleSprite",void 0),__decorate([S(cc.Node)],C.prototype,"awardItem1RootNode",void 0),__decorate([S(cc.Node)],C.prototype,"awardItem2RootNode",void 0),__decorate([S(cc.Node)],C.prototype,"awardItem3RootNode",void 0),__decorate([S(cc.Sprite)],C.prototype,"awardItem1Sprite",void 0),__decorate([S(cc.Sprite)],C.prototype,"awardItem2Sprite",void 0),__decorate([S(cc.Sprite)],C.prototype,"awardItem3Sprite",void 0),__decorate([S(cc.Label)],C.prototype,"awardItem1Label",void 0),__decorate([S(cc.Label)],C.prototype,"awardItem1SecondLabel",void 0),__decorate([S(cc.Label)],C.prototype,"awardItem2Label",void 0),__decorate([S(cc.Label)],C.prototype,"awardItem2SecondLabel",void 0),__decorate([S(cc.Label)],C.prototype,"awardItem3Label",void 0),__decorate([S(cc.Label)],C.prototype,"awardItem3SecondLabel",void 0),__decorate([S(cc.RichText)],C.prototype,"bottomTipLeftLabel",void 0),__decorate([S(cc.Label)],C.prototype,"bottomTipRightLabel",void 0),__decorate([S(cc.Label)],C.prototype,"bottomSecondTipLable",void 0),__decorate([S(cc.RichText)],C.prototype,"leftNeedlabel",void 0),__decorate([S(cc.Sprite)],C.prototype,"leftneedIcon",void 0),__decorate([S(cc.Button)],C.prototype,"okButton",void 0),__decorate([S(cc.Button)],C.prototype,"doubleButton",void 0),__decorate([S(cc.Node)],C.prototype,"closeButton",void 0),__decorate([S(cc.Label)],C.prototype,"okLabel",void 0),__decorate([S(cc.Label)],C.prototype,"skipLabel",void 0),__decorate([S(cc.Node)],C.prototype,"ParticleSystemNode",void 0),C=__decorate([y],C)}(cc.Component);m.default=I,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../../modules/MGUtils/MGPlatform":"MGPlatform","../../../base/Log":"Log","../../../upgrade/BannerDelayShowToggle":"BannerDelayShowToggle","../../../upgrade/ToggleBean":"ToggleBean","../../../util/PU":"PU","../../../util/ParticleSystemVM":"ParticleSystemVM","../../../util/SUtil":"SUtil","../../../util/SceneMusicMgr":"SceneMusicMgr","../../../util/StringUtil":"StringUtil","../../Logic/I18nManager":"I18nManager","../../keypad/KeypadNavigator":"KeypadNavigator","../GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../GameEntraScene/ImgCache":"ImgCache"}],AwardResultDialogPrefabScript:[function(l,P,m){"use strict";cc._RF.push(P,"1ab03hpLxhJLK64TBGVMe2r","AwardResultDialogPrefabScript"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../GameEntraScene/BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.title=null,i.content=null,i.btnTxt=null,i.confirmButton=null,i.closeButton=null,i.mConfirmClickCallback=null,i.mCloseClickCallback=null,i.mDialogManager=null,i.mResolve=null,i}return __extends(t,n),t.prototype.setPopupDlgManager=function(i){this.mDialogManager=i},t.prototype.onLoad=function(){var i=this;this.node.on(cc.Node.EventType.TOUCH_START,function(a){a.stopPropagation()}),this.confirmButton&&(this.mConfirmClickCallback=new d.default(function(){i.onTapConfirm()}),this.confirmButton.node.on(cc.Node.EventType.TOUCH_END,this.mConfirmClickCallback.click,this.mConfirmClickCallback)),this.closeButton&&(this.mCloseClickCallback=new d.default(function(){i.onClose()}),this.closeButton.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback))},t.prototype.init=function(i,a,u,c,p){this.setTitle(i),this.setContent(a),this.setBtnText(u),this.mOnClose=p,this.mOnConfirm=c},t.prototype.onTapConfirm=function(){this.node.destroy(),this.mResolve&&this.mResolve(),this.mOnConfirm&&this.mOnConfirm()},t.prototype.onClose=function(){this.mDialogManager&&this.mDialogManager.dismissDialog(this.node),this.mOnClose&&this.mOnClose()},t.prototype.isNotEmptyStr=function(i){return i&&1<i.length},t.prototype.setBtnText=function(i){this.btnTxt&&this.isNotEmptyStr(i)&&(this.btnTxt.string=i)},t.prototype.setTitle=function(i){this.title&&this.isNotEmptyStr(i)&&(this.title.string=i)},t.prototype.setContent=function(i){this.content&&this.isNotEmptyStr(i)&&(this.content.string=i)},t.prototype.setConfirmCallback=function(i){this.mResolve=i},t.prototype.setClickCallback=function(i,a){this.mOnConfirm=i,this.mOnClose=a},__decorate([o(cc.Label)],t.prototype,"title",void 0),__decorate([o(cc.Label)],t.prototype,"content",void 0),__decorate([o(cc.Label)],t.prototype,"btnTxt",void 0),__decorate([o(cc.Button)],t.prototype,"confirmButton",void 0),__decorate([o(cc.Button)],t.prototype,"closeButton",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],AwardResultItemPrefabScript:[function(l,P,m){"use strict";cc._RF.push(P,"92053IVOhFHHpaknWZkkSOW","AwardResultItemPrefabScript"),Object.defineProperty(m,"__esModule",{value:!0});var d=cc._decorator,s=d.ccclass,r=d.property,o=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.txt=null,i.icon=null,i}return __extends(t,n),t.prototype.onLoad=function(){},t.prototype.initData=function(i){this.mBean=i,this.refreshUI()},t.prototype.refreshUI=function(){this.mBean&&(this.mBean.spriteFrame&&(this.icon.spriteFrame=this.mBean.spriteFrame),this.mBean.number&&(this.txt.string="x"+this.mBean.number))},__decorate([r(cc.Label)],t.prototype,"txt",void 0),__decorate([r(cc.Sprite)],t.prototype,"icon",void 0),t=__decorate([s],t)}(cc.Component);m.default=o;var e=function(n,t){this.number=n,this.spriteFrame=t};m.AwardResultItemBean=e,cc._RF.pop()},{}],BIReportI:[function(l,P,m){"use strict";cc._RF.push(P,"47194KaispGaKviKqp5HzjF","BIReportI"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../util/Dictionary"),s=l("./Infoc"),r=l("../base/Log"),o=function(){function e(){this.mMap=new d.Dictionary}return e.convertNetwokType=function(n){return n=="wifi"?e.NET_WORK_WIFI:n=="2g"?e.NET_WORK_2G:n=="3g"?e.NET_WORK_3G:n=="4g"?e.NET_WORK_4G:n=="unknown"?e.NET_WORK_UNKONOW:n=="none"?e.NET_WORK_NONE:e.NET_WORK_UNKONOW},e.prototype.set=function(n,t){if(n==null||n==null)throw new Error("key cannot be null or undefined!");return t!=null&&t!=null||r.default.e("value should not be null or undefined!"),this.mMap.put(n,t),this},e.prototype.buildDataString=function(){for(var n="business_index="+this.getTableID()+"&",t=this.mMap.size(),i=this.mMap.getPairs(),a=0;a<t;a++){var u=i[a];n+=u.key+"="+u.value+"&"}return 1<n.length&&(n=n.slice(0,n.length-1)),n},e.prototype.reportData=function(n){var t=this;n===void 0&&(n=!1),setTimeout(function(){var i=t.buildDataString();s.Infoc.reportInfoc(i,n)},0)},e.NET_WORK_IGNORE=0,e.NET_WORK_WIFI=1,e.NET_WORK_2G=2,e.NET_WORK_3G=3,e.NET_WORK_4G=4,e.NET_WORK_NONE=99,e.NET_WORK_UNKONOW=100,e}();m.default=o,cc._RF.pop()},{"../base/Log":"Log","../util/Dictionary":"Dictionary","./Infoc":"Infoc"}],BackButton:[function(l,P,m){"use strict";cc._RF.push(P,"be7529lpl1F4bNjXl4tNuHn","BackButton"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../MUI/MUIButton"),s=l("../loader/BeginFrameLoader"),r=l("../../../base/G"),o=l("../../../business/UI/GameEntraScene/GameEntranceScene"),e=l("../../GameSceneSetting"),n=l("../../../business/Logic/GameTryData"),t=l("../../../business/Logic/EventBus"),i=l("../../../business/Logic/NotifyEvent"),a=l("../../GameBus"),u=function(c){function p(){var h=c.call(this,s.default.getInstance().getAtlas(),s.default.getInstance().getBackNormal(),s.default.getInstance().getBackPressed())||this;return h.onTouchListener=h.onTouched,h}return __extends(p,c),p.prototype.updatePosition=function(h){this.setPosition(.028*r.G.Ap.config.presentWidth,h-this.normalImageItem.rect.height)},p.prototype.onTouched=function(){switch(e.default.getInstance().getFromSource()){case e.FromSource.SOURCE_DEFAULT:case e.FromSource.SOURCE_RANK_RESULT:o.default.DefaultPageIndex=o.default.GAME_ENTRA_SCENE_INDEX.MUSIC_LIB_INDEX;break;case e.FromSource.SOURCE_MAIN:case e.FromSource.SOURCE_RANK_MAIN:o.default.DefaultPageIndex=o.default.GAME_ENTRA_SCENE_INDEX.HOMEPAGE_INDEX;break;case e.FromSource.SOURCE_MUSIC:case e.FromSource.SOURCE_RANK_MUSIC:o.default.DefaultPageIndex=o.default.GAME_ENTRA_SCENE_INDEX.MUSIC_LIB_INDEX;break;case e.FromSource.SOURCE_SKIN_TRY:r.G.skinTryData&&(r.G.skinTryData.trySkinFinish=!0),a.default.getInstance().scheduler.scheduleOnce(function(){t.default.fire(i.default.PLAY_TRIAL_FINISHED)},1);case e.FromSource.SOURCE_SONG_TRY:r.G.songTryData&&(r.G.songTryData.songTryFinish=!0);break;case e.FromSource.SOURCE_PIANO_TRY:r.G.tryData&&r.G.tryData.tryType==n.GameTryType.TYPE_PIANO&&(r.G.tryData.tryFinish=!0)}r.G.Ap.presenter.enterScene("MainScene")},p}(d.default);m.default=u,cc._RF.pop()},{"../../../base/G":"G","../../../business/Logic/EventBus":"EventBus","../../../business/Logic/GameTryData":"GameTryData","../../../business/Logic/NotifyEvent":"NotifyEvent","../../../business/UI/GameEntraScene/GameEntranceScene":"GameEntranceScene","../../GameBus":"GameBus","../../GameSceneSetting":"GameSceneSetting","../../MUI/MUIButton":"MUIButton","../loader/BeginFrameLoader":"BeginFrameLoader"}],Background:[function(l,P,m){"use strict";cc._RF.push(P,"24c96Yko1lGu7KWFmdrKD/b","Background"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.prototype.attachSprite=function(r,o){r.active=!0,o.active=!1},s.prototype.load=function(r){return!0},s.prototype.update=function(r){},s.prototype.destroy=function(){},s}();m.default=d,cc._RF.pop()},{}],BannerDelayShowToggle:[function(l,P,m){"use strict";cc._RF.push(P,"795c9OCCZ1D5qCYDPsWeMhT","BannerDelayShowToggle"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ToggleBean"),s=l("./ToggleChecker"),r=l("../util/PU"),o=l("../base/Log"),e=function(){function t(){}return t.getBannerDelayTime=function(i){var a=new n;if(this.isBannerDelayToggle(i)){var u=s.default.ins().getToggle(i);if(u){if(u.platform.includes("all"))return this.handleDelayTime(u);if(u.platform.includes("qq"))return r.default.isQQ()?this.handleDelayTime(u):a;if(u.platform.includes("wx"))return r.default.isWeiXin()?this.handleDelayTime(u):a}}return a},t.handleDelayTime=function(i){var a=new n;return a.normalDelayTime=i.extra&&i.extra.normal?i.extra.normal:0,a.popupDelayTime=i.extra&&i.extra.popup?i.extra.popup:0,o.default.i("BannerDelayShowToggle===> handleDelayTime  toggle = ",i,", delayTime = ",a),a},t.isBannerDelayToggle=function(i){return i==d.ToggleKey.BANNER_DELAY_DAILY_ATTENDANCE||i==d.ToggleKey.BANNER_DELAY_FIGHT_RESULT||i==d.ToggleKey.BANNER_DELAY_LOTTERY_PAGE||i==d.ToggleKey.BANNER_DELAY_NORMAL_RESULT_SHOW_OFF||i==d.ToggleKey.BANNER_DELAY_RELIVE_PAGE||i==d.ToggleKey.BANNER_DELAY_REWARD_PAGE},t}();m.default=e;var n=function(){this.normalDelayTime=0,this.popupDelayTime=0};m.BannerDelayTime=n,cc._RF.pop()},{"../base/Log":"Log","../util/PU":"PU","./ToggleBean":"ToggleBean","./ToggleChecker":"ToggleChecker"}],Banner:[function(l,P,m){"use strict";cc._RF.push(P,"f1078YEtYhKiIFjdv7nck4q","Banner"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../MUI/MUISprite"),s=l("../../../base/G"),r=l("../loader/BeginFrameLoader"),o=function(e){function n(t,i){t===void 0&&(t=null);var a=e.call(this,t)||this;return a.bannerNode=null,a.mainTitle=null,a.subTitle=null,a.adapterY=void 0,a.bannerNode=i,a.addTitleLabel(),a.imageData=r.default.getInstance().getAtlas(),a.imageItem=r.default.getInstance().getBannerBg(),a.initRect(),a}return __extends(n,e),n.prototype.initRect=function(){var t=s.G.Ap.config.presentWidth-20,i=t*this.imageItem.rect.height/this.imageItem.rect.width,a=.93*s.G.Ap.config.presentHeight,u=(this.adapterY||a)-i;this.move(10,u,t,i),this.bannerNode.setAnchorPoint(.5,.5),this.bannerNode.setPosition(-s.G.Ap.config.presentWidth/2+10,-s.G.Ap.config.presentHeight/2+u),this.bannerNode.setContentSize(t,i),this.mainTitle.node.setPosition(t/2,i/2+14),this.subTitle.node.setPosition(t/2,i/2-this.mainTitle.fontSize/2-this.subTitle.fontSize/2-14)},n.prototype.adaptPosition=function(t){this.adapterY=t,this.rect.height!==0&&(this.setPositionY(t-this.rect.height),this.bannerNode.setPositionY(-s.G.Ap.config.presentHeight/2+t-this.rect.height))},n.prototype.addTitleLabel=function(){this.mainTitle=this.createLabel(),this.mainTitle.fontSize=40,this.mainTitle.lineHeight=46,this.bannerNode.addChild(this.mainTitle.node),this.subTitle=this.createLabel(),this.subTitle.node.opacity=180,this.subTitle.fontSize=26,this.subTitle.lineHeight=32,this.bannerNode.addChild(this.subTitle.node)},n.prototype.createLabel=function(){var t=new cc.Node;return t.setAnchorPoint(.5,.5),t.color=new cc.Color(54,91,114),t.addComponent(cc.Label)},n.prototype.show=function(t,i){this.visible=!0,this.bannerNode.active=!0,this.mainTitle.string=t,this.subTitle.string=i},n.prototype.hide=function(){this.visible=!1,this.bannerNode.active=!1},n}(d.default);m.default=o,cc._RF.pop()},{"../../../base/G":"G","../../MUI/MUISprite":"MUISprite","../loader/BeginFrameLoader":"BeginFrameLoader"}],BaseCsvFile:[function(l,P,m){"use strict";cc._RF.push(P,"069eaz7RN1Jspqwv1HSOUMi","BaseCsvFile"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.find=function(o,e){var n=this.csvGetRow(o,e);if(n){var t=this.getRow();if(t)return t.mRowData=n,t.mCsvFile=this,Object.seal(t)}},r.prototype.findId=function(o){return this.find("Id",o)},r.prototype.getRow=function(){return null},r.prototype.getAllData=function(){for(var o=[],e=0,n=this.getAllDB();e<n.length;e++){var t=n[e],i=this.getRow();i&&(i.mRowData=t,i.mCsvFile=this,o.push(i))}return Object.seal(o)},r}(l("./CsvFile").default);m.default=d,cc._RF.pop()},{"./CsvFile":"CsvFile"}],BaseVersionChecker:[function(l,P,m){"use strict";cc._RF.push(P,"e8015zya7hD7oLctfffZ14M","BaseVersionChecker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./IChecker"),s=l("./VersionBean"),r=l("../util/NumberUtil"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.onMergeServerToLocal=function(t,i){},n.prototype.validateData=function(t){return t!=null&&t!=null},n.prototype.populateServerObj=function(t){if(!t)return null;var i=new s.default;return i.serverVer=d.default.populateStr(t.ver),i.key=d.default.populateStr(t.key),i.url=d.default.populateStr(t.url),i.md5=d.default.populateStr(t.md5),i.type=d.default.populateStr(t.type),i.size=r.default.parseNum(t.size),i.enableTime=r.default.parseNum(t.enableTime),i.endTime=r.default.parseNum(t.endTime),i.platform=d.default.populateStr(t.platform),i},n.prototype.populateLocalObj=function(t){return s.default.parseFromJson(t)},n}(d.default);m.default=o,cc._RF.pop()},{"../util/NumberUtil":"NumberUtil","./IChecker":"IChecker","./VersionBean":"VersionBean"}],BasicHelperCM:[function(l,P,m){"use strict";cc._RF.push(P,"8b21bUrf2tN5qWLcVYrdM/5","BasicHelperCM"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGBasicHelper"),s=l("../../../MGUtils/TypeDefinition"),r=l("../LocalStorageHelplerWeb"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.setStorage=function(t,i){return r.LocalStorageHelperWeb.setItem(t,i),!0},n.prototype.getStorage=function(t){return r.LocalStorageHelperWeb.getItem(t)},n.prototype.delStorage=function(t){return r.LocalStorageHelperWeb.removeItem(t),!0},n.prototype.getLaunchParameter=function(){return new s.LaunchOption},n.prototype.navigateToMiniProgram=function(t){},n.prototype.readFile=function(t){t.complete&&t.complete(!1,null),t.fail&&t.fail(-1,null)},n}(d.default);m.BasicHelperCM=o,cc._RF.pop()},{"../../../MGUtils/TypeDefinition":"TypeDefinition","../LocalStorageHelplerWeb":"LocalStorageHelplerWeb","../Logic/MGBasicHelper":"MGBasicHelper"}],BasicHelperFB:[function(l,P,m){"use strict";cc._RF.push(P,"70e145uAo1Bgp+9vCw0nzYs","BasicHelperFB"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGBasicHelper"),s=l("../../../MGUtils/TypeDefinition"),r=l("../../../MGUtils/FBHelper"),o=l("../LocalStorageHelplerWeb"),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.setStorage=function(i,a){return o.LocalStorageHelperWeb.setItem(i,a),!0},t.prototype.getStorage=function(i){return o.LocalStorageHelperWeb.getItem(i)},t.prototype.delStorage=function(i){return o.LocalStorageHelperWeb.removeItem(i),!0},t.prototype.getLaunchParameter=function(){var i=new s.LaunchOption,a=r.FBHelper.getEntryPointData();return a&&(i.query=a),i},t.prototype.readFile=function(i){i.complete&&i.complete(!1,null),i.fail&&i.fail(-1,null)},t.prototype.navigateToMiniProgram=function(i){},t.prototype.getChannelId=function(){return""},t}(d.default);m.BasicHelperFB=e,cc._RF.pop()},{"../../../MGUtils/FBHelper":"FBHelper","../../../MGUtils/TypeDefinition":"TypeDefinition","../LocalStorageHelplerWeb":"LocalStorageHelplerWeb","../Logic/MGBasicHelper":"MGBasicHelper"}],BasicHelperQQ:[function(l,P,m){"use strict";cc._RF.push(P,"ae39fislklHSYmcXVZnCo+i","BasicHelperQQ"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGBasicHelper"),s=l("../../../MGUtils/QQHelper"),r=l("../../../MGUtils/TypeDefinition"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.setStorage=function(t,i){return s.QQHelper.setStorage(t,i),!0},n.prototype.getStorage=function(t){return s.QQHelper.getStorage(t)},n.prototype.delStorage=function(t){return s.QQHelper.delStorage(t),!0},n.prototype.getLaunchParameter=function(){var t=new r.LaunchOption,i=GameStatusInfo.gameParam;if(i){for(var a={},u=(i[0]==="?"?i.substr(1):i).split("&"),c=0;c<u.length;c++){var p=u[c].split("=");a[decodeURIComponent(p[0])]=decodeURIComponent(p[1]||"")}t.query=a}return t.shareTicket=GameStatusInfo.aioType.toString(),t.scene=GameStatusInfo.src,t},n.prototype.readFile=function(t){try{var i=BK.FileUtil.readFile(t.filePath).readAsString();t.complete&&t.complete(!0,JSON.parse(i)),t.success&&t.success(JSON.parse(i))}catch(a){t.complete&&t.complete(!1,null),t.fail&&t.fail()}},n.prototype.navigateToMiniProgram=function(t){var i="";for(var a in t.extraData)i+=a+"="+t.extraData[a]+"&";i!=""&&i.substr(9,i.length-1),s.QQHelper.skipGame(parseInt(t.appId),i)},n.prototype.getChannelId=function(){return""},n}(d.default);m.BasicHelperQQ=o,cc._RF.pop()},{"../../../MGUtils/QQHelper":"QQHelper","../../../MGUtils/TypeDefinition":"TypeDefinition","../Logic/MGBasicHelper":"MGBasicHelper"}],BasicHelperWX:[function(l,P,m){"use strict";cc._RF.push(P,"42687BBJ1JBfoIp0LoM2xsG","BasicHelperWX"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGBasicHelper"),s=l("../../../MGUtils/WeappHelper"),r=l("../../../../scripts/business/Network/Protocol/StorageUtil"),o=l("../../../../scripts/config/LSKey"),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.setStorage=function(i,a){return s.WeappHelper.setStorageSync(i,a),!0},t.prototype.getStorage=function(i){return s.WeappHelper.getStorageSync(i)},t.prototype.delStorage=function(i){return s.WeappHelper.removeStorageSync(i),!0},t.prototype.getLaunchParameter=function(){return s.WeappHelper.getLaunchOptionsSync()},t.prototype.readFile=function(i){s.WeappHelper.getFileSystemManager().readFile({filePath:i.filePath,encoding:i.encoding,success:function(a){var u=JSON.parse(a.data);i.complete&&i.complete(!0,u),i.success&&i.success(u)},fail:function(a){i.complete&&i.complete(!1,null),i.success&&i.fail()}})},t.prototype.navigateToMiniProgram=function(i){s.WeappHelper.navigateToMiniProgram(i)},t.prototype.getChannelId=function(){var i=r.default.read(o.default.START_UP_CHANNEL,"");if(i)return i;var a=wx.getLaunchOptionsSync(),u=this.getChannelByAppId(a),c=this.getChannelByExtra(a),p=this.getChannelByOther(a),h=this.getChannelBySrc(a),f="default";return u?f=u:h?f=h:c?f=c:p&&(f=p),r.default.save(o.default.START_UP_CHANNEL,f),f},t.prototype.getChannelByExtra=function(i){return i&&i.query&&i.query.channel&&i.scene?i.query.channel:null},t.prototype.getChannelByOther=function(i){return i&&i.path&&i.path!="index"&&i.path.startsWith("6")?i.path:null},t.prototype.getChannelByAppId=function(i){return i&&i.referrerInfo&&i.referrerInfo.appId?i.referrerInfo.appId:null},t.prototype.getChannelBySrc=function(i){return i&&i.query&&i.query.source?i.query.source:null},t}(d.default);m.BasicHelperWX=e,cc._RF.pop()},{"../../../../scripts/business/Network/Protocol/StorageUtil":"StorageUtil","../../../../scripts/config/LSKey":"LSKey","../../../MGUtils/WeappHelper":"WeappHelper","../Logic/MGBasicHelper":"MGBasicHelper"}],BasicHelperWeb:[function(l,P,m){"use strict";cc._RF.push(P,"14dc2yQkhhEhLdDWUXsUQQP","BasicHelperWeb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGBasicHelper"),s=l("../../../MGUtils/TypeDefinition"),r=l("../LocalStorageHelplerWeb"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.setStorage=function(t,i){return r.LocalStorageHelperWeb.setItem(t,i),!0},n.prototype.getStorage=function(t){return r.LocalStorageHelperWeb.getItem(t)},n.prototype.delStorage=function(t){return r.LocalStorageHelperWeb.removeItem(t),!0},n.prototype.getLaunchParameter=function(){return new s.LaunchOption},n.prototype.readFile=function(t){t.complete&&t.complete(!1,null),t.fail&&t.fail(-1,null)},n.prototype.navigateToMiniProgram=function(t){},n.prototype.getChannelId=function(){return""},n}(d.default);m.BasicHelperWeb=o,cc._RF.pop()},{"../../../MGUtils/TypeDefinition":"TypeDefinition","../LocalStorageHelplerWeb":"LocalStorageHelplerWeb","../Logic/MGBasicHelper":"MGBasicHelper"}],BasicTouchEvent:[function(l,P,m){"use strict";cc._RF.push(P,"98720LZMtpGz42qwrXk1s/p","BasicTouchEvent"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../util/SceneMusicUtil"),s=function(){function r(o,e){this.mClickCallback=o,this.mReject=e}return r.prototype.click=function(o){var e=new Date().getTime();Math.abs(e-this.mClickTime)<=500?this.mReject&&this.mReject():(this.mClickTime=e,d.default.playBtnBeats(),this.mClickCallback&&this.mClickCallback(o))},r.prototype.clickBeatsLast=function(o){var e=new Date().getTime();Math.abs(e-this.mClickTime)<=500?this.mReject&&this.mReject():(this.mClickTime=e,this.mClickCallback&&this.mClickCallback(o),d.default.playBtnBeats())},r}();m.default=s,cc._RF.pop()},{"../../../util/SceneMusicUtil":"SceneMusicUtil"}],BattleDataConfig:[function(l,P,m){"use strict";cc._RF.push(P,"bdde4VAaZdKh553rHKLbcnK","BattleDataConfig"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(r,o){this.property=r.clone(),this.weight=o,this.rate=0};m.BattleDataCandidataProperty=d;var s=function(){function r(){this.comboLevels=[],this.energeLevels=[],this.feverThreshold=200,this.feverDuration=8,this.beginningCountDown=3,this.playingCountDown=30,this.startSpeed=0,this.endSpeed=0,this.increasePecentage=0,this.deductPercentage=0,this.baseBeats=0,this.startPutPropertySecond=0,this.intervalPutPropertySecond=0,this.intervalRetrySecond=0,this.startPutPropertyRate=0,this.increasePutPropertyRate=0,this.candidateProperties=[]}return r.prototype.normalizeCandidateProperties=function(){for(var o=0,e=0,n=this.candidateProperties.length;e<n;++e)o+=this.candidateProperties[e].weight;for(o===0&&(o=1),e=0,n=this.candidateProperties.length;e<n;++e){var t=this.candidateProperties[e];t.rate=t.weight/o}},r.MIN_COMBO_NUMBER=3,r.OBSTACLE_BLOCK_INTERVAL=2,r}();m.BattleDataConfig=s,cc._RF.pop()},{}],BattleDataDefines:[function(l,P,m){"use strict";var d,s,r,o;cc._RF.push(P,"0ac9dZUY0BHR6VJEw2mKUSZ","BattleDataDefines"),Object.defineProperty(m,"__esModule",{value:!0}),d=m.BattleDataDefines||(m.BattleDataDefines={}),(s=d.GameProgress||(d.GameProgress={}))[s.START=0]="START",s[s.END=1]="END",(r=d.PlayerState||(d.PlayerState={}))[r.NORMAL=0]="NORMAL",r[r.FEVER=1]="FEVER",r[r.CONTROL=2]="CONTROL",(o=d.TouchState||(d.TouchState={}))[o.COMBO=0]="COMBO",o[o.MISS=1]="MISS",cc._RF.pop()},{}],BattleDataMain:[function(l,P,m){"use strict";cc._RF.push(P,"b58ddzfyglN57vzU095VB1j","BattleDataMain"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BattleDataPlayer"),s=l("./BattleDataConfig"),r=l("../../../base/G"),o=l("../../../property/PropertyDefines"),e=l("./BattleDataRunning"),n=l("../../../business/DB/DBMgr"),t=function(){function i(a){this.selfData=new d.default,this.opponentData=new d.default,this.configData=new s.BattleDataConfig,this.runningData=new e.default,this.robot=a}return i.prototype.initialize=function(){this.readComboInfo(),this.readMusicInfo(),this.readPutPropertyInfo(),this.robot||this.readProperties()},i.prototype.getSelf=function(){return this.selfData},i.prototype.getOpponent=function(){return this.opponentData},i.prototype.getConfig=function(){return this.configData},i.prototype.getRunning=function(){return this.runningData},i.prototype.readProperties=function(){var a=r.G.Ap.state;this.selfData.carryProperties.copy(a.carryProperties),a.carryProperties.clear();for(var u=this.getRunning(),c=this.selfData.carryProperties.getPairs(),p=0,h=c.length;p<h;++p){var f=c[p].value;u.carryPropertyCount+=f.count}},i.prototype.readComboInfo=function(){for(var a=n.default.Ins().getData(n.eDataBase.eDB_FightComboRule).getAllDB(),u=0,c=a.length;u<c;++u){var p=a[u],h=parseInt(p[1]);Number.isNaN(h)&&(h=0),this.configData.comboLevels.push(h);var f=parseFloat(p[2]);Number.isNaN(f)&&(f=0),this.configData.energeLevels.push(f)}},i.prototype.readMusicInfo=function(){var a=r.G.Ap.state.getMission();console.error("BattleDataMain  readMusicInfo, matchType=>"+a.getType()),this.configData.beginningCountDown=a.beginningCountDown,this.configData.playingCountDown=a.playingCountDown,this.configData.baseBeats=a.baseBeats,this.configData.startSpeed=a.startSpeed,this.configData.endSpeed=a.endSpeed,this.configData.deductPercentage=a.deductPercentage,this.configData.increasePecentage=a.increasePecentage},i.prototype.readPutPropertyInfo=function(){this.configData.startPutPropertySecond=20,this.configData.intervalPutPropertySecond=20,this.configData.intervalRetrySecond=5,this.configData.startPutPropertyRate=.3,this.configData.increasePutPropertyRate=.1,this.configData.candidateProperties.push(new s.BattleDataCandidataProperty(new o.Property(o.PROPERTYTYPE.GAME_FOG),1)),this.configData.candidateProperties.push(new s.BattleDataCandidataProperty(new o.Property(o.PROPERTYTYPE.GAME_OBSTACLE),1)),this.configData.normalizeCandidateProperties()},i}();m.default=t,cc._RF.pop()},{"../../../base/G":"G","../../../business/DB/DBMgr":"DBMgr","../../../property/PropertyDefines":"PropertyDefines","./BattleDataConfig":"BattleDataConfig","./BattleDataPlayer":"BattleDataPlayer","./BattleDataRunning":"BattleDataRunning"}],BattleDataPlayer:[function(l,P,m){"use strict";cc._RF.push(P,"aa24b2ZimJIT5R4wZVGgUDs","BattleDataPlayer"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../util/Dictionary"),s=l("../../../property/PropertyDefines"),r=l("../../../base/State"),o=l("./BattleDataDefines"),e=l("../../../business/Logic/GameItemsManager"),n=function(){function t(){this.reset()}return t.prototype.reset=function(){this.state=o.BattleDataDefines.PlayerState.NORMAL,this.touchState=o.BattleDataDefines.TouchState.COMBO,this.comboNumber=0,this.maxComboNumber=0,this.energy=0,this.score=0,this.win=!1,this.carryProperties=new d.Dictionary2(s.Property.compare),this.workingProperties=new d.Dictionary2(s.Property.compare),this.skinID=""},t.prototype.addCarryProperty=function(i,a){a===void 0&&(a=0);var u=this.carryProperties.get(i);u===null&&((u=new r.State_PropertyItem).count=0,u.originCount=0,this.carryProperties.put(i.clone(),u)),u.count+=a,u.originCount+=a},t.prototype.getCarryPropertyCount=function(i){var a=this.carryProperties.get(i);return a===null?0:a.count},t.prototype.removeCarryProperty=function(i){this.carryProperties.remove(i)},t.prototype.consumeCarryProperty=function(i){var a=this.carryProperties.get(i);return!(a===null||a.count<=0)&&(a.count--,!0)},t.prototype.getCarryProperties=function(){for(var i=[],a=this.carryProperties.getPairs(),u=0,c=a.length;u<c;++u){var p=a[u].key;i.push(p.clone())}return i},t.prototype.isPropertyWorking=function(i){return this.workingProperties.get(i)!==null},t.prototype.startPropertyWork=function(i,a){a===void 0&&(a=!1);var u=this.workingProperties.get(s.Property);u==null?((u=new r.State_PropertyWork).tempory=a,this.workingProperties.put(i.clone(),u)):console.warn("property working, type is "+i.type)},t.prototype.accumulatePropertyWork=function(i){var a=this.workingProperties.get(s.Property);a!==null?a.accumulation=!0:console.warn("property is not working, type is "+i.type)},t.prototype.stopPropertyWork=function(i){this.workingProperties.remove(i)},t.prototype.setSkinID=function(i){this.skinID=i?e.GameItemsManager.getIns().getItemIDByIndexID(i):"5-1-0"},t.prototype.getSkinID=function(){return this.skinID},Object.defineProperty(t.prototype,"comboNumber",{get:function(){return this._comboNumber},set:function(i){i>this.maxComboNumber&&(this.maxComboNumber=i),this._comboNumber=i},enumerable:!0,configurable:!0}),t}();m.default=n,cc._RF.pop()},{"../../../base/State":"State","../../../business/Logic/GameItemsManager":"GameItemsManager","../../../property/PropertyDefines":"PropertyDefines","../../../util/Dictionary":"Dictionary","./BattleDataDefines":"BattleDataDefines"}],BattleDataRunning:[function(l,P,m){"use strict";cc._RF.push(P,"ca0db7nIINDmJz0k+PKCdNj","BattleDataRunning"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.runDuration=0,this.startRunTimestamp=0,this.backgroundTimestamp=0,this.waitEndTime=0,this.waitStartTime=0,this.releasePropertyCount=0,this.sufferPropertyCount=0,this.savePropertyCount=0,this.carryPropertyCount=0,this.missTimes=0,this.feverTimes=0};m.default=d,cc._RF.pop()},{}],BattleGameSceneViewImpl:[function(l,P,m){"use strict";cc._RF.push(P,"425319C/nxMPoq/yuCL8n7/","BattleGameSceneViewImpl"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./IBattleGameSceneView"),s=l("../MUI/MUINode"),r=l("../element/component/MUINumber"),o=l("../element/loader/NumberFrameLoader"),e=l("../MUI/MUISprite"),n=l("../element/loader/GameSceneFrameLoader"),t=l("./UiPropertyIconPanel"),i=l("../../property/PropertyDefines"),a=l("../../base/G"),u=l("../animation/action/MActionFactory"),c=l("../GameBus"),p=l("../MUI/MUIProgressBar"),h=l("../MUI/MUINineScaleSprite"),f=l("../animation/action/MScaleTo"),g=l("../animation/action/MSequence"),_=l("../element/node/MUINodePool"),y=l("../animation/action/MMoveBy"),S=l("../animation/action/MFadeTo"),I=l("../animation/action/MCallFunc"),v=l("../atlas/SimpleAtlas"),C=l("../../util/Utility"),T=l("../../util/SceneMusicMgr"),E=l("../element/loader/BeginFrameLoader"),A=function(){function M(){this.uiBoard=null,this.battleLayerRootNode=null,this.waitingLabel=null,this.fanaticalImageNode=null,this.beginningCountDownLabel=null,this.beginningReadyNode=null,this.beginningGoNode=null,this.playingCountDownLabel=null,this.playingTimeUpNode=null,this.selfPropertyPlayNode=null,this.opponentPropertyPlayNode=null,this.selfPropertyProtectPlayNode=null,this.selfDescriptionProtectNode=null,this.selfDescriptionNode=null,this.selfHeadNode=null,this.opponentHeadNode=null,this.selfPropertyIconPanel=null,this.opponentPropertyIconPanel=null,this.propertyEffectNode=null,this.propertyFogEffectNode=null,this.enemyOfflineNode=null,this.commonEffectNode=null,this.topPercent=null,this.opponentDestPosition=null,this.selfDestPosition=null,this.opponentRepeatAction=null,this.opponentRepeatAttackAction=null,this.selfFeverRepeatAction=null,this.opponentFeverRepeatAction=null,this.selfHeadScoreAcion=null,this.opponentHeadScoreAcion=null,this.selfHeadStateMissAction=null,this.opponentHeadStateMissAction=null,this.selfHeadStateComboAction=null,this.opponentHeadStateComboAction=null,this.playcountDownAction=null,this.missEffectNodePool=null,this.selfHeadIconAtlas=null,this.opponentHeadIconAtlas=null,this.selfScore=null,this.opponentScore=null,this.skinTipsNode=null,this.missBackground=null,this.feverBackground=null,this.uiBoard=null,this.battleLayerRootNode=null,this.battleLayerRootNode=null,this.beginningCountDownLabel=null,this.beginningReadyNode=null,this.beginningGoNode=null,this.playingCountDownLabel=null,this.playingTimeUpNode=null,this.selfHeadNode=null,this.opponentHeadNode=null,this.selfPropertyPlayNode=null,this.opponentPropertyPlayNode=null,this.selfPropertyProtectPlayNode=null,this.selfDescriptionProtectNode=null,this.selfDescriptionNode=null,this.propertyFogEffectNode=null,this.propertyEffectNode=null,this.selfPropertyIconPanel=new t.UiPropertyIconPanel,this.opponentPropertyIconPanel=new t.UiPropertyIconPanel,this.topPercent=.9,this.opponentDestPosition=cc.v2(0,0),this.selfDestPosition=cc.v2(0,0),this.opponentRepeatAction=null,this.opponentRepeatAttackAction=null,this.selfFeverRepeatAction=null,this.opponentFeverRepeatAction=null,this.selfHeadScoreAcion=null,this.opponentHeadScoreAcion=null,this.selfHeadStateMissAction=null,this.opponentHeadStateMissAction=null,this.playcountDownAction=null,this.commonEffectNode=null,this.missEffectNodePool=null,this.selfHeadIconAtlas=new v.default,this.opponentHeadIconAtlas=new v.default,this.selfScore=0,this.opponentScore=0,this.missBackground=null,this.feverBackground=null}return M.prototype.create=function(k){this.uiBoard=k,this.createHeadIconAtlas(),this.createBattleLayer(),this.createMissRedNode(),this.createFeverBackgroundNode(),this.createPropertyEffectNode(),this.createBattleBkg(),this.createBeginningCountDownUI(),this.createSelfHeadUI(),this.createOpponentHeadUI(),this.createPropertyPlayNode(),this.createPropertyProtectPlayNode(),this.createPlayingCountDownUI(),this.createWaitingUI(),this.createEnemyOfflineUI(),this.createCommonEffectNode(),this.createOpponentSkinEffectUI(),this.calcPropertyPlayDestPosition()},M.prototype.destroy=function(){this.destroyAtlas()},M.prototype.showWaittingLabel=function(k){this.waitingLabel.getChildByIndex(0).setVisible(k),this.waitingLabel.getChildByIndex(1).setVisible(k)},M.prototype.updateWaitingLabel=function(k){this.waitingLabel.getChildByIndex(0).setVisible(!1),this.waitingLabel.getChildByIndex(1).setVisible(!1),k==d.BattleGameSceneViewWaitingType.START?this.waitingLabel.getChildByIndex(0).setVisible(!0):this.waitingLabel.getChildByIndex(1).setVisible(!0)},M.prototype.showBeginningCountDownLabel=function(k){this.beginningCountDownLabel.setVisible(k)},M.prototype.updateBeginningCountDownLabel=function(k){this.beginningCountDownLabel.setNumberValue(k),0<k&&k<4&&T.default.play(T.default.NAME_COUNT_DOWN,T.default.PATH_COUNT_DOWN,!1)},M.prototype.showBeginningReady=function(k,D){if(this.beginningReadyNode.setVisible(k),D)if(k){this.beginningReadyNode.setScale(1.8,1.8),this.beginningReadyNode.setOpacity(0);var L=u.default.instance.createMScaleTo(1,1,.25),b=u.default.instance.createMFadeTo(1,.25),N=u.default.instance.createMSpawn(L,b);c.default.getInstance().getAnimationMgr().runAction(this.beginningReadyNode,N),T.default.play(T.default.NAME_READY,T.default.PATH_READY,!1)}else b=u.default.instance.createMFadeTo(0,.3),c.default.getInstance().getAnimationMgr().runAction(this.beginningReadyNode,b)},M.prototype.showBeginningGo=function(k,D){if(this.beginningGoNode.setVisible(k),D)if(k){this.beginningGoNode.setScale(1.8,1.8),this.beginningGoNode.setOpacity(0);var L=u.default.instance.createMScaleTo(1,1,.25),b=u.default.instance.createMFadeTo(1,.25),N=u.default.instance.createMSpawn(L,b);c.default.getInstance().getAnimationMgr().runAction(this.beginningGoNode,N),T.default.play(T.default.NAME_START_GO,T.default.PATH_START_GO,!1)}else b=u.default.instance.createMFadeTo(0,.3),c.default.getInstance().getAnimationMgr().runAction(this.beginningGoNode,b)},M.prototype.showPlayingCountDownLabel=function(k){this.playingCountDownLabel.setVisible(k)},M.prototype.updatePlayingCountDownLabel=function(k){if(this.playingCountDownLabel.setNumberValue(k),k==6&&this.playingCountDownLabel.setNumberColor(r.NumberColor.GOSMALL),k<=5){if(T.default.play(T.default.NAME_COUNT_DOWN,T.default.PATH_COUNT_DOWN,!1),!this.playcountDownAction){var D=u.default.instance.createMScaleTo(1,1,.3),L=u.default.instance.createMFadeTo(1,.3),b=u.default.instance.createMSpawn(D,L);this.playcountDownAction=b}this.playcountDownAction.getTarget()===this.playingCountDownLabel||(this.playingCountDownLabel.setScale(1.4,1.4),this.playingCountDownLabel.setOpacity(0),c.default.getInstance().getAnimationMgr().runAction(this.playingCountDownLabel,this.playcountDownAction))}},M.prototype.showPlayingTimeup=function(k,D){if(this.playingTimeUpNode.setVisible(k),D)if(k){T.default.play(T.default.NAME_TIME_UP,T.default.PATH_TIME_UP,!1),this.playingTimeUpNode.setScale(1.4,1.4),this.playingTimeUpNode.setOpacity(0);var L=u.default.instance.createMScaleTo(1,1,.3),b=u.default.instance.createMFadeTo(1,.3),N=u.default.instance.createMSpawn(L,b);c.default.getInstance().getAnimationMgr().runAction(this.playingTimeUpNode,N)}else c.default.getInstance().getAnimationMgr().stopTargetActions(this.playingTimeUpNode),b=u.default.instance.createMFadeTo(0,.3),c.default.getInstance().getAnimationMgr().runAction(this.playingTimeUpNode,b)},M.prototype.updateHeadNodeScoreText=function(k,D){var L=this.getHeadNodeById(k),b=null;switch(k){case d.BattleGameSceneViewHeadId.SELF:if(!this.selfHeadScoreAcion){var N=new f.default(1.25,1.25,.1),H=new f.default(1.1,1.1,.2),R=new g.default(N,H);this.selfHeadScoreAcion=R}b=this.selfHeadScoreAcion,this.selfScore=D;break;case d.BattleGameSceneViewHeadId.OPPONENT:this.opponentHeadScoreAcion||(N=new f.default(1.25,1.25,.1),H=new f.default(1.1,1.1,.2),R=new g.default(N,H),this.opponentHeadScoreAcion=R),b=this.opponentHeadScoreAcion,this.opponentScore=D}var F=L.getChildByIndex(M.HEAD_CHILD_SCORE).getChildByIndex(0);F.setNumberValue(D),b.getTarget()==F||c.default.getInstance().animationMgr.runAction(F,b)},M.prototype.updateHeadNodeStateEffect=function(k,D,L){var b=this.getHeadNodeById(k).getChildByIndex(M.HEAD_CHILD_STATE),N=b.getChildByIndex(0),H=b.getChildByIndex(1),R=b.getChildByIndex(2);switch(N.setVisible(!1),H.setVisible(!1),R.setVisible(!1),D){case d.BattleGameSceneViewHeadType.MISS:var F=H.getRect();b.setContentSize(F.width,F.height),H.setVisible(!0);var x=null;if(k===d.BattleGameSceneViewHeadId.SELF){if(!this.selfHeadStateMissAction){var U=new f.default(1.6,1.6,.1),B=new f.default(1.15,1.15,.2),Q=new g.default(U,B);this.selfHeadStateMissAction=Q}x=this.selfHeadStateMissAction}else this.opponentHeadStateMissAction||(U=new f.default(1.6,1.6,.1),B=new f.default(1.15,1.15,.2),Q=new g.default(U,B),this.opponentHeadStateMissAction=Q),x=this.opponentHeadStateMissAction;x.getTarget()||c.default.getInstance().animationMgr.runAction(H,x);break;case d.BattleGameSceneViewHeadType.COMBO:b.setContentSize(181,15),N.setVisible(!0),R.setNumberValue(L),R.setVisible(!0),x=null,k===d.BattleGameSceneViewHeadId.SELF?(this.selfHeadStateComboAction||(U=new f.default(1.2,1.2,.1),B=new f.default(1,1,.2),Q=new g.default(U,B),this.selfHeadStateComboAction=Q),x=this.selfHeadStateComboAction):(this.opponentHeadStateComboAction||(U=new f.default(1.2,1.2,.1),B=new f.default(1,1,.2),Q=new g.default(U,B),this.opponentHeadStateComboAction=Q),x=this.opponentHeadStateComboAction),x.getTarget()||c.default.getInstance().animationMgr.runAction(R,x)}},M.prototype.updateHeadNodeStateText=function(k,D,L){this.updateHeadNodeStateEffect(k,D,L)},M.prototype.updateHeadNodeFever=function(k,D,L,b){var N=this.getHeadNodeById(k),H=null;if(k===d.BattleGameSceneViewHeadId.SELF){if(this.selfFeverRepeatAction===null){var R=u.default.instance.createMFadeTo(.3,.333),F=u.default.instance.createMFadeTo(1,.333),x=u.default.instance.createMSequence(R,F);this.selfFeverRepeatAction=x}H=this.selfFeverRepeatAction}else this.opponentFeverRepeatAction===null&&(R=u.default.instance.createMFadeTo(.3,.333),F=u.default.instance.createMFadeTo(1,.333),x=u.default.instance.createMSequence(R,F),this.opponentFeverRepeatAction=x),H=this.opponentFeverRepeatAction;var U=N.getChildByIndex(M.HEAD_CHILD_FEVER_PROGRESSBAR);if(D)N.getChildByIndex(M.HEAD_CHILD_PROGRESSBAR).setVisible(!1),N.getChildByIndex(M.HEAD_CHILD_FEVER).setVisible(!0),U.setOpacity(1),U.setVisible(!0),H.getTarget()===U||c.default.getInstance().getAnimationMgr().runActionRepeat(U,H),k==d.BattleGameSceneViewHeadId.SELF&&(T.default.play(T.default.NAME_FANASTICAL,T.default.PATH_FANASTICAL,!1),this.fanaticalImageNode.setVisible(!0)),k==d.BattleGameSceneViewHeadId.SELF&&this.feverBackground.setVisible(!0);else if(L)N.getChildByIndex(M.HEAD_CHILD_PROGRESSBAR).setVisible(!0),N.getChildByIndex(M.HEAD_CHILD_FEVER).setVisible(!1),U.setVisible(!1),c.default.getInstance().getAnimationMgr().stopAction(H),(B=N.getChildByIndex(M.HEAD_CHILD_SCORE).getChildByIndex(1)).setVisible(!1),k==d.BattleGameSceneViewHeadId.SELF&&(this.fanaticalImageNode.setVisible(!1),this.feverBackground.setVisible(!1));else{U.setProgress(1-b);var B=N.getChildByIndex(M.HEAD_CHILD_SCORE).getChildByIndex(1),Q=this.selfScore;k==d.BattleGameSceneViewHeadId.OPPONENT&&(Q=this.opponentScore),B.setVisible(Q<1e3)}},M.prototype.updateHeadNodeEnergy=function(k,D){this.getHeadNodeById(k).getChildByIndex(M.HEAD_CHILD_PROGRESSBAR).setProgress(D)},M.prototype.updatePropertyIconPanel=function(k,D){var L=null;L=k==d.BattleGameSceneViewHeadId.SELF?this.selfPropertyIconPanel:this.opponentPropertyIconPanel;var b=0;b=D.getCarryPropertyCount(new i.Property(i.PROPERTYTYPE.GAME_AVOID)),L.avoid.root.setVisible(0<b),L.avoid.showNormal(),b=D.getCarryPropertyCount(new i.Property(i.PROPERTYTYPE.GAME_CONVERSION)),L.conversion.root.setVisible(0<b),L.conversion.showNormal(),b=D.getCarryPropertyCount(new i.Property(i.PROPERTYTYPE.GAME_FANATICAL)),L.fanatical.root.setVisible(0<b),L.fanatical.showNormal(),L.rearrange()},M.prototype.updatePropertyIconPanelSingle=function(k,D,L){var b=null;b=k==d.BattleGameSceneViewHeadId.SELF?this.selfPropertyIconPanel:this.opponentPropertyIconPanel;var N=0;L.type==i.PROPERTYTYPE.GAME_AVOID?(N=D.getCarryPropertyCount(new i.Property(i.PROPERTYTYPE.GAME_AVOID)),b.avoid.root.setVisible(0<N),b.avoid.showNormal()):L.type==i.PROPERTYTYPE.GAME_CONVERSION?(N=D.getCarryPropertyCount(new i.Property(i.PROPERTYTYPE.GAME_CONVERSION)),b.conversion.root.setVisible(0<N),b.conversion.showNormal()):L.type==i.PROPERTYTYPE.GAME_FANATICAL&&(N=D.getCarryPropertyCount(new i.Property(i.PROPERTYTYPE.GAME_FANATICAL)),b.fanatical.root.setVisible(0<N),b.fanatical.showNormal()),b.rearrange()},M.prototype.propertyStart=function(k,D){var L=(k==d.BattleGameSceneViewHeadId.SELF?this.selfPropertyIconPanel:this.opponentPropertyIconPanel).getProperty(D.type);L!=null&&L.showActive()},M.prototype.propertyEnd=function(k,D){var L=(k==d.BattleGameSceneViewHeadId.SELF?this.selfPropertyIconPanel:this.opponentPropertyIconPanel).getProperty(D.type);L!=null&&L.showNormal()},M.prototype.showFog=function(k){if(k==1){this.propertyEffectNode.getRect();var D=new s.default("Fog");this.propertyEffectNode.addChild(D);var L=n.default.getInstance().getAtlas2(),b=new e.default("fog");return b.setOpacity(255),b.imageItem=L.getItem("fog"),b.imageData=L,b.setContentSize(a.G.Ap.config.presentWidth,a.G.Ap.config.presentHeight),b.setPosition(0,0),D.addChild(b),void(this.propertyFogEffectNode=D)}this.propertyFogEffectNode!=null&&this.propertyFogEffectNode.removeFromParent()},M.prototype.displayReleasePropertyAction=function(k,D,L,b){var N=this;if(k){var H=n.default.getInstance().getAtlas();if(this.opponentPropertyPlayNode.setVisible(!0),this.opponentPropertyPlayNode.setOpacity(1),this.opponentPropertyPlayNode.setScale(1,1),this.opponentPropertyPlayNode.setImageItem(H.getItem("propertyicon"+D.type)),this.opponentPropertyPlayNode.setPosition(L.x-M.ICON_SIZE/2,L.y-M.ICON_SIZE/2),c.default.getInstance().getAnimationMgr().stopTargetActions(this.opponentPropertyPlayNode),this.opponentRepeatAction===null){var R=u.default.instance.createMScaleTo(1.2,1.2,.5),F=u.default.instance.createMScaleTo(1,1,1),x=u.default.instance.createMSequence(R,F);this.opponentRepeatAction=x}var U=u.default.instance.createMMoveTo(this.opponentDestPosition.x,this.opponentDestPosition.y,b),B=u.default.instance.createMCallFuncAction(function(){c.default.getInstance().getAnimationMgr().runActionRepeat(N.opponentPropertyPlayNode,N.opponentRepeatAction)}),Q=u.default.instance.createMSequence(U,B);c.default.getInstance().getAnimationMgr().runAction(this.opponentPropertyPlayNode,Q),(z=this.opponentHeadNode.getChildByIndex(M.HEAD_CHILD_ICON)).getChildByIndex(1).setVisible(!0),this.opponentRepeatAttackAction==null&&(this.opponentRepeatAttackAction=n.default.getInstance().getAnimations("headportnit_idle")),c.default.getInstance().getAnimationMgr().stopTargetActions(z),c.default.getInstance().getAnimationMgr().runActionRepeat(z,this.opponentRepeatAttackAction),T.default.play(T.default.NAME_PROP_DROP,T.default.PATH_PROP_DROP,!1)}else{if(this.opponentPropertyPlayNode.getVisible()){c.default.getInstance().getAnimationMgr().stopTargetActions(this.opponentPropertyPlayNode);var Z=u.default.instance.createMFadeTo(0,.3);B=u.default.instance.createMCallFuncAction(function(){N.opponentPropertyPlayNode.setVisible(!1)}),Q=u.default.instance.createMSequence(Z,B),c.default.getInstance().getAnimationMgr().runAction(this.opponentPropertyPlayNode,Q)}var z;(z=this.opponentHeadNode.getChildByIndex(M.HEAD_CHILD_ICON)).getChildByIndex(1).setVisible(!1),c.default.getInstance().getAnimationMgr().stopTargetActions(z)}},M.prototype.displayProtectPropertyAction=function(k,D,L){var b=this;if(k){var N=n.default.getInstance().getAtlas();this.selfPropertyProtectPlayNode.setVisible(!0),this.selfPropertyProtectPlayNode.setOpacity(0),this.selfPropertyProtectPlayNode.setScale(0,0),this.selfPropertyProtectPlayNode.setPosition(this.selfDestPosition.x,this.selfDestPosition.y),this.selfPropertyProtectPlayNode.setImageItem(N.getItem("propertyicon"+D.type)),c.default.getInstance().getAnimationMgr().stopTargetActions(this.selfPropertyProtectPlayNode);var H=u.default.instance.createMScaleTo(1,1,L),R=u.default.instance.createMFadeTo(1,L),F=u.default.instance.createMSpawn(H,R);c.default.getInstance().getAnimationMgr().runAction(this.selfPropertyProtectPlayNode,F);var x=u.default.instance.createMDelayAction(2),U=u.default.instance.createMCallFuncAction(function(){b.displayProtectPropertyAction(!1,null,a.G.Ap.config.releasePropertyAnimDuration)}),B=u.default.instance.createMSequence(x,U);c.default.getInstance().getAnimationMgr().runAction(this.selfPropertyProtectPlayNode,B),this.selfDescriptionProtectNode.setVisible(!1);var Q=u.default.instance.createMDelayAction(L),Z=u.default.instance.createMCallFuncAction(function(){b.selfDescriptionProtectNode.setVisible(!0)}),z=u.default.instance.createMSequence(Q,Z);c.default.getInstance().getAnimationMgr().runAction(this.selfDescriptionProtectNode,z);var W=n.default.getInstance().getAtlas();if(D.type==i.PROPERTYTYPE.GAME_AVOID){this.selfDescriptionProtectNode.imageData=W,this.selfDescriptionProtectNode.imageItem=W.getItem("protect_attack");var V=this.selfDescriptionProtectNode.imageItem.rect.width,Y=this.selfDescriptionProtectNode.imageItem.rect.height;this.selfDescriptionProtectNode.move(-1*(V-this.selfPropertyProtectPlayNode.getRect().width)/2,-1*Y,V,Y)}else D.type==i.PROPERTYTYPE.GAME_CONVERSION?(this.selfDescriptionProtectNode.imageData=W,this.selfDescriptionProtectNode.imageItem=W.getItem("protect_miss"),V=this.selfDescriptionProtectNode.imageItem.rect.width,Y=this.selfDescriptionProtectNode.imageItem.rect.height,this.selfDescriptionProtectNode.move(-1*(V-this.selfPropertyProtectPlayNode.getRect().width)/2,-1*Y,V,Y)):(this.selfDescriptionProtectNode.imageData=W,this.selfDescriptionProtectNode.imageItem=W.getItem("protect_fanatical"),V=this.selfDescriptionProtectNode.imageItem.rect.width,Y=this.selfDescriptionProtectNode.imageItem.rect.height,this.selfDescriptionProtectNode.move(-1*(V-this.selfPropertyProtectPlayNode.getRect().width)/2,-1*Y,V,Y))}else this.selfPropertyProtectPlayNode.getVisible()&&(c.default.getInstance().getAnimationMgr().stopTargetActions(this.selfPropertyProtectPlayNode),R=u.default.instance.createMFadeTo(0,L),Z=u.default.instance.createMCallFuncAction(function(){b.selfPropertyProtectPlayNode.setVisible(!1)}),F=u.default.instance.createMSequence(R,Z),c.default.getInstance().getAnimationMgr().runAction(this.selfPropertyProtectPlayNode,F))},M.prototype.displaySufferPropertyAction=function(k,D,L){var b=this;if(k){var N=n.default.getInstance().getAtlas();this.selfPropertyPlayNode.setVisible(!0),this.selfPropertyPlayNode.setOpacity(1),this.selfPropertyPlayNode.setScale(1,1),this.selfPropertyPlayNode.setImageItem(N.getItem("propertyicon"+D.type)),this.selfPropertyPlayNode.setPosition(this.opponentDestPosition.x,this.opponentDestPosition.y),c.default.getInstance().getAnimationMgr().stopTargetActions(this.selfPropertyPlayNode),u.default.instance.createMScaleTo(1,1,L);var H=u.default.instance.createMFadeTo(1,L),R=u.default.instance.createMMoveTo(this.selfDestPosition.x,this.selfDestPosition.y,L),F=u.default.instance.createMSpawn(R);c.default.getInstance().getAnimationMgr().runAction(this.selfPropertyPlayNode,F),this.selfDescriptionNode.setVisible(!1);var x=u.default.instance.createMDelayAction(L),U=u.default.instance.createMCallFuncAction(function(){b.selfDescriptionNode.setVisible(!0)}),B=u.default.instance.createMSequence(x,U);c.default.getInstance().getAnimationMgr().runAction(this.selfDescriptionNode,B);var Q=n.default.getInstance().getAtlas();if(T.default.play(T.default.NAME_PROP_IN,T.default.PATH_PROP_IN,!1),D.type==i.PROPERTYTYPE.GAME_FANATICAL){this.selfDescriptionNode.imageData=Q,this.selfDescriptionNode.imageItem=Q.getItem("occur_fanatical");var Z=this.selfDescriptionNode.imageItem.rect.width,z=this.selfDescriptionNode.imageItem.rect.height;this.selfDescriptionNode.move(-1*(Z-this.selfPropertyPlayNode.getRect().width)/2,-1*z,Z,z)}else D.type==i.PROPERTYTYPE.GAME_FOG?(this.selfDescriptionNode.imageData=Q,this.selfDescriptionNode.imageItem=Q.getItem("occur_fog"),Z=this.selfDescriptionNode.imageItem.rect.width,z=this.selfDescriptionNode.imageItem.rect.height,this.selfDescriptionNode.move(-1*(Z-this.selfPropertyPlayNode.getRect().width)/2,-1*z,Z,z)):(this.selfDescriptionNode.imageData=Q,this.selfDescriptionNode.imageItem=Q.getItem("occur_black"),Z=this.selfDescriptionNode.imageItem.rect.width,z=this.selfDescriptionNode.imageItem.rect.height,this.selfDescriptionNode.move(-1*(Z-this.selfPropertyPlayNode.getRect().width)/2,-1*z,Z,z))}else this.selfPropertyPlayNode.getVisible()&&(c.default.getInstance().getAnimationMgr().stopTargetActions(this.selfPropertyPlayNode),H=u.default.instance.createMFadeTo(0,L),U=u.default.instance.createMCallFuncAction(function(){b.selfPropertyPlayNode.setVisible(!1)}),F=u.default.instance.createMSequence(H,U),c.default.getInstance().getAnimationMgr().runAction(this.selfPropertyPlayNode,F))},M.prototype.displayMissingEffect=function(k,D){if(this.missEffectNodePool){var L=this.missEffectNodePool.get(null,!0);if(L){var b=L.getRect();L.setPosition(k-b.width/2,D);var N=L.getUserData();N&&N.getTarget()===null&&c.default.getInstance().getAnimationMgr().runAction(L,N)}}},M.prototype.showMissBackground=function(k,D){var L=this;if(k==d.BattleGameSceneViewHeadId.SELF){this.missBackground.setVisible(!0),this.missBackground.setOpacity(1);var b=u.default.instance.createMFadeTo(0,.5),N=u.default.instance.createMSpawn(b);c.default.getInstance().getAnimationMgr().runAction(this.missBackground,N);var H=u.default.instance.createMDelayAction(D),R=u.default.instance.createMCallFuncAction(function(){L.missBackground.setVisible(!1)}),F=u.default.instance.createMSequence(H,R);c.default.getInstance().getAnimationMgr().runAction(this.missBackground,F)}},M.prototype.showEnemyOfflineTips=function(k){this.enemyOfflineNode.setVisible(k)},M.prototype.showOpponentSkinTips=function(k){var D=this,L=E.default.getInstance().getAtlas(),b=new e.default("tips");b.setVisible(!0),b.setOpacity(255),b.imageData=L,b.imageItem=L.getItem(k),b.move(23,23,b.imageItem.rect.width,b.imageItem.rect.height),this.skinTipsNode.addChild(b),this.skinTipsNode.setVisible(!0),this.skinTipsNode.setScale(0,0);var N=u.default.instance.createMScaleTo(1.1,1.1,.2),H=u.default.instance.createMScaleTo(1,1,.01),R=u.default.instance.createMScaleTo(0,0,.2),F=u.default.instance.createMDelayAction(2),x=u.default.instance.createMSequence(N,H);c.default.getInstance().getAnimationMgr().runAction(this.skinTipsNode,x);var U=u.default.instance.createMCallFuncAction(function(){D.skinTipsNode.setVisible(!1)}),B=u.default.instance.createMSequence(F,R,U);c.default.getInstance().getAnimationMgr().runAction(this.skinTipsNode,B)},M.prototype.createBattleLayer=function(){var k=this.uiBoard.getRootNode().getChildByName("propertiesEffectNode"),D=this.uiBoard.getRootNode().getChildIndex(k);this.battleLayerRootNode=new s.default,this.uiBoard.getRootNode().insertChild(D,this.battleLayerRootNode)},M.prototype.createBattleBkg=function(){var k=n.default.getInstance().getAtlas(),D=new e.default("BattleBkg");D.setVisible(!0),D.setOpacity(255),D.imageData=k,D.imageItem=k.getItem("battlegamebkg"),D.move(0,this.uiBoard.getHeight()*this.topPercent-114,720,114),this.battleLayerRootNode.addChild(D)},M.prototype.createWaitingUI=function(){var k=n.default.getInstance().getAtlas(),D=new s.default("WatingLabelNode");D.move(this.uiBoard.getWidth()/2,this.uiBoard.getHeight()/2,200,24);var L=new s.default("WatingLabelStart");L.setVisible(!1),D.addChild(L);var b=new s.default("WatingLabelEnd");b.setVisible(!1),D.addChild(b);var N=new e.default("WatingLabelStart1");N.imageData=k,N.imageItem=k.getItem("player_start_1"),N.move(0,0,N.imageItem.rect.width,N.imageItem.rect.height),L.addChild(N);var H=new e.default("WatingLabelStart2");H.imageData=k,H.imageItem=k.getItem("player_start_2"),H.move(N.imageItem.rect.width,0,H.imageItem.rect.width,H.imageItem.rect.height),L.addChild(H),L.move(-1*(N.imageItem.rect.width+H.imageItem.rect.width)/2,0,192,24);var R=new e.default("WatingLabelEnd1");R.imageData=k,R.imageItem=k.getItem("player_end_1"),R.move(0,0,R.imageItem.rect.width,R.imageItem.rect.height),b.addChild(R);var F=new e.default("WatingLabelEnd2");F.imageData=k,F.imageItem=k.getItem("player_start_2"),F.move(R.imageItem.rect.width,0,F.imageItem.rect.width,F.imageItem.rect.height),b.addChild(F),b.move(-1*(R.imageItem.rect.width+F.imageItem.rect.width)/2,0,192,24),this.battleLayerRootNode.addChild(D),this.waitingLabel=D},M.prototype.createEnemyOfflineUI=function(){var k=n.default.getInstance().getAtlas(),D=new e.default("Offline");D.setVisible(!1),D.setOpacity(255),D.imageData=k,D.imageItem=k.getItem("enemyOffline"),D.move(this.uiBoard.getWidth()/2-190,this.uiBoard.getHeight()/2-57,D.imageItem.rect.width,D.imageItem.rect.height),this.battleLayerRootNode.addChild(D),this.enemyOfflineNode=D},M.prototype.createBeginningCountDownUI=function(){var k=n.default.getInstance().getAtlas(),D=new e.default("ReadyGo");D.setVisible(!1),D.setOpacity(255),D.imageData=k,D.imageItem=k.getItem("ready"),D.move(this.uiBoard.getWidth()/2-267+55,this.uiBoard.getHeight()/2-57,423,116),this.battleLayerRootNode.addChild(D),this.beginningReadyNode=D;var L=new e.default("BeginningGO");L.setVisible(!1),L.setOpacity(255),L.imageData=k,L.imageItem=k.getItem("go"),L.move(this.uiBoard.getWidth()/2-133.5,this.uiBoard.getHeight()/2-57,267,116),this.battleLayerRootNode.addChild(L),this.beginningGoNode=L},M.prototype.createPlayingCountDownUI=function(){var k=new r.default(o.default.getInstance().getAtlas(),3,"PlayingCoundDownLabel");k.setNumberColor(r.NumberColor.YELLOWSMALL),k.setNumberSize(40,55),k.setHAlineType(r.default.HCENTER,!0),k.move(this.uiBoard.getWidth()/2-200,this.uiBoard.getHeight()*this.topPercent-55-15-1,400,55),k.setNumberValue(180),k.setVisible(!1),this.battleLayerRootNode.addChild(k),this.playingCountDownLabel=k;var D=n.default.getInstance().getAtlas(),L=new e.default("PlayingTimeUp");L.setVisible(!1),L.setOpacity(255),L.imageData=D,L.imageItem=D.getItem("timeup"),L.move(this.uiBoard.getWidth()/2-229,this.uiBoard.getHeight()/2-57,458,122),this.battleLayerRootNode.addChild(L),this.playingTimeUpNode=L},M.prototype.createMissRedNode=function(){var k=n.default.getInstance().getAtlas2(),D=new e.default("missRedNode");D.setVisible(!1),D.setOpacity(255),D.imageData=k,D.imageItem=k.getItem("miss_red"),D.move(0,0,this.uiBoard.getWidth(),this.uiBoard.getHeight()),this.battleLayerRootNode.addChild(D),this.missBackground=D},M.prototype.createFeverBackgroundNode=function(){var k=n.default.getInstance().getAtlas2(),D=new h.default("feverBackgroundNode");D.setVisible(!1),D.setOpacity(255),D.imageData=k,D.imageItem=k.getItem("fever_background"),D.setInset(80,80,80,80),D.move(0,0,this.uiBoard.getWidth(),this.uiBoard.getHeight()),this.battleLayerRootNode.addChild(D),this.feverBackground=D},M.prototype.createPropertyEffectNode=function(){this.propertyEffectNode=new s.default("Propertyeffect"),this.battleLayerRootNode.addChild(this.propertyEffectNode)},M.prototype.createOpponentHeadUI=function(){var k=n.default.getInstance().getAtlas(),D=new s.default("SelfHeadUI");D.move(this.uiBoard.getWidth(),this.uiBoard.getHeight()*this.topPercent,0,0);var L=new s.default("headIconNode");L.move(-101,-97,80,80);var b=new e.default("001_scene1");b.imageData=k,b.imageItem=k.getItem("001_scene1"),b.move(-100,-25,1.2*b.imageItem.rect.width,1.2*b.imageItem.rect.height),b.setVisible(!1);var N=new e.default("002_headPortrit");N.imageData=k,N.imageItem=k.getItem("avatar_default"),this.opponentHeadIconAtlas&&(N.imageData=this.opponentHeadIconAtlas,N.imageItem=this.opponentHeadIconAtlas.getItem("full")),N.move(0,0,80,80),L.addChild(N),L.addChild(b),D.addChild(L);var H=new s.default("scoreNode"),R=new r.default(o.default.getInstance().getAtlas(),4,"ScoreLabel");R.setScale(1.1),R.setNumberColor(r.NumberColor.LIGHTYELLOW),R.setNumberSize(35,39),R.move(-122,-50,0,39),R.setHAlineType(r.default.HRIGHT,!0),R.setNumberValue(0);var F=new e.default("scoreMultiple"),x=n.default.getInstance().getAtlas();F.imageData=x,F.imageItem=x.getItem("x2_yellow");var U=R.getPosition().y;F.move(-310,U,F.imageItem.rect.width,F.imageItem.rect.height),F.setVisible(!1),H.addChild(R),H.addChild(F),D.addChild(H);var B=new s.default("stateNode");B.move(-262,-101,181,15);var Q=n.default.getInstance().getAtlas(),Z=new e.default("displayComboNode");Z.imageData=Q,Z.imageItem=Q.getItem("combo"),Z.move(0,0,78,21),Z.setVisible(!1),B.addChild(Z);var z=new e.default("displayMissNode");z.imageData=Q,z.imageItem=Q.getItem("miss_small"),z.move(80,0,50,20),z.setVisible(!1),B.addChild(z);var W=new r.default(o.default.getInstance().getAtlas(),4,"displayNumberNode");W.setNumberColor(r.NumberColor.COMBO),W.setNumberSize(16,20),W.setHAlineType(r.default.HLEFT,!0),W.setShowSign(!0),W.move(Z.getRect().width+4,0,50,11),W.setVisible(!1),B.addChild(W),D.addChild(B);var V=new h.default("FeverNode");V.setVisible(!1),V.setOpacity(255),V.imageData=k,V.imageItem=k.getItem("fever_progress_out_light"),V.move(-310,-78,197,27),V.setInset(11,0,11,0),D.addChild(V);var Y=function(ee){var $=new h.default("bg");$.imageData=k,$.imageItem=k.getItem("red_progress_bg"),$.setInset(3,0,3,0),$.move(0,0,181,12),ee.addChild($);var j=new h.default("bar");j.imageData=k,j.imageItem=k.getItem("red_progress_bar"),j.setInset(4,0,4,0),j.move(0,0,100,12),ee.addChild(j);var ie=new e.default("light");ie.imageData=k,ie.imageItem=k.getItem("red_progress_header"),ie.move(0,1,8,12),ee.addChild(ie)},q=function(ee,$){var j=ee.getChildByIndex(1),ie=ee.getChildByIndex(2);if($===0)j.setVisible(!1),ie.setVisible(!1);else{var oe=10+171*$;j.setVisible(!0),j.move(181-oe,0,oe,12),j.calcNineParam(),ie.setVisible(!0),ie.move(181-oe,1,8,11)}};(J=new p.default(Y,q,"ProgressBar")).move(-302,-70,181,12),J.setProgress(0),D.addChild(J);var J;Y=function(ee){var $=new h.default("bg");$.imageData=k,$.imageItem=k.getItem("fever_progress_bg"),$.setInset(3,0,3,0),$.move(0,0,181,12),ee.addChild($);var j=new h.default("bar");j.imageData=k,j.imageItem=k.getItem("fever_progress_bar"),j.setInset(4,0,4,0),j.move(0,0,100,12),ee.addChild(j)},q=function(ee,$){var j=ee.getChildByIndex(1);if($===0)j.setVisible(!1);else{var ie=10+171*$;j.setVisible(!0),j.move(181-ie,0,ie,12),j.calcNineParam()}},(J=new p.default(Y,q,"FeverProgressBar")).move(-302,-70,181,12),J.setProgress(0),J.setVisible(!1),D.addChild(J),this.battleLayerRootNode.addChild(D),this.opponentHeadNode=D,this.opponentPropertyIconPanel.create(),this.opponentHeadNode.addChild(this.opponentPropertyIconPanel.root),this.opponentPropertyIconPanel.root.setPosition(-47,-155)},M.prototype.createSelfHeadUI=function(){var k=n.default.getInstance().getAtlas(),D=new s.default("OpponentHeadUI");D.move(0,this.uiBoard.getHeight()*this.topPercent,0,0);var L=new e.default("Icon");L.setVisible(!0),L.setOpacity(255),L.imageData=k,L.imageItem=k.getItem("avatar_default"),L.move(22,-97,M.ICON_SIZE,M.ICON_SIZE),D.addChild(L),this.selfHeadIconAtlas&&(L.imageData=this.selfHeadIconAtlas,L.imageItem=this.selfHeadIconAtlas.getItem("full"));var b=new s.default("scoreNode"),N=new r.default(o.default.getInstance().getAtlas(),4,"ScoreLabel");N.setScale(1.1),N.setNumberColor(r.NumberColor.LIGHTBLUE),N.setNumberSize(35,39),N.move(124,-50,0,39),N.setHAlineType(r.default.HLEFT,!0),N.setNumberValue(0),b.addChild(N);var H=new e.default("scoreMultiple"),R=n.default.getInstance().getAtlas();H.imageData=R,H.imageItem=R.getItem("x2_green");var F=N.getPosition().y;H.move(262,F,H.imageItem.rect.width,H.imageItem.rect.height),H.setVisible(!1),b.addChild(H),D.addChild(b);var x=new s.default("stateNode");x.move(124,-103,181,15);var U=n.default.getInstance().getAtlas(),B=new e.default("displayComboNode");B.imageData=U,B.imageItem=U.getItem("combo"),B.move(0,0,78,21),B.setVisible(!1),x.addChild(B);var Q=new e.default("displayMissNode");Q.imageData=U,Q.imageItem=U.getItem("miss_small"),Q.move(9,0,50,20),Q.setVisible(!1),x.addChild(Q);var Z=new r.default(o.default.getInstance().getAtlas(),4,"displayNumberNode");Z.setNumberColor(r.NumberColor.COMBO),Z.setNumberSize(16,20),Z.setHAlineType(r.default.HLEFT,!0),Z.setShowSign(!0),Z.move(B.getRect().width+4,0,50,11),Z.setVisible(!1),x.addChild(Z),D.addChild(x);var z=new h.default("FeverNode");z.setVisible(!1),z.setOpacity(255),z.imageData=k,z.imageItem=k.getItem("fever_progress_out_light"),z.move(113,-78,197,27),z.setInset(11,0,11,0),D.addChild(z);var W=function(q){var J=new h.default("bg");J.imageData=k,J.imageItem=k.getItem("blue_progress_bg"),J.setInset(3,0,3,0),J.move(0,0,181,12),q.addChild(J);var ee=new h.default("bar");ee.imageData=k,ee.imageItem=k.getItem("blue_progress_bar"),ee.setInset(4,0,4,0),ee.move(0,0,100,12),q.addChild(ee);var $=new e.default("light");$.imageData=k,$.imageItem=k.getItem("blue_progress_header"),$.move(0,0,8,12),q.addChild($)},V=function(q,J){var ee=q.getChildByIndex(1),$=q.getChildByIndex(2);if(J===0)ee.setVisible(!1),$.setVisible(!1);else{var j=10+171*J;ee.setVisible(!0),ee.move(0,0,j,12),ee.calcNineParam(),$.setVisible(!0),$.move(j-8,1,8,11)}};(Y=new p.default(W,V,"ProgressBar")).move(121,-70,181,12),Y.setProgress(0),D.addChild(Y);var Y;W=function(q){var J=new h.default("bg");J.imageData=k,J.imageItem=k.getItem("fever_progress_bg"),J.setInset(3,0,3,0),J.move(0,0,181,12),q.addChild(J);var ee=new h.default("bar");ee.imageData=k,ee.imageItem=k.getItem("fever_progress_bar"),ee.setInset(4,0,4,0),ee.move(0,0,100,12),q.addChild(ee)},V=function(q,J){var ee=q.getChildByIndex(1);if(J===0)ee.setVisible(!1);else{var $=10+171*J;ee.setVisible(!0),ee.move(0,0,$,12),ee.calcNineParam()}},(Y=new p.default(W,V,"ProgressBar")).move(121,-70,181,12),Y.setProgress(0),Y.setVisible(!1),D.addChild(Y),this.battleLayerRootNode.addChild(D),this.selfHeadNode=D,this.selfPropertyIconPanel.create(),this.selfHeadNode.addChild(this.selfPropertyIconPanel.root),this.selfPropertyIconPanel.root.setPosition(47,-155)},M.prototype.getHeadNodeById=function(k){return k===d.BattleGameSceneViewHeadId.SELF?this.selfHeadNode:this.opponentHeadNode},M.prototype.createPropertyPlayNode=function(){var k=new s.default("PropertyIconPlay");k.move(0,0,0,0),this.battleLayerRootNode.addChild(k);var D=n.default.getInstance().getAtlas();(L=new e.default("PropertyIconPlaySelf")).setVisible(!1),L.setOpacity(255),L.imageData=D,L.imageItem=D.getItem("propertyicon29"),L.move(0,0,M.ICON_SIZE,M.ICON_SIZE),k.addChild(L),this.selfPropertyPlayNode=L;var L,b=new e.default("DescriptionNode");b.setVisible(!1),b.setOpacity(255),this.selfPropertyPlayNode.addChild(b),this.selfDescriptionNode=b,(L=new e.default("PropertyIconPlayOpponent")).setVisible(!1),L.setOpacity(255),L.imageData=D,L.imageItem=D.getItem("propertyicon29"),L.move(0,0,M.ICON_SIZE,M.ICON_SIZE),k.addChild(L),this.opponentPropertyPlayNode=L;var N=n.default.getInstance().getAtlas(),H=new e.default("fanaticalNode");H.imageData=N,H.imageItem=N.getItem("fanatical_multiple"),H.move(this.uiBoard.getWidth()/2-H.imageItem.rect.width/2,this.uiBoard.getHeight()/2,H.imageItem.rect.width,H.imageItem.rect.height),H.setVisible(!1),this.battleLayerRootNode.addChild(H),this.fanaticalImageNode=H},M.prototype.createPropertyProtectPlayNode=function(){var k=new s.default("PropertyProtectedIconPlay");k.move(0,0,0,0),this.battleLayerRootNode.addChild(k);var D=n.default.getInstance().getAtlas(),L=new e.default("PropertyIconProtectedPlaySelf");L.setVisible(!1),L.setOpacity(255),L.imageData=D,L.imageItem=D.getItem("propertyicon29"),L.move(0,0,M.ICON_SIZE,M.ICON_SIZE),k.addChild(L),this.selfPropertyProtectPlayNode=L;var b=new e.default("DescriptionNode");b.setVisible(!1),b.setOpacity(255),this.selfPropertyProtectPlayNode.addChild(b),this.selfDescriptionProtectNode=b},M.prototype.calcPropertyPlayDestPosition=function(){this.selfDestPosition.x=(this.uiBoard.getWidth()-M.ICON_SIZE)/2,this.selfDestPosition.y=this.uiBoard.getHeight()*this.topPercent-300,this.opponentDestPosition.x=this.uiBoard.getWidth()-M.ICON_SIZE-22,this.opponentDestPosition.y=this.uiBoard.getHeight()*this.topPercent-97},M.prototype.createCommonEffectNode=function(){var k=new s.default("CommonEffectNode");k.move(0,0,0,0),this.battleLayerRootNode.addChild(k),this.commonEffectNode=k,this.missEffectNodePool=new _.default(this.commonEffectNode,function(D,L){var b=n.default.getInstance().getAtlas(),N=new e.default("MissingEffect");N.setVisible(!1),N.setOpacity(255),N.imageData=b,N.imageItem=b.getItem("miss"),N.move(0,0,217,68),N.setScale(.75,.75),D.addChild(N);var H=new y.default(0,100,.3),R=new S.default(0,.3),F=new I.default(function(){L.put(N)}),x=new g.default(H,R,F);return N.setUserData(x),N},function(D,L){D&&D.setOpacity(1)})},M.prototype.createOpponentSkinEffectUI=function(){var k=n.default.getInstance().getAtlas();this.skinTipsNode=new s.default("SkinTips"),this.skinTipsNode.setVisible(!1),this.skinTipsNode.move(this.uiBoard.getWidth()-290,this.uiBoard.getHeight()*this.topPercent-210,267,104),this.battleLayerRootNode.addChild(this.skinTipsNode);var D=new h.default("BG");D.setVisible(!0),D.setOpacity(255),D.move(0,0,267,104),D.imageData=k,D.imageItem=k.getItem("SkinLabelBG"),D.setInset(5,24,30,25),this.skinTipsNode.addChild(D)},M.prototype.createHeadIconAtlas=function(){this.destroyAtlas();var k=a.G.Ap.data.userAvatarIcon;k&&(this.selfHeadIconAtlas=new v.default(k),this.selfHeadIconAtlas.loadCanvas(k),this.selfHeadIconAtlas.addItem("full",new C.Utility.Rect(0,0,k.width,k.height),null));var D=a.G.Ap.data.opponentAvatarIcon;D&&(this.opponentHeadIconAtlas=new v.default(D),this.opponentHeadIconAtlas.loadCanvas(D),this.opponentHeadIconAtlas.addItem("full",new C.Utility.Rect(0,0,D.width,D.height),null))},M.prototype.destroyAtlas=function(){this.selfHeadIconAtlas&&(this.selfHeadIconAtlas.onDestroy(),this.selfHeadIconAtlas=null),this.opponentHeadIconAtlas&&(this.opponentHeadIconAtlas.onDestroy(),this.opponentHeadIconAtlas=null)},M.HEAD_CHILD_START=0,M.HEAD_CHILD_ICON=M.HEAD_CHILD_START++,M.HEAD_CHILD_SCORE=M.HEAD_CHILD_START++,M.HEAD_CHILD_STATE=M.HEAD_CHILD_START++,M.HEAD_CHILD_FEVER=M.HEAD_CHILD_START++,M.HEAD_CHILD_PROGRESSBAR=M.HEAD_CHILD_START++,M.HEAD_CHILD_FEVER_PROGRESSBAR=M.HEAD_CHILD_START++,M.ICON_SIZE=80,M}();m.default=A,cc._RF.pop()},{"../../base/G":"G","../../property/PropertyDefines":"PropertyDefines","../../util/SceneMusicMgr":"SceneMusicMgr","../../util/Utility":"Utility","../GameBus":"GameBus","../MUI/MUINineScaleSprite":"MUINineScaleSprite","../MUI/MUINode":"MUINode","../MUI/MUIProgressBar":"MUIProgressBar","../MUI/MUISprite":"MUISprite","../animation/action/MActionFactory":"MActionFactory","../animation/action/MCallFunc":"MCallFunc","../animation/action/MFadeTo":"MFadeTo","../animation/action/MMoveBy":"MMoveBy","../animation/action/MScaleTo":"MScaleTo","../animation/action/MSequence":"MSequence","../atlas/SimpleAtlas":"SimpleAtlas","../element/component/MUINumber":"MUINumber","../element/loader/BeginFrameLoader":"BeginFrameLoader","../element/loader/GameSceneFrameLoader":"GameSceneFrameLoader","../element/loader/NumberFrameLoader":"NumberFrameLoader","../element/node/MUINodePool":"MUINodePool","./IBattleGameSceneView":"IBattleGameSceneView","./UiPropertyIconPanel":"UiPropertyIconPanel"}],BattleSettlement:[function(l,P,m){"use strict";cc._RF.push(P,"2954fTalqdMGLSnwijr39v5","BattleSettlement"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./../UI/MusicLevelDataLoader"),s=l("./../skin/frag/SkinTaskMgr"),r=l("./Plugin/PluginMgr"),o=l("../Core/GameDefine"),e=l("./Plugin/IPlugin"),n=l("./PlayerMgr"),t=l("./LevelMgr"),i=l("../Core/modle/RowNode"),a=l("../../social/SocialHelper"),u=l("../../base/Log"),c=l("../../base/G"),p=l("../../base/State"),h=function(){function f(){this.mLevel=0,this.mStar=0,this.mCrown=0,this.mBpm=0,this.mBaseBeat=0,this.mMusicId=0,this.mMid=0,this.mGainedGold=0,this.mGainNormalChest=0,this.mGainMusicChest=0,this.mMusicName="",this.mMusician="",this.mPerfectCount=0,this.mScore=0,this.mHistoryBestScore=0,this.mBaseScore=0,this.mScorePlus=0,this.mAddScroce=0,this.mType=i.RowType.NORMAL,this.mBadBlockCount=0,this.mBadEndBlock=0,this.mArena=!1,this.mGhostChase=!1,this.mBattleTime=0,this.mSpeed=0,this.mCarnival=0,this.mHeavyAnim=!1,this.mRecordRate=!1,this.mRecDayPlay=!1,this.mRecDayPlayAd=!1,this.mRecDayTime=!1,this.mArenaID=!1,this.mReliveTime=0,this.mGameTime=0}return f.prototype.setScore=function(g){this.mScore=g},f.prototype.setStar=function(g){this.mStar=g},f.prototype.setCrown=function(g){this.mCrown=g},f.prototype.restart=function(){this.mMid=0,this.mStar=0,this.mCrown=0,this.mMusicId=0,this.mLevel=0,this.mBpm=0,this.mScore=0,this.mHistoryBestScore=0,this.mPerfectCount=0,this.mScorePlus=0,this.mBaseBeat=0,this.mMusicName="",this.mMusician="",this.mBadBlockCount=0,this.mBadEndBlock=0,this.mType=i.RowType.UNKNOW,this.mGainedGold=0,this.mGainNormalChest=0,this.mGainMusicChest=0,this.mAddScroce=0,this.mBattleTime=0,this.mSpeed=0,this.mCarnival=0,this.mReliveTime=0,this.mGameTime=0},f.prototype.giveBattle=function(g,_,y){this.restart(),this.mLevel=g,this.mMid,this.mBaseBeat=y;var S=t.LevelMgr.Ins().getLevel(g);S!=null&&(this.mMusicId=g,this.mMid=S.music.mid,this.mMusicName=S.music.musicName,this.mMusician=S.music.musician),this.setBpm(_)},f.prototype.setBpm=function(g){this.mBpm=g,this.mBaseScore=parseInt(""+g/this.mBaseBeat/8),this.mType=i.RowType.UNKNOW,this.notifyHUD()},f.prototype.inning=function(){},f.prototype.notifyHUD=function(){},f.prototype.setGainedGold=function(g){this.mGainedGold=g},f.prototype.battleOver=function(){console.log("[BattleSettlement] battleOver");var g=r.default.Ins().getPlugin(e.default.Plugin_Exp),_=new o.LevelRecord;_.mId=this.mLevel,_.mMid=this.mMid,_.mBadBlockType=this.mType,_.mBadBlcokCount=this.mBadBlockCount,_.mbadEndBlock=this.mBadEndBlock,_.mIsFisrtGame=!1;var y=n.default.Ins(),S=y.getLevelRecord(this.mLevel);if(S==null||S==null){var I=t.LevelMgr.Ins().getLevel(this.mLevel);S=y.addNewRecord(I.id,I.music.mid,I.levelUnlock.unlockType)}this.mHistoryBestScore=S.mBestScore,_.mBestScore=S.mBestScore,_.mBestStar=S.mBestStar,_.mBestSpeed=S.mBestSpeed,S.isRecordLocked()?_.mUnlockFlag=S.mUnlockFlag:(_.mUnlockFlag=o.eUnlockFlag.FLAG_UNLOCKED,this.mLevel<o.Constant.CHOICENESS_STARTID&&y.setUserLastLevelMid(this.mMid)),_.mBestScore,this.mScore>_.mBestScore&&(_.mBestScore=this.mScore),_.mScore=this.mScore,_.mBestSpeed,this.mSpeed>_.mBestSpeed&&(_.mBestSpeed=this.mSpeed),_.mSpeed=this.mSpeed,0<t.LevelMgr.Ins().getLevelInfo(this.mLevel).mId&&(0<this.mCrown?_.mStar=3+this.mCrown:0<this.mStar&&(_.mStar=this.mStar)),_.mBestStar<_.mStar&&(_.mStar==6?(_.mIsFirstSix=!0,_.mBestStar<5&&(_.mIsFirstFive=!0),_.mBestStar<4&&(_.mIsFirstFour=!0),_.mBestStar<3&&(_.mIsFirstPassed=!0),_.mBestStar<2&&(_.mIsFirstSecond=!0),_.mBestStar<1&&(_.mIsFirstBlood=!0)):_.mStar==5?(_.mIsFirstFive=!0,_.mBestStar<4&&(_.mIsFirstFour=!0),_.mBestStar<3&&(_.mIsFirstPassed=!0),_.mBestStar<2&&(_.mIsFirstSecond=!0),_.mBestStar<1&&(_.mIsFirstBlood=!0)):_.mStar==4?(_.mIsFirstFour=!0,_.mBestStar<3&&(_.mIsFirstPassed=!0),_.mBestStar<2&&(_.mIsFirstSecond=!0),_.mBestStar<1&&(_.mIsFirstBlood=!0)):_.mStar==3?(_.mIsFirstPassed=!0,_.mBestStar<2&&(_.mIsFirstSecond=!0),_.mBestStar<1&&(_.mIsFirstBlood=!0)):_.mStar==2?(_.mIsFirstSecond=!0,_.mBestStar<1&&(_.mIsFirstBlood=!0)):_.mStar==1&&(_.mIsFirstBlood=!0),_.mBestStar=_.mStar);var v=r.default.Ins().getPlugin(e.default.Plugin_Economy);if(v&&(_.mCoin=v.increaseGold(_),0<this.mGainedGold&&(_.mCoin+=this.mGainedGold,v.gainGold(this.mGainedGold))),_.mGainedGold=this.mGainedGold,!S.isRecordLocked()){_.mExp=g.getCanIncreaseEX(_);var C=_.mExp;_.mExp=this.addPropAdditionExp(C),u.default.e("\u6E38\u620F\u7ED3\u675F\u540E\u7ECF\u9A8C\u52A0\u6210\uFF1A "+C+"  => "+_.mExp),_.mIsUpLevel=g.increaseEx(_)}_.mFrom=1,y.setLevelRecord(_);var T=_.mBestStar-3;(Number.isNaN(T)||T<0)&&(T=0);var E=_.mBestStar;E=0<T?0:_.mBestStar,Number.isNaN(E)&&(E=0),a.SocialHelper.updateSongScore({songId:""+_.mMid,crown:T,star:E,score:_.mBestScore,locked:_.isRecordLocked()}),a.SocialHelper.updateTotalScore({crown:y.getTotalCrown(),star:y.getTotalStar(),grade:y.getUserLevel(),score:y.getTotalScore()}),S.isRecordLocked()||y.refreshUnlockState(this.mLevel),this.notifyTaskSys()},f.prototype.addPropAdditionExp=function(g){return c.G.propAddition.getAdditionedExp(g,c.G.Ap.state.mission.getType().toString())},f.prototype.notifyTaskSys=function(){var g=c.G.Ap.state.getMission();if(g&&g.getType()==p.MISSIONTYPE.Normal){var _=t.LevelMgr.Ins().getLevel(g.levelId);if(_&&d.MusicLevelDataLoader.isLvUnLockMusic(_)){u.default.i("notifyTaskSys => notify musicId ="+g.musicId+" levelId="+g.levelId,_);var y=new s.GradeSongEvent;y.crownCount=this.mCrown,y.reliveTimes=this.mReliveTime,s.default.Ins().notifyGradeSongEvent(y)}}},f.prototype.addReliveTimes=function(g){this.mReliveTime=g},f.prototype.getReliveTimes=function(){return this.mReliveTime},f.prototype.addGameTime=function(g){this.mGameTime=g},f.prototype.getGameTime=function(){return this.mGameTime},f}();m.default=h,cc._RF.pop()},{"../../base/G":"G","../../base/Log":"Log","../../base/State":"State","../../social/SocialHelper":"SocialHelper","../Core/GameDefine":"GameDefine","../Core/modle/RowNode":"RowNode","./../UI/MusicLevelDataLoader":"MusicLevelDataLoader","./../skin/frag/SkinTaskMgr":"SkinTaskMgr","./LevelMgr":"LevelMgr","./PlayerMgr":"PlayerMgr","./Plugin/IPlugin":"IPlugin","./Plugin/PluginMgr":"PluginMgr"}],Bean:[function(l,P,m){"use strict";cc._RF.push(P,"9dd26QujYtFW6hPS6SEWvx8","Bean"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function o(){}return o.MSG_PRE_LOAD_OPENDATACONTEXT="msg_pre_load_opendatacontext",o.MSG_UPDATE_TOTAL_SCORE="msg_update_total_score",o.MSG_UPDATE_SONG_SCORE="msg_update_song_score",o.MSG_REFRESH_SONG_SCORE="msg_refresh_self_rank_data",o.MSG_ADVANCEL_LOAD_GROUP_RNAK_DATA="msg_advance_load_group_rank_data",o.MSG_UPDATE_CACHE="msg_update_cache",o.MSG_DRAW_RANKING="msg_draw_ranking",o.MSG_EXIT_DRAW_RANKING="msg_exit_draw_ranking",o.MSG_SYNC_DRAW_RANKING="msg_sync_draw_ranking",o.MSG_TOUCH_RANK_LIST="msg_touch_rank_list",o.MSG_UPDATE_PLAYER_INFO="msg_update_player_info",o.MSG_UPDATE_PK_RANK_INFO="msg_update_pk_rank_info",o}();m.Message=d;var s=function(){};m.GroupMsgInfo=s;var r=function(){};m.LaunchOption=r,cc._RF.pop()},{}],BeginFrameLoader:[function(l,P,m){"use strict";cc._RF.push(P,"ff497OsGURJYYIwgycNUSmJ","BeginFrameLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../atlas/SimpleAtlas"),s=function(){function r(){this.mBeginSimpleAtlas=null,this.mInit=!1,this.mBeginSimpleAtlas=new d.default}return r.getInstance=function(){return r.sInstance==null&&(r.sInstance=new r),r.sInstance},r.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return this.mInit?[2]:(this.mInit=!0,[4,this.mBeginSimpleAtlas.load("gameImage/gameBegin")]);case 1:return o.sent(),[2]}})})},r.prototype.getAtlas=function(){return this.mBeginSimpleAtlas},r.prototype.getBannerBg=function(){return this.mBeginSimpleAtlas.getItem("banner_bg")},r.prototype.getBackNormal=function(){return this.mBeginSimpleAtlas.getItem("back_normal")},r.prototype.getBackPressed=function(){return this.mBeginSimpleAtlas.getItem("back_pressed")},r.sInstance=null,r}();m.default=s,cc._RF.pop()},{"../../atlas/SimpleAtlas":"SimpleAtlas"}],BinaryData:[function(l,P,m){"use strict";cc._RF.push(P,"3e8d0Ttb4FD5b/GTPFClOMI","BinaryData"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.ArrayBufferToString=function(r){for(var o="",e=new Uint8Array(r),n=0,t=e.byteLength;n<t;n++)o+=String.fromCharCode(e[n]);return o},s.StringToArrayBuffer=function(r){for(var o=new ArrayBuffer(r.length),e=new Uint8Array(o),n=0,t=r.length;n<t;n++)e[n]=r.charCodeAt(n);return o},s.ArrayBufferToStringComplex=function(r,o){for(var e="",n=new Uint8Array(r),t=0,i=n.byteLength;t<i;t++)e+=String.fromCharCode(n[t]^o);return e},s.StringToArrayBufferComplex=function(r,o){for(var e=new ArrayBuffer(r.length),n=new Uint8Array(e),t=0,i=r.length;t<i;t++)n[t]=r.charCodeAt(t),n[t]=n[t]^o;return e},s}();m.default=d,cc._RF.pop()},{}],BlankPauseBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"6cb48vUfLFHaqA2M7q1pDj6","BlankPauseBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/BlockSkinFrameLoader"),s=l("./BlockNode"),r=l("../../MUI/MUISprite"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.reuse=function(t){e.prototype.reuse.call(this,t),this.updatePauseState(!1)},n.prototype.createLayers=function(){e.prototype.createLayers.call(this);var t=d.default.getInstance().getStartLabel(),i=this.mBlock.rect.width/t.rect.width,a=this.mBlock.rect.width,u=t.rect.height*i,c=new r.default;c.imageData=d.default.getInstance().getAtlas(),c.imageItem=t,c.move(0,(this.mBlock.rect.height-u)/2,a,u),this.addChild(c)},n.prototype.updateTouchState=function(t){},n.prototype.modifyOpacity=function(t){},n.prototype.updatePauseState=function(t){},n.prototype.showBackgroundAnimation=function(){},n}(s.default);m.default=o,cc._RF.pop()},{"../../MUI/MUISprite":"MUISprite","../loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./BlockNode":"BlockNode"}],BlockNodeCache:[function(l,P,m){"use strict";cc._RF.push(P,"64d73wbCOlGjJEEExlYKGsQ","BlockNodeCache"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ReuseNodePool"),s=l("../../../util/Utility"),r=l("./BlockNodeFactory"),o=l("../../data/MapGenerator"),e=l("../../../base/G"),n=function(){function t(){this.mShortNodeCache=null,this.mLongNodeCache=null,this.mMoneyNodeCache=null,this.mGiftNodeCache=null,this.mRedNodeCache=null,this.mPropertyNodeCache=null,this.mEvilShortNodeCache=null,this.mEvilLongNodeCache=null,this.mShortNodeCache=new d.default,this.mLongNodeCache=new d.default,this.mMoneyNodeCache=new d.default,this.mGiftNodeCache=new d.default,this.mRedNodeCache=new d.default,this.mPropertyNodeCache=new d.default,this.mEvilShortNodeCache=new d.default,this.mEvilLongNodeCache=new d.default}return t.prototype.createCache=function(i,a){var u=new s.Utility.Rect(0,0,e.G.Ap.config.mBaseBlockWidth,e.G.Ap.config.getBlockHeight()),c=o.default.createBlock(u,s.Utility.BLOCKTYPE.SHORT);if(a===s.Utility.GAMESTAGE.INFINITE||a===s.Utility.GAMESTAGE.MUSIC){for(var p=0;p<10;++p){var h=r.default.getInstance().createNode(c);i.addChild(h),c.node=h,this.put(c)}for(c.rect.height=u.height,c.type=s.Utility.BLOCKTYPE.LONG,p=0;p<4;++p)h=r.default.getInstance().createNode(c),i.addChild(h),c.node=h,this.put(c);for(c.rect.height=e.G.Ap.config.getBlockHeight(),c.type=s.Utility.BLOCKTYPE.GIFT,p=0;p<1;++p)h=r.default.getInstance().createNode(c),i.addChild(h),c.node=h,this.put(c)}if(a===s.Utility.GAMESTAGE.MONEY)for(c.rect.height=e.G.Ap.config.getBlockHeight(),c.type=s.Utility.BLOCKTYPE.MONEY,p=0;p<15;++p)h=r.default.getInstance().createNode(c),i.addChild(h),c.node=h,this.put(c)},t.prototype.get=function(i){var a=null;switch(i.type){case s.Utility.BLOCKTYPE.SHORT:case s.Utility.BLOCKTYPE.TWINS:a=this.mShortNodeCache.get(i);break;case s.Utility.BLOCKTYPE.LONG:a=this.mLongNodeCache.get(i);break;case s.Utility.BLOCKTYPE.MONEY:a=this.mMoneyNodeCache.get(i);break;case s.Utility.BLOCKTYPE.GIFT:a=this.mGiftNodeCache.get(i);break;case s.Utility.BLOCKTYPE.MISTAKE:a=this.mRedNodeCache.get(i);break;case s.Utility.BLOCKTYPE.PROPERTY:a=this.mPropertyNodeCache.get(i);break;case s.Utility.BLOCKTYPE.OBSTACLE:a=i.obstacleType===s.Utility.BLOCKTYPE.LONG?this.mEvilLongNodeCache.get(i):this.mEvilShortNodeCache.get(i)}return a},t.prototype.put=function(i){var a=!1,u=i.node;switch(i.type){case s.Utility.BLOCKTYPE.SHORT:case s.Utility.BLOCKTYPE.TWINS:a=this.mShortNodeCache.put(u);break;case s.Utility.BLOCKTYPE.LONG:a=this.mLongNodeCache.put(u);break;case s.Utility.BLOCKTYPE.MONEY:a=this.mMoneyNodeCache.put(u);break;case s.Utility.BLOCKTYPE.GIFT:a=this.mGiftNodeCache.put(u);break;case s.Utility.BLOCKTYPE.MISTAKE:a=this.mRedNodeCache.put(u);break;case s.Utility.BLOCKTYPE.PROPERTY:a=this.mPropertyNodeCache.put(u);break;case s.Utility.BLOCKTYPE.OBSTACLE:a=i.obstacleType===s.Utility.BLOCKTYPE.LONG?this.mEvilLongNodeCache.put(u):this.mEvilShortNodeCache.put(u)}return a},t.prototype.clear=function(){this.mShortNodeCache.clear(),this.mLongNodeCache.clear(),this.mMoneyNodeCache.clear(),this.mGiftNodeCache.clear(),this.mRedNodeCache.clear(),this.mPropertyNodeCache.clear(),this.mEvilShortNodeCache.clear(),this.mEvilLongNodeCache.clear()},t}();m.BlockNodeCache=n,cc._RF.pop()},{"../../../base/G":"G","../../../util/Utility":"Utility","../../data/MapGenerator":"MapGenerator","./BlockNodeFactory":"BlockNodeFactory","./ReuseNodePool":"ReuseNodePool"}],BlockNodeFactory:[function(l,P,m){"use strict";cc._RF.push(P,"07b29lTSXlETLj1YWZpZkGB","BlockNodeFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../util/Utility"),s=l("./StartBlockNode"),r=l("./ShortBlockNode"),o=l("./LongBlockNode"),e=l("./MistakeBlockNode"),n=l("./MoneyBlockNode"),t=l("./GiftBlockNode"),i=l("./BlankPauseBlockNode"),a=l("../../../base/G"),u=l("./PropertyBlockNode"),c=l("./EvilLongBlockNode"),p=l("./EvilShortBlockNode"),h=function(){function f(){}return f.getInstance=function(){return this.sInstance==null&&(this.sInstance=new f),this.sInstance},f.prototype.createNode=function(g){var _=null;switch(g.type){case d.Utility.BLOCKTYPE.TWINS:case d.Utility.BLOCKTYPE.SHORT:_=new r.default(g);break;case d.Utility.BLOCKTYPE.LONG:_=a.G.Ap.config.debugNoLongBlocks?new r.default(g):new o.default(g);break;case d.Utility.BLOCKTYPE.GIFT:_=new t.default(g);break;case d.Utility.BLOCKTYPE.MONEY:_=new n.default(g);break;case d.Utility.BLOCKTYPE.BEGIN:_=new s.default(g);break;case d.Utility.BLOCKTYPE.MISTAKE:_=new e.default(g);break;case d.Utility.BLOCKTYPE.BLANKPAUSE:_=new i.default(g);break;case d.Utility.BLOCKTYPE.OBSTACLE:_=g.obstacleType===d.Utility.BLOCKTYPE.LONG?new c.EvilLongBlockNode(g):new p.EvilShortBlockNode(g);break;case d.Utility.BLOCKTYPE.PROPERTY:_=new u.default(g)}return _!=null&&_.createLayers(),_},f.sInstance=null,f}();m.default=h,cc._RF.pop()},{"../../../base/G":"G","../../../util/Utility":"Utility","./BlankPauseBlockNode":"BlankPauseBlockNode","./EvilLongBlockNode":"EvilLongBlockNode","./EvilShortBlockNode":"EvilShortBlockNode","./GiftBlockNode":"GiftBlockNode","./LongBlockNode":"LongBlockNode","./MistakeBlockNode":"MistakeBlockNode","./MoneyBlockNode":"MoneyBlockNode","./PropertyBlockNode":"PropertyBlockNode","./ShortBlockNode":"ShortBlockNode","./StartBlockNode":"StartBlockNode"}],BlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"3ebc1IW/MVG3qVliA4/HsNm","BlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o){var e=s.call(this)||this;return e.mBlock=o,e}return __extends(r,s),r.prototype.reuse=function(o){s.prototype.reuse.call(this,o),this.mBlock=o,this.resetNode()},r.prototype.createLayers=function(){this.resetNode()},r.prototype.resetNode=function(){this.setPosition(this.mBlock.rect.x,this.mBlock.rect.y),this.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height)},r.prototype.updateLayers=function(o){},r.prototype.updateTouchState=function(o){},r.prototype.updatePauseState=function(o){},r.prototype.modifyOpacity=function(o){},r}(l("./ReuseNode").default);m.default=d,cc._RF.pop()},{"./ReuseNode":"ReuseNode"}],BlockSkinFrameLoader:[function(l,P,m){"use strict";cc._RF.push(P,"62b3amlnlpOtJK3cAKmNlyJ","BlockSkinFrameLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../atlas/SimpleImage"),s=function(){function r(){this.mGameSceneSimpleAtlas=null,this.mShortBlockTouchedAnim=null}return r.getInstance=function(){return r.sInstance==null&&(r.sInstance=new r),r.sInstance},r.prototype.setAtlas=function(o){this.mGameSceneSimpleAtlas=o,this.mShortBlockTouchedAnim=null},r.prototype.getAtlas=function(){return this.mGameSceneSimpleAtlas},r.prototype.getShortBlockTouchedAnimFrames=function(){return this.mGameSceneSimpleAtlas==null?null:(this.mShortBlockTouchedAnim==null&&(this.mShortBlockTouchedAnim=new d.SimpleImageFrameSequence(this.mGameSceneSimpleAtlas.getItem("finish_1"),this.mGameSceneSimpleAtlas.getItem("finish_2"),this.mGameSceneSimpleAtlas.getItem("finish_3"),this.mGameSceneSimpleAtlas.getItem("finish_4"))),this.mShortBlockTouchedAnim)},r.prototype.getStartBlockBackground=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("tile_start")},r.prototype.getShortBlockBackground=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("tile_black")},r.prototype.getStartLabel=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("start_label")},r.prototype.getMistakeBlockBackground=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("tile_miss")},r.prototype.getLongBlockHead=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("long_head")},r.prototype.getLongBlockLight=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("long_tilelight")},r.prototype.getLongBlockLightTop=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("long_light")},r.prototype.getLongBlockFinish=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("long_finish")},r.prototype.getLongBlockTail=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("black")},r.prototype.getDot=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("long_dot")},r.sInstance=null,r}();m.default=s,cc._RF.pop()},{"../../atlas/SimpleImage":"SimpleImage"}],BottomStorePanel:[function(l,P,m){"use strict";cc._RF.push(P,"f30e3JvSb9L7p19dFOu3cTC","BottomStorePanel"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../../business/UI/GameEntraScene/BasicTouchEvent"),o=l("../../business/UI/GameEntraScene/PrefabMgr"),e=l("./PropertiesPanel"),n=cc._decorator,t=n.ccclass,i=n.property,a=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.propSprite=null,p.contentNode=null,p.mPianoClickCallback=null,p.mPropClickCallback=null,p.mType=d.PROP,p.mPropNode=null,p.mPianoNode=null,p.mLoadFinishedCB=void 0,p}return __extends(c,u),c.prototype.setShowPropPopupCb=function(p){this.mShowPropPopupCb=p},c.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(p){p.stopPropagation()}),this.node.on(cc.Node.EventType.TOUCH_END,function(p){p.stopPropagation()}),this.initUi(),this.initEvent()},c.prototype.initEvent=function(){var p=this;this.mPropClickCallback=new r.default(function(){p.propClick()}),this.propSprite.node.on(cc.Node.EventType.TOUCH_END,this.mPropClickCallback.click,this.mPropClickCallback)},c.prototype.initUi=function(){this.updateTab(),this.showPanel()},c.prototype.propClick=function(){this.mType!=d.PROP&&(this.mType=d.PROP,this.updateTab(),this.showPanel())},c.prototype.pianoClick=function(){this.mType!=d.PAINO&&(this.mType=d.PAINO,this.updateTab(),this.showPanel())},c.prototype.showPanel=function(){this.mType==d.PROP&&this.showProp()},c.prototype.showProp=function(){var p=this;this.mPianoNode&&this.mPianoNode.setPosition(1e4,0),this.mPropNode==null?o.default.load("gamescene/PropertiesPanel",function(h,f){f&&(p.mPropNode=f,p.mPropNode.getComponent(e.default).setShowPropPopupCb(p.mShowPropPopupCb.bind(p)),p.contentNode.addChild(p.mPropNode),p.mLoadFinishedCB&&p.mLoadFinishedCB())}):this.mPropNode.setPosition(0,0)},c.prototype.setBottomStoreLoadFinished=function(p){this.mLoadFinishedCB=p},c.prototype.updateTab=function(){},c.prototype.updatePropertiesPanel=function(){this.mPropNode&&this.mPropNode.getComponent(e.default).updatePropertiesPanel()},c.prototype.playGetPropertyAnim=function(p){this.mPropNode&&this.mPropNode.getComponent(e.default).playGetPropertyAnim(p)},c.ATLAS_PATH="static_res/game_tone_en",__decorate([i(cc.Sprite)],c.prototype,"propSprite",void 0),__decorate([i(cc.Node)],c.prototype,"contentNode",void 0),c=__decorate([t],c)}(cc.Component);m.default=a,(s=d||(d={}))[s.PROP=0]="PROP",s[s.PAINO=1]="PAINO",cc._RF.pop()},{"../../business/UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr","./PropertiesPanel":"PropertiesPanel"}],BusinessUtil:[function(l,P,m){"use strict";cc._RF.push(P,"74dd5suYlxIvItheM7X9btW","BusinessUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/PrefabMgr"),s=function(){function r(){}return r.getIns=function(){return this.mIns==null&&(this.mIns=new r),this.mIns},r.prototype.showToastTips=function(o,e,n,t){var i=this;t===void 0&&(t=!1),d.default.load("prefab/ToastPrefab",function(a,u){if(u&&cc.isValid(i,!0)){var c=cc.instantiate(u),p=c.getComponent("ToastPrefab");p.showTips(o,function(){c.destroy(),n&&n()}),p.setLong(t),e.addChild(c)}})},r.mIns=null,r}();m.default=s,cc._RF.pop()},{"../UI/GameEntraScene/PrefabMgr":"PrefabMgr"}],BuySkinDiamondNotEnough:[function(l,P,m){"use strict";cc._RF.push(P,"2ae3aU3FG1Cc7vK2QmOZ2sj","BuySkinDiamondNotEnough"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.mLayout=null,i.share_btn=null,i.close_btn=null,i.mShareBtnClickCallback=null,i.mCloseBtnClickCallback=null,i}return __extends(t,n),t.prototype.setShareCallback=function(i){this.shareCallback=i},t.prototype.setCloseCallback=function(i){this.mCloseCallback=i},t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(i){i.stopPropagation()}),this.initEvent()},t.prototype.initEvent=function(){var i=this;this.mShareBtnClickCallback=new d.default(function(){i.shareBtnClick()}),this.setTouchCb(this.share_btn,this.mShareBtnClickCallback),this.mCloseBtnClickCallback=new d.default(function(){i.closeBtnClick()}),this.setTouchCb(this.close_btn,this.mCloseBtnClickCallback)},t.prototype.setTouchCb=function(i,a){i&&i.node&&a&&i.node.on(cc.Node.EventType.TOUCH_END,a.click,a)},t.prototype.start=function(){this.mLayout.getComponent(cc.Animation).play("buy_skin_diamond_not_enough")},t.prototype.shareBtnClick=function(){this.shareCallback&&this.shareCallback()},t.prototype.closeBtnClick=function(){this.mCloseCallback&&this.mCloseCallback()},__decorate([o(cc.Node)],t.prototype,"mLayout",void 0),__decorate([o(cc.Button)],t.prototype,"share_btn",void 0),__decorate([o(cc.Button)],t.prototype,"close_btn",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],CMInviteSkinPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"364bd62Ak9LJJuMBepLjCoA","CMInviteSkinPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../../base/Log"),r=l("../reward/ActivityBean"),o=l("../UI/GameEntraScene/ImgCache"),e=l("../Logic/SkinDataManager"),n=l("../reward/ActivityRewardManager"),t=l("../../base/G"),i=l("./SkinTryData"),a=l("./SkinUtils"),u=l("../Logic/EventBus"),c=l("../Logic/NotifyEvent"),p=l("../../../modules/MGAppShare/scripts/MGShareUtil"),h=l("../../social/AvatarUtil"),f=l("../UI/GameEntraScene/mainpage/MainpageBaseComponent"),g=l("../../infoc/m_p2_daily_activity"),_=l("../UI/GameEntraScene/MusicLib/HotMusicCMShareController"),y=l("../UI/GameEntraScene/mainpage/WelfareController"),S=cc._decorator,I=S.ccclass,v=S.property,C=function(T){function E(){var A=T!==null&&T.apply(this,arguments)||this;return A.content_layout=null,A.skin_bg=null,A.invite_fds_btn=null,A.share_moments_btn=null,A.close_btn=null,A.invite_count_text=null,A.invite_count_total_text=null,A.avatar_sprite=[],A.mask_layout=[],A.invite_count_layout=null,A.try_btn=null,A.popup_layout=null,A.source=y.default.SRC_HOME_PAGE_CLICK,A.mSkin=null,A.mLayoutBgUrl="",A.mInviteCountLimit=3,A.processedInvitees=[],A.newUserCount=0,A.mCloseBtnClickCallback=null,A.mInviteFdsBtnClickCallback=null,A.mShareMomentsBtnCallback=null,A.mTryBtnCallback=null,A.mTrySource=y.default.SRC_SKIN_INVITE_SHOW,A}return __extends(E,T),E.prototype.setSource=function(A){this.source=A},E.prototype.setSkinName=function(A){this.mSkin=A},E.prototype.setLayoutBgUrl=function(A){this.mLayoutBgUrl=A},E.prototype.setReportPage=function(A){this.mReportPage=A},E.prototype.setInviteCountLimit=function(A){this.mInviteCountLimit=A},E.prototype.setCloseCallback=function(A){this.mCloseCallback=A},E.prototype.setInvitefdsCallback=function(A){this.mInviteFdsCallback=A},E.prototype.setTrySource=function(A){this.mTrySource=A},E.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(k){k.stopPropagation()}),s.default.i("[SkinStore] InviteSKin initView onLoad....."),console.log("CMPlayShare skinName:"+this.mSkin.name),this.initEvent(),this.initBg(),this.initView();var A=this,M=0;this.schedule(function(){M++,s.default.i("CMInviteSkinPrefab schdule",M),A.initData()},5,6,.1)},E.prototype.initEvent=function(){var A=this;this.mCloseBtnClickCallback=new d.default(function(){A.closeBtnClick()}),this.setTouchCb(this.close_btn,this.mCloseBtnClickCallback),this.mInviteFdsBtnClickCallback=new d.default(function(){A.inviteFdsBtnClick(),g.default.report(A.mSource,g.default.ACTION_CLICK_SHARE)}),this.setTouchCb(this.invite_fds_btn,this.mInviteFdsBtnClickCallback),this.mShareMomentsBtnCallback=new d.default(function(){A.shareMomentsClick()}),this.setTouchCb(this.share_moments_btn,this.mShareMomentsBtnCallback),this.mTryBtnCallback=new d.default(function(){A.clickTrySkin(),g.default.report(A.mSource,g.default.ACTION_CLICK_TRY)}),this.setTouchCb(this.try_btn,this.mTryBtnCallback)},E.prototype.setTouchCb=function(A,M){if(A&&M){var k=A instanceof cc.Component?A.node:A;k&&k.on(cc.Node.EventType.TOUCH_END,M.click,M)}},E.prototype.clickTrySkin=function(){var A=this,M=e.SkinDataMgr.Ins().getSkinItemInfo(this.mSkin.name);M!=null?(console.log("[SkinStore] itemTrySkinCallback skin = "+M),a.default.trySkin(M,this.popup_layout.node,function(){},function(){},function(){t.G.skinTryData||(t.G.skinTryData=new i.default),t.G.skinTryData.source=A.mTrySource})):console.error("[InviteSkinStore] trySkin skin = null")},E.prototype.initBg=function(){var A=this;o.default.get(this.mLayoutBgUrl,function(M,k){k&&(A.skin_bg.getComponent(cc.Sprite).spriteFrame=k)})},E.prototype.initData=function(){var A=this;s.default.i("CMPlayShare InviteSKin initData....."),n.ActivityRewardMgr.Ins().getInviteList([r.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN+"_"+this.mSkin.name],function(M){M&&(s.default.i("MPlayShare InviteSKin initData.....succeed",M),A.invitees=M.get(r.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN+"_"+A.mSkin.name),A.preProcessInviteeList()),A.initView()})},E.prototype.initView=function(){s.default.i("[SkinStore] InviteSKin initView this.invitees.",this.invitees);var A=this.content_layout.node.children.length;this.mInviteCountLimit>A&&(this.mInviteCountLimit=A);var M="/ui/skin_invite_num"+this.mInviteCountLimit;o.default.get2(M,this.invite_count_total_text);for(var k=0,D=0;D<this.mInviteCountLimit;D++)this.content_layout.node.children[D].active=!0,this.processedInvitees[D]&&(k++,this.mask_layout[D].node.active=!0,this.avatar_sprite[D].node.width=80,this.avatar_sprite[D].node.height=80,s.default.i("CMInviteSkinPrefab this.avatar_sprite",this.avatar_sprite[D].node.width,this.avatar_sprite[D].node.height),h.default.showUserAvatar(this.processedInvitees[D].avatar_url,this.avatar_sprite[D],!1),this.processedInvitees[D].needMark&&(this.mask_layout[D].node.getChildByName("new_player_mark").active=!0));if(k>=this.mInviteCountLimit)this.unscheduleAllCallbacks(),this.invite_count_layout.node.active=!1,this.invite_fds_btn.node.active=!1,u.default.fire(c.default.CM_SKIN_ADS_UNLOCK,this.mSkin),this.closeBtnClick();else{this.invite_count_layout.node.active=!0;var L="/ui/skin_invite_num"+k;o.default.get2(L,this.invite_count_text)}e.SkinDataMgr.Ins().updateInviteSkinCount(k>this.mInviteCountLimit?this.mInviteCountLimit:k),this.newUserCount=k>this.mInviteCountLimit?this.mInviteCountLimit:k,s.default.i("[SkinStore] InviteSKin initView.....")},E.prototype.preProcessInviteeList=function(){var A=this;this.processedInvitees=[],this.invitees&&0<this.invitees.length&&this.invitees.forEach(function(M){if(A.processedInvitees.push(M),M.is_new_player){var k=Object.assign({},M);k.needMark=!0,A.processedInvitees.push(k)}})},E.prototype.closeBtnClick=function(){this.unscheduleAllCallbacks(),this.node.destroy(),this.mCloseCallback&&this.mCloseCallback()},E.prototype.inviteFdsBtnClick=function(){this.mInviteFdsCallback&&this.mInviteFdsCallback(),_.default.Ins().saveSkinItemInfo(this.mSkin),p.MGShareUtils.shareForInviteSkin("playerId",r.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN+"_"+this.mSkin.name,function(A){s.default.i("\u9080\u8BF7\u597D\u53CB\u5F97\u76AE\u80A4\u5361\u7247\u5206\u4EAB,result : "+A),u.default.fire(c.default.SHARE_HOME_SHOW_INVITE_TIPS)},"1",this.mSkin.displayName,this.mInviteCountLimit)},E.prototype.shareMomentsClick=function(){_.default.Ins().saveSkinItemInfo(this.mSkin),p.MGShareUtils.shareForInviteSkin("playerId",r.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN+"_"+this.mSkin.name,function(A){s.default.i("\u9080\u8BF7\u597D\u53CB\u5F97\u76AE\u80A4\u5361\u7247\u5206\u4EAB,result : "+A),u.default.fire(c.default.SHARE_HOME_SHOW_INVITE_TIPS)},"3",this.mSkin.displayName,this.mInviteCountLimit)},E.prototype.start=function(){},E.skinName="ice",__decorate([v(cc.Layout)],E.prototype,"content_layout",void 0),__decorate([v(cc.Sprite)],E.prototype,"skin_bg",void 0),__decorate([v(cc.Button)],E.prototype,"invite_fds_btn",void 0),__decorate([v(cc.Node)],E.prototype,"share_moments_btn",void 0),__decorate([v(cc.Button)],E.prototype,"close_btn",void 0),__decorate([v(cc.Sprite)],E.prototype,"invite_count_text",void 0),__decorate([v(cc.Sprite)],E.prototype,"invite_count_total_text",void 0),__decorate([v([cc.Sprite])],E.prototype,"avatar_sprite",void 0),__decorate([v([cc.Layout])],E.prototype,"mask_layout",void 0),__decorate([v(cc.Layout)],E.prototype,"invite_count_layout",void 0),__decorate([v(cc.Button)],E.prototype,"try_btn",void 0),__decorate([v(cc.Prefab)],E.prototype,"mToastPrefb",void 0),__decorate([v(cc.Prefab)],E.prototype,"mSaveToAlbumPrefb",void 0),__decorate([v(cc.Layout)],E.prototype,"popup_layout",void 0),E=__decorate([I],E)}(f.default);m.default=C,cc._RF.pop()},{"../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../base/G":"G","../../base/Log":"Log","../../infoc/m_p2_daily_activity":"m_p2_daily_activity","../../social/AvatarUtil":"AvatarUtil","../Logic/EventBus":"EventBus","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/MusicLib/HotMusicCMShareController":"HotMusicCMShareController","../UI/GameEntraScene/mainpage/MainpageBaseComponent":"MainpageBaseComponent","../UI/GameEntraScene/mainpage/WelfareController":"WelfareController","../reward/ActivityBean":"ActivityBean","../reward/ActivityRewardManager":"ActivityRewardManager","./SkinTryData":"SkinTryData","./SkinUtils":"SkinUtils"}],CMPlayAdapter:[function(l,P,m){"use strict";cc._RF.push(P,"99af6VO1OBFdpWRCUoHO/Do","CMPlayAdapter"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.needDownloadRes=function(){return!1},r.prototype.isSupportDownloadRes=function(){return!1},r.prototype.createCanvas=function(){return s.prototype.createCanvas.call(this)},r.prototype.createImage=function(){return s.prototype.createImage.call(this)},r.prototype.onShowListen=function(o){},r.prototype.offShowListen=function(o){},r.prototype.onHideListen=function(o){},r.prototype.offHideListen=function(o){},r.prototype.getLaunchParameter=function(){return null},r.prototype.getShareCanvas=function(){return s.prototype.getShareCanvas.call(this)},r.prototype.getUserDataPath=function(){return""},r.prototype.unZip=function(o,e,n,t){t&&t()},r.prototype.downloadFile=function(o,e,n,t,i){return t===void 0&&(t=0),i===void 0&&(i=!0),n&&n(),null},r.prototype.getFileSystemManager=function(){return s.prototype.getFileSystemManager.call(this)},r.prototype.getImageSrc=function(o){return o},r.prototype.loadImage=function(o){},r.prototype.getSharePath=function(o){return o},r.prototype.saveShareTmpFile=function(o,e){return""},r}(l("./DefaultAdapter").default);m.default=d,cc._RF.pop()},{"./DefaultAdapter":"DefaultAdapter"}],CMTouchEvent:[function(l,P,m){"use strict";var d,s,r,o,e;cc._RF.push(P,"2315cCSX6VAw7sifTubrubV","CMTouchEvent"),Object.defineProperty(m,"__esModule",{value:!0}),(s=d=m.CMState||(m.CMState={}))[s.IDLE=0]="IDLE",s[s.PRESSED=1]="PRESSED",s[s.RELEASED=2]="RELEASED",(r=m.CMTouchState||(m.CMTouchState={}))[r.IDLE=0]="IDLE",r[r.PRESSED=1]="PRESSED",r[r.ERROR=2]="ERROR",(e=o=m.CMTouchID||(m.CMTouchID={}))[e.D=0]="D",e[e.F=1]="F",e[e.J=2]="J",e[e.K=3]="K";var n=function(){function t(){this.touchs=[],this.touchs.push({id:o.D,state:d.IDLE,x:0,y:0,update:!1}),this.touchs.push({id:o.F,state:d.IDLE,x:0,y:0,update:!1}),this.touchs.push({id:o.J,state:d.IDLE,x:0,y:0,update:!1}),this.touchs.push({id:o.K,state:d.IDLE,x:0,y:0,update:!1})}return t.prototype.update=function(i,a,u,c){u===void 0&&(u=0),c===void 0&&(c=0);for(var p=0;p<this.touchs.length;p++){var h=this.touchs[p];if(h.id==i&&a!=h.state){h.state=a,h.x=u,h.y=c,h.update=!0;break}}},t.prototype.getPressedEvents=function(){for(var i=[],a=0;a<this.touchs.length;a++){var u=this.touchs[a];u.update&&u.state==d.PRESSED&&(i.push(u),u.update=!1)}return i},t.prototype.getReleasedEvents=function(){for(var i=[],a=0;a<this.touchs.length;a++){var u=this.touchs[a];u.update&&u.state==d.RELEASED&&(i.push(u),u.update=!1)}return i},t}();m.CMTouchEvent=n,cc._RF.pop()},{}],CSV:[function(l,P,m){"use strict";cc._RF.push(P,"0382fqCNNtP+IgKYN8A5EDC","CSV"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvOption"),s=["|","^"],r=[",",";","	","|","^"],o=["\r\n","\r","\n"],e=function(){function i(a,u){if(u||(u=new d.default),n(a))this.mode="encode";else{if(typeof a!="string")throw new Error("Incompatible format!");this.mode="parse"}this.data=a;var c=(this.options=u).lineDelimiter||u.line,p=u.cellDelimiter||u.delimiter;this.isParser()?(this.options.lineDelimiter=c||t(this.data,o),this.options.cellDelimiter=p||t(this.data,r)):this.isEncoder()&&(this.options.lineDelimiter=c||"\r\n",this.options.cellDelimiter=p||",")}return i.prototype.isParser=function(){return this.mode=="parse"},i.prototype.isEncoder=function(){return this.mode=="encode"},i.prototype.parse=function(a){if(this.isParser){if(this.data.trim().length===0)return[];var u,c,p=this.data,h=this.options,f=h.header,g={cell:"",line:[]};a||(c=[],a=function(D){c.push(D)}),h.lineDelimiter.length==1&&(M=A);var _,y,S,I=p.length,v=h.cellDelimiter.charCodeAt(0),C=h.lineDelimiter.charCodeAt(h.lineDelimiter.length-1);for(T(),y=_=0;_<I;_++)S=p.charCodeAt(_),u.cell&&(u.cell=!1,S==34)?u.escaped=!0:u.escaped&&S==34?u.quote=!u.quote:(u.escaped&&u.quote||!u.escaped)&&(S==v&&(A(g.cell+p.slice(y,_)),y=_+1),S==C?(M(g.cell+p.slice(y,_)),y=_+1,k(),E()):_==I-1&&(A(g.cell+p.slice(y,I)),y=_+1,k(),E()));return c||this}function T(){u={escaped:!1,quote:!1,cell:!0}}function E(){g.line=[]}function A(D){g.line.push(u.escaped?D.slice(1,-1).replace(/""/g,'"'):D),g.cell="",T()}function M(D){A(D.slice(0,1-h.lineDelimiter.length))}function k(){f?n(f)?a(g.line):f=g.line:a(g.line)}},i}();m.default=e;var n=Array.isArray||function(i){return toString.call(i)==="[object Array]"};function t(i,a){var u,c=0;return a.forEach(function(p){var h=p;s.indexOf(p)!=-1&&(h="\\"+h);var f=i.match(new RegExp(h,"g"));f&&f.length>c&&(c=f.length,u=p)}),u||a[0]}cc._RF.pop()},{"./CsvOption":"CsvOption"}],CanvasFunction:[function(l,P,m){"use strict";cc._RF.push(P,"f753ai2X01LlJu+2NU9SKyA","CanvasFunction"),Object.defineProperty(m,"__esModule",{value:!0}),function(d){var s=Math.PI/2;function r(o,e,n,t,i,a,u){var c=n.rect;if(n.rotated){var p=s;o.rotate(-p),o.drawImage(e.image,c.x,c.y,c.height,c.width,i,t,u,a),o.rotate(p)}else o.drawImage(e.image,c.x,c.y,c.width,c.height,t,i,a,u)}d.drawPartImageItemScale=function(o,e,n,t,i,a,u,c,p,h,f){var g=n.rect;o.drawImage(e.image,g.x+t,g.y+i,a,u,c,p,h,f)},d.drawImageItemScale=r,d.drawImageItem=function(o,e,n,t,i){var a=n.rect;r(o,e,n,t,i,a.width,a.height)}}(m.CanvasFunction||(m.CanvasFunction={})),cc._RF.pop()},{}],ChangePlayIdPrefb:[function(l,P,m){"use strict";cc._RF.push(P,"c57504shhxJyLmT5rcPeyCY","ChangePlayIdPrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Log"),s=l("../../../util/StringUtil"),r=l("../../../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),o=cc._decorator,e=o.ccclass,n=o.property,t=function(i){function a(){var u=i!==null&&i.apply(this,arguments)||this;return u.mOKBtn=null,u.mInputEditBox=null,u}return __extends(a,i),a.prototype.onLoad=function(){this.mOKBtn.node.on(cc.Node.EventType.TOUCH_END,this.onOK,this);var u=r.MGBasic.getStorage(this.getStorageKey());s.StringUtil.isEmpty(u)||(this.mInputEditBox.string=u)},a.prototype.onOK=function(){var u=this.mInputEditBox.string;d.default.l("[ChangePlayIdPrefb] input playID="+u),u&&0<u.length?r.MGBasic.setStorage(this.getStorageKey(),u):r.MGBasic.setStorage(this.getStorageKey(),""),this.node.destroy()},a.prototype.getStorageKey=function(){return"web_playid"},__decorate([n(cc.Button)],a.prototype,"mOKBtn",void 0),__decorate([n(cc.EditBox)],a.prototype,"mInputEditBox",void 0),a=__decorate([e],a)}(cc.Component);m.default=t,cc._RF.pop()},{"../../../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../../base/Log":"Log","../../../util/StringUtil":"StringUtil"}],CheckActivityRewardProcessor:[function(l,P,m){"use strict";cc._RF.push(P,"cc1a1y1aZhNsbPJuWSG4els","CheckActivityRewardProcessor"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Log"),s=l("../../../base/G"),r=l("../../../util/StringUtil"),o=l("../../reward/ActivityRewardManager"),e=l("../../reward/ActivityBean"),n=l("./ActivityInviteTipsPrefab"),t=l("../../Network/Protocol/StorageUtil"),i=l("../../../config/LSKey"),a=l("../../Logic/Plugin/UnlockProcessor"),u=l("../../Logic/NotifyEvent"),c=l("../../Logic/EventBus"),p=l("../../../infoc/minigame_piano2_hotmusic"),h=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),f=l("../../../../modules/MGAppShare/scripts/ShareHelper"),g=l("../../../util/QQReport"),_=l("./PrefabMgr"),y=l("../../Logic/SkinDataManager"),S=l("../../skin/frag/SkinTaskMgr"),I=l("../../HolidayGift/HolidayTaskMgr"),v=l("./MusicLib/HotMusicCMShareController"),C=function(){function T(E){this.mDialogManager=null,this.mCheckingShareForSkinInvitee=!1,this.mCheckingShareForSkinInviter=!1,this.mCMCheckingShareForSkinInviter=!1,this.mCMCheckingShareForSongInviter=!1,this.mCheckingShareForSongInvitee=!1,this.mCheckingShareForSongInviter=!1,this.mCheckingShareForSkinPieceInvitee=!1,this.mCheckingShareForSkinPieceInviter=!1,this.mCheckingShareForAddFriendInvitee=!1,this.mCheckingShareForAddFriendInviter=!1,this.mCheckingShareForToneInvitee=!1,this.mCheckingShareForToneInviter=!1,this.prefabName="prefab/ActivityInviteTipsPrefab",this.mDialogManager=E}return T.prototype.checkLittleStarInviteeReward=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(E){switch(E.label){case 0:return[4,this.checkShareForSkinInviteeReward()];case 1:return E.sent(),[2]}})})},T.prototype.checkShareForSkinInviteeReward=function(){var E=this;return new Promise(function(A,M){if(E.mCheckingShareForSkinInvitee!=1){var k=s.G.getLaunchOption();if(k&&k.query){var D=void 0,L=void 0;if(k.query.source==f.ShareHelper.SHARE_SOURCE_INVITE_SKIN)L=k.query.activityId,D=k.query.inviterId;else if(k.query.q){var b=decodeURIComponent(k.query.q);D=r.StringUtil.getQueryString(b,"id"),L=r.StringUtil.getQueryString(b,"act")}if(!D||D==="")return void A(!1);E.mCheckingShareForSkinInvitee=!0,h.MGUser.getUserLoginInfo({complete:function(N){N&&N.playerId==D?(E.mCheckingShareForSkinInviter=!1,A(!1)):L&&L!==""?o.ActivityRewardMgr.Ins().acceptInvite(L,D,function(H,R){E.mCheckingShareForSkinInvitee=!1,A(H)}):(E.mCheckingShareForSkinInvitee=!1,A(!1))}})}else A(!1)}else A(!1)})},T.prototype.checkShareForSkinInviterReward=function(E,A){var M=this;return new Promise(function(k,D){if(M.mCheckingShareForSkinInviter!=1){M.mCheckingShareForSkinInviter=!0;var L=o.ActivityRewardMgr.Ins().getCacheInviteRewardListSize(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN);o.ActivityRewardMgr.Ins().getInviteSuccessListComplete(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN,function(b){if(!b)return M.mCheckingShareForSkinInviter=!1,void k(!1);3<=b.length?t.default.read(i.default.HAS_SHOW_INVITE_3_FOR_SKIN_DIALOG)?(M.mCheckingShareForSkinInviter=!1,k(!1)):_.default.load(M.prefabName,function(N,H){if(H){t.default.save(i.default.HAS_SHOW_INVITE_3_FOR_SKIN_DIALOG,"true");var R=H.getComponent(n.default);R.setContent("\u60A8\u5DF2\u7ECF\u6210\u529F\u9080\u8BF73\u540D\u65B0\u73A9\u5BB6\u8FDB\u5165\u6E38\u620F\uFF0C\u8D60\u9001\u60A8\u51B0\u96EA\u5947\u7F18\u76AE\u80A4"),R.setBottomTips("\u7ACB\u5373\u4F7F\u7528"),R.setCloseCallback(function(){M.mDialogManager.dismissDialog(H),A&&A(k),M.mCheckingShareForSkinInviter=!1,k(!0)}),R.setConfirmCallback(function(){M.mDialogManager.dismissDialog(H),E&&E(!0,k),M.mCheckingShareForSkinInviter=!1,k(!0)}),M.mDialogManager.showDialog(H)}else M.mCheckingShareForSkinInviter=!1,k(!1)}):L<b.length?_.default.load(M.prefabName,function(N,H){if(H){var R=H.getComponent(n.default);R.setContent("\u60A8\u5DF2\u7ECF\u6210\u529F\u9080\u8BF7"+b.length+"\u540D\u65B0\u73A9\u5BB6\u8FDB\u5165\u6E38\u620F\uFF0C\u518D\u9080\u8BF7"+(3-b.length)+"\u4EBA\u5373\u53EF\u83B7\u5F97\u51B0\u96EA\u5947\u7F18\u76AE\u80A4"),R.setBottomTips("\u7EE7\u7EED\u9080\u8BF7"),R.setCloseCallback(function(){M.mDialogManager.dismissDialog(H),A&&A(k),M.mCheckingShareForSkinInviter=!1,k(!0)}),R.setConfirmCallback(function(){M.mDialogManager.dismissDialog(H),E&&E(!1,k),M.mCheckingShareForSkinInviter=!1,k(!0)}),M.mDialogManager.showDialog(H)}else M.mCheckingShareForSkinInviter=!1,k(!1)}):(M.mCheckingShareForSkinInviter=!1,k(!1))})}else k(!1)})},T.prototype.checkCMShareForSkinInviterReward=function(E,A,M){var k=this;return new Promise(function(D,L){if(k.mCMCheckingShareForSkinInviter==1||E==null)return d.default.l("[CheckActivityRewardProcessor.checkShareForSkinInviterReward] mCheckingInviter is true"),void D(!1);k.mCMCheckingShareForSkinInviter=!0;var b=[];E.forEach(function(N){b.push(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN+"_"+N.name)}),o.ActivityRewardMgr.Ins().getCacheInviteRewardListSize(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN),o.ActivityRewardMgr.Ins().getInviteList(b,function(N){if(!N)return d.default.i("[checkShareForSongInviterReward] \u7F51\u7EDC\u8FD4\u56DE\u6570\u636E\u4E3A\u7A7A"),setTimeout(function(){k.mCMCheckingShareForSkinInviter=!1},5e3),void D(!1);d.default.i("[CheckActivityRewardProcessor] \u670D\u52A1\u7AEF\u8FD4\u56DE\u6570\u636E data: ",N);for(var H=!1,R=function(U){var B=N.get(b[U]);if(!B||B.length<=0)return setTimeout(function(){k.mCMCheckingShareForSkinInviter=!1},5e3),D(!1),{value:void 0};var Q=[];if(0<B.length&&B.forEach(function(Z){if(Q.push(Z),Z.is_new_player){var z=Object.assign({},Z);z.needMark=!0,Q.push(z)}}),Q.length>=y.SkinDataMgr.Ins().getSkinInviteLimitBySkiniId(E[U].name)){if(H)return"continue";v.default.Ins().removeSkinItemInfo(E[U]),H=!0,_.default.load(k.prefabName,function(Z,z){if(z){var W=z.getComponent(n.default);W.setContent("\u60A8\u5DF2\u7ECF\u6210\u529F\u9080\u8BF7"+Q.length+"\u540D\u597D\u53CB\u6210\u529F\u52A9\u529B\uFF0C\u8D60\u9001\u60A8"+E[U].displayName+"\u76AE\u80A4"),W.setBottomTips("\u7ACB\u5373\u4F7F\u7528"),W.setCloseCallback(function(){k.mDialogManager.dismissDialog(z),M&&M(D),setTimeout(function(){k.mCMCheckingShareForSkinInviter=!1},5e3),D(!0)}),W.setConfirmCallback(function(){k.mDialogManager.dismissDialog(z),A&&A(!0,D),setTimeout(function(){k.mCMCheckingShareForSkinInviter=!1},5e3),D(!0)}),k.mDialogManager.showDialog(z)}else setTimeout(function(){k.mCMCheckingShareForSkinInviter=!1},5e3),D(!1)})}else setTimeout(function(){k.mCMCheckingShareForSkinInviter=!1},5e3),D(!1)},F=0;F<b.length;F++){var x=R(F);if(typeof x=="object")return x.value}H||(setTimeout(function(){k.mCMCheckingShareForSkinInviter=!1},5e3),D(!1))})})},T.prototype.checkShareForSongInviteeReward=function(){var E=this;return new Promise(function(A,M){if(E.mCheckingShareForSongInvitee!=1){var k=s.G.getLaunchOption();if(k&&k.query){var D=void 0,L=void 0;if(k.query.source==f.ShareHelper.SHARE_SOURCE_INVITE_SONG&&(L=k.query.activityId,D=k.query.inviterId),!D||D==="")return void A(!1);E.mCheckingShareForSongInvitee=!0,h.MGUser.getUserLoginInfo({complete:function(b){b&&b.playerId==D?(E.mCheckingShareForSongInvitee=!1,A(!1)):L&&L!==""?o.ActivityRewardMgr.Ins().acceptInvite(L,D,function(N,H){E.mCheckingShareForSongInvitee=!1,A(N)}):(E.mCheckingShareForSongInvitee=!1,A(!1))}})}else E.mCheckingShareForSongInvitee=!1,A(!1)}else A(!1)})},T.prototype.checkShareForSongInviterReward=function(E,A,M){var k=this;return new Promise(function(D,L){if(k.mCheckingShareForSongInviter!=1&&E!=null){k.mCheckingShareForSongInviter=!0;var b=[];E.forEach(function(N){b.push(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG+N.musicId)}),d.default.i("[CheckActivityRewardProcessor] hd_ids =  ",b),o.ActivityRewardMgr.Ins().getBatchInviteSuccessListComplete(b,function(N){if(!N)return setTimeout(function(){k.mCheckingShareForSongInviter=!1},5e3),void D(!1);d.default.i("[CheckActivityRewardProcessor] \u670D\u52A1\u7AEF\u8FD4\u56DE\u6570\u636E data: ",N);for(var H=!1,R=0;R<b.length;R++){var F=N.get(b[R]);if(F&&0<F.length&&!F[0].isConsume){o.ActivityRewardMgr.Ins().cosumeInviteRewardInfo(b[R],F[0]);var x=a.default.unlockByShare(E[R].id,E[R].musicId);if(console.log("[CheckActivityRewardProcessor] UnlockProcessor.unlockByShare unlock = "+x+",items[i].musicId = "+E[R].musicId),p.default.report(p.default.ACTION_INVITE_SUCC,0,E[R].musicId,r.StringUtil.getFixedlengthStr(E[R].musicName,16),1),g.QQReport.reportUnLockSong(1),H)continue;H=!0,_.default.load(k.prefabName,function(U,B){if(B){t.default.save(i.default.HAS_SHOW_INVITE_FOR_SONG_DIALOG,"true");var Q=B.getComponent(n.default);Q.setContent("\u5DF2\u7ECF\u6709\u65B0\u73A9\u5BB6\u5E2E\u60A8\u89E3\u9501\u4E86\u70ED\u66F2\uFF0C\u5FEB\u53BB\u5F39\u594F\u5427"),Q.setBottomTips("\u53BB\u5F39\u594F"),Q.setCloseCallback(function(){k.mDialogManager.dismissDialog(B),M&&M(D),setTimeout(function(){k.mCheckingShareForSongInviter=!1},5e3),D(!0)}),Q.setConfirmCallback(function(){k.mDialogManager.dismissDialog(B),A&&A(!0,D),setTimeout(function(){k.mCheckingShareForSongInviter=!1},5e3),D(!0)}),k.mDialogManager.showDialog(B),c.default.fire(u.default.UPDATE_MUSIC_LIST_HEIGHT,1)}else setTimeout(function(){k.mCheckingShareForSongInviter=!1},5e3),D(!1)})}}H||(setTimeout(function(){k.mCheckingShareForSongInviter=!1},5e3),D(!1))})}else D(!1)})},T.prototype.checkCMShareForSongInviterReward=function(E,A,M){var k=this;return d.default.l("CMPlayShare [CheckActivityRewardProcessor.checkShareForSongInviterReward] enter"),new Promise(function(D,L){if(k.mCMCheckingShareForSongInviter==1||E==null)return d.default.l("[CheckActivityRewardProcessor.checkShareForSongInviterReward] mCheckingInviter is true"),void D(!1);k.mCMCheckingShareForSongInviter=!0;var b=[];E.forEach(function(N){b.push(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG+"_"+N.musicId)}),d.default.i("[CheckActivityRewardProcessor] hd_ids =  ",b),o.ActivityRewardMgr.Ins().getInviteList(b,function(N){if(!N)return setTimeout(function(){k.mCMCheckingShareForSongInviter=!1},5e3),void D(!1);d.default.i("[CheckActivityRewardProcessor] \u670D\u52A1\u7AEF\u8FD4\u56DE\u6570\u636E data: ",N);for(var H=!1,R=0;R<b.length;R++){var F=N.get(b[R]);if(F&&0<F.length){var x=a.default.unlockByVideo(E[R].id,E[R].musicId);if(v.default.Ins().removeItemInfo(E[R]),console.log("[CheckActivityRewardProcessor] UnlockProcessor.unlockByShare unlock = "+x+",items[i].musicId = "+E[R].musicId),H)continue;H=!0,_.default.load(k.prefabName,function(U,B){if(B){t.default.save(i.default.HAS_SHOW_INVITE_FOR_SONG_DIALOG,"true");var Q=B.getComponent(n.default);Q.setContent("\u5DF2\u7ECF\u6709\u597D\u53CB\u52A9\u529B\u5E2E\u60A8\u89E3\u9501\u4E86\u70ED\u66F2\uFF0C\u5FEB\u53BB\u5F39\u594F\u5427"),Q.setBottomTips("\u53BB\u5F39\u594F"),Q.setCloseCallback(function(){k.mDialogManager.dismissDialog(B),M&&M(D),setTimeout(function(){k.mCMCheckingShareForSongInviter=!1},5e3),D(!0)}),Q.setConfirmCallback(function(){k.mDialogManager.dismissDialog(B),A&&A(!0,D),setTimeout(function(){k.mCMCheckingShareForSongInviter=!1},5e3),D(!0)}),k.mDialogManager.showDialog(B),c.default.fire(u.default.UPDATE_MUSIC_LIST_HEIGHT,1)}else setTimeout(function(){k.mCMCheckingShareForSongInviter=!1},5e3),D(!1)})}else setTimeout(function(){k.mCMCheckingShareForSongInviter=!1},5e3),D(!1)}H||(setTimeout(function(){k.mCMCheckingShareForSongInviter=!1},5e3),D(!1))})})},T.prototype.checksShareForSkinInvitee=function(){var E=this;return new Promise(function(A,M){if(E.mCheckingShareForSkinPieceInvitee!=1){var k=s.G.getLaunchOption();if(k&&k.query){var D=void 0,L=void 0,b="\u4F5A\u540D",N="";if(k.query.source==f.ShareHelper.SHARE_SOURCE_SKIN_PIECE&&(L=k.query.activityId,D=k.query.inviterId,b=k.query.nickName,N=k.query.skinId),!D||D==="")return void A(!1);E.mCheckingShareForSkinPieceInvitee=!0,h.MGUser.getUserLoginInfo({complete:function(H){H&&H.playerId==D?(E.mCheckingShareForSkinPieceInvitee=!1,A(!1)):L&&L!==""?o.ActivityRewardMgr.Ins().acceptInvite(L,D,function(R,F){R&&F.valid?(_.default.load(E.prefabName,function(x,U){if(U){var B=U.getComponent(n.default);B.setContent(cc.js.formatStr("\u60A8\u5DF2\u7ECF\u5E2E\u52A9\u73A9\u5BB6\u201C%s\u201D\u83B7\u5F97\u4E86\u300A%s\u300B\u76AE\u80A4\u788E\u7247",b,y.SkinDataMgr.Ins().getSkinItemInfoBySkinId(N).displayName)),B.setBottomTips("\u786E\u5B9A"),B.setCloseCallback(function(){E.mDialogManager.dismissDialog(U),setTimeout(function(){E.mCheckingShareForSkinPieceInvitee=!1},5e3),A(!0)}),B.setConfirmCallback(function(){E.mDialogManager.dismissDialog(U),setTimeout(function(){E.mCheckingShareForSkinPieceInvitee=!1},5e3),A(!0)}),E.mDialogManager.showDialog(U)}else setTimeout(function(){E.mCheckingShareForSkinPieceInvitee=!1},5e3),A(!1)}),A(R)):(E.mCheckingShareForSkinPieceInvitee=!1,A(!1))}):(E.mCheckingShareForSkinPieceInvitee=!1,A(!1))}})}else E.mCheckingShareForSkinPieceInvitee=!1,A(!1)}else A(!1)})},T.prototype.checkShareForSkinPieceInviterReward=function(E,A,M){var k=this;return new Promise(function(D,L){if(k.mCheckingShareForSkinPieceInviter!=1&&E!=null){k.mCheckingShareForSkinPieceInviter=!0;var b=[];E.forEach(function(N){b.push(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN_PIECE+N.skinId)}),d.default.i("[CheckActivityRewardProcessor] checkShareForSkinPieceInviterReward hd_ids =  ",b),o.ActivityRewardMgr.Ins().getBatchInviteSuccessListComplete(b,function(N){if(!N)return setTimeout(function(){k.mCheckingShareForSkinPieceInviter=!1},5e3),void D(!1);d.default.i("[CheckActivityRewardProcessor] checkShareForSkinPieceInviterReward \u670D\u52A1\u7AEF\u8FD4\u56DE\u6570\u636E data: ",N);for(var H=!1,R=!1,F=function(U){var B=N.get(b[U]);if(B&&0<B.length&&!B[0].isConsume){for(var Q=0,Z="\u4F5A\u540D",z=0;z<B.length;z++){var W=B[z];W.is_new_player&&!W.isConsume&&(Z=W.nickname,o.ActivityRewardMgr.Ins().cosumeInviteRewardInfo(b[U],W),Q++)}if(d.default.i("[CheckActivityRewardProcessor] checkShareForSkinPieceInviterReward =====>>> count "+Q),0<Q){var V=new S.ShareEvent;V.skinId=E[U].skinId,V.count=Q,S.default.Ins().notifyShareEvent(V),R=!0}if(H)return"continue";R&&(H=!0,_.default.load(k.prefabName,function(Y,q){if(q){var J=q.getComponent(n.default);J.setContent(cc.js.formatStr("\u73A9\u5BB6\u201C%s\u201D\u7B49\u5E2E\u52A9\u60A8\u83B7\u5F97\u4E86\u300A%s\u300B\u76AE\u80A4\u788E\u7247",Z,y.SkinDataMgr.Ins().getSkinItemInfoBySkinId(E[U].skinId).displayName)),J.setBottomTips("\u53BB\u67E5\u770B"),J.setCloseCallback(function(){k.mDialogManager.dismissDialog(q),M&&M(D),setTimeout(function(){k.mCheckingShareForSkinPieceInviter=!1},5e3),D(!0)}),J.setConfirmCallback(function(){k.mDialogManager.dismissDialog(q),A&&A(E[U].skinId,D),setTimeout(function(){k.mCheckingShareForSkinPieceInviter=!1},5e3),D(!0)}),k.mDialogManager.showDialog(q)}else setTimeout(function(){k.mCheckingShareForSkinPieceInviter=!1},5e3),D(!1)}))}},x=0;x<b.length;x++)F(x);H||(setTimeout(function(){k.mCheckingShareForSkinPieceInviter=!1},5e3),D(!1))})}else D(!1)})},T.prototype.checkShareForToneInvitee=function(){var E=this;return new Promise(function(A,M){if(E.mCheckingShareForToneInvitee!=1){var k=s.G.getLaunchOption();if(k&&k.query){var D=void 0,L=void 0,b="\u4F5A\u540D";if(k.query.source==f.ShareHelper.SHARE_SOURCE_TONE&&(L=k.query.activityId,D=k.query.inviterId,b=k.query.nickName),d.default.i("[CheckActivityRewardProcessor.checkShareForSongInviteeReward] activityId = "+L+",inviterId = "+D+",nickName = "+b),!D||D==="")return void A(!1);E.mCheckingShareForToneInvitee=!0,h.MGUser.getUserLoginInfo({complete:function(N){N&&N.playerId==D?(E.mCheckingShareForToneInvitee=!1,A(!1)):L&&L!==""?o.ActivityRewardMgr.Ins().acceptInvite(L,D,function(H,R){d.default.i("[CheckActivityRewardProcessor.checkShareForToneInvitee] acceptInvite result = "+H+",helpRewardInfo = ",R),E.mCheckingShareForToneInvitee=!1,A(!1)}):(E.mCheckingShareForToneInvitee=!1,A(!1))}})}else E.mCheckingShareForToneInvitee=!1,A(!1)}else A(!1)})},T.prototype.checkShareForToneInviter=function(E,A,M){var k=this;return new Promise(function(D,L){if(k.mCheckingShareForToneInviter!=1&&E&&E.length!=0){k.mCheckingShareForToneInviter=!0;var b=[];E.forEach(function(N){b.push(e.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_UNLOCK_TONE+N.taskID)}),d.default.i("[CheckActivityRewardProcessor] checkShareForToneInviter hd_ids =  ",b),o.ActivityRewardMgr.Ins().getBatchInviteSuccessListComplete(b,function(N){if(!N)return setTimeout(function(){k.mCheckingShareForToneInviter=!1},5e3),void D(!1);d.default.i("[CheckActivityRewardProcessor] checkShareForToneInviter \u670D\u52A1\u7AEF\u8FD4\u56DE\u6570\u636E data: ",N);for(var H=!1,R=function(x){var U=N.get(b[x]);if(U&&0<U.length){for(var B=0,Q=0;Q<U.length;Q++){var Z=U[Q];Z.is_new_player&&!Z.isConsume&&(Z.nickname,o.ActivityRewardMgr.Ins().cosumeInviteRewardInfo(b[x],Z),B++)}if(d.default.i("[CheckActivityRewardProcessor] checkShareForToneInviter =====>>> count "+B),0<B&&I.default.Ins().RefreshTask(E[x].taskKey,B),H)return"continue"}},F=0;F<b.length;F++)R(F);H||(setTimeout(function(){k.mCheckingShareForToneInviter=!1},5e3),D(!1))})}else D(!1)})},T}();m.default=C,cc._RF.pop()},{"../../../../modules/MGAppShare/scripts/ShareHelper":"ShareHelper","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../base/G":"G","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../infoc/minigame_piano2_hotmusic":"minigame_piano2_hotmusic","../../../util/QQReport":"QQReport","../../../util/StringUtil":"StringUtil","../../HolidayGift/HolidayTaskMgr":"HolidayTaskMgr","../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../Logic/Plugin/UnlockProcessor":"UnlockProcessor","../../Logic/SkinDataManager":"SkinDataManager","../../Network/Protocol/StorageUtil":"StorageUtil","../../reward/ActivityBean":"ActivityBean","../../reward/ActivityRewardManager":"ActivityRewardManager","../../skin/frag/SkinTaskMgr":"SkinTaskMgr","./ActivityInviteTipsPrefab":"ActivityInviteTipsPrefab","./MusicLib/HotMusicCMShareController":"HotMusicCMShareController","./PrefabMgr":"PrefabMgr"}],CheckRewardProcessor:[function(l,P,m){"use strict";cc._RF.push(P,"51ac2ciB31IYo96YbtlMKXg","CheckRewardProcessor"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Logic/ShareRewardController"),s=l("../../Logic/MoneySystem"),r=l("../../../infoc/m_p2_PData_Dia"),o=l("../../../base/G"),e=l("../../reward/RewardManager"),n=l("../../Logic/EventBus"),t=l("../../Logic/NotifyEvent"),i=l("../../../infoc/m_p2_Uaction"),a=l("../../../util/StringUtil"),u=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),c=l("../../../../modules/MGAppShare/scripts/MGShareUtil"),p=l("../../../../modules/MGAppShare/scripts/ShareHelper"),h=l("../../awardcontroller/AwardController"),f=l("../../Logic/GameItemsManager"),g=l("../../../property/PropertyDefines"),_=l("../../Network/Protocol/StorageUtil"),y=l("../../../config/LSKey"),S=l("../../../base/Log"),I=l("../../../util/DateUtil"),v=l("../../../util/TimeUtil"),C=l("../../../SubscriptionUtils"),T=function(){function E(A){this.mDialogManager=null,this.mCheckingInvitee=!1,this.mCheckingInviter=!1,this.FIRST_GET_REWARD_FROM_SUB="first",this.SIGN_GET_REWARD_FROM_SUB="sign",this.mDialogManager=A}return E.prototype.checkLittleStarInviteeReward=function(A){var M=this;if(this.mCheckingInvitee!=1){var k=o.G.getLaunchOption();if(k&&k.query,k&&k.query){var D=this.getInviterIdFromQuery(k.query);if(!D||D==="")return;this.mCheckingInvitee=!0,d.default.checkLittleStarInviteeReward(D,function(L){L?A.addChild(L):M.mCheckingInvitee=!1},function(L){s.MoneySystem.increaseDiamond(L),r.default.report(L,r.default.SOURCE_INVITEE_GET_REWARD,r.default.ACTION_GET_DIAMOND),M.mCheckingInvitee=!1})}}},E.prototype.getInviterIdFromQuery=function(A){var M=void 0;if(A.source==p.ShareHelper.SHARE_SOURCE_INVITE_FRIEND||A.source==p.ShareHelper.SHARE_SOURCE_RELIVE)M=A.inviterId;else if(A.q){var k=decodeURIComponent(A.q),D=a.StringUtil.getQueryString(k,"act");D&&D!==""||(M=a.StringUtil.getQueryString(k,"id"))}return M},E.prototype.showFollowCustomerReward=function(A){var M=this.controlFollowReward();if(a.StringUtil.isEmpty(M))A(!1);else{var k=new h.AwardResultInfo;M==this.FIRST_GET_REWARD_FROM_SUB?(k.addAwardContent(f.GameItemType.TYPE_DIAMONDS,C.SubscriptionUtils.REWARD_DIAMOND,g.PROPERTYITEMID.ID_DIAMOND),k.addAwardContent(f.GameItemType.TYPE_GOLD,C.SubscriptionUtils.REWARD_COIN,g.PROPERTYITEMID.ID_COINS),k.addAwardContent(f.GameItemType.TYPE_SKIN,1,g.PROPERTYITEMID.ID_SKIN_STARS1)):M==this.SIGN_GET_REWARD_FROM_SUB&&k.addAwardContent(f.GameItemType.TYPE_DIAMONDS,C.SubscriptionUtils.REWARD_DIAMOND_SGIN,g.PROPERTYITEMID.ID_DIAMOND),k.setIsNeedGiveAwardInfo(!0).setOkBtn("\u597D\u7684",function(){h.AwardController.getIns().dismissAwardResultPage(k),A(!0)}).setTitlePicPath("/static_res/share_gift_congratulation_title").setBottomLeftText(" \u606D\u559C\u83B7\u5F97 ").setBottomRightText(" \u5173\u6CE8\u516C\u4F17\u53F7\u5956\u52B1"),h.AwardController.getIns().showCommonAwardResultPage(k),n.default.fire(t.default.GAIN_REWARD_FROM_DESCRIPTION),_.default.save(y.default.GET_REWARD_FROM_SUBSCRIPTION_FOLLOW,u.MGUser.getCurrentServerTime().toString())}},E.prototype.controlFollowReward=function(){var A=_.default.read(y.default.GET_REWARD_FROM_SUBSCRIPTION_FOLLOW);if(a.StringUtil.isEmpty(A))return this.FIRST_GET_REWARD_FROM_SUB;var M=new Date(parseInt(A)),k=new Date(u.MGUser.getCurrentServerTime());return S.default.i("controlFollowReward last date:"+I.default.getFormattedDate(M)+", current date:"+I.default.getFormattedDate(k)),v.default.isSameDay(M,k)?null:this.SIGN_GET_REWARD_FROM_SUB},E.prototype.checkFollowSubscription=function(){var A=this;return new Promise(function(M,k){var D=o.G.getLaunchOption();if(D&&D.scene)if(D.scene==1035&&D.query&&D.query.type=="official_account")A.showFollowCustomerReward(function(L){M(L)}),M(!0);else{if(D.scene!=1e4)return void M(!1);A.showFollowCustomerReward(function(L){M(L)})}else A.checkFollowRewardWithHotStart(function(L){L?A.showFollowCustomerReward(function(b){M(b)}):M(!1)})})},E.prototype.checkFollowRewardWithHotStart=function(A){C.SubscriptionUtils.isOpenFromDialog?(S.default.l("[test] checkFollowRewardWithHotStart  true"),C.SubscriptionUtils.checkPubState(A)):A(!1)},E.prototype.checkInviteeReward=function(A){var M=this;return new Promise(function(k,D){if(M.mCheckingInvitee!=1){var L=o.G.getLaunchOption();if(L&&L.query,L&&L.query){var b=M.getInviterIdFromQuery(L.query);if(!b||b==="")return void k(!1);M.mCheckingInvitee=!0,d.default.checkInviteeReward(b,function(N,H){N?H&&H.isValid&&(M.mDialogManager.showDialog(N),s.MoneySystem.increaseDiamond(H.diamondNum),M.reportUserAction(i.default.ACTION_SHOW_INVITEE_DIALOG),r.default.report(H.diamondNum,r.default.SOURCE_INVITEE_GET_REWARD,r.default.ACTION_GET_DIAMOND)):(M.mCheckingInvitee=!1,k(!1))},function(N,H){M.mCheckingInvitee=!1,M.mDialogManager.dismissDialog(N),A?(A(k),M.reportUserAction(i.default.ACTION_INVITEE_DIALOG_CLICK)):k(!0)},function(N){M.mCheckingInvitee=!1,M.mDialogManager.dismissDialog(N),k(!0)})}else k(!1)}else k(!1)})},E.prototype.checkInviterReward=function(){var A=this;return new Promise(function(M,k){A.mCheckingInviter!=1?(A.mCheckingInviter=!0,d.default.checkInviterReward(function(D,L,b){if(D){if(A.mDialogManager.showDialog(D),n.default.fire(t.default.UPDATE_SHARE_GIFT_TIPS),s.MoneySystem.increaseDiamond(L),b)for(var N=0;N<b.length;N++)e.RewardMgr.Ins().cosumeInviteRewardInfo(b[N]);A.reportGiftBoxResult(),A.reportUserAction(i.default.ACTION_SHOW_INVITER_DIALOG),r.default.report(L,r.default.SOURCE_INVITER_GET_REWARD,r.default.ACTION_GET_DIAMOND)}else A.mCheckingInviter=!1,M(!1)},function(D,L){A.mCheckingInviter=!1,A.mDialogManager.dismissDialog(D),u.MGUser.getUserLoginInfo({complete:function(b){b&&c.MGShareUtils.shareForGiftReward(b.playerId,1,function(N){})}}),A.reportUserAction(i.default.ACTION_INVITER_DIALOG_CLICK),M(!0)},function(D){A.mCheckingInviter=!1,A.mDialogManager.dismissDialog(D),M(!0)})):M(!1)})},E.prototype.reportGiftBoxResult=function(){},E.prototype.reportUserAction=function(A){i.default.report(0,A)},E.prototype.getProcessType=function(){var A=o.G.getLaunchOption();return A&&A.query&&(A.query.source==p.ShareHelper.SHARE_SOURCE_INVITE_FRIEND||A.query.source==p.ShareHelper.SHARE_SOURCE_RELIVE)?E.ENTRANCE_TYPE_FROM_HELP_GETTING_DIAMOND:E.ENTRANCE_TYPE_NORMAL},E.prototype.checkRewards=function(){return __awaiter(this,void 0,void 0,function(){var A;return __generator(this,function(M){switch(M.label){case 0:switch(A=this.getProcessType(),A){case E.ENTRANCE_TYPE_FROM_HELP_GETTING_DIAMOND:return[3,1]}return[3,3];case 1:return[4,this.checkInviteeReward()];case 2:return M.sent(),[3,3];case 3:return[2]}})})},E.ENTRANCE_TYPE_NORMAL=1,E.ENTRANCE_TYPE_FROM_HELP_GETTING_DIAMOND=2,E}();m.default=T,cc._RF.pop()},{"../../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../../modules/MGAppShare/scripts/ShareHelper":"ShareHelper","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../SubscriptionUtils":"SubscriptionUtils","../../../base/G":"G","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../property/PropertyDefines":"PropertyDefines","../../../util/DateUtil":"DateUtil","../../../util/StringUtil":"StringUtil","../../../util/TimeUtil":"TimeUtil","../../Logic/EventBus":"EventBus","../../Logic/GameItemsManager":"GameItemsManager","../../Logic/MoneySystem":"MoneySystem","../../Logic/NotifyEvent":"NotifyEvent","../../Logic/ShareRewardController":"ShareRewardController","../../Network/Protocol/StorageUtil":"StorageUtil","../../awardcontroller/AwardController":"AwardController","../../reward/RewardManager":"RewardManager"}],ChestManager:[function(l,P,m){"use strict";cc._RF.push(P,"2418eDbKCBEI5SbYMmns1pE","ChestManager"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("../../config/LSKey"),r=l("../Network/Protocol/StorageUtil"),o=l("./LevelMgr"),e=l("../../util/TimeUtil"),n=l("./SongBoxManager"),t=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance");(d=m.PropType||(m.PropType={}))[d.PropTypeNone=0]="PropTypeNone",d[d.Gold=1]="Gold",d[d.Life=2]="Life",d[d.Diamond=3]="Diamond",d[d.Jigsaw=4]="Jigsaw",d[d.PropTypeCount=5]="PropTypeCount";var i=function(){};m.Chest=i;var a=function(){function c(){this.gold=0,this.lift=0,this.diamond=0,this.skinPieces=[]}return c.prototype.toString=function(){return"gold="+this.gold+",lift="+this.lift+",diamond="+this.diamond},c}();m.ChestReward=a;var u=function(){function c(){this.mDropSpaceScore=0,this.mRewardPro=0,this.mSongboxList=null,this.mCurGetSongboxList=null,this.mLastTime=0,this.mOpenCount=0,this.m_nGainChestTotal=0,this.mServerTime=0}return c.getInstance=function(){return c.sInstance||(c.sInstance=new c),c.sInstance},c.prototype.init=function(){var p=this;cc.sys.isMobile?t.MGUser.getCurrentServerRealTime({success:function(h){p.mServerTime=h}}):this.mServerTime=new Date().getTime()},c.prototype.resetCacheByTime=function(p){p<=0||e.default.isSameDay(new Date(p),new Date(this.mLastTime))||(this.mOpenCount=0)},c.prototype.loadList=function(){if(!this.mSongboxList){var p=n.SongBoxMgr.Ins().getSongBoxVM();if(p){this.mSongboxList=p;for(var h=0,f=0,g=0,_=this.mSongboxList;g<_.length;g++){var y=_[g];h!==y.frequenceMin&&(h=y.frequenceMin,f=0),f+=y.chance,y.totalChance=f}}}},c.prototype.preLoad=function(p,h){this.m_nGainChestTotal=0,this.loadList(),this.mCurGetSongboxList=[];var f=o.LevelMgr.Ins().getLevelInfo(p);this.mRewardPro=f.mRewarPro,this.mDropSpaceScore=2*h/f.mRewarMax;var g=r.default.read(s.default.UD_LAST_OPEN_TIME);g&&g!==""||(g="0"),this.mLastTime=parseInt(g);var _=r.default.read(s.default.UD_OPEN_COUNT);_&&_!==""||(_="0"),this.mOpenCount=parseInt(_),this.resetCacheByTime(this.mServerTime)},c.prototype.randomPropChest=function(p,h){if(cc.random0To1()>=this.mRewardPro||h!==-1&&p-h<this.mDropSpaceScore||!this.mSongboxList)return null;for(var f=1e4*cc.random0To1(),g=this.mOpenCount+this.mCurGetSongboxList.length+1,_=null,y=0,S=this.mSongboxList;y<S.length;y++){var I=S[y];if(g>=I.frequenceMin&&g<=I.frequenceMax&&f<=I.totalChance){_=I;break}}if(!_)return null;var v=new i;return v.songBoxId=_.id,v},c.prototype.setPlayGainChest=function(p){for(var h=0,f=this.mSongboxList;h<f.length;h++){var g=f[h];if(g.id===p.songBoxId){this.mCurGetSongboxList.push(g);break}}++this.m_nGainChestTotal},c.prototype.getGainChestTotal=function(){return this.m_nGainChestTotal},c.prototype.openChest=function(p){var h=this;0<this.mServerTime?this.getChestReward(!0,this.mServerTime,p):t.MGUser.getCurrentServerRealTime({complete:function(f,g){f&&(h.mServerTime=g),h.getChestReward(f,g,p)}})},c.prototype.openChestWithDefaultReward=function(){return this.generateRewardValue(!1)},c.prototype.getChestReward=function(p,h,f){var g=null;p?(this.resetCacheByTime(h),g=this.generateRewardValue()):g=this.generateRewardValue(!1),this.mLastTime=h,r.default.save(s.default.UD_OPEN_COUNT,""+this.mOpenCount),r.default.save(s.default.UD_LAST_OPEN_TIME,""+this.mLastTime),f&&f(g)},c.prototype.generateRewardValue=function(p){p===void 0&&(p=!0);for(var h=new a,f=0,g=this.mCurGetSongboxList;f<g.length;f++){var _=g[f];h.gold+=_.fixedReward;var y=this.mOpenCount+1;p&&y>=_.frequenceMin&&y<=_.frequenceMax&&(h.gold+=_.coin,h.lift+=_.power),this.mOpenCount++}return 2<=h.skinPieces.length&&(0<h.gold&&(h.lift=0),2<h.skinPieces.length&&h.skinPieces.splice(2)),h.gold===0&&h.diamond===0&&h.skinPieces.length===0&&(console.warn("reward result is empty, use default value"),0<this.m_nGainChestTotal?h.gold=10*this.m_nGainChestTotal:h.gold=10),h},c}();m.default=u,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../config/LSKey":"LSKey","../../util/TimeUtil":"TimeUtil","../Network/Protocol/StorageUtil":"StorageUtil","./LevelMgr":"LevelMgr","./SongBoxManager":"SongBoxManager"}],ClassType:[function(l,P,m){"use strict";cc._RF.push(P,"b99f4ywpuxKaLvT2+wtYQSb","ClassType"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.isArray=function(r){return this.getTypeString(r)==="array"},s.isObject=function(r){return this.getTypeString(r)==="object"},s.isString=function(r){return typeof r=="string"},s.isDate=function(r){return this.getTypeString(r)==="date"},s.isRegExp=function(r){return this.getTypeString(r)==="regexp"},s.isFunction=function(r){return typeof r=="function"},s.isBoolean=function(r){return typeof r=="boolean"},s.isNumber=function(r){return typeof r=="number"},s.isNull=function(r){return r===null},s.isUndefined=function(r){return r===void 0},s.isEmptyObject=function(r){return s.isNull(r)||s.isUndefined(r)},s.isEmptyString=function(r){return s.isEmptyObject(r)||r.trim()===""},s.setMetadata=function(r,o){if(!r||!o)throw new Error;this._metadatas.set(r,o)},s.getMetadata=function(r){return this._metadatas.get(r)||null},s.getClassType=function(r){return s.isNull(r)?null:s.isUndefined(r)?void 0:s.isBoolean(r)?Boolean:s.isNumber(r)?Number:s.isString(r)?String:(r.prototype?r.prototype:Object.getPrototypeOf(r)).constructor},s.getClassName=function(r){var o=this.getQualifiedClassName(r).split(".");return o[o.length-1]},s.getQualifiedClassName=function(r){var o=typeof r;if(!r||o!=="object"&&!r.prototype)return o;var e=r.prototype?r.prototype:Object.getPrototypeOf(r);if(e.hasOwnProperty("__class__"))return e.__class__;var n=e.constructor.toString().trim(),t=n.indexOf("("),i=n.substring(9,t);return Object.defineProperty(e,"__class__",{value:i,enumerable:!1,writable:!0}),i},s.getSuperclassName=function(r){var o=this.getQualifiedSuperclassName(r).split(".");return o[o.length-1]},s.getQualifiedSuperclassName=function(r){if(!r||typeof r!="object"&&!r.prototype)return null;var o=r.prototype?r.prototype:Object.getPrototypeOf(r),e=Object.getPrototypeOf(o);if(!e)return null;var n=this.getQualifiedClassName(e.constructor);return n||null},s.isAssignableFrom=function(r,o){if(!r||!o)return!1;if(r===o||r===Object||r==="Object")return!0;var e=o.prototype;if(e.hasOwnProperty("__types__")){var n=s.isString(r)?r:s.getQualifiedClassName(r);return e.__types__.indexOf(n)!==-1}var t=Object.getPrototypeOf(e).constructor;if(t===Object)return!1;if(s.isString(r)){if(s.getQualifiedClassName(t)===r)return!0}else if(t===r)return!0;return s.isAssignableFrom(r,t)},s.getTypeString=function(r){return Object.prototype.toString.call(r).slice(8,-1).toLowerCase()},s.getRaf=function(){var r=0;return function(o){var e=new Date().getTime(),n=Math.max(0,16-(e-r)),t=window.setTimeout(function(){o(e+n)},n);return r=e+n,t}},s.getCaf=function(){return function(r){clearTimeout(r)}},s._metadatas=new Map,s}();m.Type=d,cc._RF.pop()},{}],ClickEventSoundPlayer:[function(l,P,m){"use strict";cc._RF.push(P,"0fd68NaGK5Dipd8+XZIpX5C","ClickEventSoundPlayer"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Config"),s=l("../../../music/MusicPlayer"),r=cc._decorator,o=r.ccclass,e=(r.property,function(){function n(){this.mIndex=0,this.init()}var t;return(t=n).getInstance=function(){return t.mInstance||(t.mInstance=new t),t.mInstance},n.prototype.init=function(){var i=this;new d.default().loadMusic(100001,function(a){var u=a;i.mMusicSyllable=u.getMusicParts()[0].getHighMusicTrack().syllables,a&&(a.getMusicPart(0)?i.mPlayer=new s.default(a.getMusicPart(0).getBPM()):i.mPlayer=new s.default(90))})},n.prototype.play=function(){this.mPlayer&&this.mPlayer.addSyllable(this.mMusicSyllable[this.mIndex]),this.mIndex++},n=t=__decorate([o],n)}());m.default=e,cc._RF.pop()},{"../../../base/Config":"Config","../../../music/MusicPlayer":"MusicPlayer"}],CloudMgr:[function(l,P,m){"use strict";cc._RF.push(P,"71bb7xLzMZMMZQclHZjzsBx","CloudMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Downloader"),s=function(){function r(o){this.mChcker=null,this.mChcker=o}return r.prototype.request=function(o,e){this.mChcker.check(function(){o()},function(){e()})},r.prototype.getChecker=function(){return this.mChcker},r.prototype.getData=function(){return this.mChcker.getData()},r.prototype.filterData=function(o){return this.mChcker.getData()?this.mChcker.getData().filter(o):[]},r.prototype.saveData=function(){this.mChcker&&this.mChcker.saveLocalData()},r.prototype.download=function(o,e){return d.default.Ins().download(o,3,e)},r.prototype.unZipFile=function(o){return d.default.Ins().unZipFile(o)},r}();m.default=s,cc._RF.pop()},{"./Downloader":"Downloader"}],CloudResMgr:[function(l,P,m){"use strict";cc._RF.push(P,"551b7W2mClKi6xl3UkZa5iQ","CloudResMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BaseVersionChecker"),s=function(r){function o(e,n,t,i){return r.call(this,new d.default(e,n,t,i))||this}return __extends(o,r),o}(l("./CloudMgr").default);m.CloudResMgr=s,cc._RF.pop()},{"./BaseVersionChecker":"BaseVersionChecker","./CloudMgr":"CloudMgr"}],CloudStorageHelperCM:[function(l,P,m){"use strict";cc._RF.push(P,"1d30eYRDeZCLKzifeQpCqPC","CloudStorageHelperCM"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n,t,i){return s.call(this,o,e,n,t,i)||this}return __extends(r,s),r.prototype.setStorage=function(o){if(console.log("czx cm setstorage ",o.kvDatas),!this.mGameId||!this.mPlayerId||!this.mToken)return o.complete&&o.complete(!1),void(o.fail&&o.fail(-1));CMPlay.setStorageList(o.kvDatas,function(e){e?o.success&&o.success():o.fail&&o.fail(-1),o.complete&&o.complete(e)})},r.prototype.getStorage=function(o){if(!this.mGameId||!this.mPlayerId||!this.mToken)return o.complete&&o.complete(!1,null),void(o.fail&&o.fail(-1));CMPlay.getStroageList(o.keys,function(e){if(console.log("czx cm getStorage ",e),!e)return o.complete&&o.complete(!1,null),void(o.fail&&o.fail(-1));o.complete&&o.complete(!0,e),o.success&&o.success(e)})},r}(l("./CloudStorageHelperQQ").CloudStorageHelperQQ);m.CloudStorageHelperCM=d,cc._RF.pop()},{"./CloudStorageHelperQQ":"CloudStorageHelperQQ"}],CloudStorageHelperFB:[function(l,P,m){"use strict";cc._RF.push(P,"40544W9bNpP2ZjGxgDdwXLz","CloudStorageHelperFB"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getServiceUrl=function(){return s.prototype.isDebug.call(this)?r.SERVER_ADDRESS_URL_TEST:r.SERVER_ADDRESS_URL},r.prototype.getUrlToSetStorage=function(){return this.getServiceUrl()+r.SET_STORAGE_URL},r.prototype.getUrlToGetStorage=function(){return this.getServiceUrl()+r.GET_STORAGE_URL},r.prototype.getUrlToDetStorage=function(){return this.getServiceUrl()+r.DEL_STORAGE_URL},r.SERVER_ADDRESS_URL_TEST="https://instantgame.cmcm.com/",r.SERVER_ADDRESS_URL="https://instantgame.cmcm.com/",r.SET_STORAGE_URL="warty/storage/dy/set",r.GET_STORAGE_URL="warty/storage/dy/get",r.DEL_STORAGE_URL="warty/storage/dy/del",r}(l("../Logic/MGCloudStorageHelper").default);m.CloudStorageHelperFB=d,cc._RF.pop()},{"../Logic/MGCloudStorageHelper":"MGCloudStorageHelper"}],CloudStorageHelperQQ:[function(l,P,m){"use strict";cc._RF.push(P,"ea950oHWPtOcb9UfrcFnBE+","CloudStorageHelperQQ"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGCloudStorageHelper"),s=l("../../../../scripts/business/keypad/KeypadUtil"),r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getServiceUrl=function(){return s.default.isOversea()?e.SERVER_ADDRESS_URL_OVERSEA:o.prototype.isDebug.call(this)?e.SERVER_ADDRESS_URL_TEST:e.SERVER_ADDRESS_URL},e.prototype.getUrlToSetStorage=function(){return this.getServiceUrl()+e.SET_STORAGE_URL},e.prototype.getUrlToGetStorage=function(){return this.getServiceUrl()+e.GET_STORAGE_URL},e.prototype.getUrlToDetStorage=function(){return this.getServiceUrl()+e.DEL_STORAGE_URL},e.SERVER_ADDRESS_URL_TEST="https://pianotiles-minigame.cmcm.com/",e.SERVER_ADDRESS_URL="https://minigame.cmcm.com/",e.SERVER_ADDRESS_URL_OVERSEA="https://h5game_oversea.cmcm.com/",e.SET_STORAGE_URL="warty/storage/set",e.GET_STORAGE_URL="warty/storage/get",e.DEL_STORAGE_URL="warty/storage/del",e}(d.default);m.CloudStorageHelperQQ=r,cc._RF.pop()},{"../../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../Logic/MGCloudStorageHelper":"MGCloudStorageHelper"}],CloudStorageHelperWX:[function(l,P,m){"use strict";cc._RF.push(P,"21c44CTyCVNmYQhwnlFIQDs","CloudStorageHelperWX"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGCloudStorageHelper"),s=l("../../../../scripts/business/keypad/KeypadUtil"),r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getServiceUrl=function(){return s.default.isOversea()?e.SERVER_ADDRESS_URL_OVERSEA:o.prototype.isDebug.call(this)?e.SERVER_ADDRESS_URL_TEST:e.SERVER_ADDRESS_URL},e.prototype.getUrlToSetStorage=function(){return this.getServiceUrl()+e.SET_STORAGE_URL},e.prototype.getUrlToGetStorage=function(){return this.getServiceUrl()+e.GET_STORAGE_URL},e.prototype.getUrlToDetStorage=function(){return this.getServiceUrl()+e.DEL_STORAGE_URL},e.SERVER_ADDRESS_URL_TEST="https://pianotiles-minigame.cmcm.com/",e.SERVER_ADDRESS_URL="https://minigame.cmcm.com/",e.SERVER_ADDRESS_URL_OVERSEA="https://h5game_oversea.cmcm.com/",e.SET_STORAGE_URL="warty/storage/set",e.GET_STORAGE_URL="warty/storage/get",e.DEL_STORAGE_URL="warty/storage/del",e}(d.default);m.CloudStorageHelperWX=r,cc._RF.pop()},{"../../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../Logic/MGCloudStorageHelper":"MGCloudStorageHelper"}],CloudStorageHelperWeb:[function(l,P,m){"use strict";cc._RF.push(P,"016da+U6UtBzIuWMHhh6OGB","CloudStorageHelperWeb"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r}(l("./CloudStorageHelperFB").CloudStorageHelperFB);m.CloudStorageHelperWeb=d,cc._RF.pop()},{"./CloudStorageHelperFB":"CloudStorageHelperFB"}],CompetitionBasicData:[function(l,P,m){"use strict";cc._RF.push(P,"17f34iMn0NEt5V9VLzfiYNP","CompetitionBasicData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.CompetitionBasicData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getID=function(){return this.getInt("Id")},e.prototype.getNeedLv=function(){return this.getInt("NeedLv")},e.prototype.getShareRaise=function(){return this.getInt("ShareRaise")},e.prototype.getChallengeTimes=function(){return this.getInt("ChallengeTimes")},e.prototype.getSpendType=function(){return this.getInt("SpendType")},e.prototype.getSpendEnergy=function(){return this.getString("SpendEnergy")},e.prototype.getSpendGold=function(){return this.getString("SpendGold")},e.prototype.getSpendDiamond=function(){return this.getString("SpendDiamond")},e}(d.default);m.CompetitionBasicRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],CompetitionMusicData:[function(l,P,m){"use strict";cc._RF.push(P,"98b69Eu8fVPZqLCGlYVPILM","CompetitionMusicData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.CompetitionMusicData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getID=function(){return this.getInt("Id")},e.prototype.getDate=function(){return this.getString("Date")},e.prototype.getMid=function(){return this.getInt("Mid")},e.prototype.getIndex=function(){return this.getInt("Index")},e.prototype.getBPM=function(){return this.getInt("BPM")},e.prototype.getMusicJson=function(){return this.getString("MusicJson")},e.prototype.getMusician=function(){return this.getString("Musician")},e.prototype.getMusicName=function(){return this.getString("MusicName")},e.prototype.getResInfo=function(){return this.getString("ResInfo")},e.prototype.getResVer=function(){return this.getInt("ResVer")},e.prototype.getResMd5=function(){return this.getString("ResMd5")},e.prototype.getResSize=function(){return this.getInt("ResSize")},e}(d.default);m.CompetitionMusicRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],CompetitionRewardData:[function(l,P,m){"use strict";cc._RF.push(P,"e15ebgMaBhLI4XsG6Efe8ig","CompetitionRewardData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.CompetitionRewardData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("Id")},e.prototype.getStars=function(){return this.getInt("Stars")},e.prototype.getFrequenceMin=function(){return this.getInt("FrequenceMin")},e.prototype.getFrequenceMax=function(){return this.getInt("FrequenceMax")},e.prototype.getChance=function(){return this.getInt("Chance")},e.prototype.getRewardType=function(){return this.getString("RewardType")},e.prototype.getRewardValue=function(){return this.getInt("RewardValue")},e}(d.default);m.CompetitionRewardRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],CompetitionSettlementData:[function(l,P,m){"use strict";cc._RF.push(P,"871beEmDFlByLfudBtvW21w","CompetitionSettlementData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.CompetitionSettlementData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("Id")},e.prototype.getRankStart=function(){return this.getInt("RankStart")},e.prototype.getRankEnd=function(){return this.getInt("RankEnd")},e.prototype.getRankPercentStart=function(){return this.getInt("RankPercentStart")},e.prototype.getRankPercentEnd=function(){return this.getInt("RankPercentEnd")},e.prototype.getRewardType=function(){return this.getInt("RewardType")},e.prototype.getRewardEnergy=function(){return this.getInt("RewardEnergy")},e.prototype.getRewardGold=function(){return this.getInt("RewardGold")},e.prototype.getRewardDiamond=function(){return this.getInt("RewardDiamond")},e}(d.default);m.CompetitionSettlementRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],Config:[function(l,P,m){"use strict";cc._RF.push(P,"509cfQPwEJPuaZYy802zStI","Config"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../music/MusicCache"),s=l("../business/Logic/LevelMgr"),r=l("../util/PU"),o=l("../util/ResLoader"),e=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),n=l("../business/music/MusicDownloadProcess"),t=function(){function i(){this.designWidth=720,this.designHeight=1280,this.designBlockWidth=180,this.designBlockHeight=320,this.moneyStageSpeed=4,this.gameSceneSlotCount=4,this.gameSceneLineCount=4,this.gameFrameInterval=.0167,this.gameFrameIntervalHori=.01169,this.gameSpeedScale=i.DEFAULT_GAME_SPEED_SCALE,this.moneyFlyDuration=.3,this.moneyUpDuration=.3,this.giftUpDuration=.3,this.giftFlyDuration=.3,this.honorAnimStayTime=.3,this.enterStageDelay=1.5,this.scoreDelayAfterStageCaption=1.5,this.moneyWalkDelay=2,this.infiniteWalkDelay=2,this.blockHorizonExtend=20,this.releasePropertyAnimDuration=.8,this.presentWidth=720,this.presentHeight=1280,this.mBaseBlockHeight=320,this.mBaseBlockWidth=180,this.mBaseBlockWidthScale=1,this.mBaseBlockHeightScale=1,this.presentScale=1,this.longBlockDotPosShow=!0,this.longBlockDotAnimEnable=!0,this.longBlockChangeLength=!1,this.longBlockBounceEffectByDistance=-1,this.gameSceneTest=!1,this.debugPanelShowed=!1,this.debugNoBlockSound=!1,this.debugNoBlockAnim=!1,this.debugNoDetectMission=!1,this.debugNoTouchResponse=!1,this.debugNoScoreAnim=!1,this.debugAutoTouchBlock=!1,this.debugRobotAutoTouchBlock=!1,this.debugAutoLog=!1,this.debugNoHonorAnim=!1,this.debugNoBackgroundSwitch=!1,this.debugNoLongBlocks=!1,this.debugNoPullParent=!1,this.debugNoComplicatedPlayMode=!1,this.debugNoFlyMoneyAnim=!1,this.debugFreeRelive=!1,this.debugNoOvertake=!1,this.debugNoBackgroundAnim=!1,this.debugShowTouchPos=!1,this.debugPlayerIdCustomMusic=!1,this.musicCache=new d.default}return i.prototype.getDesignBlockHeight=function(){return this.designBlockHeight},i.prototype.getBlockHeight=function(){return this.mBaseBlockHeight},i.prototype.getMoneyStageSpeed=function(){return this.moneyStageSpeed},i.prototype.getGameSceneSlotCount=function(){return this.gameSceneSlotCount},i.prototype.getGameSceneLineCount=function(){return this.gameSceneLineCount},i.prototype.isGameSceneTest=function(){return this.gameSceneTest},i.prototype.loadMusic=function(a,u,c){var p=this;console.log("czx asdfasdfasdf",c);var h=s.LevelMgr.Ins().getLevelByMid(a);console.log("czx level",h),c?n.MusicDownloadProcess.Ins().showMusicDownloadingPopup(c,function(f){console.log("czx asdfasdfasdf  12sadfasdfsadf",f),f&&p.loadMusic2(h.music,u)}):this.loadMusic2(h.music,u)},i.prototype.loadMusic2=function(a,u){var c=this;if(a){console.log("czx loadMusic2");var p=a.musicName;if(this.debugPlayerIdCustomMusic)return void e.MGUser.getUserLoginInfo({complete:function(g){if(g){var _=g.playerId,y=cmg.CloudUtil.SERVER_ADDRESS_BASE_WX+"common/get_music/"+_;cc.sys.platform===cc.sys.WECHAT_GAME?c.wxRequestMusic(y,a,p,u):c.fetchMusic(y,a,p,u)}}});var h=this.musicCache.getMusic(p);if(h)return void u(h);var f=p.replace("'",i.ASCII_SINGLE_QUOTE_MARK_HEX);f=(f=f.replace(",",i.ASCII_COMMA_HEX)).replace("!",i.ASCII_EXCLAMATORY_MARK),f=r.default.getResourcePath("resources/song/"+f+".json"),o.default.loadJson(f,function(g,_){if(g)u(null);else{var y=c.musicCache.loadMusic(a,p,_);u(y)}})}else u(null)},i.prototype.loadMusicForChallengeCompetition=function(a,u,c){var p=this,h=this.musicCache.getMusic(a);if(h)c(h);else{var f=r.default.getResourcePath(a);o.default.loadJson(f,function(g,_){if(g)c(null);else{var y=p.musicCache.loadMusic(u,a,_);c(y)}})}},i.prototype.fetchMusic=function(a,u,c,p){var h=this;fetch(a).then(function(f){return f.json()}).then(function(f){console.log("music fetch data:",f);var g=h.musicCache.loadMusic(u,c,f);p(g)}).catch(function(f){console.log("music fetch::send error "+f,f)})},i.prototype.wxRequestMusic=function(a,u,c,p){var h=this;wx.request({url:a,success:function(f){if(console.log("wx music fetch data:",f),f.statusCode===200){var g=h.musicCache.loadMusic(u,c,f.data);p(g)}else console.log("wx music fetch::result error")},fail:function(f){console.log("wx music fetch::send error "+f,f)}})},i.prototype.getMusic=function(a){var u=s.LevelMgr.Ins().getLevelByMid(a).music.musicName;return this.getMusicByName(u)},i.prototype.getMusicByName=function(a){return this.musicCache.getMusic(a)},i.ASCII_SINGLE_QUOTE_MARK_HEX="0x27",i.ASCII_COMMA_HEX="0x2c",i.ASCII_EXCLAMATORY_MARK="0x21",i.DEFAULT_GAME_SPEED_SCALE=.95,i}();m.default=t,cc._RF.pop()},{"../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../business/Logic/LevelMgr":"LevelMgr","../business/music/MusicDownloadProcess":"MusicDownloadProcess","../music/MusicCache":"MusicCache","../util/PU":"PU","../util/ResLoader":"ResLoader"}],ConstantsRank:[function(l,P,m){"use strict";cc._RF.push(P,"3815f52UmhHIIUYYANYPjTy","ConstantsRank"),Object.defineProperty(m,"__esModule",{value:!0});var d="res/raw-assets/resources/opencontext/",s=function(){function r(){}return r.setLocalPicPathPrefix=function(o){r.PATH_PREFIX=o+""},r.LOCAL_PIC={AVATAR_RING1:d+"avatar_ring1.png",AVATAR_RING90:d+"avatar_ring90.png",AVATAR_RING20:d+"avatar_ring20.png",AVATAR_RING21:d+"avatar_ring21.png",AVATAR_RING_HOME:d+"avatar_ring_home.png",AVATAR_DEFAULT:d+"avatar_default.png",AVATAR_VIP_ICON:d+"avater_vip_icon.png",AVATAR_VIP_ICON_RESULT:d+"avatar_vip_icon_result.png",SEPERATE_LINE_VERTICAL:d+"line_h.png",SELF_RANK_BG:d+"self_rank_bg.png",GOLD_MEDAL:d+"gold_medal.png",SILVER_MEDAL:d+"silver_medal.png",BRONZE_MEDAL:d+"bronze_medal.png",CROWN_BIG:d+"crown_big.png",CROWN_MEDIUM:d+"crown_medium.png",CROWN_SMALL:d+"crown_small.png",STAR_BIG:d+"star_big.png",STAR_MEDIUM:d+"star_medium.png",STAR_SMALL:d+"star_small.png",REVIVE_LOGO:d+"revive.png",RANK1:d+"rank1.png",RANK2:d+"rank2.png",RANK3:d+"rank3.png",SHARE_CHAMPION_HEAD_BG:d+"champion_head_bg.png",SHARE_NORMAL_HEAD_BG:d+"head_bg.png",SHARE_SCORE_BG:d+"grade_bg.png",SHARE_NEW_RECORD_TEXT_PIC:d+"new_record_text.png",SHARE_NEW_RECORD_TEXT_PIC_EN:d+"new_record_text_en.png",SHARE_CHAMPION_TEXT_PIC:d+"champion_text.png",SHARE_CHAMPION_TEXT_PIC_EN:d+"champion_text_en.png",SHARE_MORE:d+"more.png",SHARE_PAGE_BG:d+"share_page_bg.png",ROBOT_B:d+"b_robot.png",ROBOT_B_EN:d+"b_robot_en.png",ROBOT_C:d+"c_robot.png",ROBOT_C_EN:d+"c_robot_en.png",NO_DATA_DEFAULT_TIP:d+"no_network_tip.png",RANK_CHAMPION_AVATAR_BG:d+"result_page/rank_champion_avatar_bg.png",RANK_CHAMPION_FLAG:d+"result_page/rank_champion_flag.png",RANK_CHAMPION_FLAG_EN:d+"result_page/rank_champion_flag_en.png",RANK_SECOND_BG:d+"result_page/rank_second_bg.png",RANK_THIRD_BG:d+"result_page/rank_third_bg.png",RANK_FIRST_NUMBER:d+"result_page/rank_first_number.png",RANK_SECOND_NUMBER:d+"result_page/rank_second_number.png",RANK_THIRD_NUMBER:d+"result_page/rank_third_number.png",GAME_PLAYING_BEYOUND_SUCCESS:d+"game_playing_beyound_success.png",GAME_PLAYING_NEW_RECORD:d+"game_playing_new_record.png",GAME_PLAYING_CIRCLE_RING:d+"game_playing_circle_ring.png",GAME_PLAYING_RANK_BG:d+"game_playing_rank_bg.png",GAME_PLAYING_ATLAS_BEAT:d+"beat.png",RANK_PK_LEVEL_ATLAS:d+"rank_pk_level_atlas.png",RANK_PK_LEVEL_STAR:d+"rank_pk_level_star.png"},r.PATH_PREFIX="",r.BEAT={new_record:"new_record",over_success:"over_success",over_await:"over_await",new_high_score:"new_high_score",next_target:"next_target",red_pre:"red_",red_0:"red_0",red_1:"red_1",red_2:"red_2",red_3:"red_3",red_4:"red_4",red_5:"red_5",red_6:"red_6",red_7:"red_7",red_8:"red_8",red_9:"red_9",white_pre:"white_",white_0:"white_0",white_1:"white_1",white_2:"white_2",white_3:"white_3",white_4:"white_4",white_5:"white_5",white_6:"white_6",white_7:"white_7",white_8:"white_8",white_9:"white_9"},r.LANGUAGE={need:"\u8FD8\u5DEE",to_exceed:"\u5C31\u80FD\u8D85\u8D8A",to_win1:"\u5373\u53EF\u8D62\u5F97",champion:"\u7B2C\u4E00\u540D",runner_up:"\u7B2C\u4E8C\u540D",second_runner_up:"\u7B2C\u4E09\u540D",to_get:"\u5373\u53EF\u83B7\u5F97",get_new_best:"\u5373\u53EF\u521B\u4E0B",new_best:"\u65B0\u7EAA\u5F55",revive_now:"\u7ACB\u5373\u590D\u6D3B",single_champion:"\u606D\u559C\u4F60\u83B7\u5F97\u5355\u66F2\u51A0\u519B",beat_frineds1:"\u5355\u66F2\u6392\u540D\u8D85\u8D8A",beat_frineds2:"\u597D\u53CB",no_internet:"\u672A\u68C0\u6D4B\u5230\u7F51\u7EDC\uFF0C\u65E0\u6CD5\u67E5\u770B\u6392\u884C\u699C",not_ranked:"\u672A\u4E0A\u699C",nothing:"\u65E0",unit1:"\u4F4D",unit2:"\u5206",robot1:"\u8D1D\u591A\u82B3",robot2:"\u83AB\u624E\u6301"},r.Vip={vip:"vip"},r}();m.ConstantsRank=s,cc._RF.pop()},{}],CookieAnimation:[function(l,P,m){"use strict";cc._RF.push(P,"57d25jzoM1G4IvqTRvheAWM","CookieAnimation"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/G"),s=l("../../animation/action/MMoveBy"),r=l("../../animation/action/MMoveTo"),o=l("../../animation/action/MScaleTo"),e=l("../../animation/action/MSequence"),n=l("../../animation/action/MSpawn"),t=l("../../animation/action/MCallFunc"),i=l("../../GameBus"),a=function(){function u(c){this.mGameNode=c;var p=this.mGameNode.getChildByName("FeedLayer");this.mMoneyPanel=p.getChildByName("MoneyPanel"),this.mMoneyIcon=this.mMoneyPanel.getChildByName("MoneyIcon"),this.mMoneyText=this.mMoneyPanel.getChildByName("MoneyText"),this.mGiftPanel=p.getChildByName("GiftPanel"),this.mGiftIcon=this.mGiftPanel.getChildByName("GiftIcon"),this.mGiftText=this.mGiftPanel.getChildByName("GiftText");var h=new o.default(1,1,.2),f=new o.default(1.3,1.3,.2);this.mTextZoomAction=new e.default(f,h)}return u.prototype.showMoneyFlyAnimation=function(c,p,h){var f=this,g=this.mMoneyIcon.getRect(),_=this.mMoneyPanel.getPosition();_.x+=g.xCenter,_.y+=g.yCenter,_.x-=c.getWidth()>>>1,_.y-=c.getHeight()>>>1;var y=d.G.Ap.config.moneyFlyDuration,S=new s.default(0,d.G.Ap.config.getBlockHeight()/2,d.G.Ap.config.moneyUpDuration),I=new r.default(_.x,_.y,y),v=new o.default(.5,.5,y),C=new t.default(function(){h(),f.startAddMoneyAction(p)}),T=new e.default(S,new n.default(I,v),C);i.default.getInstance().animationMgr.runAction(c,T)},u.prototype.startAddMoneyAction=function(c){this.mMoneyText.setNumberValue(c),this.mMoneyText.setScale(1,1),this.mTextZoomAction.getTarget()==this.mMoneyText||i.default.getInstance().animationMgr.runAction(this.mMoneyText,this.mTextZoomAction)},u.prototype.showGiftFlyAnimation=function(c,p,h){var f=this,g=this.mGiftIcon.getRect(),_=this.mGiftPanel.getPosition();_.x+=g.xCenter,_.y+=g.yCenter,_.x-=c.getWidth()>>>1,_.y-=c.getHeight()>>>1;var y=new s.default(0,d.G.Ap.config.getBlockHeight()/2,d.G.Ap.config.giftUpDuration),S=d.G.Ap.config.giftFlyDuration,I=new r.default(_.x,_.y,S),v=new t.default(function(){h(),f.startAddGiftAction(p)}),C=new e.default(y,I,v);i.default.getInstance().animationMgr.runAction(c,C)},u.prototype.startAddGiftAction=function(c){this.mGiftPanel.setVisible(!0),this.mGiftText.setNumberValue(c),this.mGiftText.setScale(1,1),this.mTextZoomAction.getTarget()==this.mGiftText?(this.mTextZoomAction.ready(),this.mTextZoomAction.start(this.mGiftText)):i.default.getInstance().animationMgr.runAction(this.mGiftText,this.mTextZoomAction)},u}();m.default=a,cc._RF.pop()},{"../../../base/G":"G","../../GameBus":"GameBus","../../animation/action/MCallFunc":"MCallFunc","../../animation/action/MMoveBy":"MMoveBy","../../animation/action/MMoveTo":"MMoveTo","../../animation/action/MScaleTo":"MScaleTo","../../animation/action/MSequence":"MSequence","../../animation/action/MSpawn":"MSpawn"}],CookiesNodeCache:[function(l,P,m){"use strict";cc._RF.push(P,"fd16fjPMtVM8osMiwasQjy+","CookiesNodeCache"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("./ReuseNode");(s=d=m.COOKIESTYPE||(m.COOKIESTYPE={}))[s.MONEY=0]="MONEY",s[s.GIFT=1]="GIFT";var o=function(){function e(n,t,i,a){this.parentNode=null,this.parentNode=n,this.atlas=t,this.moneySpriteFrame=i,this.giftSpriteFrame=a}return e.prototype.createCache=function(n,t){n===void 0&&(n=5),t===void 0&&(t=1)},e.prototype.getDynamicly=function(n){var t=this.get(n);if(t==null)switch(n){case d.MONEY:t=this.createMoneyNode();break;case d.GIFT:t=this.createGiftNode();break;default:t=this.createBlankNode()}return t},e.prototype.get=function(n){return null},e.prototype.put=function(n,t){return!1},e.prototype.clear=function(){},e.prototype.createMoneyNode=function(){var n=new r.default;return n.setContentSize(125,125),n.imageData=this.atlas,n.imageItem=this.moneySpriteFrame,n},e.prototype.createGiftNode=function(){var n=new r.default;return n.setContentSize(123,159),n.imageData=this.atlas,n.imageItem=this.giftSpriteFrame,n},e.prototype.createBlankNode=function(){return new r.default},e}();m.CookiesNodeCache=o,cc._RF.pop()},{"./ReuseNode":"ReuseNode"}],CopyrightData:[function(l,P,m){"use strict";cc._RF.push(P,"d3ed6WB49NLLZ8wxmAgxmAT","CopyrightData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findMid=function(n){return this.find("mid",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.CopyrightData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getMid=function(){return this.getInt("mid")},e.prototype.getMusicName=function(){return this.getString("music_name")},e}(d.default);m.CopyrightRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],CopyrightManager:[function(l,P,m){"use strict";cc._RF.push(P,"4a9e3y3CzZK7Z9YHGrvbS2+","CopyrightManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.mCache={}}return s.getInstance=function(){return s.mInstance||(s.mInstance=new s),s.mInstance},s.prototype.setCopyrightData=function(r,o){this.mCache[r]=o},s.prototype.isCopyrightMusic=function(r){var o=this.mCache[r];return o!=null&&o!=null},s}();m.default=d,cc._RF.pop()},{}],CrashMonitor:[function(l,P,m){"use strict";cc._RF.push(P,"d4914hATj1OD4jIFceDVkas","CrashMonitor"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../infoc/minigame_piano2_crash"),s=l("./GameInfoMgr"),r=l("./Log"),o=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=function(){function n(){}return n.begin=function(){console.warn("CrashMonitor::begin => "),n.registerErrorHandler(),n.plusFailCount(),n.updateInfocData()},n.end=function(t){console.warn("CrashMonitor::end => "+t),n.resetFailCount()},n.resetFailCount=function(){cc.sys.platform==cc.sys.WECHAT_GAME&&n.setFailCount(0)},n.plusFailCount=function(){if(cc.sys.platform==cc.sys.WECHAT_GAME){var t=n.getFailCount();n.setFailCount(t+1)}},n.updateInfocData=function(){setTimeout(function(){o.MGUser.getUserBasicInfo({complete:function(i){i&&(n.mNickName=i.nickName)}});var t=s.GameInfoMgr.Ins().getInfo();t&&(n.mGameId=t.gameid,n.mGameVersion=t.version,n.mAppId=t.appid)},0)},n.registerErrorHandler=function(){if(cc.sys.platform==cc.sys.WECHAT_GAME)wx.onError(function(t){if(t&&t.message){var i=t.message.substr(0,Math.min(t.message.length,150));n.reportCrash(i,t.stack),r.default.w("registerErrorHandler == crash happend")}});else if(cc.sys.platform==cc.sys.QQ_PLAY)BK.Script.setErrorObserver&&(r.default.w("setErrorObserver supported"),BK.Script.setErrorObserver(function(t,i){if(t||i){var a=t?t.substr(0,Math.min(t.length,150)):"msg empty",u=i||"stack empty";console.error("Crash: "+a+" stack: "+u),n.reportCrash(a,u),r.default.w("registerErrorHandler == crash happend")}}));else try{window.onerror=function(t){if(t){var i=t.substr(0,Math.min(t.length,150));n.reportCrash(i,"")}}}catch(t){}},n.reportCrash=function(t,i){if(t&&!(t.length<3)){var a=cmg.hex_sha1(t);if(a!=n.mLastDumpKey){n.mLastDumpKey=a;var u=n.mNickName,c=n.mGameId,p=n.mGameVersion,h=n.mAppId;console.warn("reportCrash => appid("+h+") nickname("+u+") dumpkey("+a+")"),d.default.report(100,c,p,h,u,a,t,i)}else console.warn("reportCrash => ignore for duplicate")}},n.tryShowCrashModal=function(t){t&&(cc.sys.platform==cc.sys.WECHAT_GAME?wx.showModal({title:"\u63D0\u793A",content:"\u68C0\u6D4B\u5230\u6E38\u620F\u5F02\u5E38\uFF0C\u8BF7\u91CD\u542F\u5C1D\u8BD5.\n"+t,confirmText:"\u91CD\u542F\u6E38\u620F",showCancel:!1,success:function(i){i.confirm&&wx.exitMiniProgram()}}):window.alert(t))},n.setFailCount=function(t){wx.setStorageSync(n.STARTUP_FAIL_KEY,t)},n.getFailCount=function(){var t=wx.getStorageSync(n.STARTUP_FAIL_KEY);return t||(t=0),t},n.TIMEOUT_MAX=3e4,n.STARTUP_FAIL_KEY="startup_fail_count",n.STARTUP_FILE=null,n.mNickName="NaN",n.mGameId=0,n.mGameVersion="NaN",n.mAppId="NaN",n.mLastDumpKey="",n}();m.default=e,cc._RF.pop()},{"../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../infoc/minigame_piano2_crash":"minigame_piano2_crash","./GameInfoMgr":"GameInfoMgr","./Log":"Log"}],CsvFile:[function(l,P,m){"use strict";cc._RF.push(P,"2092bjqpnBIVIRTYBJhs7UO","CsvFile"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvOption"),s=l("./CSV"),r=l("../../../util/ResLoader"),o=l("../../../util/PU"),e=l("../../../base/Log"),n=function(){function t(){this.mHeader={},this.emptyCount=0,this.mRowArr=[],this.mRowMap={}}return t.prototype.setHeaders=function(i){var a=this;i.forEach(function(u,c){u&&u!=""||(a.emptyCount++,u="xxx_"+a.emptyCount),a.mHeader[u]=c})},t.prototype.addRow=function(i,a){this.mRowArr.push(a);var u=a[i];this.mRowMap[u]=a},t.prototype.findField=function(i){var a=this.mHeader[i];return a==null||a==null?-1:a},t.prototype.csvGetRow=function(i,a){this.findField(i);var u=this.mRowMap[a];return u!=null&&u!=null?u:null},t.prototype.csvGetRows=function(i,a){for(var u=this.findField(i),c=this.mRowArr.length,p=[],h=0;h<c;h++){var f=this.mRowArr[h];f[u]==a&&p.push(f)}return p},t.prototype.open=function(i,a,u,c){var p=this,h=a?2:1,f=o.default.getResourcePath("resources/"+i+".txt");r.default.loadString(f,function(g,_){g?(e.default.i("DataManager.open -> ResLoader.loadString error. user cocos loader.",g),cc.loader.loadRes(i,function(y,S){y?(console.log("csv load, error="+y),c(-1)):(p.parseCSV(S,h,u),c(0))})):(p.parseCSV(_,h,u),c(0))})},t.prototype.parseCSV=function(i,a,u){var c=this,p=new d.default;p.header=!1,p.cast=!1;var h=new s.default(i,p),f=0;h.parse(function(g){f==0?c.setHeaders(g):a<=f&&c.addRow(u,g),f++})},t.prototype.getAllDB=function(){return this.mRowArr?this.mRowArr:[]},t.prototype.csvFindRowBiany=function(i,a){for(var u=parseInt(a),c=2,p=this.mRowArr.length;0<=p-c;){var h=(p+c)/2,f=this.mRowArr[h],g=parseInt(f[0]);if(u==g)return f;g<u?c=h+1:p=h-1}return null},t}();m.default=n,cc._RF.pop()},{"../../../base/Log":"Log","../../../util/PU":"PU","../../../util/ResLoader":"ResLoader","./CSV":"CSV","./CsvOption":"CsvOption"}],CsvOption:[function(l,P,m){"use strict";cc._RF.push(P,"bb5a0AYD4tFaIM94o94qxcl","CsvOption"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.header=!1,this.cast=!0};m.default=d,cc._RF.pop()},{}],CsvRowData:[function(l,P,m){"use strict";cc._RF.push(P,"10073m0JxhJJLDgRH2nYz5o","CsvRowData"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.mCsvFile=null}return s.prototype.getInt=function(r){var o=this.mCsvFile.findField(r);if(o<0||o>=this.mRowData.length)return 0;var e=parseInt(this.mRowData[o]);return Number.isNaN(e)?0:e},s.prototype.setInt=function(r,o){var e=this.mCsvFile.findField(r);-1<e&&e<this.mRowData.length&&(this.mRowData[e]=o+"")},s.prototype.getString=function(r){var o=this.mCsvFile.findField(r);return o<0||o>=this.mRowData.length?"":this.mRowData[o]},s.prototype.setString=function(r,o){var e=this.mCsvFile.findField(r);-1<e&&e<this.mRowData.length&&(this.mRowData[e]=o)},s.prototype.getFloat=function(r){var o=this.mCsvFile.findField(r);if(o<0||o>=this.mRowData.length)return 0;var e=parseFloat(this.mRowData[o]);return Number.isNaN(e)?0:e},s.prototype.setFloat=function(r,o){var e=this.mCsvFile.findField(r);-1<e&&e<this.mRowData.length&&(this.mRowData[e]=o+"")},s}();m.default=d,cc._RF.pop()},{}],CtrlAvoid:[function(l,P,m){"use strict";cc._RF.push(P,"9e57erA8jlFVrkFh+8PqPa6","CtrlAvoid"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../property/PropertyDefines"),s=l("../../../GameBus"),r=l("../../../../base/G"),o=l("../../../../base/Log"),e=function(){function n(){this.manager=null,this.property=new d.Property(d.PROPERTYTYPE.GAME_AVOID)}return n.prototype.exe=function(){var t=this,i=!1;return this.manager.trySubPropertyCount(this.property)==1&&(i=!0),i&&(this.manager.propertyProcess.onStartProperty(this.property.type),s.default.getInstance().natureScheduler.scheduleOnce(function(){t.onComplete()},this.updateAdditionTime(1))),i},n.prototype.updateAdditionTime=function(t){var i=t,a=r.G.propAddition.getAdditionObstacleTime(t,r.G.Ap.state.mission.getType().toString());return o.default.e("\u56DE\u907F \u65F6\u95F4\u52A0\u6210\uFF1A"+i+"  => "+a),a},n.prototype.onComplete=function(){this.manager.propertyProcess.onEndProperty(this.property.type)},n}();m.CtrlAvoid=e,cc._RF.pop()},{"../../../../base/G":"G","../../../../base/Log":"Log","../../../../property/PropertyDefines":"PropertyDefines","../../../GameBus":"GameBus"}],CtrlControl:[function(l,P,m){"use strict";cc._RF.push(P,"06c23M9NPJJo7Z+PvWq8LnN","CtrlControl"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../GameBus"),s=l("../../../../base/G"),r=l("../../../../property/PropertyDefines"),o=l("../../../../base/Log"),e=function(){function n(){this.manager=null,this.duration=8,this.property=new r.Property(r.PROPERTYTYPE.GAME_CONTROLL)}return n.prototype.init=function(){var t=s.G.Ap.propertyPack.getConfig().getParam(this.property);this.duration=t.effect.duration,this.updateAdditionTime()},n.prototype.updateAdditionTime=function(){var t=this.duration;this.duration=s.G.propAddition.getAdditionDashTime(this.duration,s.G.Ap.state.mission.getType().toString()),o.default.e("\u72C2\u70ED \u65F6\u95F4\u52A0\u6210\uFF1A"+t+"  => "+this.duration)},n.prototype.exe=function(){var t=this;this.manager.propertyProcess.onStartProperty(this.property.type),d.default.getInstance().natureScheduler.scheduleOnce(function(){t.onComplete()},this.duration)},n.prototype.onComplete=function(){this.manager.propertyProcess.onEndProperty(this.property.type)},n}();m.CtrlControl=e,cc._RF.pop()},{"../../../../base/G":"G","../../../../base/Log":"Log","../../../../property/PropertyDefines":"PropertyDefines","../../../GameBus":"GameBus"}],CtrlConversion:[function(l,P,m){"use strict";cc._RF.push(P,"a021dZI+PNMJ4kcIa4CPhEw","CtrlConversion"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../property/PropertyDefines"),s=l("../../../../base/G"),r=l("../../../../base/Log"),o=function(){function e(){this.manager=null,this.numberOfEffects=3,this.m_state=0,this.m_count=0,this.property=new d.Property(d.PROPERTYTYPE.GAME_CONVERSION)}return e.prototype.exe=function(){this.miss()},e.prototype.init=function(){var n=s.G.Ap.propertyPack.getConfig().getParam(this.property).effect;this.numberOfEffects=n.numberOfEffects,this.numberOfEffects=this.updateAdditionTime(this.numberOfEffects)},e.prototype.updateAdditionTime=function(n){var t=n,i=s.G.propAddition.getAdditionConversionTime(n,s.G.Ap.state.mission.getType().toString());return r.default.e("\u8F6C\u5316 \u52A0\u6210\uFF1A"+t+"  => "+i),i},e.prototype.miss=function(){switch(this.m_state){case 0:if(this.manager.trySubPropertyCount(this.property)==0)return;this.manager.propertyProcess.onStartProperty(this.property.type),this.m_count=this.numberOfEffects,--this.m_count,this.m_state=1;break;case 1:--this.m_count,this.m_count==0&&(this.m_state=0,this.manager.propertyProcess.onEndProperty(this.property.type))}},e}();m.CtrlConversion=o,cc._RF.pop()},{"../../../../base/G":"G","../../../../base/Log":"Log","../../../../property/PropertyDefines":"PropertyDefines"}],CtrlFanatical:[function(l,P,m){"use strict";cc._RF.push(P,"daed8hVeWVB6bixN7F2f29y","CtrlFanatical"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../GameBus"),s=l("../../../../property/PropertyDefines"),r=l("../../../../base/G"),o=l("./../../../../base/Log"),e=function(){function n(){this.manager=null,this.duration=5,this.property=null}return n.prototype.init=function(){this.property=new s.Property(s.PROPERTYTYPE.GAME_FANATICAL);var t=r.G.Ap.propertyPack.getConfig().getParam(this.property);this.duration=t.effect.duration,this.updateAdditionTime()},n.prototype.updateAdditionTime=function(){var t=this.duration;this.duration=r.G.propAddition.getAdditionDashTime(this.duration,r.G.Ap.state.mission.getType().toString()),o.default.e("\u72C2\u70ED \u65F6\u95F4\u52A0\u6210\uFF1A"+t+"  => "+this.duration)},n.prototype.exe=function(){var t=this;this.manager.trySubPropertyCount(this.property)!=0&&(this.manager.propertyProcess.onStartProperty(this.property.type),d.default.getInstance().natureScheduler.scheduleOnce(function(){t.onComplete()},this.duration))},n.prototype.onComplete=function(){this.manager.propertyProcess.onEndProperty(this.property.type)},n}();m.CtrlFanatical=e,cc._RF.pop()},{"../../../../base/G":"G","../../../../property/PropertyDefines":"PropertyDefines","../../../GameBus":"GameBus","./../../../../base/Log":"Log"}],CtrlFog:[function(l,P,m){"use strict";cc._RF.push(P,"5abb6BXFRhIl5unNoOknHCk","CtrlFog"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../GameBus"),s=l("../../../../base/G"),r=l("../../../../property/PropertyDefines"),o=l("../../../../base/Log"),e=function(){function n(){this.manager=null,this.effectNode=null,this.duration=5,this.property=null}return n.prototype.Init=function(){var t=s.G.Ap.propertyPack.getConfig().getParam(new r.Property(r.PROPERTYTYPE.GAME_FOG));this.duration=t.effect.duration,this.updateAdditionTime()},n.prototype.updateAdditionTime=function(){var t=this.duration;this.duration=s.G.propAddition.getAdditionFogTime(this.duration,s.G.Ap.state.mission.getType().toString()),o.default.e("\u8FF7\u96FE \u65F6\u95F4\u52A0\u6210\uFF1A"+t+"  => "+this.duration)},n.prototype.exe=function(){var t=this;this.property=new r.Property(r.PROPERTYTYPE.GAME_FOG),this.manager.propertyProcess.onStartProperty(this.property.type),s.G.Ap.state.getCarryPropertyCount(new r.Property(r.PROPERTYTYPE.GAME_SHIELD)),d.default.getInstance().natureScheduler.scheduleOnce(function(){t.onComplete()},this.duration)},n.prototype.onComplete=function(){this.manager.propertyProcess.onEndProperty(this.property.type)},n}();m.CtrlFog=e,function(){function n(){this.effectNode=null,this.Root=null}n.prototype.create=function(){},n.prototype.createAnim=function(){},n.prototype.remove=function(){this.Root!=null&&this.effectNode!=null&&this.effectNode.removeChild(this.Root)}}(),cc._RF.pop()},{"../../../../base/G":"G","../../../../base/Log":"Log","../../../../property/PropertyDefines":"PropertyDefines","../../../GameBus":"GameBus"}],CtrlObstacle:[function(l,P,m){"use strict";cc._RF.push(P,"78667oy8VpCr5mA4vh+m2Vw","CtrlObstacle"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../property/PropertyDefines"),s=l("../../../../base/G"),r=l("../../../GameBus"),o=l("../../../../base/Log"),e=function(){function n(){this.manager=null,this.duration=5,this.property=null}return n.prototype.init=function(){this.property=new d.Property(d.PROPERTYTYPE.GAME_OBSTACLE);var t=s.G.Ap.propertyPack.getConfig().getParam(new d.Property(d.PROPERTYTYPE.GAME_OBSTACLE));this.duration=t.effect.duration,this.updateAdditionTime()},n.prototype.updateAdditionTime=function(){var t=this.duration;this.duration=s.G.propAddition.getAdditionObstacleTime(this.duration,s.G.Ap.state.mission.getType().toString()),o.default.e("\u969C\u788D\u5757 \u65F6\u95F4\u52A0\u6210\uFF1A"+t+"  => "+this.duration)},n.prototype.exe=function(){var t=this;this.manager.propertyProcess.onStartProperty(this.property.type),r.default.getInstance().natureScheduler.scheduleOnce(function(){t.onComplete()},this.duration)},n.prototype.onComplete=function(){this.manager.propertyProcess.onEndProperty(this.property.type)},n}();m.CtrlObstacle=e,cc._RF.pop()},{"../../../../base/G":"G","../../../../base/Log":"Log","../../../../property/PropertyDefines":"PropertyDefines","../../../GameBus":"GameBus"}],CtrlPropertyManager:[function(l,P,m){"use strict";cc._RF.push(P,"2a13agHEDJDn7LuizYhTn7R","CtrlPropertyManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../property/PropertyDefines"),s=l("./debuff/CtrlFog"),r=l("./debuff/CtrlObstacle"),o=l("./debuff/CtrlControl"),e=l("./buff/CtrlAvoid"),n=l("./buff/CtrlConversion"),t=l("./buff/CtrlFanatical"),i=l("../../../base/G"),a=function(){function u(){this.propertyProcess=null,this.fog=new s.CtrlFog,this.obstacle=new r.CtrlObstacle,this.control=new o.CtrlControl,this.avoid=new e.CtrlAvoid,this.conversion=new n.CtrlConversion,this.fanatical=new t.CtrlFanatical,this.m_IsInit=!1}return u.prototype.init=function(){this.m_IsInit!=1&&(this.m_IsInit=!0,((this.avoid.manager=this).fog.manager=this).fog.Init(),(this.conversion.manager=this).conversion.init(),this.obstacle.init(),(this.obstacle.manager=this).control.init(),(this.control.manager=this).conversion.init(),(this.conversion.manager=this).fanatical.init(),this.fanatical.manager=this)},u.prototype.exe=function(c){switch(this.init(),c){case d.PROPERTYTYPE.GAME_FOG:case d.PROPERTYTYPE.GAME_CONTROLL:case d.PROPERTYTYPE.GAME_OBSTACLE:if(this.avoid.exe()==1)return void this.propertyProcess.onEndProperty(c)}switch(c){case d.PROPERTYTYPE.GAME_FOG:this.fog.exe();break;case d.PROPERTYTYPE.GAME_OBSTACLE:this.obstacle.exe();break;case d.PROPERTYTYPE.GAME_CONTROLL:this.control.exe();break;case d.PROPERTYTYPE.GAME_AVOID:this.avoid.exe();break;case d.PROPERTYTYPE.GAME_CONVERSION:this.conversion.exe();break;case d.PROPERTYTYPE.GAME_FANATICAL:this.fanatical.exe()}},u.prototype.trySubPropertyCount=function(c){return this.propertyProcess.onConsumeProperty(c.type)},u.prototype.test=function(){i.G.Ap.propertyPack.getConfig().getParam(new d.Property(d.PROPERTYTYPE.GAME_AVOID)),i.G.Ap.propertyPack.getConfig().getParam(new d.Property(d.PROPERTYTYPE.GAME_CONVERSION)),i.G.Ap.propertyPack.getConfig().getParam(new d.Property(d.PROPERTYTYPE.GAME_FANATICAL)),i.G.Ap.propertyPack.getConfig().getParam(new d.Property(d.PROPERTYTYPE.GAME_FOG)),i.G.Ap.propertyPack.getConfig().getParam(new d.Property(d.PROPERTYTYPE.GAME_CONTROLL)),i.G.Ap.propertyPack.getConfig().getParam(new d.Property(d.PROPERTYTYPE.GAME_OBSTACLE));for(var c=0;c<10;++c)this.conversion.miss()},u}();m.CtrlPropertyManager=a,cc._RF.pop()},{"../../../base/G":"G","../../../property/PropertyDefines":"PropertyDefines","./buff/CtrlAvoid":"CtrlAvoid","./buff/CtrlConversion":"CtrlConversion","./buff/CtrlFanatical":"CtrlFanatical","./debuff/CtrlControl":"CtrlControl","./debuff/CtrlFog":"CtrlFog","./debuff/CtrlObstacle":"CtrlObstacle"}],1:[function(l,P,m){"use strict";P.exports=l("./lib")},{"./lib":6}],2:[function(l,P,m){"use strict";var d=l("asap/raw");function s(){}var r=null,o={};function e(p){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof p!="function")throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,p!==s&&c(p,this)}function n(p,h){for(;p._83===3;)p=p._18;if(e._47&&e._47(p),p._83===0)return p._75===0?(p._75=1,void(p._38=h)):p._75===1?(p._75=2,void(p._38=[p._38,h])):void p._38.push(h);var f,g;f=p,g=h,d(function(){var _=f._83===1?g.onFulfilled:g.onRejected;if(_!==null){var y=function(S,I){try{return S(I)}catch(v){return r=v,o}}(_,f._18);y===o?i(g.promise,r):t(g.promise,y)}else f._83===1?t(g.promise,f._18):i(g.promise,f._18)})}function t(p,h){if(h===p)return i(p,new TypeError("A promise cannot be resolved with itself."));if(h&&(typeof h=="object"||typeof h=="function")){var f=function(g){try{return g.then}catch(_){return r=_,o}}(h);if(f===o)return i(p,r);if(f===p.then&&h instanceof e)return p._83=3,p._18=h,void a(p);if(typeof f=="function")return void c(f.bind(h),p)}p._83=1,p._18=h,a(p)}function i(p,h){p._83=2,p._18=h,e._71&&e._71(p,h),a(p)}function a(p){if(p._75===1&&(n(p,p._38),p._38=null),p._75===2){for(var h=0;h<p._38.length;h++)n(p,p._38[h]);p._38=null}}function u(p,h,f){this.onFulfilled=typeof p=="function"?p:null,this.onRejected=typeof h=="function"?h:null,this.promise=f}function c(p,h){var f=!1,g=function(_,y,S){try{_(y,S)}catch(I){return r=I,o}}(p,function(_){f||(f=!0,t(h,_))},function(_){f||(f=!0,i(h,_))});f||g!==o||(f=!0,i(h,r))}(P.exports=e)._47=null,e._71=null,e._44=s,e.prototype.then=function(p,h){if(this.constructor!==e)return g=p,_=h,new(f=this).constructor(function(S,I){var v=new e(s);v.then(S,I),n(f,new u(g,_,v))});var f,g,_,y=new e(s);return n(this,new u(p,h,y)),y}},{"asap/raw":10}],3:[function(l,P,m){"use strict";var d=l("./core.js");(P.exports=d).prototype.done=function(s,r){(arguments.length?this.then.apply(this,arguments):this).then(null,function(o){setTimeout(function(){throw o},0)})}},{"./core.js":2}],4:[function(l,P,m){"use strict";var d=l("./core.js");P.exports=d;var s=i(!0),r=i(!1),o=i(null),e=i(void 0),n=i(0),t=i("");function i(a){var u=new d(d._44);return u._83=1,u._18=a,u}d.resolve=function(a){if(a instanceof d)return a;if(a===null)return o;if(a===void 0)return e;if(a===!0)return s;if(a===!1)return r;if(a===0)return n;if(a==="")return t;if(typeof a=="object"||typeof a=="function")try{var u=a.then;if(typeof u=="function")return new d(u.bind(a))}catch(c){return new d(function(p,h){h(c)})}return i(a)},d.all=function(a){var u=Array.prototype.slice.call(a);return new d(function(c,p){if(u.length===0)return c([]);var h=u.length;function f(_,y){if(y&&(typeof y=="object"||typeof y=="function")){if(y instanceof d&&y.then===d.prototype.then){for(;y._83===3;)y=y._18;return y._83===1?f(_,y._18):(y._83===2&&p(y._18),void y.then(function(I){f(_,I)},p))}var S=y.then;if(typeof S=="function")return void new d(S.bind(y)).then(function(I){f(_,I)},p)}u[_]=y,--h==0&&c(u)}for(var g=0;g<u.length;g++)f(g,u[g])})},d.reject=function(a){return new d(function(u,c){c(a)})},d.race=function(a){return new d(function(u,c){a.forEach(function(p){d.resolve(p).then(u,c)})})},d.prototype.catch=function(a){return this.then(null,a)}},{"./core.js":2}],5:[function(l,P,m){"use strict";var d=l("./core.js");(P.exports=d).prototype.finally=function(s){return this.then(function(r){return d.resolve(s()).then(function(){return r})},function(r){return d.resolve(s()).then(function(){throw r})})}},{"./core.js":2}],6:[function(l,P,m){"use strict";P.exports=l("./core.js"),l("./done.js"),l("./finally.js"),l("./es6-extensions.js"),l("./node-extensions.js"),l("./synchronous.js")},{"./core.js":2,"./done.js":3,"./es6-extensions.js":4,"./finally.js":5,"./node-extensions.js":7,"./synchronous.js":8}],7:[function(l,P,m){"use strict";var d=l("./core.js"),s=l("asap");(P.exports=d).denodeify=function(o,e){return typeof e=="number"&&e!==1/0?function(n,t){for(var i=[],a=0;a<t;a++)i.push("a"+a);var u=["return function ("+i.join(",")+") {","var self = this;","return new Promise(function (rs, rj) {","var res = fn.call(",["self"].concat(i).concat([r]).join(","),");","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],u)(d,n)}(o,e):function(n){for(var t=Math.max(n.length-1,3),i=[],a=0;a<t;a++)i.push("a"+a);var u=["return function ("+i.join(",")+") {","var self = this;","var args;","var argLength = arguments.length;","if (arguments.length > "+t+") {","args = new Array(arguments.length + 1);","for (var i = 0; i < arguments.length; i++) {","args[i] = arguments[i];","}","}","return new Promise(function (rs, rj) {","var cb = "+r+";","var res;","switch (argLength) {",i.concat(["extra"]).map(function(c,p){return"case "+p+":res = fn.call("+["self"].concat(i.slice(0,p)).concat("cb").join(",")+");break;"}).join(""),"default:","args[argLength] = cb;","res = fn.apply(self, args);","}","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],u)(d,n)}(o)};var r="function (err, res) {if (err) { rj(err); } else { rs(res); }}";d.nodeify=function(o){return function(){var e=Array.prototype.slice.call(arguments),n=typeof e[e.length-1]=="function"?e.pop():null,t=this;try{return o.apply(this,arguments).nodeify(n,t)}catch(i){if(n==null)return new d(function(a,u){u(i)});s(function(){n.call(t,i)})}}},d.prototype.nodeify=function(o,e){if(typeof o!="function")return this;this.then(function(n){s(function(){o.call(e,null,n)})},function(n){s(function(){o.call(e,n)})})}},{"./core.js":2,asap:9}],8:[function(l,P,m){"use strict";var d=l("./core.js");(P.exports=d).enableSynchronous=function(){d.prototype.isPending=function(){return this.getState()==0},d.prototype.isFulfilled=function(){return this.getState()==1},d.prototype.isRejected=function(){return this.getState()==2},d.prototype.getValue=function(){if(this._83===3)return this._18.getValue();if(!this.isFulfilled())throw new Error("Cannot get a value of an unfulfilled promise.");return this._18},d.prototype.getReason=function(){if(this._83===3)return this._18.getReason();if(!this.isRejected())throw new Error("Cannot get a rejection reason of a non-rejected promise.");return this._18},d.prototype.getState=function(){return this._83===3?this._18.getState():this._83===-1||this._83===-2?0:this._83}},d.disableSynchronous=function(){d.prototype.isPending=void 0,d.prototype.isFulfilled=void 0,d.prototype.isRejected=void 0,d.prototype.getValue=void 0,d.prototype.getReason=void 0,d.prototype.getState=void 0}},{"./core.js":2}],9:[function(l,P,m){"use strict";var d=l("./raw"),s=[],r=[],o=d.makeRequestCallFromTimer(function(){if(r.length)throw r.shift()});function e(t){var i;(i=s.length?s.pop():new n).task=t,d(i)}function n(){this.task=null}P.exports=e,n.prototype.call=function(){try{this.task.call()}catch(t){e.onerror?e.onerror(t):(r.push(t),o())}finally{this.task=null,s[s.length]=this}}},{"./raw":10}],10:[function(l,P,m){(function(d){"use strict";function s(h){o.length||r(),o[o.length]=h}P.exports=s;var r,o=[],e=0;function n(){for(;e<o.length;){var h=e;if(e+=1,o[h].call(),1024<e){for(var f=0,g=o.length-e;f<g;f++)o[f]=o[f+e];o.length-=e,e=0}}o.length=0,e=0}var t,i,a,u=d!==void 0?d:self,c=u.MutationObserver||u.WebKitMutationObserver;function p(h){return function(){var f=setTimeout(_,0),g=setInterval(_,50);function _(){clearTimeout(f),clearInterval(g),h()}}}typeof c=="function"?(t=1,i=new c(n),a=document.createTextNode(""),i.observe(a,{characterData:!0}),r=function(){t=-t,a.data=t}):r=p(n),s.requestFlush=r,s.makeRequestCallFromTimer=p}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],DAwardMgr:[function(l,P,m){"use strict";cc._RF.push(P,"e2aa1dMosRORoUL77gIzhtp","DAwardMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./DailyAwardBens"),s=l("./DailyAwardGenerator"),r=l("../Logic/EventBus"),o=l("../Logic/NotifyEvent"),e=l("../Network/Protocol/StorageUtil"),n=l("../../config/LSKey"),t=l("../Logic/SkinDataManager"),i=l("../../infoc/m_p2_PData_Dia"),a=l("../Logic/GameItemsManager"),u=function(){function c(){this.mGenerator=null,this.DIFF_CLEAR_MILLISECONDS=216e5,this.mLastDateStrCache=null,this.mGenerator=new s.DailyAwardGenerator}return c.log=function(p){for(var h=[],f=1;f<arguments.length;f++)h[f-1]=arguments[f]},c.getIns=function(){return this.sInstance==null&&(this.sInstance=new c),this.sInstance},c.prototype.needShowDailyPopupDlgToday=function(){if(this.mLastDateStrCache==null){var p=e.default.read(n.default.SHOW_DAILY_AWARD_DIALOG_LAST_TIMES,"1970-1-1");p!=null&&p!=null&&p.length!=0||(p="1970-1-1"),this.mLastDateStrCache=p}var h=this.mGenerator.getTodayDateStr();return c.log("DailyAwardManager needShowDailyPopupDlgToday-> lastDateStr "+this.mLastDateStrCache+" , todayDateStr "+h+", result:"+(h>this.mLastDateStrCache)),h>this.mLastDateStrCache},c.prototype.updateShowDailyPopupDlgTime=function(){this.mLastDateStrCache=this.mGenerator.getTodayDateStr(),e.default.save(n.default.SHOW_DAILY_AWARD_DIALOG_LAST_TIMES,this.mLastDateStrCache),c.log("updateShowDailyPopupDlgTime "+this.mLastDateStrCache)},c.prototype.getDailySignInfoAsyn=function(p){c.log("getDailySignInfoAsyn called"),p&&this.mGenerator.generateDailySignInfo(p,!1)},c.prototype.checkReceiveStatAsyn=function(p){c.log("checkReceiveStatAsyn called"),p&&this.mGenerator.generateDailySignInfo(function(h){p(h.stat==d.AwardCfg.SIGN_STAT_OK&&h.receiveStat)},!0),this.receiveSkinAwardEnhance()},c.prototype.receiveSkinAwardEnhance=function(){3<=this.mGenerator.getSignInTime()&&(c.log("receiveSkinAwardEnhance\uFF1A SkinDataManager.unlockDailyAttendanceSkin called"),t.SkinDataMgr.Ins().unlockDailyAttendanceSkin())},c.prototype.receiveAward=function(p){var h=this;console.log("[DailyAward].receiveAward"),p&&this.mGenerator.doReceiveAward(function(f){f!=null&&(p(f),r.default.fire(o.default.DAILY_GET_AWARD),h.consumeAward(f.awardList))})},c.prototype.consumeAward=function(p){for(var h=0;h<p.length;h++){var f=p[h];f.awardType==a.GameItemType.TYPE_DIAMONDS?i.default.report(f.counter,i.default.SOURCE_DAILY_ATTENDANCE,i.default.ACTION_GET_DIAMOND):f.awardType==a.GameItemType.TYPE_SKIN&&(c.log("SkinDataManager.unlockDailyAttendanceSkin called"),t.SkinDataMgr.Ins().unlockDailyAttendanceSkin())}},c.sInstance=null,c.DIALOG_SRC_NONE=0,c.DIALOG_SRC_FIRST_RECEIVE_PIECE=1,c}();m.DAwardMgr=u,cc._RF.pop()},{"../../config/LSKey":"LSKey","../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../Logic/EventBus":"EventBus","../Logic/GameItemsManager":"GameItemsManager","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../Network/Protocol/StorageUtil":"StorageUtil","./DailyAwardBens":"DailyAwardBens","./DailyAwardGenerator":"DailyAwardGenerator"}],DBMgr:[function(l,P,m){"use strict";cc._RF.push(P,"c7851olDHpFXYsda0qu+CbM","DBMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("./CSV/BaseCsvFile"),o=l("./CSV/LevelData"),e=l("./CSV/LevelRewardData"),n=l("./CSV/MusicJsonData"),t=l("./CSV/LvData"),i=l("./CSV/ExpData"),a=l("./CSV/GoldData"),u=l("./CSV/LanguageSongData"),c=l("../Logic/LangMgr"),p=l("../../util/Dictionary"),h=l("../Logic/EventBus"),f=l("../Logic/NotifyEvent"),g=l("./CSV/MusicKeyData"),_=l("./CSV/CopyrightData"),y=l("./CSV/LoginReward"),S=l("./CSV/SongBox"),I=l("./CSV/FragmentBox"),v=l("./CSV/InviteAward"),C=l("../Logic/CopyrightManager"),T=l("./CSV/LevelConsumeData"),E=l("../../base/Log"),A=l("./CSV/LotteryData"),M=l("./CSV/VipData"),k=l("./CSV/CompetitionBasicData"),D=l("./CSV/CompetitionMusicData"),L=l("./CSV/CompetitionRewardData"),b=l("./CSV/GameItemsData"),N=l("./CSV/CompetitionSettlementData"),H=l("./CSV/ShopData"),R=l("./CSV/PlayerTaskData"),F=l("./CSV/LifeData"),x=l("./CSV/RankSetData"),U=l("./CSV/FightRuleData"),B=l("./CSV/RobotFightData"),Q=l("./CSV/SkinPieceData"),Z=l("./CSV/AdditionData"),z=l("./CSV/EffectData"),W=l("./CSV/HolidayTaskData");(s=d=m.eDataBase||(m.eDataBase={}))[s.eDB_Map=0]="eDB_Map",s[s.eDB_Level=1]="eDB_Level",s[s.eDB_LevelReward=2]="eDB_LevelReward",s[s.eDB_Language=3]="eDB_Language",s[s.eDB_LanguageSong=4]="eDB_LanguageSong",s[s.eDB_Animaiton=5]="eDB_Animaiton",s[s.eDB_Task=6]="eDB_Task",s[s.eDB_Lv=7]="eDB_Lv",s[s.eDB_Life=8]="eDB_Life",s[s.eDB_Exp=9]="eDB_Exp",s[s.eDB_MusicJson=10]="eDB_MusicJson",s[s.eDB_gold=11]="eDB_gold",s[s.eDB_FontName=12]="eDB_FontName",s[s.eDB_FontData=13]="eDB_FontData",s[s.eDB_FontInheritance=14]="eDB_FontInheritance",s[s.eDB_Holiday=15]="eDB_Holiday",s[s.eDB_MusicBlock=16]="eDB_MusicBlock",s[s.eDB_Album=17]="eDB_Album",s[s.eDB_WeekActivity=18]="eDB_WeekActivity",s[s.eDB_MusicReward=19]="eDB_MusicReward",s[s.eDB_PackageMusic=20]="eDB_PackageMusic",s[s.eDB_Leveing=21]="eDB_Leveing",s[s.eDB_GhostChase=22]="eDB_GhostChase",s[s.eDB_RedDotPriority=23]="eDB_RedDotPriority",s[s.eDB_Mission2MusicList=24]="eDB_Mission2MusicList",s[s.eDB_Mission2MusicRange=25]="eDB_Mission2MusicRange",s[s.eDB_AchieveMentData=26]="eDB_AchieveMentData",s[s.eDB_XmasActivity=27]="eDB_XmasActivity",s[s.eDB_MusicKey=28]="eDB_MusicKey",s[s.eDB_Copyright=29]="eDB_Copyright",s[s.eDB_LoginReward=30]="eDB_LoginReward",s[s.eDB_SongBox=31]="eDB_SongBox",s[s.eDB_FragmentBox=32]="eDB_FragmentBox",s[s.eDB_InviteAward=33]="eDB_InviteAward",s[s.eDB_LevelConsume=34]="eDB_LevelConsume",s[s.eDB_CompetitionBasic=35]="eDB_CompetitionBasic",s[s.eDB_CompetitionMusic=36]="eDB_CompetitionMusic",s[s.eDB_CompetitionReward=37]="eDB_CompetitionReward",s[s.eDB_CompetitionSettlement=38]="eDB_CompetitionSettlement",s[s.eDB_GameItems=39]="eDB_GameItems",s[s.eDB_Shop=40]="eDB_Shop",s[s.eDB_PlayerTask=41]="eDB_PlayerTask",s[s.eDB_Lottery=42]="eDB_Lottery",s[s.eDB_Vip=43]="eDB_Vip",s[s.eDB_RankSet=44]="eDB_RankSet",s[s.eDB_FightRule=45]="eDB_FightRule",s[s.eDB_RobotFight=46]="eDB_RobotFight",s[s.eDB_FightComboRule=47]="eDB_FightComboRule",s[s.eDB_HardRobot=48]="eDB_HardRobot",s[s.eDB_SkinPiece=49]="eDB_SkinPiece",s[s.eDB_Addition=50]="eDB_Addition",s[s.eDB_Effect=51]="eDB_Effect",s[s.eDB_HolidayTask=52]="eDB_HolidayTask";var V=function(){function Y(){this.mMapDataFile=new p.Dictionary,this.mDataCache=new p.Dictionary,this.mAllDataLoaded=!1,this.counter=0,this.loadTotle=0,this.loadCallback=null}return Y.Ins=function(){return Y.sInstance==null&&(Y.sInstance=new Y),Y.sInstance},Y.prototype.loadAllDataAsync=function(q){return __awaiter(this,void 0,void 0,function(){var J,ee;return __generator(this,function($){if(this.mAllDataLoaded)return q(),[2];for(this.loadData(d.eDB_Level,"DB/level"),this.loadData(d.eDB_LevelReward,"DB/levelreward"),this.loadData(d.eDB_MusicJson,"DB/music_json"),this.loadData(d.eDB_Lv,"DB/lv"),this.loadData(d.eDB_Life,"DB/life"),this.loadData(d.eDB_Exp,"DB/exp"),this.loadData(d.eDB_gold,"DB/gold"),this.loadData(d.eDB_LanguageSong,"DB/language_music"),this.loadData(d.eDB_MusicKey,"DB/music_key"),this.loadData(d.eDB_Copyright,"DB/copyright"),this.loadData(d.eDB_LoginReward,"DB/login_reward"),this.loadData(d.eDB_SongBox,"DB/song_box"),this.loadData(d.eDB_FragmentBox,"DB/fragment_box"),this.loadData(d.eDB_InviteAward,"DB/invite_award"),this.loadData(d.eDB_LevelConsume,"DB/level_consume"),this.loadData(d.eDB_CompetitionBasic,"DB/competition_basic"),this.loadData(d.eDB_CompetitionMusic,"DB/competition_music"),this.loadData(d.eDB_CompetitionReward,"DB/competition_reward"),this.loadData(d.eDB_CompetitionSettlement,"DB/competition_settlement"),this.loadData(d.eDB_GameItems,"DB/game_items_en"),this.loadData(d.eDB_Shop,"DB/shop"),this.loadData(d.eDB_PlayerTask,"DB/player_task"),this.loadData(d.eDB_Lottery,"DB/lottery"),this.loadData(d.eDB_Vip,"DB/vip"),this.loadData(d.eDB_RankSet,"DB/rank_set"),this.loadData(d.eDB_FightRule,"DB/fight_rule"),this.loadData(d.eDB_RobotFight,"DB/robotFight"),this.loadData(d.eDB_FightComboRule,"DB/rank_combo"),this.loadData(d.eDB_HardRobot,"DB/hard_robot"),this.loadData(d.eDB_SkinPiece,"DB/skin_piece"),this.loadData(d.eDB_Addition,"DB/addition"),this.loadData(d.eDB_Effect,"DB/effect"),this.loadData(d.eDB_HolidayTask,"DB/holidayTask_config"),J=[d.eDB_Level,d.eDB_LevelReward,d.eDB_MusicJson,d.eDB_Lv,d.eDB_Life,d.eDB_Exp,d.eDB_gold,d.eDB_LanguageSong,d.eDB_MusicKey,d.eDB_Copyright,d.eDB_LoginReward,d.eDB_SongBox,d.eDB_FragmentBox,d.eDB_InviteAward,d.eDB_LevelConsume,d.eDB_GameItems,d.eDB_Lottery,d.eDB_Vip,d.eDB_Addition,d.eDB_Effect],this.counter=0,this.loadTotle=J.length,this.loadCallback=q,ee=0;ee<J.length;ee++)this.loadDataAsync(J[ee],this.loadCounter,this);return[2]})})},Y.prototype.loadCounter=function(){this.counter++,h.default.fire(f.default.LOADING_DB,this.counter/this.loadTotle),this.counter==this.loadTotle&&(this.mAllDataLoaded=!0,this.loadCallback&&this.loadCallback(),console.log("load all txt succ"))},Y.prototype.reloadDb=function(q){var J=this;return new Promise(function(ee,$){return __awaiter(J,void 0,void 0,function(){return __generator(this,function(j){switch(j.label){case 0:return E.default.i("DataManager => reloadDb start.",q),this.mDataCache.remove(q),[4,this.loadDataAsync(q)];case 1:return j.sent(),ee(),[2]}})})})},Y.prototype.loadDb=function(q){var J=this;return new Promise(function(ee,$){return __awaiter(J,void 0,void 0,function(){return __generator(this,function(j){switch(j.label){case 0:return E.default.i("DataManager => loadDb start.",q),this.mDataCache.get(q)!=null?[3,2]:[4,this.loadDataAsync(q)];case 1:j.sent(),j.label=2;case 2:return ee(),[2]}})})})},Y.prototype.setDataFile=function(q,J){if(!J)return!1;this.mMapDataFile.put(q.valueOf(),J)},Y.prototype.getDataFile=function(q){return this.mMapDataFile.get(q)},Y.prototype.loadData=function(q,J){this.setDataFile(q,J)},Y.prototype.getData=function(q){var J=this.mDataCache.get(q);if(!J)throw new Error("Database "+q+" not loaded!");return J},Y.prototype.loadDataAsync=function(q,J,ee){return __awaiter(this,void 0,void 0,function(){var $,j,ie,oe,ue,pe,de;return __generator(this,function(he){switch(he.label){case 0:return($=this.mDataCache.get(q))?[3,2]:[4,this._getDataAsync(q,this.getDataFile(q))];case 1:if($=he.sent(),q==d.eDB_LanguageSong)for(j=$.getAllDB(),ie=j.length,oe=0;oe<ie;oe++)ue=j[oe],pe=ue[1],de=ue[2],c.default.gIns().setLanguage(pe,de);else if(q==d.eDB_Copyright)for(j=$.getAllDB(),ie=j.length,oe=0;oe<ie;oe++)ue=j[oe],pe=ue[0],de=ue[1],C.default.getInstance().setCopyrightData(parseInt(pe),de);else this.mDataCache.put(q,$);he.label=2;case 2:return J&&J.call(ee),[2]}})})},Y.prototype._getDataAsync=function(q,J){return __awaiter(this,void 0,Promise,function(){var ee=this;return __generator(this,function($){return[2,new Promise(function(j,ie){return __awaiter(ee,void 0,void 0,function(){var oe,ue,pe;return __generator(this,function(de){switch(oe=new r.default,ue=!0,pe=0,q){case d.eDB_Level:oe=new o.default;break;case d.eDB_LevelReward:oe=new e.LevelRewardData;break;case d.eDB_MusicJson:oe=new n.MusicJsonData;break;case d.eDB_Lv:oe=new t.LvData;break;case d.eDB_Life:oe=new F.LifeData;break;case d.eDB_Exp:oe=new i.default;break;case d.eDB_gold:oe=new a.GoldData;break;case d.eDB_LanguageSong:ue=!(pe=1),oe=new u.default;break;case d.eDB_FragmentBox:oe=new I.FragmentBox,ue=!(pe=1);break;case d.eDB_Lottery:oe=new A.LotteryData,ue=!(pe=1);break;case d.eDB_MusicKey:pe=1,oe=new g.MusicKeyData;break;case d.eDB_LevelConsume:oe=new T.LevelConsumeData,pe=1;break;case d.eDB_GameItems:oe=new b.GameItemsDatas,pe=1;break;case d.eDB_Copyright:ue=!1,oe=new _.CopyrightData;break;case d.eDB_LoginReward:oe=new y.LoginReward,ue=!1;break;case d.eDB_SongBox:oe=new S.SongBox,ue=!1;break;case d.eDB_InviteAward:oe=new v.InviteAward,ue=!1;break;case d.eDB_Vip:oe=new M.VipData;break;case d.eDB_CompetitionBasic:oe=new k.CompetitionBasicData;break;case d.eDB_CompetitionMusic:oe=new D.CompetitionMusicData;break;case d.eDB_CompetitionReward:oe=new L.CompetitionRewardData;break;case d.eDB_CompetitionSettlement:oe=new N.CompetitionSettlementData;break;case d.eDB_Shop:oe=new H.ShopData;break;case d.eDB_PlayerTask:oe=new R.PlayerTaskData;break;case d.eDB_RankSet:oe=new x.RankSetData;break;case d.eDB_FightRule:oe=new U.FightRuleData;break;case d.eDB_RobotFight:oe=new B.RobotFightData;break;case d.eDB_HardRobot:oe=new B.HardRobotData;break;case d.eDB_SkinPiece:oe=new Q.SkinPieceData;break;case d.eDB_Addition:oe=new Z.AdditionData;break;case d.eDB_Effect:oe=new z.EffectData;break;case d.eDB_HolidayTask:oe=new W.HolidayTaskData}return oe&&oe.open(J,ue,pe,function(he){j(oe)}),[2]})})})]})})},Y.prototype.getDBRow=function(q,J){var ee=this.getData(q);if(ee!=null)switch(q){case d.eDB_Level:case d.eDB_LevelReward:return ee.findLevel(J);case d.eDB_MusicJson:return ee.findMusic(J);case d.eDB_Lv:return ee.findLv(J);case d.eDB_Exp:return ee.findExpByLevel(J);case d.eDB_gold:return ee.findGoldByLevel(J);case d.eDB_LanguageSong:return ee.findLanguage(J);case d.eDB_MusicKey:return ee.findMusicByMid(J);case d.eDB_Copyright:return ee.findMid(J);case d.eDB_LoginReward:return ee.findLoginRewardById(J);case d.eDB_SongBox:return ee.findSongBoxById(J);case d.eDB_FragmentBox:return ee.findFragmentBoxById(J);case d.eDB_InviteAward:return ee.findInviteAwardById(J);case d.eDB_LevelConsume:return ee.findMid(J);case d.eDB_Lottery:return ee.findLotteryDataById(J);default:return ee.findId(J)}return null},Y.prototype.getDBRowByBiany=function(q,J){var ee=this.getData(q);if(ee)switch(q){case d.eDB_MusicJson:return ee.findMusicBiany(J)}return null},Y.prototype.getDBRowByRowID=function(q,J){var ee=this.getData(q);if(ee)switch(q){case d.eDB_MusicJson:return ee.findMusicByRowID(J)}return null},Y.prototype.getDBRows=function(q,J){var ee=this.getData(q);if(ee)switch(q){case d.eDB_LoginReward:return ee.findLoginRewardsByNewCome(J);case d.eDB_Lottery:return ee.findLotteryDataByNewCome(J);default:return ee.getAllData()}return[]},Y.sInstance=null,Y}();m.default=V,cc._RF.pop()},{"../../base/Log":"Log","../../util/Dictionary":"Dictionary","../Logic/CopyrightManager":"CopyrightManager","../Logic/EventBus":"EventBus","../Logic/LangMgr":"LangMgr","../Logic/NotifyEvent":"NotifyEvent","./CSV/AdditionData":"AdditionData","./CSV/BaseCsvFile":"BaseCsvFile","./CSV/CompetitionBasicData":"CompetitionBasicData","./CSV/CompetitionMusicData":"CompetitionMusicData","./CSV/CompetitionRewardData":"CompetitionRewardData","./CSV/CompetitionSettlementData":"CompetitionSettlementData","./CSV/CopyrightData":"CopyrightData","./CSV/EffectData":"EffectData","./CSV/ExpData":"ExpData","./CSV/FightRuleData":"FightRuleData","./CSV/FragmentBox":"FragmentBox","./CSV/GameItemsData":"GameItemsData","./CSV/GoldData":"GoldData","./CSV/HolidayTaskData":"HolidayTaskData","./CSV/InviteAward":"InviteAward","./CSV/LanguageSongData":"LanguageSongData","./CSV/LevelConsumeData":"LevelConsumeData","./CSV/LevelData":"LevelData","./CSV/LevelRewardData":"LevelRewardData","./CSV/LifeData":"LifeData","./CSV/LoginReward":"LoginReward","./CSV/LotteryData":"LotteryData","./CSV/LvData":"LvData","./CSV/MusicJsonData":"MusicJsonData","./CSV/MusicKeyData":"MusicKeyData","./CSV/PlayerTaskData":"PlayerTaskData","./CSV/RankSetData":"RankSetData","./CSV/RobotFightData":"RobotFightData","./CSV/ShopData":"ShopData","./CSV/SkinPieceData":"SkinPieceData","./CSV/SongBox":"SongBox","./CSV/VipData":"VipData"}],DailyAttendanceItemPrefbScript:[function(l,P,m){"use strict";cc._RF.push(P,"fb04bZGF2xHJb1Nv5AZmHT1","DailyAttendanceItemPrefbScript"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../daily/DailyAwardBens"),s=l("../../Logic/GameItemsManager"),r=l("../GameEntraScene/ImgCache"),o=l("../../Logic/I18nManager"),e=cc._decorator,n=e.ccclass,t=e.property,i=function(a){function u(){var c=a!==null&&a.apply(this,arguments)||this;return c.dayNode=null,c.todayNode=null,c.luckDayNode=null,c.dayTxt=null,c.diamondSprite=null,c.diamondPieceSprite=null,c.mSinglePieceIcon=null,c.giftSprite=null,c.numberTxt=null,c.maskSprite=null,c.rightMarkSprite=null,c.mDoublePieceIcon1=null,c.mDoublePieceIcon2=null,c.mDoublePieceNode=null,c.mBean=null,c.mReceiveStat=!1,c.mSignDay=0,c.mUIPostions=[{top:16,left:16},{top:16,left:162},{top:16,left:308},{top:16,left:454},{top:186,left:16},{top:186,left:162},{top:186,left:307}],c.mUIPostionsNew=[{top:16,left:16},{top:16,left:162},{top:16,left:307},{top:186,left:16},{top:186,left:162},{top:186,left:308},{top:186,left:454}],c.mShowTxtDay=["\u7B2C\u4E00\u5929","\u7B2C\u4E8C\u5929","\u7B2C\u4E09\u5929","\u7B2C\u56DB\u5929","\u7B2C\u4E94\u5929","\u7B2C\u516D\u5929","\u7B2C\u4E03\u5929"],c.mShowTxtDayEn=["Day 1","Day 2","Day 3","Day 4","Day 5","Day 6","Day 7"],c}return __extends(u,a),u.prototype.onLoad=function(){},u.prototype.init=function(c,p,h,f,g){this.mBean=c,this.mDayNode=p,this.mContainNode=h,this.mReceiveStat=f,this.mSignDay=g,this.initView()},u.prototype.updateDaySelectedView=function(c){this.mReceiveStat=c,this.resetDayNodeView(),this.initSelectDayView()},u.prototype.resetDayNodeView=function(){this.updateNodeStat(this.dayNode,!1),this.updateNodeStat(this.todayNode,!1),this.updateNodeStat(this.luckDayNode,!1),this.updateNodeStat(this.giftSprite,!1),this.updateNodeStat(this.maskSprite,!1),this.updateNodeStat(this.rightMarkSprite,!1)},u.prototype.resetView=function(){this.resetDayNodeView(),this.updateNodeStat(this.diamondSprite,!1),this.updateNodeStat(this.diamondPieceSprite,!1),this.mSinglePieceIcon&&this.updateNodeStat(this.mSinglePieceIcon.node,!1),this.updateNodeStat(this.giftSprite,!1)},u.prototype.isLuckDay=function(c){return this.mBean.signType==d.AwardCfg.SIGN_TYPE_NEWBIE&&c==3||c==7},u.prototype.updateNodeStat=function(c,p){c&&(c.active=p)},u.prototype.initView=function(){this.resetView(),this.updateDayNodeBase(),this.initContentView(),this.initSelectDayView()},u.prototype.initSelectDayView=function(){var c=this.mBean.day;this.isLuckDay(c)&&(this.updateNodeStat(this.luckDayNode,!0),this.updateNodeStat(this.giftSprite,!0)),c>this.mSignDay?this.updateNodeStat(this.dayNode,!0):c==this.mSignDay&&this.mReceiveStat==1?(this.updateNodeStat(this.todayNode,!0),this.updateNodeStat(this.luckDayNode,!1),this.numberTxt.node.color=cc.Color.BLACK.fromHEX("#FFFFFF")):(this.isLuckDay(c)?this.numberTxt.node.color=cc.Color.BLACK.fromHEX("#AD5FF8"):this.numberTxt.node.color=cc.Color.BLACK.fromHEX("#D3853B"),this.updateNodeStat(this.dayNode,!0),this.updateNodeStat(this.maskSprite,!0),this.updateNodeStat(this.rightMarkSprite,!0))},u.prototype.initContentView=function(){var c=this.mBean.awardList;if(c.length==1)switch(c[0].awardType){case s.GameItemType.TYPE_DIAMONDS:this.updateNodeStat(this.diamondSprite,!0),this.initContextText(c);break;case s.GameItemType.TYPE_PIECE:this.setSkinPieceIcon(this.mSinglePieceIcon),this.setSkinPieceText();break;case s.GameItemType.TYPE_SKIN:this.updateNodeStat(this.numberTxt.node,!1),this.mSinglePieceIcon&&this.updateNodeStat(this.mSinglePieceIcon.node,!0)}else c.length==2&&(this.isLuckDay(this.mBean.day)?this.updateNodeStat(this.giftSprite,!0):(this.updateNodeStat(this.diamondPieceSprite,!0),this.initContextText(c)));this.initLuckDayView()},u.prototype.setSkinPieceText=function(){var c="",p=this.mBean.awardList[0].skinPiece;if(p.length==1){var h=p[0].skinPieceCount;c=c+this.mBean.awardList[0].name+"x"+h}else h=parseInt(p[0].skinPieceCount)+parseInt(p[0].skinPieceCount),c=c+this.mBean.awardList[0].name+"x"+h;this.numberTxt.string=c},u.prototype.setSkinPieceIcon=function(c){if(c){var p=this.mBean.awardList[0].skinPiece;if(p.length==1){var h=p[0].skinPieceID,f=s.GameItemsManager.getIns().getSmallPicByItemId(h);r.default.get2(f,this.mSinglePieceIcon),this.updateNodeStat(this.mSinglePieceIcon.node,!0)}else{this.updateNodeStat(this.mDoublePieceNode,!0);var g=p[0].skinPieceID,_=s.GameItemsManager.getIns().getSmallPicByItemId(g);r.default.get2(_,this.mDoublePieceIcon1);var y=p[1].skinPieceID,S=s.GameItemsManager.getIns().getSmallPicByItemId(y);r.default.get2(S,this.mDoublePieceIcon2)}}},u.prototype.initContextText=function(c){for(var p="",h=0;h<c.length;h++)p=p+c[h].name+"x"+c[h].counter,h!=c.length-1&&(p+="/");this.numberTxt.string=p},u.prototype.initLuckDayView=function(){this.mBean.day==7&&(this.numberTxt.node.color=cc.Color.BLACK.fromHEX("#AD5FF8"),this.numberTxt.string=o.default.getInstance().getLanguageByKey("label_text.dia_gift"),this.updateNodeStat(this.giftSprite,!0),this.updateNodeStat(this.diamondPieceSprite,!1),this.updateNodeStat(this.diamondSprite,!1),this.mSinglePieceIcon&&this.updateNodeStat(this.mSinglePieceIcon.node,!1))},u.prototype.updateDayNodeBase=function(){var c=this.mBean.signType==d.AwardCfg.SIGN_TYPE_NEWBIE?this.mUIPostionsNew:this.mUIPostions,p=this.mBean.day-1;o.default.getInstance().isEnglish()?this.dayTxt.string=this.mShowTxtDayEn[p]:this.dayTxt.string=this.mShowTxtDay[p];var h=c[p].left-this.mContainNode.width/2+this.mDayNode.width/2,f=this.mContainNode.height-c[p].top-this.mContainNode.height/2-this.mDayNode.height/2;this.mDayNode.setPosition(h,f)},__decorate([t(cc.Node)],u.prototype,"dayNode",void 0),__decorate([t(cc.Node)],u.prototype,"todayNode",void 0),__decorate([t(cc.Node)],u.prototype,"luckDayNode",void 0),__decorate([t(cc.Label)],u.prototype,"dayTxt",void 0),__decorate([t(cc.Node)],u.prototype,"diamondSprite",void 0),__decorate([t(cc.Node)],u.prototype,"diamondPieceSprite",void 0),__decorate([t(cc.Sprite)],u.prototype,"mSinglePieceIcon",void 0),__decorate([t(cc.Node)],u.prototype,"giftSprite",void 0),__decorate([t(cc.Label)],u.prototype,"numberTxt",void 0),__decorate([t(cc.Node)],u.prototype,"maskSprite",void 0),__decorate([t(cc.Node)],u.prototype,"rightMarkSprite",void 0),__decorate([t(cc.Sprite)],u.prototype,"mDoublePieceIcon1",void 0),__decorate([t(cc.Sprite)],u.prototype,"mDoublePieceIcon2",void 0),__decorate([t(cc.Node)],u.prototype,"mDoublePieceNode",void 0),u=__decorate([n],u)}(cc.Component);m.default=i,cc._RF.pop()},{"../../Logic/GameItemsManager":"GameItemsManager","../../Logic/I18nManager":"I18nManager","../../daily/DailyAwardBens":"DailyAwardBens","../GameEntraScene/ImgCache":"ImgCache"}],DailyAttendancePrefbScript:[function(l,P,m){"use strict";cc._RF.push(P,"e7797riUFBMpIbxYsuGlhBG","DailyAttendancePrefbScript"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../daily/DailyAwardBens"),s=l("../../daily/DAwardMgr"),r=l("../GameEntraScene/BasicTouchEvent"),o=l("./DailyAttendanceItemPrefbScript"),e=l("../../daily/AwardInfoFactory"),n=l("../../awardcontroller/AwardController"),t=l("../../Logic/GameItemsManager"),i=l("../../../util/Dictionary"),a=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),u=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),c=l("../../../base/Log"),p=l("../GameEntraScene/PrefabMgr"),h=l("../GameEntraScene/ToastPrefab"),f=l("../../../../scripts/infoc/m_p2_Uaction"),g=l("../../../util/PU"),_=l("../../keypad/KeypadNavigator"),y=cc._decorator,S=y.ccclass,I=y.property,v=function(C){function T(){var E=C!==null&&C.apply(this,arguments)||this;return E.mCloseSkip=null,E.mMainPanel=null,E.mHeader=null,E.mReceiveAwardBtn=null,E.mReceiveAwardBtnTxtLable=null,E.mContentContainer=null,E.mBannerContainer=null,E.mSkinBannerContainer=null,E.dayItemPreF=null,E.dayBigItemPreF=null,E.toggleRV=null,E.doubleBtn=null,E.closedBanner=!0,E.mManager=null,E.mDailySignInfo=null,E.mDialogManager=null,E.mCurrentDayNodeScript=null,E.mCurrentDayNode=null,E.mOnReceiveClickEvent=null,E.mReportPage=0,E.mSkinChipDic=new i.Dictionary,E.mDailyAwardContents=null,E}return __extends(T,C),T.prototype.setCloseCallback=function(E){this.closeCallback=E},T.prototype.setShowSkinStoreCallbak=function(E){this.showSkinStoreCallbak=E},T.prototype.setShowSkinSplashCallbak=function(E){this.showSkinSplashCallbak=E},T.prototype.setPopupDlgManager=function(E){this.mDialogManager=E},T.prototype.gotoSkinStore=function(E){this.showSkinStoreCallbak&&this.showSkinStoreCallbak(E)},T.prototype.gotoSkinSplash=function(E){this.showSkinSplashCallbak&&this.showSkinSplashCallbak(E)},T.prototype.onLoad=function(){var E=this;this.initEvents(),this.mManager=s.DAwardMgr.getIns(),this.mManager.updateShowDailyPopupDlgTime(),this.mManager.getDailySignInfoAsyn(function(A){s.DAwardMgr.log("getDailySignInfoAsyn result:"),s.DAwardMgr.log(A),E.mDailySignInfo=A,E.initView()}),this.adaptorUI(),_.default.getInstance().pushDialog(this.node)},T.prototype.onDestroy=function(){_.default.getInstance().popDialog(this.node)},T.prototype.adaptorUI=function(){},T.prototype.initView=function(){this.initDayContentView(),this.initBannerView(),this.initButton()},T.prototype.initDayContentView=function(){for(var E=e.AwardInfoFactory.getInstance().generateUIData(this.mDailySignInfo.signType),A=0;A<7;A++){var M=E[A],k=cc.instantiate(M.bigStyle?this.dayBigItemPreF:this.dayItemPreF),D=k.getComponent(o.default);this.mContentContainer.addChild(k),k.name="day"+(A+1),D.init(M,k,this.mContentContainer,this.mDailySignInfo.receiveStat,this.mDailySignInfo.signDay),A==this.mDailySignInfo.signDay-1&&(this.mCurrentDayNodeScript=D,this.mCurrentDayNode=k)}},T.prototype.initBannerView=function(){this.mBannerContainer.active=!1,this.mSkinBannerContainer.active=!1,this.isShowSkinBanner()?this.mSkinBannerContainer.active=!0:this.mBannerContainer.active=!0},T.prototype.initButton=function(){this.mDailySignInfo.receiveStat==0?(this.mReceiveAwardBtn.node.active=!1,_.default.getInstance().refreshPage(this.node),this.uninitReceiveClickEvent()):this.initReceiveClickEvent()},T.prototype.isShowSkinBanner=function(){return!(this.mDailySignInfo.signType!=d.AwardCfg.SIGN_TYPE_NEWBIE||!(this.mDailySignInfo.signDay<3||this.mDailySignInfo.receiveStat&&this.mDailySignInfo.signDay==3))},T.prototype.updateView=function(){this.initButton(),this.mCurrentDayNodeScript.updateDaySelectedView(this.mDailySignInfo.receiveStat)},T.prototype.start=function(){},T.prototype.initEvents=function(){var E=this,A=new r.default(function(){E.onCloseClick()});this.mCloseSkip.node.on(cc.Node.EventType.TOUCH_END,A.click,A),this.node.on(cc.Node.EventType.TOUCH_START,function(){},this);var M=this.toggleRV;this.toggleRV.node.on(cc.Node.EventType.TOUCH_END,function(){M.isChecked?E.scheduleOnce(function(){M.uncheck(),this.mReceiveAwardBtn.node.active=!1,f.default.report(0,f.default.ACTION_CLICK_2_UNCHECK)},0):E.scheduleOnce(function(){M.check(),this.mReceiveAwardBtn.node.active=!0,f.default.report(0,f.default.ACTION_CLICK_2_CHECK)},0)},this)},T.prototype.initReceiveClickEvent=function(){this.mOnReceiveClickEvent=new r.default(this.onReceiveAwardClick.bind(this));var E=this.mOnReceiveClickEvent;this.mReceiveAwardBtn.node.on(cc.Node.EventType.TOUCH_END,E.click,E),this.mCurrentDayNode&&this.mCurrentDayNode.on(cc.Node.EventType.TOUCH_END,E.click,E)},T.prototype.uninitReceiveClickEvent=function(){if(this.mOnReceiveClickEvent){var E=this.mOnReceiveClickEvent;this.mCurrentDayNode&&this.mCurrentDayNode.off(cc.Node.EventType.TOUCH_END,E.click,E),this.mReceiveAwardBtn.node.off(cc.Node.EventType.TOUCH_END,E.click,E)}},T.prototype.onCloseClick=function(){this.closeCallback&&this.closeCallback()},T.prototype.onReceiveAwardClick=function(){this.toggleRV.isChecked?this.onReceiveAwardClick4Double():this.onReceiveAwardClick4Normal()},T.prototype.onReceiveAwardClick4Double=function(){var E=this;this.mDailySignInfo.receiveStat!=0&&(this.mDailySignInfo.receiveStat=!1,this.mManager.receiveAward(function(A){E.updateView(),E.mDailyAwardContents=E.rewardInfo2Content(E.mDailySignInfo.awardList),n.AwardController.giveAwardInfo(E.mDailyAwardContents),g.default.isCM()?E.showAdvForDoubleAwards(0):E.showAdvForDoubleAwards(u.ADScene.SOURCE_DAILY_ATTENDANCE_FRONT)}))},T.prototype.onReceiveAwardClick4Normal=function(){var E=this;this.mDailySignInfo.receiveStat!=0&&(this.mDailySignInfo.receiveStat=!1,this.mManager.receiveAward(function(A){if(E.updateView(),E.mDialogManager){var M=new n.AwardResultInfo,k=E.mDailySignInfo.awardList;if(0<k.length){M.setIsShowText(!1),M.setIsNeedGiveAwardInfo(!0).steSource(n.AwardResultInfo.SOURCE_DAILY_ATTENDANCE),n.AwardController.shouldDoubleAwards(k)?(M.setRichOkBtn(" ","/static_res/button_daily_checkin_award_normal_en","/static_res/button_daily_checkin_award_pressed_en",function(){n.AwardController.getIns().dismissAwardResultPage(M),g.default.isCM()?E.showAdvForDoubleAwards(0):E.showAdvForDoubleAwards(u.ADScene.DAILY_ATTENDANCE_CHECKIN)}),M.enableSkipLabel("",function(){n.AwardController.getIns().dismissAwardResultPage(M)})):M.setOkBtn("Ok",function(){n.AwardController.getIns().dismissAwardResultPage(M)}),M.setCloseParentCallback(function(){});for(var D=function(b){var N=k[b];N.awardType==t.GameItemType.TYPE_PIECE?N.skinPiece.forEach(function(H){M.addAwardContent(N.awardType,parseInt(H.skinPieceCount),H.skinPieceID)}):M.addAwardContent(N.awardType,N.counter,N.itemID)},L=0;L<k.length;L++)D(L);n.AwardController.getIns().showCommonAwardResultPage(M),E.mDailyAwardContents=M.getAwardContentList()}}}))},T.prototype.rewardInfo2Content=function(E){if(!E)return null;for(var A,M=[],k=function(b){b.awardType==t.GameItemType.TYPE_PIECE?b.skinPiece.forEach(function(N){var H=new n.AwardContent(b.awardType,parseInt(N.skinPieceCount),N.skinPieceID);M.push(H)}):(A=new n.AwardContent(b.awardType,b.counter,b.itemID),M.push(A))},D=0,L=E;D<L.length;D++)k(L[D]);return M},T.prototype.showAdvForDoubleAwards=function(E){var A=this;a.MGAdv.show(E,u.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(M){switch(M){case u.ADStat.NOT_NETWORK:A.showToastTips("No network available",!1);break;case u.ADStat.SHOW_SUCCESS_CLOSE:if(A.mDailyAwardContents){c.default.i("DailyAttendancePrefbScript","video adv shown, give awards.");var k=n.AwardController.filterAwardsForDouble(A.mDailyAwardContents);n.AwardController.giveAwardInfo(k),A.showToastTips(n.AwardController.getAwardsToastTip(k),!1),A.mDailyAwardContents=null}else c.default.i("DailyAttendancePrefbScript","video adv shown, but awards is invalidate");break;case u.ADStat.SHOW_NOT_ENED_CLOSE:break;case u.ADStat.SHOW_GET_AD_FAILED:A.showToastTips("No video ads available",!1)}})},T.prototype.showToastTips=function(E,A,M){var k=this;p.default.load("prefab/ToastPrefab",function(D,L){if(L){var b=L.getComponent(h.default);b.showTips(E,function(){L.destroy(),M&&M()}),b.setLong(A),k.node.addChild(L)}})},T.prototype.moveMainNode=function(){},__decorate([I(cc.Label)],T.prototype,"mCloseSkip",void 0),__decorate([I(cc.Node)],T.prototype,"mMainPanel",void 0),__decorate([I(cc.Node)],T.prototype,"mHeader",void 0),__decorate([I(cc.Button)],T.prototype,"mReceiveAwardBtn",void 0),__decorate([I(cc.Label)],T.prototype,"mReceiveAwardBtnTxtLable",void 0),__decorate([I(cc.Node)],T.prototype,"mContentContainer",void 0),__decorate([I(cc.Node)],T.prototype,"mBannerContainer",void 0),__decorate([I(cc.Node)],T.prototype,"mSkinBannerContainer",void 0),__decorate([I(cc.Prefab)],T.prototype,"dayItemPreF",void 0),__decorate([I(cc.Prefab)],T.prototype,"dayBigItemPreF",void 0),__decorate([I(cc.Toggle)],T.prototype,"toggleRV",void 0),__decorate([I(cc.Node)],T.prototype,"doubleBtn",void 0),T=__decorate([S],T)}(cc.Component);m.default=v,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../../scripts/infoc/m_p2_Uaction":"m_p2_Uaction","../../../base/Log":"Log","../../../util/Dictionary":"Dictionary","../../../util/PU":"PU","../../Logic/GameItemsManager":"GameItemsManager","../../awardcontroller/AwardController":"AwardController","../../daily/AwardInfoFactory":"AwardInfoFactory","../../daily/DAwardMgr":"DAwardMgr","../../daily/DailyAwardBens":"DailyAwardBens","../../keypad/KeypadNavigator":"KeypadNavigator","../GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../GameEntraScene/PrefabMgr":"PrefabMgr","../GameEntraScene/ToastPrefab":"ToastPrefab","./DailyAttendanceItemPrefbScript":"DailyAttendanceItemPrefbScript"}],DailyAwardBens:[function(l,P,m){"use strict";cc._RF.push(P,"8eedbQTR2NFiZ6ZXDABn4Qe","DailyAwardBens"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/GameItemsManager"),s=l("../../util/StringUtil"),r=l("../Logic/I18nManager"),o=function(){function i(){}return i.SIGN_TYPE_NONE="sign_type_none",i.SIGN_TYPE_NORMAL="sign_type_normal",i.SIGN_TYPE_NEWBIE="sign_type_newbie",i.SIGN_STAT_NET_ERROR="sign_stat_net_error",i.SIGN_STAT_OK="sign_stat_ok",i}();m.AwardCfg=o;var e=function(i,a,u,c,p){this.stat=i,this.awardList=p,this.signType=a,this.receiveStat=u,this.signDay=c};m.DailySignInfo=e;var n=function(i,a,u,c){this.day=i,this.bigStyle=a,this.awardList=u,this.signType=c};m.DailyDayUIBean=n;var t=function(){function i(){this.itemID="",this.awardType=-1,this.name="",this.counter=0,this.skinName="",this.skinPiece=null}return i.createDiamondInfo=function(a){var u=new i;return u.awardType=d.GameItemType.TYPE_DIAMONDS,u.name=r.default.getInstance().getLanguageByKey("label_text.diamond"),u.itemID="1-1-0",u.counter=a,u},i.createPieceInfo=function(a){if(!s.StringUtil.isEmpty(a)){var u=a.split("$"),c=new Array;u.forEach(function(h){var f={skinPieceID:h.split("%")[0],skinPieceCount:h.split("%")[1]};c.push(f)});var p=new i;return p.awardType=d.GameItemType.TYPE_PIECE,p.name="\u76AE\u80A4\u788E\u7247",p.skinPiece=c,p}},i.createSkinInfo=function(){var a=new i;return a.itemID="5-5-0",a.counter=1,a.awardType=d.GameItemType.TYPE_SKIN,a},i.prototype.toString=function(){return"awardType: "+this.awardType+" name: "+this.name+" counter: "+this.counter+" skinName: "+this.skinName},i}();m.AwardInfo=t,cc._RF.pop()},{"../../util/StringUtil":"StringUtil","../Logic/GameItemsManager":"GameItemsManager","../Logic/I18nManager":"I18nManager"}],DailyAwardGenerator:[function(l,P,m){"use strict";cc._RF.push(P,"facd4nE/6BBOqQsWHjAlJMx","DailyAwardGenerator"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Network/Protocol/StorageUtil"),s=l("../../config/LSKey"),r=l("../../util/TimeUtil"),o=l("./DailyAwardBens"),e=l("./AwardInfoFactory"),n=l("./DAwardMgr"),t=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),i=function(){function a(){this.mSignInTime=0,this.mSignInLastDate="",this.MAX_DAYS=7,this.DIFF_CLEAR_MILLISECONDS=216e5,this.ONE_DAY_MILLISECONDS=864e5,this.mCurrentSignType=o.AwardCfg.SIGN_TYPE_NORMAL,this.mCurrentReceiveStat=!1,this.mCurrentNowStr="",this.mCachedDailySignInfo=null,this.init()}return a.prototype.init=function(){this.mSignInLastDate=d.default.read(s.default.SIGN_IN_LAST_DATE,"1970_01_01"),this.mSignInLastDate==null&&(this.mSignInLastDate="1970_01_01");var u=d.default.read(s.default.SIGN_IN_TIMES);u&&0<u.length&&(this.mSignInTime=parseInt(u))},a.prototype.getSignInTime=function(){return this.mSignInTime},a.prototype.getTodayDateStr=function(){var u=new Date;return u.setTime(u.getTime()-this.DIFF_CLEAR_MILLISECONDS),r.default.formatDate(u.getTime())},a.prototype.getReceiveStat=function(){return this.mCurrentReceiveStat},a.prototype.getSignType=function(){return this.getCurrentSignInTime()>=this.MAX_DAYS?o.AwardCfg.SIGN_TYPE_NORMAL:o.AwardCfg.SIGN_TYPE_NEWBIE},a.prototype.getCurrentSignInTime=function(){return this.mCurrentReceiveStat==0?this.mSignInTime-1:this.mSignInTime},a.prototype.getCurrentSignDay=function(){return this.getCurrentSignInTime()%this.MAX_DAYS+1},a.prototype.saveData=function(){d.default.save(s.default.SIGN_IN_TIMES,this.mSignInTime.toString()),d.default.save(s.default.SIGN_IN_LAST_DATE,this.mSignInLastDate)},a.prototype.doReceiveAward=function(u){n.DAwardMgr.log(a.TAG+"doReceiveAward->getServerTime result: "+this.mCurrentReceiveStat),this.mCurrentReceiveStat&&(this.mSignInTime++,this.mSignInLastDate=this.mCurrentNowStr,this.saveData(),this.mCurrentReceiveStat=!1,this.refreshCachedSignInfo()),u(this.mCachedDailySignInfo)},a.prototype.refreshCachedSignInfo=function(){this.mCachedDailySignInfo&&(this.mCachedDailySignInfo.receiveStat=this.getReceiveStat())},a.prototype.generateDailySignInfo=function(u,c){var p=this;if(c==0&&this.mCachedDailySignInfo!=null)return n.DAwardMgr.log(a.TAG+"use mCachedDailySignInfo :"),n.DAwardMgr.log(this.mCachedDailySignInfo),void u(this.mCachedDailySignInfo);t.MGUser.getCurrentServerRealTime({complete:function(h,f){n.DAwardMgr.log(a.TAG+"doGenerate->getServerTime result: "+h+", timestamp: "+f),p.mCurrentReceiveStat=!1,h&&p.refreshStat(f/1e3);var g=new o.DailySignInfo(h?o.AwardCfg.SIGN_STAT_OK:o.AwardCfg.SIGN_STAT_NET_ERROR,p.getSignType(),p.getReceiveStat(),p.getCurrentSignDay(),p.getReceiveStat()?p.getCurrentAwardInfo():null);h&&(p.mCachedDailySignInfo=g),u(g)}})},a.prototype.getCurrentAwardInfo=function(){var u=this.getCurrentSignDay();return e.AwardInfoFactory.getInstance().generate(u,this.getSignType())},a.prototype.refreshStat=function(u){var c=new Date(1e3*u-this.DIFF_CLEAR_MILLISECONDS);this.mCurrentNowStr=r.default.formatDate(c.getTime()),this.mCurrentReceiveStat=this.mCurrentNowStr>this.mSignInLastDate,n.DAwardMgr.log(a.TAG+"refreshStat : "+this.mCurrentReceiveStat+"with now: "+this.mCurrentNowStr+" & lastSignInDate: "+this.mSignInLastDate)},a.prototype.getTestTime=function(u){var c=new Date;c.setTime(c.getTime()+1*this.ONE_DAY_MILLISECONDS),u(!0,c.getTime()/1e3)},a.TAG="DailyAwardGenerator",a}();m.DailyAwardGenerator=i,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../config/LSKey":"LSKey","../../util/TimeUtil":"TimeUtil","../Network/Protocol/StorageUtil":"StorageUtil","./AwardInfoFactory":"AwardInfoFactory","./DAwardMgr":"DAwardMgr","./DailyAwardBens":"DailyAwardBens"}],DataEntryWorker:[function(l,P,m){"use strict";cc._RF.push(P,"8bcd73lgjpL5pAOD7bgdhp0","DataEntryWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../gamescene/workers/WorkerBase"),s=l("../../Logic/LotteryDataManager"),r=l("../LotteryVM"),o=l("../LotteryEnum"),e=l("../../Logic/GameItemsManager"),n=function(t){function i(){var a=t.call(this,"DataEntryWorker")||this;return a.lotteryHandler=null,a}return __extends(i,t),i.prototype.init=function(a,u){var c=u,p=this.getDataList(c),h=this.getGameItems(),f=this.constructVMs(p,h);this.lotteryHandler=a,this.lotteryHandler.setLotteryVMList(f)},i.prototype.onStart=function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];try{if(a&&a.length<=0)return;var c=a[0],p=a[1];this.init(c,p)}catch(h){console.log("--- DataEntryWorker onStart err:---",h)}},i.prototype.onStop=function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];try{return void this.reset()}catch(c){console.log("--- DataEntryWorker onStop err:---",c)}},i.prototype.onStateChanged=function(a){},i.prototype.getDataList=function(a){a===void 0&&(a=o.UserEnum.PASS_COMING);var u=[];return a===o.UserEnum.NEW_COMING?u=s.LotteryDataMgr.Ins().getLotteryDataVM(1):a===o.UserEnum.PASS_COMING&&(u=s.LotteryDataMgr.Ins().getLotteryDataVM(0)),u},i.prototype.getGameItems=function(){return e.GameItemsManager.getIns().getAllItems()},i.prototype.constructVMs=function(a,u){for(var c=[],p=0,h=a;p<h.length;p++)for(var f=h[p],g=0,_=u;g<_.length;g++){var y=_[g];if(f.isSkinPiece==1){(S=new r.LotteryVM).setId(y.getItemId()),S.setChanceMin(f.chanceMin),S.setChanceMax(f.chanceMax),S.setCount(f.count),S.setIcon(y.getSmallPic()),S.setBigIcon(y.getPic()),S.setIsSkinPiece(f.isSkinPiece),c.push(S);break}if(f.rewardType===y.getItemId()){var S=new r.LotteryVM,I=o.SKIN_TYPE.NONE;S.setId(y.getItemId()),S.setChanceMin(f.chanceMin),S.setChanceMax(f.chanceMax),S.setIcon(y.getSmallPic()),S.setBigIcon(y.getPic()),S.setCount(f.count),S.setIsSkinPiece(f.isSkinPiece);var v=this.getSkinLimit(y.getItemId());v!==void 0&&(I=v?o.SKIN_TYPE.LIMIT:o.SKIN_TYPE.FOREVER),S.setSkinType(I),c.push(S)}}return c},i.prototype.getSkinLimit=function(a){if(a){var u=e.GameItemsManager.getIns(),c=!1;if(u.isSkinType(a)){var p=u.getItemTimeLimitDay(a);return p&&(c=p!==0),c}}},i.prototype.reset=function(){},i.prototype.onPause=function(){console.log("--- DataEntryWorker onPause---")},i.prototype.onResume=function(){console.log("--- DataEntryWorker onResume---")},i}(d.WorkerBase);m.default=n,cc._RF.pop()},{"../../../gamescene/workers/WorkerBase":"WorkerBase","../../Logic/GameItemsManager":"GameItemsManager","../../Logic/LotteryDataManager":"LotteryDataManager","../LotteryEnum":"LotteryEnum","../LotteryVM":"LotteryVM"}],Data:[function(l,P,m){"use strict";cc._RF.push(P,"d6a253D+ztMEpYthbgVjnON","Data"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function r(){this.releasePropertyCount=0,this.sufferPropertyCount=0,this.savePropertyCount=0,this.carryPropertyCount=0,this.missTimes=0,this.feverTimes=0}return r.prototype.reset=function(){this.releasePropertyCount=0,this.sufferPropertyCount=0,this.savePropertyCount=0,this.carryPropertyCount=0,this.missTimes=0,this.feverTimes=0},r}();m.FightGameSceneCountInfo=d;var s=function(){this.userAvatarIcon=null,this.opponentAvatarIcon=null,this.fightGameSceneCount=new d};m.default=s,cc._RF.pop()},{}],DateUtil:[function(l,P,m){"use strict";cc._RF.push(P,"b5304XCmCtB6obWj7v/oWpL","DateUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),s=function(){function r(){}return r.parseToDate=function(o){return new Date(o)},r.getFormattedDate=function(o){if(o){var e=o.getFullYear(),n=o.getMonth()+1,t=o.getDate();return e+"-"+this.getDateStrFormat(n)+"-"+this.getDateStrFormat(t)}return null},r.getDateStrFormat=function(o){return 10<=o?o.toString():"0"+o.toString()},r.getFormatedTime=function(o){if(!o)return null;var e=o.getHours().toString(),n=o.getMinutes().toString(),t=o.getSeconds().toString(),i=o.getMilliseconds().toString();if(n.length<2&&(n="0"+n),t.length<2&&(t="0"+t),i.length<3)for(var a=0;a<3-i.length;a++)i="0"+i;return e+":"+n+":"+t},r.isBeyondOnDay=function(o){var e=new Date(o);return e.setHours(24),e.setMinutes(59),e.setSeconds(59),d.MGUser.getCurrentServerTime()>e.getTime()},r}();m.default=s,cc._RF.pop()},{"../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance"}],DebugPanelPrefb:[function(l,P,m){"use strict";cc._RF.push(P,"b9e2aIhkVNPOL9zuMuZaLaP","DebugPanelPrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../config/LSKey"),s=l("../../Network/Protocol/StorageUtil"),r=l("../../../social/WXHelper"),o=l("../../Logic/MoneySystem"),e=l("../../../base/GameInfoMgr"),n=l("../../../util/PU"),t=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),i=l("../../Network/Protocol/MemCache"),a=l("../../../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance"),u=l("./PrefabMgr"),c=l("../../Logic/SkinDataManager"),p=l("../../../base/Log"),h=cc._decorator,f=h.ccclass,g=h.property,_=function(y){function S(){var I=y!==null&&y.apply(this,arguments)||this;return I.useLocalTime=null,I.useLocalTimeLabel=null,I.cleanData=null,I.cleanCache=null,I.cleanServerData=null,I.cleanWXData=null,I.addDiamondButton=null,I.infocButton=null,I.infoLabel=null,I.addMoneyButton=null,I.mInfiniteChallengeBtn=null,I.mInfiniteChallengeLabel=null,I.infiniteLotteryBtn=null,I.infiniteLotteryLabel=null,I.changePlayIdBtn=null,I.unlockAllSkinBtn=null,I.closeBtn=null,I.dialogNode=null,I.flauntPageDebugBtn=null,I.usePianoOther=null,I.usePianoOtherLable=null,I}return __extends(S,y),S.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(I){I.stopPropagation()}),this.cleanData.node.on(cc.Node.EventType.TOUCH_END,this.doCleanData,this),this.cleanCache.node.on(cc.Node.EventType.TOUCH_END,this.doCleanCache,this),this.cleanServerData.node.on(cc.Node.EventType.TOUCH_END,this.doCleanServerData,this),n.default.isWeiXin()?this.cleanWXData.node.on(cc.Node.EventType.TOUCH_END,this.doCleanWXData,this):this.cleanWXData.node.active=!1,this.addDiamondButton.node.on(cc.Node.EventType.TOUCH_END,this.addDiamond,this),this.addMoneyButton.node.on(cc.Node.EventType.TOUCH_END,this.addMoney,this),this.useLocalTime.node.on(cc.Node.EventType.TOUCH_END,this.setUseLocalTime,this),this.infocButton.node.on(cc.Node.EventType.TOUCH_END,this.infocTest,this),this.mInfiniteChallengeBtn.node.on(cc.Node.EventType.TOUCH_END,this.infiniteChallenge,this),this.infiniteLotteryBtn.node.on(cc.Node.EventType.TOUCH_END,this.infiniteLottery,this),this.changePlayIdBtn.node.on(cc.Node.EventType.TOUCH_END,this.changePlayId,this),this.unlockAllSkinBtn.node.on(cc.Node.EventType.TOUCH_END,this.unlockAllSkin,this),this.closeBtn.node.on(cc.Node.EventType.TOUCH_END,this.close,this),this.flauntPageDebugBtn.node.on(cc.Node.EventType.TOUCH_END,this.enableFlauntPageDebug,this),this.usePianoOther&&this.usePianoOther.node.on(cc.Node.EventType.TOUCH_END,this.unlockPianoTone,this),this.initView()},S.prototype.infocTest=function(){s.default.save(d.default.CMG_USE_INOFC_DEBUG_SERVER,"1")},S.prototype.initView=function(){var I=this,v=s.default.read(d.default.CMG_DEBUG_USE_LOCAL_TIME,"0");this.useLocalTimeLabel.string=v=="1"?"\u5207\u6362\u65F6\u95F4:\u5F53\u524D\u672C\u5730":"\u5207\u6362\u65F6\u95F4:\u5F53\u524D\u670D\u52A1\u7AEF",this.infoLabel&&(this.infoLabel.string="",t.MGUser.getUserLoginInfo({complete:function(C){var T=e.GameInfoMgr.Ins().getInfo();if(T){var E="";C?E+="wxId: "+C.playerId+"\n":E="wxId: \n",E+="AppId: "+T.appid+"\n",E+="GameId: "+T.gameid+"\n",E+="version: "+T.version+"\n",n.default.isWeiXin()&&(E+="Server: "+cmg.CloudUtil.SERVER_ADDRESS_BASE_WX),I.infoLabel.string=E}}})),this.initChallenge(),this.initLottery(),this.updateUsePianoName()},S.prototype.initChallenge=function(){var I=s.default.read(d.default.DEBUG_INFINITE_CHALLENGE_TIME);this.mInfiniteChallengeLabel.string=I==="true"?"\u70B9\u51FB\u5173\u95ED\u65E0\u9650\u64C2\u53F0\u8D5B":"\u70B9\u51FB\u5F00\u542F\u65E0\u9650\u64C2\u53F0\u8D5B"},S.prototype.initLottery=function(){var I=s.default.read(d.default.DEBUG_INFINITE_LOTTERY);this.infiniteLotteryLabel.string=I==="true"?"\u70B9\u51FB\u5173\u95ED\u65E0\u9650\u62BD\u5956":"\u70B9\u51FB\u5F00\u542F\u65E0\u9650\u62BD\u5956"},S.prototype.setUseLocalTime=function(){var I=s.default.read(d.default.CMG_DEBUG_USE_LOCAL_TIME,"0")=="1"?"0":"1";s.default.save(d.default.CMG_DEBUG_USE_LOCAL_TIME,I),this.useLocalTimeLabel.string=I=="1"?"\u5207\u6362\u65F6\u95F4:\u5F53\u524D\u672C\u5730":"\u5207\u6362\u65F6\u95F4:\u5F53\u524D\u670D\u52A1\u7AEF",this.showTips("\u5207\u6362\u6210\u529F")},S.prototype.addDiamond=function(){o.MoneySystem.increaseDiamond(199),this.showTips("\u94BB\u77F3 +199")},S.prototype.addMoney=function(){},S.prototype.doCleanData=function(){for(var I=this,v=d.default.KEYS_NEED_SYNC,C=0;C<v.length;C++)s.default.remove(v[C]);s.default.remove(i.MemCache.KEY_ALL),a.MGCloudStorage.delStorage({keys:d.default.KEYS_NEED_SYNC,complete:function(T){I.doCleanWXData()}})},S.prototype.doCleanCache=function(){for(var I=d.default.KEYS_NEED_SYNC,v=0;v<I.length;v++)s.default.remove(I[v]);s.default.remove(i.MemCache.KEY_ALL),this.showTips("\u5220\u9664\u6570\u636E\u3010\u6210\u529F\u3011",!0)},S.prototype.doCleanServerData=function(){var I=this;a.MGCloudStorage.delStorage({keys:d.default.KEYS_NEED_SYNC,complete:function(v){v?I.showTips("\u5220\u9664\u6570\u636E\u3010\u6210\u529F\u3011",!0):I.showTips("\u5220\u9664\u6570\u636E\u3010\u5931\u8D25\u3011",!0)}})},S.prototype.doCleanWXData=function(){var I=this;if(n.default.isWeiXin()){var v=[];v.push({key:"ts",value:""}),v.push({key:"ss_0",value:""}),v.push({key:"ss_1",value:""}),r.WXHelper.setUserCloudStorage(v,function(C){r.WXHelper.removeUserCloudStorage(["ts","ss_0","ss_1"],function(T){I.showTips("\u5220\u9664\u6570\u636E\u3010\u6210\u529F\u3011",!0)})})}},S.prototype.showTips=function(I,v){v===void 0&&(v=!1);var C=v?"\u91CD\u542F\u540E\u751F\u6548":"\u64CD\u4F5C\u6210\u529F";n.default.isWeiXin()?wx.showModal({title:C,content:I,showCancel:!1,confirmText:"\u5173\u95ED"}):p.default.e("DebugPanel=> title="+C+"  content="+I)},S.prototype.infiniteChallenge=function(){s.default.read(d.default.DEBUG_INFINITE_CHALLENGE_TIME)==="true"?(s.default.save(d.default.DEBUG_INFINITE_CHALLENGE_TIME,"false"),this.mInfiniteChallengeLabel.string="\u70B9\u51FB\u5F00\u542F\u65E0\u9650\u64C2\u53F0\u8D5B",this.showTips("\u65E0\u9650\u6B21\u64C2\u53F0\u8D5B\u5173\u95ED\u6210\u529F")):(s.default.save(d.default.DEBUG_INFINITE_CHALLENGE_TIME,"true"),this.mInfiniteChallengeLabel.string="\u70B9\u51FB\u5173\u95ED\u65E0\u9650\u64C2\u53F0\u8D5B",this.showTips("\u65E0\u9650\u6B21\u64C2\u53F0\u8D5B\u5F00\u542F\u6210\u529F"))},S.prototype.infiniteLottery=function(){s.default.read(d.default.DEBUG_INFINITE_LOTTERY)==="true"?(s.default.save(d.default.DEBUG_INFINITE_LOTTERY,"false"),this.infiniteLotteryLabel.string="\u70B9\u51FB\u5F00\u542F\u65E0\u9650\u62BD\u5956",this.showTips("\u65E0\u9650\u6B21\u62BD\u5956\u5173\u95ED\u6210\u529F")):(s.default.save(d.default.DEBUG_INFINITE_LOTTERY,"true"),this.infiniteLotteryLabel.string="\u70B9\u51FB\u5173\u95ED\u65E0\u9650\u62BD\u5956",this.showTips("\u65E0\u9650\u6B21\u62BD\u5956\u5F00\u542F\u6210\u529F"))},S.prototype.updateUsePianoName=function(){},S.prototype.unlockPianoTone=function(){},S.prototype.enableFlauntPageDebug=function(){s.default.read(d.default.DEBUG_ENABLE_FLAUNT_PAGE)==="true"?(s.default.save(d.default.DEBUG_ENABLE_FLAUNT_PAGE,"false"),this.showTips("\u70AB\u8000\u9875DEBUG\u5173\u95ED")):(s.default.save(d.default.DEBUG_ENABLE_FLAUNT_PAGE,"true"),this.showTips("\u70AB\u8000\u9875DEBUG\u5F00\u542F"))},S.prototype.changePlayId=function(){var I=this;u.default.load("prefab/ChangePlayIDPrefab",function(v,C){I.dialogNode.addChild(C)})},S.prototype.unlockAllSkin=function(){var I=c.SkinDataMgr.Ins().getSkinList();I&&I.forEach(function(v){c.SkinDataMgr.Ins().unlockSkin(v.name)}),this.showTips("\u76AE\u80A4\u89E3\u9501\u6210\u529F")},S.prototype.setCloseCallback=function(I){this.mCloseCallback=I},S.prototype.close=function(){this.mCloseCallback&&this.mCloseCallback(),this.node.destroy()},__decorate([g(cc.Button)],S.prototype,"useLocalTime",void 0),__decorate([g(cc.Label)],S.prototype,"useLocalTimeLabel",void 0),__decorate([g(cc.Button)],S.prototype,"cleanData",void 0),__decorate([g(cc.Button)],S.prototype,"cleanCache",void 0),__decorate([g(cc.Button)],S.prototype,"cleanServerData",void 0),__decorate([g(cc.Button)],S.prototype,"cleanWXData",void 0),__decorate([g(cc.Button)],S.prototype,"addDiamondButton",void 0),__decorate([g(cc.Button)],S.prototype,"infocButton",void 0),__decorate([g(cc.Label)],S.prototype,"infoLabel",void 0),__decorate([g(cc.Button)],S.prototype,"addMoneyButton",void 0),__decorate([g(cc.Button)],S.prototype,"mInfiniteChallengeBtn",void 0),__decorate([g(cc.Label)],S.prototype,"mInfiniteChallengeLabel",void 0),__decorate([g(cc.Button)],S.prototype,"infiniteLotteryBtn",void 0),__decorate([g(cc.Label)],S.prototype,"infiniteLotteryLabel",void 0),__decorate([g(cc.Button)],S.prototype,"changePlayIdBtn",void 0),__decorate([g(cc.Button)],S.prototype,"unlockAllSkinBtn",void 0),__decorate([g(cc.Button)],S.prototype,"closeBtn",void 0),__decorate([g(cc.Node)],S.prototype,"dialogNode",void 0),__decorate([g(cc.Button)],S.prototype,"flauntPageDebugBtn",void 0),__decorate([g(cc.Button)],S.prototype,"usePianoOther",void 0),__decorate([g(cc.Label)],S.prototype,"usePianoOtherLable",void 0),S=__decorate([f],S)}(cc.Component);m.default=_,cc._RF.pop()},{"../../../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance":"MGCloudStorageEntrance","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../base/GameInfoMgr":"GameInfoMgr","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../social/WXHelper":"WXHelper","../../../util/PU":"PU","../../Logic/MoneySystem":"MoneySystem","../../Logic/SkinDataManager":"SkinDataManager","../../Network/Protocol/MemCache":"MemCache","../../Network/Protocol/StorageUtil":"StorageUtil","./PrefabMgr":"PrefabMgr"}],DecelerateConfirm:[function(l,P,m){"use strict";cc._RF.push(P,"679a4owKmhHoYZq3/JhbyJ2","DecelerateConfirm"),Object.defineProperty(m,"__esModule",{value:!0});var d=cc._decorator,s=d.ccclass,r=(d.property,l("../../util/nodeFacade")),o=l("../../business/UI/GameEntraScene/BasicTouchEvent"),e=l("../../business/keypad/KeypadNavigator"),n=function(t){function i(){var a=t!==null&&t.apply(this,arguments)||this;return a.confirmCallback=null,a.cancelCallback=null,a.destroyCallback=null,a}return __extends(i,t),i.prototype.onLoad=function(){var a=new r.default(this.node).getChild("dlg");this.buildBkg(),a&&this.buildCloseBtn(a),a&&this.buildConfirmBtn(a),e.default.getInstance().pushDialog(this.node,"DecelerateConfirm")},i.prototype.onDestroy=function(){e.default.getInstance().popDialog(this.node,"DecelerateConfirm")},i.prototype.buildBkg=function(){var a=this.node.getChildByName("bkg");a&&(a.on(cc.Node.EventType.TOUCH_START,function(u){u.stopPropagation()}),a.on(cc.Node.EventType.TOUCH_END,function(u){u.stopPropagation()}))},i.prototype.buildCloseBtn=function(a){var u=this,c=a.getChild("closebutton").getNode();if(c){var p=new o.default(function(){u.onClickCloseButton()});c.on(cc.Node.EventType.TOUCH_END,p.click,p)}},i.prototype.buildConfirmBtn=function(a){var u=this,c=a.getChild("confirmbutton").getNode();if(c){var p=new o.default(function(){u.onConfirmBtnClick()});c.on(cc.Node.EventType.TOUCH_END,p.click,p)}},i.prototype.onClickCloseButton=function(){this.node.active=!1,this.cancelCallback(),this.destroyCallback()},i.prototype.onConfirmBtnClick=function(){this.node.active=!1,this.confirmCallback(),this.destroyCallback()},i.prototype.setDestroyCallback=function(a){a&&(this.destroyCallback=a)},i.prototype.setConfirmCallback=function(a){a&&(this.confirmCallback=a)},i.prototype.setCancelCallback=function(a){a&&(this.cancelCallback=a)},i=__decorate([s],i)}(cc.Component);m.default=n,cc._RF.pop()},{"../../business/UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../../business/keypad/KeypadNavigator":"KeypadNavigator","../../util/nodeFacade":"NodeFacade"}],DecelerateWorker:[function(l,P,m){"use strict";cc._RF.push(P,"2d97fdULgFAC6YQlNBNth8z","DecelerateWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../workers/WorkerBase"),s=l("../../../property/PropertyDefines"),r=l("../../../base/G"),o=l("../../../util/runtime/Tween"),e=l("../../workers/WorkerState"),n=l("../../GameBus"),t=l("../../../util/runtime/ClassType"),i=l("./../../../base/Log"),a=function(u){function c(){var p=u.call(this,"DecelerateWorker")||this;return p.preSpeed=0,p.endSpeed=0,p.duration=0,p.obtained=!1,p.decelerateProperty=null,p.endCallback=null,p.MULTIPLE=.5,p.RECOVERY_TIME=2,p}return __extends(c,u),c.prototype.init=function(p,h,f){var g=p.getSpeed();r.G.Ap.config.mBaseBlockHeight,this.endSpeed=g*this.MULTIPLE,this.duration=h.permanentTime||0,this.updateAdditionTime(),this.setPreSpeed(g),this.setEndCallback(f),this.stage=p,this.stage.setSpeed(this.endSpeed),this.decelerateProperty=new s.Property(s.PROPERTYTYPE.GAME_SLOW),this.startCountDown(this.duration),console.log("--- DecelerateWorker onStart preSpeed:---",g)},c.prototype.updateAdditionTime=function(){var p=this.duration;this.duration=r.G.propAddition.getAdditionDashTime(this.duration,r.G.Ap.state.mission.getType().toString()),i.default.e("\u51CF\u901F \u65F6\u95F4\u52A0\u6210\uFF1A"+p+"  => "+this.duration)},c.prototype.onStart=function(){for(var p=[],h=0;h<arguments.length;h++)p[h]=arguments[h];try{if(p&&p.length<=0)return;var f=p[0],g=p[1],_=p[2];this.init(f,g,_),r.G.Ap.state.startPropertyWork(this.decelerateProperty),console.log("--- DecelerateWorker onStart args:---",p)}catch(y){console.log("--- DecelerateWorker onStart err:---",y)}},c.prototype.onStop=function(){for(var p=[],h=0;h<arguments.length;h++)p[h]=arguments[h];try{return r.G.Ap.state.stopPropertyWork(this.decelerateProperty),void(this.stage.propertyWorked=!1)}catch(f){console.log("--- DecelerateWorker onStop err:---",f)}},c.prototype.onPause=function(){console.log("--- DecelerateWorker onPause---")},c.prototype.onResume=function(){console.log("--- DecelerateWorker onResume---")},c.prototype.onStateChanged=function(p){console.log("--- DecelerateWorker onStateChanged args:---",p),p.state===e.WorkerState.stopped&&this.recovery()},c.prototype.reset=function(){this.preSpeed=0,this.endSpeed=0,this.duration=0,this.obtained=!1,this.decelerateProperty=null},c.prototype.recovery=function(){try{cc.sys.platform==cc.sys.QQ_PLAY?this.workForQQ():this.workForWechat(requestAnimationFrame,cancelAnimationFrame)}catch(p){this.stage.setSpeed(this.preSpeed)}},c.prototype.workForWechat=function(p,h){var f=this,g=this.endSpeed,_=59*this.RECOVERY_TIME,y=0,S=0;this.stage.setSpeed(g);var I=function(){var v=f.preSpeed;if(f.state===e.WorkerState.stopped){var C=f.getChangeSpeed(y,g,v,_);++y<=_?(f.stage.setSpeed(C),S&&h(S),S=p(I)):(f.stage.setSpeed(v),f.reset(),S&&h(S))}};I()},c.prototype.workForQQ=function(){this.workForWechat(t.Type.getRaf(),t.Type.getCaf())},c.prototype.getChangeSpeed=function(p,h,f,g){var _=o.mTween.quadLinear(p,h,f,g);return _=Math.min(_,f)},c.prototype.startCountDown=function(p){var h=this;p&&n.default.getInstance().scheduler.scheduleOnce(function(){h.endCallback()},p)},c.prototype.setEndCallback=function(p){p&&(this.endCallback=p)},c.prototype.getEndCallback=function(){return this.endCallback},c.prototype.setPreSpeed=function(p){p===void 0&&(p=0),this.preSpeed=p},c}(d.WorkerBase);m.default=a,cc._RF.pop()},{"../../../base/G":"G","../../../property/PropertyDefines":"PropertyDefines","../../../util/runtime/ClassType":"ClassType","../../../util/runtime/Tween":"Tween","../../GameBus":"GameBus","../../workers/WorkerBase":"WorkerBase","../../workers/WorkerState":"WorkerState","./../../../base/Log":"Log"}],DefaultAdapter:[function(l,P,m){"use strict";cc._RF.push(P,"3bc40OGOzJMoIhVOpMz1cNx","DefaultAdapter"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.prototype.needDownloadRes=function(){return!1},s.prototype.isSupportDownloadRes=function(){return!1},s.prototype.createCanvas=function(){return document.createElement("canvas")},s.prototype.createImage=function(){return document.createElement("img")},s.prototype.onShowListen=function(r){},s.prototype.offShowListen=function(r){},s.prototype.onHideListen=function(r){},s.prototype.offHideListen=function(r){},s.prototype.getLaunchParameter=function(){return null},s.prototype.getShareCanvas=function(){return null},s.prototype.getUserDataPath=function(){return""},s.prototype.unZip=function(r,o,e,n){n&&n()},s.prototype.downloadFile=function(r,o,e,n,t){return n===void 0&&(n=0),t===void 0&&(t=!0),e&&e(),null},s.prototype.getFileSystemManager=function(){return new Object},s.prototype.getCanvasHeightByContext=function(r){return r.canvas.height},s.prototype.getImageSrc=function(r){return new Object},s.prototype.loadImage=function(r){},s.prototype.getSharePath=function(r){return r},s.prototype.saveShareTmpFile=function(r,o){return""},s.prototype.getImageBySimpleImage=function(r){return r.image},s}();m.default=d,cc._RF.pop()},{}],Define:[function(l,P,m){"use strict";cc._RF.push(P,"4bea3WW3jtGwa1tRQ3G4+ru","Define"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../DB/DBMgr"),o=l("../../util/StringUtil"),e=l("./../../base/Log");(s=d||(d={})).Gold="2-1-",s.GameGold="2-2-",s.Exp="3-",s.Revive="4-",s.GameProp="5-",s.GameProp_Dash="5-21-",s.GameProp_Slow="5-22-",s.GameProp_Shield="5-23-",s.GameProp_Fanatical="5-31-",s.GameProp_Fog="5-32-",s.GameProp_Obstacle="5-33-",s.GameProp_Conversion="5-30-";var n=function(){function a(u,c,p){p===void 0&&(p=!0),this.isPercent=!0,this.value=0,this.effectId=u,this.isPercent=p,this.value=c}return a.prototype.isType=function(u,c){return c===void 0&&(c=!0),!o.StringUtil.isEmpty(this.effectId)&&(c?this.effectId.startsWith(u):this.effectId===u)},a.getEffect=function(u){if(o.StringUtil.isEmpty(u))return null;var c=r.default.Ins().getDBRows(r.eDataBase.eDB_Effect);if(c)for(var p=0;p<c.length;p++){var h=c[p];if(h&&h.getEffectId()==u)return new a(h.getEffectId(),h.getValue(),h.getisPercent())}return null},a}(),t=function(){function a(){this.mAdditions=new Map,this.mSkinAdditions=null}return a.prototype.getAdditions=function(){for(var u=this,c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];var h=[];return c&&0<c.length&&c.forEach(function(f){var g=u.mAdditions.get(f);g&&0<g.length&&g.forEach(function(_){_&&h.push(_)})}),h},a.prototype.filterAdditions=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];for(var h=this.getAdditions.apply(this,c),f=[],g=0;g<h.length;g++){var _=h[g];u&&u(_)&&f.push(_)}return f},a.prototype.setSkinAdditions=function(u){this.removeAdditions(this.mSkinAdditions),this.mSkinAdditions=u,this.addAdditions(u)},a.prototype.addAdditions=function(u){var c=this;u&&u.forEach(function(p,h){var f=c.mAdditions.get(h);f||(f=[],c.mAdditions.set(h,f)),p&&0<p.length&&p.forEach(function(g){g&&(f.push(g),e.default.l("\u65B0\u589E\u52A0\u6210\u5C5E\u6027\uFF1Ascene="+h+"  [effect:"+g.effectId+"]",g))})})},a.prototype.removeAdditions=function(u){var c=this;u&&u.forEach(function(p,h){var f=c.mAdditions.get(h);f&&p&&0<p.length&&p.forEach(function(g){var _=f.indexOf(g);0<=_&&f.splice(_,1)})})},a.prototype.calcAdditions=function(u,c){for(var p=[],h=2;h<arguments.length;h++)p[h-2]=arguments[h];var f=this.filterAdditions.apply(this,[c].concat(p)),g=1,_=0;if(f&&0<f.length)for(var y=0;y<f.length;y++){var S=f[y];S&&(S.isPercent?g+=S.value:_+=S.value)}return u*g+_},a.prototype.getAdditionedExp=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return Math.ceil(this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.Exp)}].concat(c)))},a.prototype.getAdditionGainMoney=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return Math.ceil(this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameGold)}].concat(c)))},a.prototype.getAdditionReviveTimes=function(){for(var u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];return this.calcAdditions.apply(this,[0,function(p){return p&&p.isType(d.Revive)}].concat(u))},a.prototype.getAdditionDashTime=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameProp_Dash)}].concat(c))},a.prototype.getAdditionFogTime=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameProp_Fog)}].concat(c))},a.prototype.getAdditionObstacleTime=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameProp_Obstacle)}].concat(c))},a.prototype.getAdditionConversionTime=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return Math.ceil(this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameProp_Conversion)}].concat(c)))},a.prototype.getAdditionSlowTime=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameProp_Slow)}].concat(c))},a.prototype.getAdditionShieldTime=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameProp_Shield)}].concat(c))},a.prototype.getAdditionCtrlFanaticalTime=function(u){for(var c=[],p=1;p<arguments.length;p++)c[p-1]=arguments[p];return this.calcAdditions.apply(this,[u,function(h){return h&&h.isType(d.GameProp_Fanatical)}].concat(c))},a}();m.PropAddition=t;var i=function(){function a(){}return a.getAdditions=function(u){var c=new Map;if(!o.StringUtil.isEmpty(u))for(var p=r.default.Ins().getDBRows(r.eDataBase.eDB_Addition),h=0;h<p.length;h++){var f=p[h];if(f&&f.getItemId()==u){var g=f.getSceneId(),_=c.get(g);_||(_=[],c.set(g,_));var y=n.getEffect(f.getEffectId());y&&_.push(y)}}return c},a.getAdditionDesc=function(u){for(var c=r.default.Ins().getDBRows(r.eDataBase.eDB_Addition),p="",h=0;h<c.length;h++){var f=c[h];if(f&&f.getItemId()==u&&(p=f.getDesc(),!o.StringUtil.isEmpty(p)))break}return p},a}();m.default=i,cc._RF.pop()},{"../../util/StringUtil":"StringUtil","../DB/DBMgr":"DBMgr","./../../base/Log":"Log"}],Delay:[function(l,P,m){"use strict";cc._RF.push(P,"10d96r+CipBIZa4jJ4llYlU","Delay"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.wait=function(r){return new Promise(function(o){return setTimeout(o,r/1e3)})},s}();m.Delay=d,cc._RF.pop()},{}],DeskIconInstrucPrefb:[function(l,P,m){"use strict";cc._RF.push(P,"31fc7j70tdH0bPpe8ACQ9E2","DeskIconInstrucPrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BasicTouchEvent"),s=l("../../../util/SUtil"),r=cc._decorator,o=r.ccclass,e=r.property,n=function(t){function i(){var a=t!==null&&t.apply(this,arguments)||this;return a.mCloseButton=null,a.mArrow=null,a.mTitle=null,a.mWhiteBg=null,a.mMenuLabel=null,a}return __extends(i,t),i.prototype.onLoad=function(){var a=this,u=new d.default(function(){a.mCloseCallback()});this.mCloseButton.node.on(cc.Node.EventType.TOUCH_END,u.click,u),this.node.on(cc.Node.EventType.TOUCH_START,function(c){c.stopPropagation()},this),this.adaptorUI(),cc.sys.platform==cc.sys.QQ_PLAY&&(this.mMenuLabel.string="\u70B9\u51FB\u83DC\u5355 \u201C\u521B\u5EFA\u684C\u9762\u5FEB\u6377\u65B9\u5F0F\u201D \u9009\u9879")},i.prototype.adaptorUI=function(){s.SUtil.ins().isLiuHai()&&(s.SUtil.ins().toTop(this.mArrow,10.9),s.SUtil.ins().toTop(this.mTitle,26.4),s.SUtil.ins().toTop(this.mWhiteBg,28.7))},i.prototype.setCallback=function(a){this.mCloseCallback=a},__decorate([e(cc.Button)],i.prototype,"mCloseButton",void 0),__decorate([e(cc.Sprite)],i.prototype,"mArrow",void 0),__decorate([e(cc.Sprite)],i.prototype,"mTitle",void 0),__decorate([e(cc.Sprite)],i.prototype,"mWhiteBg",void 0),__decorate([e(cc.Label)],i.prototype,"mMenuLabel",void 0),i=__decorate([o],i)}(cc.Component);m.DeskIconInstrucPrefb=n,cc._RF.pop()},{"../../../util/SUtil":"SUtil","./BasicTouchEvent":"BasicTouchEvent"}],DialogManager:[function(l,P,m){"use strict";cc._RF.push(P,"86e47t10b9MDaODdLXMM5BG","DialogManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.mShowCount=0}return s.getIns=function(){return s.sIns||(s.sIns=new s),s.sIns},s.prototype.addSenceDialogListener=function(r,o){},s.prototype.removeSenceDialogListener=function(r,o){},s.prototype.showDialog=function(r){var o=this.getCurrentSceneRootNode(),e=r.getContentNode();o&&e&&(o.addChild(e),this.addShowCount())},s.prototype.dimissDialog=function(r){var o=r.getContentNode();o&&(o.destroy(),this.removeShowCount())},s.prototype.buildSceneKey=function(r){return this.getCurrentSceneName()+"_"+r},s.prototype.getCurrentSceneName=function(){var r=cc.director.getScene();return r?r.name:null},s.prototype.getCurrentSceneRootNode=function(){var r=cc.find("loadingNode");return r||null},s.prototype.addShowCount=function(){this.mShowCount++},s.prototype.removeShowCount=function(){this.mShowCount--},s.prototype.isHasShowingToastPop=function(){return!(this.mShowCount<=0)},s}();m.default=d,cc._RF.pop()},{}],DialogNoButtonPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"27669XXV+VMOokJjdzir10U","DialogNoButtonPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.mTitle=null,i.mContent=null,i.mLoading=null,i.mCloseBtn=null,i.mCloseClickCallback=null,i.mCloseCallback=null,i.mShowLoading=!1,i}return __extends(t,n),t.prototype.onLoad=function(){this.mShowLoading&&(this.mLoadingAnim=this.mLoading.getComponent(cc.Animation),this.mLoadingAnim.play("dialog_loading")),this.initEvents()},t.prototype.initEvents=function(){var i=this;this.node.on(cc.Node.EventType.TOUCH_START,function(a){a.stopPropagation()}),this.mCloseBtn&&(this.mCloseClickCallback=new d.default(function(){i.onClose()}),this.mCloseBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback))},t.prototype.onClose=function(){this.mShowLoading&&this.mLoadingAnim&&this.mLoadingAnim.stop(),this.mCloseCallback&&this.mCloseCallback(this.node)},t.prototype.setTitle=function(i){this.mTitle.string=i},t.prototype.setContent=function(i){this.mContent.string=i},t.prototype.setShowLoading=function(i){this.mLoading.node.active=i,this.mShowLoading=i},t.prototype.setCloseCallback=function(i){this.mCloseCallback=i},t.prototype.setShowClose=function(i){this.mCloseBtn.node.active=i},__decorate([o(cc.Label)],t.prototype,"mTitle",void 0),__decorate([o(cc.RichText)],t.prototype,"mContent",void 0),__decorate([o(cc.Sprite)],t.prototype,"mLoading",void 0),__decorate([o(cc.Button)],t.prototype,"mCloseBtn",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],DialogOneButtonPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"f88e1EhthNOaKQzqcBpm39V","DialogOneButtonPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../keypad/KeypadNavigator"),r=cc._decorator,o=r.ccclass,e=r.property,n=function(t){function i(){var a=t!==null&&t.apply(this,arguments)||this;return a.mTitle=null,a.mContent=null,a.mBotton=null,a.mBtnTxt=null,a.mCloseBtn=null,a.mShowClose=!1,a.mBottonClickCallback=null,a.mCloseClickCallback=null,a.mBottonCallback=null,a.mCloseCallback=null,a}return __extends(i,t),i.prototype.onLoad=function(){this.initEvents(),s.default.getInstance().pushDialog(this.node)},i.prototype.initEvents=function(){var a=this;this.node.on(cc.Node.EventType.TOUCH_START,function(u){u.stopPropagation()}),this.mBotton&&(this.mBottonClickCallback=new d.default(function(){a.onBottomBtnClick(),s.default.getInstance().popDialog(a.node)}),this.mBotton.node.on(cc.Node.EventType.TOUCH_END,this.mBottonClickCallback.click,this.mBottonClickCallback)),this.mCloseBtn.node.active=this.mShowClose,this.mCloseBtn&&this.mShowClose&&(this.mCloseClickCallback=new d.default(function(){a.onCloseBtnClick()}),this.mCloseBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback))},i.prototype.onCloseBtnClick=function(){this.mCloseCallback&&this.mCloseCallback(this.node)},i.prototype.onBottomBtnClick=function(){this.mBottonCallback&&this.mBottonCallback(this.node)},i.prototype.setTitle=function(a){return this.mTitle.string=a,this},i.prototype.setContent=function(a){return this.mContent.string=a,this},i.prototype.setBtnTxt=function(a){return this.mBtnTxt.string=a,this},i.prototype.setBottonCallback=function(a){return this.mBottonCallback=a,this},i.prototype.setShowClose=function(a){return this.mShowClose=a,this},i.prototype.setCloseCallback=function(a){return this.mCloseCallback=a,this},__decorate([e(cc.Label)],i.prototype,"mTitle",void 0),__decorate([e(cc.RichText)],i.prototype,"mContent",void 0),__decorate([e(cc.Button)],i.prototype,"mBotton",void 0),__decorate([e(cc.Label)],i.prototype,"mBtnTxt",void 0),__decorate([e(cc.Button)],i.prototype,"mCloseBtn",void 0),i=__decorate([o],i)}(cc.Component);m.default=n,cc._RF.pop()},{"../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../keypad/KeypadNavigator":"KeypadNavigator"}],DialogRechargePrefab:[function(l,P,m){"use strict";cc._RF.push(P,"1d484+8kFBLNbxDzBjc9tg7","DialogRechargePrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.mTitle=null,i.mContent=null,i.mBotton=null,i.mBtnTxt=null,i.mDiamondIcon=null,i.mDiamondCountTxt=null,i.mGoldIcon=null,i.mGoldCountTxt=null,i.mTickeIcon=null,i.mTickeCountTxt=null,i.mDashIcon=null,i.mDashCountTxt=null,i.mSlowIcon=null,i.mSlowCountTxt=null,i.mShieldIcon=null,i.mShieldCountTxt=null,i.mBottonClickCallback=null,i.mBottonCallback=null,i}return __extends(t,n),t.prototype.onLoad=function(){this.initEvents(),this.initUI()},t.prototype.initEvents=function(){var i=this;this.node.on(cc.Node.EventType.TOUCH_START,function(a){a.stopPropagation()}),this.mBotton&&(this.mBottonClickCallback=new d.default(function(){i.onClose()}),this.mBotton.node.on(cc.Node.EventType.TOUCH_END,this.mBottonClickCallback.click,this.mBottonClickCallback))},t.prototype.initUI=function(){if(0<this.mDashCount)this.mDashIcon.node.active=!0,this.mDashCountTxt.node.active=!0,this.mDashCountTxt.string="x"+this.mDashCount.toString(),this.mGoldIcon.node.active=!1,this.mGoldCountTxt.node.active=!1,this.mDiamondIcon.node.active=!1,this.mDiamondCountTxt.node.active=!1;else if(0<this.mSlowCount)this.mSlowIcon.node.active=!0,this.mSlowCountTxt.node.active=!0,this.mSlowCountTxt.string="x"+this.mSlowCount.toString(),this.mGoldIcon.node.active=!1,this.mGoldCountTxt.node.active=!1,this.mDiamondIcon.node.active=!1,this.mDiamondCountTxt.node.active=!1;else if(0<this.mShieldCount)this.mShieldIcon.node.active=!0,this.mShieldCountTxt.node.active=!0,this.mShieldCountTxt.string="x"+this.mShieldCount.toString(),this.mGoldIcon.node.active=!1,this.mGoldCountTxt.node.active=!1,this.mDiamondIcon.node.active=!1,this.mDiamondCountTxt.node.active=!1;else if(0<this.mTickeCount)this.mTickeIcon.node.active=!0,this.mTickeCountTxt.node.active=!0,this.mGoldIcon.node.active=!1,this.mGoldCountTxt.node.active=!1,this.mDiamondIcon.node.active=!1,this.mDiamondCountTxt.node.active=!1;else if(this.mDiamondCount==0&&this.mGoldCount!=0){var i=this.mGoldIcon.getComponent(cc.Widget);i.isAlignRight=!0,i.right=210;var a=this.mGoldCountTxt.getComponent(cc.Widget);a.isAlignRight=!0,a.right=236.5,this.mDiamondIcon.node.active=!1,this.mDiamondCountTxt.node.active=!1}else if(this.mGoldCount==0&&this.mDiamondCount!=0){var u=this.mDiamondIcon.getComponent(cc.Widget);u.isAlignLeft=!0,u.left=210;var c=this.mDiamondCountTxt.getComponent(cc.Widget);c.isAlignLeft=!0,c.left=236.5,this.mGoldIcon.node.active=!1,this.mGoldCountTxt.node.active=!1}},t.prototype.onClose=function(){this.mBottonCallback&&this.mBottonCallback(this.node)},t.prototype.setTitle=function(i){this.mTitle.string=i},t.prototype.setContent=function(i){this.mContent.string=i},t.prototype.setBtnTxt=function(i){this.mBtnTxt.string=i},t.prototype.setBottonCallback=function(i){this.mBottonCallback=i},t.prototype.setDiamondCount=function(i){this.mDiamondCount=i,this.mDiamondCountTxt.string="x"+i.toString()},t.prototype.setGoldCount=function(i){this.mGoldCount=i,this.mGoldCountTxt.string="x"+i.toString()},t.prototype.setTickeCount=function(i){this.mTickeCount=i,this.mTickeCountTxt.string="x"+i.toString()},t.prototype.setDashCount=function(i){this.mDashCount=i},t.prototype.setShieldCount=function(i){this.mShieldCount=i},t.prototype.setSlowCount=function(i){this.mSlowCount=i},__decorate([o(cc.Label)],t.prototype,"mTitle",void 0),__decorate([o(cc.Label)],t.prototype,"mContent",void 0),__decorate([o(cc.Button)],t.prototype,"mBotton",void 0),__decorate([o(cc.Label)],t.prototype,"mBtnTxt",void 0),__decorate([o(cc.Sprite)],t.prototype,"mDiamondIcon",void 0),__decorate([o(cc.Label)],t.prototype,"mDiamondCountTxt",void 0),__decorate([o(cc.Sprite)],t.prototype,"mGoldIcon",void 0),__decorate([o(cc.Label)],t.prototype,"mGoldCountTxt",void 0),__decorate([o(cc.Sprite)],t.prototype,"mTickeIcon",void 0),__decorate([o(cc.Label)],t.prototype,"mTickeCountTxt",void 0),__decorate([o(cc.Sprite)],t.prototype,"mDashIcon",void 0),__decorate([o(cc.Label)],t.prototype,"mDashCountTxt",void 0),__decorate([o(cc.Sprite)],t.prototype,"mSlowIcon",void 0),__decorate([o(cc.Label)],t.prototype,"mSlowCountTxt",void 0),__decorate([o(cc.Sprite)],t.prototype,"mShieldIcon",void 0),__decorate([o(cc.Label)],t.prototype,"mShieldCountTxt",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],Dialog:[function(l,P,m){"use strict";cc._RF.push(P,"4120dvcrvxLHqKlHnzrE3yV","Dialog"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./DialogManager"),s=function(){function r(o,e){this.mContentNode=null,this.mPrefabPath="0",this.mShowListenCallBack=new Array,this.mDismissCallBack=new Array,this.mPrefabPath=o,this.setOnCreateListener(e)}return r.prototype.setOnCreateListener=function(o){this.mOnCreateFinish=o},r.prototype.getContentNode=function(){return this.mContentNode},r.prototype.onShowListen=function(o){this.mShowListenCallBack.push(o)},r.prototype.onDismissListen=function(o){this.mDismissCallBack.push(o)},r.prototype.show=function(){var o=this;cc.loader.loadRes(this.mPrefabPath,cc.Prefab,function(n,t){o.showPrefab(t)});for(var e=0;e<this.mShowListenCallBack.length;e++)this.mShowListenCallBack[e]()},r.prototype.dismiss=function(){d.default.getIns().dimissDialog(this);for(var o=0;o<this.mDismissCallBack.length;o++)this.mDismissCallBack[o]()},r.prototype.showWithNode=function(o){this.mContentNode=o,this.mOnCreateFinish&&this.mOnCreateFinish(o),d.default.getIns().showDialog(this)},r.prototype.showPrefab=function(o){var e=cc.instantiate(o);this.showWithNode(e)},r}();m.default=s,cc._RF.pop()},{"./DialogManager":"DialogManager"}],DiamondPopupProfab:[function(l,P,m){"use strict";cc._RF.push(P,"c2db9h+pKhA9rCe5eP+GOun","DiamondPopupProfab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Logic/PlayerMgr"),s=l("../UserInfoManager"),r=l("../../../util/SceneMusicMgr"),o=l("../GameEntraScene/BasicTouchEvent"),e=l("../../../infoc/m_p2_PData_Dia"),n=l("../../../infoc/m_p2_pop_coin"),t=l("../../Network/Protocol/StorageUtil"),i=l("../../../config/LSKey"),a=l("../GameEntraScene/ToastPrefab"),u=l("../../Logic/MoneySystem"),c=l("../../../base/Log"),p=l("../../../social/SocialHelper"),h=l("../../shop/DialogNoButtonPrefab"),f=l("../GameEntraScene/PopupDlg"),g=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),_=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),y=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),S=l("../../../util/PU"),I=l("../../Logic/I18nManager"),v=l("../../keypad/KeypadNavigator"),C=cc._decorator,T=C.ccclass,E=C.property,A=function(M){function k(){var L=M!==null&&M.apply(this,arguments)||this;return L.diamond_count_label=null,L.tips_layout=null,L.mContentLayout=null,L.mDestSprite=null,L.mOriginSprite=null,L.mBgLight=null,L.mSlipActive=null,L.mDiamondPanel=null,L.close_btn=null,L.get_free_diamond_btn=null,L.mLoadingBtn=null,L.mVideoBtn=null,L.mVideoCountText=null,L.mCountDownTimerBtn=null,L.mTimerText=null,L.mWatchVideoLayout=null,L.mToastPrefab=null,L.mBottomTipTxt=null,L.mGetTicketBtn=null,L.mDeltaTime=-1,L.mDate=null,L.mIsStartTimer=!1,L.mCloseBtnClickCallback=null,L.mGetFreeEnergyBtnCallback=null,L.mDialogManager=null,L}var D;return __extends(k,M),(D=k).prototype.setCloseCallback=function(L){this.closeCallback=L},k.prototype.setShopClickCallback=function(L){this.shopClickCallback=L},k.prototype.onLoad=function(){this.mContentLayout.getComponent(cc.Animation).play("diamond_pop_out"),d.default.Ins().addUserListener(this),this.node.on(cc.Node.EventType.TOUCH_START,function(L){L.stopPropagation()}),this.mBgLight.node.active=!1,this.mSlipActive.node.active=!1,this.mLoadingBtn.node.active=!1,this.mVideoBtn.node.active=!1,this.mCountDownTimerBtn.node.active=!1,this.initEvent(),this.initADFeature(),this.initDialog(),S.default.isIOS()&&(this.mGetTicketBtn.node.active=!1),v.default.getInstance().pushDialog(this.node)},k.prototype.initEvent=function(){var L=this;this.mCloseBtnClickCallback=new o.default(function(){L.closeBtnClick()}),this.close_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseBtnClickCallback.click,this.mCloseBtnClickCallback),this.mGetFreeEnergyBtnCallback=new o.default(function(){L.getDiamondFreeBtnClick()}),this.get_free_diamond_btn.node.on(cc.Node.EventType.TOUCH_END,this.mGetFreeEnergyBtnCallback.click,this.mGetFreeEnergyBtnCallback);var b=new o.default(function(){L.mLoadingBtnClick()}),N=new o.default(function(){L.mVideoBtnClick()}),H=new o.default(function(){L.mCountDownBtnClick()}),R=new o.default(function(){L.doTicket()});this.mLoadingBtn.node.on(cc.Node.EventType.TOUCH_END,b.click,b),this.mVideoBtn.node.on(cc.Node.EventType.TOUCH_END,N.click,N),this.mCountDownTimerBtn.node.on(cc.Node.EventType.TOUCH_END,H.click,H),this.mGetTicketBtn.node.on(cc.Node.EventType.TOUCH_END,R.click,R)},k.prototype.initADFeature=function(){p.SocialHelper.onShowListen(this.onWxShow),S.default.isWeiXin()||_.MGAdv.load(y.ADScene.GET_DIAMOND_POPUP,y.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),_.MGAdv.isADFeatureEnable()&&(this.mWatchVideoLayout.node.active=!0,this.mContentLayout.node.height=635,this.startGetServerTime(),this.mBottomTipTxt.string=I.default.getInstance().getLanguageByKey("label_text.watch_video_invite_tips"))},k.prototype.onWxShow=function(L){c.default.isDebug();try{this.startGetServerTime()}catch(b){}},k.prototype.startGetServerTime=function(){var L=this;this.mLoadingBtn.node.active=!0,this.getSeverTimestamp(),this.mLoadingTimerHandle=setInterval(function(){c.default.isDebug(),L.mServerDayStr||L.getSeverTimestamp()},3e3)},k.prototype.getSeverTimestamp=function(){var L=this;g.MGUser.getCurrentServerRealTime({success:function(b){L.mServerTimestamp=b,clearInterval(L.mLoadingTimerHandle),L.mLoadingBtn.node.active=!1;var N=new Date(L.mServerTimestamp),H=N.getMonth(),R=N.getDate();L.mServerDayStr=N.getFullYear().toString()+"-"+(H<9?"0"+H:""+H)+"-"+(R<10?"0"+R:""+R);var F=t.default.read(i.default.HOME_WATCH_VIDEO_REMAINING_TIMES_THE_DAY);if(c.default.isDebug(),F){var x=F.split(D.SEPERATE_CHAR);L.mCacheDayStr=x[0],L.mServerDayStr==L.mCacheDayStr?L.mCacheVideoCount=parseInt(x[1]):L.mCacheVideoCount=D.DEFAULT_VIDEO_COUNT}else L.mCacheDayStr="",L.mCacheVideoCount=D.DEFAULT_VIDEO_COUNT;c.default.isDebug(),L.updateVideoBtnState()}})},k.prototype.updateVideoBtnState=function(){if(0<this.mCacheVideoCount)this.mVideoBtn.node.active=!0,this.mCountDownTimerBtn.node.active=!1,this.mVideoCountText.string=I.default.getInstance().getLanguageByKey("label_text.free")+"("+this.mCacheVideoCount.toString()+")";else{this.mDate=new Date(this.mServerTimestamp),this.mDate.setHours(23,59,59,999);var L=this.mDate.getTime();this.mDate.setHours(0,0,0,0);var b=this.mDate.getTime();this.mDeltaTime=b+L-this.mServerTimestamp,this.updateCountDownTimerText(this.mDeltaTime),this.mVideoBtn.node.active=!1,this.mCountDownTimerBtn.node.active=!0,this.mIsStartTimer=!0,v.default.getInstance().refreshPage(this.node)}},k.prototype.updateCountDownTimerText=function(L){this.mDate.setTime(L);var b,N,H,R=this.mDate.getHours(),F=this.mDate.getMinutes(),x=this.mDate.getSeconds();b=R<10?"0"+R:R.toString(),N=F<10?"0"+F:F.toString(),H=x<10?"0"+x:x.toString(),this.mTimerText.string=b+":"+N+":"+H},k.prototype.stopAllTimer=function(){clearInterval(this.mLoadingTimerHandle),this.mIsStartTimer=!1},k.prototype.showToastTips=function(L,b){try{var N=cc.instantiate(this.mToastPrefab);N.getComponent(a.default).showTips(L,function(){N.destroy(),b&&b()}),this.tips_layout.node.addChild(N)}catch(H){}},k.prototype.start=function(){},k.prototype.update=function(L){if(this.mIsStartTimer){if(this.mDeltaTime-=1e3*L,this.mDeltaTime<=0)return this.mIsStartTimer=!1,void this.startGetServerTime();this.updateCountDownTimerText(this.mDeltaTime)}},k.prototype.onDestroy=function(){this.stopAllTimer(),p.SocialHelper.offShowListen(this.onWxShow),this.mServerDayStr=null,d.default.Ins().removeUserListener(this),r.default.stop(r.default.NAME_BUY_DIAMOND),v.default.getInstance().popDialog(this.node)},k.prototype.onChange=function(L,b,N,H,R){this.diamond_count_label.string=""+N},k.prototype.closeBtnClick=function(){n.default.report(n.default.SCENE_GET_DIAMOND_DIALOG,this.mSource,n.default.ACTION_CLICK_DIALOG_CLOSE_BTN),this.closeCallback&&this.closeCallback(),this.stopAllTimer()},k.prototype.updateDimondCountLabel=function(){this.diamond_count_label.string=s.User.UserInfoManager.getUserInfo().diamond+""},k.prototype.mLoadingBtnClick=function(){I.default.getInstance().getLanguageByKey("label_text.netnotok"),n.default.report(n.default.SCENE_GET_DIAMOND_DIALOG,this.mSource,n.default.ACTION_CLICK_LOADING_BTN)},k.prototype.mVideoBtnClick=function(){var L=this;if(n.default.report(n.default.SCENE_GET_DIAMOND_DIALOG,this.mSource,n.default.ACTION_CLICK_WATCH_VIDEO),_.MGAdv.isADCached(y.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)){var b=y.ADScene.GET_DIAMOND_POPUP;_.MGAdv.show(b,y.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(H){switch(H){case y.ADStat.NOT_NETWORK:var R=I.default.getInstance().getLanguageByKey("label_text.netnotok");L.showToastTips(R);break;case y.ADStat.SHOW_SUCCESS_CLOSE:L.increaseDiamond();break;case y.ADStat.SHOW_NOT_ENED_CLOSE:break;case y.ADStat.SHOW_GET_AD_FAILED:L.showToastTips("No video ads available")}})}else{var N=I.default.getInstance().getLanguageByKey("label_text.noadrevivefree");this.showToastTips(N),S.default.isWeiXin()||_.MGAdv.load(y.ADScene.GET_DIAMOND_POPUP,y.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)}},k.prototype.increaseDiamond=function(){var L=this;this.mCacheVideoCount-=1;var b=this.mServerDayStr+D.SEPERATE_CHAR+this.mCacheVideoCount;t.default.save(i.default.HOME_WATCH_VIDEO_REMAINING_TIMES_THE_DAY,b),c.default.isDebug(),e.default.report(2,e.default.SOURCE_HOME_WATCH_VIDEO_GET_DIAMOND,e.default.ACTION_GET_DIAMOND),setTimeout(function(){u.MoneySystem.increaseDiamond(2),L.mBgLight.node.active=!0,L.mSlipActive.node.active=!0,L.mDestSprite.node.active=!1,r.default.play(r.default.NAME_BUY_DIAMOND,r.default.PATH_BUY_DIAMOND,!1),L.scheduleOnce(function(){L.playBuyDiamondAnim(L.mOriginSprite)},.1),L.scheduleOnce(function(){L.playBuyDiamondAnim(L.mOriginSprite,function(){L.updateDimondCountLabel(),L.mDestSprite.node.active=!0,L.mBgLight.node.active=!1,L.mSlipActive.node.active=!1,L.startGetServerTime()})},.2)},500)},k.prototype.mCountDownBtnClick=function(){I.default.getInstance().isEnglish()?this.showToastTips("No chance left today. Come back tomorrow"):this.showToastTips("\u770B\u89C6\u9891\u83B7\u94BB\u77F3\u6B21\u6570\u5DF2\u7528\u5B8C\uFF0C\u8BF7\u660E\u65E5\u518D\u6765"),n.default.report(n.default.SCENE_GET_DIAMOND_DIALOG,this.mSource,n.default.ACTION_CLICK_COUNT_FULL_BTN)},k.prototype.doTicket=function(){n.default.report(n.default.SCENE_GET_DIAMOND_DIALOG,this.mSource,n.default.ACTION_CLICK_SHOP_BTN),S.default.isIOS()?this.showIOSNotSupportDialog():this.shopClickCallback&&this.shopClickCallback()},k.prototype.initDialog=function(){this.mDialogManager=new f.PopupDlg,this.mDialogManager.setParentLayout(this.tips_layout.node)},k.prototype.showIOSNotSupportDialog=function(){var L=this;this.mDialogManager.showPopupDlgDynamic("prefab/shop/DialogNoButtonPrefab",function(b){if(cc.isValid(L,!0)&&b){var N=b.getComponent(h.default);N.setCloseCallback(function(){L.mDialogManager.dismissDialog(b)}),N.setShowLoading(!1);var H=I.default.getInstance().getLanguageByKey("label_text.shop_tip2");N.setContent("<color=#3B5D72>"+H+"</c>")}})},k.prototype.getDiamondFreeBtnClick=function(){},k.prototype.playBuyDiamondAnim=function(L,b){var N=new cc.Node;N.width=56,N.height=56;var H=L.node.parent.convertToWorldSpaceAR(L.node.getPosition()),R=this.node.convertToNodeSpaceAR(H);N.setPosition(R),N.addComponent(cc.Sprite).spriteFrame=L.spriteFrame;var F=this.mBgLight.node.parent.convertToWorldSpaceAR(this.mBgLight.node.getPosition()),x=this.node.convertToNodeSpaceAR(F);this.node.addChild(N);var U=x.x-N.x,B=x.y-N.y,Q=[cc.p(x.x-.3*U,x.y-.8*B),cc.p(x.x-0*U,x.y-.3*B),cc.p(x.x,x.y)],Z=cc.bezierTo(.2,Q),z=cc.fadeTo(.01,0),W=cc.sequence(Z,z,cc.callFunc(function(){b&&b()}));N.runAction(W)},k.prototype.setSource=function(L){this.mSource=L},k.prototype.getSource=function(){return this.mSource},k.DEFAULT_VIDEO_COUNT=6,k.SEPERATE_CHAR="#",__decorate([E(cc.Label)],k.prototype,"diamond_count_label",void 0),__decorate([E(cc.Layout)],k.prototype,"tips_layout",void 0),__decorate([E(cc.Layout)],k.prototype,"mContentLayout",void 0),__decorate([E(cc.Sprite)],k.prototype,"mDestSprite",void 0),__decorate([E(cc.Sprite)],k.prototype,"mOriginSprite",void 0),__decorate([E(cc.Sprite)],k.prototype,"mBgLight",void 0),__decorate([E(cc.Sprite)],k.prototype,"mSlipActive",void 0),__decorate([E(cc.Node)],k.prototype,"mDiamondPanel",void 0),__decorate([E(cc.Button)],k.prototype,"close_btn",void 0),__decorate([E(cc.Button)],k.prototype,"get_free_diamond_btn",void 0),__decorate([E(cc.Button)],k.prototype,"mLoadingBtn",void 0),__decorate([E(cc.Button)],k.prototype,"mVideoBtn",void 0),__decorate([E(cc.Label)],k.prototype,"mVideoCountText",void 0),__decorate([E(cc.Button)],k.prototype,"mCountDownTimerBtn",void 0),__decorate([E(cc.Label)],k.prototype,"mTimerText",void 0),__decorate([E(cc.Layout)],k.prototype,"mWatchVideoLayout",void 0),__decorate([E(cc.Prefab)],k.prototype,"mToastPrefab",void 0),__decorate([E(cc.Label)],k.prototype,"mBottomTipTxt",void 0),__decorate([E(cc.Button)],k.prototype,"mGetTicketBtn",void 0),k=D=__decorate([T],k)}(cc.Component);m.default=A,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../../infoc/m_p2_pop_coin":"m_p2_pop_coin","../../../social/SocialHelper":"SocialHelper","../../../util/PU":"PU","../../../util/SceneMusicMgr":"SceneMusicMgr","../../Logic/I18nManager":"I18nManager","../../Logic/MoneySystem":"MoneySystem","../../Logic/PlayerMgr":"PlayerMgr","../../Network/Protocol/StorageUtil":"StorageUtil","../../keypad/KeypadNavigator":"KeypadNavigator","../../shop/DialogNoButtonPrefab":"DialogNoButtonPrefab","../GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../GameEntraScene/PopupDlg":"PopupDlg","../GameEntraScene/ToastPrefab":"ToastPrefab","../UserInfoManager":"UserInfoManager"}],Dictionary:[function(l,P,m){"use strict";cc._RF.push(P,"6e639CjovxLYoD7cLm0N09H","Dictionary"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(o,e){this.key=null,this.value=null,this.key=o,this.value=e};m.Pair=d;var s=function(){function o(){this.arr=[]}return o.prototype.put=function(e,n){for(var t=0;t<this.arr.length;t++)if(this.arr[t].key===e)return void(this.arr[t].value=n);this.arr.push(new d(e,n))},o.prototype.get=function(e){for(var n=0;n<this.arr.length;n++)if(this.arr[n].key===e)return this.arr[n].value;return null},o.prototype.remove=function(e){for(var n=0;n<this.arr.length;n++)if(this.arr[n].key===e)return void this.arr.splice(n,1)},o.prototype.clear=function(){this.arr=[]},o.prototype.size=function(){return this.arr.length},o.prototype.getPairs=function(){return this.arr},o}();m.Dictionary=s;var r=function(){function o(e){e===void 0&&(e=null),this.arr=[],this.cmp=e||function(n,t){return n===t}}return o.prototype.copy=function(e){this.clear();for(var n=0,t=e.arr.length;n<t;++n){var i=e.arr[n];this.put(i.key,i.value)}},o.prototype.put=function(e,n){for(var t=0;t<this.arr.length;t++)if(this.cmp(this.arr[t].key,e)===0)return void(this.arr[t].value=n);this.arr.push(new d(e,n))},o.prototype.get=function(e){for(var n=0;n<this.arr.length;n++)if(this.cmp(this.arr[n].key,e)===0)return this.arr[n].value;return null},o.prototype.remove=function(e){for(var n=0;n<this.arr.length;n++)if(this.cmp(this.arr[n].key,e)===0)return void this.arr.splice(n,1)},o.prototype.clear=function(){this.arr=[]},o.prototype.size=function(){return this.arr.length},o.prototype.getPairs=function(){return this.arr},o}();m.Dictionary2=r,cc._RF.pop()},{}],DownLoadingPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"0d570iQc5xEKKaNXrWua/pR","DownLoadingPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../Logic/EventBus"),r=l("../Logic/NotifyEvent"),o=cc._decorator,e=o.ccclass,n=o.property,t=function(i){function a(){var u=i!==null&&i.apply(this,arguments)||this;return u.download_label=null,u.cancel_btn=null,u.progressbar=null,u.mLoadingTips=null,u.mCancelClickCallback=null,u}return __extends(a,i),a.prototype.setCancelCallback=function(u){this.cancelCallback=u},a.prototype.setLoadingTips=function(u){this.mLoadingTips=u},a.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(u){u.stopPropagation()}),this.initEvent(),s.default.register(r.default.LOADING_DOWNLOAD,this.downloading,this)},a.prototype.downloading=function(u,c){c&&2<=c.length&&c[1]!=null&&0<=c[1]&&c[1]<=1&&(this.progressbar.progress=c[1],this.download_label.string=(this.mLoadingTips==null?"\u6B63\u5728\u52A0\u8F7D\u76AE\u80A4\u6587\u4EF6...":this.mLoadingTips)+Math.round(100*c[1])+"%")},a.prototype.onDestroy=function(){s.default.remove(r.default.LOADING_DOWNLOAD,this.downloading,this)},a.prototype.initEvent=function(){var u=this;this.mCancelClickCallback=new d.default(function(){u.cancelClick()}),this.cancel_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCancelClickCallback.click,this.mCancelClickCallback)},a.prototype.cancelClick=function(){this.cancelCallback&&this.cancelCallback()},a.prototype.start=function(){this.getComponent(cc.Animation).play("dowanloading_popup")},__decorate([n(cc.Label)],a.prototype,"download_label",void 0),__decorate([n(cc.Button)],a.prototype,"cancel_btn",void 0),__decorate([n(cc.ProgressBar)],a.prototype,"progressbar",void 0),a=__decorate([e],a)}(cc.Component);m.default=t,cc._RF.pop()},{"../Logic/EventBus":"EventBus","../Logic/NotifyEvent":"NotifyEvent","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],Downloader:[function(l,P,m){"use strict";cc._RF.push(P,"ce601WAAUtMtKsC/1LVkesf","Downloader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/Log"),s=l("../LogicPlatform/PlatformProxy"),r=l("../util/PU"),o=function(){function e(){this.mDownloadInfo=new Object,this.mDownloadTask=new Object,this.mUICancel=new Object}return e.Ins=function(){return e._instance==null&&(e._instance=new e),e._instance},e.prototype.download=function(n,t,i){var a=this;if(t===void 0&&(t=3),n==null||n==null)return new Promise(function(c,p){c()});var u=n.getUniqueKey();return new Promise(function(c,p){a.doUpdateLoop(u,n,t,function(h){delete a.mUICancel[u],delete a.mDownloadInfo[u],delete a.mDownloadTask[u],c(h)},function(){d.default.w("\u4E0B\u8F7D\u5931\u8D25\u3002\u3002\u3002\u3002",n),delete a.mUICancel[u],delete a.mDownloadInfo[u],delete a.mDownloadTask[u],p()},i)})},e.prototype.cancelDownload=function(n){var t=n.getUniqueKey();if(d.default.i("\u5F00\u59CB\u53D6\u6D88\u4E0B\u8F7D\uFF1A"+t),this.mUICancel[t]="cancel",t in this.mDownloadTask){var i=this.mDownloadTask[t];i&&(i.abort(),d.default.i("\u53D6\u6D88\u4E0B\u8F7D\uFF1A"+t))}},e.prototype.doUpdateLoop=function(n,t,i,a,u,c){var p=this,h=i;if(Number.isNaN(h)&&(h=3),n in this.mUICancel)return d.default.i("UI \u53D6\u6D881\u3002\u3002\u3002\u3002"+n),void u();this.updateAsync(n,t,0,h,function(f){a(f)},function(){p.loopSongRejectCallback(n,t,0,h,a,u,c)},c)},e.prototype.loopSongRejectCallback=function(n,t,i,a,u,c,p){if(n in this.mUICancel)return d.default.i("UI \u53D6\u6D882\u3002\u3002\u3002\u3002"+n),void c();a<++i?(d.default.l(e.TAG+"loopSongRejectCallback reach max retry times."),c()):this.updateAsync(n,t,i,a,u,c,p)},e.prototype.isUICanceled=function(n){return n in this.mUICancel},e.prototype.updateAsync=function(n,t,i,a,u,c,p){var h=this,f=this.downloadFile(t.url,t.size,!1,t.md5,function(g){h.isUICanceled(n)?c():s.default.Ins().getFileSystemManager().getFileInfo({filePath:g,success:function(_){var y=_.size,S=!1;r.default.isQQ()&&(t.size!=y&&t.size!=y-1||(S=!0)),d.default.w("after getfileinfo: size="+y+" /target_size="+t.size+" skipUnZip="+p),y==t.size||S?p?u(g):s.default.Ins().unZip(g,"",function(){u()},function(){d.default.i("unzip failed "+t.getUniqueKey()),c()}):c()},fail:function(_){d.default.i("getFileInfo, error: ",_),c()}})},function(){c()});this.mDownloadTask[n]=f},e.prototype.downloadFile=function(n,t,i,a,u,c){return i===void 0&&(i=!1),a===void 0&&(a=""),s.default.Ins().downloadFile(n,function(p){u(p)},function(){c()},t,!0)},e.prototype.unZipFile=function(n){return new Promise(function(t,i){n?s.default.Ins().unZip(n,"",function(){d.default.i("unzip success  "+n),console.warn("--- unZipFile success ---"),t()},function(){d.default.i("unzip failed "+n),console.warn("--- unZipFile failed ---"),i()}):t()})},e._instance=null,e.TAG="ResDownloader  => ",e}();m.default=o,cc._RF.pop()},{"../LogicPlatform/PlatformProxy":"PlatformProxy","../base/Log":"Log","../util/PU":"PU"}],EMap:[function(l,P,m){"use strict";cc._RF.push(P,"23f21WqzFtPSoR3yz3+u8dZ","EMap"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Enumerator"),s=l("./KeyValuePair"),r=function(){function o(){this._keys=[],this._values=[]}return Object.defineProperty(o.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),o.prototype.set=function(e,n){var t=this._keys,i=t.indexOf(e);return i===-1&&(t[i=t.length]=e),this._values[i]=n,this},o.prototype.get=function(e){var n=this._keys.indexOf(e);return n!==-1?this._values[n]:void 0},o.prototype.has=function(e){return this._keys.indexOf(e)!==-1},o.prototype.delete=function(e){var n=this._keys.indexOf(e);return n!==-1&&(this._keys.splice(n,1),this._values.splice(n,1),!0)},o.prototype.clear=function(){this._keys.length=0,this._values.length=0},o.prototype.getEnumerator=function(){var e=this.entries();return new d.Enumerator(e)},o.prototype.forEach=function(e,n){for(var t=this._keys,i=this._values,a=0,u=t.length;a<u;a++)e.call(n,new s.KeyValuePair(t[a],i[a]),this)},o.prototype.keys=function(){return this._keys.concat()},o.prototype.values=function(){return this._values.concat()},o.prototype.entries=function(){var e=new Array;return this.forEach(function(n,t){e.push(new s.KeyValuePair(n.key,n.value))}),e},o.prototype.toString=function(){var e=Object.create(null);return this.forEach(function(n,t){e[n.key]=n.value}),JSON.stringify(e)},o}();m.Map=r,cc._RF.pop()},{"./Enumerator":"Enumerator","./KeyValuePair":"KeyValuePair"}],EasyReport:[function(l,P,m){"use strict";cc._RF.push(P,"8a474ACdaZN8Iaipcafw5UH","EasyReport"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o){var e=s.call(this)||this;return e.data=new Object,e.tabId=o,e}return __extends(r,s),r.prototype.getTableID=function(){return this.tabId},r.prototype.add=function(o,e){return this.data[o]=e,this},r.prototype.report=function(){try{for(var o in this.data)s.prototype.set.call(this,o,this.data[o]);this.reportData()}catch(e){console.warn("report "+this.tabId+" failed. e = "+e)}},r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],EconomyPlugin:[function(l,P,m){"use strict";cc._RF.push(P,"df28exrAtNM8Z8MRPnRY2Zi","EconomyPlugin"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./IPlugin"),s=l("../LevelMgr"),r=l("../Level"),o=l("../../DB/DBMgr"),e=l("../PlayerMgr"),n=function(t){function i(){var a=t.call(this)||this;return a.m_bSale=!1,a.m_saleTime=0,a.m_CurGainDiamond=0,a}return __extends(i,t),i.prototype.getKind=function(){return d.default.Plugin_Economy},i.prototype.increaseGold=function(a){if(!a)return 0;var u=0,c=s.LevelMgr.Ins().getLevel(a.mId);if(c){var p=c.music;switch(c.type){case r.eLevelKind.eLevel_Normal:case r.eLevelKind.eLevel_Gold:case r.eLevelKind.eLevel_Choiceness:if(a.mIsFirstBlood){var h=s.LevelMgr.Ins().getClearanceAward(a.mId).getAward(1);h&&(u+=h.gold)}u+=this.gainGoldByIncrease(p.musicLevel,a.mScore,!1)}}return u!=0&&this.gainGold(u,"CEconomyPlugin::IncreaseGold"),u},i.prototype.gainGoldByIncrease=function(a,u,c){var p=o.default.Ins().getDBRow(o.eDataBase.eDB_gold,a+""),h=0,f=0,g=0;return p&&(c?(h=Math.floor(u*p.getPvpGold1()),f=p.getPvpMaxGold()):(h=Math.floor(u*p.getGold()),f=p.getMaxGold()),g=f<h?f:h),g},i.prototype.gainGold=function(a,u){this.saveGold(a)},i.prototype.getFactor=function(a){switch(a){case 1:return 1.1;case 2:return 1.2;case 3:return 1.3;case 4:return 1.5;case 5:return 1.7;case 6:return 1.9;case 7:return 2.1;case 8:return 2.4;case 9:return 2.7;case 10:return 3;default:return 0}},i.prototype.upperLimitGold=function(a,u){switch(a){case 1:return u?12:5;case 2:return u?14:6;case 3:return u?17:7;case 4:return u?20:8;case 5:return u?22:9;case 6:return u?24:10;case 7:return u?26:11;case 8:return u?28:12;case 9:return u?31:13;case 10:return u?36:15;default:return 0}},i.prototype.lowLimitScore=function(a){return a?40:100},i.prototype.saveGold=function(a){var u=e.default.Ins(),c=u.getUserCoin();c=0<(c+=a)?c:0,u.setUserCoin(c)},i.prototype.getCurGold=function(){return e.default.Ins().getUserCoin()},i.prototype.getCurDiamond=function(){return e.default.Ins().getUserDiamond()},i.prototype.gainDiamond=function(a){this.m_CurGainDiamond=a,this.saveDiamond(a)},i.prototype.addDiamond=function(a){this.m_CurGainDiamond=a;var u=e.default.Ins(),c=u.getUserDiamond();c=0<(c+=a)?c:0,u.setUserDiamond(c)},i.prototype.costDiamond=function(a){return a<=this.getCurDiamond()&&(this.gainDiamond(-a),!0)},i.prototype.saveDiamond=function(a){var u=e.default.Ins(),c=u.getUserDiamond();c=0<(c+=a)?c:0,u.setUserDiamond(c)},i}(d.default);m.default=n,cc._RF.pop()},{"../../DB/DBMgr":"DBMgr","../Level":"Level","../LevelMgr":"LevelMgr","../PlayerMgr":"PlayerMgr","./IPlugin":"IPlugin"}],EffectData:[function(l,P,m){"use strict";cc._RF.push(P,"d5f06BSj09M2ZPxBlvXwyIg","EffectData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("Id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.EffectData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("Id")},e.prototype.getEffectId=function(){return this.getString("effectId")},e.prototype.getValue=function(){return this.getFloat("value")},e.prototype.getisPercent=function(){return this.getInt("isPercent")==1},e.prototype.getDesc=function(){return this.getString("desc")},e}(d.default);m.EffectRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],Emitter:[function(l,P,m){"use strict";cc._RF.push(P,"23d6bV9y4pGnbZm2Nuq1CNa","Emitter"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function r(){this.listeners={}}return r.prototype.register=function(o,e,n){this.listeners[o]||(this.listeners[o]=[]),this.listeners[o].push(new s(e,n))},r.prototype.remove=function(o,e,n){var t=this.listeners[o];if(t){for(var i=t.length,a=0;a<i;a++)if(t[a].compar(n)){t.splice(a,1);break}t.length==0&&delete this.listeners[o]}},r.prototype.fire=function(o){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var t=this.listeners[o];if(t)for(var i=t.length,a=0;a<i;a++){var u=t[a];u&&u.notify.apply(u,[o].concat(e))}},r}();m.Emitter=d;var s=function(){function r(o,e){this.callback=null,this.context=null,this.callback=o,this.context=e}return r.prototype.notify=function(){for(var o,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.callback&&(o=this.callback).call.apply(o,[this.context].concat(e))},r.prototype.compar=function(o){return o==this.context},r}();cc._RF.pop()},{}],EmptyPagePrefab:[function(l,P,m){"use strict";cc._RF.push(P,"d5b775VrGRFvbsAMbW+r1ed","EmptyPagePrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../util/SingleWorker"),s=l("./MainpageBaseComponent"),r=cc._decorator,o=r.ccclass,e=r.property,n=function(t){function i(){var a=t!==null&&t.apply(this,arguments)||this;return a.mLoadingSprite=null,a.isCreated=!1,a}return __extends(i,t),i.prototype.onload=function(){},i.prototype.playLoadAnim=function(){this.mLoadingSprite.node.active=!0;var a=this.getComponent(cc.Animation);a&&a.play("skin_loading")},i.prototype.loadFinish=function(){var a=this.getComponent(cc.Animation);a&&a.stop(),this.mLoadingSprite.node.active=!1},i.prototype.loadUI=function(){var a=this,u=this;if(!u.isCreated){u.playLoadAnim();var c="empty-page-loadui-"+u.mItem.getType();d.default.doWork(c,function(){return u.mItem.buildContent()},function(p,h){cc.isValid(u,!0)&&h&&(u.isCreated=!0,u.loadFinish(),a.mNode=h,u.node.addChild(h))})}},i.prototype.onShow=function(){this.loadUI()},i.prototype.release=function(){if(this.mNode){var a=this.mNode.getComponent(s.default);a&&a.destroy(),this.mNode.removeFromParent(!0)}this.isCreated=!1},i.prototype.setData=function(a){this.mItem=a},__decorate([e(cc.Sprite)],i.prototype,"mLoadingSprite",void 0),i=__decorate([o],i)}(cc.Component);m.default=n,cc._RF.pop()},{"../../../../util/SingleWorker":"SingleWorker","./MainpageBaseComponent":"MainpageBaseComponent"}],EnergyBuyDialogItem:[function(l,P,m){"use strict";cc._RF.push(P,"03020P/rq5AB7Tj/XTgX+bv","EnergyBuyDialogItem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../GameEntraScene/BasicTouchEvent"),s=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),r=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),o=l("../../../util/PU"),e=cc._decorator,n=e.ccclass,t=e.property,i=function(a){function u(){var c=a!==null&&a.apply(this,arguments)||this;return c.mGetFreeEnergyBtnClickCallback=null,c.mGetEnergy2BtnClickCallback=null,c}return __extends(u,a),u.prototype.setFreeCallback=function(c){this.mFreeGetCallback=c},u.prototype.setBuyCallback=function(c){this.mBuyEnergyCallback=c},u.prototype.onLoad=function(){this.initViews(),this.initEvents()},u.prototype.setType=function(c){this.mType=c},u.prototype.initEvents=function(){var c=this;this.mGetFreeEnergyBtnClickCallback=new d.default(function(){c.mFreeGetCallback&&c.mFreeGetCallback()}),this.mFreeBtn.node.on(cc.Node.EventType.TOUCH_END,this.mGetFreeEnergyBtnClickCallback.click,this.mGetFreeEnergyBtnClickCallback),this.mGetEnergy2BtnClickCallback=new d.default(function(){c.mBuyEnergyCallback&&c.mBuyEnergyCallback()}),this.mBuyBtn.node.on(cc.Node.EventType.TOUCH_END,this.mGetEnergy2BtnClickCallback.click,this.mGetEnergy2BtnClickCallback)},u.prototype.getIcon=function(){return this.mType==0?this.mHeartIcon1:this.mType==1?this.mHeartIcon1:this.mType==2?this.mHeartIcon2:this.mType==3?this.mHeartIcon3:void 0},u.prototype.initViews=function(){switch(this.mType){case 0:this.mHeartIcon1.node.active=!0,this.mHeartIcon2.node.active=!1,this.mHeartIcon3.node.active=!1,this.mHeartCount.string="x 2",o.default.isWeiXin()||s.MGAdv.load(r.ADScene.GET_ENERGY_POPUP,r.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),s.MGAdv.isADFeatureEnable()?(this.mFreeBtn.node.active=!0,this.mBuyBtn.node.active=!1):(this.mFreeBtn.node.active=!1,this.mBuyBtn.node.active=!0),this.mExpenseLabel.string="x 100";break;case 1:this.mHeartIcon1.node.active=!0,this.mHeartIcon2.node.active=!1,this.mHeartIcon3.node.active=!1,this.mHeartCount.string="x 5",this.mFreeBtn.node.active=!1,this.mExpenseLabel.string="x 220";break;case 2:this.mHeartIcon1.node.active=!0,this.mHeartIcon2.node.active=!0,this.mHeartIcon3.node.active=!1,this.mHeartCount.string="x 10",this.mFreeBtn.node.active=!1,this.mExpenseLabel.string="x 430";break;case 3:this.mHeartIcon1.node.active=!0,this.mHeartIcon2.node.active=!0,this.mHeartIcon3.node.active=!0,this.mHeartCount.string="x 20",this.mFreeBtn.node.active=!1,this.mExpenseLabel.string="x 850"}},__decorate([t(cc.Sprite)],u.prototype,"mHeartIcon1",void 0),__decorate([t(cc.Sprite)],u.prototype,"mHeartIcon2",void 0),__decorate([t(cc.Sprite)],u.prototype,"mHeartIcon3",void 0),__decorate([t(cc.Label)],u.prototype,"mHeartCount",void 0),__decorate([t(cc.Button)],u.prototype,"mFreeBtn",void 0),__decorate([t(cc.Button)],u.prototype,"mBuyBtn",void 0),__decorate([t(cc.Label)],u.prototype,"mExpenseLabel",void 0),u=__decorate([n],u)}(cc.Component);m.default=i,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../util/PU":"PU","../GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],EnergyPlugin:[function(l,P,m){"use strict";cc._RF.push(P,"1fbcbtF2YBCZIJfbjsmYFtC","EnergyPlugin"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../PlayerMgr"),s=l("../../Network/Protocol/UserUtil"),r=l("./IPlugin"),o=l("../../DB/DBMgr"),e=l("../EventBus"),n=l("../NotifyEvent"),t=l("../MoneySystem"),i=function(a){function u(){var c=a.call(this)||this;c.mMaxEnergy=10,c.mUserRecoverySp=1e3,c.mRecovery=!1,c.reset();var p=s.default.getCurSysTime();return c.mLastRecovery>p&&(c.mLastRecovery=p),c}return __extends(u,a),u.prototype.getKind=function(){return r.default.Plugin_Energy},u.prototype.updateSelf=function(){var c=o.default.Ins().getDBRow(o.eDataBase.eDB_Life,this.mUserLevel+""),p=10;if(!c)for(var h=1;;){var f=o.default.Ins().getDBRow(o.eDataBase.eDB_Life,h+"");if(!f)break;c=f,h++}if(c&&(this.mMaxEnergy=c.getLife(),p=c.getLife(),this.mUserRecoverySp=c.getLifeRecovery()),this.mCurrentEnergy<0){this.mCurrentEnergy=p;var g=d.default.Ins();g.setHP(this.mCurrentEnergy);var _=s.default.getCurSysTime();this.mLastRecovery=_,g.setLastRecovery(this.mLastRecovery)}},u.prototype.update=function(c){if(!(this.mCurrentEnergy<this.mMaxEnergy))return this.mRecovery=!1,void e.default.fire(n.default.HP_REVIVE,0);this.mRecovery||(this.startRecovery(),this.mRecovery=!0);var p=s.default.getCurSysTime();p<this.mLastRecovery&&(this.mLastRecovery=p),Math.max(this.mUserRecoverySp-(p-this.mLastRecovery)%this.mUserRecoverySp,0);var h=(p-this.mLastRecovery)%this.mUserRecoverySp,f=parseInt(this.mUserRecoverySp-(p-this.mLastRecovery)+"");e.default.fire(n.default.HP_REVIVE,f);var g=(p-this.mLastRecovery)/this.mUserRecoverySp;1<=g&&(this.increaseEnergy(g),this.startRecovery(h))},u.prototype.increaseEnergy=function(c){this.mCurrentEnergy>this.mMaxEnergy||(this.mCurrentEnergy=Math.min(this.mCurrentEnergy+c,this.mMaxEnergy),this.mCurrentEnergy=parseInt(""+this.mCurrentEnergy),d.default.Ins().setHP(this.mCurrentEnergy))},u.prototype.addEnergy=function(c){this.mCurrentEnergy=this.mCurrentEnergy+c,d.default.Ins().setHP(this.mCurrentEnergy)},u.prototype.startRecovery=function(c){(c==null||c==null||Number.isNaN(c)||Number.isNaN(c))&&(c=0);var p=s.default.getCurSysTime();p<this.mLastRecovery||(this.mLastRecovery=p-c,d.default.Ins().setLastRecovery(this.mLastRecovery))},u.prototype.decreaseEnergy=function(c){return t.MoneySystem.getHpCount()<=1||(c=parseInt(""+c))>this.mCurrentEnergy||(this.mCurrentEnergy=Math.max(this.mCurrentEnergy-c,0),d.default.Ins().setHP(this.mCurrentEnergy)),!1},u.prototype.onLevelChanged=function(c){var p=this.mUserLevel;if(this.mUserLevel=c,this.updateSelf(),p<c&&this.mCurrentEnergy<this.mMaxEnergy)for(var h=p;h<=c;h++){var f=o.default.Ins().getDBRow(o.eDataBase.eDB_Lv,h-1+"");f&&this.increaseEnergy(f.getRewarLife())}},u.prototype.getCurrentEnergy=function(){return this.mCurrentEnergy},u.prototype.getMaxEnergy=function(){return this.mMaxEnergy},u.prototype.reset=function(){var c=d.default.Ins();this.mUserLevel=c.getUserLevel(),this.mCurrentEnergy=c.getHP(),this.mLastRecovery=c.getLastRecovery(),this.mRecovery=!1,this.updateSelf(),this.mCurrentEnergy<this.mMaxEnergy&&(this.mRecovery=!0)},u.prototype.isCurEnergyEnough=function(){return 1<=this.mCurrentEnergy},u}(r.default);m.default=i,cc._RF.pop()},{"../../DB/DBMgr":"DBMgr","../../Network/Protocol/UserUtil":"UserUtil","../EventBus":"EventBus","../MoneySystem":"MoneySystem","../NotifyEvent":"NotifyEvent","../PlayerMgr":"PlayerMgr","./IPlugin":"IPlugin"}],EnergyPopupProfab:[function(l,P,m){"use strict";cc._RF.push(P,"55604jiRBhN14E4Eb/TPQMM","EnergyPopupProfab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Logic/PlayerMgr"),s=l("../../../util/TimeUtil"),r=l("../UserInfoManager"),o=l("../../../util/SceneMusicMgr"),e=l("../GameEntraScene/BasicTouchEvent"),n=l("../../../infoc/m_p2_pop_coin"),t=l("../GameEntraScene/ToastPrefab"),i=l("./EnergyBuyDialogItem"),a=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),u=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),c=l("../GameEntraScene/PrefabMgr"),p=l("../../../util/PU"),h=l("../../Logic/I18nManager"),f=l("../../keypad/KeypadNavigator"),g=cc._decorator,_=g.ccclass,y=g.property,S=function(I){function v(){var C=I!==null&&I.apply(this,arguments)||this;return C.energy_count_label=null,C.auto_time_label=null,C.time_bg=null,C.tips_layout=null,C.toastPrefab=null,C.mBgLight=null,C.mSlipActive=null,C.mTopDestEnergySprite=null,C.mContentLayout=null,C.close_btn=null,C.mCloseBtnClickCallback=null,C}return __extends(v,I),v.prototype.setCloseCallback=function(C){this.closeCallback=C},v.prototype.setToGoldPopupPrefab=function(C){this.mToGoldPopupPrefab=C},v.prototype.onLoad=function(){this.mContentLayout.getComponent(cc.Animation).play("energy_pop_out"),d.default.Ins().addUserListener(this),r.User.UserInfoManager.registerHpReviveListener(this.hpCallback,this),this.node.on(cc.Node.EventType.TOUCH_START,function(C){C.stopPropagation()}),this.mBgLight.node.active=!1,this.mSlipActive.node.active=!1,this.initEvent(),this.initItem(),this.initADFeature(),f.default.getInstance().pushDialog(this.node)},v.prototype.initItem=function(){var C=this;c.default.load("prefab/EnergyBuyDialogItem",function(T,E){if(E){var A=cc.instantiate(E),M=A.getComponent(i.default);M.setType(0),M.setBuyCallback(function(){C.getEnergy2BtnClick(M.getIcon())}),M.setFreeCallback(function(){C.getEnergyFreeBtnClick(M.getIcon())}),A.getChildByName("get_energy_free_btn").name="1_free_btn",A.getChildByName("get_energy_20_btn").name="1_buy_btn",C.mItemNode_1.addChild(A);var k=cc.instantiate(E),D=k.getComponent(i.default);D.setType(1),D.setBuyCallback(function(){C.getEnergy5BtnClick(D.getIcon())}),k.getChildByName("get_energy_free_btn").name="2_free_btn",k.getChildByName("get_energy_20_btn").name="2_buy_btn",C.mItemNode_2.addChild(k);var L=cc.instantiate(E),b=L.getComponent(i.default);b.setType(2),b.setBuyCallback(function(){C.getEnergy10BtnClick(b.getIcon())}),L.getChildByName("get_energy_free_btn").name="3_free_btn",L.getChildByName("get_energy_20_btn").name="3_buy_btn",C.mItemNode_3.addChild(L);var N=cc.instantiate(E),H=N.getComponent(i.default);H.setType(3),H.setBuyCallback(function(){C.getEnergy20BtnClick(H.getIcon())}),N.getChildByName("get_energy_free_btn").name="4_free_btn",N.getChildByName("get_energy_20_btn").name="4_buy_btn",C.mItemNode_4.addChild(N)}},!1)},v.prototype.initADFeature=function(){p.default.isWeiXin()||a.MGAdv.load(u.ADScene.GET_ENERGY_POPUP,u.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)},v.prototype.initEvent=function(){var C=this;this.mCloseBtnClickCallback=new e.default(function(){C.closeBtnClick()}),this.close_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseBtnClickCallback.click,this.mCloseBtnClickCallback)},v.prototype.start=function(){r.User.UserInfoManager.isAutoReviveHp()?(this.auto_time_label.node.active=!0,this.time_bg.node.active=!0):(this.auto_time_label.node.active=!1,this.time_bg.node.active=!1)},v.prototype.onDestroy=function(){d.default.Ins().removeUserListener(this),r.User.UserInfoManager.unRegisterHpReviveListener(this.hpCallback,this),o.default.stop(o.default.NAME_BUY_LIFE),f.default.getInstance().popDialog(this.node)},v.prototype.hpCallback=function(C,T){T<=0?(this.auto_time_label.node.active=!1,this.time_bg.node.active=!1):(this.auto_time_label.string=h.default.getInstance().getLanguageByKey("label_text.time")+s.default.convertSecondToMinutesSecond(T),this.auto_time_label.node.active=!0,this.time_bg.node.active=!0)},v.prototype.onChange=function(C,T,E,A,M){this.energy_count_label.string=""+C},v.prototype.closeBtnClick=function(){this.reportPopWindowCoin(-1),this.closeCallback&&this.closeCallback()},v.prototype.setEnergyLabel=function(){this.energy_count_label.string=r.User.UserInfoManager.getUserInfo().hp+""},v.prototype.getEnergy2BtnClick=function(C){this.getEnergyBtnClick(C,100)},v.prototype.getEnergyFreeBtnClick=function(C){var T=this;if(console.log("lllll getEnergyFreeBtnClick"),a.MGAdv.isADCached(u.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)){var E=u.ADScene.GET_ENERGY_POPUP;console.log("lllll MGAdv.show"),a.MGAdv.show(E,u.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(M){switch(console.log("lllll MGAdv.show2"),M){case u.ADStat.NOT_NETWORK:var k=h.default.getInstance().getLanguageByKey("label_text.netnotok");T.showToastTips(k);break;case u.ADStat.SHOW_SUCCESS_CLOSE:setTimeout(function(){T.getEnergyBtnClick(C,0)},500);break;case u.ADStat.SHOW_NOT_ENED_CLOSE:break;case u.ADStat.SHOW_GET_AD_FAILED:T.showToastTips("No video ads available")}})}else{var A=h.default.getInstance().getLanguageByKey("label_text.noadrevivefree");this.showToastTips(A),p.default.isWeiXin()||a.MGAdv.load(u.ADScene.GET_ENERGY_POPUP,u.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)}},v.prototype.getEnergyBtnClick=function(C,T){var E=this;this.reportPopWindowCoin(T==100?2:0),r.User.UserInfoManager.buyHpByCoin(T)?(this.mBgLight.node.active=!0,this.mSlipActive.node.active=!0,this.mTopDestEnergySprite.node.active=!1,o.default.play(o.default.NAME_BUY_LIFE,o.default.PATH_BUY_LIFE,!1),this.scheduleOnce(function(){E.playBuyGoldSuccessAnim(C,function(){E.setEnergyLabel(),E.mBgLight.node.active=!1,E.mSlipActive.node.active=!1,E.mTopDestEnergySprite.node.active=!0})},0)):(this.toGoldPopupPrefab(),console.log("getEnergyBtnClick  false"))},v.prototype.reportPopWindowCoin=function(C){C==0?n.default.report(n.default.SCENE_GET_ENERGY_DIALOG,this.mSource,n.default.ACTION_CLICK_GET_ENERGY_VIDEO_GOLD):C==2?n.default.report(n.default.SCENE_GET_ENERGY_DIALOG,this.mSource,n.default.ACTION_CLICK_GET_ENERGY_100_GOLD):C==5?n.default.report(n.default.SCENE_GET_ENERGY_DIALOG,this.mSource,n.default.ACTION_CLICK_GET_ENERGY_220_GOLD):C==10?n.default.report(n.default.SCENE_GET_ENERGY_DIALOG,this.mSource,n.default.ACTION_CLICK_GET_ENERGY_430_GOLD):C==20?n.default.report(n.default.SCENE_GET_ENERGY_DIALOG,this.mSource,n.default.ACTION_CLICK_GET_ENERGY_850_GOLD):C==-1&&n.default.report(n.default.SCENE_GET_ENERGY_DIALOG,this.mSource,n.default.ACTION_CLICK_DIALOG_CLOSE_BTN)},v.prototype.getEnergy5BtnClick=function(C){var T=this;this.reportPopWindowCoin(5),r.User.UserInfoManager.buyHpByCoin(220)?(this.mBgLight.node.active=!0,this.mSlipActive.node.active=!0,this.mTopDestEnergySprite.node.active=!1,o.default.play(o.default.NAME_BUY_LIFE,o.default.PATH_BUY_LIFE,!1),this.scheduleOnce(function(){T.playBuyGoldSuccessAnim(C)},.1),this.scheduleOnce(function(){T.playBuyGoldSuccessAnim(C)},.2),this.scheduleOnce(function(){T.playBuyGoldSuccessAnim(C,function(){T.setEnergyLabel(),T.mBgLight.node.active=!1,T.mSlipActive.node.active=!1,T.mTopDestEnergySprite.node.active=!0})},.3),console.log("getEnergy5BtnClick  true")):(this.toGoldPopupPrefab(),console.log("getEnergy5BtnClick  false"))},v.prototype.getEnergy10BtnClick=function(C){var T=this;if(this.reportPopWindowCoin(10),r.User.UserInfoManager.buyHpByCoin(430)){this.mBgLight.node.active=!0,this.mSlipActive.node.active=!0,this.mTopDestEnergySprite.node.active=!1,o.default.play(o.default.NAME_BUY_LIFE,o.default.PATH_BUY_LIFE,!1);for(var E=1;E<5;E++)this.scheduleOnce(function(){T.playBuyGoldSuccessAnim(C)},.1*E);this.scheduleOnce(function(){T.playBuyGoldSuccessAnim(C,function(){T.setEnergyLabel(),T.mBgLight.node.active=!1,T.mSlipActive.node.active=!1,T.mTopDestEnergySprite.node.active=!0})},.5)}else this.toGoldPopupPrefab()},v.prototype.getEnergy20BtnClick=function(C){var T=this;if(this.reportPopWindowCoin(20),r.User.UserInfoManager.buyHpByCoin(850)){this.mBgLight.node.active=!0,this.mSlipActive.node.active=!0,this.mTopDestEnergySprite.node.active=!1,o.default.play(o.default.NAME_BUY_LIFE,o.default.PATH_BUY_LIFE,!1);for(var E=1;E<10;E++)this.scheduleOnce(function(){T.playBuyGoldSuccessAnim(C)},.1*E);this.scheduleOnce(function(){T.playBuyGoldSuccessAnim(C,function(){T.setEnergyLabel(),T.mBgLight.node.active=!1,T.mSlipActive.node.active=!1,T.mTopDestEnergySprite.node.active=!0})},1)}else this.toGoldPopupPrefab()},v.prototype.toGoldPopupPrefab=function(){this.mToGoldPopupPrefab&&this.mToGoldPopupPrefab()},v.prototype.playBuyGoldSuccessAnim=function(C,T){var E=new cc.Node;E.width=56,E.height=56;var A=C.node.parent.convertToWorldSpaceAR(C.node.getPosition()),M=this.node.convertToNodeSpaceAR(A);E.setPosition(M),E.addComponent(cc.Sprite).spriteFrame=C.spriteFrame;var k=this.mBgLight.node.parent.convertToWorldSpaceAR(this.mBgLight.node.getPosition()),D=this.node.convertToNodeSpaceAR(k);this.node.addChild(E);var L=D.x-E.x,b=D.y-E.y,N=[cc.p(D.x-.3*L,D.y-.8*b),cc.p(D.x-0*L,D.y-.3*b),cc.p(D.x,D.y)],H=cc.bezierTo(.2,N),R=cc.fadeTo(.01,0),F=cc.sequence(H,R,cc.callFunc(function(){T&&T()}));E.runAction(F)},v.prototype.setSource=function(C){this.mSource=C},v.prototype.getSource=function(){return this.mSource},v.prototype.showToastTips=function(C,T){var E=cc.instantiate(this.toastPrefab);E.getComponent(t.default).showTips(C,function(){E.destroy(),T&&T()}),this.tips_layout.node.addChild(E)},__decorate([y(cc.Label)],v.prototype,"energy_count_label",void 0),__decorate([y(cc.Label)],v.prototype,"auto_time_label",void 0),__decorate([y(cc.Sprite)],v.prototype,"time_bg",void 0),__decorate([y(cc.Layout)],v.prototype,"tips_layout",void 0),__decorate([y(cc.Prefab)],v.prototype,"toastPrefab",void 0),__decorate([y(cc.Sprite)],v.prototype,"mBgLight",void 0),__decorate([y(cc.Sprite)],v.prototype,"mSlipActive",void 0),__decorate([y(cc.Sprite)],v.prototype,"mTopDestEnergySprite",void 0),__decorate([y(cc.Layout)],v.prototype,"mContentLayout",void 0),__decorate([y(cc.Button)],v.prototype,"close_btn",void 0),__decorate([y(cc.Node)],v.prototype,"mItemNode_1",void 0),__decorate([y(cc.Node)],v.prototype,"mItemNode_2",void 0),__decorate([y(cc.Node)],v.prototype,"mItemNode_3",void 0),__decorate([y(cc.Node)],v.prototype,"mItemNode_4",void 0),v=__decorate([_],v)}(cc.Component);m.default=S,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../infoc/m_p2_pop_coin":"m_p2_pop_coin","../../../util/PU":"PU","../../../util/SceneMusicMgr":"SceneMusicMgr","../../../util/TimeUtil":"TimeUtil","../../Logic/I18nManager":"I18nManager","../../Logic/PlayerMgr":"PlayerMgr","../../keypad/KeypadNavigator":"KeypadNavigator","../GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../GameEntraScene/PrefabMgr":"PrefabMgr","../GameEntraScene/ToastPrefab":"ToastPrefab","../UserInfoManager":"UserInfoManager","./EnergyBuyDialogItem":"EnergyBuyDialogItem"}],EnumEntry:[function(l,P,m){"use strict";cc._RF.push(P,"9f92e0ADcxMkakPJvT6OJSB","EnumEntry"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s,r,o,e){this.name=s,this.value=r,this.alias=o||"",this.description=e||""};m.EnumEntry=d,cc._RF.pop()},{}],EnumUtils:[function(l,P,m){"use strict";cc._RF.push(P,"d4884Hz5fpGNL9i6KzwX0sl","EnumUtils"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./EnumEntry"),s=l("../runtime/ClassType"),r=function(){function o(){}return o.getEntry=function(e,n){if(n){var t=this.getEntries(n).filter(function(i){return i.value===e});return t.length===1?t[0]:null}},o.getEntries=function(e){if(e){if(this._entryCache.has(e))return this._entryCache.get(e);for(var n=s.Type.getMetadata(e)||{},t=new Array,i=0,a=this.getFields(e);i<a.length;i++){var u=a[i],c=u[0],p=u[1],h=n[c],f=h?h.alias:"",g=h?h.description:"";t.push(new d.EnumEntry(c,p,f,g))}return 0<t.length&&this._entryCache.set(e,t),t}},o.getFields=function(e){if(e)return Object.keys(e).map(function(n){return[n,e[n]]}).filter(function(n){n[0];var t=n[1];return s.Type.isNumber(t)})},o._entryCache=new Map,o}();m.EnumUtils=r,cc._RF.pop()},{"../runtime/ClassType":"ClassType","./EnumEntry":"EnumEntry"}],Enumerator:[function(l,P,m){"use strict";cc._RF.push(P,"02f7bsJ31hIfZugb9FpvVSL","Enumerator"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r){r||console.log("--- no arguments---"),this._index=0,this._current=void 0,this._items=r}return Object.defineProperty(s.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),s.prototype.next=function(){var r=this._items;return this._index<r.length&&(this._current=r[this._index++],!0)},s}();m.Enumerator=d,cc._RF.pop()},{}],EventBus:[function(l,P,m){"use strict";cc._RF.push(P,"1386em4yqBBtoBmXvc87ZaR","EventBus"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Emitter"),s=function(){function o(){this.mCount=0,this.mEmitter=new d.Emitter}return o.prototype.register=function(e,n,t){this.mEmitter.register(e,n,t),this.mCount+=1},o.prototype.remove=function(e,n,t){this.mEmitter.remove(e,n,t),0<this.mCount&&(this.mCount-=1)},o.prototype.fire=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];this.mEmitter.fire(e,n)},o}(),r=function(){function o(){}return o.register=function(e,n,t){this.ins.register(e,n,t)},o.remove=function(e,n,t){this.ins.remove(e,n,t)},o.fire=function(e){for(var n,t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];(n=this.ins).fire.apply(n,[e].concat(t))},o.ins=new s,o}();m.default=r,cc._RF.pop()},{"../../util/Emitter":"Emitter"}],EvilLongBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"18c3970/NZN4p0iiBqtqgj+","EvilLongBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./LongBlockNode"),s=l("../loader/GameSceneFrameLoader"),r=l("../../MUI/MUISprite"),o=l("../../../base/G"),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createLayers=function(){n.prototype.createLayers.call(this);for(var i=this.getAllChildren(),a=0,u=i.length;a<u;a++)i[a].setOpacity(.4*i[a].getOpacity());var c=s.default.getInstance().getAtlas(),p=c.getItem("black");if(p){var h=p.rect.width,f=p.rect.height,g=new r.default;g.imageData=c,g.imageItem=p,g.move((this.mBlock.rect.width-h)/2,(o.G.Ap.config.mBaseBlockHeight-f)/2,h,f),this.addChild(g)}},t}(d.default);m.EvilLongBlockNode=e,cc._RF.pop()},{"../../../base/G":"G","../../MUI/MUISprite":"MUISprite","../loader/GameSceneFrameLoader":"GameSceneFrameLoader","./LongBlockNode":"LongBlockNode"}],EvilShortBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"c9380DlTjFIZ5Ormwm11inZ","EvilShortBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/GameSceneFrameLoader"),s=l("../../MUI/MUISprite"),r=l("../../../base/G"),o=l("./BlockNode"),e=l("../loader/BlockSkinFrameLoader"),n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createLayers=function(){t.prototype.createLayers.call(this);var a=e.default.getInstance().getShortBlockBackground(),u=new s.default;u.imageData=e.default.getInstance().getAtlas(),u.imageItem=a,u.move(0,0,this.mBlock.rect.width,this.mBlock.rect.height),u.setOpacity(.4),this.addChild(u);var c=d.default.getInstance().getAtlas(),p=c.getItem("black");if(p){var h=p.rect.width,f=p.rect.height,g=new s.default;g.imageData=c,g.imageItem=p,g.move((this.mBlock.rect.width-h)/2,(r.G.Ap.config.mBaseBlockHeight-f)/2,h,f),this.addChild(g)}},i}(o.default);m.EvilShortBlockNode=n,cc._RF.pop()},{"../../../base/G":"G","../../MUI/MUISprite":"MUISprite","../loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","../loader/GameSceneFrameLoader":"GameSceneFrameLoader","./BlockNode":"BlockNode"}],ExclusiveSkinGameScene:[function(l,P,m){"use strict";cc._RF.push(P,"cd7b2wKwz1FT71zIq11GngT","ExclusiveSkinGameScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameScene"),s=l("../base/G"),r=l("../business/Logic/LangMgr"),o=l("./element/loader/GameSceneFrameLoader"),e=l("./element/loader/BlockSkinFrameLoader"),n=function(t){function i(a,u){return t.call(this,a,u)||this}return __extends(i,t),i.prototype.initilize=function(){if(this.effectiveSkin=s.G.Ap.skinMgr.getTrialSkinItem(),this.effectiveSkin||(this.effectiveSkin=s.G.Ap.skinMgr.getCurrentSkinItem()),this.atlasGameObject=o.default.getInstance().getAtlas(),this.effectiveSkin){var a=this.effectiveSkin.getSkinObject(),u=a.skinRaw.getBlockAtlasName();e.default.getInstance().setAtlas(a.atlasMap[u]),s.G.Ap.config.longBlockDotAnimEnable=a.skinRaw.getDesign().longBlockDotAnimaion}},i.prototype.allowProperty=function(){return!0},i.prototype.updateUI=function(){if(this.effectiveSkin){var a=r.default.gIns().getLanguageByKey(this.music.getName()),u=cc.js.formatStr("\u6B63\u5728\u8BD5\u73A9\u300A%s\u300B\u76AE\u80A4",this.effectiveSkin.getProperty().displayName);this.banner.show(a,u)}},i}(d.default);m.default=n,cc._RF.pop()},{"../base/G":"G","../business/Logic/LangMgr":"LangMgr","./GameScene":"GameScene","./element/loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./element/loader/GameSceneFrameLoader":"GameSceneFrameLoader"}],ExpData:[function(l,P,m){"use strict";cc._RF.push(P,"2f891kjxl1AyreqKM6OSmEO","ExpData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findExpByLevel=function(n){return this.find("Lv",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.default=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getLv=function(){return this.getInt("Lv")},e.prototype.getScore=function(){return this.getFloat("Score")},e.prototype.getMaxScore=function(){return this.getInt("MaxScore")},e.prototype.getPvpMaxScore=function(){return this.getInt("PvpMaxScore")},e}(d.default);m.ExpRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],ExpPlugin:[function(l,P,m){"use strict";cc._RF.push(P,"c3927m4RNhFq70CDkFnH9IN","ExpPlugin"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../PlayerMgr"),s=l("../../DB/DBMgr"),r=l("./PluginMgr"),o=l("../../Network/Protocol/UserUtil"),e=l("./IPlugin"),n=l("../LevelMgr"),t=l("../Level"),i=function(a){function u(){var c=a.call(this)||this;return c.mNeedBroadCast=!1,c.mUserCorn=0,c.mNPlayerMaxLv=26,c.reset(),c}return __extends(u,a),u.prototype.getKind=function(){return e.default.Plugin_Exp},u.prototype.reset=function(){for(var c=!0;c;){this.mNPlayerMaxLv++;var p=s.default.Ins().getDBRow(s.eDataBase.eDB_Lv,this.mNPlayerMaxLv+"");p&&p.getExp()==-1&&(c=!1)}var h=d.default.Ins();h.getUserLevel()>this.mNPlayerMaxLv?this.mUserLevel=this.mNPlayerMaxLv:this.mUserLevel=h.getUserLevel(),this.mExp=h.getUserCurrentExp(),this.mBeforeExp=this.mExp,this.mBeforeLevel=this.mUserLevel;var f=s.default.Ins().getDBRow(s.eDataBase.eDB_Lv,this.mUserLevel+"");this.mNextExp=f?f.getExp():-1,this.mNotifyUI=!1,this.judgeExpEx(),this.mExp>this.mUserLevel*u.MAX_RATIO&&this.mNextExp!=-1&&this.judgeExp()},u.prototype.judgeExp=function(){var c=this.mExp;this.mBeforeLevel=this.mUserLevel;var p=d.default.Ins(),h=!1;if(this.mNextExp!=-1){for(;c>=this.mNextExp&&this.mNextExp!=-1;){this.mUserLevel+=1,p.setUserLevel(this.mUserLevel),c-=this.mNextExp;var f=s.default.Ins().getDBRow(s.eDataBase.eDB_Lv,this.mUserLevel+"");this.mNextExp=f?f.getExp():-1,h=!0}if(h)return this.setExp(c),r.default.Ins().notifyLevelChanged(this.mUserLevel),this.mNeedBroadCast=!0,this.mCurrentTime=o.default.getCurSysTime(),h}return this.mExp>this.mUserLevel*u.MAX_RATIO&&this.mNextExp!=-1&&(this.mUserLevel+=1,p.setUserLevel(this.mUserLevel),c-=this.mNextExp,f=s.default.Ins().getDBRow(s.eDataBase.eDB_Lv,this.mUserLevel+""),this.mNextExp=f?f.getExp():-1,this.setExp(c),r.default.Ins().notifyLevelChanged(this.mUserLevel),this.mNeedBroadCast=!0,this.mCurrentTime=o.default.getCurSysTime(),h=!0),h},u.prototype.judgeExpEx=function(){for(var c=0,p=this.mNextExp,h=this.mExp;p<=h&&p!=-1;){if(1<++c)return this.mBeforeExp=this.mNextExp,this.mExp=this.mNextExp,d.default.Ins().setUserCurrentExp(this.mExp),!0;h-=p;var f=s.default.Ins().getDBRow(s.eDataBase.eDB_Lv,c+"");p=f?f.getExp():-1}return!1},u.prototype.setExp=function(c){this.mBeforeExp=this.mExp,this.mExp=c,d.default.Ins().setUserCurrentExp(this.mExp)},u.prototype.judgeUpdateVersion=function(){var c=this.mExp;if(this.mBeforeLevel=this.mUserLevel,this.mNextExp==-1)return!1;for(var p=!1;c>=this.mNextExp&&this.mNextExp!=-1;){this.mUserLevel+=1,d.default.Ins().setUserLevel(this.mUserLevel),c-=this.mNextExp;var h=s.default.Ins().getDBRow(s.eDataBase.eDB_Lv,this.mUserLevel+"");this.mNextExp=h?h.getExp():-1,p=!0;break}return c=0,!!p&&(r.default.Ins().notifyLevelChanged(this.mUserLevel),this.setExp(c),this.mNotifyUI=!0,this.mNeedBroadCast=!0,this.mCurrentTime=o.default.getCurSysTime(),this.mCurrentTime+=3,!0)},u.prototype.notifyUI=function(){},u.prototype.isNeedAnim=function(){return this.mNeedAnim},u.prototype.resetAnmin=function(){this.mNeedAnim=!1},u.prototype.getBeforeLevel=function(){return this.mBeforeLevel},u.prototype.update=function(c){this.mNeedBroadCast&&o.default.getCurSysTime()-this.mCurrentTime>u.INTERVAR&&(this.mNeedBroadCast=!1,this.mNotifyUI&&(this.mNotifyUI=!1,this.notifyUI()))},u.prototype.getCurrentLevel=function(){return this.mUserLevel},u.prototype.setCurrentLevel=function(c){this.mUserLevel=c},u.prototype.getExp=function(){return this.mExp},u.prototype.getNextLevelExp=function(){return this.mNextExp==-1?this.mExp:this.mNextExp},u.prototype.increaseEx2=function(c){return this.setExp(this.mExp+c),this.judgeExp()},u.prototype.increaseEx=function(c){var p=this.getCanIncreaseEX(c);return this.setExp(this.mExp+p),this.judgeExp()},u.prototype.updateVersion=function(){this.judgeUpdateVersion()},u.prototype.getPlayerMaxLv=function(){return this.mNPlayerMaxLv},u.prototype.getCanIncreaseEX=function(c){var p=0,h=n.LevelMgr.Ins().getLevel(c.mId);if(h){var f=h.music;switch(h.type){case t.eLevelKind.eLevel_Normal:case t.eLevelKind.eLevel_Gold:case t.eLevelKind.eLevel_Popular:case t.eLevelKind.eLevel_Choiceness:p+=this.calculate(f.musicLevel,c.mScore,c.mStar,!1);var g,_=n.LevelMgr.Ins().getClearanceAward(c.mId);c.mIsFirstBlood&&(g=_.getAward(1))&&(p+=g.exp),c.mIsFirstSecond&&(g=_.getAward(2))&&(p+=g.exp),c.mIsFirstPassed&&(g=_.getAward(3))&&(p+=g.exp)}}return p},u.prototype.calculate=function(c,p,h,f){var g=1,_=0,y=0,S=s.default.Ins().getDBRow(s.eDataBase.eDB_Exp,c+"");S&&(_=p*S.getScore(),g=(y=f?S.getPvpMaxScore():S.getMaxScore())<_?y:_);var I=Math.floor(g+.5);return I<=0&&(I=1),I},u.INTERVAR=1,u.MAX_EXP=99999999,u.MAX_RATIO=780,u}(e.default);m.default=i,cc._RF.pop()},{"../../DB/DBMgr":"DBMgr","../../Network/Protocol/UserUtil":"UserUtil","../Level":"Level","../LevelMgr":"LevelMgr","../PlayerMgr":"PlayerMgr","./IPlugin":"IPlugin","./PluginMgr":"PluginMgr"}],FBHelper:[function(l,P,m){"use strict";cc._RF.push(P,"097c0DxTSRKrJq8G0o7tQKN","FBHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.getID=function(){return FBInstant.player?FBInstant.player.getID():""},s.getNickName=function(){return FBInstant.player?FBInstant.player.getName():""},s.getPhoto=function(){return FBInstant.player?FBInstant.player.getPhoto():""},s.getEntryPointData=function(){return FBInstant.getEntryPointData()},s}();m.FBHelper=d,cc._RF.pop()},{}],FPSProcess:[function(l,P,m){"use strict";cc._RF.push(P,"1afe0lsEepKGIF9u0/iy+jY","FPSProcess"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/G"),s=function(){function r(o){this.counter=o}return r.prototype.process=function(o){if(o<=.02)return d.G.Ap.config.gameFrameInterval;if(10<this.counter.getDuration()){var e=this.counter.getFPS();return 55<e?d.G.Ap.config.gameFrameInterval:50<e?r.INTERVAL_1:45<e?r.INTERVAL0:40<e?r.INTERVAL1:35<e?r.INTERVAL2:30<e?r.INTERVAL2_5:25<e?r.INTERVAL3:20<e?r.INTERVAL3_5:o}return d.G.Ap.config.gameFrameInterval},r.INTERVAL_1=.018,r.INTERVAL0=.02,r.INTERVAL1=.022,r.INTERVAL2=.025,r.INTERVAL2_5=.028,r.INTERVAL3=.033,r.INTERVAL3_5=.04,r.INTERVAL4=.05,r.INTERVAL5=.1,r.INTERVAL6=.2,r}();m.default=s,cc._RF.pop()},{"../../base/G":"G"}],FightFriendTimesTask:[function(l,P,m){"use strict";cc._RF.push(P,"b658fWEKmJNb6XvvRTsE1Me","FightFriendTimesTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],FightRuleData:[function(l,P,m){"use strict";cc._RF.push(P,"03d8466dwdFQZ5RV6kt1VDT","FightRuleData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.FightRuleData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.getDesc=function(){return this.getString("desc")},e}(d.default);m.FightRuleDataRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],FightUsePropTimesTask:[function(l,P,m){"use strict";cc._RF.push(P,"0d76cykNy1IpL6Ub/L88AXo","FightUsePropTimesTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],FightWinCountTask:[function(l,P,m){"use strict";cc._RF.push(P,"a3a81S/Mh5MF4vQeKtb1HDd","FightWinCountTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],FirstSongGuideGameScene:[function(l,P,m){"use strict";cc._RF.push(P,"aaa56XRVPxPFbo2U7ZbAs7v","FirstSongGuideGameScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameScene"),s=l("./ctrl/GameStageGuide"),r=l("../base/G"),o=l("../util/Utility"),e=l("./ctrl/GameStageMoney"),n=l("./ctrl/GameStageMusic"),t=l("./MUI/MUINode"),i=l("./GameSceneSetting"),a=l("../business/task/newguidance/NewGuidancePrefab"),u=l("../business/gameover/ReliveFreeDialogTipDialog"),c=l("../business/Logic/LevelMgr"),p=l("./view/GameStageNodeView"),h=l("../business/UI/GameEntraScene/PrefabMgr"),f=l("../business/UI/UserInfoBtnManager"),g=l("../business/Logic/I18nManager"),_=function(y){function S(I,v){var C=y.call(this,I,v)||this;return C.guideStage=null,C.handScript=null,i.default.getInstance().setNeedShowGuideInResultPage(!0),C}return __extends(S,y),S.prototype.onLoad=function(){y.prototype.onLoad.call(this),this.stageStates[o.Utility.GAMESTAGE.GUIDE]=new d.StageState(!1)},S.prototype.start=function(){y.prototype.start.call(this),this.renderSwitch.enableCocosRender(),this.renderSwitch.disableCocosTouch(),this.renderSwitch.enableTouchHandler()},S.prototype.initGame=function(){if(this.music){if(this.getGameRegion(),this.levelRecord==null||this.levelRecord.mBestStar<3){var I=c.LevelMgr.Ins().getRewardGold(this.level.id),v=this.getGameNode(),C=new p.default(v.getChildByTag(o.Utility.GAMESTAGE.MONEY));this.moneyStage=new e.default(this,C,I.gold,I.goldline),this.moneyStage.init(),this.moneyStage.activeNode(!1)}var T=this.getGameNode(),E=new p.default(T.getChildByTag(o.Utility.GAMESTAGE.GUIDE));this.guideStage=new s.default(this,E,this),this.guideStage.init(152),this.guideStage.activeNode(!0);var A=new p.default(T.getChildByTag(o.Utility.GAMESTAGE.MUSIC));this.firstStage=new n.default(this,A),this.infiniteStage=this.firstStage,this.currentStage=this.guideStage,this.startGameStageSwitch(o.Utility.GAMESTAGE.GUIDE)}},S.prototype.createUI=function(){y.prototype.createUI.call(this);var I=new t.default;I.move(0,0,this.gameSceneSize.width,this.gameSceneSize.height),this.blockRegionNode.addChild(I,o.Utility.GAMESTAGE.GUIDE)},S.prototype.doLoading=function(){y.prototype.doLoading.call(this);var I=g.default.getInstance().getLanguageByKey("label_text.new_guide_theme");this.banner.show(I,"")},S.prototype.startRun=function(){y.prototype.startRun.call(this),this.endGuide()},S.prototype.finishGameStage=function(I){I===o.Utility.GAMESTAGE.GUIDE?(this.stageStates[I].finish=!0,this.startGameStageSwitch(o.Utility.GAMESTAGE.MUSIC)):y.prototype.finishGameStage.call(this,I)},S.prototype.startGameStageSwitch=function(I){I===o.Utility.GAMESTAGE.MUSIC?(r.G.Ap.state.enterGameStage(I),this.guideStage.setRunning(!1),this.guideStage.activeNode(!1),this.firstStage.init(152),this.firstStage.activeNode(!0),this.currentStage=this.firstStage,this.updateUI(),this.banner.setVisible(!0),r.G.Ap.state.pause(),this.guideFinish()):y.prototype.startGameStageSwitch.call(this,I)},S.prototype.attainScore=function(I){r.G.Ap.state.getGameStage()!==o.Utility.GAMESTAGE.GUIDE&&y.prototype.attainScore.call(this,I)},S.prototype.pauseGame=function(){r.G.Ap.state.getGameStage()===o.Utility.GAMESTAGE.GUIDE?r.G.Ap.state.pause():y.prototype.pauseGame.call(this)},S.prototype.resumeGame=function(){r.G.Ap.state.getGameStage()===o.Utility.GAMESTAGE.GUIDE?r.G.Ap.state.resume():y.prototype.resumeGame.call(this)},S.prototype.showReliveDialog=function(){return y.prototype.showReliveDialog.call(this)},S.prototype.reliveGame=function(I){y.prototype.reliveGame.call(this,I)},S.prototype.hideBanner=function(){this.banner.hide()},S.prototype.shortBlockGuide=function(I,v){},S.prototype.longBlockBeginGuide=function(I,v){if(this.handScript){var C=I.x+Math.floor(I.width/2),T=r.G.Ap.config.presentHeight-(I.y+v+150),E="\u957F\u5757\u51FA\u73B0\uFF0C\u6309\u4F4F\u5343\u4E07\u522B\u677E\u5F00\u54E6\uFF01";g.default.getInstance().isEnglish()&&(E="Press the long tile and hold down"),this.handScript.setDataFroGameScene(E,!1,a.CircleColor.YELLOW,a.TipPos.DOWN,new cc.Vec2(C,T))}},S.prototype.longBlockGuide=function(I,v){this.handScript&&this.handScript.setDataFroGameScene(null,!1,a.CircleColor.YELLOW,a.TipPos.DOWN,null)},S.prototype.longBlockEndGuide=function(I,v){if(this.handScript){var C="\u957F\u5757\u7ED3\u675F\uFF0C\u5E72\u7684\u6F02\u4EAE\uFF01\u677E\u5F00\u624B\u6307\u5427\u3002";g.default.getInstance().isEnglish()&&(C="The end of the long block, beautiful! \nRelease your finger."),this.handScript.setDataFroGameScene(C,!1,a.CircleColor.YELLOW,a.TipPos.DOWN,null)}},S.prototype.guideFinish=function(){var I=this;this.showGuide(!1),h.default.load("prefab/newtarget/FirstFailTipDialog",function(v,C){if(!v&&C){var T=C.getComponent(u.default);T.setType(u.DIALOG_TYPE.CONTRA),T.setBtnClickCallback(function(){C.removeFromParent(),I.onGuideFinishClick()}),I.renderSwitch.getRenderNode().addChild(C),I.renderSwitch.saveStatus(),I.renderSwitch.enableCocosRender(),I.renderSwitch.enableCocosTouch(),I.renderSwitch.disableTouchHandler(),f.UserInfoBtnManager.getInstance().createOnGameScene(function(){C.removeFromParent(),I.onGuideFinishClick()})}})},S.prototype.onGuideFinishClick=function(){this.renderSwitch.restoreStatus(),this.prepareModule(),this.showGuide(!0),this.startBlockGuide()},S.prototype.prepareModule=function(){this.moduleManager.prepareAllModules()},S.prototype.startBlockGuide=function(){if(this.handScript){var I=this.firstStage.guide.getStartBlockRect(),v=0-this.firstStage.guide.map.move,C=I.x+Math.floor(I.width/2),T=r.G.Ap.config.presentHeight-(I.y+v+Math.floor(I.height/2));this.handScript.setDataFroGameScene(null,!1,a.CircleColor.YELLOW,a.TipPos.DOWN,new cc.Vec2(C,T))}},S.prototype.showGuide=function(I){this.handScript&&(this.handScript.node.active=I)},S.prototype.endGuide=function(){this.handScript&&this.handScript.node.parent&&(this.handScript.node.removeFromParent(),this.handScript=null),i.default.getInstance().setGuideShowed(!0)},S}(d.default);m.default=_,cc._RF.pop()},{"../base/G":"G","../business/Logic/I18nManager":"I18nManager","../business/Logic/LevelMgr":"LevelMgr","../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr","../business/UI/UserInfoBtnManager":"UserInfoBtnManager","../business/gameover/ReliveFreeDialogTipDialog":"ReliveFreeDialogTipDialog","../business/task/newguidance/NewGuidancePrefab":"NewGuidancePrefab","../util/Utility":"Utility","./GameScene":"GameScene","./GameSceneSetting":"GameSceneSetting","./MUI/MUINode":"MUINode","./ctrl/GameStageGuide":"GameStageGuide","./ctrl/GameStageMoney":"GameStageMoney","./ctrl/GameStageMusic":"GameStageMusic","./view/GameStageNodeView":"GameStageNodeView"}],FirstSongTask:[function(l,P,m){"use strict";cc._RF.push(P,"a1417AxDoxC+b4aPB3A82VF","FirstSongTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TaskItemImpl"),s=l("../TaskItem"),r=l("../../Logic/PlayerMgr"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.update=function(){this.isTaskSuccess()?(this.currentStep=this.totalStep,this.status=s.TaskStatus.TASK_STATUS_SUCCESS):(this.currentStep=0,this.status=s.TaskStatus.TASK_STATUS_DOING)},n.prototype.isTaskSuccess=function(){return!(r.default.Ins().getUserLevel()===1&&r.default.Ins().getUserCurrentExp()<5)},n}(d.default);m.default=o,cc._RF.pop()},{"../../Logic/PlayerMgr":"PlayerMgr","../TaskItem":"TaskItem","./TaskItemImpl":"TaskItemImpl"}],FogWorker:[function(l,P,m){"use strict";cc._RF.push(P,"a550eE29f5Or6Feoj15friT","FogWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../workers/WorkerBase"),s=l("../../workers/WorkerState"),r=l("../../../property/PropertyDefines"),o=l("../../../base/G"),e=l("../../GameBus"),n=l("../../MUI/MUISprite"),t=l("../../../base/Log"),i=function(a){function u(){var c=a.call(this,"FogWorker")||this;return c.Property=null,c.OnCompleted=null,c}return __extends(u,a),u.prototype.onStart=function(){for(var c=this,p=[],h=0;h<arguments.length;h++)p[h]=arguments[h];try{if(p&&p.length<=0)return;this.Property=new r.Property(r.PROPERTYTYPE.GAME_FOG),this.stage=p[1],this.stage.propertyWorked=!0,new n.default("GiftIcon");var f=this.updateAdditionTime(5);e.default.getInstance().scheduler.scheduleOnce(function(){c.OnCompleted()},f),o.G.Ap.state.startPropertyWork(this.Property),console.log("--- FogWorker onStart args:---",p)}catch(g){console.log("--- FogWorker onStart err:---",g)}},u.prototype.updateAdditionTime=function(c){var p=c,h=o.G.propAddition.getAdditionFogTime(c,o.G.Ap.state.mission.getType().toString());return t.default.e("\u8FF7\u96FE \u65F6\u95F4\u52A0\u6210\uFF1A"+p+"  => "+h),h},u.prototype.onStop=function(){for(var c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];try{return console.log("--- FogWorker onStop args:---",c),this.stage.propertyWorked=!1,void o.G.Ap.state.stopPropertyWork(this.Property)}catch(h){console.log("--- FogWorker onStop err:---",h)}},u.prototype.onPause=function(){console.log("--- FogWorker onPause---")},u.prototype.onResume=function(){console.log("--- FogWorker onResume---")},u.prototype.onStateChanged=function(c){console.log("--- FogWorker onStateChanged args:---",c),c.state,s.WorkerState.stopped},u.prototype.reset=function(){this.Property=null},u}(d.WorkerBase);m.default=i,cc._RF.pop()},{"../../../base/G":"G","../../../base/Log":"Log","../../../property/PropertyDefines":"PropertyDefines","../../GameBus":"GameBus","../../MUI/MUISprite":"MUISprite","../../workers/WorkerBase":"WorkerBase","../../workers/WorkerState":"WorkerState"}],FollowGiftsPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"dbe5ePwiPJBqZmdoU00RSc/","FollowGiftsPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/PU"),s=l("../../SubscriptionUtils"),r=l("../Logic/EventBus"),o=l("../Logic/NotifyEvent"),e=l("../../infoc/m_p2_Uaction"),n=cc._decorator,t=n.ccclass,i=n.property,a=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.mLabel=null,p.mFollowButton=null,p.mBg=null,p.mList=null,p.mItem1=null,p.mItem2=null,p.mItem3=null,p.mDiamond=null,p.mCoin=null,p.mSkin=null,p.mSkinTerm=null,p.mCallBack=null,p}return __extends(c,u),c.prototype.onLoad=function(){this.initListener(),this.initUI()},c.prototype.start=function(){},c.prototype.initListener=function(){var p=this;this.mBg.node.on(cc.Node.EventType.TOUCH_START,function(h){h.stopPropagation()}),this.mFollowButton.node.on(cc.Node.EventType.TOUCH_START,function(){p.followSubscription()},this),this.mLabel.node.on(cc.Node.EventType.TOUCH_END,function(){e.default.report(0,e.default.ACTION_FOLLOW_DIALOG_CLOSE),p.close()},this),r.default.register(o.default.GAIN_REWARD_FROM_DESCRIPTION,this.close,this)},c.prototype.initUI=function(){if(d.default.isQQ()){this.mItem3.active=!1;var p=this.mList.getComponent(cc.Widget);p.top=445,p.updateAlignment()}this.mDiamond.string="\u94BB\u77F3x"+s.SubscriptionUtils.REWARD_DIAMOND,this.mCoin.string="\u91D1\u5E01x"+s.SubscriptionUtils.REWARD_COIN,this.mSkin.string=s.SubscriptionUtils.REWARD_SKIN,this.mSkinTerm.string="1\u5929",e.default.report(0,e.default.ACTION_FOLLOW_DIALOG_SHOW)},c.prototype.setCloseCallback=function(p){this.mCallBack=p},c.prototype.close=function(){this.mCallBack&&this.mCallBack(),r.default.remove(o.default.GAIN_REWARD_FROM_DESCRIPTION,this.close,this),this.node.parent.removeChild(this.node)},c.prototype.followSubscription=function(){e.default.report(0,e.default.ACTION_FOLLOW_DIALOG_CLICK),s.SubscriptionUtils.followSubscription()},__decorate([i(cc.Label)],c.prototype,"mLabel",void 0),__decorate([i(cc.Button)],c.prototype,"mFollowButton",void 0),__decorate([i(cc.Sprite)],c.prototype,"mBg",void 0),__decorate([i(cc.Node)],c.prototype,"mList",void 0),__decorate([i(cc.Node)],c.prototype,"mItem1",void 0),__decorate([i(cc.Node)],c.prototype,"mItem2",void 0),__decorate([i(cc.Node)],c.prototype,"mItem3",void 0),__decorate([i(cc.Label)],c.prototype,"mDiamond",void 0),__decorate([i(cc.Label)],c.prototype,"mCoin",void 0),__decorate([i(cc.Label)],c.prototype,"mSkin",void 0),__decorate([i(cc.Label)],c.prototype,"mSkinTerm",void 0),c=__decorate([t],c)}(cc.Component);m.default=a,cc._RF.pop()},{"../../SubscriptionUtils":"SubscriptionUtils","../../infoc/m_p2_Uaction":"m_p2_Uaction","../../util/PU":"PU","../Logic/EventBus":"EventBus","../Logic/NotifyEvent":"NotifyEvent"}],FragmentBoxManager:[function(l,P,m){"use strict";cc._RF.push(P,"a0bbfc1c8RIjpAKc0y/xofO","FragmentBoxManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=function(){function o(){}return o.getInstance=function(){return o.mInstance||(o.mInstance=new o),o.mInstance},o.prototype.getFragmentBoxVM=function(){for(var e=[],n=0,t=d.default.Ins().getDBRows(d.eDataBase.eDB_FragmentBox);n<t.length;n++){var i=t[n],a=parseInt(i.mRowData[0]);if(a&&typeof a=="number"){var u=new r,c=i;u.id=c.getId(),u.rewardType=c.getRewardType(),u.num=c.getNum(),u.chanceMin=c.getChanceMin(),u.chanceMax=c.getChanceMax(),e.push(u)}}return Object.seal(e)},o}();m.FragmentBoxManager=s;var r=function(){};m.FragmentBoxVM=r,cc._RF.pop()},{"../DB/DBMgr":"DBMgr"}],FragmentBox:[function(l,P,m){"use strict";cc._RF.push(P,"b52b0qA0yBDKpJ0Zg8gZAzL","FragmentBox"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findFragmentBoxById=function(n){return this.find("RewardType",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.FragmentBox=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.getRewardType=function(){return this.getString("RewardType")},e.prototype.getNum=function(){return this.getInt("num")},e.prototype.getChanceMin=function(){return this.getInt("chanceMin")},e.prototype.getChanceMax=function(){return this.getInt("chanceMax")},e}(d.default);m.FragmentBoxRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],GameApp:[function(l,P,m){"use strict";cc._RF.push(P,"662745bXWZEmbS1OHxKYcxL","GameApp"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Presenter"),s=l("./Data"),r=l("./State"),o=l("./Config"),e=l("./Sound"),n=l("../util/AutomaticTest"),t=l("../skin/SkinMgr"),i=l("../anticheat/AntiCheatProbe"),a=l("../property/PropertyPack"),u=function(){function c(){this.presenter=new d.default,this.data=new s.default,this.state=new r.default,this.config=new o.default,this.sound=new e.default,this.autoTester=new n.default,this.skinMgr=new t.default,this.antiCheat=new i.default,this.propertyPack=new a.default,this.performanceCounter=null}return c.prototype.initlizeOnLoadStart=function(){},c.prototype.initlizeOnLoadFinish=function(){this.antiCheat.initilize()},c.prototype.initializeOnLoadDataFinish=function(){this.propertyPack.initilize()},c}();m.default=u,cc._RF.pop()},{"../anticheat/AntiCheatProbe":"AntiCheatProbe","../property/PropertyPack":"PropertyPack","../skin/SkinMgr":"SkinMgr","../util/AutomaticTest":"AutomaticTest","./Config":"Config","./Data":"Data","./Presenter":"Presenter","./Sound":"Sound","./State":"State"}],GameBus:[function(l,P,m){"use strict";cc._RF.push(P,"6476aQAhHFIW72oFMmSCsT0","GameBus"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.animationMgr=null,this.scheduler=null,this.natureScheduler=null}return s.getInstance=function(){return s.sInstance==null&&(s.sInstance=new s),s.sInstance},s.prototype.getAnimationMgr=function(){return this.animationMgr},s.prototype.getScheduler=function(){return this.scheduler},s.prototype.getNatureScheduler=function(){return this.natureScheduler},s.sInstance=null,s}();m.default=d,cc._RF.pop()},{}],GameClub:[function(l,P,m){"use strict";cc._RF.push(P,"bb7400HtaFD4IuOmVibIJqs","GameClub"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/PU"),s=l("../../util/SUtil"),r=l("../../infoc/m_p2_Uaction"),o=l("../../util/Utility"),e=function(){function n(){}return n.show=function(t){if(this.mGameClubButton)return this.mGameClubButton.show(),n.mIsShow=!0;if(d.default.isWeiXin()&&0<=o.Utility.compareVersion(d.default.SDKVersion,"2.0.3")){var i=void 0;if(s.SUtil.ins().isLiuHai())switch(t){case 0:i=858/s.SUtil.ins().mScreenHeight;break;case 1:i=760/s.SUtil.ins().mScreenHeight;break;case 2:i=670/s.SUtil.ins().mScreenHeight}else if(s.SUtil.ins().isQuanMian())switch(t){case 0:i=785/s.SUtil.ins().mScreenHeight;break;case 1:i=690/s.SUtil.ins().mScreenHeight;break;case 2:i=600/s.SUtil.ins().mScreenHeight}else if(s.SUtil.ins().isPuTong())switch(t){case 0:i=740/s.SUtil.ins().mScreenHeight;break;case 1:i=645/s.SUtil.ins().mScreenHeight;break;case 2:i=555/s.SUtil.ins().mScreenHeight}var a=d.default.windowWidth/720*44;return this.mGameClubButton=wx.createGameClubButton({icon:"white",style:{left:39*d.default.windowWidth/720,top:d.default.windowHeight*i,width:a,height:a}}),this.mGameClubButton.onTap(function(u){console.log(u),r.default.report(0,r.default.ACTION_CLICK_PLAYER_CYCLE)}),n.mIsShow=!0}return!1},n.hide=function(){var t=n.mIsShow;return this.mGameClubButton&&n.mIsShow&&(this.mGameClubButton.hide(),n.mIsShow=!1),t},n.destroy=function(){this.mGameClubButton&&(this.mGameClubButton.destroy(),this.mGameClubButton=null,n.mIsShow=!1)},n.mIsShow=!1,n}();m.default=e,cc._RF.pop()},{"../../infoc/m_p2_Uaction":"m_p2_Uaction","../../util/PU":"PU","../../util/SUtil":"SUtil","../../util/Utility":"Utility"}],GameDefine:[function(l,P,m){"use strict";cc._RF.push(P,"f0f279YGIhK3q2ag6hZdZTC","GameDefine"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r,o=l("../Logic/Level");(s=d=m.eFromTab||(m.eFromTab={}))[s.FROM_NONE=0]="FROM_NONE",s[s.FROM_HOME=1]="FROM_HOME",s[s.FROM_MUSIC=2]="FROM_MUSIC",s[s.FROM_HALL=3]="FROM_HALL",s[s.FROM_MORESONG=4]="FROM_MORESONG",s[s.FROM_ME=5]="FROM_ME",(r=m.eFromMusicListTab||(m.eFromMusicListTab={}))[r.FROM_ML_LEVEL=0]="FROM_ML_LEVEL",r[r.FROM_ML_UNLEVEL=1]="FROM_ML_UNLEVEL",r[r.FROM_ML_FAVOR=2]="FROM_ML_FAVOR",r[r.FROM_ML_END=3]="FROM_ML_END";var e=function(){function c(){}return c.DIAMONDSONG_STARTID=700,c.TRIAL_SONG_ID=400,c.CHOICENESS_STARTID=9e3,c.CLOUD_HOTSONG_URL="https://piano-weixin-game.cmcm.com/pianotiles2/cfg/hotsong/hotsong_config.json",c}();m.Constant=e;var n=function(){this.mId=0,this.mMid=0,this.mUnlockFlag=t.FLAG_NONE,this.mItemPlayMusicAnim=!1,this.mSymbol=o.eSymbolKind.eSymbolDefault,this.mRewardEXP1=0,this.mRewardEXP2=0,this.mRewardEXP3=0,this.mRewar3Gold=0,this.mRewar3Goldline=0,this.mRewarPro=0,this.mRewarMax=0,this.mFromTab=d.FROM_NONE,this.mRewarID=0,this.mActivity=0};m.LevelInfo=n;var t,i,a,u=function(){function c(){this.mId=0,this.mMid=0,this.mBestScore=0,this.mBestStar=0,this.mBestSpeed=0,this.mScore=0,this.mStar=0,this.mSpeed=0,this.mBadBlockType=0,this.mBadBlcokCount=0,this.mbadEndBlock=0,this.mIsFirstPassed=!1,this.mIsFirstBlood=!1,this.mIsFirstSecond=!1,this.mIsFirstFour=!1,this.mIsFirstFive=!1,this.mIsFirstSix=!1,this.mLockFb=!1,this.mUnlockFlag=t.FLAG_NONE,this.mExp=0,this.mCoin=0,this.mIsUpLevel=!1,this.mIsFisrtGame=!1,this.mFrom=0,this.mbest=!1,this.mGainedGold=0}return c.prototype.isRecordLocked=function(){return this.mId!=1&&c.isLocked(this.mUnlockFlag)},c.isLocked=function(p){return p==t.FLAG_LOCKED_LV||p==t.FLAG_LOCKED_GOLD||p==t.FLAG_LOCKED_STAR||p==t.FLAG_LOCKED_DIAMOND||p==t.FLAG_LOCKED_LV_TRY},c.prototype.clearData=function(){this.mBestScore=0,this.mBestStar=0,this.mBestSpeed=0},c.prototype.isEmpty=function(){var p=this.isRecordLocked();return!(this.mBestScore!=0||!p)},c}();m.LevelRecord=u,(i=t=m.eUnlockFlag||(m.eUnlockFlag={}))[i.FLAG_NONE=0]="FLAG_NONE",i[i.FLAG_LOCKED_LV=1]="FLAG_LOCKED_LV",i[i.FLAG_LOCKED_GOLD=2]="FLAG_LOCKED_GOLD",i[i.FLAG_LOCKED_STAR=3]="FLAG_LOCKED_STAR",i[i.FLAG_UNLOCKED=4]="FLAG_UNLOCKED",i[i.FLAG_UNLOCK_LV=5]="FLAG_UNLOCK_LV",i[i.FLAG_UNLOCK_LV_SHOWN=6]="FLAG_UNLOCK_LV_SHOWN",i[i.FLAG_UNLOCK_GOLD=7]="FLAG_UNLOCK_GOLD",i[i.FLAG_UNLOCK_GOLD_SHOWN=8]="FLAG_UNLOCK_GOLD_SHOWN",i[i.FLAG_UNLOCK_STAR=9]="FLAG_UNLOCK_STAR",i[i.FLAG_UNLOCK_STAR_SHOWN=10]="FLAG_UNLOCK_STAR_SHOWN",i[i.FLAG_UNLOCK_DIAMOND=11]="FLAG_UNLOCK_DIAMOND",i[i.FLAG_UNLOCK_DIAMOND_SHOWN=12]="FLAG_UNLOCK_DIAMOND_SHOWN",i[i.FLAG_LOCKED_DIAMOND=13]="FLAG_LOCKED_DIAMOND",i[i.FLAG_LOCKED_ACTIVITY=14]="FLAG_LOCKED_ACTIVITY",i[i.FLAG_LOCKED_LV_TRY=19]="FLAG_LOCKED_LV_TRY",i[i.FLAG_UNLOCK_SHARE=20]="FLAG_UNLOCK_SHARE",i[i.FLAG_UNLOCK_BY_VIP=21]="FLAG_UNLOCK_BY_VIP",i[i.FLAG_LOCKED_VIDEO=22]="FLAG_LOCKED_VIDEO",(a=m.eLanguage||(m.eLanguage={}))[a.LANGUAGE_NONE=0]="LANGUAGE_NONE",a[a.LANGUAGE_EN=1]="LANGUAGE_EN",a[a.LANGUAGE_ZH_CN=2]="LANGUAGE_ZH_CN",a[a.LANGUAGE_ZH_TW=3]="LANGUAGE_ZH_TW",a[a.LANGUAGE_DE=4]="LANGUAGE_DE",a[a.LANGUAGE_FR=5]="LANGUAGE_FR",a[a.LANGUAGE_NL=6]="LANGUAGE_NL",a[a.LANGUAGE_NW=7]="LANGUAGE_NW",a[a.LANGUAGE_PO=8]="LANGUAGE_PO",a[a.LANGUAGE_TR=9]="LANGUAGE_TR",a[a.LANGUAGE_ES=10]="LANGUAGE_ES",a[a.LANGUAGE_IT=11]="LANGUAGE_IT",a[a.LANGUAGE_AR=12]="LANGUAGE_AR",a[a.LANGUAGE_KR=13]="LANGUAGE_KR",a[a.LANGUAGE_JP=14]="LANGUAGE_JP",a[a.LANGUAGE_RU=15]="LANGUAGE_RU",a[a.LANGUAGE_IN=16]="LANGUAGE_IN",cc._RF.pop()},{"../Logic/Level":"Level"}],GameEntranceSceneFirstEnter:[function(l,P,m){"use strict";cc._RF.push(P,"b271579+n1CQq7ATVD/yq0u","GameEntranceSceneFirstEnter"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../util/SUtil"),s=l("../MusicLevelDataLoader"),r=l("../../../infoc/m_p2_Uaction"),o=l("../../../util/SceneMusicMgr"),e=l("../../../util/SceneMusicUtil"),n=l("../../../base/G"),t=l("../../../base/State"),i=l("../../Logic/Plugin/PluginMgr"),a=l("../../Logic/Plugin/IPlugin"),u=l("../../../gamescene/GameSceneSetting"),c=l("../../../base/Startup"),p=l("../../../util/PU"),h=l("../../Logic/I18nManager"),f=l("../../UI/GameEntraScene/ImgCache"),g=l("../../keypad/KeypadNavigator"),_=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),y=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),S=cc._decorator,I=S.ccclass,v=S.property,C=function(T){function E(){var A=T!==null&&T.apply(this,arguments)||this;return A.mFirstEnterStartBtn=null,A.mFirstStartTopLabel=null,A.mFirstStartDiscSprite=null,A.mFirstStartNameLabel=null,A.mFirstStartBottomLabelPanel=null,A.startTime=0,A}return __extends(E,T),E.prototype.enResLoad=function(){var A=this;this.enSpriteSetNull(),f.default.get("static_res/little_star_button_start_normal_en",function(M,k){cc.isValid(A,!0)&&(A.mFirstEnterStartBtn.normalSprite=k)}),f.default.get("static_res/little_star_button_start_pressend_en",function(M,k){cc.isValid(A,!0)&&(A.mFirstEnterStartBtn.pressedSprite=k)})},E.prototype.enSpriteSetNull=function(){this.mFirstEnterStartBtn.getComponent(cc.Sprite).spriteFrame=null},E.prototype.onLoad=function(){h.default.getInstance().isEnglish()&&this.enResLoad(),this.loadLittleStarScene()},E.prototype.start=function(){this.adaptorUI(),this.startTime=Date.now(),p.default.isCM()&&(c.default.hasReportTimecost||(c.default.hasReportTimecost=!0),p.default.isCM()&&CMPlay.Infoc.reportAction(CMPlay.ACTION.GUIDE_PAGE)),g.default.getInstance().gotoPage(this.node,"FirstEnter")},E.prototype.play=function(A){o.default.stop(o.default.NAME_MOVIE_CYCLE),e.default.playBtnBeats(),n.G.Ap.state.reset(),n.G.Ap.state.mission=new t.Mission(A.id,A.musicId,!1),n.G.Ap.config.loadMusic(A.musicId,function(M){i.default.Ins().getPlugin(a.default.Plugin_Energy).decreaseEnergy(1),u.default.getInstance().setFromSource(u.FromSource.SOURCE_GUIDE),n.G.Ap.presenter.enterScene(n.G.GAME_SCENE_NAME,A.musicId)})},E.prototype.loadLittleStarScene=function(){var A=this,M=s.MusicLevelDataLoader.getHomePageItemInfo();this.mFirstEnterStartBtn.node.on(cc.Node.EventType.TOUCH_END,function(){var D=_.ADScene.PLAY_GAME;y.MGAdv.commercialBreak(D,_.QQ_ADV_TYPE.VIDEO_TYPE_PLAY_AGAIN,function(L){A.play(M)})},this);var k=cc.rotateBy(2,90);this.mFirstStartDiscSprite.node.runAction(cc.repeatForever(k)),r.default.report(0,r.default.ACTION_SHOW_FIRST_LITTLE_STAR)},E.prototype.adaptorUI=function(){d.SUtil.ins().isLiuHai()?(d.SUtil.ins().toTop(this.mFirstStartTopLabel,18.5),d.SUtil.ins().toTop(this.mFirstStartDiscSprite,25.3),d.SUtil.ins().toTop(this.mFirstStartNameLabel,58.6),d.SUtil.ins().toTop(this.mFirstEnterStartBtn,65.9),d.SUtil.ins().toTop(this.mFirstStartBottomLabelPanel,88.1)):d.SUtil.ins().isQuanMian()?(d.SUtil.ins().toTop(this.mFirstStartTopLabel,15.5),d.SUtil.ins().toTop(this.mFirstStartDiscSprite,22.6),d.SUtil.ins().toTop(this.mFirstStartNameLabel,58.8),d.SUtil.ins().toTop(this.mFirstEnterStartBtn,66.6),d.SUtil.ins().toTop(this.mFirstStartBottomLabelPanel,94.1)):d.SUtil.ins().isPuTong()&&(d.SUtil.ins().toTop(this.mFirstStartTopLabel,11.3),d.SUtil.ins().toTop(this.mFirstStartDiscSprite,19.5),d.SUtil.ins().toTop(this.mFirstStartNameLabel,60.2),d.SUtil.ins().toTop(this.mFirstEnterStartBtn,69),d.SUtil.ins().toTop(this.mFirstStartBottomLabelPanel,93.4))},__decorate([v(cc.Button)],E.prototype,"mFirstEnterStartBtn",void 0),__decorate([v(cc.Label)],E.prototype,"mFirstStartTopLabel",void 0),__decorate([v(cc.Sprite)],E.prototype,"mFirstStartDiscSprite",void 0),__decorate([v(cc.Label)],E.prototype,"mFirstStartNameLabel",void 0),__decorate([v(cc.Layout)],E.prototype,"mFirstStartBottomLabelPanel",void 0),E=__decorate([I],E)}(cc.Component);m.default=C,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../base/G":"G","../../../base/Startup":"Startup","../../../base/State":"State","../../../gamescene/GameSceneSetting":"GameSceneSetting","../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../util/PU":"PU","../../../util/SUtil":"SUtil","../../../util/SceneMusicMgr":"SceneMusicMgr","../../../util/SceneMusicUtil":"SceneMusicUtil","../../Logic/I18nManager":"I18nManager","../../Logic/Plugin/IPlugin":"IPlugin","../../Logic/Plugin/PluginMgr":"PluginMgr","../../UI/GameEntraScene/ImgCache":"ImgCache","../../keypad/KeypadNavigator":"KeypadNavigator","../MusicLevelDataLoader":"MusicLevelDataLoader"}],GameEntranceScene:[function(l,P,m){"use strict";cc._RF.push(P,"fb2c0jkknRCAJgvQ81PRire","GameEntranceScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Logic/PlayerMgr"),s=l("../../../base/G"),r=l("../MusicLevelDataLoader"),o=l("../../Network/Protocol/StorageUtil"),e=l("../../../config/LSKey"),n=l("./BasicTouchEvent"),t=l("./HomePagePrefb"),i=l("../playerInfoPopup/PlayerInfoPopupProfab"),a=l("../UserInfoManager"),u=l("../../../util/TimeUtil"),c=l("../../Logic/Plugin/PluginMgr"),p=l("../../Logic/Plugin/IPlugin"),h=l("../../../util/SceneMusicMgr"),f=l("../../Logic/EventBus"),g=l("../../Logic/NotifyEvent"),_=l("../../../infoc/m_p2_Uaction"),y=l("../../../infoc/m_p2_pop_coin"),S=l("../../../util/SUtil"),I=l("../../Logic/MoneySystem"),v=l("../../../gamescene/GameSceneSetting"),C=l("./PopupDlg"),T=l("../../skin/SkinStore"),E=l("../dailyattendance/DailyAttendancePrefbScript"),A=l("./CheckRewardProcessor"),M=l("../../daily/DAwardMgr"),k=l("./PrefabMgr"),D=l("../../Logic/InviteSkinManager"),L=l("../../../base/CrashMonitor"),b=l("./MusicLib/MusicLibraryManager"),N=l("./MusicLib/HotSongSplash"),H=l("./ToastPrefab"),R=l("./MusicLib/UnlockConfirmDialogPrefab"),F=l("../../Logic/Plugin/UnlockProcessor"),x=l("../../looper/ActivityLooper"),U=l("../../../infoc/minigame_piano2_hotmusic"),B=l("../../../base/Log"),Q=l("../../../infoc/m_p2_PData_Dia"),Z=l("./ToastPopManager"),z=l("../../skin/SkinManager"),W=l("../../task/TaskItem"),V=l("../../task/newguidance/NewGuidanceLoader"),Y=l("../../../util/PageHeap"),q=l("../../shop/DialogOneButtonPrefab"),J=l("../../../util/PU"),ee=l("../../../../modules/MGAppShare/scripts/ShareHelper"),$=l("../../music/MusicDownloadProcess"),j=l("../../skin/SkinUtils"),ie=l("../../../util/QQReport"),oe=l("../../skin/frag/SkinTaskMgr"),ue=l("./mainpage/ShareSkinController"),pe=l("../../daily/AttentionUtil"),de=l("./MusicLib/HotMusicCMShareController"),he=l("../../Logic/I18nManager"),me=l("../../lottery/LotteryProcess"),ye=l("../../lottery/LotteryIndex"),ge=l("../../../infoc/InfocHelper"),Te=l("../../lottery/LotteryEnum"),Se=l("../../keypad/KeypadNavigator"),Be=l("../../../../modules/MGAdv/scripts/Adapter/AdvHelperCMplay"),be=cc._decorator,Ue=be.ccclass,se=be.property,He=function(re){function O(){var G=re!==null&&re.apply(this,arguments)||this;return G.top_energy_value_btn=null,G.top_energy_value_label=null,G.top_glod_value_btn=null,G.top_gold_value_lable=null,G.top_diamond_value_btn=null,G.top_diamond_value_lable=null,G.mTopIconPanel=null,G.middle_content_layout=null,G.mainpage_layout_preF=null,G.mainpage_layout=null,G.ranking_layout=null,G.player_info_popup_layout=null,G.mToastPopLayout=null,G.mGlobalPopupContainer=null,G.mAnimHeartLayout=null,G.mHpTimeGroup=null,G.mHpTimeLabel=null,G.mGlobalRankLayout=null,G.energy_btn=null,G.gold_btn=null,G.diamond_btn=null,G.mEventStopNode=null,G.mMusicLibrary=null,G.mLitteStarNode=null,G.mEnergyBtnClickCallback=null,G.mGoldBtnClickCallback=null,G.mDiamondBtnClickCallback=null,G.mIsPlayEnergyAnim=!1,G.mHomePageScriptNode=null,G.mDiaogMgr=null,G.mCheckRewardProcessor=null,G.mCheckActivityRewardProcessor=null,G.mShowingLittleStarLayout=!1,G.mSkinStorePrefbNode=null,G.mActivityLooper=null,G.mShowNewTargetGuide=!1,G.mMusicLibraryPrefb=null,G.mIsFirst=!0,G.mUpdateTask=[],G.mProgressDlg=null,G.isCheckingPopupDialogs=!1,G.mCurrHotTab=!1,G.isLoadingMusic=!1,G}var w;return __extends(O,re),(w=O).prototype.toSkinStoreFromAwardPageCallback=function(G,K){this.toHomeTab()},O.prototype.onLoad=function(){L.default.end("GameEntranceScene"),f.default.register(g.default.HP_NOT_ENOUGH_ITEM_CLICK,this.hpNotEnoughCallback,this),f.default.register(g.default.HIDE_HOMEPAGE_EVENT_TOP_MASK,this.hideEventStopNode,this),f.default.register(g.default.SHOW_HOMEPAGE_EVENT_TOP_MASK,this.showEventStopNode,this),f.default.register(g.default.LIFE_CYCLE_ON_SHOW,this.onShow,this),f.default.register(g.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,this.showMusicToast,this),f.default.register(g.default.SHOW_MUSIC_LIB_UNLOCK_DIALOG,this.showMusicLibUnlockDialog,this),f.default.register(g.default.INVITE_SONG_LOOPER_START,this.startActivityLooper,this),f.default.register(g.default.INVITE_SONG_LOOPER_STOP,this.releaseActivityLooper,this),f.default.register(g.default.REWARTDPANEL_SHOW_SKINSTORE,this.toSkinStoreFromAwardPageCallback,this),f.default.register(g.default.REWARTDPANEL_SHOW_PIECE,this.toSkinStoreFromAwardPageCallback,this),f.default.register(g.default.SHARE_HOME_SHOW_INVITE_TIPS,this.showInviteTipsPopup,this),f.default.register(g.default.SPEC_SONG_TRY_SKIN_HOME,this.specSongTrySkin,this),f.default.register(g.default.LOAD_MUSIC,this.onLoadMusic,this),f.default.register(g.default.DIAMOND_BUY_TRUMPET_NOT_ENOUGH,this.buyTrumpetDiamondnotEnough,this),f.default.register(g.default.NEW_GUIDE_GO_CLICK,this.newGuideGoClick,this),this.mDiaogMgr=new C.PopupDlg,this.mDiaogMgr.setParentLayout(this.player_info_popup_layout),this.mDiaogMgr.setShowDialogCallback(this.onAddDialog.bind(this)),this.mDiaogMgr.setDismissDialogCallback(this.onRemoveDialog.bind(this)),this.updateToastLayout(),this.mCheckRewardProcessor=new A.default(this.mDiaogMgr),this.saveLoginGame(),this.loadNormalScene(),Se.default.getInstance().gotoPage(this.node,"MainPagePrefab","onLoad")},O.prototype.start=function(){this.onSkinChange(),this.adaptorUI(),this.postUpdateTask(function(){$.MusicDownloadProcess.Ins().updateMusicPiano()})},O.prototype.onSkinChange=function(){if(this.applyBackgroundSkin(),this.applyHomePageSkin(),this.mainpage_layout){var G=this.mainpage_layout.getComponent(t.default);G&&G.onSkinChange()}if(this.mSkinStorePrefbNode){var K=this.mSkinStorePrefbNode.getComponent(T.default);K&&K.onSkinChange()}},O.prototype.postUpdateTask=function(G){this.mUpdateTask.push(G)},O.prototype.update=function(G){if(!s.G.Ap.config.debugNoBackgroundAnim){var K=s.G.Ap.skinMgr.getCurrentSkinItem();K&&K.getSkinElementPainter().update(G,"GameEntranceScene"),0<this.mUpdateTask.length&&this.mUpdateTask.shift()()}},O.prototype.applyBackgroundSkin=function(){if(!s.G.Ap.config.debugNoBackgroundAnim){var G=s.G.Ap.skinMgr.getCurrentSkinItem();if(G){var K=this.node.getChildByName("bg_share_star"),X=this.node.getChildByName("animation_bkg");G.getSkinElementPainter().captureBackground("GameEntranceScene",K,X)}}},O.prototype.applyHomePageSkin=function(){var G=s.G.Ap.skinMgr.getCurrentSkinItem();G&&G.getSkinElementPainter().captureElement("GameEntranceScene","parent",this.node.parent)},O.prototype.hpNotEnoughCallback=function(){this.toEnergyDialog(y.default.SOURCE_ENERGY_NOT_CLICK_START)},O.prototype.hpReviveCallback=function(G,K){K<=0?this.mHpTimeGroup.node.active=!1:(this.mHpTimeGroup.node.active=!0,this.mHpTimeLabel.string=u.default.convertSecondToMinutesSecond(K))},O.prototype.loadNormalScene=function(){switch(o.default.save(e.default.HAS_SHOW_HOME_PAGE,"true"),this.mHpTimeGroup.node.active=!1,a.User.UserInfoManager.registerHpReviveListener(this.hpReviveCallback,this),d.default.Ins().addUserListener(this),w.DefaultPageIndex){case w.GAME_ENTRA_SCENE_INDEX.HOMEPAGE_INDEX:this.toHomeTab();break;case w.GAME_ENTRA_SCENE_INDEX.MUSIC_LIB_INDEX:this.isSongTryFinish()?this.toMusicLibTab(!0):this.toMusicLibTab();break;case w.GAME_ENTRA_SCENE_INDEX.CHALLENGE_INDEX:this.toHomeTab();break;case w.GAME_ENTRA_SCENE_INDEX.TO_HOT_INDEX:this.toMusicLibTab(!0);break;case w.GAME_ENTRA_SCENE_INDEX.TO_FIGHT_INDEX:this.toHomeTab();break;case w.GAME_ENTRA_SCENE_INDEX.TO_SKIN_PAGE:}w.DefaultPageIndex=w.GAME_ENTRA_SCENE_INDEX.NONE_INDEX,this.initEvents()},O.prototype.initEvents=function(){var G=this;this.mEnergyBtnClickCallback=new n.default(function(){G.toEnergyDialog(y.default.SOURCE_HOME_ENERGY),_.default.report(0,_.default.ACTION_CLICK_ENERGY)}),this.energy_btn.node.on(cc.Node.EventType.TOUCH_END,this.mEnergyBtnClickCallback.click,this.mEnergyBtnClickCallback),this.mGoldBtnClickCallback=new n.default(function(){G.goldBtnClick(y.default.SOURCE_HOME_GOLD),_.default.report(0,_.default.ACTION_CLICK_GOLD)}),this.gold_btn.node.on(cc.Node.EventType.TOUCH_END,this.mGoldBtnClickCallback.click,this.mGoldBtnClickCallback),this.mDiamondBtnClickCallback=new n.default(function(){G.diamondBtnClick(y.default.SOURCE_HOME_DIAMOND),_.default.report(0,_.default.ACTION_CLICK_DIAMOND)}),this.diamond_btn.node.on(cc.Node.EventType.TOUCH_END,this.mDiamondBtnClickCallback.click,this.mDiamondBtnClickCallback)},O.prototype.onHomeTabClickCallback=function(G){this.toHomeTab()},O.prototype.toHomeTab=function(){var G=this;B.default.l("[GameEntranceScene.toHomeTab] enter"),_.default.report(r.MusicLevelDataLoader.getHomePageItemInfo().musicId,_.default.ACTION_SHOW_HOME_TAB),this.mainpage_layout?(this.mainpage_layout.active=!0,this.mHomePageScriptNode.onStart(),this.mHomePageScriptNode.onShow()):(this.mainpage_layout=cc.instantiate(this.mainpage_layout_preF),this.middle_content_layout.node.addChild(this.mainpage_layout),this.mHomePageScriptNode=this.mainpage_layout.getComponent(t.default),this.mHomePageScriptNode.setSlidePanelLoadFinish(function(){G.scheduleOnce(function(){Se.default.getInstance().isNodeExists("DailyBtn")||Se.default.getInstance().refreshPage(G.node,"MainPagePrefab")},1)}),Y.default.Ins().push("HomePage")),this.mHomePageScriptNode&&this.mHomePageScriptNode.checkTargetIcon(),this.hideRankPage(),this.hideMusicPage(),this.mTopIconPanel.node.active=!0,this.mHomePageScriptNode.setUseEnergyCallback(function(K){if(console.warn("setUseEnergyCallback => spendEnergy:"+K),K==0)return G.showEventStopNode(),G.mHomePageScriptNode.startGame(!1),void G.hideEventStopNode();if(c.default.Ins().getPlugin(p.default.Plugin_Energy).isCurEnergyEnough()){if(!G.mIsPlayEnergyAnim){G.mIsPlayEnergyAnim=!0,G.showEventStopNode();var X=G.mAnimHeartLayout.getPosition(),te=G.mHomePageScriptNode.getStartBtnPosition(),ne=cc.moveTo(.5,te);G.mAnimHeartLayout.active=!0,G.scheduleOnce(function(){var ae=cc.sequence(ne,cc.callFunc(function(){var le=G.mAnimHeartLayout.getComponent(cc.Animation);le.once("finished",function(){G.mHomePageScriptNode.startGame(),G.hideEventStopNode(),G.mIsPlayEnergyAnim=!1,G.mAnimHeartLayout.setPosition(X),G.mHeartAnimNode.opacity=255,G.mAnimHeartLayout.active=!1},G),le.play("heart_anim"),h.default.play(h.default.NAME_CONSUME_LIFE,h.default.PATH_CONSUME_LIFE,!1)}));G.mAnimHeartLayout.runAction(ae)},.02)}}else G.toEnergyDialog(y.default.SOURCE_ENERGY_NOT_CLICK_START)}),this.mHomePageScriptNode.setHomeShareGiftClickCallback(function(){}),this.mHomePageScriptNode.setHomeDailyAtdcClickCallback(function(){G.showDailyAttendanceDlg()}),this.mHomePageScriptNode.setShowSkinStoreCallback(function(){G.showSkinStorePopup(!1)}),this.mHomePageScriptNode.setShowSkinPieceCallback(function(){G.showSkinStorePopup(!0)}),this.mHomePageScriptNode.setToHotMusicTabCallback(function(){G.toMusicLibTab(!0)}),this.mHomePageScriptNode.setToChallengePageCallback(function(){}),this.mHomePageScriptNode.setToMusicLibCallback(function(){G.onMusicLibTabClickCallback()}),this.mHomePageScriptNode.setToLottaryPageCallback(function(){G.showLottoryDlg()}),this.mHomePageScriptNode.setToChosenMusicPageCallback(function(){G.toMusicLibTab(!0)}),this.mHomePageScriptNode.setOnLoadFinishCB(function(){G.mHomePageScriptNode.hideLeftIcon(),G.showDialogs(!0)}),this.ranking_layout&&(this.ranking_layout.active=!1),this.showDialogs(),J.default.isCM()||D.InviteSkinManager.refreshInviteSkinData(),z.SkinMgr.Ins().checkSkinTimeLimit(this.player_info_popup_layout,function(){G.onSkinChange()}),J.default.supportCMOnshare()&&this.checkInviters(),B.default.l("GameEntranceScene start finish."),Se.default.getInstance().gotoPage(this.node,"MainPagePrefab","toHomeTab")},O.prototype.checkInviters=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(G){switch(G.label){case 0:return[4,this.checkCMActivitySongInviter()];case 1:return G.sent(),this.checkCMActivitySkinInviter(),[2]}})})},O.prototype.checkCMActivitySkinInviter=function(){var G=this,K=de.default.Ins().getSkinItemArray();if(K&&0<K.length)return K.forEach(function(X){B.default.i("CMPlayShare: GameEntranceScene===>checkCMActivitySongInviter, name:"+X.name+", displayName:"+X.displayName)}),this.mCheckActivityRewardProcessor.checkCMShareForSkinInviterReward(K,function(X,te){return __awaiter(G,void 0,void 0,function(){return __generator(this,function(ne){switch(ne.label){case 0:return X?[4,this.showSkinStorePopup(!1)]:[3,2];case 1:return ne.sent(),[3,2];case 2:return te(!0),[2]}})})})},O.prototype.checkCMActivitySongInviter=function(){return __awaiter(this,void 0,Promise,function(){var G,K=this;return __generator(this,function(X){return(G=de.default.Ins().getItemArray())&&0<G.length?(G.forEach(function(te){B.default.i("CMPlayShare: GameEntranceScene===>checkCMActivitySongInviter, id:"+te.id+", musicId:"+te.musicId)}),[2,this.mCheckActivityRewardProcessor.checkCMShareForSongInviterReward(G,function(te,ne){return __awaiter(K,void 0,void 0,function(){return __generator(this,function(ae){return te&&this.toMusicLibTab(!0),[2]})})})]):[2]})})},O.prototype.newGuideGoClick=function(G,K){var X=K[0];switch(this.mHomePageScriptNode&&this.mHomePageScriptNode.hideFightGuide(),X){case W.TaskID.TASK_ID_LITTLE_STAR:case W.TaskID.TASK_ID_LEVEL_THREE:V.default.getInstance().showGuideFinger("NewPlayerTarget","HomePagePreF","GuideToPlay",this.node,!1,this.hideTargetIconFinger);break;case W.TaskID.TASK_ID_ATTEND_CHALLENGE:V.default.getInstance().showGuideFinger("NewPlayerTarget","HomePagePreF","GuideToChallenge",this.node,!1,this.hideTargetIconFinger);break;case W.TaskID.TASK_ID_GAME_SHARE:V.default.getInstance().showGuideFinger("NewPlayerTarget","HomePagePreF","GuideToShare",this.node,!1,this.hideTargetIconFinger);break;case W.TaskID.TASK_ID_UNLOCK_HOT_SONG:V.default.getInstance().showGuideFinger("NewPlayerTarget","HomePagePreF","GuideToHotMusic",this.node,!1,this.hideTargetIconFinger)}},O.prototype.hideTargetIconFinger=function(){f.default.fire(g.default.HIDE_GUIDE_FINGER)},O.prototype.getProcessType=function(){var G=s.G.getLaunchOption();return pe.AttentionUtil.isLauchFromAttention(G)?w.ENTRANCE_TYPE_FROM_ATTENTION_ENTER:G&&G.query?G.query.source==ee.ShareHelper.SHARE_SOURCE_INVITE_FRIEND||G.query.source==ee.ShareHelper.SHARE_SOURCE_RELIVE?w.ENTRANCE_TYPE_FROM_HELP_GETTING_DIAMOND:G.query.source==ee.ShareHelper.SHARE_SOURCE_INVITE_SKIN?w.ENTRANCE_TYPE_FROM_HELP_GETTING_SKIN:G.query.source==ee.ShareHelper.SHARE_SOURCE_INVITE_SONG?w.ENTRANCE_TYPE_FROM_HELP_GETTING_SONG:G.query.source==ee.ShareHelper.SHARE_SOURCE_SKIN_PIECE?w.ENTRANCE_TYPE_FROM_SKIN_PIECE:w.ENTRANCE_TYPE_NORMAL:w.ENTRANCE_TYPE_NORMAL},O.prototype.showMusicLibDialogs=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(G){switch(G.label){case 0:return[4,this.checkShowDailyAttendanceDlg()];case 1:return G.sent(),[2]}})})},O.prototype.doShowDialogs=function(G){return G===void 0&&(G=!1),__awaiter(this,void 0,void 0,function(){var K;return __generator(this,function(X){switch(X.label){case 0:return B.default.i("[gwj] showDialogs enter"),J.default.isCM()?[4,this.checkShowDailyAttendanceDlg()]:[3,2];case 1:return X.sent(),[2];case 2:switch(K=this.getProcessType(),K){case w.ENTRANCE_TYPE_FROM_HELP_GETTING_DIAMOND:return[3,3];case w.ENTRANCE_TYPE_FROM_HELP_GETTING_SKIN:return[3,6];case w.ENTRANCE_TYPE_FROM_HELP_GETTING_SONG:return[3,9];case w.ENTRANCE_TYPE_FROM_ATTENTION_ENTER:return[3,12];case w.ENTRANCE_TYPE_FROM_SKIN_PIECE:return[3,15];case w.ENTRANCE_TYPE_NORMAL:return[3,19]}return[3,22];case 3:return[4,this.checkShowDailyAttendanceDlg()];case 4:return X.sent(),[4,this.showHotSongSplash()];case 5:return X.sent(),[3,22];case 6:return[4,this.checkShowDailyAttendanceDlg()];case 7:return X.sent(),[4,this.showHotSongSplash()];case 8:return X.sent(),[3,22];case 9:return[4,this.checkShowDailyAttendanceDlg()];case 10:return X.sent(),[4,this.showHotSongSplash()];case 11:return X.sent(),[3,22];case 12:return[4,this.checkShowDailyAttendanceDlg()];case 13:return X.sent(),[4,this.showHotSongSplash()];case 14:return X.sent(),[3,22];case 15:return[4,this.checkSkinPieceInvitee()];case 16:return X.sent(),[4,this.checkShowDailyAttendanceDlg()];case 17:return X.sent(),[4,this.showHotSongSplash()];case 18:return X.sent(),[3,22];case 19:return[4,this.checkShowDailyAttendanceDlg()];case 20:return X.sent(),[4,this.showHotSongSplash()];case 21:return X.sent(),[3,22];case 22:return this.isCheckingPopupDialogs=!1,B.default.i("start do show dialogs finished."),[2]}})})},O.prototype.showDialogs=function(G){return G===void 0&&(G=!1),__awaiter(this,void 0,void 0,function(){var K=this;return __generator(this,function(X){return B.default.i("call show dialogs. isCheckingPopup="+this.isCheckingPopupDialogs),this.isCheckingPopupDialogs||(this.isCheckingPopupDialogs=!0,this.postUpdateTask(function(){K.doShowDialogs(G)})),[2]})})},O.prototype.onMusicLibTabClickCallback=function(G){U.default.report(U.default.ACTION_SHOW,U.default.SOURCE_TAB,0,"",0),this.toMusicLibTab(!1)},O.prototype.toMusicLibTab=function(G){var K=this;G===void 0&&(G=!1),Date.now(),this.mCurrHotTab=G,this.mMusicLibraryPrefb?(this.showMusicLibrary(this.mMusicLibraryPrefb,!1,G),this.mMusicLibraryScript.showNavigator(G)):k.default.load("prefab/MusicLibraryPrefab",function(X,te){Date.now(),K.mMusicLibraryPrefb=te,K.mMusicLibraryScript=K.mMusicLibraryPrefb.getComponent(b.default),K.mMusicLibraryScript.setDialogMgr(K.mDiaogMgr),K.showMusicLibrary(K.mMusicLibraryPrefb,!0,G),K.mMusicLibraryScript.showNavigator(G)})},O.prototype.showMusicLibrary=function(G,K,X){var te=this;Date.now(),Date.now(),_.default.report(0,_.default.ACTION_SHOW_MUSICLIB_TAB),this.mainpage_layout&&(this.mainpage_layout.active=!1),this.hideRankPage(),this.mTopIconPanel.node.active=!1,o.default.read(e.default.HAS_SCORLL_TO_TARGET_POSITION)=="false"&&o.default.save(e.default.HAS_SCORLL_TO_TARGET_POSITION,"true"),Date.now(),this.mMusicLibraryScript.setCloseCallback(function(){G.active=!1,G.x=-1e4,te.mMusicLibraryScript.hideNavigator(),Y.default.Ins().pop("MusicLibrary"),te.onHomeTabClickCallback()}),this.mMusicLibraryScript.setOnLoadCallback(function(){X?(B.default.i("CMPlayShare GameENtranceCenee  TO HOT TAB!!!"),te.mMusicLibraryScript.changePage(b.default.HOT_MUSIC_LIB_INDEX),te.mMusicLibraryScript.setTabBg(b.default.HOT_MUSIC_LIB_INDEX),o.default.save(e.default.HAS_SHOW_MUSIC_RED_SPOT,"true"),te.mMusicLibraryScript.hideRedIcon()):(te.mMusicLibraryScript.changePage(b.default.LEVEL_MUSIC_LIB_INDEX),te.mMusicLibraryScript.setTabBg(b.default.LEVEL_MUSIC_LIB_INDEX)),te.showMusicLibDialogs()}),Date.now(),K?this.mMusicLibrary.addChild(G):(this.mMusicLibraryPrefb.active=!0,this.mMusicLibraryPrefb.x=0,this.mMusicLibraryScript.onStart(),this.mMusicLibraryScript.onShow(),this.mMusicLibraryScript.showNavigator(X)),Y.default.Ins().push("MusicLibrary")},O.prototype.hideMusicPage=function(){this.mMusicLibraryPrefb&&this.mMusicLibraryPrefb.active==1&&(this.mMusicLibraryPrefb.active=!1,this.mMusicLibraryPrefb.x=-1e4,this.mMusicLibraryScript.hideNavigator())},O.prototype.showSongTryToast=function(){s.G.songTryData.songTryFinish=!1,this.showTryFinishToast()},O.prototype.showTryFinishToast=function(){},O.prototype.showToast=function(G){var K=this;k.default.load("prefab/ToastPrefab",function(X,te){te.getComponent(H.default).showTips(G,function(){te.destroy()}),K.player_info_popup_layout.addChild(te)})},O.prototype.isSongTryFinish=function(){return s.G.songTryData&&s.G.songTryData.songTryFinish},O.prototype.startActivityLooper=function(){console.info("[ActivityLooper] HotMusicList startActivityLooper"),this.mActivityLooper==null&&(this.mActivityLooper=new x.default),this.mActivityLooper.start(function(){})},O.prototype.releaseActivityLooper=function(){console.info("[ActivityLooper] HotMusicList releaseActivityLooper"),this.mActivityLooper&&(this.mActivityLooper.release(),this.mActivityLooper=null)},O.prototype.onChange=function(G,K,X,te,ne){this.top_diamond_value_lable.string=""+X,this.top_energy_value_label.string=""+G,this.top_gold_value_lable.string=""+K},O.prototype.toEnergyDialog=function(G){var K=this;k.default.load("prefab/PlayerInfoPopupProfab",function(X,te){var ne=te.getComponent(i.default);ne.setCloseSelfCallback(function(){K.mDiaogMgr.dismissDialog(te)}),ne.playerEnergyBtnClick(G),K.mDiaogMgr.showDialog(te)})},O.prototype.showShareSkin=function(G,K,X){var te=this;ue.default.Ins().show(G,function(ne){ne&&te.mDiaogMgr.showDialog(ne),K&&K()},function(ne){ne&&te.mDiaogMgr.dismissDialog(ne),X&&X()})},O.prototype.goldBtnClick=function(G){var K=this;k.default.load("prefab/PlayerInfoPopupProfab",function(X,te){var ne=te.getComponent(i.default);ne.setCloseSelfCallback(function(){K.mDiaogMgr.dismissDialog(te)}),ne.playerGoldBtnClick(G),K.mDiaogMgr.showDialog(te),console.log("goldBtnClick")})},O.prototype.diamondBtnClick=function(G){var K=this;k.default.load("prefab/PlayerInfoPopupProfab",function(X,te){var ne=te.getComponent(i.default);ne.setCloseSelfCallback(function(){K.mDiaogMgr.dismissDialog(te)}),ne.playerDiamondBtnClick(G),K.mDiaogMgr.showDialog(te),console.log("diamondBtnClick")})},O.prototype.showMusicToast=function(G,K){var X=this,te="";k.default.load("prefab/PlayerInfoPopupProfab",function(ce,fe){var _e=fe.getComponent(i.default);_e.setCloseSelfCallback(function(){X.mDiaogMgr.dismissDialog(fe)}),K[0]=="\u4F53\u529B"?_e.playerEnergyBtnClick(0):K[0]=="\u91D1\u5E01"?_e.playerGoldBtnClick(0):K[0]=="\u94BB\u77F3"&&_e.playerDiamondBtnClick(0),X.mDiaogMgr.showDialog(fe),console.log("goldBtnClick")}),K[0]=="energy"||K[0]=="\u4F53\u529B"?te=he.default.getInstance().getLanguageByKey("label_text.unlock_energy"):K[0]=="coins"||K[0]=="\u91D1\u5E01"?te=he.default.getInstance().getLanguageByKey("label_text.unlock_gold"):K[0]!="diamonds"&&K[0]!="\u94BB\u77F3"||(te=he.default.getInstance().getLanguageByKey("label_text.unlock_diamond"));var ne=K[1];he.default.getInstance().isEnglish()&&K[1]=="\u89E3\u9501"&&(ne="unlock");var ae=he.default.getInstance().getLanguageByKey("label_text.unlock_str_plus"),le=cc.js.formatStr(ae,te,ne);k.default.load("prefab/ToastPrefab",function(ce,fe){fe.getComponent(H.default).showTips(le,function(){fe.destroy()}),X.player_info_popup_layout.addChild(fe)})},O.prototype.showMusicLibUnlockDialog=function(G,K){var X=this;k.default.load("prefab/musiclib/UnlockConfirmDialogPrefab",function(te,ne){var ae=K[0];U.default.report(U.default.ACTION_SHOW_UNLOCK_CONFIRM_DIALOG,0,ae.musicId,ae.musicName,ae.musicType);var le=ne.getComponent(R.default);le.setContent("\u662F\u5426\u82B1\u8D39"+ae.unlockValue+ae.type+'\u6C38\u4E45\u6027\u89E3\u9501\u70ED\u95E8\u795E\u66F2"'+ae.musicName+'"'),le.setCloseCallback(function(){U.default.report(U.default.ACTION_SHOW_UNLOCK_CONFIRM_DIALOG_CLICK_CANCEL,0,ae.musicId,ae.musicName,ae.musicType)}),le.setConfirmCallback(function(){var ce;setTimeout(function(){Se.default.getInstance().isNodeFocus()&&(console.warn("NOTE: \u89E3\u9501\u5B8C\u6B4C\u66F2\uFF0C\u8C03\u7528onPressRight"),Se.default.getInstance().onPressRight())},600),U.default.report(U.default.ACTION_SHOW_UNLOCK_CONFIRM_DIALOG_CLICK_OK,0,ae.musicId,ae.musicName,ae.musicType),ae.type=="\u91D1\u5E01"?(I.MoneySystem.consumeGold(ae.unlockValue),F.default.unlockByGold(ae.levelId,ae.musicId),ie.QQReport.reportUnLockSong(1)):ae.type=="\u94BB\u77F3"&&(Q.default.report(ae.unlockValue,Q.default.SOURCE_BUG_HOTO_MUSIC,Q.default.ACTION_CONSUME_DIAMOND),I.MoneySystem.consumeDiamond(ae.unlockValue),F.default.unlockByDiamond(ae.levelId,ae.musicId),ie.QQReport.reportUnLockSong(1)),f.default.fire(g.default.NOTIFY_MUSIC_LIBRARY_UPDATE,ae.musicId),ae.musicType==U.default.TYPE_ACTIVITY&&f.default.fire(g.default.UPDATE_MUSIC_LIST_HEIGHT,1),ae.type=="\u91D1\u5E01"?ce=U.default.ACTION_GOLD_UNLOCK_SUCC:ae.type=="\u94BB\u77F3"&&(ce=U.default.ACTION_DIAMOND_UNLOCK_SUCC),U.default.report(ce,0,ae.musicId,ae.musicName,ae.musicType),o.default.save(e.default.HOT_SONG_UNLOCKED,"true")}),X.player_info_popup_layout.addChild(ne)})},O.prototype.onDestroy=function(){this.mIsPlayEnergyAnim=!1,d.default.Ins().removeUserListener(this),a.User.UserInfoManager.unRegisterHpReviveListener(this.hpReviveCallback,this),f.default.remove(g.default.HP_NOT_ENOUGH_ITEM_CLICK,this.hpNotEnoughCallback,this),f.default.remove(g.default.HIDE_HOMEPAGE_EVENT_TOP_MASK,this.hideEventStopNode,this),f.default.remove(g.default.SHOW_HOMEPAGE_EVENT_TOP_MASK,this.showEventStopNode,this),f.default.remove(g.default.LIFE_CYCLE_ON_SHOW,this.onShow,this),f.default.remove(g.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,this.showMusicToast,this),f.default.remove(g.default.SHOW_MUSIC_LIB_UNLOCK_DIALOG,this.showMusicLibUnlockDialog,this),f.default.remove(g.default.INVITE_SONG_LOOPER_START,this.startActivityLooper,this),f.default.remove(g.default.INVITE_SONG_LOOPER_STOP,this.releaseActivityLooper,this),f.default.remove(g.default.REWARTDPANEL_SHOW_SKINSTORE,this.toSkinStoreFromAwardPageCallback,this),f.default.remove(g.default.REWARTDPANEL_SHOW_PIECE,this.toSkinStoreFromAwardPageCallback,this),f.default.remove(g.default.SHARE_HOME_SHOW_INVITE_TIPS,this.showInviteTipsPopup,this),f.default.remove(g.default.SPEC_SONG_TRY_SKIN_HOME,this.specSongTrySkin,this),f.default.remove(g.default.LOAD_MUSIC,this.onLoadMusic,this),f.default.remove(g.default.DIAMOND_BUY_TRUMPET_NOT_ENOUGH,this.buyTrumpetDiamondnotEnough,this),f.default.remove(g.default.NEW_GUIDE_GO_CLICK,this.newGuideGoClick,this),this.releaseActivityLooper(),this.mDiaogMgr.destroy(),Z.ToastPopManager.getIns().destroy(),oe.default.Ins().onDestory(),cc.sys.garbageCollect()},O.prototype.buyTrumpetDiamondnotEnough=function(){this.diamondBtnClick(y.default.SOURCE_BUY_TRUMPET_DIAMOND_NOT_ENOUGH)},O.prototype.specSongTrySkin=function(){j.default.trySkinSpecSong(!0,this.player_info_popup_layout)},O.prototype.showInviteTipsPopup=function(){var G=this;this.mDiaogMgr.showPopupDlgDynamic("prefab/shop/DialogOneButtonPrefab",function(K){var X=K.getComponent(q.default);X.setContent("<color=3B5D72><size=30>\u9080\u8BF7\u5DF2\u53D1\u9001\uFF0C\u65B0\u73A9\u5BB6\u70B9\u5165\n\r\u5373\u53EF\u89E3\u9501\uFF01</size></color>"),X.setBtnTxt("\u597D\u7684"),X.setShowClose(!1),X.setBottonCallback(function(te){G.mDiaogMgr.dismissDialog(te)})})},O.prototype.checkShowDailyAttendanceDlg=function(){var G=this;return new Promise(function(K,X){var te=M.DAwardMgr.getIns().needShowDailyPopupDlgToday();B.default.w("checkShowDailyAttendanceDlg \uFF1A needShow "+te),te?M.DAwardMgr.getIns().checkReceiveStatAsyn(function(ne){var ae=M.DAwardMgr.getIns().needShowDailyPopupDlgToday();B.default.w("checkShowDailyAttendanceDlg \uFF1A checkNeedShow again: "+ae),ne&&ae?(M.DAwardMgr.getIns().updateShowDailyPopupDlgTime(),G.showDailyAttendanceDlg(K)):K(!1)}):K(!1)})},O.prototype.showDailyAttendanceDlg=function(G){var K=this;this.mDiaogMgr.showPopupDlgDynamic("prefab/DailyAttendancePrefb",function(X){var te=X.getComponent(E.default);te.setCloseCallback(function(){K.mDiaogMgr.dismissDialog(X),G&&G(!0)}),te.setShowSkinStoreCallbak(function(){return __awaiter(K,void 0,void 0,function(){return __generator(this,function(ne){return this.mDiaogMgr.dismissDialog(X),G&&G(!0),this.showSkinStorePopup(!1),[2]})})}),te.setShowSkinSplashCallbak(function(ne){return __awaiter(K,void 0,void 0,function(){return __generator(this,function(ae){return this.mDiaogMgr.dismissDialog(X),G&&G(!0),[2]})})}),te.setPopupDlgManager(K.mDiaogMgr)})},O.prototype.showSkinStorePopup=function(G,K){var X=this;return new Promise(function(te,ne){k.default.load("prefab/SkinStorePrefab",function(ae,le){var ce=le.getComponent(T.default);ce.setCloseCallback(function(){X.toHomeTab(),X.mSkinStorePrefbNode=null,X.mDiaogMgr.dismissDialog(le),te(!0),X.scheduleOnce(function(){Se.default.getInstance().refreshPage(X.node,"MainPagePrefab")},0)}),ce.setSkinChangeCallback(function(){X.onSkinChange()}),ce.setShareGiftCallback(function(){return __awaiter(X,void 0,void 0,function(){return __generator(this,function(fe){return[2]})})}),ce.setInviteSkinCallback(function(fe,_e,Ae){return X.showInviteSkinDialog(fe,_e,Ae)}),ce.setCMInviteSkinCallback(function(fe){return X.showCMInviteSkinDialog(fe)}),ce.setNormalMusicPageCb(function(){X.toMusicLibTab()}),ce.setGoldNotEnoughCb(function(){X.goldBtnClick(y.default.SOURCE_SKIN_PIECE_GOLD_NOT_ENOUGH)}),X.mSkinStorePrefbNode=le,X.mDiaogMgr.showDialog(le),X.mainpage_layout&&(X.mainpage_layout.active=!1)})})},O.prototype.showInviteSkinDialog=function(G,K,X){return X===void 0&&(X=!1),new Promise(function(te,ne){te(!0)})},O.prototype.showCMInviteSkinDialog=function(G){var K=this;return new Promise(function(X){K.showShareSkin(G,function(){},function(){X(!0)})})},O.prototype.showHotSongSplash=function(){var G=this;return new Promise(function(K,X){if(w.hasShowHotSongSplash)K(!1);else{var te=o.default.read(e.default.SHOW_HOT_SONG_SPLASH_TIMES);te!=null&&te!=""&&te!=null||(te="0");var ne=parseInt(te);2<=ne?K(!1):k.default.load("prefab/musiclib/HotSongSplashPrefab",function(ae,le){var ce=le.getComponent(N.default);ce.setCloseCallback(function(){G.mDiaogMgr.dismissDialog(le),K(!0)}),ce.setPlayImmediatelyCallback(function(){G.mDiaogMgr.dismissDialog(le),K(!0),G.toMusicLibTab(!0),_.default.report(0,_.default.ACTION_HOT_SONG_SPLASH_PLAY)}),G.mDiaogMgr.showDialog(le),w.hasShowHotSongSplash=!0,_.default.report(0,_.default.ACTION_SHOW_HOT_SONG_SPLASH),o.default.save(e.default.SHOW_HOT_SONG_SPLASH_TIMES,ne+1+"")})}})},O.prototype.adaptorUI=function(){S.SUtil.ins().isLiuHai()?(S.SUtil.ins().toTopByPx(this.mTopIconPanel,84),S.SUtil.ins().toTopByPx(this.mAnimHeartLayout,80)):S.SUtil.ins().isQuanMian()?(S.SUtil.ins().toTopByPx(this.mTopIconPanel,33),S.SUtil.ins().toTopByPx(this.mAnimHeartLayout,30)):S.SUtil.ins().isPuTong(),this.mAnimHeartLayout.getComponent(cc.Widget).updateAlignment()},O.prototype.hideRankPage=function(){this.mGlobalRankLayout&&this.mGlobalRankLayout.removeAllChildren()},O.prototype.showEventStopNode=function(){this.mEventStopNode.active=!0,this.mEventStopNode.on(cc.Node.EventType.TOUCH_START,function(G){G.stopPropagationImmediate()},this)},O.prototype.hideEventStopNode=function(){this.mEventStopNode.active=!1},O.prototype.saveLoginGame=function(){},O.prototype.checkSkinPieceInvitee=function(){return this.mCheckActivityRewardProcessor.checksShareForSkinInvitee()},O.prototype.onStart=function(){console.warn("GameEntranceScene::onStart"),f.default.register(g.default.LIFE_CYCLE_ON_SHOW,this.onShow,this),this.hideEventStopNode(),this.mainpage_layout&&this.mainpage_layout.active?(this.mHomePageScriptNode.onStart(),Se.default.getInstance().gotoPage(this.node,"MainPagePrefab","onStart#MainPage")):this.mMusicLibraryPrefb&&this.mMusicLibraryPrefb.active&&(this.mMusicLibraryScript.onStart(),this.mMusicLibraryScript.showNavigator(this.mCurrHotTab),this.isSongTryFinish()&&this.showSongTryToast())},O.prototype.onStop=function(){f.default.remove(g.default.LIFE_CYCLE_ON_SHOW,this.onShow,this),this.mainpage_layout&&this.mainpage_layout.active?this.mHomePageScriptNode.onStop():this.mMusicLibraryPrefb&&this.mMusicLibraryPrefb.active&&(this.mMusicLibraryScript.onStop(),this.mMusicLibraryScript.hideNavigator())},O.prototype.onShow=function(G,K){if(B.default.l("[GameEntranceScene.onShow] enter"),Be.default.mIsRewardVideoPlayed)console.error(">>>>> SKIP onShow for mIsRewardVideoPlayed=true");else if(this.hideEventStopNode(),this.updateToastLayout(),!this.mShowingLittleStarLayout)switch(console.warn("GameEntranceScene => onShow"),w.DefaultPageIndex){case w.GAME_ENTRA_SCENE_INDEX.HOMEPAGE_INDEX:this.toHomeTab();break;case w.GAME_ENTRA_SCENE_INDEX.MUSIC_LIB_INDEX:this.isSongTryFinish()?this.toMusicLibTab(!0):this.toMusicLibTab();break;case w.GAME_ENTRA_SCENE_INDEX.TO_HOT_INDEX:this.toMusicLibTab(!0);break;case w.GAME_ENTRA_SCENE_INDEX.TO_SKIN_PAGE:break;default:this.mMusicLibraryPrefb&&this.mMusicLibraryPrefb.active&&this.mMusicLibraryPrefb.getComponent(b.default).onShow()}},O.prototype.onHide=function(){console.warn("GameEntranceScene => onHide"),this.mainpage_layout&&this.mainpage_layout.active?this.mHomePageScriptNode.onHide():this.mMusicLibraryPrefb&&this.mMusicLibraryPrefb.active&&this.mMusicLibraryScript.onHide()},O.prototype.updateToastLayout=function(){Z.ToastPopManager.getIns().init(this.mToastPopLayout)},O.prototype.onAddDialog=function(G){},O.prototype.onRemoveDialog=function(G){G<=0&&(this.mainpage_layout,this.mHomePageScriptNode&&!this.mShowNewTargetGuide&&this.mHomePageScriptNode.checkTargetIcon(),this.mShowNewTargetGuide=!1)},O.prototype.ShwoSkinStorePrefab=function(G){if(G){var K=G[0];K&&K.skinId?this.showSkinStorePopup(!0,K.skinId):this.showSkinStorePopup(!1)}else this.showSkinStorePopup(!1)},O.prototype.onLoadMusic=function(G,K){var X=this;this.isLoadingMusic||(this.isLoadingMusic=!0,K?s.G.Ap.config.loadMusic(s.G.Ap.state.mission.musicId,function(te){var ne=K[0],ae=v.FromSource.SOURCE_MUSIC;if(ne===0)K[1].decreaseEnergy(1);else if(ne===1){var le=K[1];switch(le.spendType){case r.GameConsume.SPENDTYPE_ENERGY:I.MoneySystem.consumeHp(le.spendEnergy);break;case r.GameConsume.SPENDTYPE_DIAMOND:I.MoneySystem.consumeDiamond(le.spendEnergy);break;case r.GameConsume.SPENDTYPE_GOLD:I.MoneySystem.consumeGold(le.spendEnergy);break;default:I.MoneySystem.consumeHp(le.spendEnergy)}}else ne===2?ae=v.FromSource.SOURCE_SONG_TRY:ne===3?ae=v.FromSource.SOURCE_MAIN:ne==4&&(ae=v.FromSource.SOURCE_RESULT_UPGRADE);if(v.default.getInstance().setFromSource(ae),j.default.needTryInviteSkinSpecSong(s.G.Ap.state.mission.musicId))return f.default.fire(g.default.SPEC_SONG_TRY_SKIN_HOME),void(X.isLoadingMusic=!1);s.G.Ap.presenter.enterScene(s.G.GAME_SCENE_NAME,s.G.Ap.state.mission.musicId,function(){},!0,function(){X.isLoadingMusic=!1})},this.player_info_popup_layout):this.isLoadingMusic=!1)},O.prototype.showLottoryDlg=function(G){var K=this;k.default.load("prefab/lottery/LotteryPrefab",function(X,te){if(te){var ne=me.LotteryProcess.getInstance(),ae=te.getComponent(ye.default);ge.InfocHelper.isNewUser()===1?ne.setNewComing(Te.UserEnum.NEW_COMING):ne.setNewComing(Te.UserEnum.PASS_COMING),ae.init(ne),ae.setCloseCallback(function(){K.mHomePageScriptNode.checkTargetIcon(),K.mDiaogMgr.dismissDialog(te),G&&G(!0),Se.default.getInstance().gotoPage(K.node,"MainPagePrefab")}),K.mDiaogMgr.showDialog(te)}else G&&G(!1)})},O.GAME_ENTRA_SCENE_INDEX={NONE_INDEX:-1,HOMEPAGE_INDEX:1,MUSIC_LIB_INDEX:2,CHALLENGE_INDEX:10,TO_HOT_INDEX:12,TO_FIGHT_INDEX:14,TO_SKIN_PAGE:15},O.DefaultPageIndex=w.GAME_ENTRA_SCENE_INDEX.HOMEPAGE_INDEX,O.hasShowHotSongSplash=!1,O.ENTRANCE_TYPE_NORMAL=1,O.ENTRANCE_TYPE_FROM_HELP_GETTING_DIAMOND=2,O.ENTRANCE_TYPE_FROM_HELP_GETTING_SKIN=4,O.ENTRANCE_TYPE_FROM_HELP_GETTING_SONG=5,O.ENTRANCE_TYPE_FROM_ATTENTION_ENTER=6,O.ENTRANCE_TYPE_FROM_SKIN_PIECE=7,__decorate([se(cc.Button)],O.prototype,"top_energy_value_btn",void 0),__decorate([se(cc.Label)],O.prototype,"top_energy_value_label",void 0),__decorate([se(cc.Button)],O.prototype,"top_glod_value_btn",void 0),__decorate([se(cc.Label)],O.prototype,"top_gold_value_lable",void 0),__decorate([se(cc.Button)],O.prototype,"top_diamond_value_btn",void 0),__decorate([se(cc.Label)],O.prototype,"top_diamond_value_lable",void 0),__decorate([se(cc.Layout)],O.prototype,"mTopIconPanel",void 0),__decorate([se(cc.Layout)],O.prototype,"middle_content_layout",void 0),__decorate([se(cc.Prefab)],O.prototype,"mainpage_layout_preF",void 0),__decorate([se(cc.Node)],O.prototype,"player_info_popup_layout",void 0),__decorate([se(cc.Node)],O.prototype,"mToastPopLayout",void 0),__decorate([se(cc.Node)],O.prototype,"mGlobalPopupContainer",void 0),__decorate([se(cc.Node)],O.prototype,"mAnimHeartLayout",void 0),__decorate([se(cc.Layout)],O.prototype,"mHpTimeGroup",void 0),__decorate([se(cc.Label)],O.prototype,"mHpTimeLabel",void 0),__decorate([se(cc.Node)],O.prototype,"mGlobalRankLayout",void 0),__decorate([se(cc.Button)],O.prototype,"energy_btn",void 0),__decorate([se(cc.Button)],O.prototype,"gold_btn",void 0),__decorate([se(cc.Button)],O.prototype,"diamond_btn",void 0),__decorate([se(cc.Node)],O.prototype,"mEventStopNode",void 0),__decorate([se(cc.Node)],O.prototype,"mMusicLibrary",void 0),__decorate([se(cc.Node)],O.prototype,"mLitteStarNode",void 0),__decorate([se(cc.Node)],O.prototype,"mHeartAnimNode",void 0),O=w=__decorate([Ue],O)}(cc.Component);m.default=He,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Adapter/AdvHelperCMplay":"AdvHelperCMplay","../../../../modules/MGAppShare/scripts/ShareHelper":"ShareHelper","../../../base/CrashMonitor":"CrashMonitor","../../../base/G":"G","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../gamescene/GameSceneSetting":"GameSceneSetting","../../../infoc/InfocHelper":"InfocHelper","../../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../infoc/m_p2_pop_coin":"m_p2_pop_coin","../../../infoc/minigame_piano2_hotmusic":"minigame_piano2_hotmusic","../../../util/PU":"PU","../../../util/PageHeap":"PageHeap","../../../util/QQReport":"QQReport","../../../util/SUtil":"SUtil","../../../util/SceneMusicMgr":"SceneMusicMgr","../../../util/TimeUtil":"TimeUtil","../../Logic/EventBus":"EventBus","../../Logic/I18nManager":"I18nManager","../../Logic/InviteSkinManager":"InviteSkinManager","../../Logic/MoneySystem":"MoneySystem","../../Logic/NotifyEvent":"NotifyEvent","../../Logic/PlayerMgr":"PlayerMgr","../../Logic/Plugin/IPlugin":"IPlugin","../../Logic/Plugin/PluginMgr":"PluginMgr","../../Logic/Plugin/UnlockProcessor":"UnlockProcessor","../../Network/Protocol/StorageUtil":"StorageUtil","../../daily/AttentionUtil":"AttentionUtil","../../daily/DAwardMgr":"DAwardMgr","../../keypad/KeypadNavigator":"KeypadNavigator","../../looper/ActivityLooper":"ActivityLooper","../../lottery/LotteryEnum":"LotteryEnum","../../lottery/LotteryIndex":"LotteryIndex","../../lottery/LotteryProcess":"LotteryProcess","../../music/MusicDownloadProcess":"MusicDownloadProcess","../../shop/DialogOneButtonPrefab":"DialogOneButtonPrefab","../../skin/SkinManager":"SkinManager","../../skin/SkinStore":"SkinStore","../../skin/SkinUtils":"SkinUtils","../../skin/frag/SkinTaskMgr":"SkinTaskMgr","../../task/TaskItem":"TaskItem","../../task/newguidance/NewGuidanceLoader":"NewGuidanceLoader","../MusicLevelDataLoader":"MusicLevelDataLoader","../UserInfoManager":"UserInfoManager","../dailyattendance/DailyAttendancePrefbScript":"DailyAttendancePrefbScript","../playerInfoPopup/PlayerInfoPopupProfab":"PlayerInfoPopupProfab","./BasicTouchEvent":"BasicTouchEvent","./CheckRewardProcessor":"CheckRewardProcessor","./HomePagePrefb":"HomePagePrefb","./MusicLib/HotMusicCMShareController":"HotMusicCMShareController","./MusicLib/HotSongSplash":"HotSongSplash","./MusicLib/MusicLibraryManager":"MusicLibraryManager","./MusicLib/UnlockConfirmDialogPrefab":"UnlockConfirmDialogPrefab","./PopupDlg":"PopupDlg","./PrefabMgr":"PrefabMgr","./ToastPopManager":"ToastPopManager","./ToastPrefab":"ToastPrefab","./mainpage/ShareSkinController":"ShareSkinController"}],GameInfoMgr:[function(l,P,m){"use strict";cc._RF.push(P,"c6edaOB5A9J345snFl4pUm2","GameInfoMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){};m.GameInfo=d;var s=function(){function r(){this.mGameInfo=void 0;var o=new d;o.appid="wx3ff4ef6cb6e496a4",o.version="1.2.7.106",o.gameid=6001,o.resPath="res/1.2.7.59/res-20190107213343.json",o.skinPath="https://piano-weixin-game.cmcm.com/pianotiles2/skin/skin-201807161424.json",o.platform=CMPlay.isCMPlay()?"cmplay":"",o.resCDN="https://piano-weixin-game.cmcm.com/pianotiles2/",o.skinCDN="https://piano-weixin-game.cmcm.com/pianotiles2/",this.mGameInfo=o}return r.Ins=function(){return r.mInstance||(r.mInstance=new r),r.mInstance},r.prototype.getInfo=function(){return this.mGameInfo},r.mInstance=null,r}();m.GameInfoMgr=s,cc._RF.pop()},{}],GameInterface:[function(l,P,m){"use strict";cc._RF.push(P,"7ba1bFkt1xJQr2290xzQCxd","GameInterface"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],GameItemsData:[function(l,P,m){"use strict";cc._RF.push(P,"aaf029BAJJCBaXX9ZDqQu24","GameItemsData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("item_id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.GameItemsDatas=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getString("id")},e.prototype.getItemId=function(){return this.getString("item_id")},e.prototype.getName=function(){return this.getString("name")},e.prototype.getKey=function(){return this.getString("key")},e.prototype.getPic=function(){return this.getString("pic")},e.prototype.getSmallPic=function(){return this.getString("small_pic")},e.prototype.getEffect=function(){return this.getString("effect")},e.prototype.getDescribe=function(){return this.getString("desc")},e.prototype.getBuyType=function(){return this.getString("buytype")},e.prototype.getBuyPrice=function(){return this.getString("buyprice")},e}(d.default);m.GameItemsRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],GameItemsManager:[function(l,P,m){"use strict";cc._RF.push(P,"3c5edUR5glEnqSZ0d0wSf6g","GameItemsManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=l("../../base/Log"),r=l("../../business/Logic/I18nManager"),o=function(){function t(){}return t.ID_DIAMOND="1-1-0",t.ID_GOLD="2-1-0",t.ID_POWER="3-1-0",t.ID_TICKET="7-1-0",t.ID_VIP_1="8-1-0",t.ID_SKIN_DEFAULT="5-1-0",t.ID_SKIN_ICE="5-2-0",t.ID_PIECE_ICE="5-2-99",t.ID_SKIN_SAKURA="5-3-0",t.ID_PIECE_SAKURA="5-3-99",t.ID_SKIN_WORLDCUP0="5-4-0",t.ID_SKIN_WORLDCUP1="5-4-1",t.ID_SKIN_WORLDCUP2="5-4-2",t.ID_SKIN_WORLDCUP3="5-4-3",t.ID_PIECE_WORLDCUP="5-4-99",t.ID_SKIN_GREENWILD="5-5-0",t.ID_PIECE_GREENWILD="5-5-99",t.ID_SKIN_GIRL0="5-6-0",t.ID_SKIN_GIRL1="5-6-1",t.ID_SKIN_GIRL2="5-6-2",t.ID_SKIN_GIRL3="5-6-3",t.ID_PIECE_GIRL="5-6-99",t.ID_SKIN_STARS0="5-7-0",t.ID_SKIN_STARS1="5-7-1",t.ID_SKIN_STARS2="5-7-2",t.ID_SKIN_STARS3="5-7-3",t.ID_PIECE_STARS="5-7-99",t.ID_SKIN_CANDY0="5-8-0",t.ID_SKIN_CANDY1="5-8-1",t.ID_SKIN_CANDY2="5-8-2",t.ID_SKIN_CANDY3="5-8-3",t.ID_PIECE_CANDY="5-8-99",t.ID_SKIN_AFTERRAIN="5-9-0",t.ID_PROP_DASH="6-1-0",t.ID_PROP_SLOW="6-2-0",t.ID_PROP_SHIELD="6-3-0",t}();m.GameItemsDefine=o;var e=function(){function t(){}return t.TYPE_UNKOWN=0,t.TYPE_PIECE=1,t.TYPE_SKIN=2,t.TYPE_DIAMONDS=3,t.TYPE_GOLD=4,t.TYPE_HP=5,t.TYPE_TICKET=6,t.TYPE_PROP=7,t.TYPE_VIP=8,t.TYPE_TONE=10,t}();m.GameItemType=e;var n=function(){function t(){this.items=d.default.Ins().getDBRows(d.eDataBase.eDB_GameItems)}return t.getPropPlistPath=function(){return r.default.getInstance().isEnglish()?t.PROP_PLIST_PATH_EN:t.PROP_PLIST_PATH},t.getIns=function(){return t.mInstance||(t.mInstance=new t),t.mInstance},t.prototype.getAllItems=function(){return this.items},t.prototype.getItemTypeByItemId=function(i){try{var a=i.split("-");if(a&&a.length==3){var u=e.TYPE_UNKOWN;switch(a[0]){case"1":u=e.TYPE_DIAMONDS;break;case"2":u=e.TYPE_GOLD;break;case"3":u=e.TYPE_HP;break;case"4":break;case"5":u=e.TYPE_SKIN;break;case"7":u=e.TYPE_TICKET;break;case"6":u=e.TYPE_PROP;break;case"8":u=e.TYPE_VIP;break;case"9":u=e.TYPE_PIECE;break;case"10":u=e.TYPE_TONE}return u}}catch(c){s.default.e(c)}return e.TYPE_UNKOWN},t.prototype.isDiamondsType=function(i){return this.getItemTypeByItemId(i)==e.TYPE_DIAMONDS},t.prototype.isGoldType=function(i){return this.getItemTypeByItemId(i)==e.TYPE_GOLD},t.prototype.isHPType=function(i){return this.getItemTypeByItemId(i)==e.TYPE_HP},t.prototype.isSkinType=function(i){return this.getItemTypeByItemId(i)==e.TYPE_SKIN},t.prototype.isTicketType=function(i){return this.getItemTypeByItemId(i)==e.TYPE_TICKET},t.prototype.isPropType=function(i){return this.getItemTypeByItemId(i)==e.TYPE_PROP},t.prototype.isToneType=function(i){return this.getItemTypeByItemId(i)==e.TYPE_TONE},t.prototype.getItemTimeLimitDay=function(i){try{var a=i.split("-");if(a&&a.length==3)return parseInt(a[2])}catch(u){s.default.e(u)}return 0},t.prototype.getItemNameSplitTime=function(i){try{var a=d.default.Ins().getDBRow(d.eDataBase.eDB_GameItems,i).getName().split("\uFF08");if(a&&0<a.length)return a[0]}catch(u){s.default.e(u)}return""},t.prototype.getItemById=function(i){for(var a=0;a<this.items.length;a++)if(this.items[a].getItemId()==i)return this.items[a];return null},t.prototype.getItemIDByIndexID=function(i){for(var a=0;a<this.items.length;a++)if(this.items[a].getId()==i.toString())return this.items[a].getItemId();return null},t.prototype.getSmallPicByItemId=function(i){return d.default.Ins().getDBRow(d.eDataBase.eDB_GameItems,i).getSmallPic()},t.prototype.getBigPicByItemId=function(i){return d.default.Ins().getDBRow(d.eDataBase.eDB_GameItems,i).getPic()},t.prototype.getSkinNameByItemId=function(i){var a="";if(this.isSkinType(i))try{var u=i.split("-");if(u&&u.length==3)switch(u[1]){case"1":a="\u9ED8\u8BA4\u76AE\u80A4";break;case"2":a="\u51B0\u96EA\u5947\u5E7B";break;case"3":a="\u6A31\u82B1\u6811\u4E0B";break;case"4":a="\u4E16\u754C\u676F";break;case"5":a="\u7EFF\u91CE\u4ED9\u8E2A";break;case"4":a="\u5143\u6C14\u5C11\u5973";break;case"7":a="\u661F\u7A7A\u73AF\u6E38"}}catch(c){s.default.e(c)}return a},t.prototype.getSkinItemIdByName=function(i){if(this.items&&0<this.items.length){var a=this.items.filter(function(u){return u.getName()==i});if(a&&0<a.length)return a[0].getItemId()}return""},t.PROP_PLIST_PATH="static_res/gamestore",t.PROP_PLIST_PATH_EN="static_res/gamestore_en",t}();m.GameItemsManager=n,cc._RF.pop()},{"../../base/Log":"Log","../../business/Logic/I18nManager":"I18nManager","../DB/DBMgr":"DBMgr"}],GameMapGuide:[function(l,P,m){"use strict";cc._RF.push(P,"86f84Jhi5JN86WmCznAVfo6","GameMapGuide"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=l("../../util/Dictionary"),r=l("../../base/G"),o=l("../../util/PU");(function(e){var n=function(i,a){i===void 0&&(i=-1),a===void 0&&(a=-1),this.segmentIndex=-1,this.blockIndex=-1,this.touchHeight=0,this.inClickableRegion=!0,this.segmentIndex=i,this.blockIndex=a};e.Location=n;var t=function(){function i(){this.map=null,this.mTouchLocations=new s.Dictionary}return i.prototype.looseDetectClick=function(a,u,c,p){var h=this.getSegment(a);if(h==null)return null;var f=null,g=p.x-h.rect.x,_=p.y-h.rect.y+this.map.move;if(-u<=_){if(_<=h.rect.height+c){(f=new n).segmentIndex=a;for(var y=r.G.Ap.config.blockHorizonExtend,S=0,I=h.blocks.length;S<I;++S)if(g>=(C=(v=h.blocks[S]).rect).x-y&&g<=C.xMax+y){f.blockIndex=S,v.type==d.Utility.BLOCKTYPE.LONG?f.touchHeight=Math.max(_-C.y-120*r.G.Ap.config.mBaseBlockHeightScale,0):d.Utility.BLOCKTYPECHARACTER.c[v.type].accurate&&_>C.yMax+c&&(f.inClickableRegion=!1);break}}else if(o.default.is3DTouchCompat()&&_<=h.rect.height+r.G.Ap.config.mBaseBlockHeight){(f=new n).segmentIndex=a;var v=null;for(S=0,I=h.blocks.length;S<I;++S)if(h.blocks[S].slotIndex===0){v=h.blocks[S];break}if(v){var C=v.rect;y=r.G.Ap.config.blockHorizonExtend,g>=C.x-y&&g<=C.xMax+y&&(f.blockIndex=0,v.type==d.Utility.BLOCKTYPE.LONG&&(f.touchHeight=Math.max(_-C.y-120*r.G.Ap.config.mBaseBlockHeightScale,0)))}}}return f},i.prototype.looseDetectClickBlockIgnoreY=function(a,u){var c=this.getSegment(a);if(c==null)return-1;for(var p=r.G.Ap.config.blockHorizonExtend,h=u.x-c.rect.x,f=0,g=c.blocks.length;f<g;++f){var _=c.blocks[f].rect;if(h>=_.x-p&&h<=_.xMax+p)return f}return-1},i.prototype.calcTouchBlockLocation=function(a){var u=this.calcSegmentIndex(a);if(u===-1)return null;var c=new n;c.segmentIndex=u;for(var p=r.G.Ap.config.blockHorizonExtend,h=this.map.segments[c.segmentIndex],f=a.x-h.rect.x,g=a.y+this.map.move-h.rect.y,_=0,y=h.blocks.length;_<y;++_){var S=h.blocks[_].rect;if(f>=S.x-p&&f<=S.xMax+p&&g>=S.y&&g<=S.yMax){c.blockIndex=_;break}}return c},i.prototype.calcTouchVirtualBlockRect=function(a){var u=this.calcSegmentIndex(a);if(u===-1)return null;var c=this.map.segments[u].rect,p=this.map.params.slotCount,h=this.map.params.slotWidth,f=Math.floor(a.x/h);return new d.Utility.Rect(c.x+Math.min(f,p-1)*h,c.y,h,c.height)},i.prototype.calcSegmentIndex=function(a){a.x;for(var u=a.y+this.map.move,c=this.map.bottom,p=this.map.top-1,h=-1;!(p<c);){var f=Math.floor((c+p)/2),g=this.map.segments[f];if(g.rect.y>u)p=f-1;else{if(!(g.rect.yMax<u)){h=f;break}c=f+1}}return h},i.prototype.getSegment=function(a){return this.map.segments[a]},i.prototype.getBlock=function(a){return this.getBlockByIndex(a.segmentIndex,a.blockIndex)},i.prototype.getBlockByIndex=function(a,u){var c=this.map.segments[a];return c==null||u<0||u>=c.blocks.length?null:c.blocks[u]},i.prototype.restoreMap=function(){this.map.move=0,this.map.bottom=0;for(var a=this.map.top=0;a<this.map.segments.length;++a)for(var u=this.map.segments[a],c=0;c<u.blocks.length;++c){var p=u.blocks[c];p.touchCount=0,p.touchId=-1,p.added=!1,p.touchMove=0}this.mTouchLocations.clear()},i.prototype.addTouch=function(a,u){this.mTouchLocations.put(a,u)},i.prototype.getTouch=function(a){return this.mTouchLocations.get(a)},i.prototype.removeTouch=function(a){this.mTouchLocations.remove(a)},i.prototype.clearTouchs=function(){this.mTouchLocations.clear()},i.prototype.getTouchs=function(){return this.mTouchLocations.getPairs()},i.prototype.getStartBlockRect=function(){return this.getSegment(0).blocks[0].rect},i}();e.Guide=t})(m.GameMap||(m.GameMap={})),cc._RF.pop()},{"../../base/G":"G","../../util/Dictionary":"Dictionary","../../util/PU":"PU","../../util/Utility":"Utility"}],GameModuleManager:[function(l,P,m){"use strict";cc._RF.push(P,"c4930VOWfVGypi339sIFiFg","GameModuleManager"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("./OvertakeFriendModule"),o=l("./QQRedPacketModule");(s=d=m.ModuleType||(m.ModuleType={}))[s.Overtake_Friend=0]="Overtake_Friend",s[s.QQ_Red_Packet=1]="QQ_Red_Packet";var e=function(){function n(){this.mModuleMap=new Map}return n.prototype.setEnableModuleList=function(t){t&&(this.mLoadList=new Set(t))},n.prototype.loadAllModules=function(){var t=this;this.mLoadList&&this.mLoadList.forEach(function(i){var a=t.getOrCreateModule(i);a&&a.load()})},n.prototype.destroyAllModules=function(){this.mModuleMap.forEach(function(t,i,a){t.destroy()}),this.mModuleMap.clear()},n.prototype.prepareAllModules=function(){this.mModuleMap.forEach(function(t,i,a){t.prepare()})},n.prototype.startAllModules=function(){this.mModuleMap.forEach(function(t,i,a){t.start()})},n.prototype.pauseAllModules=function(){this.mModuleMap.forEach(function(t,i,a){t.pause()})},n.prototype.resumeAllModules=function(){this.mModuleMap.forEach(function(t,i,a){t.resume()})},n.prototype.addAllModulesToRootNode=function(t,i){i===void 0&&(i=!1),this.mModuleMap.forEach(function(a,u,c){var p=a.getUINode();p&&(t.addChild(p),p.setVisible(i))})},n.prototype.getModule=function(t){return this.mLoadList&&this.mLoadList.has(t)?this.getOrCreateModule(t):null},n.prototype.getOrCreateModule=function(t){var i=this.mModuleMap.get(t);return i||(i=this.createModule(t))&&this.mModuleMap.set(t,i),i},n.prototype.createModule=function(t){var i=null;switch(t){case d.Overtake_Friend:i=new r.default;break;case d.QQ_Red_Packet:i=new o.default}return i},n}();m.default=e,cc._RF.pop()},{"./OvertakeFriendModule":"OvertakeFriendModule","./QQRedPacketModule":"QQRedPacketModule"}],GameOverHotSongItem:[function(l,P,m){"use strict";cc._RF.push(P,"57d51nVAa9CFqdsMIlXa4F6","GameOverHotSongItem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/MusicLevelDataLoader"),s=l("../UI/GameEntraScene/BasicTouchEvent"),r=l("../Logic/Level"),o=l("../reward/ActivityBean"),e=l("../../util/StringUtil"),n=l("../../infoc/m_p2_HMusic_laxin"),t=l("../Logic/EventBus"),i=l("../Logic/NotifyEvent"),a=l("../../../modules/MGAppShare/scripts/MGShareUtil"),u=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),c=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),p=l("../../util/PU"),h=l("../common/BusinessUtil"),f=l("../Logic/Plugin/UnlockProcessor"),g=l("../UI/GameEntraScene/MusicLib/HotMusicCMShareController"),_=cc._decorator,y=_.ccclass,S=_.property,I=function(v){function C(){var T=v!==null&&v.apply(this,arguments)||this;return T.title_label=null,T.describe_label=null,T.invite_btn=null,T.invite_label=null,T.start_Layout=null,T.start_label=null,T.cm_invite_btn=null,T}return __extends(C,v),C.prototype.setStartGameCallback=function(T){this.startGameCallback=T},C.prototype.onLoad=function(){var T=this;this.inviteClickCallbak=new s.default(function(){T.inviteBtnClick()}),this.invite_btn.node.on(cc.Node.EventType.TOUCH_END,this.inviteClickCallbak.click,this.inviteClickCallbak),t.default.register(i.default.NOTIFY_MUSIC_LIBRARY_UPDATE,this.refreshData,this)},C.prototype.start=function(){},C.prototype.onDestroy=function(){t.default.remove(i.default.NOTIFY_MUSIC_LIBRARY_UPDATE,this.refreshData,this)},C.prototype.inviteBtnClick=function(){var T=this;if(this.mItemInfo.isLocked)if(p.default.supportCMOnshare())this.inviteCMFriendBtnClickCallback();else{var E=u.ADScene.SOURCE_HOTMUSIC_UNLOCK;c.MGAdv.show(E,u.QQ_ADV_TYPE.VIDEO_TYPE_HOTMUSIC_UNLOCK,function(A){switch(A){case u.ADStat.NOT_NETWORK:h.default.getIns().showToastTips("No network available",T.node,null,!0);break;case u.ADStat.SHOW_SUCCESS_CLOSE:f.default.unlockByVideo(T.mItemInfo.id,T.mItemInfo.musicId);break;case u.ADStat.SHOW_NOT_ENED_CLOSE:break;case u.ADStat.SHOW_GET_AD_FAILED:h.default.getIns().showToastTips("No video ads available",T.node,null,!0)}}),n.default.report(n.default.SOURCE_GAMEOVER,n.default.ACTION_CLICK_INVITE_FRIEND,""+this.mItemInfo.musicId)}else this.startGameCallback&&this.startGameCallback(this.mItemInfo)},C.prototype.inviteCMFriendBtnClickCallback=function(){g.default.Ins().saveItemInfo(this.mItemInfo),a.MGShareUtils.shareForInviteSong("playerId",o.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG+"_"+this.mItemInfo.musicId,this.mItemInfo.musicId,this.mItemInfo.musicName,this.mItemInfo.id,function(T){T&&t.default.fire(i.default.SHARE_HOME_SHOW_INVITE_TIPS)})},C.prototype.refreshData=function(T,E){if(E[0]==this.mItemInfo.musicId){var A=d.MusicLevelDataLoader.getItemInfoByMid(this.mItemInfo.musicId);this.setData(A,this.itemID)}},C.prototype.setData=function(T,E){this.itemID=E,T!=null?(this.mItemInfo=T,this.node.active=!0,this.title_label.string=e.StringUtil.getFixedlengthStr(T.musicName,16),T.isLocked?(p.default.supportCMOnshare()?this.cm_invite_btn.active=!0:this.invite_label.active=!0,this.start_Layout.active=!1):(this.cm_invite_btn.active=!1,this.invite_label.active=!1,this.start_Layout.active=!0,T.mGameComsume.spendType==d.GameConsume.SPENDTYPE_ENERGY?this.start_label.string=T.mGameComsume.spendEnergy+"\u5F00\u59CB":this.start_label.string="\u5F00\u59CB"),T.unlockType.unlockType==r.eUnlockType.UNLOCK_TYPE_DIAMOND?this.describe_label.string=cc.js.formatStr("\u4EF7\u503C%s\u94BB\u77F3",T.unlockType.unlockValue):this.describe_label.string=""):this.node.active=!1},__decorate([S(cc.Label)],C.prototype,"title_label",void 0),__decorate([S(cc.Label)],C.prototype,"describe_label",void 0),__decorate([S(cc.Button)],C.prototype,"invite_btn",void 0),__decorate([S(cc.Node)],C.prototype,"invite_label",void 0),__decorate([S(cc.Node)],C.prototype,"start_Layout",void 0),__decorate([S(cc.Label)],C.prototype,"start_label",void 0),__decorate([S(cc.Node)],C.prototype,"cm_invite_btn",void 0),C=__decorate([y],C)}(cc.Component);m.default=I,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../infoc/m_p2_HMusic_laxin":"m_p2_HMusic_laxin","../../util/PU":"PU","../../util/StringUtil":"StringUtil","../Logic/EventBus":"EventBus","../Logic/Level":"Level","../Logic/NotifyEvent":"NotifyEvent","../Logic/Plugin/UnlockProcessor":"UnlockProcessor","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/MusicLib/HotMusicCMShareController":"HotMusicCMShareController","../UI/MusicLevelDataLoader":"MusicLevelDataLoader","../common/BusinessUtil":"BusinessUtil","../reward/ActivityBean":"ActivityBean"}],GameOverHotSongShare:[function(l,P,m){"use strict";cc._RF.push(P,"e0ca1uMAE1Ot4eZoHsBSL1G","GameOverHotSongShare"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../util/SUtil"),s=l("../../../../util/PU"),r=l("../BasicTouchEvent"),o=l("../../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=l("../../../../../modules/MGAppShare/scripts/MGShareUtil"),n=l("../../../Logic/EventBus"),t=l("../../../Logic/NotifyEvent"),i=l("../../../reward/ActivityBean"),a=l("../../../../infoc/m_p2_HMusic_laxin"),u=cc._decorator,c=u.ccclass,p=u.property,h=function(f){function g(){var _=f!==null&&f.apply(this,arguments)||this;return _.musicNameLabel=null,_.shareBtn=null,_.cancelBtn=null,_.content=null,_.shareBtnPanel=null,_.diamondCount=null,_.top=null,_.mShareClickCallback=null,_.mCloseClickCallback=null,_.completeFunc=null,_}return __extends(g,f),g.prototype.start=function(){this.adaptorUI(),this.initEvents();var _=this.shareBtn.getComponent(cc.Animation);this.musicNameLabel.string="\u300A"+this.mMusicName+"\u300B",this.diamondCount.string=this.mUnlockDiamond+"",_.play("fluent_btn_bigger"),a.default.report(a.default.SOURCE_HOT_MUSIC_RESULT,a.default.ACTION_SHOW,"0")},g.prototype.initEvents=function(){var _=this;this.node.on(cc.Node.EventType.TOUCH_START,function(y){y.stopPropagation()}),this.node.on(cc.Node.EventType.TOUCH_START,function(y){y.stopPropagationImmediate()},this),this.mShareClickCallback=new r.default(function(){_.onShareClick()}),this.shareBtn.node.on(cc.Node.EventType.TOUCH_END,this.mShareClickCallback.click,this.mShareClickCallback),this.mCloseClickCallback=new r.default(function(){_.onCloseClick()}),this.cancelBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback)},g.prototype.onShareClick=function(){this.shareForHotSongGift(),this.completeFunc(),a.default.report(a.default.SOURCE_HOT_MUSIC_RESULT,a.default.ACTION_CLICK_TO_HOT_SONG,"0")},g.prototype.onCloseClick=function(){this.completeFunc(),a.default.report(a.default.SOURCE_HOT_MUSIC_RESULT,a.default.ACTION_CLICK_CLOSE,"0")},g.prototype.shareForHotSongGift=function(){var _=this;o.MGUser.getUserLoginInfo({complete:function(y){y&&e.MGShareUtils.shareForInviteSong(y.playerId,i.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG+_.mMusicMid,_.mMusicMid,_.mMusicName,_.mLevelId,function(S){S&&n.default.fire(t.default.SHARE_RESULT_SHOW_INVITE_TIPS)}),n.default.fire(t.default.INVITE_SONG_LOOPER_START)}})},g.prototype.setData=function(_,y,S,I,v,C,T){this.mMusicMid=_,this.mLevelId=y,this.mMusicName=S,this.mCurrentScore=I,this.mBestScore=v,this.mMusicGrade=C,this.mUnlockDiamond=T},g.prototype.setCompleteFunc=function(_){_&&(this.completeFunc=_)},g.prototype.adaptorUI=function(){s.default.isQQ()?d.SUtil.ins().isLiuHai()?(d.SUtil.ins().setNodeWidgetToTop(this.content,18.9),d.SUtil.ins().setNodeWidgetToTop(this.musicNameLabel,16.9),d.SUtil.ins().setNodeWidgetToTop(this.shareBtnPanel,74.3),d.SUtil.ins().setNodeWidgetToTop(this.cancelBtn,83.4)):d.SUtil.ins().isQuanMian()&&(d.SUtil.ins().setNodeWidgetToTop(this.content,16.3),d.SUtil.ins().setNodeWidgetToTop(this.musicNameLabel,14.5),d.SUtil.ins().setNodeWidgetToTop(this.shareBtnPanel,76.6),d.SUtil.ins().setNodeWidgetToTop(this.cancelBtn,86.5)):(s.default.isWeiXin()||s.default.isWeb())&&(d.SUtil.ins().isLiuHai()?(d.SUtil.ins().toTopByPx(this.content,304),d.SUtil.ins().toTopByPx(this.shareBtnPanel,1152),d.SUtil.ins().toTopByPx(this.cancelBtn,1319),d.SUtil.ins().toTopByPx(this.top,182.5)):d.SUtil.ins().isQuanMian()&&(d.SUtil.ins().toTopByPx(this.content,245),d.SUtil.ins().toTopByPx(this.shareBtnPanel,1060),d.SUtil.ins().toTopByPx(this.cancelBtn,1227)))},__decorate([p(cc.Label)],g.prototype,"musicNameLabel",void 0),__decorate([p(cc.Button)],g.prototype,"shareBtn",void 0),__decorate([p(cc.Label)],g.prototype,"cancelBtn",void 0),__decorate([p(cc.Sprite)],g.prototype,"content",void 0),__decorate([p(cc.Node)],g.prototype,"shareBtnPanel",void 0),__decorate([p(cc.Label)],g.prototype,"diamondCount",void 0),__decorate([p(cc.Node)],g.prototype,"top",void 0),g=__decorate([c],g)}(cc.Component);m.default=h,cc._RF.pop()},{"../../../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../../infoc/m_p2_HMusic_laxin":"m_p2_HMusic_laxin","../../../../util/PU":"PU","../../../../util/SUtil":"SUtil","../../../Logic/EventBus":"EventBus","../../../Logic/NotifyEvent":"NotifyEvent","../../../reward/ActivityBean":"ActivityBean","../BasicTouchEvent":"BasicTouchEvent"}],GameOverHotSong:[function(l,P,m){"use strict";cc._RF.push(P,"79902U8cwRD/58y1H0XV0hA","GameOverHotSong"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../UI/MusicLevelDataLoader"),r=l("../../util/Dictionary"),o=l("./GameOverHotSongItem"),e=l("../../infoc/m_p2_HMusic_laxin"),n=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),t=l("../../util/PU"),i=l("../UI/GameEntraScene/ImgCache"),a=cc._decorator,u=a.ccclass,c=a.property,p=function(h){function f(){var g=h!==null&&h.apply(this,arguments)||this;return g.close_btn=null,g.bg_sprite=null,g.scrollView=null,g.spawnCount=0,g.spacing=0,g.bufferZone=0,g.mItemPrefab=null,g.mCloseClickCallback=null,g.mContent=null,g.itemTemplate=null,g.items=[],g.mRealIndex=[],g.itemHeight=122,g.lastContentPosY=0,g.mItemUnlockCount=new r.Dictionary,g.mInitDataFinish=!1,g}return __extends(f,h),f.prototype.setStartGameCallback=function(g){this.startGameCallback=g},f.prototype.setCloseCallback=function(g){this.closeCallback=g},f.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(g){g.stopPropagation()}),this.mContent=this.scrollView.content,this.initEvent(),this.initBg(),this.mItemInfos=s.MusicLevelDataLoader.getValidActiveInfo(n.MGUser.getCurrentServerTime()),this.initializeScrollView(),e.default.report(e.default.SOURCE_GAMEOVER,e.default.ACTION_SHOW,"0")},f.prototype.start=function(){},f.prototype.onDestroy=function(){},f.prototype.initEvent=function(){var g=this;this.mCloseClickCallback=new d.default(function(){g.closeClick()}),this.close_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback)},f.prototype.initBg=function(){var g=this;t.default.supportCMOnshare()&&i.default.get("/static_res/gameover/hot_song_invite_bg.png",function(_,y){y&&(g.bg_sprite.getComponent(cc.Sprite).spriteFrame=y)})},f.prototype.closeClick=function(){this.closeCallback&&this.closeCallback(),e.default.report(e.default.SOURCE_GAMEOVER,e.default.ACTION_CLICK_CLOSE,"0")},f.prototype.initializeScrollView=function(){var g=this;this.itemTemplate=cc.instantiate(this.mItemPrefab);var _=this.mItemInfos.length*(this.itemHeight+this.spacing);this.mContent.height=_;for(var y=Math.min(this.mItemInfos.length,this.spawnCount),S=0;S<y;S++){var I=cc.instantiate(this.itemTemplate),v=I.getComponent(o.default);v.setData(this.mItemInfos[S],S),v.setStartGameCallback(function(C){g.startGameCallback&&g.startGameCallback(C)}),I.setPosition(0,-(S*(this.itemHeight+this.spacing)+this.spacing)),this.mContent.addChild(I),this.mRealIndex.push(S),this.items.push(I)}},f.prototype.scrollEvent=function(g,_){switch(_){case 0:case 1:case 2:case 3:break;case 4:this.updateByScroll()}},f.prototype.updateByScroll=function(){var g,_,y,S,I,v,C,T,E,A=this.items,M=this.bufferZone;if(this.mContent.y<this.lastContentPosY)for(var k=this.mRealIndex.length-1;0<=k&&(E=A[this.mRealIndex[k]],g=A[this.mRealIndex[0]],(_=this.getPositionInView(E)).y<-M&&g.y+this.spacing+E.height<0);k--)y=(T=E.getComponent(o.default)).itemID-this.spawnCount,T.setData(this.mItemInfos[y],y),S=this.mRealIndex.pop(),this.mRealIndex.unshift(S),E.setPosition(0,g.y+this.spacing+this.itemHeight),k++;else for(k=0;k<this.mRealIndex.length&&(E=A[this.mRealIndex[k]],I=A[this.mRealIndex[this.mRealIndex.length-1]],_=this.getPositionInView(E),v=this.itemHeight,_.y>M&&I.y-v-this.spacing>-this.mContent.height);k++)y=(T=E.getComponent(o.default)).itemID+this.spawnCount,T.setData(this.mItemInfos[y],y),C=this.mRealIndex.shift(),this.mRealIndex.push(C),E.setPosition(0,I.y-v-this.spacing),k--;this.lastContentPosY=this.mContent.y},f.prototype.getPositionInView=function(g){var _=g.parent.convertToWorldSpaceAR(g.position);return this.scrollView.node.convertToNodeSpaceAR(_)},__decorate([c(cc.Button)],f.prototype,"close_btn",void 0),__decorate([c(cc.Sprite)],f.prototype,"bg_sprite",void 0),__decorate([c(cc.ScrollView)],f.prototype,"scrollView",void 0),__decorate([c],f.prototype,"spawnCount",void 0),__decorate([c],f.prototype,"spacing",void 0),__decorate([c],f.prototype,"bufferZone",void 0),__decorate([c(cc.Prefab)],f.prototype,"mItemPrefab",void 0),f=__decorate([u],f)}(cc.Component);m.default=p,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../infoc/m_p2_HMusic_laxin":"m_p2_HMusic_laxin","../../util/Dictionary":"Dictionary","../../util/PU":"PU","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/MusicLevelDataLoader":"MusicLevelDataLoader","./GameOverHotSongItem":"GameOverHotSongItem"}],GameOverInviteSKin:[function(l,P,m){"use strict";cc._RF.push(P,"7aaf8NFDt9GQKZrLdP0SuXH","GameOverInviteSKin"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../reward/ActivityBean"),s=l("../UI/GameEntraScene/BasicTouchEvent"),r=l("../reward/ActivityRewardManager"),o=l("../Logic/SkinDataManager"),e=l("../UI/GameEntraScene/ImgCache"),n=l("../../base/Log"),t=l("../Logic/EventBus"),i=l("../Logic/NotifyEvent"),a=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),u=l("../../social/AvatarUtil"),c=l("../../../modules/MGAppShare/scripts/MGShareUtil"),p=cc._decorator,h=p.ccclass,f=p.property,g=function(_){function y(){var S=_!==null&&_.apply(this,arguments)||this;return S.invite_fds_btn=null,S.close_btn=null,S.invite_count_text=null,S.avatar_sprite1=null,S.mask_layout1=null,S.avatar_sprite2=null,S.mask_layout2=null,S.avatar_sprite3=null,S.mask_layout3=null,S.invite_count_layout=null,S.newUserCount=0,S.mCloseBtnClickCallback=null,S.mInviteFdsBtnClickCallback=null,S}return __extends(y,_),y.prototype.setCloseCallback=function(S){this.mCloseCallback=S},y.prototype.setInvitefdsCallback=function(S){this.mInviteFdsCallback=S},y.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(S){S.stopPropagation()}),this.initEvent(),this.initData()},y.prototype.initEvent=function(){var S=this;this.mCloseBtnClickCallback=new s.default(function(){S.closeBtnClick()}),this.close_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseBtnClickCallback.click,this.mCloseBtnClickCallback),this.mInviteFdsBtnClickCallback=new s.default(function(){S.inviteFdsBtnClick()}),this.invite_fds_btn.node.on(cc.Node.EventType.TOUCH_END,this.mInviteFdsBtnClickCallback.click,this.mInviteFdsBtnClickCallback)},y.prototype.initData=function(){var S=this;this.invitees=r.ActivityRewardMgr.Ins().getCacheInviteRewardList(d.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN),this.initView(),r.ActivityRewardMgr.Ins().getInviteSuccessListComplete(d.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN,function(I){S.invitees=I,S.initView()})},y.prototype.initView=function(){var S=this;if(this.invitees&&0<this.invitees.length){var I=0;if(this.invitees.forEach(function(C){C.hd_id==d.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN&&C.is_new_player&&(++I==1&&(S.mask_layout1.node.active=!0,S.avatar_sprite1.node.width=108,S.avatar_sprite1.node.height=108,u.default.showUserAvatar(C.avatar_url,S.avatar_sprite1,!1)),I==2&&(S.mask_layout2.node.active=!0,S.avatar_sprite2.node.width=108,S.avatar_sprite2.node.height=108,u.default.showUserAvatar(C.avatar_url,S.avatar_sprite2,!1)),I==3&&(S.mask_layout3.node.active=!0,S.avatar_sprite3.node.width=108,S.avatar_sprite3.node.height=108,u.default.showUserAvatar(C.avatar_url,S.avatar_sprite3,!1)))}),3<=I)this.invite_count_layout.node.active=!1,o.SkinDataMgr.Ins().unlockInviteSkin();else{this.invite_count_layout.node.active=!0;var v="/ui/skin_invite_num"+I;e.default.get2(v,this.invite_count_text)}o.SkinDataMgr.Ins().updateInviteSkinCount(3<I?3:I),this.newUserCount=3<I?3:I}},y.prototype.closeBtnClick=function(){this.mCloseCallback&&this.mCloseCallback()},y.prototype.inviteFdsBtnClick=function(){this.mInviteFdsCallback&&this.mInviteFdsCallback(),a.MGUser.getUserLoginInfo({complete:function(S){S&&c.MGShareUtils.shareForInviteSkin(S.playerId,d.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN,function(I){n.default.i("\u9080\u8BF7\u597D\u53CB\u5F97\u76AE\u80A4\u5361\u7247\u5206\u4EAB,result : "+I),I&&t.default.fire(i.default.SHARE_RESULT_SHOW_INVITE_TIPS)})}})},y.prototype.start=function(){},__decorate([f(cc.Button)],y.prototype,"invite_fds_btn",void 0),__decorate([f(cc.Button)],y.prototype,"close_btn",void 0),__decorate([f(cc.Sprite)],y.prototype,"invite_count_text",void 0),__decorate([f(cc.Sprite)],y.prototype,"avatar_sprite1",void 0),__decorate([f(cc.Layout)],y.prototype,"mask_layout1",void 0),__decorate([f(cc.Sprite)],y.prototype,"avatar_sprite2",void 0),__decorate([f(cc.Layout)],y.prototype,"mask_layout2",void 0),__decorate([f(cc.Sprite)],y.prototype,"avatar_sprite3",void 0),__decorate([f(cc.Layout)],y.prototype,"mask_layout3",void 0),__decorate([f(cc.Layout)],y.prototype,"invite_count_layout",void 0),y=__decorate([h],y)}(cc.Component);m.default=g,cc._RF.pop()},{"../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../social/AvatarUtil":"AvatarUtil","../Logic/EventBus":"EventBus","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../reward/ActivityBean":"ActivityBean","../reward/ActivityRewardManager":"ActivityRewardManager"}],GameOverPopupUtil:[function(l,P,m){"use strict";cc._RF.push(P,"fda152FKDNCxbCYBr3srOYG","GameOverPopupUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../Logic/SkinDataManager"),o=l("../Logic/PlayerMgr"),e=l("../Network/Protocol/StorageUtil"),n=l("../../config/LSKey"),t=l("../../util/NumberUtil"),i=l("../../util/TimeUtil"),a=l("../../base/Log"),u=l("../UI/MusicLevelDataLoader"),c=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),p=l("../../upgrade/ToggleChecker"),h=l("../../upgrade/ToggleBean"),f=function(){function g(){}return g.needShowInviteSkinPopup=function(_){return!1},g.needShowHotMusicbattleTips=function(){var _=!1,y=c.MGUser.getCurrentServerTime(),S=new Date(y);return i.default.isSameDay(S,new Date(t.default.parseIntFromString(e.default.read(n.default.GAME_OVER_LAST_SHOW_HOT_MUSIC_BATTLE_TIPS_TIME))))||(_=!0),a.default.i("[zhangfu]GameOverInviteUtil.needShowHotMusicbattleTips needShow = "+_+",timeStamp = "+y),e.default.save(n.default.GAME_OVER_LAST_SHOW_HOT_MUSIC_BATTLE_TIPS_TIME,y+""),_},g.needActiveShowPopup=function(_,y){var S=!1,I=c.MGUser.getCurrentServerTime(),v=new Date(I);return _<3&&i.default.isSameDay(v,new Date(t.default.parseIntFromString(e.default.read(n.default.GAME_OVER_LAST_SHOW_TIME))))&&(y==d.InviteType_SKIN?i.default.isSameDay(v,new Date(t.default.parseIntFromString(e.default.read(n.default.GAME_OVER_INVIE_SKIN_LAST_SHOW_TIME))))||(S=!0):y==d.InviteType_HOT_SONG&&(i.default.isSameDay(v,new Date(t.default.parseIntFromString(e.default.read(n.default.GAME_OVER_INVITE_SONG_LAST_SHOW_TIME))))||(S=!0))),a.default.i("[zhangfu]GameOverInviteUtil.needActiveShowPopup needShow = "+S+",timeStamp = "+I),S},g.needShowActivePopupByToggle=function(_,y,S){p.default.ins().init(function(){var I=h.ToggleKey.RESULT_SKIN;_==d.InviteType_HOT_SONG&&(I=h.ToggleKey.RESULT_SONG);var v=p.default.ins().getToggleStatus(I,0,y),C=v==1;a.default.i("[zhangfu]GameOverInviteUtil.needShowActivePopupByToggle toggle status ="+v+", needShow = "+C),S(C)})},g.needShowShareGiftByToggle=function(_,y){y(!1)},g.getDefaultShowType=function(){return d.InviteType_HOT_SONG},g.canShowSkin=function(){return!r.SkinDataMgr.Ins().isUnLockAllInviteSkin()},g.canShowHotSong=function(){var _=!1;if(3<=o.default.Ins().getUserLevel()){var y=u.MusicLevelDataLoader.getValidActiveInfo(c.MGUser.getCurrentServerTime());if(y){for(var S=y.length,I=0;I<S;I++)if(y[I].isLocked)return _=!0}}return _},g}();m.default=f,(s=d=m.InviteType||(m.InviteType={}))[s.InviteType_NONE=0]="InviteType_NONE",s[s.InviteType_SKIN=1]="InviteType_SKIN",s[s.InviteType_HOT_SONG=2]="InviteType_HOT_SONG",cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../config/LSKey":"LSKey","../../upgrade/ToggleBean":"ToggleBean","../../upgrade/ToggleChecker":"ToggleChecker","../../util/NumberUtil":"NumberUtil","../../util/TimeUtil":"TimeUtil","../Logic/PlayerMgr":"PlayerMgr","../Logic/SkinDataManager":"SkinDataManager","../Network/Protocol/StorageUtil":"StorageUtil","../UI/MusicLevelDataLoader":"MusicLevelDataLoader"}],GameSceneDebugPanel:[function(l,P,m){"use strict";cc._RF.push(P,"6b16bzjEqtI76zSdCv+AzmP","GameSceneDebugPanel"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/G"),s=l("../business/UI/GameEntraScene/PrefabMgr"),r=function(){function o(e,n){this.DebugTouchEnabled=!1,this.node=null,this.renderSwitch=null,this.clickTimes=0,this.lastClickTime=0,this.limitX=0,this.limitYDown=0,this.limitYUp=0,this.inited=!1,this.touchInit=!1,this.node=e,this.renderSwitch=n;var t=cc.view.getDevicePixelRatio();this.limitX=80*t,this.limitYDown=80*t,this.limitYUp=Math.floor(cc.game.canvas.height/d.G.Ap.config.presentScale)-this.limitYDown}return o.prototype.setDebugTouchEnabled=function(){this.DebugTouchEnabled=!0},o.prototype.isTouchMatched=function(e){if(!this.DebugTouchEnabled||e.length<=0)return!1;var n=e[0];return n.clientX<=this.limitX&&n.clientY>=this.limitYUp},o.prototype.checkColorEgg=function(){if(d.G.Ap.config.isGameSceneTest())this.triggerColorEgg();else{var e=new Date().getTime();e-this.lastClickTime<=800?(this.clickTimes++,this.clickTimes===6&&(this.clickTimes=0,d.G.Ap.config.gameSceneTest=!0,this.triggerColorEgg())):this.clickTimes=1,this.lastClickTime=e}},o.prototype.triggerColorEgg=function(){var e=this;this.initTouchStatus(),this.inited?this.showDebugElements():(this.inited=!0,this.loadDebugPrefb(function(n){e.initDebugElements(n)}))},o.prototype.showDebugElements=function(){var e=this.node.getChildByName("DebugPanel");e!=null&&(e.active=!0)},o.prototype.initTouchStatus=function(){this.touchInit||(this.touchInit=!0,this.renderSwitch.saveStatus(),this.renderSwitch.enableCocosRender(),this.renderSwitch.enableCocosTouch(),this.renderSwitch.disableTouchHandler())},o.prototype.resetTouchStatus=function(){this.renderSwitch.restoreStatus(),this.touchInit=!1},o.prototype.initDebugElements=function(e){var n=this;if(!d.G.Ap.autoTester.isStart()){this.node.addChild(e);var t=this.node.getChildByName("DebugPanel");if(t!=null){t.getChildByName("ClosePanel").on(cc.Node.EventType.TOUCH_END,function(C){t.active=!1,n.resetTouchStatus()});var i=t.getChildByName("Sound");i.getChildByName("Label").getComponent(cc.Label).string="\u58F0\u97F3\uFF1A"+(d.G.Ap.config.debugNoBlockSound?"\u5173":"\u5F00"),i.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugNoBlockSound=!d.G.Ap.config.debugNoBlockSound,i.getChildByName("Label").getComponent(cc.Label).string="\u58F0\u97F3\uFF1A"+(d.G.Ap.config.debugNoBlockSound?"\u5173":"\u5F00")});var a=t.getChildByName("ScoreAnim");a.getChildByName("Label").getComponent(cc.Label).string="\u5206\u6570\uFF1A"+(d.G.Ap.config.debugNoScoreAnim?"\u5173":"\u5F00"),a.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugNoScoreAnim=!d.G.Ap.config.debugNoScoreAnim,a.getChildByName("Label").getComponent(cc.Label).string="\u5206\u6570\uFF1A"+(d.G.Ap.config.debugNoScoreAnim?"\u5173":"\u5F00")});var u=t.getChildByName("LongBlockTouch");u.getChildByName("Label").getComponent(cc.Label).string="\u4E0D\u68C0\u6D4B\uFF1A"+(d.G.Ap.config.debugNoDetectMission?"\u5F00":"\u5173"),u.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugNoDetectMission=!d.G.Ap.config.debugNoDetectMission,u.getChildByName("Label").getComponent(cc.Label).string="\u4E0D\u68C0\u6D4B\uFF1A"+(d.G.Ap.config.debugNoDetectMission?"\u5F00":"\u5173")});var c=t.getChildByName("BlockTouch");c.getChildByName("Label").getComponent(cc.Label).string="\u5757\u52A8\u753B\uFF1A"+(d.G.Ap.config.debugNoBlockAnim?"\u5173":"\u5F00"),c.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugNoBlockAnim=!d.G.Ap.config.debugNoBlockAnim,c.getChildByName("Label").getComponent(cc.Label).string="\u5757\u52A8\u753B\uFF1A"+(d.G.Ap.config.debugNoBlockAnim?"\u5173":"\u5F00")});var p=t.getChildByName("TouchEvent");p.getChildByName("Label").getComponent(cc.Label).string="\u53EF\u70B9\u51FB\uFF1A"+(d.G.Ap.config.debugNoTouchResponse?"\u5173":"\u5F00"),p.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugNoTouchResponse=!d.G.Ap.config.debugNoTouchResponse,p.getChildByName("Label").getComponent(cc.Label).string="\u53EF\u70B9\u51FB\uFF1A"+(d.G.Ap.config.debugNoTouchResponse?"\u5173":"\u5F00")});var h=t.getChildByName("AutoTouch");h.getChildByName("Label").getComponent(cc.Label).string="\u81EA\u52A8\u70B9\uFF1A"+(d.G.Ap.config.debugAutoTouchBlock?"\u5F00":"\u5173"),h.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugAutoTouchBlock=!d.G.Ap.config.debugAutoTouchBlock,h.getChildByName("Label").getComponent(cc.Label).string="\u81EA\u52A8\u70B9\uFF1A"+(d.G.Ap.config.debugAutoTouchBlock?"\u5F00":"\u5173")});var f=t.getChildByName("RobotTouch");f.getChildByName("Label").getComponent(cc.Label).string="\u673A\u5668\u4EBA\u70B9\uFF1A"+(d.G.Ap.config.debugRobotAutoTouchBlock?"\u5F00":"\u5173"),f.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugRobotAutoTouchBlock=!d.G.Ap.config.debugRobotAutoTouchBlock,f.getChildByName("Label").getComponent(cc.Label).string="\u673A\u5668\u4EBA\u70B9\uFF1A"+(d.G.Ap.config.debugRobotAutoTouchBlock?"\u5F00":"\u5173")});var g=t.getChildByName("AutoLog");g.getChildByName("Label").getComponent(cc.Label).string="\u65E5\u5FD7\uFF1A"+(d.G.Ap.config.debugAutoLog?"\u5F00":"\u5173"),g.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugAutoLog=!d.G.Ap.config.debugAutoLog,g.getChildByName("Label").getComponent(cc.Label).string="\u65E5\u5FD7\uFF1A"+(d.G.Ap.config.debugAutoLog?"\u5F00":"\u5173")});var _=t.getChildByName("FourfoldSpeed");_.getChildByName("Label").getComponent(cc.Label).string="4\u500D\u901F\uFF1A"+(d.G.Ap.config.gameSpeedScale==4?"\u5F00":"\u5173"),_.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.gameSpeedScale==4?d.G.Ap.config.gameSpeedScale=.95:d.G.Ap.config.gameSpeedScale=4,_.getChildByName("Label").getComponent(cc.Label).string="4\u500D\u901F\uFF1A"+(d.G.Ap.config.gameSpeedScale==4?"\u5F00":"\u5173")});var y=t.getChildByName("FreeRelive");y.getChildByName("Label").getComponent(cc.Label).string="\u65E0\u9650\u590D\u6D3B\uFF1A"+(d.G.Ap.config.debugFreeRelive?"\u5F00":"\u5173"),y.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugFreeRelive=!d.G.Ap.config.debugFreeRelive,y.getChildByName("Label").getComponent(cc.Label).string="\u65E0\u9650\u590D\u6D3B\uFF1A"+(d.G.Ap.config.debugFreeRelive?"\u5F00":"\u5173")});var S=t.getChildByName("NoOvertake");S.getChildByName("Label").getComponent(cc.Label).string="\u8D85\u8D8A\u597D\u53CB\uFF1A"+(d.G.Ap.config.debugNoOvertake?"\u5173":"\u5F00"),S.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugNoOvertake=!d.G.Ap.config.debugNoOvertake,S.getChildByName("Label").getComponent(cc.Label).string="\u8D85\u8D8A\u597D\u53CB\uFF1A"+(d.G.Ap.config.debugNoOvertake?"\u5173":"\u5F00")});var I=t.getChildByName("NoBgAnim");I.getChildByName("Label").getComponent(cc.Label).string="\u80CC\u666F\u52A8\u753B\uFF1A"+(d.G.Ap.config.debugNoBackgroundAnim?"\u5173":"\u5F00"),I.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugNoBackgroundAnim=!d.G.Ap.config.debugNoBackgroundAnim,I.getChildByName("Label").getComponent(cc.Label).string="\u80CC\u666F\u52A8\u753B\uFF1A"+(d.G.Ap.config.debugNoBackgroundAnim?"\u5173":"\u5F00")});var v=t.getChildByName("ShowTouchPos");v.getChildByName("Label").getComponent(cc.Label).string="\u70B9\u51FB\u4F4D\u7F6E\uFF1A"+(d.G.Ap.config.debugShowTouchPos?"\u5F00":"\u5173"),v.on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.config.debugShowTouchPos=!d.G.Ap.config.debugShowTouchPos,v.getChildByName("Label").getComponent(cc.Label).string="\u70B9\u51FB\u4F4D\u7F6E\uFF1A"+(d.G.Ap.config.debugShowTouchPos?"\u5F00":"\u5173")}),t.getChildByName("PauseGame").on(cc.Node.EventType.TOUCH_END,function(C){n.renderSwitch.getGameInterface().pauseGame()}),t.getChildByName("PerfTest").on(cc.Node.EventType.TOUCH_END,function(C){d.G.Ap.autoTester.startTest()}),t.active=!0}}},o.prototype.loadDebugPrefb=function(e){s.default.load("prefab/GameSceneDebugPanel",function(n,t){e(t)})},o}();m.default=r,cc._RF.pop()},{"../base/G":"G","../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr"}],GameSceneEntry:[function(l,P,m){"use strict";cc._RF.push(P,"2b4d7YIOjdIRphzzoL3vAkl","GameSceneEntry"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TouchHandler"),s=l("../base/G"),r=l("./GameSceneDebugPanel"),o=l("../util/PU"),e=l("./TrialGameScene"),n=l("./TrialSongGameScene"),t=l("../base/State"),i=l("./GameSceneSetting"),a=l("../property/PropertyDefines"),u=l("../util/nodeFacade"),c=l("./NormalGameScene"),p=l("./MUI/MUIDefines"),h=l("./element/loader/BeginFrameLoader"),f=l("./element/loader/BlockSkinFrameLoader"),g=l("./element/loader/NumberFrameLoader"),_=l("./element/loader/GameSceneFrameLoader"),y=l("../business/UI/GameEntraScene/PrefabMgr"),S=l("../base/Log"),I=l("./ExclusiveSkinGameScene"),v=l("../../modules/MGAdv/scripts/Logic/MGAdvDefine"),C=l("../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),T=l("../business/Network/Protocol/StorageUtil"),E=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),A=l("../util/StringUtil"),M=l("../util/TimeUtil"),k=l("../config/LSKey"),D=l("../business/UI/GameEntraScene/ImgCache"),L=l("./view/BottomStorePanel"),b=l("./view/PropertiesPanel"),N=l("./TryPianoGameScene"),H=l("../business/Logic/I18nManager"),R=l("../business/shop/PropertyStorePrefab"),F=l("../business/keypad/KeypadNavigator"),x=l("../business/keypad/KeypadUtil"),U=cc._decorator,B=U.ccclass,Q=U.property,Z=function(){function W(){this.item=null,this.PROPERTIES=[{probability:.34,type:a.PROPERTYTYPE.GAME_DASH,tipIcon:"/static_res/tip_12s_autorun"},{probability:.33,type:a.PROPERTYTYPE.GAME_SLOW,tipIcon:"/static_res/tip_15s_slowdown"},{probability:.33,type:a.PROPERTYTYPE.GAME_SHIELD,tipIcon:"/static_res/tip_counteract_invincibel8s"}],this.PROPERTIES_EN=[{probability:.34,type:a.PROPERTYTYPE.GAME_DASH,tipIcon:"/static_res/tip_12s_autorun_en"},{probability:.33,type:a.PROPERTYTYPE.GAME_SLOW,tipIcon:"/static_res/tip_15s_slowdown_en"},{probability:.33,type:a.PROPERTYTYPE.GAME_SHIELD,tipIcon:"/static_res/tip_counteract_invincibel8s_en"}],this.item=this.pop()}return W.prototype.getProperty=function(){return new a.Property(this.item.type)},W.prototype.getType=function(){return this.item.type},W.prototype.getTipIcon=function(){return this.item.tipIcon},W.prototype.pop=function(){var V=cc.rand()%100,Y=0;if(H.default.getInstance().isEnglish())for(var q=0,J=this.PROPERTIES_EN;q<J.length;q++){var ee=J[q],$=Y+Math.round(100*ee.probability);if(Y<=V&&V<$)return ee;Y=$}else for(var j=0,ie=this.PROPERTIES;j<ie.length;j++){if(ee=ie[j],$=Y+Math.round(100*ee.probability),Y<=V&&V<$)return ee;Y=$}},W}();m.PropertyGenerator=Z;var z=function(W){function V(){var Y=W!==null&&W.apply(this,arguments)||this;return Y.sprite=null,Y.debugPanelEntry=null,Y.advRewardButton=null,Y.gameScene=null,Y.ctx=null,Y.touchHandler=null,Y.spriteCanvas=null,Y.spriteContext=null,Y.spriteTexture=null,Y.isCocosRender=void 0,Y.androidRenderLimit=0,Y.savedCocosRenderStatus=!1,Y.savedCocosTouchStatus=!1,Y.savedTouchHandlerStatus=!1,Y.debugPanel=null,Y.bottomStorePanel=null,Y.mGameFrameInterval=0,Y.lastFrameTime=0,Y.propertyGenerator=null,Y}return __extends(V,W),V.prototype.enResLoad=function(){var Y=this;this.enSpriteSetNull(),D.default.get("static_res/gamescene_adv_reward_icon_en",function(q,J){cc.isValid(Y,!0)&&(Y.advRewardButton.normalSprite=J)}),D.default.get("static_res/gamescene_adv_reward_icon_press_en",function(q,J){cc.isValid(Y,!0)&&(Y.advRewardButton.pressedSprite=J)})},V.prototype.enSpriteSetNull=function(){this.advRewardButton.getComponent(cc.Sprite).spriteFrame=null},V.prototype.onLoad=function(){H.default.getInstance().isEnglish()&&this.enResLoad(),this.canvas=cc.game.canvas,cc._renderType!==cc.game.RENDER_TYPE_CANVAS?(console.log("GameSceneEntry::renderType => WebGL"),this.ctx=null):(console.log("GameSceneEntry::renderType => Canvas"),this.ctx=this.canvas.getContext("2d")),this.lastFrameTime=Date.now(),this.makesureAtlasLoadFinish(),this.resetRenderLimit(),console.log("GameSceneEntry::resolution => "+this.canvas.width+"x"+this.canvas.height),this.touchHandler=new d.default(this.node,this),this.touchHandler.registerListener(),this.saveStatus(),this.createGameScene(),this.gameScene.setEntryInterface(this),this.gameScene.initilize(),this.gameScene.onLoad(),this.createRenderTexture();var Y=s.G.Ap.state.mission;Y.getType()==t.MISSIONTYPE.ExclusiveSkin||Y.getType()==t.MISSIONTYPE.Battle||Y.getType()==t.MISSIONTYPE.TrySkin||Y.trial||Y.getType()==t.MISSIONTYPE.TrySong||Y.trialSong||Y.getType()==t.MISSIONTYPE.TryPiano||Y.tryPiano||i.default.getInstance().isNeedShowGuideInGameScene()||this.initAdv(),S.default.isDebug()&&(this.debugPanel=new r.default(this.node,this),this.debugPanelEntry.on(cc.Node.EventType.TOUCH_END,this.checkAndShowDebugPanel,this)),F.default.getInstance().gotoPage(this.node,"GameSceneEntry")},V.prototype.initAdvEvent=function(){var Y=this,q=this.node.getChildByName("AdvRewardBtn"),J=this.node.getChildByName("AdvRewardTip");q.on(cc.Node.EventType.TOUCH_END,function(){console.warn("AdvRewardBtn => pressed");var ee=v.ADScene.GAME_SCENE_REWARD_PROP,$="\u7F51\u7EDC\u4E0D\u7ED9\u529B\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5";H.default.getInstance().isEnglish()&&($="There is something wrong with network,please check it."),C.MGAdv.show(ee,v.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(j){switch(j){case v.ADStat.NOT_NETWORK:Y.showToastTips($);break;case v.ADStat.SHOW_SUCCESS_CLOSE:Y.showRewardPropertyDialog();break;case v.ADStat.SHOW_NOT_ENED_CLOSE:break;case v.ADStat.SHOW_GET_AD_FAILED:Y.showToastTips("No video ads available")}q.active=!1,Y.node.removeChild(q),J&&Y.node.removeChild(J),F.default.getInstance().onPressTab()})},this)},V.prototype.showRewardPropertyDialog=function(){var Y=this,q=E.MGUser.getCurrentServerTime().toString();console.log("\u672C\u6B21\u89C2\u770B\u5E7F\u544A\u65F6\u95F4 "+q),T.default.save(k.default.LAST_USE_ADV_GET_PROPERTY_TIME,q);var J=T.default.read(k.default.USE_ADV_GET_PROPERTY_COUNT);console.log("\u89C2\u770B\u5E7F\u544A\u6B21\u6570"+J),A.StringUtil.isEmpty(J)?(console.log("\u5E7F\u544A\u6B21\u6570\u52A01"),T.default.save(k.default.USE_ADV_GET_PROPERTY_COUNT,"1")):(console.log("\u5E7F\u544A\u6B21\u6570\u52A01"),T.default.save(k.default.USE_ADV_GET_PROPERTY_COUNT,(parseInt(J)+1).toString()));var ee=this.propertyGenerator.getProperty();this.saveStatus(),this.disableTouchHandler();var $="\u606D\u559C\u83B7\u5F97\u51CF\u901F\u9053\u5177\uFF0C\u590D\u6D3B\u540E15\u79D2\u5185\u94A2\u7434\u5757\u4E0B\u843D\u901F\u5EA6\u964D\u4F4E50",j="\u606D\u559C\u83B7\u5F97\u51B2\u523A\u9053\u5177\uFF0C\u53EF\u5F00\u5C40\u51B2\u523A12\u79D2",ie="\u606D\u559C\u83B7\u5F97\u62A4\u76FE\u9053\u5177\uFF0C\u62B5\u6D88\u4E00\u6B21\u5931\u8BEF\u5E76\u65E0\u654C8\u79D2",oe="\u597D\u7684";H.default.getInstance().isEnglish()&&($="Get slow down prop\uFF0Cblock falling speed -50% in 15s after revive.",j="Get auto tap  prop\uFF0Cauto tap for 12s at the beginning of the game.",ie="Get shield prop\uFF0Coffset one miss and remain  invincible for 8s.",oe="Ok"),y.default.load("prefab/shop/DialogRechargePrefab",function(ue,pe){if(pe){var de=cc.instantiate(pe),he=de.getComponent("DialogRechargePrefab"),me=void 0;switch(ee.type){case a.PROPERTYTYPE.GAME_SLOW:me=$,he.setSlowCount(1);break;case a.PROPERTYTYPE.GAME_DASH:me=j,he.setDashCount(1);break;case a.PROPERTYTYPE.GAME_SHIELD:me=ie,he.setShieldCount(1)}he.setContent(me),he.setBtnTxt(oe),he.setBottonCallback(function(){var ye=s.G.Ap.propertyPack.getPlayProperty();ye.addProperty(ee,1),s.G.Ap.propertyPack.save(),ye.getPropertyCount(ee),Y.updatePropertyCount(ee),Y.restoreStatus(),de.destroy()}),Y.node.addChild(de)}})},V.prototype.showToastTips=function(Y,q){var J=this;y.default.load("prefab/ToastPrefab",function(ee,$){if($){var j=cc.instantiate($),ie=j.getComponent("ToastPrefab");ie.showTips(Y,function(){j.destroy(),q&&q()}),ie.setLong(!1),J.node.addChild(j)}})},V.prototype.initAdv=function(){this.propertyGenerator=new Z;var Y=T.default.read(k.default.LAST_USE_ADV_GET_PROPERTY_TIME);if(A.StringUtil.isEmpty(Y))console.log("\u6E38\u620F\u573A\u666F\u52A0\u8F7D\u5E7F\u544A  \u4E0A\u6B21\u65F6\u95F4\u662F\u7A7A");else{var q=new Date(parseInt(Y));console.log("\u6E38\u620F\u573A\u666F\u52A0\u8F7D\u5E7F\u544A "+Y+" "+E.MGUser.getCurrentServerTime()),M.default.isBeyondOneDay(q,new Date(E.MGUser.getCurrentServerTime()))&&(console.log("\u6E38\u620F\u573A\u666F\u52A0\u8F7D\u5E7F\u544A  \u65F6\u95F4\u8D85\u8FC7\u4E86\u4E00\u5929\uFF0C\u91CD\u7F6E\u663E\u793A\u6B21\u6570"),T.default.save(k.default.USE_ADV_GET_PROPERTY_COUNT,"0"))}var J=T.default.read(k.default.USE_ADV_GET_PROPERTY_COUNT),ee=this.node.getChildByName("AdvRewardBtn"),$=this.node.getChildByName("AdvRewardTip");x.default.isHorizon()?($.active=!1,ee.active=!1):A.StringUtil.isEmpty(J)?($.active=!0,this.setRandomAdvRewardTip(),ee.active=!0):3<=parseInt(J)?($.active=!1,ee.active=!1):($.active=!0,this.setRandomAdvRewardTip(),ee.active=!0),ee.active==1&&(C.MGAdv.isBannerCached()||o.default.isWeb()||o.default.isWeiXin()||C.MGAdv.load(v.ADScene.GAME_SCENE_REWARD_PROP,v.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),this.initAdvEvent())},V.prototype.setRandomAdvRewardTip=function(){var Y=this.node.getChildByName("AdvRewardTip").getComponent(cc.Sprite),q=this.propertyGenerator.getTipIcon();D.default.get2(q,Y)},V.prototype.checkAndShowDebugPanel=function(){this.debugPanel.checkColorEgg()},V.prototype.start=function(){this.enableCocosRender(),this.enableCocosTouch(),this.enableTouchHandler(),this.gameScene.start(),this.gameScene.updateScreenRatio(),this.gameScene.allowProperty()?this.updatePropertiesPanel():this.showPropertiesPanel(!1)},V.prototype.onDestroy=function(){this.enableCocosRender(),this.enableCocosTouch(),this.disableTouchHandler(),cc.sys.garbageCollect(),this.touchHandler.unregisterListener(),cc.audioEngine.uncacheAll();try{this.gameScene.onDestroy()}catch(Y){console.error("GameSceneEntry::Error="+Y)}},V.prototype.update=function(Y){var q=Date.now();if(this.mGameFrameInterval=(q-this.lastFrameTime)/1e3,this.lastFrameTime=q,o.default.calculationBenchmarkLevel(Y),this.gameScene)if(this.gameScene.update(this.mGameFrameInterval,Y),this.isCocosRender)if(p.MUI.global.renderType===p.MUI.RenderType.CANVAS)cc.sys.os===cc.sys.OS_ANDROID?6<=this.androidRenderLimit?(this.androidRenderLimit=0,this.gameScene.renderToTexture(this.spriteContext,null),this.spriteTexture.handleLoadedTexture()):this.androidRenderLimit++:(this.gameScene.renderToTexture(this.spriteContext,null),this.spriteTexture.handleLoadedTexture());else{var J=this.spriteTexture._glID;this.gameScene.renderToTexture(p.MUI.global.ctx,J)}else p.MUI.global.renderType===p.MUI.RenderType.CANVAS?(this.ctx.setTransform(1,0,0,1,0,0),this.gameScene.render(this.ctx),s.G.Ap.config.debugShowTouchPos&&this.touchHandler.render(this.ctx)):this.gameScene.render(p.MUI.global.ctx)},V.prototype.createGameScene=function(){var Y=s.G.Ap.state.mission;Y.getType()===t.MISSIONTYPE.Battle||Y.getType()===t.MISSIONTYPE.BattleFriend||Y.getType()===t.MISSIONTYPE.BattleWorldChat||(Y.getType()===t.MISSIONTYPE.ExclusiveSkin?this.gameScene=new I.default(this,this.node):Y.getType()===t.MISSIONTYPE.TrySkin||Y.trial?this.gameScene=new e.default(this,this.node):Y.getType()===t.MISSIONTYPE.TrySong||Y.trialSong?this.gameScene=new n.default(this,this.node):Y.getType()===t.MISSIONTYPE.TryPiano||Y.tryPiano?this.gameScene=new N.default(this,this.node):this.gameScene=new c.default(this,this.node)),this.gameScene.setDecelerateConfirmPrefab("prefab/UseDecelerateConfirm"),this.gameScene.setPropertyIntroductionPrefab("prefab/PropertyIntroduction")},V.prototype.createRenderTexture=function(){if(this.spriteTexture=new cc.Texture2D,this.sprite.spriteFrame=new cc.SpriteFrame(this.spriteTexture),p.MUI.global.renderType===p.MUI.RenderType.CANVAS)this.spriteCanvas=document.createElement("canvas"),this.spriteCanvas.width=this.canvas.width,this.spriteCanvas.height=this.canvas.height,this.spriteContext=this.spriteCanvas.getContext("2d"),this.spriteTexture.initWithElement(this.spriteCanvas),this.spriteTexture.handleLoadedTexture(),this.sprite.node.scaleY=1;else{for(var Y=new cc.Size(p.MUI.global.rttWidth,p.MUI.global.rttHeight),q=Y.width*Y.height*4,J=new Uint8Array(q),ee=0;ee<q;ee++)J[ee]=0;this.spriteTexture.initWithData(J,cc.Texture2D.PixelFormat.RGBA8888,Y.width,Y.height,null);var $=p.MUI.global.rttViewPort;this.sprite.type=cc.Sprite.Type.TILED,this.sprite.spriteFrame.setRect(new cc.Rect($[0],$[1],$[2],$[3])),this.sprite.node.setContentSize($[2],$[3]),this.sprite.node.setScale((s.G.Ap.config.presentWidth+1)/$[2],-(s.G.Ap.config.presentHeight+1)/$[3]),this.sprite.node.scaleY=-(s.G.Ap.config.presentHeight+1)/$[3];var j=p.MUI.global.ctx;this.sprite.srcBlendFactor=j.ONE,this.sprite.dstBlendFactor=j.ONE_MINUS_SRC_ALPHA}},V.prototype.showPropertiesPanel=function(Y){var q=this.node.getChildByName("propertiesPanel");q&&(q.active=Y)},V.prototype.updatePropertiesPanel=function(Y){var q=this,J=this.node.getChildByName("propertiesPanel");if(J)return this.bottomStorePanel?(this.bottomStorePanel.updatePropertiesPanel(),void(Y&&this.bottomStorePanel.playGetPropertyAnim(Y))):void y.default.load("gamescene/BottomStorePanel",function(ee,$){$&&(q.bottomStorePanel=$.getComponent(L.default),q.bottomStorePanel.setShowPropPopupCb(function(j,ie){j==b.PropShowType.Desc?q.showPropertyDescribeToast(ie):j==b.PropShowType.Store&&q.showPropertyStore(ie)}),q.bottomStorePanel.setBottomStoreLoadFinished(function(){F.default.getInstance().isNodeExists("propertyicondash")||q.scheduleOnce(function(){F.default.getInstance().refreshPage(q.node,"GameSceneEntry")},1)}),J.addChild($),Y&&q.bottomStorePanel.playGetPropertyAnim(Y))})},V.prototype.showPropertyDescribeToast=function(Y){var q=new u.default(this.node.getChildByName("toast")),J=s.G.Ap.propertyPack.getConfig().getParam(Y);if(J){var ee=this.parseDesc(J.describe);q.setChildText("title",ee),q.setOpacity(255),q.setVisible(!0)}if(q.getNode()){q.getNode().stopAllActions();var $=cc.delayTime(3),j=cc.fadeTo(.2,0);q.getNode().runAction(cc.sequence($,j))}},V.prototype.showPropertyStore=function(Y){var q=this,J=this.node.getChildByName("store");J&&y.default.load("prefab/PropertyStorePrefab",function(ee,$){if($){J.addChild($);var j=$.getComponent(R.default);j.setCallBack(q),j.setPriortyProperty(Y),j.show(),q.disableTouchHandler()}})},V.prototype.resetRenderLimit=function(){this.androidRenderLimit=10},V.prototype.onTouchStart=function(Y){if(this.debugPanel&&this.debugPanel.isTouchMatched(Y)&&!s.G.Ap.state.running)return this.checkAndShowDebugPanel(),void S.default.l("GameSceneEntry.onTouchStart debugPanel");this.gameScene.onGameNodeTouchStart(Y)},V.prototype.onTouchMove=function(Y){this.gameScene.onGameNodeTouchMove(Y)},V.prototype.onTouchEnd=function(Y){this.gameScene.onGameNodeTouchEnd(Y)},V.prototype.enableCocosRender=function(){this.isCocosRender!==!0&&(console.log("Cocos Render => ON"),this.isCocosRender=!0,cc.sys.skipRender=!1)},V.prototype.disableCocosRender=function(){this.isCocosRender!==!1&&(console.log("Cocos Render => OFF"),this.isCocosRender=!1,this.resetRenderLimit(),cc.sys.skipRender=!0)},V.prototype.enableCocosTouch=function(){console.log("Cocos Touch => ON"),cc.sys.skipTouch=!1},V.prototype.disableCocosTouch=function(){console.log("Cocos Touch => OFF"),cc.sys.skipTouch=!0},V.prototype.enableTouchHandler=function(){console.log("Touch Handler => ON"),this.touchHandler.enable(!0)},V.prototype.disableTouchHandler=function(){console.log("Touch Handler => OFF"),this.touchHandler.enable(!1)},V.prototype.saveStatus=function(){this.savedCocosRenderStatus=cc.sys.skipRender,this.savedCocosTouchStatus=cc.sys.skipTouch,this.touchHandler&&(this.savedTouchHandlerStatus=this.touchHandler.isEnabled())},V.prototype.restoreStatus=function(){this.isCocosRender=!this.savedCocosRenderStatus,cc.sys.skipRender=this.savedCocosRenderStatus,cc.sys.skipRender&&this.resetRenderLimit(),cc.sys.skipTouch=this.savedCocosTouchStatus,this.touchHandler.enable(this.savedTouchHandlerStatus),console.log("restore: touchHandler:"+this.savedTouchHandlerStatus+" skipTouch:"+this.savedCocosTouchStatus+" skipRender:"+this.savedCocosRenderStatus)},V.prototype.getGameInterface=function(){return this.gameScene},V.prototype.getRenderNode=function(){return this.node},V.prototype.makesureAtlasLoadFinish=function(){var Y;(Y=h.default.getInstance().getAtlas())&&!Y.isLoadFinish()&&Y.stepLoad(),(Y=f.default.getInstance().getAtlas())&&!Y.isLoadFinish()&&Y.stepLoad(),(Y=g.default.getInstance().getAtlas())&&!Y.isLoadFinish()&&Y.stepLoad(),(Y=_.default.getInstance().getAtlas())&&!Y.isLoadFinish()&&Y.stepLoad(),(Y=_.default.getInstance().getAtlas2())&&!Y.isLoadFinish()&&Y.stepLoad()},V.prototype.updatePropertyCount=function(Y){this.updatePropertiesPanel(Y)},V.prototype.gameStartRun=function(){this.debugPanel&&(this.debugPanelEntry.off(cc.Node.EventType.TOUCH_END,this.checkAndShowDebugPanel,this),this.debugPanel.setDebugTouchEnabled());var Y=this.node.getChildByName("AdvRewardBtn");Y&&this.node.removeChild(Y);var q=this.node.getChildByName("AdvRewardTip");q&&this.node.removeChild(q),new u.default(this.node).setChildVisible("propertiesPanel",!1),this.enableTouchHandler()},V.prototype.gameBackground=function(){this.gameScene&&this.gameScene.gameBackground()},V.prototype.gameForeground=function(){this.gameScene&&this.gameScene.gameForeground()},V.prototype.onPropertyStoreClose=function(Y){this.enableTouchHandler(),this.enableCocosTouch();var q=s.G.Ap.state;q.addCarryProperty(Y,0);for(var J=q.getCarryProperties(),ee=0,$=J.length;ee<$;++ee){var j=J[ee];q.removeCarryProperty(j)}var ie=s.G.Ap.propertyPack.getPlayProperty();for(ee=0,$=J.length;ee<$;++ee)j=J[ee],0<ie.getPropertyCount(j)&&q.addCarryProperty(j,1);this.updatePropertiesPanel()},V.prototype.onBuyProperty=function(Y,q){},V.prototype.parseDesc=function(Y){var q="";if(~Y.indexOf(";"))for(var J=Y.split(";"),ee=0,$=0,j=J;$<j.length;$++){var ie=j[$];q=q.concat(ie),++ee!==J.length&&(q=q.concat("\n"))}else q=Y;return q},__decorate([Q(cc.Sprite)],V.prototype,"sprite",void 0),__decorate([Q(cc.Node)],V.prototype,"debugPanelEntry",void 0),__decorate([Q(cc.Button)],V.prototype,"advRewardButton",void 0),V=__decorate([B],V)}(cc.Component);m.default=z,cc._RF.pop()},{"../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../base/G":"G","../base/Log":"Log","../base/State":"State","../business/Logic/I18nManager":"I18nManager","../business/Network/Protocol/StorageUtil":"StorageUtil","../business/UI/GameEntraScene/ImgCache":"ImgCache","../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr","../business/keypad/KeypadNavigator":"KeypadNavigator","../business/keypad/KeypadUtil":"KeypadUtil","../business/shop/PropertyStorePrefab":"PropertyStorePrefab","../config/LSKey":"LSKey","../property/PropertyDefines":"PropertyDefines","../util/PU":"PU","../util/StringUtil":"StringUtil","../util/TimeUtil":"TimeUtil","../util/nodeFacade":"NodeFacade","./ExclusiveSkinGameScene":"ExclusiveSkinGameScene","./GameSceneDebugPanel":"GameSceneDebugPanel","./GameSceneSetting":"GameSceneSetting","./MUI/MUIDefines":"MUIDefines","./NormalGameScene":"NormalGameScene","./TouchHandler":"TouchHandler","./TrialGameScene":"TrialGameScene","./TrialSongGameScene":"TrialSongGameScene","./TryPianoGameScene":"TryPianoGameScene","./element/loader/BeginFrameLoader":"BeginFrameLoader","./element/loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./element/loader/GameSceneFrameLoader":"GameSceneFrameLoader","./element/loader/NumberFrameLoader":"NumberFrameLoader","./view/BottomStorePanel":"BottomStorePanel","./view/PropertiesPanel":"PropertiesPanel"}],GameSceneFrameLoader:[function(l,P,m){"use strict";cc._RF.push(P,"ca65agr12RJ/Kyl9UnilxsG","GameSceneFrameLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../atlas/SimpleAtlas"),s=l("../../animation/action/MAdvanceAnimation"),r=l("../../../util/PU"),o=l("../../../util/ResLoader"),e=function(){function n(){this.mGameSceneShieldAtlas=null,this.mGameSceneSimpleAtlas=null,this.mGameSceneSimpleAtlas2=null,this.mShortBlockTouchedAnim=null,this.mInit=!1,this.loadCounter=0,this.mGameSceneShieldAtlas=new d.default,this.mGameSceneSimpleAtlas=new d.default,this.mGameSceneSimpleAtlas2=new d.default,this.mGameAnimations=new Object}return n.getInstance=function(){return n.sInstance==null&&(n.sInstance=new n),n.sInstance},n.prototype.init=function(t,i){return __awaiter(this,void 0,void 0,function(){var a,u,c,p;return __generator(this,function(h){switch(h.label){case 0:return this.mInit?[2]:(this.mInit=!0,[4,this.mGameSceneSimpleAtlas.load("gameImage/gameScene")]);case 1:return h.sent(),[4,this.mGameSceneSimpleAtlas2.load("gameImage/gameScene2_en")];case 2:return h.sent(),[4,this.mGameSceneShieldAtlas.load("gameImage/shield")];case 3:for(h.sent(),a=["honor_one","honor_two","honor_three","kinbi","wujin","headportnit_idle"],this.loadCounter=0,u=0,c=a.length;u<c;++u)p=r.default.getResourcePath("resources/animation/"+a[u]+"_anim.json"),this.loadAnimation2(p,a[u],this.loadComplete.bind(this,a.length,t,i));return[2]}})})},n.prototype.loadComplete=function(t,i,a){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(u){return this.loadCounter++,this.loadCounter==t&&i&&i.call(a),[2]})})},n.prototype.loadAnimation2=function(t,i,a){var u=this;o.default.loadJson(t,function(c,p){if(!c){var h=new s.default(p);u.mGameAnimations[i]=h}a&&a()})},n.prototype.loadAnimation=function(t,i,a,u){return __awaiter(this,void 0,Promise,function(){var c=this;return __generator(this,function(p){return o.default.loadJson(t,function(h,f){if(h)u(h);else{var g=new s.default(f);c.mGameAnimations[i]=g,a(f)}}),[2]})})},n.prototype.getShieldAnimation=function(){return this.mGameSceneShieldAtlas},n.prototype.getAtlas=function(){return this.mGameSceneSimpleAtlas},n.prototype.getAtlas2=function(){return this.mGameSceneSimpleAtlas2},n.prototype.getMoneyBlockBackground=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("bonus_tile_music")},n.prototype.getGiftBlockBackground=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("egg_2")},n.prototype.getCircleLight=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("long_circle_light")},n.prototype.getDotLight=function(){return this.mGameSceneSimpleAtlas==null?null:this.mGameSceneSimpleAtlas.getItem("long_dot_light")},n.prototype.getAnimations=function(t){return this.mGameAnimations[t]},n.sInstance=null,n}();m.default=e,cc._RF.pop()},{"../../../util/PU":"PU","../../../util/ResLoader":"ResLoader","../../animation/action/MAdvanceAnimation":"MAdvanceAnimation","../../atlas/SimpleAtlas":"SimpleAtlas"}],GameSceneSetting:[function(l,P,m){"use strict";cc._RF.push(P,"d3712ovjbJFhI5yx6MMeosC","GameSceneSetting"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../business/Network/Protocol/StorageUtil"),o=l("../config/LSKey"),e=l("../business/Logic/PlayerMgr");(s=d=m.FromSource||(m.FromSource={}))[s.SOURCE_DEFAULT=0]="SOURCE_DEFAULT",s[s.SOURCE_GUIDE=1]="SOURCE_GUIDE",s[s.SOURCE_MAIN=2]="SOURCE_MAIN",s[s.SOURCE_MUSIC=3]="SOURCE_MUSIC",s[s.SOURCE_RANK_MAIN=4]="SOURCE_RANK_MAIN",s[s.SOURCE_RANK_MUSIC=5]="SOURCE_RANK_MUSIC",s[s.SOURCE_RANK_RESULT=6]="SOURCE_RANK_RESULT",s[s.SOURCE_RANK_OTHER=7]="SOURCE_RANK_OTHER",s[s.SOURCE_SKIN_TRY=8]="SOURCE_SKIN_TRY",s[s.SOURCE_SONG_TRY=9]="SOURCE_SONG_TRY",s[s.SOURCE_CHALLENGE_GAME=10]="SOURCE_CHALLENGE_GAME",s[s.SOURCE_FIGHT=11]="SOURCE_FIGHT",s[s.SOURCE_RESULT_UPGRADE=12]="SOURCE_RESULT_UPGRADE",s[s.SOURCE_PIANO_TRY=13]="SOURCE_PIANO_TRY";var n=function(){function t(){this.mNeedShowGuide=!1,this.mFromSource=d.SOURCE_DEFAULT}return t.getInstance=function(){return t.sInstance==null&&(t.sInstance=new t),t.sInstance},t.prototype.isNeedShowGuideInGameScene=function(){return!this.isUserGuideFinish()&&!this.isGuideShowd()},t.prototype.isGuideShowd=function(){return r.default.read(o.default.GAMESCENE_GUIDE_SHOWED,"false")==="true"},t.prototype.setGuideShowed=function(i){r.default.save(o.default.GAMESCENE_GUIDE_SHOWED,i?"true":"false")},t.prototype.isUserGuideFinish=function(){return!(e.default.Ins().getUserLevel()===1&&e.default.Ins().getUserCurrentExp()<5)},t.prototype.isNeedShowGuideInResultPage=function(){return!!this.mNeedShowGuide&&this.isUserGuideFinish()},t.prototype.setNeedShowGuideInResultPage=function(i){this.mNeedShowGuide=i},t.prototype.getFromSource=function(){return this.mFromSource},t.prototype.setFromSource=function(i){this.mFromSource=i},t.sInstance=null,t}();m.default=n,cc._RF.pop()},{"../business/Logic/PlayerMgr":"PlayerMgr","../business/Network/Protocol/StorageUtil":"StorageUtil","../config/LSKey":"LSKey"}],GameScene:[function(l,P,m){"use strict";cc._RF.push(P,"103d9/ct2xMoZOIfCHOgX9Q","GameScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/G"),s=l("../util/Utility"),r=l("../util/Performance"),o=l("./StarCountSwitch"),e=l("./element/anim/ScoreAnimation"),n=l("../music/Music"),t=l("../music/MusicPlayer"),i=l("./ctrl/GameStageMusic"),a=l("./ctrl/GameStageMoney"),u=l("../business/gameover/Relive"),c=l("../business/gameover/ReviveController"),p=l("../business/Logic/LevelMgr"),h=l("../business/Logic/PlayerMgr"),f=l("../business/gameover/ReliveScoreData"),g=l("./element/loader/GameSceneFrameLoader"),_=l("../business/UI/GameEntraScene/UICache"),y=l("./element/node/CookiesNodeCache"),S=l("./element/anim/CookieAnimation"),I=l("../util/SUtil"),v=l("./animation/MScheduler"),C=l("./animation/MAnimationMgr"),T=l("./element/component/Banner"),E=l("./MUI/MUIBoard"),A=l("./MUI/MUINode"),M=l("./MUI/MUISprite"),k=l("./animation/action/MSequence"),D=l("./GameBus"),L=l("./animation/action/MCallFunc"),b=l("./animation/action/MDelay"),N=l("./element/component/MUINumber"),H=l("../util/SceneMusicMgr"),R=l("./element/loader/NumberFrameLoader"),F=l("./element/component/SplitLine"),x=l("../business/UI/GameClub"),U=l("./element/component/BackButton"),B=l("./GameSceneSetting"),Q=l("./MUI/MUIFactory"),Z=l("./element/loader/BlockSkinFrameLoader"),z=l("../business/Logic/ChestManager"),W=l("../base/State"),V=l("../business/Network/Protocol/StorageUtil"),Y=l("../config/LSKey"),q=l("../business/Network/Protocol/User"),J=l("../business/Network/Protocol/UserUtil"),ee=l("../util/PageHeap"),$=l("./module/GameModuleManager"),j=l("./module/QQRedPacketModule"),ie=l("../property/PropertyDefines"),oe=l("./property/PropertyProcess"),ue=l("./property/DecelerateConfirm"),pe=l("./MUI/MUIDefines"),de=l("../business/UI/GameEntraScene/PrefabMgr"),he=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),me=l("../util/StringUtil"),ye=l("../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),ge=l("../../modules/MGAdv/scripts/Logic/MGAdvDefine"),Te=l("./view/GameStageNodeView"),Se=l("../base/Log"),Be=l("../business/Logic/I18nManager"),be=l("./element/component/KeyTouchLine"),Ue=l("../business/keypad/KeypadUtil"),se=function(re){this.finish=!1,this.finish=re};m.StageState=se;var He=function(){function re(O,w){this.entryInterface=null,this.gameSceneSize=new cc.Size(0,0),this.blockRegionSize=new cc.Size(0,0),this.propertiesIconNode=null,this.propertiesEffectNode=null,this.effectiveSkin=null,this.backgroundNode=null,this.backgroundEffectNode=null,this.blockTouchEffectNode=null,this.blockLongTouchEffectNode=null,this.starCountSwitch=null,this.cookieAnimation=null,this.cookiesNodeCache=null,this.scoreAnimation=null,this.firstStage=null,this.infiniteStage=null,this.moneyStage=null,this.currentStage=null,this.stageStates=[],this.musicZero=new n.default(""),this.player=new t.default(90),this.music=this.musicZero,this.level=null,this.levelRecord=null,this.mReviveController=null,this.performance=new r.Performance.CounterImpl(.022),this.FRAME_TIME=1/60,this.atlasGameObject=null,this.uiBoard=null,this.blockRegionNode=null,this.keyTouchLine=null,this.spliteLine=null,this.bannerNode=null,this.banner=null,this.backButton=null,this.renderSwitch=null,this.decelerateConfirmPrefabName=null,this.moduleManager=new $.default,this.propertyProc=new oe.default(this),this.canClickStart=!0,this.FIRST_STAGE_POSITION=265,this.renderSwitch=O,this.bannerNode=w.getChildByName("banner"),B.default.getInstance().setNeedShowGuideInResultPage(!1)}return re.prototype.allowProperty=function(){return!1},re.prototype.initilize=function(){if(this.effectiveSkin=d.G.Ap.skinMgr.getCurrentSkinItem(),this.atlasGameObject=g.default.getInstance().getAtlas(),this.effectiveSkin){var O=this.effectiveSkin.getSkinObject(),w=O.skinRaw.getBlockAtlasName();Z.default.getInstance().setAtlas(O.atlasMap[w]),d.G.Ap.config.longBlockDotAnimEnable=O.skinRaw.getDesign().longBlockDotAnimaion,d.G.Ap.config.longBlockChangeLength=O.skinRaw.getDesign().longBlockChangeLength,d.G.Ap.config.longBlockBounceEffectByDistance=O.skinRaw.getDesign().longBlockBounceEffectByDistance||-1}},re.prototype.getEnableModuleList=function(){return null},re.prototype.setEntryInterface=function(O){this.entryInterface=O},re.prototype.onLoad=function(){_.UICache.musicListView&&_.UICache.hideMusicView(),V.default.read(Y.default.HAS_FIRST_PLAY_LITTLE_STAR)!="true"?me.StringUtil.isEmpty(V.default.read(Y.default.IS_NEW_RECORD_TIME))&&(V.default.save(Y.default.IS_NEW_TO_SHOW_GUIDE,"true"),V.default.save(Y.default.IS_NEW_RECORD_TIME,he.MGUser.getCurrentServerTime().toString())):V.default.save(Y.default.IS_NEW_TO_SHOW_GUIDE,"false"),V.default.save(Y.default.HAS_FIRST_PLAY_LITTLE_STAR,"true"),x.default.hide(),this.moduleManager.setEnableModuleList(this.getEnableModuleList()),this.moduleManager.loadAllModules(),D.default.getInstance().animationMgr=new C.default,D.default.getInstance().scheduler=new v.default,D.default.getInstance().natureScheduler=new v.default,this.stageStates[s.Utility.GAMESTAGE.MUSIC]=new se(!1),this.stageStates[s.Utility.GAMESTAGE.MONEY]=new se(!1),this.stageStates[s.Utility.GAMESTAGE.INFINITE]=new se(!1),this.gameSceneSize.width=d.G.Ap.config.presentWidth,this.gameSceneSize.height=d.G.Ap.config.presentHeight,this.blockRegionSize.width=this.gameSceneSize.width,this.blockRegionSize.height=this.gameSceneSize.height,this.doLoading(),this.buildPerformanceCounter()},re.prototype.loadReliveAdv=function(){},re.prototype.start=function(){this.adaptationUI()},re.prototype.updateScreenRatio=function(){d.G.Ap.config.presentScale=cc.game.canvas.width/d.G.Ap.config.designWidth,this.uiBoard.getRootNode().setScale(d.G.Ap.config.presentScale),this.spliteLine.updateLines(d.G.Ap.config.presentScale),this.keyTouchLine&&this.keyTouchLine.updateLines(d.G.Ap.config.presentScale)},re.prototype.render=function(O){this.uiBoard.render(O)},re.prototype.renderToTexture=function(O,w){this.uiBoard.renderToTexture(O,w)},re.prototype.update=function(O,w){var G=d.G.Ap;if(G.config.gameSceneTest?G.autoTester.isStart()?(G.autoTester.attachGame(this),G.autoTester.update(O)):this.performanceUpdate(O):this.performanceUpdate(w),D.default.getInstance().natureScheduler.update(w),D.default.getInstance().scheduler.update(O),D.default.getInstance().animationMgr.update(O),!G.state.isPaused()){var K=this.currentStage;K&&K.update(O),this.player.update(O)}},re.prototype.onDestroy=function(){this.firstStage?(this.firstStage.clearCache(),this.firstStage.destroy()):this.infiniteStage&&(this.infiniteStage.clearCache(),this.infiniteStage.destroy()),this.moneyStage&&(this.moneyStage.clearCache(),this.moneyStage.destroy()),D.default.getInstance().animationMgr.stopAllActions(),D.default.getInstance().animationMgr=null,D.default.getInstance().scheduler.unScheduleAll(),D.default.getInstance().scheduler=null,D.default.getInstance().natureScheduler.unScheduleAll(),D.default.getInstance().natureScheduler=null,this.moduleManager.destroyAllModules(),this.overtakeFriend=null,this.propertyProc&&this.propertyProc.uninitialize(),this.uiBoard&&this.uiBoard.uninitilize(pe.MUI.global.ctx)},re.prototype.doLoading=function(){var O=this;this.createUI(),this.loadMusic(),this.updateUI(),this.createAnimCtrl(),z.default.getInstance().init(),this.mReviveController=new c.default;var w=new oe.PropertyHandlerParam,G=this.renderSwitch.getRenderNode();w.iconNode=this.propertiesIconNode,w.effectNode=this.propertiesEffectNode,this.setPropertyIntroductionClickCb(function(K){O.canClickStart=K}),this.propertyProc&&this.propertyProc.initialize(w,G)},re.prototype.createUI=function(){var O=g.default.getInstance().getAtlas2();if(this.uiBoard=new E.default,this.uiBoard.setSize(this.gameSceneSize.width,this.gameSceneSize.height),this.uiBoard.initilize(pe.MUI.global.ctx),this.uiBoard.getRootNode().setScale(d.G.Ap.config.presentScale),this.effectiveSkin){var w=this.effectiveSkin.getSkinObject();if(w){var G=w.skinRaw.createBackgroundNode(w,Q.default.instance);G&&(this.uiBoard.getRootNode().addChild(G),this.backgroundNode=G);var K=new A.default;this.uiBoard.getRootNode().addChild(K),this.backgroundEffectNode=K}}this.blockRegionNode=new A.default,this.uiBoard.getRootNode().addChild(this.blockRegionNode);var X=new A.default;X.move(0,0,this.gameSceneSize.width,this.gameSceneSize.height),this.blockRegionNode.addChild(X,s.Utility.GAMESTAGE.MUSIC);var te=new A.default;te.move(0,0,this.gameSceneSize.width,this.gameSceneSize.height),this.blockRegionNode.addChild(te,s.Utility.GAMESTAGE.MONEY),this.spliteLine=new F.default("SplitLine"),this.spliteLine.move(0,0,this.gameSceneSize.width,this.gameSceneSize.height),this.uiBoard.getRootNode().addChild(this.spliteLine),Ue.default.isHorizon()&&(this.keyTouchLine=new be.default("KeyTouchLine"),this.spliteLine.move(0,0,this.gameSceneSize.width,this.gameSceneSize.height),this.uiBoard.getRootNode().addChild(this.keyTouchLine)),this.createPropertiesEffectNode();var ne=new A.default("StageCaption");this.uiBoard.getRootNode().addChild(ne);var ae=new M.default("InfiniteStageCaption");ae.setVisible(!1),ae.setOpacity(0),ae.imageData=O,ae.imageItem=O.getItem("title_endless"),(ce=ae.imageItem.rect.clone()).width*=2,ce.height*=2,ae.setContentSize(ce.width,ce.height),ae.setPosition(-ce.width/2,-ce.height);var le=new M.default("wujin 2");le.imageData=O,le.imageItem=ae.imageItem,le.setContentSize(ce.width,ce.height),ae.addChild(le),ne.addChild(ae);var ce,fe=new M.default("MoneyStageCaption");fe.setVisible(!1),fe.setOpacity(0),fe.imageData=O,fe.imageItem=O.getItem("title_gold"),(ce=fe.imageItem.rect.clone()).width*=2,ce.height*=2,fe.move(-ce.width/2,-ce.height,ce.width,ce.height);var _e=new M.default("gameover_star1");_e.imageData=this.atlasGameObject,_e.imageItem=this.atlasGameObject.getItem("starlight"),_e.move(-113,122,106,132),fe.addChild(_e);var Ae=new M.default("gameover_star2");Ae.imageData=this.atlasGameObject,Ae.imageItem=_e.imageItem,Ae.move(669,119,106,132),fe.addChild(Ae),ne.addChild(fe);var ze=new A.default("FeedLayer");this.uiBoard.getRootNode().addChild(ze);var qe=140,we=new A.default("MoneyPanel");we.setVisible(!1),we.setScale(.3),we.move(this.gameSceneSize.width-qe,this.gameSceneSize.height-76,0,0),ze.addChild(we);var ke=160,Qe=new M.default("MoneyIcon");Qe.imageData=this.atlasGameObject,Qe.imageItem=this.atlasGameObject.getItem("ic_gold"),Qe.move(0,-ke,ke,ke),we.addChild(Qe);var xe=new N.default(R.default.getInstance().getAtlas(),2,"MoneyText");xe.setNumberColor(N.NumberColor.WHITE),xe.setCenterNumber(!1);var Ve=R.default.getInstance().getItemRect();xe.move(1.1*ke,-Ve.height/2-ke/2,0,Ve.height),xe.setNumberValue(0),we.addChild(xe),qe=140;var Fe=new A.default("GiftPanel");Fe.setVisible(!1),Fe.setScale(.3),Fe.move(this.gameSceneSize.width-qe,this.gameSceneSize.height-76,0,0),ze.addChild(Fe),ke=160;var je=new M.default("GiftIcon");je.imageData=this.atlasGameObject,je.imageItem=this.atlasGameObject.getItem("ic_gift"),je.move(0,-ke,ke,ke),Fe.addChild(je);var We=new N.default(R.default.getInstance().getAtlas(),2,"GiftText");We.setNumberColor(N.NumberColor.WHITE),We.setCenterNumber(!1),Ve=R.default.getInstance().getItemRect(),We.move(1.1*ke,-Ve.height/2-ke/2,0,Ve.height),We.setNumberValue(0),Fe.addChild(We),this.createPropertiesIconNode(),this.scoreAnimation=new e.default(this.gameSceneSize,this.uiBoard.getRootNode());var Ge=new A.default("StarAnimation");Ge.setVisible(!1),Ge.setScale(1),Ge.move(d.G.Ap.config.presentWidth/2,.9*d.G.Ap.config.presentHeight,0,0),this.uiBoard.getRootNode().addChild(Ge);for(var Me=new cc.Size(113,140),Ne=1;Ne<=3;++Ne){var Ke=new M.default("honor"+Ne);Ke.imageData=this.atlasGameObject,Ke.imageItem=this.atlasGameObject.getItem("star"),Ke.move(-(Me.width>>>1),-Me.height,Me.width,Me.height),Ke.setOpacity(0),Ge.addChild(Ke)}var Xe=(De=new cc.Size(158,190)).height-Me.height>>>1;(Le=new M.default("honorlight")).imageData=this.atlasGameObject,Le.imageItem=this.atlasGameObject.getItem("starlight"),Le.move(-(De.width>>>1),-De.height+Xe,De.width,De.height),Le.setOpacity(0),Ge.addChild(Le);var Oe=new A.default("CrownAnimation");for(Oe.setVisible(!1),Oe.setScale(1),Oe.move(d.G.Ap.config.presentWidth/2,.9*d.G.Ap.config.presentHeight,0,0),this.uiBoard.getRootNode().addChild(Oe),Me=new cc.Size(99,94),Ne=1;Ne<=3;++Ne){var Ye=new M.default("honor"+Ne);Ye.imageData=this.atlasGameObject,Ye.imageItem=this.atlasGameObject.getItem("crown"),Ye.move(-(Me.width>>>1),-Me.height,Me.width,Me.height),Ye.setOpacity(0),Oe.addChild(Ye)}var De,Le;Xe=(De=new cc.Size(130,122)).height-Me.height>>>1,(Le=new M.default("honorlight")).imageData=this.atlasGameObject,Le.imageItem=this.atlasGameObject.getItem("crownlight"),Le.move(-(De.width>>>1),-De.height+Xe,De.width,De.height),Le.setOpacity(0),Oe.addChild(Le),this.banner=new T.default("banner",this.bannerNode),this.uiBoard.getRootNode().addChild(this.banner),this.backButton=new U.default,this.uiBoard.getRootNode().addChild(this.backButton),this.moduleManager.addAllModulesToRootNode(this.uiBoard.getRootNode(),!0),this.overtakeFriend=this.moduleManager.getModule($.ModuleType.Overtake_Friend),this.overtakeFriend&&this.overtakeFriend.hideNode(),this.qqRedPacket=this.moduleManager.getModule($.ModuleType.QQ_Red_Packet),this.blockTouchEffectNode=new A.default("BlockTouchEffectNode"),this.uiBoard.getRootNode().addChild(this.blockTouchEffectNode),this.starCountSwitch=new o.default(this.effectiveSkin,this.backgroundNode,this.backgroundEffectNode,this.blockTouchEffectNode)},re.prototype.createPropertiesEffectNode=function(){this.allowProperty()&&(this.propertiesEffectNode=new A.default("propertiesEffectNode"),this.propertiesEffectNode.move(0,0,this.gameSceneSize.width,this.gameSceneSize.height),this.uiBoard.getRootNode().addChild(this.propertiesEffectNode))},re.prototype.createPropertiesIconNode=function(){this.allowProperty()&&(this.propertiesIconNode=new A.default("PropertiesIconNode"),this.propertiesIconNode.move(0,0,this.gameSceneSize.width,this.gameSceneSize.height),this.uiBoard.getRootNode().addChild(this.propertiesIconNode))},re.prototype.updateUI=function(){if(this.music){var O=Be.default.getInstance().getLanguageByKey(this.music.getName()),w=Be.default.getInstance().getLanguageByKey("label_text.game_history_top")+(this.levelRecord?this.levelRecord.mBestScore:0);this.banner.show(O,w)}B.default.getInstance().getFromSource(),this.backButton.setVisible(!1)},re.prototype.createAnimCtrl=function(){var O=this.uiBoard.getRootNode().getChildByName("FeedLayer");this.cookiesNodeCache=new y.CookiesNodeCache(O,this.atlasGameObject,this.atlasGameObject.getItem("light_gold"),this.atlasGameObject.getItem("ic_gift")),this.cookieAnimation=new S.default(this.uiBoard.getRootNode())},re.prototype.adaptationUI=function(){var O=new cc.Size(686,168);if(I.SUtil.ins().isLiuHai()){var w=this.uiBoard.getRootNode().getChildByName("FeedLayer");w.getChildByName("MoneyPanel").setPositionY(.889*this.gameSceneSize.height),w.getChildByName("GiftPanel").setPositionY(.889*this.gameSceneSize.height);var G=.877*this.gameSceneSize.height;this.scoreAnimation.setPositionY(G),this.scoreAnimation.setScale(1),this.uiBoard.getRootNode().getChildByName("StarAnimation").setPositionY(G),this.uiBoard.getRootNode().getChildByName("CrownAnimation").setPositionY(G),(K=this.uiBoard.getRootNode().getChildByName("StageCaption")).setScale(.503*this.gameSceneSize.width/O.width),K.setPosition(this.gameSceneSize.width/2,G),this.banner.adaptPosition(.913*this.gameSceneSize.height),this.backButton.updatePosition(.946*this.gameSceneSize.height)}else if(I.SUtil.ins().isQuanMian())G=this.gameSceneSize.height-143,this.scoreAnimation.setPositionY(G),(K=this.uiBoard.getRootNode().getChildByName("StageCaption")).setScale(.503*this.gameSceneSize.width/O.width),K.setPosition(this.gameSceneSize.width/2,G),this.uiBoard.getRootNode().getChildByName("StarAnimation").setPositionY(G),this.uiBoard.getRootNode().getChildByName("CrownAnimation").setPositionY(G),this.backButton.updatePosition(.977*this.gameSceneSize.height);else if(I.SUtil.ins().isPuTong()){var K;G=this.gameSceneSize.height-132,this.scoreAnimation.setPositionY(G),(K=this.uiBoard.getRootNode().getChildByName("StageCaption")).setScale(.419*this.gameSceneSize.width/O.width),K.setPosition(this.gameSceneSize.width/2,G),this.uiBoard.getRootNode().getChildByName("StarAnimation").setPositionY(G),this.uiBoard.getRootNode().getChildByName("CrownAnimation").setPositionY(G),this.backButton.updatePosition(.986*this.gameSceneSize.height)}},re.prototype.loadMusic=function(){if(this.level=p.LevelMgr.Ins().getLevelByMid(d.G.Ap.state.mission.musicId),this.level!=null){this.levelRecord=h.default.Ins().getLevelRecordByMid(d.G.Ap.state.mission.musicId);var O=d.G.Ap.config.getMusic(d.G.Ap.state.mission.musicId);O&&(this.music=O,this.music.getMusicPart(0)&&this.player.setBpm(this.music.getMusicPart(0).getBPM()),this.initGame())}},re.prototype.initGoldAddition=function(O){return d.G.propAddition.getAdditionGainMoney(O,d.G.Ap.state.mission.getType().toString())},re.prototype.initGame=function(){if(console.log("initGameinitGameinitGame"),this.music){this.getGameRegion();var O=this.levelRecord==null||this.levelRecord.mBestStar<3;if(O){var w=p.LevelMgr.Ins().getRewardGold(this.level.id),G=this.initGoldAddition(w.gold);Se.default.e("\u6E38\u620F\u8FC7\u7A0B\u4E2D\u91D1\u5E01\u6570\u91CF \u52A0\u6210\uFF1A"+w.gold+"   =>  "+G),w.gold=G;var K=this.getGameNode(),X=new Te.default(K.getChildByTag(s.Utility.GAMESTAGE.MONEY));this.moneyStage=new a.default(this,X,w.gold,w.goldline),this.moneyStage.init(),this.moneyStage.activeNode(!1)}var te=this.getGameNode(),ne=new Te.default(te.getChildByTag(s.Utility.GAMESTAGE.MUSIC));this.firstStage=new i.default(this,ne,!O),this.firstStage.init(this.FIRST_STAGE_POSITION),this.firstStage.activeNode(!0),this.qqRedPacket&&this.firstStage.setShowGiftBox(!1),this.infiniteStage=this.firstStage,this.currentStage=this.firstStage,this.startGameStageSwitch(s.Utility.GAMESTAGE.MUSIC)}},re.prototype.restartGame=function(){d.G.Ap.state.pause(),this.currentStage&&this.currentStage.resetGameData(),this.startRun()},re.prototype.pauseGame=function(){if(this.stageStates!=null){var O=d.G.Ap.state.getGameStage();switch(O){case s.Utility.GAMESTAGE.MUSIC:(w=this.stageStates[O])&&w.finish?(this.moneyStage?this.startGameStageSwitch(s.Utility.GAMESTAGE.MONEY):this.startGameStageSwitch(s.Utility.GAMESTAGE.INFINITE),this.currentStage&&this.currentStage.setCurrentSegmentPaused()?d.G.Ap.state.pause():console.warn("stage pause failed "+this.currentStage&&this.currentStage.type)):this.firstStage.setCurrentSegmentPaused()?d.G.Ap.state.pause():console.warn("music stage pause failed.");break;case s.Utility.GAMESTAGE.MONEY:var w;(w=this.stageStates[O])&&w.finish?(this.startGameStageSwitch(s.Utility.GAMESTAGE.INFINITE),this.currentStage&&this.currentStage.setCurrentSegmentPaused()?d.G.Ap.state.pause():console.warn("stage pause failed "+this.currentStage&&this.currentStage.type)):this.moneyStage&&this.moneyStage.setCurrentSegmentPaused()?d.G.Ap.state.pause():console.warn("money stage pause failed.");break;case s.Utility.GAMESTAGE.INFINITE:this.infiniteStage.setCurrentSegmentPaused()?d.G.Ap.state.pause():console.warn("infinite stage pause failed.")}this.updatePerformanceStatus(r.PERFORMANCE_STATUS.Pause),this.propertyProc&&this.propertyProc.onGamePause()}else console.warn("pauseGame this.stageStates is null.")},re.prototype.resumeGame=function(){console.log("--- resumeGame ---"),this.slowRaiseGameSpeed(),d.G.Ap.state.resume(),this.updatePerformanceStatus(r.PERFORMANCE_STATUS.Resume),this.propertyProc&&this.propertyProc.onGameResume()},re.prototype.slowRaiseGameSpeed=function(){var O=this;this.currentStage&&this.currentStage.setSpeedScale(!0),this.setShedule(function(){O.currentStage&&O.currentStage.restoreSpeed()},.25,this.currentStage&&this.currentStage.getRestoreCount(),.1)},re.prototype.onGameNodeTouchStart=function(O){this.backButton.touchStart(O)?Se.default.l("onGameNodeTouchStart this.backButton.touchStart"):this.canClickStart?this.currentStage&&this.currentStage.onTouchStart(O):Se.default.l("onGameNodeTouchStart !this.canClickStart")},re.prototype.onGameNodeTouchEnd=function(O){this.backButton.touchEnd()||this.currentStage&&this.currentStage.onTouchEnd(O)},re.prototype.onGameNodeTouchCancel=function(O){this.onGameNodeTouchEnd(O)},re.prototype.onGameNodeTouchMove=function(O){this.currentStage&&this.currentStage.onTouchMove(O)},re.prototype.getPlayer=function(){return this.player},re.prototype.getMusic=function(){return this.music},re.prototype.getGameRegion=function(){return this.blockRegionSize},re.prototype.getGameNode=function(){return this.blockRegionNode},re.prototype.getAtlasGameObject=function(){return this.atlasGameObject},re.prototype.getLevel=function(){return this.level},re.prototype.getCurrentStage=function(){return this.currentStage},re.prototype.startRun=function(){this.slowRaiseGameSpeed();var O=d.G.Ap.state;O.gameStart(),O.resume(),this.banner.hide(),this.renderSwitch.disableCocosRender(),this.renderSwitch.enableTouchHandler(),this.fixRenderIssue(),this.moduleManager.startAllModules(),!this.qqRedPacket&&this.overtakeFriend&&this.overtakeFriend.showNode(),this.updatePerformanceStatus(r.PERFORMANCE_STATUS.Begin),this.entryInterface&&this.entryInterface.gameStartRun(),this.propertyProc&&this.propertyProc.onGameStart(),CMPlay.getQueryString("platform","default")!="qtt"&&this.fixTouchIssue()},re.prototype.stopRun=function(){this.currentStage&&this.currentStage.setRunning(!1)},re.prototype.fixRenderIssue=function(){var O=cc.view.getDesignResolutionSize();cc.view.setDesignResolutionSize(O.width,O.height,cc.view.getResolutionPolicy())},re.prototype.fixTouchIssue=function(){var O=this,w=5*this.FRAME_TIME,G=new k.default(new b.default(w),new L.default(function(){cc.inputManager.update(w),O.renderSwitch.disableCocosTouch()}));D.default.getInstance().animationMgr.runAction(this.uiBoard.getRootNode(),G)},re.prototype.gameWillOver=function(O,w){this.propertyProc&&this.propertyProc.beforeGameOver(O,w)},re.prototype.gameOver=function(){if(d.G.Ap.antiCheat.isHit()){var O=d.G.Ap.performanceCounter,w=d.G.Ap.antiCheat.getOperatingCount(),G=this.currentStage?this.currentStage&&this.currentStage.getSpeed():0;w.setTotalScore(d.G.Ap.state.attainScore),w.setPlayTime(O.getDuration()),w.setBlockHeight(d.G.Ap.config.mBaseBlockHeight),w.setFPS(O.getFPS()),w.setMusicId(d.G.Ap.state.mission.musicId),w.setAPM(G/Math.max(d.G.Ap.config.mBaseBlockHeight,1)),w.setFpsArray(O.getFpsArray()),this.setUserInfo(w)}d.G.Ap.state.pause(),this.moduleManager.pauseAllModules(),this.showReliveDialog(),this.updatePerformanceStatus(r.PERFORMANCE_STATUS.End)},re.prototype.showReliveDialog=function(){var O=this,w=c.ReliveMode.NORMAL,G=d.G.Ap.state.attainScore;this.qqRedPacket&&G<j.default.TARGET_SCORE&&(w=c.ReliveMode.QQ_RED_PACK);var K=this.mReviveController.getReliveType(G,w);return K!=c.default.RESULT_CAN_NOT_REVIVE?(this.mReviveController.initLevelInfo(d.G.Ap.state.mission.levelId),this.mReviveController.initReliveData(w,G),de.default.load("prefab/RelivePrefb",function(X,te){if(te){O.renderSwitch.saveStatus(),O.renderSwitch.enableCocosRender(),O.renderSwitch.enableCocosTouch(),O.renderSwitch.disableTouchHandler();var ne=te.getComponent(u.default);ne&&(ne.setReliveScoreDataCallback(function(){return O.getReliveScoreData()}),ne.setReliveCallback(function(ae){ye.MGAdv.hideBanner(ge.ADScene.RELIVE_POPUP),ye.MGAdv.destroyBanner(ge.ADScene.RELIVE_POPUP),ee.default.Ins().pop("ReliveDialog"),O.renderSwitch.getRenderNode().removeChild(te),te.destroy(),O.propertyProc&&O.propertyProc.setRelivePropType(ae),O.showPopupWithProperty(K)}),ne.setCancelGameCallback(function(){O.gameCancel()}),ne.setReviveController(O.mReviveController)),O.renderSwitch.getRenderNode().addChild(te,u.GAMESCENEZORDER.RELIVE),ee.default.Ins().push("ReliveDialog")}})):(this.gameCancel(),d.G.Ap.state.gameOver(),d.G.Ap.presenter.enterScene(d.G.GAME_OVER_SCENE_NAME,d.G.Ap.state.mission.musicId)),this.propertyProc&&this.propertyProc.onGameOver(),K},re.prototype.finishGameStage=function(O){var w=this;if(d.G.Ap.state,this.stageStates[O].finish=!0,this.propertyProc&&this.propertyProc.onGameStageFinish(O),O===s.Utility.GAMESTAGE.MUSIC)if(this.moneyStage==null){var G=d.G.Ap.config.enterStageDelay;(K=g.default.getInstance().getAnimations("honor_three"))&&(G=K.getDuration()+.3),this.setSheduleOnce(function(){w.scoreAnimation.setScoreAnimationShow(!1),w.startGameStageCaptionAnimation(s.Utility.GAMESTAGE.INFINITE),w.setSheduleOnce(function(){w.scoreAnimation.setScoreAnimationShow(!0)},d.G.Ap.config.scoreDelayAfterStageCaption)},G),this.startGameStageSwitch(s.Utility.GAMESTAGE.INFINITE)}else{var K;G=d.G.Ap.config.enterStageDelay,(K=g.default.getInstance().getAnimations("honor_three"))&&(G=K.getDuration()+.3),this.setSheduleOnce(function(){w.scoreAnimation.setScoreAnimationShow(!1),w.startGameStageCaptionAnimation(s.Utility.GAMESTAGE.MONEY),w.setSheduleOnce(function(){w.scoreAnimation.setScoreAnimationShow(!0)},d.G.Ap.config.scoreDelayAfterStageCaption),w.setSheduleOnce(function(){w.startGameStageSwitch(s.Utility.GAMESTAGE.MONEY)},d.G.Ap.config.moneyWalkDelay)},G)}else O===s.Utility.GAMESTAGE.MONEY&&(this.scoreAnimation.setScoreAnimationShow(!1),this.startGameStageCaptionAnimation(s.Utility.GAMESTAGE.INFINITE),this.setSheduleOnce(function(){w.scoreAnimation.setScoreAnimationShow(!0)},d.G.Ap.config.scoreDelayAfterStageCaption),this.setSheduleOnce(function(){w.startGameStageSwitch(s.Utility.GAMESTAGE.INFINITE)},d.G.Ap.config.infiniteWalkDelay))},re.prototype.pulledGameStage=function(O,w,G){switch(O){case s.Utility.GAMESTAGE.MONEY:this.firstStage&&(this.firstStage.allFalled()?this.firstStage=null:this.firstStage.pull(w));break;case s.Utility.GAMESTAGE.INFINITE:this.moneyStage&&(this.moneyStage.pull(w),this.moneyStage.allFalled()&&(this.moneyStage.destroy(),this.moneyStage=null));break;case s.Utility.GAMESTAGE.MUSIC:}},re.prototype.attainStar=function(){var O=this;d.G.Ap.state.addStar(),this.propertyProc&&this.propertyProc.onAttainHonor(d.G.Ap.state.attainStars,0),this.scoreAnimation.setScoreAnimationShow(!1);var w=this.uiBoard.getRootNode().getChildByName("StarAnimation");w.setVisible(!0);var G=["honor_one","honor_two","honor_three"],K=g.default.getInstance().getAnimations(G[d.G.Ap.state.attainStars-1]);if(K){var X=new b.default(d.G.Ap.config.honorAnimStayTime),te=new L.default(function(){w.setVisible(!1),d.G.Ap.state.attainStars!=3&&O.scoreAnimation.setScoreAnimationShow(!0)});D.default.getInstance().animationMgr.runAction(w,new k.default(K,X,te))}else w.setVisible(!1),d.G.Ap.state.attainStars!=3&&this.scoreAnimation.setScoreAnimationShow(!0),console.warn("Load animation failed. name = "+G[d.G.Ap.state.attainStars-1]);this.starCountSwitch.changeStarCount(d.G.Ap.state.attainStars)},re.prototype.attainCrown=function(){var O=this;d.G.Ap.state.addCrown(),this.propertyProc&&this.propertyProc.onAttainHonor(d.G.Ap.state.attainStars,d.G.Ap.state.attainCrowns),this.scoreAnimation.setScoreAnimationShow(!1);var w=this.uiBoard.getRootNode().getChildByName("CrownAnimation");w.setVisible(!0);var G=["honor_one","honor_two","honor_three"],K=g.default.getInstance().getAnimations(G[d.G.Ap.state.attainCrowns-1]);if(K){var X=new b.default(d.G.Ap.config.honorAnimStayTime),te=new L.default(function(){w.setVisible(!1),O.scoreAnimation.setScoreAnimationShow(!0)});D.default.getInstance().animationMgr.runAction(w,new k.default(K,X,te))}else w.setVisible(!1),this.scoreAnimation.setScoreAnimationShow(!0),console.warn("Load animation failed. name = "+G[d.G.Ap.state.attainCrowns-1])},re.prototype.attainScore=function(O){O<=0||(d.G.Ap.state.addScore(O),this.updateModules(),d.G.Ap.config.debugNoScoreAnim||this.scoreAnimation.showAttainScoreAnimation(d.G.Ap.state.attainScore))},re.prototype.updateModules=function(){this.qqRedPacket?this.qqRedPacket.update()||this.overtakeFriend&&(this.overtakeFriend.showNode(),this.overtakeFriend.update()):this.overtakeFriend&&this.overtakeFriend.update()},re.prototype.attainMoney=function(O){var w=d.G.Ap.state.addMoney();d.G.Ap.config.debugNoFlyMoneyAnim||this.createMoneyFlyAnimation(O,w)},re.prototype.attainGift=function(O){var w=d.G.Ap.state.addGift(0);this.startGiftFlyAnimation(O,w)},re.prototype.attainBlockEffect=function(O,w){var G=this.propertyProc&&this.propertyProc.getStopBlockEffect();if(this.effectiveSkin&&!G&&this.effectiveSkin.getSkinObject()){var K=this.starCountSwitch.getCurrentBlockEffect(),X=K.getNode(w);if(X){var te=X.getRect();X.setPosition(O.x-(te.width>>>1),O.y-(te.height>>>1)),X.setVisible(!0);var ne=K.getAction(w),ae=null;ne?ae=new k.default(ne,new L.default(function(){K.putAction(ne,w),X.setVisible(!1)})):(console.warn("attainBlockEffect animation is null."),ae=new L.default(function(){X.setVisible(!1)})),D.default.getInstance().animationMgr.runAction(X,ae)}}},re.prototype.setSheduleOnce=function(O,w){D.default.getInstance().scheduler.scheduleOnce(O,w)},re.prototype.setShedule=function(O,w,G,K){D.default.getInstance().scheduler.scheduleLoop(O,w,G,K)},re.prototype.setNatureSheduleOnce=function(O,w){D.default.getInstance().natureScheduler.scheduleOnce(O,w)},re.prototype.setNatureShedule=function(O,w,G,K,X){D.default.getInstance().natureScheduler.scheduleLoop(O,w,G,K,X)},re.prototype.cancelNatureShedule=function(O){D.default.getInstance().natureScheduler.unSchedule(O)},re.prototype.gameBackground=function(){},re.prototype.gameForeground=function(){},re.prototype.createMoneyFlyAnimation=function(O,w){var G=this,K=this.cookiesNodeCache.getDynamicly(y.COOKIESTYPE.MONEY);K.setPosition(O.x-(K.getWidth()>>>1),O.y-(K.getHeight()>>>1)),this.uiBoard.getRootNode().getChildByName("FeedLayer").addChild(K),this.cookieAnimation.showMoneyFlyAnimation(K,w,function(){G.cookiesNodeCache.put(y.COOKIESTYPE.MONEY,K)||(K||console.error("money animation remove error"),K.removeFromParent())})},re.prototype.startGameStageSwitch=function(O){if(d.G.Ap.state.getGameStage()!=O){if(d.G.Ap.state.enterGameStage(O),this.propertyProc&&this.propertyProc.onGameStageStart(O),O===s.Utility.GAMESTAGE.MUSIC)this.moduleManager.prepareAllModules();else if(O===s.Utility.GAMESTAGE.MONEY)d.G.Ap.config.debugNoBlockSound||this.playPassAudio(),this.firstStage&&(this.firstStage.setRunning(!1),this.moneyStage.setSpeed(this.firstStage.getSpeed())),this.currentStage=this.moneyStage,this.moneyStage.activeNode(!0),(w=this.uiBoard.getRootNode().getChildByName("FeedLayer")).getChildByName("MoneyPanel").setVisible(!0),w.getChildByName("GiftPanel").setVisible(!1);else if(O===s.Utility.GAMESTAGE.INFINITE){var w;H.default.stop(H.default.NAME_PASS_BACKGRIUND),this.moneyStage&&this.moneyStage.setRunning(!1),this.firstStage=null,this.infiniteStage.type=s.Utility.GAMESTAGE.INFINITE,this.infiniteStage.setRunning(!0),this.infiniteStage.activeNode(!0),this.currentStage=this.infiniteStage,(w=this.uiBoard.getRootNode().getChildByName("FeedLayer")).getChildByName("MoneyPanel").setVisible(!1),w.getChildByName("GiftPanel").setVisible(!1)}}else console.warn("try reentry game stage "+O)},re.prototype.playPassAudio=function(){H.default.play(H.default.NAME_PASS_BACKGRIUND,H.default.PATH_PASS_BACKGRIUND,!1)},re.prototype.startGameStageCaptionAnimation=function(O){switch(O){case s.Utility.GAMESTAGE.MONEY:var w=this.uiBoard.getRootNode().getChildByName("StageCaption").getChildByName("MoneyStageCaption");w.setVisible(!0),(G=g.default.getInstance().getAnimations("kinbi"))?D.default.getInstance().animationMgr.runAction(w,G):console.warn("Load kinbi animation error."),D.default.getInstance().scheduler.scheduleOnce(function(){w.setVisible(!1)},3);break;case s.Utility.GAMESTAGE.INFINITE:var G,K=this.uiBoard.getRootNode().getChildByName("StageCaption").getChildByName("InfiniteStageCaption");K.setVisible(!0),(G=g.default.getInstance().getAnimations("wujin"))?D.default.getInstance().animationMgr.runAction(K,G):console.warn("Load wujin animation error."),D.default.getInstance().scheduler.scheduleOnce(function(){K.setVisible(!1)},3)}},re.prototype.startGiftFlyAnimation=function(O,w){var G=this,K=this.cookiesNodeCache.getDynamicly(y.COOKIESTYPE.GIFT);K.setPosition(O.x-(K.getWidth()>>>1),O.y-(K.getHeight()>>>1)),this.uiBoard.getRootNode().getChildByName("FeedLayer").addChild(K),this.cookieAnimation.showGiftFlyAnimation(K,w,function(){G.cookiesNodeCache.put(y.COOKIESTYPE.GIFT,K)||(K||console.error("giftNode animation remove error"),K.removeFromParent())})},re.prototype.gameCancel=function(){this.propertyProc&&this.propertyProc.onGameCancel()},re.prototype.reliveGame=function(O){d.G.Ap.state.addReliveTimes(),this.moduleManager.resumeAllModules(),console.warn("==== reliveGame ===="),this.currentStage&&this.currentStage.relive(),this.propertyProc&&this.propertyProc.onGameRelive()},re.prototype.getReliveScoreData=function(){var O=new f.default;return O.crownType=this.getNextCrownType(),O.crownType!=f.CrownType.CrownType_NONE&&(O.score=this.currentStage?this.currentStage.getNextHonorScore():100),O},re.prototype.getNextCrownType=function(){var O=this.getCrownType();return O==f.CrownType.CrownType_THREE_CROWN?f.CrownType.CrownType_NONE:O+1},re.prototype.getCrownType=function(){var O=f.CrownType.CrownType_NONE;switch(d.G.Ap.state.gameStage){case s.Utility.GAMESTAGE.MONEY:O=f.CrownType.CrownType_THREE_STAR;break;case s.Utility.GAMESTAGE.MUSIC:var w=d.G.Ap.state.attainStars;w==1?O=f.CrownType.CrownType_ONE_STAR:w==2?O=f.CrownType.CrownType_TWO_STAR:w==3&&(O=f.CrownType.CrownType_THREE_STAR);break;case s.Utility.GAMESTAGE.INFINITE:var G=d.G.Ap.state.attainCrowns;O=G==1?f.CrownType.CrownType_ONE_CROWN:G==2?f.CrownType.CrownType_TWO_CROWN:G==3?f.CrownType.CrownType_THREE_CROWN:f.CrownType.CrownType_THREE_STAR}return O},re.prototype.performanceUpdate=function(O){d.G.Ap.state.getMission().getType()===W.MISSIONTYPE.Rank?d.G.Ap.config.debugAutoLog?this.performance.updateAndAutoLog(O):this.performance.update(O):r.Performance.Counter.update(O)},re.prototype.setUserInfo=function(O){var w=V.default.read(Y.default.UserInfo),G=new q.default;J.default.parseToUser(w,G),O.setUserLevel(G.level),O.setUserDiamond(G.diamond),O.setUserHp(G.hp)},re.prototype.updatePerformanceStatus=function(O){var w=d.G.Ap.performanceCounter;w.getStatus()!==O&&w.setStatus(O)},re.prototype.showPopupWithProperty=function(O){var w=this,G=this.propertyProc?this.propertyProc.getResumeCount(ie.PROPERTYTYPE.GAME_SLOW):0;G&&0<G?de.default.load(this.decelerateConfirmPrefabName,function(K,X){if(X){var te=X.getComponent(ue.default);te.setConfirmCallback(function(){w.propertyProc.setDecelerateLoad(!0)}),te.setCancelCallback(function(){w.propertyProc.setDecelerateLoad(!1)}),te.setDestroyCallback(function(){w.renderSwitch.getRenderNode().removeChild(X),X.destroy(),w.renderSwitch.restoreStatus(),w.reliveGame(O)}),w.renderSwitch.getRenderNode().addChild(X,100)}}):(this.propertyProc&&this.propertyProc.setDecelerateLoad(!1),this.renderSwitch.restoreStatus(),this.reliveGame(O))},re.prototype.getRunningProperty=function(){return this.propertyProc?this.propertyProc.getRunningProperty():null},re.prototype.getGameSceneSize=function(){return this.gameSceneSize},re.prototype.setDecelerateConfirmPrefab=function(O){this.decelerateConfirmPrefabName=O},re.prototype.setPropertyIntroductionPrefab=function(O){this.propertyProc&&this.propertyProc.setPropertyIntroductionPrefab(O)},re.prototype.setPropertyIntroductionClickCb=function(O){this.propertyProc&&O&&this.propertyProc.setPropertyIntroductionClickCb(O)},re.prototype.buildPerformanceCounter=function(){var O=d.G.Ap.state.getMission().getType();d.G.Ap.performanceCounter=O===W.MISSIONTYPE.Rank?this.performance:r.Performance.Counter},re.prototype.testRestartGame=function(){this.restartGame()},re.prototype.testPauseGame=function(){this.pauseGame()},re.prototype.testResumeGame=function(){this.resumeGame()},re.prototype.testStartGame=function(){this.startRun()},re}();m.default=He,cc._RF.pop()},{"../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../base/G":"G","../base/Log":"Log","../base/State":"State","../business/Logic/ChestManager":"ChestManager","../business/Logic/I18nManager":"I18nManager","../business/Logic/LevelMgr":"LevelMgr","../business/Logic/PlayerMgr":"PlayerMgr","../business/Network/Protocol/StorageUtil":"StorageUtil","../business/Network/Protocol/User":"User","../business/Network/Protocol/UserUtil":"UserUtil","../business/UI/GameClub":"GameClub","../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr","../business/UI/GameEntraScene/UICache":"UICache","../business/gameover/Relive":"Relive","../business/gameover/ReliveScoreData":"ReliveScoreData","../business/gameover/ReviveController":"ReviveController","../business/keypad/KeypadUtil":"KeypadUtil","../config/LSKey":"LSKey","../music/Music":"Music","../music/MusicPlayer":"MusicPlayer","../property/PropertyDefines":"PropertyDefines","../util/PageHeap":"PageHeap","../util/Performance":"Performance","../util/SUtil":"SUtil","../util/SceneMusicMgr":"SceneMusicMgr","../util/StringUtil":"StringUtil","../util/Utility":"Utility","./GameBus":"GameBus","./GameSceneSetting":"GameSceneSetting","./MUI/MUIBoard":"MUIBoard","./MUI/MUIDefines":"MUIDefines","./MUI/MUIFactory":"MUIFactory","./MUI/MUINode":"MUINode","./MUI/MUISprite":"MUISprite","./StarCountSwitch":"StarCountSwitch","./animation/MAnimationMgr":"MAnimationMgr","./animation/MScheduler":"MScheduler","./animation/action/MCallFunc":"MCallFunc","./animation/action/MDelay":"MDelay","./animation/action/MSequence":"MSequence","./ctrl/GameStageMoney":"GameStageMoney","./ctrl/GameStageMusic":"GameStageMusic","./element/anim/CookieAnimation":"CookieAnimation","./element/anim/ScoreAnimation":"ScoreAnimation","./element/component/BackButton":"BackButton","./element/component/Banner":"Banner","./element/component/KeyTouchLine":"KeyTouchLine","./element/component/MUINumber":"MUINumber","./element/component/SplitLine":"SplitLine","./element/loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./element/loader/GameSceneFrameLoader":"GameSceneFrameLoader","./element/loader/NumberFrameLoader":"NumberFrameLoader","./element/node/CookiesNodeCache":"CookiesNodeCache","./module/GameModuleManager":"GameModuleManager","./module/QQRedPacketModule":"QQRedPacketModule","./property/DecelerateConfirm":"DecelerateConfirm","./property/PropertyProcess":"PropertyProcess","./view/GameStageNodeView":"GameStageNodeView"}],GameShareTask:[function(l,P,m){"use strict";cc._RF.push(P,"85ea4vElrVAB7xIhrsS5arS","GameShareTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TaskItemImpl"),s=l("../TaskItem"),r=l("../../Network/Protocol/StorageUtil"),o=l("../../../config/LSKey"),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.update=function(){r.default.read(o.default.SHARE_FOR_GIFT_SHARED)==="true"?(this.currentStep=this.totalStep,this.status=s.TaskStatus.TASK_STATUS_SUCCESS):(this.currentStep=0,this.status=s.TaskStatus.TASK_STATUS_DOING)},t}(d.default);m.default=e,cc._RF.pop()},{"../../../config/LSKey":"LSKey","../../Network/Protocol/StorageUtil":"StorageUtil","../TaskItem":"TaskItem","./TaskItemImpl":"TaskItemImpl"}],GameStageEventObserver:[function(l,P,m){"use strict";cc._RF.push(P,"510dfzfId1D5Ihcat9BwHSe","GameStageEventObserver"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],GameStageGuide:[function(l,P,m){"use strict";cc._RF.push(P,"e1a48m+nAJHqYKv6oGS+5ae","GameStageGuide"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameStageMusic"),s=l("../data/Map"),r=l("../../base/G"),o=l("../data/MapGenerator"),e=l("../../util/Utility"),n=function(t){function i(a,u,c){var p=t.call(this,a,u,!0)||this;return p.mGuide=c,p.type=e.Utility.GAMESTAGE.GUIDE,p}return __extends(i,t),i.prototype.createMap=function(a){var u=this.mGame.getGameRegion(),c=new s.MapGenerateParam;c.slotCount=r.G.Ap.config.getGameSceneSlotCount(),c.baseBlockHeight=r.G.Ap.config.getBlockHeight(),c.slotWidth=u.width/c.slotCount,this.guide.map=o.default.generateGuide(c,u),this.guide.map.move=-a,this.destinationSegmentIndex=this.guide.map.segments.length-1},i.prototype.enterMusicPart=function(a){this.currentBPM=85,this.currentBeats=.5;var u=this.currentBPM/60/this.currentBeats*this.guide.map.params.baseBlockHeight*r.G.Ap.config.gameSpeedScale;this.setSpeed(u)},i.prototype.enterSegment=function(a){if(t.prototype.enterSegment.call(this,a),a===0){if(0<(p=this.guide.getSegment(a)).blocks.length){var u=p.blocks[0],c=p.rect.y-this.guide.map.move;this.mGuide.shortBlockGuide(u.rect,c)}}else if(a===1)this.mGame.pauseGame(),0<(p=this.guide.getSegment(a)).blocks.length&&(u=p.blocks[0],c=p.rect.y-this.guide.map.move,this.mGuide.longBlockBeginGuide(u.rect,c));else if(a===2){var p;0<(p=this.guide.getSegment(a-1)).blocks.length&&(u=p.blocks[0],c=p.rect.y-this.guide.map.move,this.mGuide.longBlockGuide(u.rect,c))}},i.prototype.detectMiss=function(){},i.prototype.makeMistake=function(a,u){},i.prototype.touchBlock=function(a,u,c,p){c.type===e.Utility.SEGMENTTYPE.BEGIN?(p.touchId=a,p.touchCount++,p.attainScore=0,r.G.Ap.state.resume(),this.mGuide.hideBanner(),this.notifyTouchState(p,!0),this.displayTouchEffect(c,p)):(r.G.Ap.state.isPaused()&&this.mGame.resumeGame(),t.prototype.touchBlock.call(this,a,u,c,p))},i.prototype.touchResumeBlock=function(a,u){return a===this.currentSegment},i.prototype.updateNodeTouchMove=function(a){if(t.prototype.updateNodeTouchMove.call(this,a),this.currentSegment===2)for(var u=this.guide.getTouchs(),c=u.length,p=0;p<c;++p){var h=this.guide.getBlock(u[p].value);if(h&&h.type==e.Utility.BLOCKTYPE.LONG&&h.attainScore>=h.score){this.mGame.pauseGame();var f=this.guide.getSegment(this.currentSegment).rect.y+h.rect.height-this.guide.map.move;this.mGuide.longBlockEndGuide(h.rect,f);break}}},i.prototype.longBlockTouchOver=function(a){t.prototype.longBlockTouchOver.call(this,a),this.currentSegment===2&&this.mGame.finishGameStage(this.type)},i}(d.default);m.default=n,cc._RF.pop()},{"../../base/G":"G","../../util/Utility":"Utility","../data/Map":"Map","../data/MapGenerator":"MapGenerator","./GameStageMusic":"GameStageMusic"}],GameStageMoney:[function(l,P,m){"use strict";cc._RF.push(P,"fc30aE1z1lOmq6D7UCB3Qrm","GameStageMoney"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=l("../../base/G"),r=l("../data/MapGenerator"),o=l("../data/Map"),e=l("./GameStage"),n=l("./GameMapGuide"),t=function(i){function a(u,c,p,h){var f=i.call(this,u,c,d.Utility.GAMESTAGE.MONEY)||this;return f.moneyLine=0,f.money=0,f.blankPauseNode=null,f.money=p,f.moneyLine=h,f.speed=s.G.Ap.config.getMoneyStageSpeed()*s.G.Ap.config.getDesignBlockHeight(),f}return __extends(a,i),a.prototype.init=function(u){u===void 0&&(u=0),this.mGame.getGameNode(),this.mGame.getGameRegion(),this.createMap(),this.dynamicAddNode(),this.enterSegment(0),s.G.Ap.config.debugNoPullParent&&this.view.pullView(0)},a.prototype.createMap=function(){var u=this.mGame.getGameRegion(),c=new o.MapGenerateParam;c.slotCount=s.G.Ap.config.getGameSceneSlotCount(),c.baseBlockHeight=s.G.Ap.config.getBlockHeight(),c.slotWidth=u.width/c.slotCount,this.guide.map=r.default.generateMoneyMap(this.money,this.moneyLine,c,u),this.guide.map.move=-u.height,this.destinationSegmentIndex=this.guide.map.segments.length-1},a.prototype.setCurrentSegmentPaused=function(){if(!this.mRunning)return!1;if(!this.blankPauseNode){var u=new d.Utility.Rect(0,0,s.G.Ap.config.mBaseBlockWidth,s.G.Ap.config.mBaseBlockHeight),c=r.default.createBlock(u,d.Utility.BLOCKTYPE.BLANKPAUSE);this.blankPauseNode=this.view.addBlockNode(c,"BlankPauseNode"),this.view.reuseBlockNode(this.blankPauseNode)}var p=this.currentSegment;if(this.currentSegment<this.guide.map.segments.length)if((f=this.guide.map.segments[this.currentSegment]).rect.y<this.guide.map.move)p=this.currentSegment+1;else{var h=f.rect.y-this.guide.map.move-this.guide.map.params.baseBlockHeight;0<h&&(this.walkDown(h),this.dynamicAddNode(),this.pull(0))}if(this.view.showElement(this.blankPauseNode,!0),p+1<this.guide.map.segments.length){var f=this.guide.map.segments[p],g=r.default.getFreeSlotsBySegment(this.guide.map.params.slotCount,f);g.length==0&&g.push(1),s.G.Ap.config.debugNoPullParent?this.view.moveElement(this.blankPauseNode,g[0]*this.guide.map.params.slotWidth,f.rect.y-this.guide.map.move):this.view.moveElement(this.blankPauseNode,g[0]*this.guide.map.params.slotWidth,f.rect.y)}else f=this.guide.map.segments[this.guide.map.segments.length-1],s.G.Ap.config.debugNoPullParent?this.view.moveElement(this.blankPauseNode,0,Math.max(f.rect.y-this.guide.map.move,0)+this.guide.map.params.baseBlockHeight):this.view.moveElement(this.blankPauseNode,0,Math.max(f.rect.y,0)+this.guide.map.params.baseBlockHeight);return!0},a.prototype.onTouchStart=function(u){if(this.mRunning&&!s.G.Ap.config.debugNoTouchResponse){s.G.Ap.state.isPaused()&&this.preTouchPausedBlock(null,null);for(var c=0,p=u.length;c<p;++c){var h=u[c],f=h.identifier;f==null&&(f=1);var g=new cc.Vec2(h.clientX,h.clientY),_=this.guide.calcTouchBlockLocation(g);if(!(!_||_.segmentIndex<0||_.blockIndex<0)){var y=this.guide.getBlock(_);y&&y.touchCount==0&&(this.touchBlock(f,_,y),this.notifyTouchState(y,!0))}}}},a.prototype.onTouchEnd=function(u){},a.prototype.preTouchPausedBlock=function(u,c){this.blankPauseNode&&this.view.unuseBlockNode(this.blankPauseNode),this.mGame.resumeGame()},a.prototype.touchBlock=function(u,c,p){p.touchId=u,p.touchCount=1;var h=this.guide.getSegment(c.segmentIndex),f=p.rect.center();f.x+=h.rect.x,f.y+=h.rect.y-this.guide.map.move,this.mGame.attainMoney(f)},a.prototype.detectEnterNextSegment=function(){var u=this.guide.getSegment(this.currentSegment);if(u!=null){var c=u.rect.yMax-this.guide.map.move<=0,p=!0;if(!c){for(var h=u.blocks.length,f=0;f<h;++f)if(u.blocks[f].touchCount==0){p=!1;break}}(c||p)&&this.enterSegment(this.currentSegment+1)}},a.prototype.detectMiss=function(){if(s.G.Ap.config.debugAutoTouchBlock||this.propertyWorked){var u=this.guide.getSegment(this.currentSegment);if(u==null)return;if(u.rect.y-this.guide.map.move<=0)for(var c=u.blocks.length,p=0;p<c;++p){var h=u.blocks[p];h.touchCount==0&&(this.touchBlock(0,new n.GameMap.Location(this.currentSegment,p),h),this.notifyTouchState(h,!0))}}},a.prototype.enterMusicPart=function(u){},a}(e.default);m.default=t,cc._RF.pop()},{"../../base/G":"G","../../util/Utility":"Utility","../data/Map":"Map","../data/MapGenerator":"MapGenerator","./GameMapGuide":"GameMapGuide","./GameStage":"GameStage"}],GameStageMusic:[function(l,P,m){"use strict";cc._RF.push(P,"5c1c1QybFRPkLaYksTvkIMA","GameStageMusic"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=l("../../base/G"),r=l("../data/MapGenerator"),o=l("../data/Map"),e=l("./GameStage"),n=l("./GameMapGuide"),t=l("../../util/Dictionary"),i=l("../../util/PU"),a=l("../../business/Logic/ChestManager"),u=l("../../anticheat/OperatingCount"),c=l("../../business/keypad/KeypadUtil"),p=function(){this.error=!1,this.positionX=0,this.holdTimes=0,this.countItem=new u.OperatingCountItem},h=function(f){function g(_,y,S,I){S===void 0&&(S=!1),I===void 0&&(I=null);var v=f.call(this,_,y,d.Utility.GAMESTAGE.MUSIC,I)||this;return v.mIsDebugMode=!0,v.crowns=[],v.continueToInfinite=!1,v.touchRecords=new t.Dictionary,v.twinsBlockDelay=.2,v.continueToInfinite=S,v.mIsDebugMode=CMPlay.getQueryString("_cm_debug_","false")=="true",v}return __extends(g,f),g.prototype.init=function(_){_===void 0&&(_=0),this.autoDestroyOffset=s.G.Ap.config.mBaseBlockHeight,this.divisionShop.halfBaseBlockHeight=s.G.Ap.config.mBaseBlockHeight/2,this.divisionShop.minSpeedDivide8=3*s.G.Ap.config.mBaseBlockHeight/8,this.divisionShop.maxSpeedDivide8=9*s.G.Ap.config.mBaseBlockHeight/8,this.divisionShop.longBlockLightHeight=217*s.G.Ap.config.mBaseBlockHeight/320,this.divisionShop.longBlockBlankHeight=267*s.G.Ap.config.mBaseBlockHeight/320,this.calcHonors(),this.createMap(_),this.enterSegment(0),this.detectGrow(),this.dynamicAddNode(),this.pull(0),s.G.Ap.config.debugNoPullParent&&this.view.pullView(0)},g.prototype.setShowGiftBox=function(_){this.showGift=_},g.prototype.setCurrentSegmentPaused=function(){if(!this.mRunning)return console.log("pause error, is not running"),!1;for(var _=this.currentSegment,y=0;y<5;y++){_++;for(var S=this.guide.getSegment(_),I=0;S&&I<S.blocks.length;++I)0<S.blocks[I].touchCount&&(this.currentSegment=_,S.blocks[I].touchCount=0,this.notifyTouchState(S.blocks[I],!1))}var v=this.guide.getSegment(this.currentSegment);if(v==null||v.type!=d.Utility.SEGMENTTYPE.MEDIUM)return console.warn("pause error, segment is not fit"),!1;var C=this.getNeedPauseBlocks(v);if(C.length==0)return console.warn("pause error, blocks.length is 0"),!1;if(this.guide.clearTouchs(),c.default.isHorizon()){var T=.5*this.guide.map.params.baseBlockHeight,E=v.rect.y-this.guide.map.move;console.warn("setCurrentSegmentPaused => realOffset:"+E),E<T?this.walkDown(E-T):T<E&&(this.walkDown(E-T),this.dynamicAddNode(),this.pull(0))}else if((E=v.rect.y-this.guide.map.move)<0)this.walkDown(E);else if(0<E){var A=this.guide.map.params.baseBlockHeight;A<=E&&(this.walkDown(E-A),this.dynamicAddNode(),this.pull(0))}I=0;for(var M=C.length;I<M;++I){var k=C[I],D=k.node;D!=null?(k.paused=!0,this.view.updateBlockNodePauseState(D,k.paused)):console.warn("pause error, node is null")}return!0},g.prototype.getNextHonorScore=function(){if(this.crowns.length==0)return 0;var _=this.guide.map.segments[this.currentSegment];if(_==null)return 0;var y=this.mGame.getMusic().getMusicParts();if(y.length==0)return 0;var S=0,I=this.currentMusicPartIncrease,v=Math.max(0,_.musicBlockIndex);if(!this.isHonor(I,v)){v+=1;for(var C=this.crowns[this.crowns.length-1],T=I;T<C;++T){for(var E=!1,A=y[T%y.length].getMusicBlocks(),M=v,k=A.length;M<k;++M)if(S+=r.default.calcLessScoreByMusicBlock(A[M]),this.isHonor(T,M)){E=!0;break}if(v=0,E)break}}T=0;for(var D=_.blocks.length;T<D;++T){var L=_.blocks[T];0<L.touchCount||(L.type==d.Utility.BLOCKTYPE.LONG?S+=1:S+=L.score)}return S},g.prototype.update=function(_){f.prototype.update.call(this,_),this.mRunning&&(this.detectGrow(),this.detectStop())},g.prototype.walkDown=function(_){f.prototype.walkDown.call(this,_),this.updateNodeTouchMove(_)},g.prototype.detectMiss=function(){this.detectMissSegment(this.currentSegment)},g.prototype.detectMissSegment=function(_){var y=this,S=this.guide.map.segments[_],I=s.G.Ap.config.debugAutoTouchBlock;if(S){if(I||this.propertyWorked)this.autoTouch(S);else if(!s.G.Ap.config.debugNoDetectMission){var v=S.rect.y+this.guide.map.params.baseBlockHeight-this.guide.map.move;if(v<=0)for(var C=S.blocks.length,T=function(M){var k=S.blocks[M],D=k.type;return d.Utility.BLOCKTYPECHARACTER.c[D].music?D===d.Utility.BLOCKTYPE.LONG&&k.slotIndex===0&&i.default.is3DTouchCompat()&&0<v+E.guide.map.params.baseBlockHeight?"break":k.touchCount===0?(E.gameWillOver(function(){y.mIsDebugMode&&console.warn("XMAN::detectMissSegment => GAMEOVER for detectMiss"),y.makeMiss(_,M,y.guide.map.params.baseBlockHeight-v)},E),"break"):void 0:"continue"},E=this,A=0;A<C&&T(A)!=="break";++A);}}},g.prototype.createMap=function(_){var y=this.mGame.getGameRegion(),S=new o.MapGenerateParam;S.slotCount=s.G.Ap.config.getGameSceneSlotCount(),S.baseBlockHeight=s.G.Ap.config.getBlockHeight(),S.slotWidth=y.width/S.slotCount,this.guide.map=r.default.generate(this.mGame.getMusic(),S,y,[0,1],this.crowns,this.continueToInfinite),this.guide.map.move=-_,this.continueToInfinite?this.destinationSegmentIndex=this.guide.map.segments.length-1:this.destinationSegmentIndex=this.guide.map.segments.length-2},g.prototype.detectStop=function(){this.type==d.Utility.GAMESTAGE.MUSIC&&this.allFalled()&&this.setRuning(!1)},g.prototype.detectGrow=function(){var _=this.guide.map,y=_.segments.length,S=this.mGame.getGameRegion(),I=_.move+S.height+S.height,v=_.segments[y-1];if(this.currentSegment>=y-1||v.rect.y<I||v.inhereBlockCount==0){var C=Math.max(0,v.musicPartIndex),T=v.musicBlockIndex,E=v.rect.yMax,A=r.default.getFreeSlotsBySegment(this.guide.map.params.slotCount,v),M=r.default.createSegmentByPreMusicBlock(this.mGame.getMusic(),C,T,this.guide.map.params,S,A);M&&(this.beforeGrowSegment(M),M.rect.y+=E,this.guide.map.segments.push(M),this.afterGrowSegment(M),(M.inhereBlockCount==0||M.rect.y<I)&&this.detectGrow())}},g.prototype.beforeGrowSegment=function(_){this.type===d.Utility.GAMESTAGE.INFINITE&&this.putGiftToSegment(_)&&(s.G.Ap.state.dropScore=s.G.Ap.state.attainScore),this.tryPutCrownToSegment(_),this.eventObserver&&this.eventObserver.onBeforeGrowSegment(_)},g.prototype.afterGrowSegment=function(_){},g.prototype.attainHonor=function(_){_!=null&&_.haveHonor&&(this.type==d.Utility.GAMESTAGE.INFINITE?this.mGame.attainCrown():this.mGame.attainStar())},g.prototype.getTouchKeyString=function(_){for(var y="",S=0,I=_.length;S<I;++S)_[S].clientX==90?y+=" D":_[S].clientX==270?y+=" F":_[S].clientX==450?y+=" J":_[S].clientX==630&&(y+=" K");return y},g.prototype.isShowGameRegion=function(_){return _.rect.y-this.guide.map.move<=this.mGame.getGameRegion().height},g.prototype.debugSegment=function(_,y,S){S===void 0&&(S="");for(var I="XMAN::debug => seg["+_+"] ",v=0;v<4;v++){for(var C=!1,T=0;T<y.blocks.length;T++){var E=y.blocks[T];if(E.slotIndex==v){I+="@"+E.touchCount+"("+E.type+") ",C=!0;break}}C||(I+="_0(0) ")}console.warn(I+" "+S)},g.prototype.onTouchStart=function(_){if(this.mRunning&&!s.G.Ap.config.debugNoTouchResponse&&!this.propertyWorked)if(c.default.isHorizon()){var y=this.currentSegment;if(this.mIsDebugMode&&console.error("XMAN::BEGIN =>"+this.getTouchKeyString(_)),s.G.Ap.state.isPaused())for(var S=0,I=_.length;S<I;++S)this.processTouchDot(_[S]);else{for(var v=y,C=y-1,T=y+3,E=!0,A=C;A<=T;A++){var M=this.guide.getSegment(A);if(M&&this.isShowGameRegion(M)){for(var k="XMAN::onTouchStart => segment:"+A,D=0;D<M.blocks.length;D++){var L=M.blocks[D],b=L.rect;if(this.mIsDebugMode&&this.debugSegment(A,M,"BEFORE"),L.touchCount==0){for(var N=!1,H=!1,R=0;R<_.length;R++)if(!_[R].processed){N=!0;var F=_[R].clientX;if(F>=b.x&&F<=b.xMax){k+=" => TOUCH BLOCK(slot:"+L.slotIndex+", x:"+F+")";var x=new n.GameMap.Location;x.segmentIndex=A,x.blockIndex=D,v<A&&(v=A),H=_[R].processed=!0,this.touchBlock(_[R].identifier,x,M,L),this.detectEnterNextSegment();break}}if(L.type!=d.Utility.BLOCKTYPE.TWINS&&N&&!H){E=!1;break}}else k+=" => SKIP BLOCK(slot:"+L.slotIndex+")";this.mIsDebugMode&&this.debugSegment(A,M,"AFTER"),this.mIsDebugMode&&console.warn(k)}if(!E)break}}if(!s.G.Ap.state.isPaused()){for(S=0,I=_.length;S<I;++S)if(!_[S].processed){var U=new cc.Vec2(_[S].clientX,_[S].clientY);this.makeMistake(null,U);break}console.warn(E?"XMAN::GameOver for Hit Nothing":"XMAN::GameOver for Hit Order")}if(!s.G.Ap.state.isPaused())for(A=C;A<=v;A++)this.detectMissSegment(A)}var B=this.currentSegment;this.mIsDebugMode&&console.error("XMAN::END => segment:"+y+" => "+B)}else for(S=0,I=_.length;S<I;++S)this.processTouchDot(_[S])},g.prototype.onTouchMove=function(_){if(this.mRunning&&!s.G.Ap.config.debugNoTouchResponse&&!s.G.Ap.state.isPaused())for(var y=0,S=_.length;y<S;++y){var I=_[y],v=I.identifier;v==null&&(v=1);var C=this.touchRecords.get(v);if(C){if(C.holdTimes<60){C.holdTimes++;var T=Math.abs(I.clientX-C.positionX);if(39.27<T)C.error=!0,C.positionX=I.clientX;else{var E=this.touchRecords.get(v);E.error&&T<22.5?this.processTouchDot(I,!0):E.positionX=I.clientX}}C.countItem.touchMoved=!0}}},g.prototype.onTouchEnd=function(_){if(this.mRunning&&!s.G.Ap.config.debugNoTouchResponse)for(var y=0,S=_.length;y<S;++y){var I=_[y],v=I.identifier;v==null&&(v=1);var C=this.touchRecords.get(v);C&&this.touchRecords.remove(v);var T=this.guide.getTouch(v);if(T){this.guide.removeTouch(v);var E=this.guide.getBlock(T);E!=null&&(E.touchId=-1,E.counter=0,this.longBlockTouchOver(E),C&&(C.countItem.touchScore=E.attainScore))}else s.G.Ap.state.isPaused()||C!=null&&C.error&&Math.abs(I.clientX-C.positionX)<11.25&&this.processTouchDot(I,!0);C&&this.endCountTouch(C)}},g.prototype.processTouchDot=function(_,y){y===void 0&&(y=!1),this.mGame.getGameRegion();do{var S=_.identifier;S==null&&(S=1);var I=null,v=new cc.Vec2(_.clientX,_.clientY);if(!y){var C=this.touchRecords.get(S);C||(C=new p,this.touchRecords.put(S,C)),C.error=!1,C.positionX=v.x,C.holdTimes=0,I=C}var T=this.divisionShop.halfBaseBlockHeight,E=this.divisionShop.speedDivide8;s.G.Ap.state.isPaused()&&(E=T=0);var A=this.guide.looseDetectClick(this.currentSegment,T,E,v);A!=null&&A.blockIndex!=-1||(A=this.guide.looseDetectClick(this.currentSegment-1,T,E,v))==null&&(A=this.guide.calcTouchBlockLocation(v));var M=A?this.guide.getSegment(A.segmentIndex):null;if(M==null)break;this.processTouchSegment(_,y,v,A,M,I)}while(!1)},g.prototype.processTouchSegment=function(_,y,S,I,v,C){var T=this;y===void 0&&(y=!1);var E=!1;do{var A=_.identifier;if(!s.G.Ap.state.isPaused()&&y){var M=this.guide.getSegment(this.currentSegment),k=this.guide.looseDetectClickBlockIgnoreY(this.currentSegment,S),D=0<=k?M.blocks[k]:null;if(!D||!D.node||D.type==d.Utility.BLOCKTYPE.LONG)break;I.segmentIndex=this.currentSegment,I.blockIndex=k,v=M}var L=this.guide.getBlock(I);if(s.G.Ap.state.isPaused()){if(!this.touchResumeBlock(I.segmentIndex,L)){E=!0;break}}else{if(L==null){I.segmentIndex>=this.currentSegment&&(this.gameWillOver(function(){T.mIsDebugMode&&console.warn("XMAN::processTouchSegment => GAMEOVER"),T.makeMistake(I,S)},this),E=!0);break}if(I.segmentIndex!=this.currentSegment&&d.Utility.BLOCKTYPECHARACTER.c[L.type].music&&this.makeDisorder(I,L))break;if(!I.inClickableRegion){console.warn("!location.inClickableRegion \uFF1Ablocktype = "+L.type);break}}L?(L.touchCount===0&&(this.touchBlock(A,I,v,L),E=!0),C&&this.startCountTouch(S,v,L,C)):console.error("block is null.")}while(!1);return E},g.prototype.touchResumeBlock=function(_,y){return!(y==null||!y.paused)&&(y.type!=d.Utility.BLOCKTYPE.BEGIN&&this.preTouchPausedBlock(_),!0)},g.prototype.preTouchPausedBlock=function(_){for(var y=this.guide.getSegment(_),S=0,I=y.blocks.length;S<I;++S){var v=y.blocks[S];if(v.paused){v.paused=!1;var C=v.node;this.view.updateBlockNodePauseState(C,v.paused)}}this.mGame.resumeGame()},g.prototype.autoTouch=function(_){var y=this.mGame.getGameRegion(),S=this.currentSegment;if(_.rect.y-this.guide.map.move<=y.height/2)for(var I=_.blocks.length,v=0;v<I;++v){var C=_.blocks[v];if(C.touchCount==0&&C.type!=d.Utility.BLOCKTYPE.OBSTACLE){var T=new n.GameMap.Location;T.segmentIndex=S,T.blockIndex=v,this.notifyTouchState(C,!0),this.touchBlock(1,T,_,C)}}},g.prototype.touchBlock=function(_,y,S,I){var v=this;if(this.eventObserver&&this.eventObserver.onTouchBlockEvent(I,S.rect.x,S.rect.y-this.guide.map.move),I.touchId=_,I.touchCount++,I.type===d.Utility.BLOCKTYPE.BEGIN)I.attainScore=0,this.mGame.startRun(),this.createGiftForTwoStars(),this.notifyTouchState(I,!0),this.displayTouchEffect(S,I);else if(I.type===d.Utility.BLOCKTYPE.SHORT)I.attainScore=I.score,this.attainBlockScore(I),this.notifyTouchState(I,!0),this.displayTouchEffect(S,I),(T=this.mGame.getPlayer())&&(E=this.mGame.getMusic().getMusicBlock(I.musicPartIndex,I.musicBlockIndex))&&E.playAllSyllablsInOrder(T),this.detectTouchGitBlock(_,y,S,I);else if(I.type===d.Utility.BLOCKTYPE.TWINS){if(I.attainScore=I.score,this.attainBlockScore(I),this.notifyTouchState(I,!0),this.displayTouchEffect(S,I),E=this.mGame.getMusic().getMusicBlock(I.musicPartIndex,I.musicBlockIndex)){var C=0;y.blockIndex==0&&(C=1),(T=this.mGame.getPlayer())&&(0<S.blocks[C].touchCount?this.runDuration-S.blocks[C].touchTime<this.twinsBlockDelay?E.playAllSyllablsInOrder(T):E.playSingleSyllable(T,1):(I.touchTime=this.runDuration,this.mGame.setSheduleOnce(function(){v.delayPlayBlock(y)},this.twinsBlockDelay)))}}else if(I.type===d.Utility.BLOCKTYPE.LONG){this.guide.addTouch(_,y),this.notifyTouchState(I,!0),I.bounus.length===0&&this.displayBounceEffect(S,I,I.touchMove+this.divisionShop.longBlockLightHeight),I.touchMove=y.touchHeight;var T,E,A=I.score+1,M=this.calcLongBlockScore(I,A);I.attainScore=M,(T=this.mGame.getPlayer())&&(E=this.mGame.getMusic().getMusicBlock(I.musicPartIndex,I.musicBlockIndex))&&E.playAllSyllablsInOrder(T),this.detectTouchGitBlock(_,y,S,I)}else if(I.type===d.Utility.BLOCKTYPE.GIFT){I.attainScore=0,this.notifyTouchState(I,!0);var k=I.rect.center();k.x+=S.rect.x,k.y+=S.rect.y-this.guide.map.move,this.mGame.attainGift(k),a.default.getInstance().setPlayGainChest(I.propChest)}this.detectEnterNextSegment()},g.prototype.longBlockTouchOver=function(_){this.attainBlockScore(_),this.notifyTouchState(_,!1)},g.prototype.calcLongBlockScore=function(_,y){var S=(_.score-.834)*this.guide.map.params.baseBlockHeight,I=Math.floor(_.touchMove/S*_.score)+1;return I<=y?I:y},g.prototype.detectTouchGitBlock=function(_,y,S,I){switch(I.type){case d.Utility.BLOCKTYPE.LONG:case d.Utility.BLOCKTYPE.SHORT:for(var v=0,C=S.blocks.length;v<C;++v){var T=S.blocks[v];T.touchCount===0&&T.type===d.Utility.BLOCKTYPE.GIFT&&T.slotIndex===I.slotIndex&&this.touchBlock(_,new n.GameMap.Location(y.segmentIndex,v),S,T)}}},g.prototype.delayPlayBlock=function(_){var y=this.guide.getSegment(_.segmentIndex);if(y.blocks.length==2){var S=0;if(_.blockIndex==0&&(S=1),y.blocks[S].touchCount==0){var I=y.blocks[_.blockIndex],v=this.mGame.getMusic().getMusicBlock(I.musicPartIndex,I.musicBlockIndex);v&&v.playSingleSyllable(this.mGame.getPlayer(),0)}}},g.prototype.displayTouchEffect=function(_,y){var S=y.rect.center();S.y=y.rect.yCenter+_.rect.y,S.y-=this.guide.map.move;var I=y.type;this.mGame.attainBlockEffect(S,I)},g.prototype.displayBounceEffect=function(_,y,S){var I=y.rect.center();I.y=S+_.rect.y,I.y-=this.guide.map.move;var v=y.type;this.mGame.attainBlockEffect(I,v)},g.prototype.attainBlockScore=function(_){this.eventObserver&&(_.attainScore=this.eventObserver.onAttainScore(_.attainScore)),this.mGame.attainScore(_.attainScore)},g.prototype.updateNodeTouchMove=function(_){for(var y=this.guide.getTouchs(),S=y.length,I=0;I<S;++I){var v=this.guide.getBlock(y[I].value);if(v&&v.type==d.Utility.BLOCKTYPE.LONG){if(v.touchMove+=_,0<s.G.Ap.config.longBlockBounceEffectByDistance){var C=v.touchMove/s.G.Ap.config.longBlockBounceEffectByDistance,T=v.rect.height/s.G.Ap.config.longBlockBounceEffectByDistance;if(C>v.counter&&C<T){var E=this.guide.getSegment(y[I].value.segmentIndex);this.displayBounceEffect(E,v,v.touchMove),v.counter++}}for(var A=this.guide.map.params.baseBlockHeight,M=v.touchMove/A,k=0;k<v.bounus.length;++k){var D=v.bounus[k];if(M>=D.time&&!D.attain){D.attain=!0;var L=this.mGame.getMusic().getMusicBlock(v.musicPartIndex,v.musicBlockIndex);L&&L.playAccompanySyllable(this.mGame.getPlayer(),k),s.G.Ap.config.longBlockBounceEffectByDistance<=0&&(E=this.guide.getSegment(y[I].value.segmentIndex),this.displayBounceEffect(E,v,v.touchMove+this.divisionShop.longBlockLightHeight));break}}var b=v.score+1,N=this.calcLongBlockScore(v,b),H=s.G.Ap.config.debugAutoTouchBlock,R=this.propertyWorked;if((H||R)&&v.attainScore<b&&N==b?(v.attainScore=N,v.touchId=-1,this.attainBlockScore(v)):v.attainScore=N,v.node){var F=v.node;this.view.updateBlockNodeLayers(F,this.speed)}}}},g.prototype.createGiftForTwoStars=function(){s.G.Ap.state.dropScore=-1;for(var _=0,y=this.guide.map.segments;_<y.length;_++){var S=y[_];if(!(S.musicPartIndex<1)&&this.putGiftToSegment(S)){s.G.Ap.state.dropScore=0;break}}},g.prototype.putGiftToSegment=function(_){if(this.showGift){if(_.blocks.length!=1)return!1;var y=[_.blocks[0].slotIndex],S=a.default.getInstance().randomPropChest(s.G.Ap.state.attainScore,s.G.Ap.state.dropScore);if(!S)return!1;var I=this.guide.map.params.slotWidth,v=this.guide.map.params.baseBlockHeight,C=y[d.Utility.getRandom(0,y.length-1)],T=new d.Utility.Rect(I*C,0,I,v),E=r.default.createGiftBlock(T,S);return E&&(E.slotIndex=C,_.blocks.push(E),_.slots.push(C)),!0}},g.prototype.tryPutCrownToSegment=function(_){this.isHonor(this.currentMusicPartIncrease,_.musicBlockIndex)&&(_.haveHonor=!0);var y=this.mGame.getMusic().getMusicPart(_.musicPartIndex);if(y&&y.getMusicBlocks().length==_.musicBlockIndex+1){for(var S=this.crowns.length,I=0;I<S;++I)if(this.currentMusicPartIncrease+1==this.crowns[I]){_.haveHonor=!0;break}}},g.prototype.calcHonors=function(){var _=this.mGame.getLevel();if(_!=null)for(S=1;S<=6;++S){var y=_.awardStar.getAward(S);y&&this.crowns.push(y)}else{console.warn("Music doesn't have level information.");for(var S=1;S<=6;++S)this.crowns.push(S)}},g.prototype.isHonor=function(_,y){var S=this.mGame.getMusic().getMusicParts();if(S.length==0)return!1;var I=S[_%S.length];if(!I||I.getMusicBlocks().length!=y+1)return!1;for(var v=this.crowns.length,C=0;C<v;++C)if(_+1==this.crowns[C])return!0;return!1},g.prototype.getNeedPauseBlocks=function(_){for(var y=[],S=null,I=0,v=_.blocks;I<v.length;I++)S=v[I],d.Utility.BLOCKTYPECHARACTER.c[S.type].music&&S.touchCount==0&&y.push(S);if(!y.length)for(var C=0,T=_.blocks;C<T.length;C++)S=T[C],d.Utility.BLOCKTYPECHARACTER.c[S.type].music&&y.push(S);return y},g.prototype.startCountTouch=function(_,y,S,I){var v=s.G.Ap.antiCheat;if(v.isHit()&&!(this.divisionShop.blockSpeed<v.getSpeedThreshold())){var C=I.countItem;C.valid=!0,C.blockType=S.type,C.touchScreenPosX=_.x,C.touchScreenPosY=_.y,C.touchBlockPosX=_.x-S.rect.x,C.touchBlockPosY=_.y+this.guide.map.move-y.rect.y,C.touchScore=S.score,C.startTime=new Date().getTime(),C.slotIndex=S.slotIndex}},g.prototype.endCountTouch=function(_){s.G.Ap.antiCheat.isHit()&&_.countItem.valid&&(_.countItem.endTime=new Date().getTime(),s.G.Ap.antiCheat.getOperatingCount().addItem(_.countItem))},g.sortTouchsByY=function(_,y){return _.clientY>y.clientY?1:_.clientY<y.clientY?-1:0},g}(e.default);m.default=h,cc._RF.pop()},{"../../anticheat/OperatingCount":"OperatingCount","../../base/G":"G","../../business/Logic/ChestManager":"ChestManager","../../business/keypad/KeypadUtil":"KeypadUtil","../../util/Dictionary":"Dictionary","../../util/PU":"PU","../../util/Utility":"Utility","../data/Map":"Map","../data/MapGenerator":"MapGenerator","./GameMapGuide":"GameMapGuide","./GameStage":"GameStage"}],GameStageNodeView:[function(l,P,m){"use strict";cc._RF.push(P,"5a3c3nJKWZKD6dp7vk/VF88","GameStageNodeView"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../element/node/BlockNodeCache"),s=l("../element/node/BlockNodeFactory"),r=l("../animation/action/MDelay"),o=l("../animation/action/MBlink"),e=l("../animation/action/MCallFunc"),n=l("../animation/action/MSequence"),t=l("../GameBus"),i=function(){function a(u){this.mContentNode=null,this.blockNodeCache=null,this.mContentNode=u,this.blockNodeCache=new d.BlockNodeCache}return a.prototype.attachView=function(u){this.mContentNode=u},a.prototype.activeView=function(u){this.mContentNode&&this.mContentNode.setVisible(u)},a.prototype.pullView=function(u){this.mContentNode&&this.mContentNode.setPositionY(u)},a.prototype.moveElement=function(u,c,p){u&&u.setPosition(c,p)},a.prototype.showElement=function(u,c){u&&u.setVisible(c)},a.prototype.addBlockNode=function(u,c){var p=this.blockNodeCache.get(u);return p==null&&(p=s.default.getInstance().createNode(u),c&&p.setName(c),this.mContentNode.addChild(p)),p},a.prototype.removeBlockNode=function(u){this.blockNodeCache.put(u)||u.node.unuse()},a.prototype.unuseBlockNode=function(u){u&&u.unuse()},a.prototype.reuseBlockNode=function(u){u&&u.reuse()},a.prototype.updateBlockNodeTouchState=function(u,c){u&&u.updateTouchState(c)},a.prototype.updateBlockNodeLayers=function(u,c){u&&u.updateLayers(c)},a.prototype.updateBlockNodePauseState=function(u,c){u&&u.updatePauseState(c)},a.prototype.displayMissingEffect=function(u,c){if(u.node){var p=new r.default(.5),h=new o.default(4,.5),f=new e.default(function(){u.node.setVisible(!0),c&&c()}),g=new n.default(p,h,f);t.default.getInstance().animationMgr.runAction(u.node,g)}else c&&c()},a.prototype.displayMistakeEffect=function(u,c){var p=this;if(u.node){var h=new o.default(4,.5),f=new e.default(function(){p.blockNodeCache.put(u)||(u.node==null&&console.error("make misstake block.node is null"),u.node.removeFromParent()),c&&c()}),g=new n.default(h,f);t.default.getInstance().animationMgr.runAction(u.node,g)}else c&&c()},a}();m.default=i,cc._RF.pop()},{"../GameBus":"GameBus","../animation/action/MBlink":"MBlink","../animation/action/MCallFunc":"MCallFunc","../animation/action/MDelay":"MDelay","../animation/action/MSequence":"MSequence","../element/node/BlockNodeCache":"BlockNodeCache","../element/node/BlockNodeFactory":"BlockNodeFactory"}],GameStageRankMusic:[function(l,P,m){"use strict";cc._RF.push(P,"4fc3b1fGf1NyYGEX61ii1xi","GameStageRankMusic"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameStageMusic"),s=l("../../base/G"),r=l("../../base/State"),o=function(e){function n(t,i){return e.call(this,t,i,!0)||this}return __extends(n,e),n.prototype.createGiftForTwoStars=function(){},n.prototype.putGiftToSegment=function(t){return!1},n.prototype.calcHonors=function(){for(var t=s.G.Ap.state.mission,i=1;i<=6;++i){var a=t.honors[i-1];a?this.crowns.push(a):(console.warn("GameStageRankMusic::calcHonors mission.honors is not enough."),this.crowns.push(r.default.HONORS[i]))}},n}(d.default);m.default=o,cc._RF.pop()},{"../../base/G":"G","../../base/State":"State","./GameStageMusic":"GameStageMusic"}],GameStageTrialSong:[function(l,P,m){"use strict";cc._RF.push(P,"e2ea2Jc4qlM+rY2l0o7T3wz","GameStageTrialSong"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameStageMusic"),s=l("../data/Map"),r=l("../../base/G"),o=l("../data/MapGenerator"),e=function(n){function t(i,a){return n.call(this,i,a,!1)||this}return __extends(t,n),t.prototype.createMap=function(i){var a=this.mGame.getGameRegion(),u=new s.MapGenerateParam;u.slotCount=r.G.Ap.config.getGameSceneSlotCount(),u.baseBlockHeight=r.G.Ap.config.getBlockHeight(),u.slotWidth=a.width/u.slotCount,this.guide.map=o.default.generateTrialSong(this.mGame.getMusic(),u,a,[0,1,2,3]),this.guide.map.move=-i,this.destinationSegmentIndex=this.guide.map.segments.length-1},t.prototype.createGiftForTwoStars=function(){},t}(d.default);m.default=e,cc._RF.pop()},{"../../base/G":"G","../data/Map":"Map","../data/MapGenerator":"MapGenerator","./GameStageMusic":"GameStageMusic"}],GameStageTrial:[function(l,P,m){"use strict";cc._RF.push(P,"176c63sMotLYodXnTWXdtGy","GameStageTrial"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameStageMusic"),s=l("../data/Map"),r=l("../../base/G"),o=l("../data/MapGenerator"),e=function(n){function t(i,a){return n.call(this,i,a,!1)||this}return __extends(t,n),t.prototype.createMap=function(i){var a=this.mGame.getGameRegion(),u=new s.MapGenerateParam;u.slotCount=r.G.Ap.config.getGameSceneSlotCount(),u.baseBlockHeight=r.G.Ap.config.getBlockHeight(),u.slotWidth=a.width/u.slotCount,this.guide.map=o.default.generateTrial(this.mGame.getMusic(),u,a,[0,1,2,3]),this.guide.map.move=-i,this.destinationSegmentIndex=this.guide.map.segments.length-1},t.prototype.createGiftForTwoStars=function(){},t}(d.default);m.default=e,cc._RF.pop()},{"../../base/G":"G","../data/Map":"Map","../data/MapGenerator":"MapGenerator","./GameStageMusic":"GameStageMusic"}],GameStageView:[function(l,P,m){"use strict";cc._RF.push(P,"9ab91arhZ5DFYQYPDQXYuBK","GameStageView"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],GameStage:[function(l,P,m){"use strict";cc._RF.push(P,"5612dQWkcJFTr5pIA18XmRU","GameStage"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=l("../../base/G"),r=l("./GameMapGuide"),o=l("../data/MapGenerator"),e=l("../../music/MusicPlayer"),n=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),t=function(){this.halfBaseBlockHeight=0,this.speedDivide8=0,this.minSpeedDivide8=0,this.maxSpeedDivide8=0,this.blockSpeed=0,this.longBlockLightHeight=0,this.longBlockBlankHeight=0},i=function(){function a(u,c,p,h){h===void 0&&(h=null),this.type=d.Utility.GAMESTAGE.NONE,this.guide=new r.GameMap.Guide,this.runDuration=0,this.mGame=null,this.eventObserver=null,this.mRunning=!0,this.speed=0,this.speedScale=1,this.currentMusicPartIncrease=-1,this.currentSegment=-1,this.currentBPM=0,this.currentBeats=0,this.destinationSegmentIndex=-1,this.autoDestroyOffset=0,this.view=null,this.divisionShop=new t,this.playerId=null,this.propertyWorked=!1;var f=this;f.mGame=u,f.type=p,f.view=c,f.eventObserver=h,n.MGUser.getUserLoginInfo({complete:function(g){g&&(f.playerId=g.playerId)}})}return a.prototype.activeNode=function(u){this.view.activeView(u)},a.prototype.destroy=function(){this.mGame=null},a.prototype.setRunning=function(u){this.mRunning=u},a.prototype.resetGameData=function(){this.speedScale=1,this.runDuration=0,this.currentMusicPartIncrease=-1,this.currentSegment=0,this.currentBPM=0,this.currentBeats=0,this.guide.restoreMap(),s.G.Ap.state.reset(!0)},a.prototype.setCurrentSegmentPaused=function(){return!1},a.prototype.allFalled=function(){return!(0<this.guide.map.segments.length&&0<this.guide.map.segments[this.destinationSegmentIndex].rect.yMax-this.guide.map.move)},a.prototype.setSpeedScale=function(u){this.speedScale=u?a.SPEED_SCALE_PERCENT:1},a.prototype.getRestoreCount=function(){return a.SPEED_SCALE_RESTORE_COUNT},a.prototype.restoreSpeed=function(){this.speedScale<1&&(this.speedScale+=a.SPEED_SCALE_RESTORE_EACH),1<this.speedScale&&(this.speedScale=1)},a.prototype.relive=function(){this.setRuning(!0),this.setCurrentSegmentPaused()},a.prototype.clearCache=function(){},a.prototype.getNextHonorScore=function(){return 0},a.prototype.getDetailHonorScore=function(u){return 0},a.prototype.getSpeed=function(){return this.speed},a.prototype.setSpeed=function(u){this.speed=u;var c=this.speed/8;c<this.divisionShop.minSpeedDivide8?c=this.divisionShop.minSpeedDivide8:c>this.divisionShop.maxSpeedDivide8&&(c=this.divisionShop.maxSpeedDivide8),this.divisionShop.blockSpeed=this.speed/Math.max(s.G.Ap.config.mBaseBlockHeight,1),this.divisionShop.speedDivide8=c},a.prototype.setBPM=function(u){var c=this.mGame.getPlayer();c&&c.setBpm(u)},a.prototype.setRuning=function(u){this.mRunning=u},a.prototype.update=function(u){if(this.mRunning){this.runDuration+=u;var c=u*this.speed*this.speedScale;this.dynamicAddNode(),this.walkDown(c),this.destoryNode(),this.detectMiss(),this.detectEnterNextSegment()}},a.prototype.walkDown=function(u){this.pull(u),this.mGame.pulledGameStage(this.type,u,this.guide.map.move)},a.prototype.detectMiss=function(){},a.prototype.pull=function(u){if(this.guide.map.move+=u,s.G.Ap.config.debugNoPullParent)for(var c=this.guide.map,p=c.segments,h=c.bottom;h<c.top;++h)for(var f=p[h],g=f.blocks.length,_=0;_<g;++_){var y=f.blocks[_],S=(y.rect,y.node);S&&this.view.moveElement(S,y.rect.x,f.rect.y-this.guide.map.move)}else this.view.pullView(-this.guide.map.move)},a.prototype.makeMiss=function(u,c,p){var h=this;this.setRuning(!1),this.playFailedSound();var f=p/30;this.mGame.setShedule(function(){h.pull(-f)},0,30,0);var g=this.guide.getBlockByIndex(u,c);if(g&&g.node){if(this.eventObserver){var _=this.guide.getSegment(u);this.eventObserver.onAppearMissBlockEvent(g,_.rect.x,_.rect.y-this.guide.map.move)}this.view.displayMissingEffect(g,function(){h.gameOver()})}},a.prototype.makeDisorder=function(u,c){return!0},a.prototype.makeMistake=function(u,c){var p=this;this.setRuning(!1),this.playFailedSound();var h=this.guide.calcTouchVirtualBlockRect(c);if(h==null)this.gameOver();else{var f=o.default.createBlock(h,d.Utility.BLOCKTYPE.MISTAKE);this.eventObserver&&this.eventObserver.onTouchBlockEvent(f,0,0);var g=this.view.addBlockNode(f,null);(f.node=g)?(s.G.Ap.config.debugNoPullParent?this.view.moveElement(g,h.x,h.y-this.guide.map.move):this.view.moveElement(g,h.x,h.y),this.view.displayMistakeEffect(f,function(){p.gameOver()})):this.gameOver()}},a.prototype.gameWillOver=function(u,c){this.mGame.gameWillOver(u,c)},a.prototype.gameOver=function(){this.mGame.gameOver()},a.prototype.notifyTouchState=function(u,c){if(!s.G.Ap.config.debugNoBlockAnim){var p=u.node;p!=null&&this.view.updateBlockNodeTouchState(p,c)}},a.prototype.dynamicAddNode=function(){for(var u=this.mGame.getGameRegion(),c=this.guide.map.segments.length,p=this.guide.map.move+u.height,h=this.guide.map.top;h<c;++h){var f=this.guide.map.segments[h];if(f.rect.y>=p)break;this.guide.map.top=h+1;for(var g=f.blocks.length,_=0;_<g;++_){var y=f.blocks[_];if(!y.added){if(y.node==null){var S=this.view.addBlockNode(y,null);S&&(s.G.Ap.config.debugNoPullParent||this.view.moveElement(S,y.rect.x+f.rect.x,y.rect.y+f.rect.y),y.node=S)}y.added=!0}}}},a.prototype.destoryNode=function(){for(var u=this.guide.map.move-this.autoDestroyOffset,c=this.guide.map.segments.length,p=this.guide.map.bottom;p<c;++p){var h=this.guide.map.segments[p];if(h.rect.yMax>=u)break;this.guide.map.bottom=p+1;for(var f=h.blocks.length,g=0;g<f;++g){var _=h.blocks[g];_.node&&(this.view.removeBlockNode(_),_.node=null)}}},a.prototype.onTouchStart=function(u){},a.prototype.onTouchMove=function(u){},a.prototype.onTouchEnd=function(u){},a.prototype.detectEnterNextSegment=function(){var u=this.currentSegment,c=this.guide.getSegment(u);if(c!=null){for(var p=!1,h=c.blocks.length,f=0;f<h;++f){var g=c.blocks[f],_=c.blocks[f].type;if(d.Utility.BLOCKTYPECHARACTER.c[_].music&&g.touchCount==0){p=!0;break}}if(!p){var y=u+1,S=this.guide.getSegment(y);if(S){var I=this.mGame.getGameRegion();if(S.type==d.Utility.SEGMENTTYPE.DESTINATION&&S.rect.yMax-this.guide.map.move>I.height)return}this.enterSegment(y),this.currentSegment===y&&this.detectEnterNextSegment()}}},a.prototype.enterSegment=function(u){if(this.currentSegment!=u){var c=this.guide.getSegment(u);if(c!=null){var p=this.guide.getSegment(this.currentSegment);if(this.currentSegment=u,this.attainHonor(p),c.type==d.Utility.SEGMENTTYPE.BEGIN)this.enterMusicPart(0);else if(c.type==d.Utility.SEGMENTTYPE.MEDIUM){var h=this.mGame.getMusic().getMusicParts().length;h=Math.max(h,1),c.musicPartIndex!=this.currentMusicPartIncrease%h&&this.enterMusicPart(this.currentMusicPartIncrease+1)}else c.type==d.Utility.SEGMENTTYPE.DESTINATION&&this.mGame.finishGameStage(this.type)}}},a.prototype.attainHonor=function(u){},a.prototype.enterMusicPart=function(u){var c=this.mGame.getMusic();if(c.getMusicParts().length!=0){this.currentMusicPartIncrease=Math.max(0,u);var p=c.getMusicParts().length,h=c.getMusicPart(this.currentMusicPartIncrease%p),f=0;if(this.skipSpeedGrow(u))f=this.currentBPM;else{var g=100;3<=this.currentMusicPartIncrease/p&&(g=130),f=this.currentMusicPartIncrease>=p?this.getNewBPM(this.currentBPM,this.currentBeats,h.getBaseBeats(),g):h.getBPM(),this.currentBeats=h.getBaseBeats()}this.currentBPM=f,this.mGame.getPlayer().setBpm(f),this.mGame.getPlayer().update(0);var _=f/60/this.currentBeats*this.guide.map.params.baseBlockHeight*s.G.Ap.config.gameSpeedScale;this.checkProperty(_)||this.setSpeed(_)}},a.prototype.getNewBPM=function(u,c,p,h){var f=u/Math.max(0,c),g=1.3-.001*(f-h),_=f/60;return 60*(_*=g=g<1.04?1.04:g)*p},a.prototype.playFailedSound=function(){var u=s.G.Ap.sound.getInstrumentFactory().get("piano");if(this.mGame.getPlayer())for(var c=["c","e","g"],p=0;p<c.length;++p){var h=u.getBeat(c[p]);h&&e.default.playMusicBeat(h,1,1,0)}},a.prototype.checkProperty=function(u){var c=this.mGame.getRunningProperty();return!!c&&(c.setPreSpeed(u),!0)},a.prototype.skipSpeedGrow=function(u){return!1},a.SPEED_SCALE_RESTORE_COUNT=(1-(a.SPEED_SCALE_PERCENT=.61))/(a.SPEED_SCALE_RESTORE_EACH=.067),a}();m.default=i,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/G":"G","../../music/MusicPlayer":"MusicPlayer","../../util/Utility":"Utility","../data/MapGenerator":"MapGenerator","./GameMapGuide":"GameMapGuide"}],GameTryData:[function(l,P,m){"use strict";cc._RF.push(P,"2f2a8nCPM1LNYSSHNWROe09","GameTryData"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=function(){this.tryType=d.TYPE_NONE,this.tryFinish=!1,this.data=null};m.default=r,(s=d=m.GameTryType||(m.GameTryType={}))[s.TYPE_NONE=0]="TYPE_NONE",s[s.TYPE_PIANO=1]="TYPE_PIANO",cc._RF.pop()},{}],GiftBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"67506PrHoxDULpbNVnWIC9Z","GiftBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/GameSceneFrameLoader"),s=l("./BlockNode"),r=l("../../MUI/MUISprite"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.createLayers=function(){this.setPosition(this.mBlock.rect.x,this.mBlock.rect.y),this.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height);var t=d.default.getInstance().getGiftBlockBackground(),i=this.mBlock.rect.width/t.rect.width,a=this.mBlock.rect.width,u=t.rect.height*i,c=new r.default;c.imageData=d.default.getInstance().getAtlas(),c.imageItem=t,c.setScale(.6),c.move(0,(this.mBlock.rect.height-u)/2,a,u),this.addChild(c)},n.prototype.updateTouchState=function(t){this.opacity=t?0:1},n}(s.default);m.default=o,cc._RF.pop()},{"../../MUI/MUISprite":"MUISprite","../loader/GameSceneFrameLoader":"GameSceneFrameLoader","./BlockNode":"BlockNode"}],GiftBoxDialog:[function(l,P,m){"use strict";cc._RF.push(P,"ddef0p1MJlEhrfmbmg8buL1","GiftBoxDialog"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/ChestManager"),s=l("../awardcontroller/AwardController"),r=l("../Logic/GameItemsManager"),o=l("../skin/SkinPieceMgr"),e=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),n=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),t=l("../Network/Protocol/StorageUtil"),i=l("../../config/LSKey"),a=l("../../util/TimeUtil"),u=l("../UI/GameEntraScene/ToastPrefab"),c=l("../UI/GameEntraScene/PrefabMgr"),p=l("../Logic/MoneySystem"),h=l("../../util/PU"),f=l("../../business/Logic/I18nManager"),g=l("../keypad/KeypadNavigator"),_=cc._decorator,y=_.ccclass,S=_.property,I=function(v){function C(){var T=v!==null&&v.apply(this,arguments)||this;return T.mChestRootNode=null,T.mGiftBoxNode=null,T.mTopLayout=null,T.mBg=null,T.mTopSprite=null,T.mBottomSprite=null,T.mChestCount=null,T.mAwardPrefab=null,T.mPopupLayout=null,T.mReward=null,T.mShowAds=!1,T}return __extends(C,v),C.prototype.setOnAwardTipsClickCallback=function(T){this.onAwardTipsClickCallback=T},C.prototype.onLoad=function(){var T=this;this.mTopSprite.node.on(cc.Node.EventType.TOUCH_END,this.giftClickCallback,this),this.mBottomSprite.node.on(cc.Node.EventType.TOUCH_END,this.giftClickCallback,this),this.node.on(cc.Node.EventType.TOUCH_START,function(A){A.stopPropagation()},this);var E=d.default.getInstance().getGainChestTotal();this.mChestCount.string="x "+E,d.default.getInstance().openChest(function(A){T.mReward=A}),g.default.getInstance().gotoPage(this.node)},C.prototype.start=function(){this.playIdle()},C.prototype.setOkayListener=function(T){this.mOkayCallback=T},C.prototype.giftClickCallback=function(){this.mAnimation=this.mChestRootNode.getComponent(cc.Animation),this.mAnimation.getAnimationState("open").isPlaying||(this.mReward||(console.warn("reward got error, use default"),this.mReward=d.default.getInstance().openChestWithDefaultReward()),this.mChestRootNode.getComponent(cc.Animation).stop("idle"),this.playOpen())},C.prototype.playIdle=function(){var T=this.mChestRootNode.getComponent(cc.Animation);T.play("idle"),T.on("finished",this.giftClickCallback,this)},C.prototype.playOpen=function(){this.mAnimation=this.mChestRootNode.getComponent(cc.Animation),this.mAnimation.play("open"),this.mAnimation.on("finished",this.onAnimFinished.bind(this),this)},C.prototype.onAnimFinished=function(){this.showAwardPopup()},C.prototype.showAwardPopup=function(){this.mBg.node.active=!1,this.mTopLayout.active=!1,this.mGiftBoxNode.active=!1,this.showAwardPage()},C.prototype.showAwardPage=function(){var T=this,E=new s.AwardResultInfo,A="/static_res/share_gift_congratulation_title",M="\u597D\u7684";f.default.getInstance().isEnglish()&&(A="/static_res/share_gift_congratulation_title_en",M="ok"),E.setTitlePicPath(A).setIsNeedGiveAwardInfo(!0).steSource(s.AwardResultInfo.SOURCE_GAME_CHEST).setCloseParentCallback(function(){T.onAwardTipsClickCallback&&T.onAwardTipsClickCallback(T.mReward)}).setOkBtn(M,function(){T.mOkayCallback&&T.mOkayCallback(T.mReward,o.default.Ins().isNeedShowPieceTipsDialog(E.getAwardContentList())),s.AwardController.getIns().dismissAwardResultPage(E)}).enableSkipLabel("",function(){T.mOkayCallback&&T.mOkayCallback(T.mReward,o.default.Ins().isNeedShowPieceTipsDialog(E.getAwardContentList())),s.AwardController.getIns().dismissAwardResultPage(E)}).setDoubleBtn("double vidoe",function(){console.warn("click~!");var L=n.ADScene.PLAY_AGAIN;e.MGAdv.show(L,n.QQ_ADV_TYPE.VIDEO_TYPE_SKIN_UNLOCK,function(b){if(cc.isValid(T,!0))switch(b){case n.ADStat.NOT_NETWORK:T.showToastTips("No network available",!0);break;case n.ADStat.SHOW_SUCCESS_CLOSE:T.onDoubleWatchAdsSuccess(E),T.showToastTips("Received rewards successfully",!0);break;case n.ADStat.SHOW_NOT_ENED_CLOSE:T.showToastTips("show not end close",!0);break;case n.ADStat.SHOW_GET_AD_FAILED:T.showToastTips("No video ads available",!0)}})}),0<this.mReward.diamond&&E.addAwardContent(r.GameItemType.TYPE_DIAMONDS,this.mReward.diamond,r.GameItemsDefine.ID_DIAMOND),0<this.mReward.gold&&E.addAwardContent(r.GameItemType.TYPE_GOLD,this.mReward.gold,r.GameItemsDefine.ID_GOLD),0<this.mReward.lift&&E.addAwardContent(r.GameItemType.TYPE_HP,this.mReward.lift,r.GameItemsDefine.ID_POWER),this.mReward.skinPieces&&0<this.mReward.skinPieces.length&&this.mReward.skinPieces.forEach(function(L){E.addAwardContent(r.GameItemType.TYPE_PIECE,L.count,L.pieceID)}),this.mShowAds=this.isNeedShowAdsAward(),f.default.getInstance().isEnglish()&&(this.mShowAds=!1);var k="/static_res/btn_getreward_normal",D="/static_res/btn_getreward_press";f.default.getInstance().isEnglish()&&(k="/static_res/btn_getreward_normal_en",D="/static_res/btn_getreward_press_en"),this.mShowAds&&(h.default.isWeiXin()||e.MGAdv.load(n.ADScene.NORMAL_RESULT_REWARD,n.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),E.setIsShowText(!1),E.setRichOkBtn("",k,D,function(){s.AwardController.getIns().dismissAwardResultPage(E),T.mOkayCallback&&T.mOkayCallback(T.mReward,o.default.Ins().isNeedShowPieceTipsDialog(E.getAwardContentList())),T.adsClick()}),E.enableSkipLabel("",function(){console.log("czx awardResultInfo enableSkipLabel",T.mOkayCallback),s.AwardController.getIns().dismissAwardResultPage(E),T.mOkayCallback&&T.mOkayCallback(T.mReward,o.default.Ins().isNeedShowPieceTipsDialog(E.getAwardContentList()))})),s.AwardController.getIns().showCommonAwardResultPage(E)},C.prototype.onDoubleWatchAdsSuccess=function(T){if(this.mOkayCallback){var E=s.AwardController.filterAwardsForDouble(T.getAwardContentList());s.AwardController.giveAwardInfo(E),this.mOkayCallback(this.mReward,o.default.Ins().isNeedShowPieceTipsDialog(T.getAwardContentList()))}s.AwardController.getIns().dismissAwardResultPage(T)},C.prototype.adsClick=function(){var T=this,E=n.ADScene.NORMAL_RESULT_REWARD;e.MGAdv.show(E,n.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(A){switch(A){case n.ADStat.NOT_NETWORK:T.showToastTips("No network available",!0);break;case n.ADStat.SHOW_SUCCESS_CLOSE:T.seeAdsSuccess(),T.saveReward2Local();break;case n.ADStat.SHOW_NOT_ENED_CLOSE:break;case n.ADStat.SHOW_GET_AD_FAILED:T.showToastTips("No video ads available",!0)}})},C.prototype.seeAdsSuccess=function(){this.showToastTips("\u606D\u559C\u83B7\u5F97\u989D\u5916\u94BB\u77F3x5\u5956\u52B1",!0),p.MoneySystem.increaseDiamond(5)},C.prototype.showToastTips=function(T,E,A){var M=cc.director.getScene();M&&c.default.load("prefab/ToastPrefab",function(k,D){var L=D.getComponent(u.default);L.showTips(T,function(){D.destroy(),A&&A()}),L.setLong(E),M.addChild(D)})},C.prototype.saveReward2Local=function(){if(this.isTodayReward()){var T=t.default.read(i.default.RESULT_REWARD_COUNT),E=parseInt(T)+1;t.default.save(i.default.RESULT_REWARD_COUNT,E.toString())}else t.default.save(i.default.RESULT_REWARD_COUNT_DATE,new Date().getTime()+""),t.default.save(i.default.RESULT_REWARD_COUNT,"1")},C.prototype.isNeedShowAdsAward=function(){var T=e.MGAdv.isADCached(n.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK);if(!e.MGAdv.isADFeatureEnable()||!T)return!1;if(this.isTodayReward()){var E=t.default.read(i.default.RESULT_REWARD_COUNT);if(E&&2<=parseInt(E))return!1}return!0},C.prototype.isTodayReward=function(){var T=parseInt(t.default.read(i.default.RESULT_REWARD_COUNT_DATE)),E=a.default.formatDate(T);return a.default.getTodayFormatDate()==E},C.prototype.onDestroy=function(){this.mAnimation&&this.mAnimation.off("finished",this.onAnimFinished,this)},__decorate([S(cc.Node)],C.prototype,"mChestRootNode",void 0),__decorate([S(cc.Node)],C.prototype,"mGiftBoxNode",void 0),__decorate([S(cc.Node)],C.prototype,"mTopLayout",void 0),__decorate([S(cc.Sprite)],C.prototype,"mBg",void 0),__decorate([S(cc.Sprite)],C.prototype,"mTopSprite",void 0),__decorate([S(cc.Sprite)],C.prototype,"mBottomSprite",void 0),__decorate([S(cc.Label)],C.prototype,"mChestCount",void 0),__decorate([S(cc.Prefab)],C.prototype,"mAwardPrefab",void 0),__decorate([S(cc.Layout)],C.prototype,"mPopupLayout",void 0),C=__decorate([y],C)}(cc.Component);m.default=I,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../business/Logic/I18nManager":"I18nManager","../../config/LSKey":"LSKey","../../util/PU":"PU","../../util/TimeUtil":"TimeUtil","../Logic/ChestManager":"ChestManager","../Logic/GameItemsManager":"GameItemsManager","../Logic/MoneySystem":"MoneySystem","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../awardcontroller/AwardController":"AwardController","../keypad/KeypadNavigator":"KeypadNavigator","../skin/SkinPieceMgr":"SkinPieceMgr"}],GoldBuyTask:[function(l,P,m){"use strict";cc._RF.push(P,"ef55ddM88ZJdoVfNCRrBkqi","GoldBuyTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],GoldData:[function(l,P,m){"use strict";cc._RF.push(P,"09a8c5ik9hKrYVAp5MmyE1D","GoldData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findGoldByLevel=function(n){return this.find("Lv",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.GoldData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getLv=function(){return this.getInt("Lv")},e.prototype.getGold=function(){return this.getFloat("Gold")},e.prototype.getPvpGold1=function(){return this.getFloat("PvpGold1")},e.prototype.getPvpGold2=function(){return this.getFloat("PvpGold2")},e.prototype.getPvpGold3=function(){return this.getFloat("PvpGold3")},e.prototype.getMaxGold=function(){return this.getInt("MaxGold")},e.prototype.getPvpMaxGold=function(){return this.getInt("PvpMaxGold")},e}(d.default);m.GoldRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],GoldPopupProfab:[function(l,P,m){"use strict";cc._RF.push(P,"162c0F5F5JFMaUhhrxwXZMG","GoldPopupProfab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Logic/PlayerMgr"),s=l("../UserInfoManager"),r=l("../../../util/SceneMusicMgr"),o=l("../GameEntraScene/BasicTouchEvent"),e=l("../../../infoc/m_p2_PData_Dia"),n=l("../../../infoc/m_p2_pop_coin"),t=l("../../keypad/KeypadNavigator"),i=cc._decorator,a=i.ccclass,u=i.property,c=function(p){function h(){var f=p!==null&&p.apply(this,arguments)||this;return f.gold_count_label=null,f.m100GoldSprite=null,f.m1100GoldSprite=null,f.m12999GoldSprite=null,f.m100ContentLayout=null,f.mTopDestGoldSprite=null,f.mContentLayout=null,f.mBgLight=null,f.mSlipActive=null,f.close_btn=null,f.get_gold_100_btn=null,f.get_gold_1100_btn=null,f.get_gold_12999_btn=null,f.mCloseBtnClickCallback=null,f.mGetGold100BtnClickCallback=null,f.mGetGold1100BtnClickCallback=null,f.mGetGold12999BtnClickCallback=null,f}return __extends(h,p),h.prototype.setCloseCallback=function(f){this.mCloseCallback=f},h.prototype.setToDiamondPopupPrefab=function(f){this.mToDiamondPopupPrefab=f},h.prototype.onLoad=function(){this.mContentLayout.getComponent(cc.Animation).play("gold_pop_out"),d.default.Ins().addUserListener(this),this.node.on(cc.Node.EventType.TOUCH_START,function(f){f.stopPropagation()}),this.mBgLight.node.active=!1,this.mSlipActive.node.active=!1,this.initEvent(),t.default.getInstance().pushDialog(this.node)},h.prototype.initEvent=function(){var f=this;this.mCloseBtnClickCallback=new o.default(function(){f.closeBtnClick()}),this.close_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseBtnClickCallback.click,this.mCloseBtnClickCallback),this.mGetGold100BtnClickCallback=new o.default(function(){f.getGold100BtnClick()}),this.get_gold_100_btn.node.on(cc.Node.EventType.TOUCH_END,this.mGetGold100BtnClickCallback.click,this.mGetGold100BtnClickCallback),this.mGetGold1100BtnClickCallback=new o.default(function(){f.getGold1100BtnClick()}),this.get_gold_1100_btn.node.on(cc.Node.EventType.TOUCH_END,this.mGetGold1100BtnClickCallback.click,this.mGetGold1100BtnClickCallback),this.mGetGold12999BtnClickCallback=new o.default(function(){f.getGold12999BtnClick()}),this.get_gold_12999_btn.node.on(cc.Node.EventType.TOUCH_END,this.mGetGold12999BtnClickCallback.click,this.mGetGold12999BtnClickCallback)},h.prototype.start=function(){},h.prototype.onDestroy=function(){d.default.Ins().removeUserListener(this),r.default.stop(r.default.NAME_BUY_GOLD),t.default.getInstance().popDialog(this.node)},h.prototype.onChange=function(f,g,_,y,S){this.gold_count_label.string=""+g},h.prototype.closeBtnClick=function(){n.default.report(n.default.SCENE_GET_GOLD_DIALOG,this.mSource,n.default.ACTION_CLICK_DIALOG_CLOSE_BTN),this.mCloseCallback&&this.mCloseCallback()},h.prototype.setCoinLabel=function(){this.gold_count_label.string=s.User.UserInfoManager.getUserInfo().coin+""},h.prototype.getGold100BtnClick=function(){var f=this;n.default.report(n.default.SCENE_GET_GOLD_DIALOG,this.mSource,n.default.ACTION_CLICK_1_DIAMOND),s.User.UserInfoManager.buyCoinByDiamond(1)?(e.default.report(1,e.default.SOURCE_BUY_GOLD_USE,e.default.ACTION_CONSUME_DIAMOND),this.mBgLight.node.active=!0,this.mSlipActive.node.active=!0,this.mTopDestGoldSprite.node.active=!1,r.default.play(r.default.NAME_BUY_GOLD,r.default.PATH_BUY_GOLD,!1),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m100GoldSprite,function(){f.setCoinLabel(),f.mBgLight.node.active=!1,f.mSlipActive.node.active=!1,f.mTopDestGoldSprite.node.active=!0})},0)):this.toDiamondPopupPrefab()},h.prototype.getGold1100BtnClick=function(){var f=this;n.default.report(n.default.SCENE_GET_GOLD_DIALOG,this.mSource,n.default.ACTION_CLICK_10_DIAMOND),s.User.UserInfoManager.buyCoinByDiamond(10)?(e.default.report(10,e.default.SOURCE_BUY_GOLD_USE,e.default.ACTION_CONSUME_DIAMOND),this.mBgLight.node.active=!0,this.mSlipActive.node.active=!0,this.mTopDestGoldSprite.node.active=!1,r.default.play(r.default.NAME_BUY_GOLD,r.default.PATH_BUY_GOLD,!1),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m1100GoldSprite)},.1),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m1100GoldSprite)},.2),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m1100GoldSprite,function(){f.setCoinLabel(),f.mBgLight.node.active=!1,f.mSlipActive.node.active=!1,f.mTopDestGoldSprite.node.active=!0})},.3)):this.toDiamondPopupPrefab()},h.prototype.getGold12999BtnClick=function(){var f=this;n.default.report(n.default.SCENE_GET_GOLD_DIALOG,this.mSource,n.default.ACTION_CLICK_100_DIAMOND),s.User.UserInfoManager.buyCoinByDiamond(100)?(e.default.report(100,e.default.SOURCE_BUY_GOLD_USE,e.default.ACTION_CONSUME_DIAMOND),this.mBgLight.node.active=!0,this.mSlipActive.node.active=!0,this.mTopDestGoldSprite.node.active=!1,r.default.play(r.default.NAME_BUY_GOLD,r.default.PATH_BUY_GOLD,!1),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m12999GoldSprite)},.1),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m12999GoldSprite)},.2),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m12999GoldSprite)},.3),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m12999GoldSprite)},.4),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m12999GoldSprite)},.5),this.scheduleOnce(function(){f.playBuyGoldSuccessAnim(f.m12999GoldSprite,function(){f.setCoinLabel(),f.mBgLight.node.active=!1,f.mSlipActive.node.active=!1,f.mTopDestGoldSprite.node.active=!0})},.6)):this.toDiamondPopupPrefab()},h.prototype.toDiamondPopupPrefab=function(){this.mToDiamondPopupPrefab&&this.mToDiamondPopupPrefab()},h.prototype.playBuyGoldSuccessAnim=function(f,g){var _=new cc.Node;_.width=56,_.height=56;var y=f.node.parent.convertToWorldSpaceAR(f.node.getPosition()),S=this.node.convertToNodeSpaceAR(y);_.setPosition(S),_.addComponent(cc.Sprite).spriteFrame=f.spriteFrame;var I=this.mBgLight.node.parent.convertToWorldSpaceAR(this.mBgLight.node.getPosition()),v=this.node.convertToNodeSpaceAR(I);this.node.addChild(_);var C=v.x-_.x,T=v.y-_.y,E=[cc.p(v.x-.3*C,v.y-.8*T),cc.p(v.x-0*C,v.y-.3*T),cc.p(v.x,v.y)],A=cc.bezierTo(.2,E),M=cc.fadeTo(.01,0),k=cc.sequence(A,M,cc.callFunc(function(){g&&g()}));_.runAction(k)},h.prototype.setSource=function(f){this.mSource=f},h.prototype.getSource=function(){return this.mSource},__decorate([u(cc.Label)],h.prototype,"gold_count_label",void 0),__decorate([u(cc.Sprite)],h.prototype,"m100GoldSprite",void 0),__decorate([u(cc.Sprite)],h.prototype,"m1100GoldSprite",void 0),__decorate([u(cc.Sprite)],h.prototype,"m12999GoldSprite",void 0),__decorate([u(cc.Layout)],h.prototype,"m100ContentLayout",void 0),__decorate([u(cc.Sprite)],h.prototype,"mTopDestGoldSprite",void 0),__decorate([u(cc.Layout)],h.prototype,"mContentLayout",void 0),__decorate([u(cc.Sprite)],h.prototype,"mBgLight",void 0),__decorate([u(cc.Sprite)],h.prototype,"mSlipActive",void 0),__decorate([u(cc.Button)],h.prototype,"close_btn",void 0),__decorate([u(cc.Button)],h.prototype,"get_gold_100_btn",void 0),__decorate([u(cc.Button)],h.prototype,"get_gold_1100_btn",void 0),__decorate([u(cc.Button)],h.prototype,"get_gold_12999_btn",void 0),h=__decorate([a],h)}(cc.Component);m.default=c,cc._RF.pop()},{"../../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../../infoc/m_p2_pop_coin":"m_p2_pop_coin","../../../util/SceneMusicMgr":"SceneMusicMgr","../../Logic/PlayerMgr":"PlayerMgr","../../keypad/KeypadNavigator":"KeypadNavigator","../GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UserInfoManager":"UserInfoManager"}],GuidanceInfo:[function(l,P,m){"use strict";cc._RF.push(P,"1bf79O6GG9CxahkVbylxori","GuidanceInfo"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){};m.default=d;var s=function(){};m.PrefabItem=s;var r=function(){};m.GuidanceItem=r,cc._RF.pop()},{}],G:[function(l,P,m){"use strict";cc._RF.push(P,"79b33rxbvZOSI1Xc+21WqVQ","G"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("../social/SocialHelper");(d=m.G||(m.G={})).GAME_SCENE_NAME="GameSceneEntry",d.GAME_OVER_SCENE_NAME="GameOverSceneUpdate",d.Ap=null,d.enterGameTime=0,d.networkType=null,d.networkIsConnected=!0,d.launchOption=null,d.skinTryData=null,d.songTryData=null,d.tryData=null,d.getLaunchOption=function(){return d.launchOption?d.launchOption:s.SocialHelper.getLaunchParameter()},d.isCloudHotSongUpgrade=!1,d.propAddition=null,cc._RF.pop()},{"../social/SocialHelper":"SocialHelper"}],HolidayTaskData:[function(l,P,m){"use strict";cc._RF.push(P,"95e68DgVi9G+7B+SyFtNfh4","HolidayTaskData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("Id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.HolidayTaskData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getHolidayId=function(){return this.getString("holidayID")},e.prototype.getTaskId=function(){return this.getString("taskID")},e.prototype.getTotal=function(){return this.getInt("total")},e.prototype.getRewardID=function(){return this.getString("rewardID")},e.prototype.getShowBtn=function(){return this.getInt("showBtn")==1},e.prototype.getTryMusicId=function(){var n=this.getInt("tryMusicId");return isNaN(Number(n))?0:Number(n)},e.prototype.getQQShareImgUrl=function(){return this.getString("qqShareImgUrl")},e.prototype.getTaskKey=function(){return this.getString("taskKey")},e.prototype.getDesc=function(){return this.getString("desc")},e.prototype.getStep=function(){return this.getString("step")},e.prototype.getReward=function(){return this.getString("reward")},e.prototype.getBeginTime=function(){return this.getInt("beginTime")},e.prototype.getEndTime=function(){return this.getInt("endTime")},e.prototype.getRefresh=function(){return!!this.getInt("refresh")},e}(d.default);m.HolidayTaskItemsRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],HolidayTaskItem:[function(l,P,m){"use strict";cc._RF.push(P,"d3916+UZ+BJEJgrKwtcGxCj","HolidayTaskItem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./HolidayTask"),s=l("../../util/NumberUtil"),r=l("../skin/frag/SkinTaskItem"),o=function(){function e(n,t,i){this.curGetCount=0,this.curStep=0,this.status=[],this.holidayId=n,this.taskKey=t,this.taskID=i}return e.prototype.getTaskStr=function(){var n=this.taskID+"*";return n+=this.curGetCount,this.status.forEach(function(t){n+="*"+t}),n},e.prototype.formatStrToItem=function(n){this.curGetCount=s.default.parseIntFromString(n[1]);for(var t=2;t<n.length;t++)this.status[t-2]=s.default.parseIntFromString(n[t]);this.setCurrentStep()},e.prototype.refreshTaskInfo=function(){this.curGetCount=0,this.status.splice(0,this.status.length);for(var n=0;n<this.stepTarget.length;n++)this.status.push(r.TaskStatus.STATUS_NONE)},e.prototype.isFinishTaskItem=function(){return this.curStep>=this.stepTarget.length},e.prototype.refreshTaskStatus=function(n,t){this.status[n]=t},e.prototype.setTaskItemData=function(n,t){switch(this.taskKey){case d.HolidayTaskKey.TASK_DAILY_LOGIN_GAME:n||(this.curGetCount+=t);break;case d.HolidayTaskKey.TASK_PLAY_RANK_GAME:n?this.curGetCount+=t:this.curGetCount=1;break;case d.HolidayTaskKey.TASK_INVITE_NEW_PLAYER:default:this.curGetCount+=t}this.setCurrentStep()},e.prototype.setCurrentStep=function(){for(var n=0;n<this.stepTarget.length&&this.stepTarget[n]<=this.curGetCount;n++)this.status[n]!=r.TaskStatus.STATUS_FINISH&&(this.status[n]=r.TaskStatus.STATUS_SUCCESS),this.curStep=n},e.prototype.getCurrentReward=function(){return this.reward[this.curStep]},e}();m.default=o,cc._RF.pop()},{"../../util/NumberUtil":"NumberUtil","../skin/frag/SkinTaskItem":"SkinTaskItem","./HolidayTask":"HolidayTask"}],HolidayTaskMgr:[function(l,P,m){"use strict";cc._RF.push(P,"ccd7b/ozRZCSIMZPhRmqbAP","HolidayTaskMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./HolidayTask"),s=l("../../base/Log"),r=l("./HolidayTaskItem"),o=l("../skin/frag/SkinTaskItem"),e=l("../Network/Protocol/StorageUtil"),n=l("../../config/LSKey"),t=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),i=l("../../util/StringUtil"),a=l("../DB/DBMgr"),u=l("../Logic/EventBus"),c=l("../Logic/NotifyEvent"),p=l("../../util/PU"),h=function(){function f(){this.TASK_HOLIDAY_TONE="",this.mAllTaskArray=new Map,this.initAndRefreshData()}return f.Ins=function(){return this.ins==null&&(this.ins=new f),this.ins},f.prototype.initAndRefreshData=function(){if(this.isFuncEnabled()){this.mAllTaskArray.clear();var g=this.readTaskDataLocal(),_=a.default.Ins().getDBRows(a.eDataBase.eDB_HolidayTask);this.parseConfig(_,g),this.TASK_HOLIDAY_TONE=this.getInTimeTask(),s.default.l("the init  data holiday task is "+this.TASK_HOLIDAY_TONE)}},f.prototype.parseConfig=function(g,_){if(g)for(var y=0,S=g;y<S.length;y++){var I=S[y];if(I&&!i.StringUtil.isEmpty(I.getHolidayId())){var v=new r.default(I.getHolidayId(),I.getTaskKey(),I.getTaskId());v.stepTarget=this.parseStringList(I.getStep()),v.reward=this.parseStringList(I.getReward()),v.desc=I.getDesc(),v.repeat=I.getRefresh();for(var C=0;C<v.stepTarget.length;C++)v.status.push(o.TaskStatus.STATUS_NONE);var T=this.mAllTaskArray.get(I.getHolidayId());T||(T=new d.default(I.getHolidayId(),I.getTotal())),T.taskItems.push(v),T.beginTime==null&&(T.beginTime=I.getBeginTime()),T.endTime==null&&(T.endTime=I.getEndTime()),T.rewardID==null&&(T.rewardID=I.getRewardID()),T.showBtn==null&&(T.showBtn=I.getShowBtn()),T.tryMusicLevelID==null&&(T.tryMusicLevelID=I.getTryMusicId()),T.qqShareImgUrl==null&&(T.qqShareImgUrl=I.getQQShareImgUrl()),this.mAllTaskArray.set(T.holidayID,T)}}_&&0<_.length&&this.mAllTaskArray.forEach(function(E){E&&_.forEach(function(A){return E.readTaskDataLocal(A)})})},f.prototype.parseStringList=function(g){if(i.StringUtil.isEmpty(g))return console.warn("parseStringList is empty"),[];var _=g.split("-");if(_){for(var y=[],S=0,I=_;S<I.length;S++){var v=I[S];v?y.push(parseFloat(v)):console.warn("parseStringList detail error")}return y}return console.warn("parseStringList data parse error"),[]},f.prototype.saveTask=function(){var g=this;this.isFuncEnabled()&&this.mAllTaskArray&&0<this.mAllTaskArray.size&&this.getCurTime(function(_,y){if(_){var S="";g.mAllTaskArray.forEach(function(I,v){S+=I.saveTaskData(y)+"#"}),1<S.length&&(S=S.substr(0,S.length-1)),s.default.l("the holidaytaskMgr savestr is "+S),e.default.save(n.default.HOLIDAY_TASK_LIST,S)}})},f.prototype.readTaskDataLocal=function(){var g=[],_=e.default.read(n.default.HOLIDAY_TASK_LIST);if(!i.StringUtil.isEmpty(_)){_.startsWith("undefined")&&(_=_.replace("undefined",""));for(var y=0,S=_.split("#");y<S.length;y++){var I=S[y];g.push(I)}}return g},f.prototype.getTask=function(g){return this.isFuncEnabled()?i.StringUtil.isEmpty(g)?(s.default.e("get Task holiday id is err is empty"),null):this.mAllTaskArray.get(g):null},f.prototype.getInTimeTask=function(){if(this.isFuncEnabled()){var g=t.MGUser.getCurrentServerTime(),_="";return this.mAllTaskArray.forEach(function(y){y.beginTime<=g&&y.endTime>=g&&(_=y.holidayID)}),_}},f.prototype.RefreshTask=function(g,_){if(this.isFuncEnabled()){var y=this.mAllTaskArray.get(this.TASK_HOLIDAY_TONE);if(y){var S=t.MGUser.getCurrentServerTime();y.beginTime<=S&&y.endTime>=S&&y.setTaskData(g,_)}this.saveTask(),s.default.i(f.TAG+"RefreshTask key = "+g+",currentStep = "+_,this),u.default.fire(c.default.TASK_ITEM_UPDATE_WELF_STEP)}},f.prototype.setTaskItemFinish=function(g,_,y,S){if(this.isFuncEnabled()){var I=this.getTask(g);I&&(I.setTaskStatus(_,y,S),this.saveTask())}},f.prototype.getCurTime=function(g){t.MGUser.getCurrentServerRealTime({complete:function(_,y){g(_,y)}})},f.prototype.isFuncEnabled=function(){return!p.default.isCM()},f.TAG="HolidayTaskMgr ====>>",f.ins=null,f}();m.default=h,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../config/LSKey":"LSKey","../../util/PU":"PU","../../util/StringUtil":"StringUtil","../DB/DBMgr":"DBMgr","../Logic/EventBus":"EventBus","../Logic/NotifyEvent":"NotifyEvent","../Network/Protocol/StorageUtil":"StorageUtil","../skin/frag/SkinTaskItem":"SkinTaskItem","./HolidayTask":"HolidayTask","./HolidayTaskItem":"HolidayTaskItem"}],HolidayTask:[function(l,P,m){"use strict";cc._RF.push(P,"3a4f905EEZBGpQdV2dYgfVF","HolidayTask"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("../../util/TimeUtil"),r=l("../../base/Log"),o=l("../../util/NumberUtil"),e=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),n=l("../../util/StringUtil");(d=m.HolidayTaskKey||(m.HolidayTaskKey={})).TASK_DAILY_LOGIN_GAME="daily_login_game",d.TASK_PLAY_RANK_GAME="play_rank_game",d.TASK_INVITE_NEW_PLAYER="invite_new_player";var t=function(){function i(a,u){this.holidayID=null,this.beginTime=null,this.endTime=null,this.total=null,this.rewardID=null,this.showBtn=null,this.tryMusicLevelID=null,this.qqShareImgUrl=null,this.CurrentEnergy=0,this.holidayID=a,this.taskItems=[],this.total=u}return i.prototype.saveTaskData=function(a){var u=s.default.formatDate(a)+"&";return this.mLastSaveDay=s.default.formatDate(a),u+=this.holidayID+"&",u+=this.CurrentEnergy+"&",this.taskItems.forEach(function(c){u+=c.getTaskStr()+"&"}),u=u.substr(0,u.length-1),r.default.l(" saveHolidayTaskMgr timeStamp = "+a+",saveStr = "+u),u},i.prototype.readTaskDataLocal=function(a){if(!n.StringUtil.isEmpty(a)){var u=a.split("&");if(u&&1<u.length&&this.holidayID==u[1]){this.mLastSaveDay=u[0],this.CurrentEnergy=o.default.parseIntFromString(u[2]);for(var c=!this.isSameDay(),p=Math.min(this.taskItems.length,u.length-3),h=0;h<p;h++)if(this.taskItems[h]){var f=u[h+3].split("*");this.taskItems[h].taskID===f[0]&&(this.taskItems[h].formatStrToItem(f),this.taskItems[h].repeat&&c&&this.taskItems[h].refreshTaskInfo())}}}},i.prototype.isSameDay=function(){var a=s.default.formatDate(e.MGUser.getCurrentServerTime());return!!this.mLastSaveDay&&a===this.mLastSaveDay},i.prototype.setTaskData=function(a,u){for(var c=0,p=this.taskItems;c<p.length;c++){var h=p[c];h.taskKey===a&&h.setTaskItemData(this.isSameDay(),u)}},i.prototype.setTaskStatus=function(a,u,c){for(var p=0,h=this.taskItems;p<h.length;p++){var f=h[p];f.taskKey===a&&(f.refreshTaskStatus(u,c),this.CurrentEnergy+=f.reward[u])}},i}();m.default=t,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../util/NumberUtil":"NumberUtil","../../util/StringUtil":"StringUtil","../../util/TimeUtil":"TimeUtil"}],HomePagePrefb:[function(l,P,m){"use strict";cc._RF.push(P,"4ffa0Ql0CVIaa1ieTLI2zdb","HomePagePrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/G"),s=l("../MusicLevelDataLoader"),r=l("../../../base/State"),o=l("../../Logic/PlayerMgr"),e=l("../../Logic/Plugin/PluginMgr"),n=l("../../Logic/Plugin/IPlugin"),t=l("./BasicTouchEvent"),i=l("../../../infoc/m_p2_Uaction"),a=l("../../../util/SUtil"),u=l("../../Logic/EventBus"),c=l("../../Logic/NotifyEvent"),p=l("./ImgCache"),h=l("../../task/newguidance/NewGuidanceLoader"),f=l("./PrefabMgr"),g=l("./MainpageRightBtnPanel"),_=l("./ToastPrefab"),y=l("../../../util/PU"),S=l("../../../base/Log"),I=l("../GameClub"),v=l("../../Network/Protocol/StorageUtil"),C=l("../../../config/LSKey"),T=l("../../skin/frag/SkinTaskMgr"),E=l("../../../util/StringUtil"),A=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),M=l("../../../base/Startup"),k=l("../../Logic/I18nManager"),D=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),L=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),b=l("../../keypad/KeypadUtil"),N=cc._decorator,H=N.ccclass,R=N.property,F=function(x){function U(){var B=x!==null&&x.apply(this,arguments)||this;return B.mMusicNameLabel=null,B.mStartBtn=null,B.mLevelSprite_1=null,B.mLevelSprite_2=null,B.mLevelSprite_3=null,B.star_layout=null,B.star1=null,B.star2=null,B.star3=null,B.crow_layout=null,B.crow1=null,B.crow2=null,B.crow3=null,B.mDiscSprite=null,B.mElementFrames=null,B.mRecommendNode=null,B.mUseEnergyCallback=null,B.mStartBtnClickCallback=null,B.mItemInfo=null,B.mHomePageAvatorClickCallback=null,B.mAvatorClickCallback=null,B.mHomePageShareGiftClickCallback=null,B.mSkinClickCallback=null,B.mShowSkinStoreCallback=null,B.mShowSkinPieceCallback=null,B.mHomePageDailyAtdcClickCallback=null,B.mToHotMusicTabCallback=null,B.mRightBtnPanelScript=null,B.mGameClubVisibility=!1,B.mUpdateTask=[],B.mHomeMusicLibIcon="static_res/homepage/home_music_lib_icon",B.mHomeMusicLibIconPress="static_res/homepage/home_music_lib_icon_press",B.mHotMusicLibIcon="static_res/homepage/home_hot_music_icon",B.mHotMusicLibIconPress="static_res/homepage/home_hot_music_icon_press",B.mMoveVal=46,B}return __extends(U,x),U.prototype.enResLoad=function(){var B=this;this.enSpriteSetNull(),this.mHomeMusicLibIcon="static_res/homepage/en/home_music_lib_icon_en",this.mHomeMusicLibIconPress="static_res/homepage/en/home_music_lib_icon_press_en",this.mHotMusicLibIcon="static_res/homepage/en/home_hot_music_icon_en",this.mHotMusicLibIconPress="static_res/homepage/en/home_hot_music_icon_press_en",p.default.get(this.mHomeMusicLibIcon,function(Q,Z){cc.isValid(B,!0)&&(B.mMusicLibBtn.normalSprite=Z)}),p.default.get(this.mHomeMusicLibIconPress,function(Q,Z){cc.isValid(B,!0)&&(B.mMusicLibBtn.pressedSprite=Z)}),p.default.get(this.mHotMusicLibIcon,function(Q,Z){cc.isValid(B,!0)&&(B.mHotMusicBtn.normalSprite=Z)}),p.default.get(this.mHotMusicLibIconPress,function(Q,Z){cc.isValid(B,!0)&&(B.mHotMusicBtn.pressedSprite=Z)})},U.prototype.enSpriteSetNull=function(){this.mMusicLibBtn.getComponent(cc.Sprite).spriteFrame=null,this.mHotMusicBtn.getComponent(cc.Sprite).spriteFrame=null},U.prototype.onLoad=function(){var B=this;k.default.getInstance().isEnglish()&&this.enResLoad(),this.mItemInfo=s.MusicLevelDataLoader.getHomePageItemInfo(),this.adaptorUI(),this.mEventStopCallback=function(Q){switch(Q){case cc.Node.EventType.TOUCH_START:B.mEventStopNode.active=!0;break;case cc.Node.EventType.TOUCH_END:case cc.Node.EventType.TOUCH_CANCEL:B.mEventStopNode.active=!1}},this.initEvent(),this.initIcons(),this.initCrossComponent(this.node),this.updateView(),this.initRecommendGame()},U.prototype.postUpdateTask=function(B){this.mUpdateTask.push(B)},U.prototype.update=function(){0<this.mUpdateTask.length&&this.mUpdateTask.shift()()},U.prototype.updateView=function(){this.mMusicNameLabel.string=this.mItemInfo.index+"."+this.mItemInfo.musicName;var B=o.default.Ins().getLevelRecordByMid(this.mItemInfo.musicId);B?B.mBestStar<=3?this.showStar(B.mBestStar):this.showCrow(B.mBestStar-3):this.showStar(0),this.initHotSongRedSpot(),this.refreshUnlockProgress(),this.onSkinChange()},U.prototype.onStart=function(){},U.prototype.onStop=function(){},U.prototype.onShow=function(){S.default.i("[HomePagePrefab].onshow enter .... "),this.mItemInfo=s.MusicLevelDataLoader.getHomePageItemInfo(),this.updateView()},U.prototype.showFightGuide=function(){var B=this,Q=!0;if(v.default.read(C.default.HAS_WIN_FIGHT,"")!="true"){var Z=v.default.read(C.default.HAS_SHOW_GAME_ENTRA,"");if(E.StringUtil.isEmpty(Z))v.default.save(C.default.HAS_SHOW_GAME_ENTRA,"true"),Q=!1;else{var z=v.default.read(C.default.GUIDE_TO_FIGHT_TIMES,"");if(z=="2")Q=!1;else if(!E.StringUtil.isEmpty(z)){var W=v.default.read(C.default.LAST_GUIDE_TO_FIGHT_TIME,"");E.StringUtil.isEmpty(W)||A.MGUser.getCurrentServerTime()-parseInt(W)<864e5&&(Q=!1)}}}else Q=!1;Q&&this.scheduleOnce(function(){B.hideNewTargetGuideFinger(),h.default.getInstance().showGuideFinger("NewPlayerTarget","HomePagePreF","GuideToChallenge",B.node,!1,function(){u.default.fire(c.default.HIDE_GUIDE_FINGER)}),v.default.save(C.default.LAST_GUIDE_TO_FIGHT_TIME,A.MGUser.getCurrentServerTime().toString());var V=v.default.read(C.default.GUIDE_TO_FIGHT_TIMES,"");E.StringUtil.isEmpty(V)?v.default.save(C.default.GUIDE_TO_FIGHT_TIMES,"1"):V=="1"&&v.default.save(C.default.GUIDE_TO_FIGHT_TIMES,"2")},1)},U.prototype.hideFightGuide=function(){var B=v.default.read(C.default.GUIDE_TO_FIGHT_TIMES,"");if(!E.StringUtil.isEmpty(B)){var Q=this.node.getChildByTag(h.default.FINGER_NODE_OTHER_TAG);Q&&(this.node.removeChildByTag(h.default.FINGER_NODE_OTHER_TAG),Q.destroy())}},U.prototype.onHide=function(){},U.prototype.initIcons=function(){var B=this;f.default.load("prefab/MainpageRightBtnPanel",function(Q,Z){Z&&(b.default.isHorizon()&&(Z.scale=1.25,console.warn("scale MainPageRightPanel to 1.25x")),B.mRightBtnPanelScript=Z.getComponent(g.default),B.mRightBtnPanelScript.setEventStopCallback(B.mEventStopCallback),B.mRightBtnPanelScript.setToSharePageCallback(B.mHomePageShareGiftClickCallback),B.mRightBtnPanelScript.setToLottaryPageCallback(B.mToLottaryPageCallback),B.mRightBtnPanelScript.setToChosenMusicPageCallback(B.mToChosenMusicPageCallback),B.mRightBtnPanelScript.setToSkinPiecesPageCallback(B.mShowSkinPieceCallback),B.mRightBtnPanelScript.setToDailyPageCallback(B.mHomePageDailyAtdcClickCallback),B.mLeftIconPanel.addChild(Z),B.invokeSlidePanelLoadFinish())})},U.prototype.initCrossComponent=function(B){y.default.isQQ()&&f.default.load("prefab/gamebox/MainRcmdGame",function(Q,Z){Z?B.addChild(Z):S.default.e("[--RCM--] \u4EA4\u53C9\u8425\u9500\u6302\u4EF6\uFF1A \u52A0\u8F7D\u5931\u8D25"+Q)})},U.prototype.hideLeftIcon=function(){},U.prototype.invokeSlidePanelLoadFinish=function(){this.mOnSlidePanelLoadFinishCB&&this.mOnSlidePanelLoadFinishCB()},U.prototype.setSlidePanelLoadFinish=function(B){this.mOnSlidePanelLoadFinishCB=B},U.prototype.invokeLoadFinish=function(){this.mOnLoadFinishCB&&this.mOnLoadFinishCB()},U.prototype.refreshUnlockProgress=function(){var B=this;s.MusicLevelDataLoader.getNormalMusicUnlockInfo(function(Q,Z){B.mUnlockProcess.string="Progress: "+Q+"/"+Z})},U.prototype.onSkinChange=function(){this.applySkin();var B=o.default.Ins().getLevelRecordByMid(this.mItemInfo.musicId);if(B?B.mBestStar<=3?this.showStar(B.mBestStar):this.showCrow(B.mBestStar-3):this.showStar(0),a.SUtil.ins().isLiuHai()){var Q=this.mMoveVal;a.SUtil.ins().isEqual19_9()&&(Q*=-1),(W=this.mDiscSprite.node.getComponent(cc.Sprite).spriteFrame.getRect()).width<370?this.mDiscSprite.node.setContentSize(370,370):this.mDiscSprite.node.setContentSize(W.width,W.height);var Z=this.mDiscSprite.node.getContentSize();if(a.SUtil.ins().toTopByPixel(this.mDiscSprite,447.8-Z.height/2+Q),this.mStartBtn.normalSprite){var z=this.mStartBtn.normalSprite.getRect();a.SUtil.ins().toTopByPx(this.mStartBtn,854+(141-z.height)/2+Q)}}else if(a.SUtil.ins().isQuanMian())(W=this.mDiscSprite.node.getComponent(cc.Sprite).spriteFrame.getRect()).width<370?this.mDiscSprite.node.setContentSize(370,370):this.mDiscSprite.node.setContentSize(W.width,W.height),Z=this.mDiscSprite.node.getContentSize(),a.SUtil.ins().toTopByPixel(this.mDiscSprite,342.9-Z.height/2+2*this.mMoveVal),this.mStartBtn.normalSprite&&(z=this.mStartBtn.normalSprite.getRect(),a.SUtil.ins().toTopByPx(this.mStartBtn,782+(141-z.height)/2+this.mMoveVal));else if(a.SUtil.ins().isPuTong()){var W;(W=this.mDiscSprite.node.getComponent(cc.Sprite).spriteFrame.getRect().clone()).width<525&&(W.width*=.946,W.height*=.946),W.width<350?this.mDiscSprite.node.setContentSize(350,350):this.mDiscSprite.node.setContentSize(W.width,W.height),Z=this.mDiscSprite.node.getContentSize(),a.SUtil.ins().toTopByPixel(this.mDiscSprite,315.9-Z.height/2+this.mMoveVal),this.mStartBtn.normalSprite&&(z=this.mStartBtn.normalSprite.getRect(),a.SUtil.ins().toTopByPx(this.mStartBtn,641+(141-z.height)/2+this.mMoveVal))}},U.prototype.initHotSongRedSpot=function(){var B=this;T.default.Ins().hasTaskUnTaken(function(Q,Z){var z;Q?(B.mHotMusicCountLabel.string="\u788E\u7247\u53EF\u9886\u53D6",(z=B.mHotMusicCountLabel.getComponent(cc.Animation))&&z.play("homepage_skin_bling")):((z=B.mHotMusicCountLabel.getComponent(cc.Animation))&&z.stop(),B.mHotMusicCountLabel.node.opacity=255,B.mHotMusicCountLabel.string=k.default.getInstance().getLanguageByKey("label_text.bingxue_tangguo"))})},U.prototype.updateAvatorRedSpot=function(){},U.prototype.applySkin=function(){var B=d.G.Ap.skinMgr.getCurrentSkinItem();B&&B.getSkinElementPainter().captureElement("GameEntranceScene","ExtraMiddleMainPagePrefb",this.node)},U.prototype.handleMutiTouch=function(B){var Q=this;B.on(cc.Node.EventType.TOUCH_START,function(){Q.mEventStopNode.active=!0},this),B.on(cc.Node.EventType.TOUCH_CANCEL,function(){Q.mEventStopNode.active=!1},this)},U.prototype.initEvent=function(){var B=this;this.mEventStopNode.on(cc.Node.EventType.TOUCH_END,function(){},this),this.mStartBtnClickCallback=new t.default(function(){v.default.save(C.default.OPEN_GAMEOVER_FROM,"0"),i.default.report(B.mItemInfo.musicId,i.default.ACTION_CLICK_HOME_START),B.onStartBtnClickCallback(),B.mEventStopNode.active=!1},function(){B.mEventStopNode.active=!1}),this.mStartBtn.node.on(cc.Node.EventType.TOUCH_END,this.mStartBtnClickCallback.click,this.mStartBtnClickCallback),this.handleMutiTouch(this.mStartBtn.node),this.mAvatorClickCallback=new t.default(function(){B.avatorTouchCallback(),i.default.report(0,i.default.ACTION_CLICK_HOME_AVATOR),B.mEventStopNode.active=!1,v.default.save(C.default.HAS_CLICK_HOME_AVATOR,"true"),B.updateAvatorRedSpot()},function(){B.mEventStopNode.active=!1}),this.mChallengeClickCallback=new t.default(function(){i.default.report(0,i.default.ACTION_CLICK_CHALLENGE_COMPETITION),B.mToChallengePageCallback&&B.mToChallengePageCallback(),B.mEventStopNode.active=!1},function(){B.mEventStopNode.active=!1}),this.mSkinClickCallback=new t.default(function(){p.default.get(B.mHotMusicLibIcon,function(Q,Z){cc.isValid(B,!0)&&(B.mHotMusicBtn.getComponent(cc.Sprite).spriteFrame=Z)}),B.showSkinStorePage(),i.default.report(0,i.default.ACTION_CLICK_SKIN_STORE),B.mEventStopNode.active=!1},function(){B.mEventStopNode.active=!1}),this.mHotMusicBtn.node.on(cc.Node.EventType.TOUCH_END,this.mSkinClickCallback.click,this.mSkinClickCallback),this.handleMutiTouch(this.mHotMusicBtn.node),this.mMusicLibClickCallback=new t.default(function(){p.default.get(B.mHomeMusicLibIcon,function(Q,Z){cc.isValid(B,!0)&&(B.mMusicLibBtn.getComponent(cc.Sprite).spriteFrame=Z)}),B.mToMusicLibCallback&&B.mToMusicLibCallback(),B.mEventStopNode.active=!1},function(){B.mEventStopNode.active=!1}),this.mMusicLibBtn.node.on(cc.Node.EventType.TOUCH_END,this.mMusicLibClickCallback.click,this.mMusicLibClickCallback),this.handleMutiTouch(this.mMusicLibBtn.node),this.mHideRightPanelNode=this.node.getChildByName("HideRightBtnPanel"),this.mHideRightPanelNode.on(cc.Node.EventType.TOUCH_START,function(Q){B.mRightBtnPanelScript&&B.mRightBtnPanelScript.hideRightPanelByClickAnyWhere()},this),this.mHideRightPanelNode._touchListener&&this.mHideRightPanelNode._touchListener.setSwallowTouches(!1),this.registerEvent()},U.prototype.registerEvent=function(){u.default.register(c.default.HIDE_GUIDE_FINGER,this.hideNewTargetGuideFinger,this),u.default.register(c.default.UPDATE_SKIN_PIECES_TIPS,this.initHotSongRedSpot,this),u.default.register(c.default.UPDATE_WX_VERSION_TOAST,this.showToastTips,this)},U.prototype.removeRegisterEvent=function(){u.default.remove(c.default.UPDATE_SKIN_PIECES_TIPS,this.initHotSongRedSpot,this),u.default.remove(c.default.HIDE_GUIDE_FINGER,this.hideNewTargetGuideFinger,this),u.default.remove(c.default.UPDATE_WX_VERSION_TOAST,this.showToastTips,this)},U.prototype.showToastTips=function(){var B=this;f.default.load("prefab/ToastPrefab",function(Q,Z){if(Z){var z=Z.getComponent(_.default);z.showTips("\u5FAE\u4FE1\u7248\u672C\u8FC7\u4F4E\uFF0C\u8BF7\u5347\u81F3\u6700\u65B0\u7248\u5FAE\u4FE1!",function(){Z.destroy()}),z.setLong(!1),B.node.addChild(Z)}})},U.prototype.setToLottaryPageCallback=function(B){this.mToLottaryPageCallback=B},U.prototype.setToChosenMusicPageCallback=function(B){this.mToChosenMusicPageCallback=B},U.prototype.showSkinStorePage=function(){this.mShowSkinStoreCallback&&this.mShowSkinStoreCallback()},U.prototype.setShowSkinStoreCallback=function(B){this.mShowSkinStoreCallback=B},U.prototype.setShowSkinPieceCallback=function(B){this.mShowSkinPieceCallback=B},U.prototype.avatorTouchCallback=function(){this.mHomePageAvatorClickCallback&&this.mHomePageAvatorClickCallback()},U.prototype.setHomeAvatorClickCallback=function(B){this.mHomePageAvatorClickCallback=B},U.prototype.setHomeShareGiftClickCallback=function(B){this.mHomePageShareGiftClickCallback=B},U.prototype.dailyAttendanceTouchCallback=function(){this.mHomePageDailyAtdcClickCallback&&this.mHomePageDailyAtdcClickCallback()},U.prototype.setHomeDailyAtdcClickCallback=function(B){this.mHomePageDailyAtdcClickCallback=B},U.prototype.setToHotMusicTabCallback=function(B){this.mToHotMusicTabCallback=B},U.prototype.hotSongBtnClick=function(){this.mToHotMusicTabCallback&&this.mToHotMusicTabCallback()},U.prototype.setToChallengePageCallback=function(B){this.mToChallengePageCallback=B},U.prototype.setToMusicLibCallback=function(B){this.mToMusicLibCallback=B},U.prototype.setOnLoadFinishCB=function(B){this.mOnLoadFinishCB=B},U.prototype.start=function(){y.default.isCM()&&(M.default.hasReportTimecost||(M.default.hasReportTimecost=!0))},U.prototype.initRecommendGame=function(){},U.prototype.hideNewTargetGuideFinger=function(){var B=this.node.getChildByTag(h.default.FINGER_NODE_TARGET_ICON_TAG);B&&(this.node.removeChildByTag(h.default.FINGER_NODE_TARGET_ICON_TAG),B.destroy())},U.prototype.checkTargetIcon=function(){this.mRightBtnPanelScript&&this.mRightBtnPanelScript.setIcons()},U.prototype.onStartBtnClickCallback=function(){var B=this,Q=D.ADScene.PLAY_GAME;L.MGAdv.commercialBreak(Q,D.QQ_ADV_TYPE.VIDEO_TYPE_PLAY_AGAIN,function(Z){B.mUseEnergyCallback&&B.mUseEnergyCallback(!0)})},U.prototype.startGame=function(B){B===void 0&&(B=!0),d.G.Ap.state.reset(),B&&e.default.Ins().getPlugin(n.default.Plugin_Energy).decreaseEnergy(1),d.G.Ap.state.mission=new r.Mission(this.mItemInfo.id,this.mItemInfo.musicId,!1),u.default.fire(c.default.LOAD_MUSIC,3)},U.prototype.showStar=function(B){this.star_layout.node.active=!0,this.crow_layout.node.active=!1,this.loadStarIcon(this.star1,0<B),this.loadStarIcon(this.star2,1<B),this.loadStarIcon(this.star3,2<B)},U.prototype.showCrow=function(B){this.star_layout.node.active=!1,this.crow_layout.node.active=!0,this.loadCrownIcon(this.crow1,0<B),this.loadCrownIcon(this.crow2,1<B),this.loadCrownIcon(this.crow3,2<B)},U.prototype.loadStarIcon=function(B,Q){var Z=this.mElementFrames.getChildByName("starFrames");if(Z){var z=Z.getComponent(cc.Button);B.spriteFrame=Q?z.hoverSprite:z.normalSprite}},U.prototype.loadCrownIcon=function(B,Q){var Z=this.mElementFrames.getChildByName("crownFrames");if(Z){var z=Z.getComponent(cc.Button);B.spriteFrame=Q?z.hoverSprite:z.normalSprite}},U.prototype.onDestroy=function(){console.log("[HomePage] onDestory"),this.mEventStopNode&&(this.mEventStopNode.active=!1),I.default.destroy(),this.removeRegisterEvent()},U.prototype.getStartBtnPosition=function(){var B=this.mStartBtn.node.parent.convertToWorldSpaceAR(this.mStartBtn.node.getPosition());return this.node.convertToNodeSpaceAR(B)},U.prototype.setUseEnergyCallback=function(B){this.mUseEnergyCallback=B},U.prototype.setVipPosition=function(){y.default.isIOS(),this.mLeftIconPanel.height=481,a.SUtil.ins().isLiuHai()?a.SUtil.ins().toTopByPx(this.mLeftIconPanel,263):a.SUtil.ins().isQuanMian()?a.SUtil.ins().toTopByPx(this.mLeftIconPanel,192):a.SUtil.ins().isPuTong()&&a.SUtil.ins().toTopByPx(this.mLeftIconPanel,146)},U.prototype.adaptorUI=function(){if(this.setVipPosition(),a.SUtil.ins().isLiuHai()){var B=this.mMoveVal;a.SUtil.ins().isEqual19_9()&&(B*=-1),a.SUtil.ins().toTopByPx(this.mDiscSprite,286+B),a.SUtil.ins().toTopByPx(this.star_layout,671+B),a.SUtil.ins().toTopByPx(this.crow_layout,677+B),a.SUtil.ins().toTopByPx(this.mMusicNameLabel,777+B),a.SUtil.ins().toTopByPx(this.mStartBtn,854+B),a.SUtil.ins().toBottomByPx(this.mMusicLibBtn,120),a.SUtil.ins().toBottomByPx(this.mHotMusicBtn,120),a.SUtil.ins().toBottomByPx(this.mRecommendNode,538),a.SUtil.ins().toTopByPx(this.mRightIconPanel,229)}else a.SUtil.ins().isQuanMian()?(a.SUtil.ins().toTopByPx(this.mDiscSprite,216+this.mMoveVal),a.SUtil.ins().toTopByPx(this.star_layout,604+this.mMoveVal),a.SUtil.ins().toTopByPx(this.crow_layout,610+this.mMoveVal),a.SUtil.ins().toTopByPx(this.mMusicNameLabel,716+this.mMoveVal),a.SUtil.ins().toTopByPx(this.mStartBtn,782+this.mMoveVal),a.SUtil.ins().toBottomByPx(this.mMusicLibBtn,90),a.SUtil.ins().toBottomByPx(this.mHotMusicBtn,90),a.SUtil.ins().toBottomByPx(this.mRecommendNode,499),a.SUtil.ins().toTopByPx(this.mRightIconPanel,159)):a.SUtil.ins().isShortScreen()?(a.SUtil.ins().toTopByPx(this.mDiscSprite,162),a.SUtil.ins().toTopByPx(this.star_layout,535),a.SUtil.ins().toTopByPx(this.crow_layout,535),a.SUtil.ins().toTopByPx(this.mMusicNameLabel,611),a.SUtil.ins().toTopByPx(this.mStartBtn,674),a.SUtil.ins().toTopByPx(this.mRightIconPanel,129),a.SUtil.ins().toBottomByPx(this.mHotMusicBtn,-5),a.SUtil.ins().toBottomByPx(this.mMusicLibBtn,-5)):a.SUtil.ins().isPuTong()&&a.SUtil.ins().toTopByPx(this.mRightIconPanel,129)},U.prototype.adapterAvator=function(){},U.prototype.setMailTips=function(B){},U.prototype.checkVip=function(){},U.prototype.onEnable=function(){this.mGameClubVisibility=!0},U.prototype.onDisable=function(){this.mGameClubVisibility=!1},__decorate([R(cc.Label)],U.prototype,"mMusicNameLabel",void 0),__decorate([R(cc.Button)],U.prototype,"mStartBtn",void 0),__decorate([R(cc.Sprite)],U.prototype,"mLevelSprite_1",void 0),__decorate([R(cc.Sprite)],U.prototype,"mLevelSprite_2",void 0),__decorate([R(cc.Sprite)],U.prototype,"mLevelSprite_3",void 0),__decorate([R(cc.Layout)],U.prototype,"star_layout",void 0),__decorate([R(cc.Sprite)],U.prototype,"star1",void 0),__decorate([R(cc.Sprite)],U.prototype,"star2",void 0),__decorate([R(cc.Sprite)],U.prototype,"star3",void 0),__decorate([R(cc.Layout)],U.prototype,"crow_layout",void 0),__decorate([R(cc.Sprite)],U.prototype,"crow1",void 0),__decorate([R(cc.Sprite)],U.prototype,"crow2",void 0),__decorate([R(cc.Sprite)],U.prototype,"crow3",void 0),__decorate([R(cc.Sprite)],U.prototype,"mDiscSprite",void 0),__decorate([R(cc.Node)],U.prototype,"mElementFrames",void 0),__decorate([R(cc.Button)],U.prototype,"mHotMusicBtn",void 0),__decorate([R(cc.Label)],U.prototype,"mHotMusicCountLabel",void 0),__decorate([R(cc.Button)],U.prototype,"mMusicLibBtn",void 0),__decorate([R(cc.Label)],U.prototype,"mCrownCountLabel",void 0),__decorate([R(cc.Label)],U.prototype,"mUnlockProcess",void 0),__decorate([R(cc.Label)],U.prototype,"mNewMusicCountLabel",void 0),__decorate([R(cc.Node)],U.prototype,"mLeftIconPanel",void 0),__decorate([R(cc.Node)],U.prototype,"mRightIconPanel",void 0),__decorate([R(cc.Node)],U.prototype,"mHideRightPanelNode",void 0),__decorate([R(cc.Node)],U.prototype,"mRecommendNode",void 0),__decorate([R(cc.Node)],U.prototype,"mEventStopNode",void 0),__decorate([R(cc.Label)],U.prototype,"mNewSongNameLabel",void 0),U=__decorate([H],U)}(cc.Component);m.default=F,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../base/G":"G","../../../base/Log":"Log","../../../base/Startup":"Startup","../../../base/State":"State","../../../config/LSKey":"LSKey","../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../util/PU":"PU","../../../util/SUtil":"SUtil","../../../util/StringUtil":"StringUtil","../../Logic/EventBus":"EventBus","../../Logic/I18nManager":"I18nManager","../../Logic/NotifyEvent":"NotifyEvent","../../Logic/PlayerMgr":"PlayerMgr","../../Logic/Plugin/IPlugin":"IPlugin","../../Logic/Plugin/PluginMgr":"PluginMgr","../../Network/Protocol/StorageUtil":"StorageUtil","../../keypad/KeypadUtil":"KeypadUtil","../../skin/frag/SkinTaskMgr":"SkinTaskMgr","../../task/newguidance/NewGuidanceLoader":"NewGuidanceLoader","../GameClub":"GameClub","../MusicLevelDataLoader":"MusicLevelDataLoader","./BasicTouchEvent":"BasicTouchEvent","./ImgCache":"ImgCache","./MainpageRightBtnPanel":"MainpageRightBtnPanel","./PrefabMgr":"PrefabMgr","./ToastPrefab":"ToastPrefab"}],HotMusicCMShareController:[function(l,P,m){"use strict";cc._RF.push(P,"439c03+VopCXL2deTOclCsG","HotMusicCMShareController"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../MusicLevelDataLoader"),s=l("../../../Network/Protocol/StorageUtil"),r=l("../../../../base/Log"),o=l("../../../Logic/SkinDataManager"),e=function(){function n(){this.songKey="inviteForSongs",this.skinKey="inviteForSkins",this.songArray=[],this.skinArray=[],this.songArray=this.getItemArray(),this.skinArray=this.getSkinItemArray()}return n.Ins=function(){return this.ins==null&&(this.ins=new n),this.ins},n.prototype.saveItemInfo=function(t){var i={};i.id=t.id,i.musicId=t.musicId,this.songArray.findIndex(function(a){return a.id===t.id})==-1&&(this.songArray.push(i),s.default.save(this.songKey,JSON.stringify(this.songArray)))},n.prototype.saveSkinItemInfo=function(t){var i={};i.name=t.name,i.displayName=t.displayName,this.skinArray.findIndex(function(a){return a.name===t.name})==-1&&(this.skinArray.push(i),s.default.save(this.skinKey,JSON.stringify(this.skinArray)))},n.prototype.getItemArray=function(){var t,i=s.default.read(this.songKey,""),a=[];if(i)try{t=JSON.parse(i)}catch(u){return null}return t&&Array.isArray(t)&&0<t.length&&t.forEach(function(u){var c=new d.ItemInfo;c.id=u.id,c.musicId=u.musicId,a.push(c)}),a},n.prototype.getSkinItemArray=function(){var t,i=s.default.read(this.skinKey,""),a=[];if(i)try{t=JSON.parse(i)}catch(u){return null}return t&&Array.isArray(t)&&0<t.length&&t.forEach(function(u){var c=new o.SkinItemInfo;c.name=u.name,c.displayName=u.displayName,a.push(c)}),a},n.prototype.removeItemInfo=function(t){var i=this.songArray.findIndex(function(a){return a.id===t.id});return r.default.i("HotMusicCMShareController",this.songArray,t),i!=-1&&(this.songArray.splice(i,1),s.default.save(this.songKey,JSON.stringify(this.songArray)),!0)},n.prototype.removeSkinItemInfo=function(t){var i=this.skinArray.findIndex(function(a){return a.name===t.name});return r.default.i("HotMusicCMShareController",this.skinArray,t),i!=-1&&(this.skinArray.splice(i,1),s.default.save(this.skinKey,JSON.stringify(this.skinArray)),!0)},n}();m.default=e,cc._RF.pop()},{"../../../../base/Log":"Log","../../../Logic/SkinDataManager":"SkinDataManager","../../../Network/Protocol/StorageUtil":"StorageUtil","../../MusicLevelDataLoader":"MusicLevelDataLoader"}],HotMusicCardItemPrefb:[function(l,P,m){"use strict";cc._RF.push(P,"3b8a2gfgvlHKb8RUzh4JJGl","HotMusicCardItemPrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../BasicTouchEvent"),s=l("../../../../base/G"),r=l("../../../../base/State"),o=l("../../../Logic/EventBus"),e=l("../../../Logic/NotifyEvent"),n=l("../../MusicLevelDataLoader"),t=l("../ImgCache"),i=l("./InviteUnlockMusicCountdownUtil"),a=l("../../../reward/ActivityBean"),u=l("../../../Logic/MoneySystem"),c=l("../../../Logic/Level"),p=l("../../../../infoc/minigame_piano2_hotmusic"),h=l("../../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),f=l("../../../../../modules/MGAppShare/scripts/MGShareUtil"),g=l("../../../../config/LSKey"),_=l("../../../Network/Protocol/StorageUtil"),y=l("../../../../util/PU"),S=l("../../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),I=l("../../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),v=l("../../../common/BusinessUtil"),C=l("../../../Logic/Plugin/UnlockProcessor"),T=l("./HotMusicCMShareController"),E=l("../../../Logic/I18nManager"),A=l("../../../../util/StringUtil"),M=cc._decorator,k=M.ccclass,D=M.property,L=function(b){function N(){var R=b!==null&&b.apply(this,arguments)||this;return R.itemID=0,R.mNeedShowCountdown=!1,R}var H;return __extends(N,b),(H=N).prototype.onLoad=function(){E.default.getInstance().isEnglish()?this.mMusician!=null&&(this.mMusician.node.active=!1):(this.mNormalMusicName!=null&&(this.mNormalMusicName.node.getComponent(cc.Widget).top=30),this.mMusician!=null&&(this.mMusician.node.active=!0)),o.default.register(e.default.UPDATE_MUSIC_LIST_CURRENT_TIME,this.udpateCurrentTime,this),this.registerEvent()},N.prototype.setCtrl=function(R){this.mCtrl=R},N.prototype.udpateCurrentTime=function(R,F){this.mCurrentTime=F[0]},N.prototype.registerEvent=function(){var R=this,F=function(){R.mCtrl.setTouched(!1)};this.mSpecRankBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mSpecUnlockRankBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.rankBtnClickCallback())}),y.default.isCM()?(y.default.supportCMOnshare()?this.mSpecLockInviteBtn.node.active=!0:this.mSpecUnlockByVideoBtn.node.active=!0,this.mSpecUnlockByVideoBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mSpecUnlockByVideoBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.doUnlockByVideo(),p.default.report(p.default.ACTION_CLICK_UNLOCK_BY_VIDEO,0,R.mItemInfo.musicId,R.mItemInfo.index+"."+R.mItemInfo.musicName,R.getMusicTpye()))}),this.mSpecUnlockByVideoBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mSpecUnlockByVideoBtn.node.uuid)},this),this.setTouchCb(this.mSpecUnlockByVideoBtn,this.mSpecUnlockByVideoBtnCallback),this.mSpecUnlockByVideoBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this)):(this.mNormalRankBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mNormalRankIcon.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.rankBtnClickCallback())}),this.setTouchCb(this.mNormalRankIcon,this.mNormalRankBtnCallback),this.setTouchCb(this.mSpecUnlockRankBtn,this.mSpecRankBtnCallback),this.mNormalRankIcon.node.on(cc.Node.EventType.TOUCH_START,function(){},this),this.mNormalRankIcon.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){R.mCtrl.setTouched(!0,R.mNormalRankIcon.node.uuid)},this),this.mSpecUnlockRankBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mSpecUnlockRankBtn.node.uuid)},this),this.mSpecUnlockRankBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mSpecUnlockBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mSpecUnlockBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.unlockBtnClickCallback())}),y.default.supportCMOnshare()?this.mSpecLockInviteBtn.node.active=!1:this.mSpecUnlockByVideoBtn.node.active=!1),this.setTouchCb(this.mSpeclockDiamondBuyBtn,this.mSpecUnlockBtnCallback),this.mSpecUnlockBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mSpecUnlockBtn.node.uuid)},this),this.setTouchCb(this.mSpecUnlockBtn,this.mSpecUnlockBtnCallback),this.mSpecUnlockBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mNormalTryBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mNormalTryBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.tryBtnClickCallback())}),this.setTouchCb(this.mNormalTryBtn,this.mNormalTryBtnCallback),this.mSpecTryBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mSpecLockTryBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.tryBtnClickCallback())}),this.setTouchCb(this.mSpecLockTryBtn,this.mSpecTryBtnCallback),this.mNormalTryBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mNormalTryBtn.node.uuid)},this),this.mNormalTryBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mSpecUnLockTryBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mSpecUnlockTryBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.tryBtnClickCallback())}),this.mSpecUnlockTryBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mSpecUnlockTryBtn.node.uuid)},this),this.setTouchCb(this.mSpecUnlockTryBtn,this.mSpecUnLockTryBtnCallback),this.mSpecUnlockTryBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mSpecLockTryBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mSpecLockTryBtn.node.uuid)},this),this.mSpecLockTryBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mNormalStartBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mNormalStartBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.startMusicCallback())}),this.setTouchCb(this.mNormalStartBtn,this.mNormalStartBtnCallback),this.mSpecStartBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mSpecUnlockStartBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.startMusicCallback())}),this.setTouchCb(this.mSpecUnlockStartBtn,this.mSpecStartBtnCallback),this.mNormalStartBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mNormalStartBtn.node.uuid)},this),this.mNormalStartBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mSpecUnlockStartBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mSpecUnlockStartBtn.node.uuid)},this),this.mSpecUnlockStartBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mSpecInviteCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mSpecLockInviteBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),y.default.supportCMOnshare()?R.inviteCMFriendBtnClickCallback():R.inviteFriendBtnClickCallback())}),this.setTouchCb(this.mSpecLockInviteBtn,this.mSpecInviteCallback),this.mSpecLockInviteBtn.node.on(cc.Node.EventType.TOUCH_START,function(){R.mCtrl.setTouched(!0,R.mSpecLockInviteBtn.node.uuid)},this),this.mSpecLockInviteBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this),this.mSpecLockInviteBtn.node.on(cc.Node.EventType.TOUCH_END,F,this),this.mUnlockBtnCallback=new d.default(function(){R.mCtrl.getTouched()&&R.mCtrl.getTouchUuid()!=R.mNormalUnlockBtn.node.uuid?R.mCtrl.setTouched(!1):(R.mCtrl.setTouched(!1),R.unlockBtnClickCallback())}),this.setTouchCb(this.mNormalUnlockBtn,this.mUnlockBtnCallback),this.mNormalUnlockBtn.node.on(cc.Node.EventType.TOUCH_START,function(x){R.mCtrl.setTouched(!0,R.mNormalUnlockBtn.node.uuid)},this),this.mNormalUnlockBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,F,this)},N.prototype.doUnlockByVideo=function(){var R=this;if(y.default.isWeb())C.default.unlockByVideo(this.mItemInfo.id,this.mItemInfo.musicId);else{var F=I.ADScene.SOURCE_HOTMUSIC_UNLOCK;S.MGAdv.show(F,I.QQ_ADV_TYPE.VIDEO_TYPE_HOTMUSIC_UNLOCK,function(x){switch(x){case I.ADStat.NOT_NETWORK:v.default.getIns().showToastTips("No network available",R.node,null,!0);break;case I.ADStat.SHOW_SUCCESS_CLOSE:C.default.unlockByVideo(R.mItemInfo.id,R.mItemInfo.musicId);break;case I.ADStat.SHOW_NOT_ENED_CLOSE:break;case I.ADStat.SHOW_GET_AD_FAILED:v.default.getIns().showToastTips("No video ads available",R.node,null,!0)}})}},N.prototype.setTouchCb=function(R,F){if(R&&F){var x=R instanceof cc.Component?R.node:R;x&&x.on(cc.Node.EventType.TOUCH_END,F.click,F)}},N.prototype.startMusicCallback=function(){if(p.default.report(p.default.ACTION_CLICK_START,0,this.mItemInfo.musicId,this.mItemInfo.index+"."+this.mItemInfo.musicName,this.getMusicTpye()),this.mItemInfo.mGameComsume.spendType==n.GameConsume.SPENDTYPE_ENERGY){if(u.MoneySystem.getHpCount()<this.mItemInfo.mGameComsume.spendEnergy)return o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u4F53\u529B","\u5F00\u59CB"),void o.default.fire(e.default.HIDE_HOMEPAGE_EVENT_TOP_MASK)}else if(this.mItemInfo.mGameComsume.spendType==n.GameConsume.SPENDTYPE_DIAMOND){if(u.MoneySystem.getDiamondCount()<this.mItemInfo.mGameComsume.spendDiamond)return o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u94BB\u77F3","\u5F00\u59CB"),void o.default.fire(e.default.HIDE_HOMEPAGE_EVENT_TOP_MASK)}else if(this.mItemInfo.mGameComsume.spendType==n.GameConsume.SPENDTYPE_GOLD&&u.MoneySystem.getGoldCount()<this.mItemInfo.mGameComsume.spendGold)return o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u91D1\u5E01","\u5F00\u59CB"),void o.default.fire(e.default.HIDE_HOMEPAGE_EVENT_TOP_MASK);var R=cc.director.getWinSize().height,F=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.mItemInfo.mGameComsume.unlockActive?(F.y=F.y-this.node.height+this.mSpecUnlockStartBtn.node.height/2+22-(R-1280)/2,F.x=F.x+this.node.width/2-this.mSpecUnlockStartBtn.node.width/2):(F.y=F.y-this.node.height+this.mNormalStartBtn.node.height/2+22-(R-1280)/2,F.x=F.x+this.node.width/2-this.mNormalStartBtn.node.width/2),this.startMusic()},N.prototype.startMusic=function(){_.default.save(g.default.OPEN_GAMEOVER_FROM,"2"),s.G.Ap.state.reset(),s.G.Ap.state.mission=new r.Mission(this.mItemInfo.id,this.mItemInfo.musicId,!1),o.default.fire(e.default.LOAD_MUSIC,1,this.mItemInfo.mGameComsume)},N.prototype.rankBtnClickCallback=function(){},N.prototype.tryBtnClickCallback=function(){if(this.mTryPlayPositionCallback){if(p.default.report(p.default.ACTION_CLICK_TRY,0,this.mItemInfo.musicId,this.mItemInfo.index+"."+this.mItemInfo.musicName,this.getMusicTpye()),this.mItemInfo.mGameComsume.testType==n.GameConsume.TESTTYPE_ENERGY){if(u.MoneySystem.getHpCount()<this.mItemInfo.mGameComsume.testEnergy)return void o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u4F53\u529B","\u8BD5\u73A9")}else if(this.mItemInfo.mGameComsume.testType==n.GameConsume.TESTTYPE_GOLD){if(u.MoneySystem.getGoldCount()<this.mItemInfo.mGameComsume.testGold)return void o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u91D1\u5E01","\u8BD5\u73A9")}else if(this.mItemInfo.mGameComsume.testType==n.GameConsume.TESTTYPE_DIAMOND&&u.MoneySystem.getDiamondCount()<this.mItemInfo.mGameComsume.testDiamond)return void o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u91D1\u5E01","\u8BD5\u73A9");this.mTryPlayPositionCallback(this.mItemInfo)}},N.prototype.setTryPositionCallback=function(R){this.mTryPlayPositionCallback=R},N.prototype.setRememberPosCallback=function(R){this.mRememberPositionCallback=R},N.prototype.unlockBtnClickCallback=function(){var R,F;this.mRememberPositionCallback&&this.mRememberPositionCallback();var x=Math.ceil(this.mItemInfo.unlockType.unlockValue);if(this.mItemInfo.unlockType.unlockType==c.eUnlockType.UNLOCK_TYPE_GOLD){if(R="\u91D1\u5E01",F=p.default.ACTION_CLICK_GOLD_UNLOCK,p.default.report(F,0,this.mItemInfo.musicId,this.mItemInfo.index+"."+this.mItemInfo.musicName,this.getMusicTpye()),u.MoneySystem.getGoldCount()<x)return void o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u91D1\u5E01","\u89E3\u9501")}else if(this.mItemInfo.unlockType.unlockType==c.eUnlockType.UNLOCK_TYPE_DIAMOND&&(R="\u94BB\u77F3",F=p.default.ACTION_CLICK_DIAMOND_UNLOCK,p.default.report(F,0,this.mItemInfo.musicId,this.mItemInfo.index+"."+this.mItemInfo.musicName,this.getMusicTpye()),u.MoneySystem.getDiamondCount()<x))return p.default.report(p.default.ACTION_SHOW_BUY_DIAMOND_DIALOG,0,this.mItemInfo.musicId,this.mItemInfo.index+"."+this.mItemInfo.musicName,this.getMusicTpye()),void o.default.fire(e.default.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST,"\u94BB\u77F3","\u89E3\u9501");o.default.fire(e.default.SHOW_MUSIC_LIB_UNLOCK_DIALOG,{type:R,unlockValue:x,musicName:this.mItemInfo.musicName,musicId:this.mItemInfo.musicId,musicType:this.getMusicTpye(),levelId:this.mItemInfo.id})},N.prototype.getMusicTpye=function(){return this.mItemInfo.mGameComsume.unlockActive?p.default.TYPE_ACTIVITY:p.default.TYPE_HOT},N.prototype.inviteFriendBtnClickCallback=function(){var R=this;p.default.report(p.default.ACTION_CLICK_SHARE,0,this.mItemInfo.musicId,this.mItemInfo.index+"."+this.mItemInfo.musicName,this.getMusicTpye()),h.MGUser.getUserLoginInfo({complete:function(F){F&&f.MGShareUtils.shareForInviteSong(F.playerId,a.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG+R.mItemInfo.musicId,R.mItemInfo.musicId,R.mItemInfo.musicName,R.mItemInfo.id,function(x){x&&o.default.fire(e.default.SHARE_HOME_SHOW_INVITE_TIPS)}),o.default.fire(e.default.INVITE_SONG_LOOPER_START)}})},N.prototype.inviteCMFriendBtnClickCallback=function(){T.default.Ins().saveItemInfo(this.mItemInfo),f.MGShareUtils.shareForInviteSong("playerId",a.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SONG+"_"+this.mItemInfo.musicId,this.mItemInfo.musicId,this.mItemInfo.musicName,this.mItemInfo.id,function(R){R&&o.default.fire(e.default.SHARE_HOME_SHOW_INVITE_TIPS)})},N.prototype.showExceptMore=function(){this.mNormalPanel.node.active=!1,this.mSpecUnlockPanel.node.active=!1,this.mSpecLockPanle.node.active=!1,this.mExceptMoreLabel.node.x=0},N.prototype.hideException=function(){this.mExceptMoreLabel.node.x=5e3},N.prototype.setData=function(R,F,x){if(this.mCurrentTime=x,!(this.mItemInfo=R))throw this.mNeedShowCountdown=!1,new Error("item info undefine");if(R.id==H.EXCEPT_MORE_ID)return this.mNeedShowCountdown=!1,this.showExceptMore(),void(this.itemID=F);if(this.hideException(),R.mGameComsume.unlockActive&&R.mGameComsume.isActive(i.default.Ins().getCurrentTime())){if(this.mSpeclockSongName.string=R.musicName,y.default.supportCMOnshare()?this.mSpeclockSongDesc.string=E.default.getInstance().getLanguageByKey("label_text.music_invite_rule"):this.mSpeclockSongDesc.string="\u770B1\u6B21\u89C6\u9891\u5373\u53EF\u514D\u8D39\u89E3\u9501",this.mSpecUnlockSongDesc.string=R.musician,this.mSpecUnlockSongName.string=R.musicName,this.mSpecUnlockRankText.string=F+1+"",this.mSpeclockRankText.string=F+1+"",R.mGameComsume.isActive(i.default.Ins().getCurrentTime()))if(R.isLocked)this.mNeedShowCountdown=!0,this.mSpecLockPanle.node.active=!0,this.mNormalPanel.node.active=!1,this.mSpecUnlockPanel.node.active=!1,this.mSpecLockTryBtn.node.active=!1,this.mSpeclockDiamondBuyBtn.node.active=!1,y.default.supportCMOnshare()||(this.mSpecLockInviteBtn.node.active=!1);else{this.mNeedShowCountdown=!1,this.mSpecLockPanle.node.active=!1,this.mNormalPanel.node.active=!1,this.mSpecUnlockPanel.node.active=!0,y.default.isCM()&&(this.mSpecUnlockRankBtn.node.active=!1);var U=void 0,B=void 0;R.mGameComsume.spendType==n.GameConsume.SPENDTYPE_DEFAULT?(U="/musiclist/energy_icon",B=R.mGameComsume.testGold):R.mGameComsume.spendType==n.GameConsume.SPENDTYPE_ENERGY?(U="/musiclist/energy_icon",B=R.mGameComsume.spendEnergy):R.mGameComsume.spendType==n.GameConsume.SPENDTYPE_DIAMOND?(U="/musiclist/diamond_icon",B=R.mGameComsume.spendDiamond):R.mGameComsume.spendType==n.GameConsume.SPENDTYPE_GOLD&&(U="/musiclist/gold_icon",B=R.mGameComsume.spendGold),t.default.get(U,function(Z,z){cc.isValid(this.node)&&(this.mSpecUnlockPlayExpenseIcon.spriteFrame=z)}.bind(this)),this.mSpecUnlockPlayExpenseLabel.string=B+" "+E.default.getInstance().getLanguageByKey("label_text.music_start"),this.setStarOrCrownSpriteFrame(R.bestStar,!0)}}else if(this.mNeedShowCountdown=!1,this.mSpecLockPanle.node.active=!1,this.mNormalPanel.node.active=!0,this.mSpecUnlockPanel.node.active=!1,this.mNormalMusicIndex.string=F+1+"",this.mNormalMusicName.string=R.musicName,this.mMusician.string=R.musician,R.isLocked)this.mNormalStarPanel.active=!1,this.mNormalCrownPanel.active=!1,this.mNormalStartBtn.node.active=!1,this.mNormalRankIcon.node.active=!1,this.mNormalTryBtn.node.active=!0,this.mNormalUnlockBtn.node.active=!0,this.mNormalLockIcon.active=!y.default.isCM(),this.SetBuyBtnText(R,this.mNormalUnlockExpenseIcon,this.mNormalUnlockExpenseLabel),this.SetTryPlayBtn(R,this.mNormalTryExpenseIcon,this.mNormalTryExpenseLabel);else{this.mNormalStarPanel.active=!0,this.mNormalCrownPanel.active=!0,this.mNormalStartBtn.node.active=!0,this.mNormalRankIcon.node.active=!y.default.isCM(),this.mNormalTryBtn.node.active=!1,this.mNormalUnlockBtn.node.active=!1,this.mNormalLockIcon.active=!1,U=void 0;var Q=void 0;R.mGameComsume.spendType==n.GameConsume.SPENDTYPE_ENERGY?(U="/musiclist/energy_icon",Q=R.mGameComsume.spendEnergy):R.mGameComsume.spendType==n.GameConsume.SPENDTYPE_GOLD?(U="/musiclist/gold_icon",Q=R.mGameComsume.spendGold):R.mGameComsume.spendType==n.GameConsume.SPENDTYPE_DIAMOND&&(U="/musiclist/diamond_icon",Q=R.mGameComsume.spendDiamond),t.default.get(U,function(Z,z){cc.isValid(this.node)&&(this.mNormalStartExpenseIcon.spriteFrame=z)}.bind(this)),this.mNormalStartExpenseLabel.string=Q+" "+E.default.getInstance().getLanguageByKey("label_text.music_start"),this.setStarOrCrownSpriteFrame(R.bestStar,!1)}this.itemID=F},N.prototype.SetBuyBtnText=function(R,F,x){var U;R.unlockType.unlockType==c.eUnlockType.UNLOCK_TYPE_GOLD?U="/musiclist/gold_icon":R.unlockType.unlockType==c.eUnlockType.UNLOCK_TYPE_DIAMOND&&(U="/musiclist/diamond_icon"),t.default.get(U,function(B,Q){cc.isValid(this.node)&&(F.spriteFrame=Q)}.bind(this)),x.string=Math.ceil(R.unlockType.unlockValue)+" "+E.default.getInstance().getLanguageByKey("label_text.music_unlock")},N.prototype.SetTryPlayBtn=function(R,F,x){var U,B;R.mGameComsume.testType==n.GameConsume.TESTTYPE_GOLD?(U="/musiclist/gold_icon",B=R.mGameComsume.testGold):R.mGameComsume.testType==n.GameConsume.TESTTYPE_DIAMOND?(U="/musiclist/diamond_icon",B=R.mGameComsume.testDiamond):R.mGameComsume.testType==n.GameConsume.TESTTYPE_ENERGY?(U="/musiclist/energy_icon",B=R.mGameComsume.testEnergy):R.mGameComsume.testType==n.GameConsume.TESTTYPE_DEFAULT&&(U="/musiclist/energy_icon",B=R.mGameComsume.testGold),t.default.get2(U,F),x.string=B+E.default.getInstance().getLanguageByKey("label_text.music_trial")},N.prototype.setStarOrCrownSpriteFrame=function(R,F){var x=this;if(F?3<R?(this.mSpecUnlockStarPanel.active=!1,this.mSpecUnlockCrownPanel.active=!0):(this.mSpecUnlockStarPanel.active=!0,this.mSpecUnlockCrownPanel.active=!1):3<R?(this.mNormalStarPanel.active=!1,this.mNormalCrownPanel.active=!0):(this.mNormalStarPanel.active=!0,this.mNormalCrownPanel.active=!1),F)switch(R){case 0:t.default.get("/musiclist/music_list_star_unget",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockStar1.spriteFrame=B,this.mSpecUnlockStar2.spriteFrame=B,this.mSpecUnlockStar3.spriteFrame=B)}.bind(this));break;case 1:t.default.get("/musiclist/music_list_star_get",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockStar1.spriteFrame=B)}.bind(this)),t.default.get("/musiclist/music_list_star_unget",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockStar2.spriteFrame=B,this.mSpecUnlockStar3.spriteFrame=B)}.bind(this));break;case 2:t.default.get("/musiclist/music_list_star_get",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockStar1.spriteFrame=B,this.mSpecUnlockStar2.spriteFrame=B)}.bind(this)),t.default.get("/musiclist/music_list_star_unget",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockStar3.spriteFrame=B)}.bind(this));break;case 3:t.default.get("/musiclist/music_list_star_get",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockStar1.spriteFrame=B,this.mSpecUnlockStar2.spriteFrame=B,this.mSpecUnlockStar3.spriteFrame=B)}.bind(this));break;case 4:t.default.get("/musiclist/music_list_crown_get",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockCrown1.spriteFrame=B)}.bind(this)),t.default.get("/musiclist/music_list_crown_unget",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockCrown2.spriteFrame=B,this.mSpecUnlockCrown3.spriteFrame=B)}.bind(this));break;case 5:t.default.get("/musiclist/music_list_crown_get",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockCrown1.spriteFrame=B,this.mSpecUnlockCrown2.spriteFrame=B)}.bind(this)),t.default.get("/musiclist/music_list_crown_unget",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockCrown3.spriteFrame=B)}.bind(this));break;case 6:t.default.get("/musiclist/music_list_crown_get",function(U,B){cc.isValid(this.node)&&(this.mSpecUnlockCrown1.spriteFrame=B,this.mSpecUnlockCrown2.spriteFrame=B,this.mSpecUnlockCrown3.spriteFrame=B)}.bind(this))}else switch(R){case 0:t.default.get("/musiclist/music_list_star_unget",function(U,B){cc.isValid(this.node)&&(this.mNormalStarIcon1.spriteFrame=B,this.mNormalStarIcon2.spriteFrame=B,this.mNormalStarIcon3.spriteFrame=B)}.bind(this));break;case 1:t.default.get("/musiclist/music_list_star_get",function(U,B){cc.isValid(this.node)&&(this.mNormalStarIcon1.spriteFrame=B)}.bind(this)),t.default.get("/musiclist/music_list_star_unget",function(U,B){cc.isValid(this.node)&&(this.mNormalStarIcon2.spriteFrame=B,this.mNormalStarIcon3.spriteFrame=B)}.bind(this));break;case 2:t.default.get("/musiclist/music_list_star_get",function(U,B){cc.isValid(this.node)&&(this.mNormalStarIcon1.spriteFrame=B,this.mNormalStarIcon2.spriteFrame=B)}.bind(this)),t.default.get("/musiclist/music_list_star_unget",function(U,B){cc.isValid(this.node)&&(this.mNormalStarIcon3.spriteFrame=B)}.bind(this));break;case 3:t.default.get("/musiclist/music_list_star_get",function(U,B){cc.isValid(this.node)&&(this.mNormalStarIcon1.spriteFrame=B,this.mNormalStarIcon2.spriteFrame=B,this.mNormalStarIcon3.spriteFrame=B)}.bind(this));break;case 4:t.default.get("/musiclist/music_list_crown_get",function(U,B){cc.isValid(this.node)&&(this.mNormalCrownIcon1.spriteFrame=B)}.bind(this)),t.default.get("/musiclist/music_list_crown_unget",function(U,B){cc.isValid(this.node)&&(this.mNormalCrownIcon2.spriteFrame=B,this.mNormalCrownIcon3.spriteFrame=B)}.bind(this));break;case 5:t.default.get("/musiclist/music_list_crown_get",function(U,B){cc.isValid(x.node)&&(x.mNormalCrownIcon1.spriteFrame=B,x.mNormalCrownIcon2.spriteFrame=B)}),t.default.get("/musiclist/music_list_crown_unget",function(U,B){cc.isValid(x.node)&&(x.mNormalCrownIcon3.spriteFrame=B)});break;case 6:t.default.get("/musiclist/music_list_crown_get",function(U,B){cc.isValid(this.node)&&(this.mNormalCrownIcon1.spriteFrame=B,this.mNormalCrownIcon2.spriteFrame=B,this.mNormalCrownIcon3.spriteFrame=B)}.bind(this))}},N.prototype.onDestroy=function(){o.default.remove(e.default.UPDATE_MUSIC_LIST_CURRENT_TIME,this.udpateCurrentTime,this)},N.prototype.update=function(R){this.mCurrentTime=this.mCurrentTime+1e3*R,this.mNeedShowCountdown&&this.initCountDownTime(this.mCurrentTime,this.mItemInfo.mGameComsume.activeEndTime)},N.prototype.initCountDownTime=function(R,F){if(this.time=F-R,this.time<=0)return this.mNeedShowCountdown=!1,void o.default.fire(e.default.NOTIFY_MUSIC_LIBRARY_UPDATE,this.mItemInfo.musicId);this.day=parseInt(this.time/864e5+""),this.hour=parseInt(this.time%864e5/36e5+""),this.minute=parseInt(this.time%36e5/6e4+""),this.second=parseInt(this.time%6e4/1e3+""),this.second--,this.second<0&&(this.second=59,this.minute--,this.minute<0&&(this.minute=59,this.hour--,this.hour<0&&(this.hour=23,this.day--))),this.day==0&&this.hour==0&&this.minute==0&&this.second==0&&this.mCtrl.updateItemHeight(),this.day<10?this.dayStr="0"+this.day:this.dayStr=this.day,this.hour<10?this.hourStr="0"+this.hour:this.hourStr=this.hour,this.minute<10?this.minStr="0"+this.minute:this.minStr=this.minute,this.second<10?this.secStr="0"+this.second:this.secStr=this.second;var x=A.StringUtil.format(E.default.getInstance().getLanguageByKey("label_text.music_unlock_msg4"),this.dayStr,this.hourStr,this.minStr,this.secStr);this.mSpecLockCountdownLabel.string=x},N.EXCEPT_MORE_ID=-999999,__decorate([D(cc.Sprite)],N.prototype,"mNormalPanel",void 0),__decorate([D(cc.Node)],N.prototype,"mNormalLockIcon",void 0),__decorate([D(cc.Button)],N.prototype,"mNormalStartBtn",void 0),__decorate([D(cc.Label)],N.prototype,"mNormalStartExpenseLabel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalStartExpenseIcon",void 0),__decorate([D(cc.Node)],N.prototype,"mNormalStarPanel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalStarIcon1",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalStarIcon2",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalStarIcon3",void 0),__decorate([D(cc.Node)],N.prototype,"mNormalCrownPanel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalCrownIcon1",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalCrownIcon2",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalCrownIcon3",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalRankIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mNormalMusicIndex",void 0),__decorate([D(cc.Label)],N.prototype,"mNormalMusicName",void 0),__decorate([D(cc.Label)],N.prototype,"mMusician",void 0),__decorate([D(cc.Button)],N.prototype,"mNormalTryBtn",void 0),__decorate([D(cc.Button)],N.prototype,"mNormalUnlockBtn",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalTryExpenseIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mNormalTryExpenseLabel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalUnlockExpenseIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mNormalUnlockExpenseLabel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mNormalNewMusicIcon",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockPanel",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecUnlockSongName",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecUnlockSongDesc",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecUnlockRankText",void 0),__decorate([D(cc.Node)],N.prototype,"mSpecUnlockStarPanel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockStar1",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockStar2",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockStar3",void 0),__decorate([D(cc.Node)],N.prototype,"mSpecUnlockCrownPanel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockCrown1",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockCrown2",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockCrown3",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockRankBtn",void 0),__decorate([D(cc.Button)],N.prototype,"mSpecUnlockStartBtn",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockPlayExpenseIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecUnlockPlayExpenseLabel",void 0),__decorate([D(cc.Button)],N.prototype,"mSpecUnlockTryBtn",void 0),__decorate([D(cc.Button)],N.prototype,"mSpecUnlockBtn",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecTryExpenseIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecTryExpenseLabel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecUnlockExpenseIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecUnlockExpenseLabel",void 0),__decorate([D(cc.Button)],N.prototype,"mSpecUnlockByVideoBtn",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecLockPanle",void 0),__decorate([D(cc.Label)],N.prototype,"mSpeclockSongName",void 0),__decorate([D(cc.Label)],N.prototype,"mSpeclockSongDesc",void 0),__decorate([D(cc.Label)],N.prototype,"mSpeclockRankText",void 0),__decorate([D(cc.Button)],N.prototype,"mSpecLockTryBtn",void 0),__decorate([D(cc.Button)],N.prototype,"mSpecLockInviteBtn",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecLockCountdownLabel",void 0),__decorate([D(cc.Label)],N.prototype,"mSpecLockTryExpenseLabel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpecLockTryExpenseIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mExceptMoreLabel",void 0),__decorate([D(cc.Sprite)],N.prototype,"mSpeclockDiamondBuyBtnIcon",void 0),__decorate([D(cc.Label)],N.prototype,"mSpeclockDiamondBuyBtnLabel",void 0),__decorate([D(cc.Button)],N.prototype,"mSpeclockDiamondBuyBtn",void 0),__decorate([D(cc.Sprite)],N.prototype,"specChallengeMusicIcon",void 0),N=H=__decorate([k],N)}(cc.Component);m.default=L,cc._RF.pop()},{"../../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../../base/G":"G","../../../../base/State":"State","../../../../config/LSKey":"LSKey","../../../../infoc/minigame_piano2_hotmusic":"minigame_piano2_hotmusic","../../../../util/PU":"PU","../../../../util/StringUtil":"StringUtil","../../../Logic/EventBus":"EventBus","../../../Logic/I18nManager":"I18nManager","../../../Logic/Level":"Level","../../../Logic/MoneySystem":"MoneySystem","../../../Logic/NotifyEvent":"NotifyEvent","../../../Logic/Plugin/UnlockProcessor":"UnlockProcessor","../../../Network/Protocol/StorageUtil":"StorageUtil","../../../common/BusinessUtil":"BusinessUtil","../../../reward/ActivityBean":"ActivityBean","../../MusicLevelDataLoader":"MusicLevelDataLoader","../BasicTouchEvent":"BasicTouchEvent","../ImgCache":"ImgCache","./HotMusicCMShareController":"HotMusicCMShareController","./InviteUnlockMusicCountdownUtil":"InviteUnlockMusicCountdownUtil"}],HotMusicListCtrl:[function(l,P,m){"use strict";cc._RF.push(P,"f5f1983drdKD6Vkc6ojsibP","HotMusicListCtrl"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../MusicLevelDataLoader"),s=l("../../../Network/Protocol/StorageUtil"),r=l("../../../../config/LSKey"),o=l("./HotMusicCardItemPrefb"),e=l("./InviteUnlockMusicCountdownUtil"),n=l("../../../../base/G"),t=l("../../../../base/State"),i=l("../../../Logic/SongTryData"),a=l("../../../Logic/MoneySystem"),u=l("../../../Logic/EventBus"),c=l("../../../Logic/NotifyEvent"),p=l("../../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),h=l("../../../keypad/KeypadUtil"),f=cc._decorator,g=f.ccclass,_=f.property,y=function(S){function I(){var C=S!==null&&S.apply(this,arguments)||this;return C.itemPrefb=null,C.scrollView=null,C.spawnCount=0,C.totalCount=0,C.spacing=0,C.bufferZone=0,C.items=[],C.lastContentPosY=0,C.musicInfoArray=new Array,C.updateMusicItemCount=0,C.mRealIndex=[],C.mInitHideShowState=!1,C.mHideAfterLoad=!1,C.mSkipCount=0,C.mIsTouched=!1,C.mAlreadyShow=!1,C.mUpdateTask=[],C.mHasLoadedListView=!1,C.mLoadingListView=!1,C.mLastItemHeight=0,C}var v;return __extends(I,S),v=I,Object.defineProperty(I.prototype,"hideAfterLoad",{get:function(){return this.mHideAfterLoad},set:function(C){this.mHideAfterLoad=C},enumerable:!0,configurable:!0}),I.prototype.getTotalCount=function(){return this.musicInfoArray.length},I.prototype.onLoad=function(){u.default.register(c.default.UPDATE_MUSIC_LIST_CURRENT_TIME,this.udpateCurrentTime,this),u.default.register(c.default.UPDATE_MUSIC_LIST_HEIGHT,this.updateItemHeight,this),this.mCurrentTime=p.MGUser.getCurrentServerTime(),this.content=this.scrollView.content},I.prototype.postUpdateTask=function(C){this.mUpdateTask.push(C)},I.prototype.start=function(){var C=this;this.mAlreadyShow=!0,this.scheduleOnce(function(){C.scrollToRememberPosition()},.001)},I.prototype.udpateCurrentTime=function(C,T){this.mCurrentTime=T[0]},I.prototype.onDestroy=function(){u.default.remove(c.default.UPDATE_MUSIC_LIST_HEIGHT,this.updateItemHeight,this),u.default.remove(c.default.UPDATE_MUSIC_LIST_CURRENT_TIME,this.udpateCurrentTime,this),u.default.fire(c.default.INVITE_SONG_LOOPER_STOP),console.info("[ActivityLooper] HotMusicList onDestroy")},I.prototype.getItemType=function(C){return C.mGameComsume&&C.mGameComsume.unlockActive&&C.mGameComsume.isActive(e.default.Ins().getCurrentTime())?C.isLocked?v.TYPE_LOCK_SPEC:v.TYPE_UNLOCK_SPEC:v.TYPE_NORMAL},I.prototype.getItemHeight=function(C){switch(C){case v.TYPE_NORMAL:return v.NORMAL_ITEM_HEIGHT;case v.TYPE_LOCK_SPEC:return v.SPEC_LOCK_ITEM_HEIGHT;case v.TYPE_UNLOCK_SPEC:return v.SPEC_UNLOCK_ITEM_HEIGHT;default:return v.NORMAL_ITEM_HEIGHT}},I.prototype.setTouched=function(C,T){this.mIsTouched=C,this.mUuid=T},I.prototype.getTouchUuid=function(){return this.mUuid},I.prototype.getTouched=function(){return this.mIsTouched},I.prototype.SetItemDivHeight=function(C){v.NORMAL_ITEM_HEIGHT=C.mNormalPanel.node.height,v.SPEC_LOCK_ITEM_HEIGHT=C.mSpecLockPanle.node.height,v.SPEC_UNLOCK_ITEM_HEIGHT=C.mSpecUnlockPanel.node.height},I.prototype.loadData=function(){return __awaiter(this,void 0,void 0,function(){var C=this;return __generator(this,function(T){return cc.isValid(this.node)&&this.postUpdateTask(function(){C.musicInfoArray=d.MusicLevelDataLoader.getChoicenessAllItemInfo(),C.updateMusicItemCount=C.spawnCount;var E=new d.ItemInfo;E.id=o.default.EXCEPT_MORE_ID,C.musicInfoArray.push(E),C.postUpdateTask(function(){C.initListView(C.musicInfoArray)})}),[2]})})},I.prototype.initListView=function(C){return __awaiter(this,void 0,void 0,function(){var T,E,A,M,k,D,L=this;return __generator(this,function(b){for(Date.now(),T=cc.instantiate(this.itemPrefb),E=T.getComponent(o.default),this.SetItemDivHeight(E),this.musicInfoArray=d.MusicLevelDataLoader.getChoicenessAllItemInfo(),(A=new d.ItemInfo).id=o.default.EXCEPT_MORE_ID,this.musicInfoArray.push(A),this.RefreshContentHeight(),this.spawnCount>this.musicInfoArray.length&&(this.spawnCount=this.musicInfoArray.length),M=function(N){var H=k.musicInfoArray[N],R=N;k.postUpdateTask(function(){var F=cc.instantiate(T),x=F.getComponent(o.default);if(x.setData(H,R,L.mCurrentTime),x.setCtrl(L),x.setRememberPosCallback(function(){L.rememberScrollPosition()}),x.setTryPositionCallback(function(B){L.rememberScrollPosition(),B.mGameComsume.testType==d.GameConsume.TESTTYPE_GOLD?a.MoneySystem.consumeGold(B.mGameComsume.testGold):B.mGameComsume.testType==d.GameConsume.TESTTYPE_DIAMOND?a.MoneySystem.consumeDiamond(B.mGameComsume.testDiamond):(B.mGameComsume.testType==d.GameConsume.TESTTYPE_ENERGY||B.mGameComsume.testType==d.GameConsume.TESTTYPE_DEFAULT)&&a.MoneySystem.consumeHp(B.mGameComsume.testEnergy),n.G.songTryData||(n.G.songTryData=new i.default),n.G.songTryData.songTryListPosition=L.scrollView.getScrollOffset().y,n.G.Ap.state.reset(),n.G.Ap.state.mission=new t.Mission(B.id,B.musicId,!1),n.G.Ap.state.mission.trialSong=!0,u.default.fire(c.default.LOAD_MUSIC,2)}),R==0)F.setPosition(0,-L.spacing);else{var U=L.items[R-1];F.setPosition(0,U.y-L.mLastItemHeight-L.spacing)}F.tag=L.getItemType(H),F.height=L.getItemHeight(F.tag),L.content.addChild(F),L.items.push(F),L.mRealIndex.push(R),L.mLastItemHeight=F.height,L.updateMusicItemCount-=1,L.updateMusicItemCount<=0&&(L.mAlreadyShow=!0,L.mHasLoadedListView=!0,L.mLoadingListView=!1,L.scrollView.enabled=!0,L.scheduleOnce(function(){L.scrollToRememberPosition()},.001))})},k=this,D=0;D<this.spawnCount;D++)M(D);return[2]})})},I.prototype.getPositionInView=function(C){var T=C.parent.convertToWorldSpaceAR(C.position);return this.scrollView.node.convertToNodeSpaceAR(T)},I.prototype.update=function(C){this.mCurrentTime+=C,this.mInitHideShowState||(this.mHideAfterLoad,this.mSkipCount++,3<=this.mSkipCount&&(this.mHideAfterLoad=!1,this.mInitHideShowState=!0)),0<this.mUpdateTask.length&&this.mUpdateTask.shift()()},I.prototype.onShow=function(C){C===void 0&&(C=-1),this.mHasLoadedListView||this.mLoadingListView?this.updateListView(C):(this.mLoadingListView=!0,this.scrollView.enabled=!1,this.loadData())},I.prototype.updateListView=function(C){var T=this;C===void 0&&(C=-1),this.scrollView.enabled=!0,this.mAlreadyShow=!0,this.musicInfoArray=d.MusicLevelDataLoader.getChoicenessAllItemInfo();var E=new d.ItemInfo;E.id=o.default.EXCEPT_MORE_ID,this.musicInfoArray.push(E);for(var A,M,k,D=this.mRealIndex.length,L=(this.scrollView.node.height,this.scrollView.node.height,this.scrollView.node.anchorX,this.scrollView.node.anchorY,0);L<D;L++){if(A=this.mRealIndex[L],k=(M=this.items[A]).getComponent(o.default),C!=-1&&M.musicId==C){k.setData(this.musicInfoArray[k.itemID],k.itemID,this.mCurrentTime);break}k.setData(this.musicInfoArray[k.itemID],k.itemID,this.mCurrentTime)}this.scheduleOnce(function(){T.scrollToRememberPosition()},.3)},I.prototype.updateItemHeight=function(){u.default.fire(c.default.INVITE_SONG_LOOPER_STOP),this.musicInfoArray=d.MusicLevelDataLoader.getChoicenessAllItemInfo(),this.RefreshContentHeight(),this.RefreshAllItemHeight()},I.prototype.RefreshContentHeight=function(){for(var C,T=0,E=0,A=0,M=0;M<this.musicInfoArray.length;M++)this.musicInfoArray[M]&&this.musicInfoArray[M].id!=o.default.EXCEPT_MORE_ID&&(this.musicInfoArray[M].mGameComsume.unlockActive&&this.musicInfoArray[M].mGameComsume.isActive(e.default.Ins().getCurrentTime())?this.musicInfoArray[M].isLocked?A++:E++:T++);C=v.NORMAL_ITEM_HEIGHT*(T+1)+v.SPEC_UNLOCK_ITEM_HEIGHT*E+v.SPEC_LOCK_ITEM_HEIGHT*A,this.content.height=C},I.prototype.RefreshAllItemHeight=function(){for(var C,T,E=this.mRealIndex.length,A=0;A<E;A++){if(C=this.mRealIndex[A],(T=this.items[C]).getComponent(o.default),A==0)T.setPosition(0,-this.spacing);else{var M=this.items[A-1];T.setPosition(0,M.y-M.height-this.spacing)}T.tag=this.getItemType(this.musicInfoArray[A]),T.height=this.getItemHeight(T.tag)}},I.prototype.onHide=function(){console.info("[ActivityLooper] HotMusicList onHide"),this.scrollView.stopAutoScroll(),this.mAlreadyShow&&this.rememberScrollPosition(),u.default.fire(c.default.INVITE_SONG_LOOPER_STOP)},I.prototype.setEnable=function(C){this.scrollView.enabled=C},I.prototype.update2=function(){var C,T,E,A,M,k,D,L,b,N,H,R,F,x=this.items,U=this.bufferZone;if(this.scrollView.content.y<this.lastContentPosY)for(var B=this.mRealIndex.length-1;0<=B&&(C=this.mRealIndex[B],T=this.mRealIndex[0],E=x[C],A=x[T],(M=this.getPositionInView(E)).y<-U&&A.y+this.spacing+E.height<200);B--)D=(k=E.getComponent(o.default)).itemID-this.spawnCount,this.musicInfoArray[D].id==o.default.EXCEPT_MORE_ID?(E.tag=v.TYPE_NORMAL,E.height=v.NORMAL_ITEM_HEIGHT):(E.tag=this.getItemType(this.musicInfoArray[D]),E.height=this.getItemHeight(E.tag)),k.setData(this.musicInfoArray[D],D,this.mCurrentTime),L=this.mRealIndex.pop(),this.mRealIndex.unshift(L),b=E.height,E.setPositionY(A.y+this.spacing+b),B++;else for(B=0;B<this.mRealIndex.length&&(C=this.mRealIndex[B],N=this.mRealIndex[this.mRealIndex.length-1],E=this.items[C],H=this.items[N],M=this.getPositionInView(E),R=this.getItemHeight(H.tag),M.y>U&&H.y-R-this.spacing>-this.content.height);B++)D=(k=E.getComponent(o.default)).itemID+this.spawnCount,this.musicInfoArray[D].id==o.default.EXCEPT_MORE_ID?(E.tag=v.TYPE_NORMAL,E.height=v.NORMAL_ITEM_HEIGHT):(E.tag=this.getItemType(this.musicInfoArray[D]),E.height=this.getItemHeight(E.tag)),k.setData(this.musicInfoArray[D],D,this.mCurrentTime),F=this.mRealIndex.shift(),this.mRealIndex.push(F),E.setPositionY(H.y-R-this.spacing),B--;this.lastContentPosY=this.scrollView.content.y},I.prototype.scrollEvent=function(C,T){switch(T){case 0:case 1:case 2:case 3:break;case 4:this.update2()}},I.prototype.rememberScrollPosition=function(){s.default.save(r.default.HOT_MUSIC_LIB_SCROLL_POSITION,this.scrollView.getScrollOffset().y+"")},I.prototype.scrollToRememberPosition=function(){if(h.default.isHorizon())console.warn("== skip scrollToRememberPosition for horizontal ==");else{var C=s.default.read(r.default.HOT_MUSIC_LIB_SCROLL_POSITION);C?parseFloat(C)<1?this.scrollView.scrollToTop(.2):this.scrollView.scrollTo(cc.p(0,1-parseFloat(C)/this.scrollView.getMaxScrollOffset().y),.2):this.scrollView.scrollToTop(.2)}},I.SPEC_UNLOCK_ITEM_HEIGHT=233,I.SPEC_LOCK_ITEM_HEIGHT=296,I.NORMAL_ITEM_HEIGHT=223,I.TYPE_LOCK_SPEC=1,I.TYPE_UNLOCK_SPEC=2,I.TYPE_NORMAL=0,__decorate([_(cc.Prefab)],I.prototype,"itemPrefb",void 0),__decorate([_(cc.ScrollView)],I.prototype,"scrollView",void 0),__decorate([_],I.prototype,"spawnCount",void 0),__decorate([_],I.prototype,"totalCount",void 0),__decorate([_],I.prototype,"spacing",void 0),__decorate([_],I.prototype,"bufferZone",void 0),I=v=__decorate([g],I)}(cc.Component);m.default=y,cc._RF.pop()},{"../../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../../base/G":"G","../../../../base/State":"State","../../../../config/LSKey":"LSKey","../../../Logic/EventBus":"EventBus","../../../Logic/MoneySystem":"MoneySystem","../../../Logic/NotifyEvent":"NotifyEvent","../../../Logic/SongTryData":"SongTryData","../../../Network/Protocol/StorageUtil":"StorageUtil","../../../keypad/KeypadUtil":"KeypadUtil","../../MusicLevelDataLoader":"MusicLevelDataLoader","./HotMusicCardItemPrefb":"HotMusicCardItemPrefb","./InviteUnlockMusicCountdownUtil":"InviteUnlockMusicCountdownUtil"}],HotSongSplashItem:[function(l,P,m){"use strict";cc._RF.push(P,"993f78QV3hM/otfL+jv29W8","HotSongSplashItem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.title_label=null,i.author_label=null,i.describe_label=null,i.activity_sprite=null,i}return __extends(t,n),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.onDestroy=function(){},t.prototype.setData=function(i,a,u){if(this.itemID=a,i!=null){var c=0;u!=null&&u!=null&&(c=parseInt(u+"")),this.node.active=!0,this.title_label.string=i.musicName,this.author_label.string=i.musician,c==-1?this.describe_label.node.active=!1:(this.describe_label.node.active=!0,this.describe_label.string="\u5DF2\u6709"+(2e5+c)+"\u4EBA\u89E3\u9501"),i.mGameComsume.isActive(d.MGUser.getCurrentServerTime())?this.activity_sprite.node.active=!0:this.activity_sprite.node.active=!1}else this.node.active=!1},__decorate([o(cc.Label)],t.prototype,"title_label",void 0),__decorate([o(cc.Label)],t.prototype,"author_label",void 0),__decorate([o(cc.Label)],t.prototype,"describe_label",void 0),__decorate([o(cc.Sprite)],t.prototype,"activity_sprite",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance"}],HotSongSplash:[function(l,P,m){"use strict";cc._RF.push(P,"853f8x+iPVD4qs+qviOnnS7","HotSongSplash"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../BasicTouchEvent"),s=l("../../MusicLevelDataLoader"),r=l("./HotSongSplashItem"),o=l("../../../../util/Dictionary"),e=l("../../../../infoc/minigame_piano2_hotmusic"),n=cc._decorator,t=n.ccclass,i=n.property,a=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.root_layout=null,p.close_btn=null,p.jumpBtn=null,p.play_btn=null,p.scrollView=null,p.spawnCount=0,p.totalCount=0,p.spacing=0,p.bufferZone=0,p.mItemPrefab=null,p.mToastPrefab=null,p.popup_layout=null,p.loading_sprite=null,p.mCloseClickCallback=null,p.mPlayClickCallback=null,p.mContent=null,p.itemTemplate=null,p.items=[],p.mRealIndex=[],p.itemHeight=168,p.lastContentPosY=0,p.updateTimer=0,p.updateInterval=.2,p.mItemUnlockCount=new o.Dictionary,p.mInitDataFinish=!1,p}return __extends(c,u),c.prototype.setCloseCallback=function(p){this.closeCallback=p},c.prototype.setPlayImmediatelyCallback=function(p){this.playImmediatelyCallback=p},c.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(p){p.stopPropagation()}),this.mContent=this.scrollView.content,this.adapterUI(),this.initEvent(),this.mItemInfos=s.MusicLevelDataLoader.getNewChoiceness(),this.initializeScrollView()},c.prototype.start=function(){this.getComponent(cc.Animation).play("hot_song_splash")},c.prototype.onDestroy=function(){},c.prototype.initEvent=function(){var p=this;this.mCloseClickCallback=new d.default(function(){p.closeClick()}),this.close_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback),this.jumpBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback),this.mPlayClickCallback=new d.default(function(){e.default.report(e.default.ACTION_SHOW,e.default.SOURCE_DIALOG,0,"",0),p.playClick()}),this.play_btn.node.on(cc.Node.EventType.TOUCH_END,this.mPlayClickCallback.click,this.mPlayClickCallback)},c.prototype.playClick=function(){this.playImmediatelyCallback&&this.playImmediatelyCallback()},c.prototype.closeClick=function(){this.closeCallback&&this.closeCallback()},c.prototype.initData=function(p,h){var f=this;if(this.mItemInfos&&0<this.mItemInfos.length){for(var g=[],_=0;_<this.mItemInfos.length;_++){var y=this.mItemInfos[_];y&&g.push(y.musicId)}cmg.platform.queryMusicPeopleNums(g,function(S,I){if(S&&I){for(var v=0;v<g.length;v++){var C=g[v];f.mItemUnlockCount.put(C,I[""+C])}p()}else h()})}else p()},c.prototype.dataSetChanged=function(){for(var p,h,f=this.mRealIndex.length,g=0;g<f;g++)p=this.mRealIndex[g],(h=this.items[p].getComponent(r.default)).setData(this.mItemInfos[h.itemID],h.itemID,this.getItemUnlockCount(this.mItemInfos[g].musicId))},c.prototype.getItemUnlockCount=function(p){var h=this.mItemUnlockCount.get(p);return h==null||h==null?-1:h},c.prototype.initializeScrollView=function(){this.itemTemplate=cc.instantiate(this.mItemPrefab);var p=this.mItemInfos.length*(this.itemHeight+this.spacing);this.mContent.height=p;for(var h=Math.min(this.mItemInfos.length,this.spawnCount),f=0;f<h;f++){var g=cc.instantiate(this.itemTemplate);g.getComponent(r.default).setData(this.mItemInfos[f],f,this.getItemUnlockCount(this.mItemInfos[f].musicId)),g.setPosition(0,-(f*(this.itemHeight+this.spacing)+this.spacing)),this.mContent.addChild(g),this.mRealIndex.push(f),this.items.push(g)}},c.prototype.scrollEvent=function(p,h){switch(h){case 0:case 1:case 2:case 3:break;case 4:this.updateByScroll()}},c.prototype.updateByScroll=function(){var p,h,f,g,_,y,S,I,v,C=this.items,T=this.bufferZone;if(this.mContent.y<this.lastContentPosY)for(var E=this.mRealIndex.length-1;0<=E&&(v=C[this.mRealIndex[E]],p=C[this.mRealIndex[0]],(h=this.getPositionInView(v)).y<-T&&p.y+this.spacing+v.height<0);E--)f=(I=v.getComponent(r.default)).itemID-this.spawnCount,I.setData(this.mItemInfos[f],f,this.getItemUnlockCount(this.mItemInfos[f].musicId)),g=this.mRealIndex.pop(),this.mRealIndex.unshift(g),v.setPosition(0,p.y+this.spacing+this.itemHeight),E++;else for(E=0;E<this.mRealIndex.length&&(v=C[this.mRealIndex[E]],_=C[this.mRealIndex[this.mRealIndex.length-1]],h=this.getPositionInView(v),y=this.itemHeight,h.y>T&&_.y-y-this.spacing>-this.mContent.height);E++)f=(I=v.getComponent(r.default)).itemID+this.spawnCount,I.setData(this.mItemInfos[f],f,this.getItemUnlockCount(this.mItemInfos[f].musicId)),S=this.mRealIndex.shift(),this.mRealIndex.push(S),v.setPosition(0,_.y-y-this.spacing),E--;this.lastContentPosY=this.mContent.y},c.prototype.getPositionInView=function(p){var h=p.parent.convertToWorldSpaceAR(p.position);return this.scrollView.node.convertToNodeSpaceAR(h)},c.prototype.adapterUI=function(){},__decorate([i(cc.Layout)],c.prototype,"root_layout",void 0),__decorate([i(cc.Button)],c.prototype,"close_btn",void 0),__decorate([i(cc.Button)],c.prototype,"jumpBtn",void 0),__decorate([i(cc.Button)],c.prototype,"play_btn",void 0),__decorate([i(cc.ScrollView)],c.prototype,"scrollView",void 0),__decorate([i],c.prototype,"spawnCount",void 0),__decorate([i],c.prototype,"totalCount",void 0),__decorate([i],c.prototype,"spacing",void 0),__decorate([i],c.prototype,"bufferZone",void 0),__decorate([i(cc.Prefab)],c.prototype,"mItemPrefab",void 0),__decorate([i(cc.Prefab)],c.prototype,"mToastPrefab",void 0),__decorate([i(cc.Layout)],c.prototype,"popup_layout",void 0),__decorate([i(cc.Layout)],c.prototype,"loading_layout",void 0),__decorate([i(cc.Sprite)],c.prototype,"loading_sprite",void 0),c=__decorate([t],c)}(cc.Component);m.default=a,cc._RF.pop()},{"../../../../infoc/minigame_piano2_hotmusic":"minigame_piano2_hotmusic","../../../../util/Dictionary":"Dictionary","../../MusicLevelDataLoader":"MusicLevelDataLoader","../BasicTouchEvent":"BasicTouchEvent","./HotSongSplashItem":"HotSongSplashItem"}],HotmusicActivityMgr:[function(l,P,m){"use strict";cc._RF.push(P,"a7034FuVh5Gj4jzyrN0UyK8","HotmusicActivityMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/StringUtil"),s=l("../../upgrade/VersionBean"),r=l("../../upgrade/IChecker"),o=l("../../util/NumberUtil"),e=l("../../upgrade/CloudMgr"),n=l("../../config/LSKey"),t=l("../../util/SingleWorker"),i=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),a=function(p){function h(){var f=p!==null&&p.apply(this,arguments)||this;return f.unlockType="1",f}return __extends(h,p),h.prototype.getMids=function(){var f=[];if(d.StringUtil.isEmpty(this.mids))return f;var g=this.mids.split(";");return g&&g.forEach(function(_){d.StringUtil.isEmpty(_)||f.push(_)}),f},h}(s.default);m.HotmusicAcitivityBean=a;var u=function(p){function h(){return p!==null&&p.apply(this,arguments)||this}return __extends(h,p),h.prototype.validateData=function(f){return f!=null&&f!=null},h.prototype.onMergeServerToLocal=function(f,g){},h.prototype.populateServerObj=function(f){var g=new a;return g.serverVer=r.default.populateStr(f.ver),g.key=r.default.populateStr(f.key),g.url=r.default.populateStr(f.url),g.md5=r.default.populateStr(f.md5),g.type=r.default.populateStr(f.type),g.size=o.default.parseNum(f.size),g.enableTime=o.default.parseNum(f.enableTime),g.endTime=o.default.parseNum(f.endTime),g.platform=r.default.populateStr(f.platform),g.id=o.default.parseNum(f.id),g.start=r.default.populateStr(f.start),g.end=r.default.populateStr(f.end),g.mids=r.default.populateStr(f.mids),g.unlockType=r.default.populateStr(f.unlockType),g.enableTime=this.getTimeInMs(g.start),g.endTime=this.getTimeInMs(g.end),g},h.prototype.populateLocalObj=function(f){var g=new a;return g.localVer=r.default.populateStr(f.localVer),g.serverVer=r.default.populateStr(f.serverVer),g.downloadTime=o.default.parseNum(f.downloadTime),g.localMd5=r.default.populateStr(f.localMd5),g.key=r.default.populateStr(f.key),g.url=r.default.populateStr(f.url),g.md5=r.default.populateStr(f.md5),g.type=r.default.populateStr(f.type),g.enableTime=o.default.parseNum(f.enableTime),g.platform=r.default.populateStr(f.platform),g.endTime=o.default.parseNum(f.endTime),g.id=o.default.parseNum(f.id),g.start=r.default.populateStr(f.start),g.end=r.default.populateStr(f.end),g.mids=r.default.populateStr(f.mids),g.unlockType=r.default.populateStr(f.unlockType),g},h.prototype.getTimeInMs=function(f){if(d.StringUtil.isEmpty(f))return 0;try{return new Date(f).getTime()}catch(g){return console.error("format str to date error."+f),0}},h}(r.default);m.HotmusicActivityChecker=u;var c=function(){function p(){this.server_url="https://piano-weixin-game.cmcm.com/pianotiles2/cfg/cmplay/hotmusic/activity.json",this.mCloudMgr=new e.default(new u("hotmusic-actvity",n.default.HOTMUSIC_ACTIVITY,this.server_url))}return p.Ins=function(){return p._s||(p._s=new p),p._s},p.prototype.init=function(h){var f=this;t.default.doWork("hotmsuci-activityMGR",function(){return new Promise(function(g,_){f.mCloudMgr.request(function(){g()},function(){g()})})},function(){h&&h()})},p.prototype.getTodayActivityMusic=function(){var h=i.MGUser.getCurrentServerTime(),f=this.mCloudMgr.filterData(function(_){return _.enableTime<=h&&_.endTime>h&&_.isPlatformValid("cmplay")}),g=[];return f&&0<f.length&&f.forEach(function(_){if(_){var y=_.getMids();y&&0<y.length&&y.forEach(function(S){g.push({mid:S,start:_.enableTime,end:_.endTime})})}}),g},p}();m.default=c,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../config/LSKey":"LSKey","../../upgrade/CloudMgr":"CloudMgr","../../upgrade/IChecker":"IChecker","../../upgrade/VersionBean":"VersionBean","../../util/NumberUtil":"NumberUtil","../../util/SingleWorker":"SingleWorker","../../util/StringUtil":"StringUtil"}],I18nManager:[function(l,P,m){"use strict";cc._RF.push(P,"351c6n1AXNGLYHjXyq4MBDc","I18nManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("LanguageData"),s=function(){function r(){this.mCache={},this.mIsEnglish=!1,console.warn("setLang to en"),this.mIsEnglish=!0,d.init("en")}return r.init=function(){r.getInstance()},r.prototype.isEnglish=function(){return this.mIsEnglish},r.getInstance=function(){return r.sInstance==null&&(r.sInstance=new r),r.sInstance},r.prototype.setLanguage=function(o,e){this.mCache[o]=e},r.prototype.getLanguageByKey=function(o){var e=this.mCache[o];if(e)return this.mIsEnglish?o:e;var n=d.t(o);return n||void 0},r.sInstance=null,r}();m.default=s,cc._RF.pop()},{LanguageData:"LanguageData"}],IAdapter:[function(l,P,m){"use strict";cc._RF.push(P,"356c8ClGDVNQ5U7AF3yNgcq","IAdapter"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IAwardRounter:[function(l,P,m){"use strict";cc._RF.push(P,"1842d71j7ZANrwkSEPRcFGy","IAwardRounter"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IBattleGameSceneView:[function(l,P,m){"use strict";var d,s,r;cc._RF.push(P,"a51ccPoOGpCqp7EKwAf5cRL","IBattleGameSceneView"),Object.defineProperty(m,"__esModule",{value:!0}),(d=m.BattleGameSceneViewHeadId||(m.BattleGameSceneViewHeadId={}))[d.SELF=0]="SELF",d[d.OPPONENT=1]="OPPONENT",(s=m.BattleGameSceneViewHeadType||(m.BattleGameSceneViewHeadType={}))[s.MISS=0]="MISS",s[s.COMBO=1]="COMBO",s[s.MISS_1=2]="MISS_1",s[s.NONE=3]="NONE",(r=m.BattleGameSceneViewWaitingType||(m.BattleGameSceneViewWaitingType={}))[r.START=0]="START",r[r.END=1]="END",cc._RF.pop()},{}],IChecker:[function(l,P,m){"use strict";cc._RF.push(P,"01d60YZ9PxIG54Ai6ye0tAN","IChecker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/Log"),s=l("../business/Network/Protocol/StorageUtil"),r=l("../util/StringUtil"),o=l("../LogicPlatform/PlatformProxy"),e=l("../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),n=l("../../modules/MGUtils/NetworkUtils"),t=l("../util/PU"),i=function(){function a(u,c,p,h){this.mType="",this.mStorageKey="",this.mLocalBeans=[],this.mVersionJsonUrl="",this.innerFile="",this.isCheckedNetVer=!1,this.mType=u,this.mStorageKey=c,this.mVersionJsonUrl=p,this.innerFile=h}return a.prototype.saveLocalData=function(){var u=JSON.stringify(this.mLocalBeans);s.default.save(this.mStorageKey,u)},a.prototype.getType=function(){return this.mType},a.prototype.getData=function(){return this.mLocalBeans},a.prototype.check=function(u,c){var p=this;this.isCheckedNetVer?u():(this.parseLocalData(),this.parseData(function(h){p.validateData(h)&&(p.mergeToLocalData(h),p.saveLocalData(),p.isCheckedNetVer=!0),u()},function(){c()}))},a.prototype.parseData=function(u,c){var p=this;this.readLocalFile(function(h){h?u(h):p.requestNet(u,c)},function(){p.requestNet(u,c)})},a.prototype.readLocalFile=function(u,c){var p=this;r.StringUtil.isEmpty(this.innerFile)?c():cc.loader.load(cc.url.raw(this.innerFile),function(h,f){d.default.i("read from file:",p.innerFile,h,f),h||!f?c():u(f)})},a.prototype.requestNet=function(u,c){d.default.i("request from net:"+this.mVersionJsonUrl),o.default.Ins().isSupportDownloadRes()?this.doDownloadToDisk(u,c):this.doRequestWithoutDisk(u,c)},a.prototype.doRequestWithoutDisk=function(u,c){n.default.request({platform:t.default.getPlatformType(),url:this.mVersionJsonUrl,method:n.default.METHOD_GET,dataType:"json",success:function(p){u&&u(p)},fail:function(){c&&c()}})},a.prototype.doDownloadToDisk=function(u,c){var p=this;o.default.Ins().downloadFile(this.mVersionJsonUrl,function(h){e.MGBasic.readFile({filePath:h,encoding:"utf8",success:function(f){u(f)},fail:function(){c()}})},function(){d.default.e(a.TAG+" download failed."+p.mVersionJsonUrl),c()},0,!1)},a.prototype.parseLocalData=function(){this.mLocalBeans.splice(0,this.mLocalBeans.length);var u,c=s.default.read(this.mStorageKey);if(c!=null&&c!=null&&c.length!==0)try{if((u=JSON.parse(c))&&0<u.length)for(var p=0;p<u.length;p++){var h=this.populateLocalObj(u[p]);h!=null&&this.mLocalBeans.push(h)}}catch(f){}},a.prototype.mergeToLocalData=function(u){if(u&&0<u.length){for(var c=[],p=0;p<u.length;p++){var h=this.populateServerObj(u[p]);if(h){c.push(h);for(var f=null,g=0;g<this.mLocalBeans.length;g++){var _=this.mLocalBeans[g];if(_.key==h.key&&_.type==h.type){f=_;break}}f&&(h.localMd5=f.md5,h.localVer=f.localVer,h.downloadTime=f.downloadTime),this.onMergeServerToLocal(h,f)}}0<c.length&&(this.mLocalBeans=c)}return!0},a.populateStr=function(u){return u==null||u==null?"":""+u},a.TAG="IChecker => ",a}();m.default=i,cc._RF.pop()},{"../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../modules/MGUtils/NetworkUtils":"NetworkUtils","../LogicPlatform/PlatformProxy":"PlatformProxy","../base/Log":"Log","../business/Network/Protocol/StorageUtil":"StorageUtil","../util/PU":"PU","../util/StringUtil":"StringUtil"}],IEnumerable:[function(l,P,m){"use strict";cc._RF.push(P,"f7ba0RxZipKSZ7sDwkp8fD2","IEnumerable"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IEnumerator:[function(l,P,m){"use strict";cc._RF.push(P,"b74c29g9GBLZJBC597z+nQS","IEnumerator"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IMap:[function(l,P,m){"use strict";cc._RF.push(P,"f8679/1+yZF1LENcysLqhL0","IMap"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IModule:[function(l,P,m){"use strict";cc._RF.push(P,"525c7NavABPGoO2OEfH0DXe","IModule"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IMusicContext:[function(l,P,m){"use strict";cc._RF.push(P,"492723ax+ZJio+FUWNuTtsK","IMusicContext"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IPlugin:[function(l,P,m){"use strict";cc._RF.push(P,"b06a5Lp/e1AA6q0N0C05jKl","IPlugin"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.prototype.update=function(r){},s.prototype.onLevelChanged=function(r){},s.prototype.onAwake=function(){},s.prototype.getKind=function(){return""},s.Plugin_Singin="Sing In",s.Plugin_Exp="Exp",s.Plugin_Energy="Energy",s.Plugin_Unlock="Unlock",s.Plugin_Economy="Economy",s.Plugin_WorldRank="WorldRank",s.Plugin_Share="Share",s.Plugin_HallLogic="Hall",s.Plugin_Rate="Rate",s.Plugin_Diamond="Diamond",s.Plugin_Ad="Ad",s.Plugin_Recharge="Recharge",s.Plugin_MusicTrack="Track",s.Plugin_Debug="Debug",s.Plugin_Skin_Chip="SkinChip",s}();m.default=d,cc._RF.pop()},{}],IServiceBuilder:[function(l,P,m){"use strict";cc._RF.push(P,"68fb0kx6xhM/LfjSUpPecev","IServiceBuilder"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IServiceProviderFactory:[function(l,P,m){"use strict";cc._RF.push(P,"caa2cedgYFO+KFp1beK0Rcb","IServiceProviderFactory"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IServiceProvider:[function(l,P,m){"use strict";cc._RF.push(P,"d20aclC1Y1B3IO3X1COON2D","IServiceProvider"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IServiceStorage:[function(l,P,m){"use strict";cc._RF.push(P,"cb767e4YT9AbZy4iaoIN56Z","IServiceStorage"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],ISet:[function(l,P,m){"use strict";cc._RF.push(P,"ecd37of5A1JxY6xK7fle5f4","ISet"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],IWorker:[function(l,P,m){"use strict";cc._RF.push(P,"bcfffac/RhHVYbT/RbmNroa","IWorker"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],ImgCache:[function(l,P,m){"use strict";cc._RF.push(P,"5fbacNeNnVNJ5lgzX0KhEG0","ImgCache"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function r(){this.mImageMap={}}return r.prototype.loadAtlasSpriteFrames=function(o,e,n){var t=this,i=o+"-"+e,a=this.mImageMap[i];if(a)return a.textureLoaded()||a.ensureLoadTexture(),void n(null,a);cc.loader.loadRes(o,cc.SpriteAtlas,function(u,c){if(u)n(u,null);else{var p=c.getSpriteFrame(e);t.mImageMap[i]=p,n(null,p)}})},r.prototype.saveMusicItemBgImageAtlas=function(o,e,n){var t=this;cc.loader.loadRes(o,cc.SpriteAtlas,function(i,a){i?n(i,null):(e.forEach(function(u){var c=a.getSpriteFrame(u);c&&(t.mImageMap[u]=c)}),n(null,a))})},r.prototype.getMusicItemBgImage=function(o,e,n){var t=this,i=this.mImageMap[e];if(i)return i.textureLoaded()||i.ensureLoadTexture(),void n(null,i);cc.loader.loadRes(o,cc.SpriteAtlas,function(a,u){if(a)n(a,null);else{var c=u.getSpriteFrame(e);t.mImageMap[e]=c,n(null,c)}})},r.prototype.get=function(o,e){var n=this,t=this.mImageMap[o];if(t)return t.textureLoaded()||t.ensureLoadTexture(),void e(null,t);cc.loader.loadRes(o,cc.SpriteFrame,function(i,a){i?e(i,null):(n.mImageMap[o]=a,e(null,a))})},r.prototype.getImages=function(o,e){for(var n=new Array,t=new Array,i=0;i<o.length;i++){var a=this.mImageMap[o[i]];a&&(a.textureLoaded()||a.ensureLoadTexture(),n.push(a),t.push(o[i]))}if(t.length!=o.length){var u=new Array;o.forEach(function(c){for(var p=!1,h=0;h<t.length;h++)if(c==t[h]){p=!0;break}p||u.push(c)}),console.log(u[0]),cc.loader.loadResArray(u,cc.SpriteFrame,function(c,p){if(c)e(c,null);else{var h=p,f=n.concat(h);e(null,f)}})}else e(null,n)},r}(),s=function(){function r(){}return r.loadAtlasSpriteFrames=function(o,e,n){this.ins.loadAtlasSpriteFrames(o,e,n)},r.saveMusicItemBgImageAtlas=function(o,e,n){this.ins.saveMusicItemBgImageAtlas(o,e,n)},r.getMusicItemBgImage=function(o,e,n){this.ins.getMusicItemBgImage(o,e,n)},r.getImages=function(o,e){this.ins.getImages(o,e)},r.get=function(o,e){this.ins.get(o,e)},r.get2=function(o,e,n){this.ins.get(o,function(t,i){i&&e&&cc.isValid(e,!0)&&(e.spriteFrame=i),n&&n(t,i)})},r.ins=new d,r}();m.default=s,cc._RF.pop()},{}],InfocHelper:[function(l,P,m){"use strict";cc._RF.push(P,"cbee5tz9dxEPbhK9gOfWtm3","InfocHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../business/Network/Protocol/StorageUtil"),s=l("../config/LSKey"),r=l("../util/TimeUtil"),o=l("../../modules/MGUtils/MGPlatform"),e=l("../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),n=l("../util/PU");(function(t){var i=null;function a(){var p=0,h=d.default.read(s.default.FIRST_ENTER_TIME);return h==null||h==null||h.length==0?(p=new Date().getTime(),d.default.save(s.default.FIRST_ENTER_TIME,p+"")):p=parseInt(h),r.default.formatDate(p)===r.default.getTodayFormatDate()?1:2}function u(){return n.default.isWeiXin()?1:n.default.isQQ()?2:n.default.isCM()?6:0}function c(){return cc.sys.os===cc.sys.OS_IOS?1:cc.sys.os===cc.sys.OS_ANDROID?2:0}t.isNewUser=a,t.getSystemInfo=function(){return i==null&&(i=o.MGPlatform.getSystemInfoSync()),i},t.getCommonData=function(p,h,f,g){return p==null?"brand=&model=&pixelratio=&version=&system=&sdkversion=&wechatid="+h+"&newuser=&authorization=&product_no=239&public_index=6&channel_key="+u()+"&game_id=1001&game_name=\u94A2\u7434\u5757&sub_channel=&benchmarklevel=&platform="+c()+"&game_version="+g:"brand="+p.brand+"&model="+p.model+"&pixelratio="+p.pixelRatio+"&version="+p.version+"&system="+p.system+"&sdkversion="+p.SDKVersion+"&wechatid="+h+"&newuser="+a()+"&authorization="+f+"&product_no=239&public_index=6&channel_key="+u()+"&game_id=1001&game_name=\u94A2\u7434\u5757&sub_channel="+e.MGBasic.getChannelId()+"&benchmarklevel=&platform="+c()+"&game_version="+g}})(m.InfocHelper||(m.InfocHelper={})),cc._RF.pop()},{"../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../modules/MGUtils/MGPlatform":"MGPlatform","../business/Network/Protocol/StorageUtil":"StorageUtil","../config/LSKey":"LSKey","../util/PU":"PU","../util/TimeUtil":"TimeUtil"}],Infoc:[function(l,P,m){"use strict";cc._RF.push(P,"106e62RnflKpoIes3GB+kN1","Infoc"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./InfocHelper"),s=l("../base/GameInfoMgr"),r=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),o=l("../../modules/MGUtils/NetworkUtils"),e=l("../util/PU");(function(n){var t="https://helpminigame1.ksmobile.com/g/v1",i="http://111.230.84.242/g/v1",a=null;function u(c,p,h,f){var g=d.InfocHelper.getCommonData(a,p,h,f),_=t+"/?"+g+"&"+c;n.UseTestReportHost&&(console.warn("================ now use test report host ============= "+i),_=i+"/?"+g+"&"+c);var y=encodeURI(_),S=s.GameInfoMgr.Ins().getInfo();o.default.request({platform:e.default.getPlatformType(S.platform),url:y,method:"GET",success:function(I){if(I){var v=function(C){if(!C)return-1;var T=C.indexOf("result=");if(T<0)return-2;if(T+7>=C.length)return-3;var E=C.charAt(T+7);return parseInt(E)}(I);v==1||console.error("[infoc] report fail, status code="+I.statusCode+", result="+v+" ,url="+_)}else console.warn("[infoc] error, url="+_)},fail:function(I,v){console.warn("[infoc] error, url="+_+" ,statusCode="+I)}})}n.UseTestReportHost=!1,n.reportInfoc=function(c,p){p===void 0&&(p=!1),e.default.isQQ()||e.default.isWeiXin()||e.default.isCM()?(a==null&&(a=d.InfocHelper.getSystemInfo()),p?u(c,"",0,""):r.MGUser.getUserLoginInfo({complete:function(h){r.MGUser.getUserBasicInfo({complete:function(f){var g=s.GameInfoMgr.Ins().getInfo(),_=f?1:2;u(c,h?h.playerId:"",_,g?g.version:"")}})}})):console.log("Infoc platform not support: "+c)}})(m.Infoc||(m.Infoc={})),cc._RF.pop()},{"../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../modules/MGUtils/NetworkUtils":"NetworkUtils","../base/GameInfoMgr":"GameInfoMgr","../util/PU":"PU","./InfocHelper":"InfocHelper"}],InsFactory:[function(l,P,m){"use strict";cc._RF.push(P,"0d187rdpt9OXbJ885fVR0xG","InsFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.mFactory={}}return s._getInstance=function(){return s._inited||(s._inited=!0,s._instance=new s),s._instance},s.setIns=function(r,o,e){e===void 0&&(e=!1);var n=s._getInstance().mFactory;return!(n[r]&&!e)&&(n[r]=o,!0)},s.getIns=function(r){var o=s._getInstance().mFactory[r];return o||null},s._inited=!1,s}();m.default=d,cc._RF.pop()},{}],InstrumentFactory:[function(l,P,m){"use strict";cc._RF.push(P,"bbdfeA2aoNPMIMk4BjfuYr5","InstrumentFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicInstrument"),s=function(){function r(){this.instruments=[]}return r.prototype.get=function(o){for(var e=0;e<this.instruments.length;++e)if(this.instruments[e].name===o)return this.instruments[e];var n=new d.default(o);return this.instruments.push(n),n.makeUp(),n},r.prototype.preloadMusic=function(){this.get("piano")},r}();m.default=s,cc._RF.pop()},{"./MusicInstrument":"MusicInstrument"}],InviteAwardManager:[function(l,P,m){"use strict";cc._RF.push(P,"43a658I8w5LaoGYD2UyXssT","InviteAwardManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=function(){function o(){}return o.getInstance=function(){return o.mInstance||(o.mInstance=new o),o.mInstance},o.prototype.getInviteAwardVM=function(){for(var e=[],n=0,t=d.default.Ins().getDBRows(d.eDataBase.eDB_InviteAward);n<t.length;n++){var i=t[n],a=parseInt(i.mRowData[0]);if(a&&typeof a=="number"){var u=new r,c=i;u.id=c.getId(),u.type=c.getType(),u.fragments=c.getFragments(),u.diamonds=c.getDiamonds(),u.coins=c.getCoins(),u.power=c.getPower(),e.push(u)}}return Object.seal(e)},o}();m.InviteAwardManager=s;var r=function(){};m.InviteAwardVM=r,cc._RF.pop()},{"../DB/DBMgr":"DBMgr"}],InviteAward:[function(l,P,m){"use strict";cc._RF.push(P,"efc21SsLPxClp2y3MYFleS6","InviteAward"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findInviteAwardById=function(n){return this.find("id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.InviteAward=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.getType=function(){return this.getInt("type")},e.prototype.getFragments=function(){return this.getInt("fragments")},e.prototype.getDiamonds=function(){return this.getInt("diamonds")},e.prototype.getCoins=function(){return this.getInt("coins")},e.prototype.getPower=function(){return this.getInt("power")},e}(d.default);m.InviteAwardRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],InviteSkinManager:[function(l,P,m){"use strict";cc._RF.push(P,"dcfb0BV1ZxH/52/55T6TaYY","InviteSkinManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../reward/ActivityRewardManager"),s=l("../reward/ActivityBean"),r=l("./SkinDataManager"),o=function(){function e(){}return e.refreshInviteSkinData=function(){var n=this;r.SkinDataMgr.Ins().isUnLockAllInviteSkin()||(this.updateInviteSkinData(d.ActivityRewardMgr.Ins().getCacheInviteRewardList(s.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN)),d.ActivityRewardMgr.Ins().getInviteSuccessListComplete(s.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN,function(t){n.updateInviteSkinData(t)}))},e.updateInviteSkinData=function(n){if(n&&0<n.length){var t=0;n.forEach(function(i){i.hd_id==s.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN&&i.is_new_player&&t++}),3<=t&&r.SkinDataMgr.Ins().unlockInviteSkin(),r.SkinDataMgr.Ins().updateInviteSkinCount(3<t?3:t)}},e}();m.InviteSkinManager=o,cc._RF.pop()},{"../reward/ActivityBean":"ActivityBean","../reward/ActivityRewardManager":"ActivityRewardManager","./SkinDataManager":"SkinDataManager"}],InviteSkinPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"d1be4emRMNMbIVkEUMLHFBw","InviteSkinPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../../../modules/MGAppShare/scripts/ShareImageUtils"),r=l("../UI/GameEntraScene/ToastPrefab"),o=l("../gameover/SaveSuccessPrefab"),e=l("../../base/Log"),n=l("../../social/WXHelper"),t=l("../reward/ActivityBean"),i=l("../UI/GameEntraScene/ImgCache"),a=l("../Logic/SkinDataManager"),u=l("../reward/ActivityRewardManager"),c=l("../../base/G"),p=l("./SkinTryData"),h=l("./SkinUtils"),f=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),g=l("../Logic/EventBus"),_=l("../Logic/NotifyEvent"),y=l("../../../modules/MGAppShare/scripts/MGShareUtil"),S=l("../../social/AvatarUtil"),I=l("../../../modules/MGAppShare/scripts/ShareImage"),v=l("../../util/PU"),C=l("../UI/GameEntraScene/mainpage/MainpageBaseComponent"),T=l("../../infoc/m_p2_daily_activity"),E=l("../UI/GameEntraScene/mainpage/WelfareController"),A=cc._decorator,M=A.ccclass,k=A.property,D=function(L){function b(){var N=L!==null&&L.apply(this,arguments)||this;return N.content_layout=null,N.invite_fds_btn=null,N.save_image_btn=null,N.close_btn=null,N.invite_count_text=null,N.avatar_sprite1=null,N.mask_layout1=null,N.avatar_sprite2=null,N.mask_layout2=null,N.avatar_sprite3=null,N.mask_layout3=null,N.invite_count_layout=null,N.try_btn=null,N.popup_layout=null,N.source=E.default.SRC_HOME_PAGE_CLICK,N.newUserCount=0,N.mCloseBtnClickCallback=null,N.mInviteFdsBtnClickCallback=null,N.mSaveImageBtnCallback=null,N.mTryBtnCallback=null,N.mTrySource=E.default.SRC_SKIN_INVITE_SHOW,N.isSaving=!1,N}return __extends(b,L),b.prototype.setSource=function(N){this.source=N},b.prototype.setCloseCallback=function(N){this.mCloseCallback=N},b.prototype.setInvitefdsCallback=function(N){this.mInviteFdsCallback=N},b.prototype.setSaveImageCallback=function(N){this.mSaveImageCallback=N},b.prototype.setTrySource=function(N){this.mTrySource=N},b.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(N){N.stopPropagation()}),e.default.i("[SkinStore] InviteSKin initView onLoad....."),this.initEvent(),this.initData(),this.hideShareToFriCircleForQQ()},b.prototype.hideShareToFriCircleForQQ=function(){v.default.isQQ()&&(this.save_image_btn.active=!1)},b.prototype.initEvent=function(){var N=this;this.mCloseBtnClickCallback=new d.default(function(){N.closeBtnClick()}),this.setTouchCb(this.close_btn,this.mCloseBtnClickCallback),this.mInviteFdsBtnClickCallback=new d.default(function(){N.inviteFdsBtnClick(),T.default.report(N.mSource,T.default.ACTION_CLICK_SHARE)}),this.setTouchCb(this.invite_fds_btn,this.mInviteFdsBtnClickCallback),this.mSaveImageBtnCallback=new d.default(function(){N.saveImageBtnClick(),T.default.report(N.mSource,T.default.ACTION_CLICK_SAVE)}),this.setTouchCb(this.save_image_btn,this.mSaveImageBtnCallback),this.mTryBtnCallback=new d.default(function(){N.clickTrySkin(),T.default.report(N.mSource,T.default.ACTION_CLICK_TRY)}),this.setTouchCb(this.try_btn,this.mTryBtnCallback)},b.prototype.setTouchCb=function(N,H){if(N&&H){var R=N instanceof cc.Component?N.node:N;R&&R.on(cc.Node.EventType.TOUCH_END,H.click,H)}},b.prototype.clickTrySkin=function(){var N=this,H=a.SkinDataMgr.Ins().getInviteSkin();H!=null?(console.log("[SkinStore] itemTrySkinCallback skin = "+H),h.default.trySkin(H,this.popup_layout.node,function(){},function(){},function(){c.G.skinTryData||(c.G.skinTryData=new p.default),c.G.skinTryData.source=N.mTrySource})):console.error("[InviteSkinStore] trySkin skin = null")},b.prototype.initData=function(){var N=this;e.default.i("[SkinStore] InviteSKin initData....."),u.ActivityRewardMgr.Ins().getInviteSuccessListComplete(t.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN,function(H){N.invitees=H,N.initView()})},b.prototype.initView=function(){var N=this;if(e.default.i("[SkinStore] InviteSKin initView this.invitees.",this.invitees),this.invitees&&0<this.invitees.length){var H=0;if(this.invitees.forEach(function(F){F.hd_id==t.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN&&F.is_new_player&&(++H==1&&(N.mask_layout1.node.active=!0,N.avatar_sprite1.node.width=108,N.avatar_sprite1.node.height=108,S.default.showUserAvatar(F.avatar_url,N.avatar_sprite1,!1)),H==2&&(N.mask_layout2.node.active=!0,N.avatar_sprite2.node.width=108,N.avatar_sprite2.node.height=108,S.default.showUserAvatar(F.avatar_url,N.avatar_sprite2,!1)),H==3&&(N.mask_layout3.node.active=!0,N.avatar_sprite3.node.width=108,N.avatar_sprite3.node.height=108,S.default.showUserAvatar(F.avatar_url,N.avatar_sprite3,!1))),e.default.i("[SkinStore] InviteSKin initView invitee = "+F)}),3<=H)this.invite_count_layout.node.active=!1,a.SkinDataMgr.Ins().unlockInviteSkin();else{this.invite_count_layout.node.active=!0;var R="/ui/skin_invite_num"+H;i.default.get2(R,this.invite_count_text)}a.SkinDataMgr.Ins().updateInviteSkinCount(3<H?3:H),this.newUserCount=3<H?3:H}e.default.i("[SkinStore] InviteSKin initView.....")},b.prototype.closeBtnClick=function(){this.invokeCloseCb(),this.mCloseCallback&&this.mCloseCallback()},b.prototype.inviteFdsBtnClick=function(){this.mInviteFdsCallback&&this.mInviteFdsCallback(),f.MGUser.getUserLoginInfo({complete:function(N){N&&y.MGShareUtils.shareForInviteSkin(N.playerId,t.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN,function(H){e.default.i("\u9080\u8BF7\u597D\u53CB\u5F97\u76AE\u80A4\u5361\u7247\u5206\u4EAB,result : "+H),g.default.fire(_.default.SHARE_HOME_SHOW_INVITE_TIPS)})}})},b.prototype.saveImageBtnClick=function(){this.isSaving||(this.isSaving=!0,this.mSaveImageCallback&&this.mSaveImageCallback(),this.shareQRCodeToFriendCircle(),this.isSaving=!1)},b.prototype.shareQRCodeToFriendCircle=function(){var N=this,H=new s.default;this.showGenerateToast(),H.getShraeQRCode(function(R){H.setShareImageFds(R),H.getShareImage(I.ShareImage.TYPE_SHARE_GIFT_FDS,function(F,x){N.hideGenerateToast(),F?(N.showSavingToast(),N.saveImgToAlbum(x,function(){N.hideSavingToast(),N.showSaveSuccessDialog()},function(){N.hideSavingToast(),N.showSavingFailToast()})):N.hideSavingToast()})},I.ShareImage.QRCODE_IMAGE_WIDHT,I.ShareImage.QRCODE_IMAGE_HEIGHT,t.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN)},b.prototype.saveImgToAlbum=function(N,H,R){n.WXHelper.saveTmpImgToAlbum(N,H,R)},b.prototype.showLoadingQRCodeFailToast=function(){var N=cc.instantiate(this.mToastPrefb);N.getComponent(r.default).showTips("\u4FDD\u5B58\u5931\u8D25\n\r\u8BF7\u8054\u7F51\u540E\u91CD\u8BD5!",function(){N.destroy()}),this.node.addChild(N)},b.prototype.showSavingFailToast=function(){var N=cc.instantiate(this.mToastPrefb);N.getComponent(r.default).showLoadFail(function(){N.destroy()}),this.node.addChild(N)},b.prototype.showGenerateToast=function(){var N=cc.instantiate(this.mToastPrefb);N.name="generateToast",N.getComponent(r.default).showLoading("\u6B63\u5728\u751F\u6210\u56FE\u7247"),this.node.addChild(N)},b.prototype.hideGenerateToast=function(){var N=this.node.getChildByName("generateToast");N&&N.destroy()},b.prototype.showSavingToast=function(){var N=cc.instantiate(this.mToastPrefb);N.name="savingToast",N.getComponent(r.default).showLoading("\u6B63\u5728\u4FDD\u5B58\u56FE\u7247"),this.node.addChild(N)},b.prototype.hideSavingToast=function(){var N=this.node.getChildByName("savingToast");N&&N.destroy()},b.prototype.showSaveSuccessDialog=function(){var N=cc.instantiate(this.mSaveToAlbumPrefb);N.getComponent(o.default).setTips(" \u5FEB\u53BB\u670B\u53CB\u5708\u5206\u4EAB\u5427!"),this.node.addChild(N)},b.prototype.start=function(){},b.skinName="ice",__decorate([k(cc.Layout)],b.prototype,"content_layout",void 0),__decorate([k(cc.Button)],b.prototype,"invite_fds_btn",void 0),__decorate([k(cc.Node)],b.prototype,"save_image_btn",void 0),__decorate([k(cc.Button)],b.prototype,"close_btn",void 0),__decorate([k(cc.Sprite)],b.prototype,"invite_count_text",void 0),__decorate([k(cc.Sprite)],b.prototype,"avatar_sprite1",void 0),__decorate([k(cc.Layout)],b.prototype,"mask_layout1",void 0),__decorate([k(cc.Sprite)],b.prototype,"avatar_sprite2",void 0),__decorate([k(cc.Layout)],b.prototype,"mask_layout2",void 0),__decorate([k(cc.Sprite)],b.prototype,"avatar_sprite3",void 0),__decorate([k(cc.Layout)],b.prototype,"mask_layout3",void 0),__decorate([k(cc.Layout)],b.prototype,"invite_count_layout",void 0),__decorate([k(cc.Button)],b.prototype,"try_btn",void 0),__decorate([k(cc.Prefab)],b.prototype,"mToastPrefb",void 0),__decorate([k(cc.Prefab)],b.prototype,"mSaveToAlbumPrefb",void 0),__decorate([k(cc.Layout)],b.prototype,"popup_layout",void 0),b=__decorate([M],b)}(C.default);m.default=D,cc._RF.pop()},{"../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../modules/MGAppShare/scripts/ShareImage":"ShareImage","../../../modules/MGAppShare/scripts/ShareImageUtils":"ShareImageUtils","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/G":"G","../../base/Log":"Log","../../infoc/m_p2_daily_activity":"m_p2_daily_activity","../../social/AvatarUtil":"AvatarUtil","../../social/WXHelper":"WXHelper","../../util/PU":"PU","../Logic/EventBus":"EventBus","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../UI/GameEntraScene/mainpage/MainpageBaseComponent":"MainpageBaseComponent","../UI/GameEntraScene/mainpage/WelfareController":"WelfareController","../gameover/SaveSuccessPrefab":"SaveSuccessPrefab","../reward/ActivityBean":"ActivityBean","../reward/ActivityRewardManager":"ActivityRewardManager","./SkinTryData":"SkinTryData","./SkinUtils":"SkinUtils"}],InviteTipsPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"c188d5hbXtHvLRurL0TNLbr","InviteTipsPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.title=null,i.content=null,i.bottomTips=null,i.confirmButton=null,i.closeBtn=null,i.confirmLabel=null,i.mConfirmClickCallback=null,i.mCloseClickCallback=null,i.mResolve=null,i.mCloseCallback=null,i}return __extends(t,n),t.prototype.onLoad=function(){var i=this;this.node.on(cc.Node.EventType.TOUCH_START,function(a){a.stopPropagation()}),this.confirmButton&&(this.mConfirmClickCallback=new d.default(function(){i.onTapConfirm()}),this.confirmButton.node.on(cc.Node.EventType.TOUCH_END,this.mConfirmClickCallback.click,this.mConfirmClickCallback)),this.closeBtn&&(this.mCloseClickCallback=new d.default(function(){i.onTapClose()}),this.closeBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback))},t.prototype.onTapClose=function(){this.mCloseCallback&&this.mCloseCallback()},t.prototype.onTapConfirm=function(){this.mResolve&&this.mResolve()},t.prototype.setTitle=function(i){this.title&&(this.title.string=i)},t.prototype.setContent=function(i){this.content&&(this.content.string=i)},t.prototype.setConfirmBtnContent=function(i){i&&(this.confirmLabel.string=i)},t.prototype.setBottomTips=function(i){this.bottomTips&&(this.bottomTips.string=i)},t.prototype.setConfirmCallback=function(i){this.mResolve=i},t.prototype.setCloseCallback=function(i){this.mCloseCallback=i},__decorate([o(cc.Label)],t.prototype,"title",void 0),__decorate([o(cc.Label)],t.prototype,"content",void 0),__decorate([o(cc.Label)],t.prototype,"bottomTips",void 0),__decorate([o(cc.Button)],t.prototype,"confirmButton",void 0),__decorate([o(cc.Button)],t.prototype,"closeBtn",void 0),__decorate([o(cc.Label)],t.prototype,"confirmLabel",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"./BasicTouchEvent":"BasicTouchEvent"}],InviteUnlockMusicCountdownUtil:[function(l,P,m){"use strict";cc._RF.push(P,"6ab9b5wNTpLZJfld+MmDtJW","InviteUnlockMusicCountdownUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../util/StringUtil"),s=l("../../../Logic/EventBus"),r=l("../../../Logic/NotifyEvent"),o=l("../../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=function(){function n(){this.mIsActivityOver=!1,this.mServerTime=o.MGUser.getCurrentServerTime(),this.initCountDownTime(this.mServerTime),cc.director.getScheduler().schedule(this.mCountdownTimeCallback,cc.director,1,cc.macro.REPEAT_FOREVER,0)}return n.Ins=function(){return this.sInstance==null&&(this.sInstance=new n),this.sInstance},n.prototype.updateServerTime=function(){this.mServerTime=o.MGUser.getCurrentServerTime(),s.default.fire(r.default.UPDATE_MUSIC_LIST_CURRENT_TIME,this.mServerTime)},n.prototype.getActivityCountdownTime=function(){return this.mIsActivityOver},n.prototype.getCountdownTimeFormat=function(){return this.mFormatTimeStr},n.prototype.isBeyondActivityDeadline=function(t){return!d.StringUtil.isEmpty(t)&&parseInt(t)<this.mServerTime},n.prototype.getCurrentTime=function(){return this.mServerTime},n.prototype.initCountDownTime=function(t){var i,a,u,c,p=this,h=t-this.mServerTime,f=parseInt(h/864e5+""),g=parseInt(h%864e5/36e5+""),_=parseInt(h%36e5/6e4+""),y=parseInt(h%6e4/1e3+"");this.mCountdownTimeCallback=function(){--y<0&&(y=59,--_<0&&(_=59,--g<0&&(g=23,f--))),f==0&&g==0&&_==0&&y==0&&(p.mIsActivityOver=!0,p.stopCountdown()),i=f<10?"0"+f:f,a=g<10?"0"+g:g,u=_<10?"0"+_:_,c=y<10?"0"+y:y,p.mFormatTimeStr=i+"\u5929"+a+"\u65F6"+u+"\u5206"+c+"\u79D2",p.mServerTime++}},n.prototype.stopCountdown=function(){cc.director.getScheduler().unschedule(this.mCountdownTimeCallback,this)},n.sInstance=null,n}();m.default=e,cc._RF.pop()},{"../../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../../util/StringUtil":"StringUtil","../../../Logic/EventBus":"EventBus","../../../Logic/NotifyEvent":"NotifyEvent"}],KeyNode:[function(l,P,m){"use strict";cc._RF.push(P,"16ec3U5tpZOkbH1jdj05o22","KeyNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../MUI/MUISprite"),s=l("../loader/KeypadFrameLoader"),r=l("../../MUI/MUINode"),o=function(n){function t(i){i===void 0&&(i=null);var a=n.call(this,i)||this;return a.imageData=s.default.getInstance().getAtlas(),console.error(a.imageData),a.imageItem=s.default.getInstance().getKeyImageItem(i),a.setContentSize(a.imageItem.rect.width,a.imageItem.rect.height),a.setPosition(-a.imageItem.rect.width/2,-a.imageItem.rect.height/2),a}return __extends(t,n),t}(d.default),e=function(n){function t(i){i===void 0&&(i=null);var a=n.call(this,"key_"+i)||this;return a.touch=void 0,a.keyI=void 0,a.keyP=void 0,a.keyE=void 0,a.setContentSize(1,1),a.setScale(1.5,1.5),i!="d"&&i!="f"&&i!="j"&&i!="k"?console.error("Unsupported name => "+i):(a.touch=new o("touch"),a.touch.setVisible(!1),a.addChild(a.touch),a.keyI=new o(i+"_white"),a.keyI.setVisible(!0),a.addChild(a.keyI),a.keyP=new o(i+"_green"),a.keyP.setVisible(!1),a.addChild(a.keyP),a.keyE=new o(i+"_red"),a.keyE.setVisible(!1),a.addChild(a.keyE)),a}return __extends(t,n),t.prototype.onPressed=function(){this.touch.setVisible(!0),this.keyI.setVisible(!1),this.keyP.setVisible(!0),this.keyE.setVisible(!1)},t.prototype.onReleased=function(){this.touch.setVisible(!1),this.keyI.setVisible(!0),this.keyP.setVisible(!1),this.keyE.setVisible(!1)},t}(r.default);m.default=e,cc._RF.pop()},{"../../MUI/MUINode":"MUINode","../../MUI/MUISprite":"MUISprite","../loader/KeypadFrameLoader":"KeypadFrameLoader"}],KeyTouchLine:[function(l,P,m){"use strict";cc._RF.push(P,"396ecYPslpOxp/8d1dV1yut","KeyTouchLine"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/G"),s=l("../../MUI/MUILine"),r=l("../../data/CMTouchEvent"),o=l("../../MUI/MUIDefines"),e=l("./KeyNode"),n=l("../../../business/keypad/KeypadNavigator"),t=function(i){function a(u){var c=i.call(this,u)||this;c.rootNode=void 0,c.keyMap={},c.keyPos={},c.mCMTouchEvent=void 0,c.ratio=0,c.touchBuffer=null,c.keyNodes={},c.ratio=cc.view.getDevicePixelRatio(),c.updateLines(d.G.Ap.config.presentScale),c.setColor(new cc.Color(255,255,255,255)),n.default.getInstance().addKeyDownCB(c.onKeyDown.bind(c)),n.default.getInstance().addKeyUpCB(c.onKeyUp.bind(c)),c.rootNode=cc.find("Canvas"),c.mCMTouchEvent=new r.CMTouchEvent,c.keyNodes={};var p=r.CMTouchID.D;return c.keyNodes[p]=new e.default("d"),c.keyNodes[p].setPosition(c.keyPos[p].x,c.keyPos[p].y),c.addChild(c.keyNodes[p]),p=r.CMTouchID.F,c.keyNodes[p]=new e.default("f"),c.keyNodes[p].setPosition(c.keyPos[p].x,c.keyPos[p].y),c.addChild(c.keyNodes[p]),p=r.CMTouchID.J,c.keyNodes[p]=new e.default("j"),c.keyNodes[p].setPosition(c.keyPos[p].x,c.keyPos[p].y),c.addChild(c.keyNodes[p]),p=r.CMTouchID.K,c.keyNodes[p]=new e.default("k"),c.keyNodes[p].setPosition(c.keyPos[p].x,c.keyPos[p].y),c.addChild(c.keyNodes[p]),c}return __extends(a,i),a.prototype.removeFromParent=function(){i.prototype.removeFromParent.call(this),n.default.getInstance().removeKeyDownCB(this.onKeyDown.bind(this)),n.default.getInstance().removeKeyUpCB(this.onKeyUp.bind(this))},a.prototype.draw=function(u,c){i.prototype.draw.call(this,u,c);var p=o.MUI.global.renderType===o.MUI.RenderType.WEBGL,h=this.mCMTouchEvent.getPressedEvents();switch(o.MUI.global.renderType){case o.MUI.RenderType.WEBGL:h.length;break;case o.MUI.RenderType.CANVAS:var f=u;f.fillStyle="red",f.beginPath();for(var g=0;g<h.length;g++){var _=h[g].x*d.G.Ap.config.presentScale,y=0;y=p?h[g].y*d.G.Ap.config.presentScale:(d.G.Ap.config.presentHeight-h[g].y)*d.G.Ap.config.presentScale,f.arc(_,y,10*this.ratio,0,2*Math.PI,!1)}f.closePath(),f.fill()}},a.prototype.updateLines=function(u){var c=o.MUI.global.renderType===o.MUI.RenderType.WEBGL,p=d.G.Ap.config.presentWidth*d.G.Ap.config.presentScale,h=Math.round(d.G.Ap.config.presentHeight*(c?.28:.72)*d.G.Ap.config.presentScale),f=[];f.push(new cc.Vec2(0,h)),f.push(new cc.Vec2(p,h)),this.setLine(f);var g=.25*d.G.Ap.config.presentWidth,_=.28*d.G.Ap.config.presentHeight;this.keyPos[r.CMTouchID.D]={x:Math.round(.5*g),y:_},this.keyPos[r.CMTouchID.F]={x:Math.round(1.5*g),y:_},this.keyPos[r.CMTouchID.J]={x:Math.round(2.5*g),y:_},this.keyPos[r.CMTouchID.K]={x:Math.round(3.5*g),y:_}},a.prototype.emitTouch=function(u,c){var p=this.keyPos[u];c==0?(this.mCMTouchEvent.update(u,r.CMState.PRESSED,p.x,p.y),this.rootNode.emit("cm_touchstart",this.mCMTouchEvent.getPressedEvents()),this.keyNodes[u].setPosition(p.x,p.y),this.keyNodes[u].onPressed()):c==2&&(this.mCMTouchEvent.update(u,r.CMState.RELEASED,p.x,p.y),this.rootNode.emit("cm_touchend",this.mCMTouchEvent.getReleasedEvents()),this.mCMTouchEvent.update(u,r.CMState.IDLE,p.x,p.y),this.keyNodes[u].onReleased())},a.prototype.onKeyDown=function(u){var c=this.keyMap[u.keyCode]==1?1:0;switch(this.keyMap[u.keyCode]=1,u.keyCode){case 68:this.emitTouch(r.CMTouchID.D,c);break;case 70:this.emitTouch(r.CMTouchID.F,c);break;case 74:this.emitTouch(r.CMTouchID.J,c);break;case 75:this.emitTouch(r.CMTouchID.K,c)}},a.prototype.onKeyUp=function(u){switch(this.keyMap[u.keyCode]=0,u.keyCode){case 68:this.emitTouch(r.CMTouchID.D,2);break;case 70:this.emitTouch(r.CMTouchID.F,2);break;case 74:this.emitTouch(r.CMTouchID.J,2);break;case 75:this.emitTouch(r.CMTouchID.K,2)}},a}(s.default);m.default=t,cc._RF.pop()},{"../../../base/G":"G","../../../business/keypad/KeypadNavigator":"KeypadNavigator","../../MUI/MUIDefines":"MUIDefines","../../MUI/MUILine":"MUILine","../../data/CMTouchEvent":"CMTouchEvent","./KeyNode":"KeyNode"}],KeyValuePair:[function(l,P,m){"use strict";cc._RF.push(P,"675acqOxYFGNYkMYRI+jQI6","KeyValuePair"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r,o){this._key=r,this._value=o}return Object.defineProperty(s.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),s.prototype.toString=function(){return"["+(this._key||"")+", "+(this._value||"")+"]"},s}();m.KeyValuePair=d,cc._RF.pop()},{}],KeypadFocusedUI:[function(l,P,m){"use strict";cc._RF.push(P,"657acnSs31Djrx4Xu6UcX/2","KeypadFocusedUI"),Object.defineProperty(m,"__esModule",{value:!0});var d="_focus_block_",s=function(){function r(){var o=this;this.focusBlockPrefab=void 0,cc.loader.loadRes("prefab/keypad/FocusBlock",cc.Prefab,function(e,n){n&&(console.error("KeypadFocusedUI:: => FocusBlock Prefab Ready"),o.focusBlockPrefab=n)})}return r.getInstance=function(){return r.mInstance||(r.mInstance=new r),r.mInstance},r.prototype.hideFocusEffect=function(){var o=cc.find("NavigatorNode");if(o){var e=o.getChildByName(d);e&&e.removeFromParent()}},r.prototype.showFocusEffect=function(o){this.showFocusEffectWithRetry(o,3)},r.prototype.showFocusEffectWithRetry=function(o,e){var n=this;if(o&&o.isValid){if(!this.focusBlockPrefab)return console.error("KeypadFocusedUI::showFocusEffect => Missing FocusBlock"),void(1<=e&&setTimeout(function(){n.showFocusEffectWithRetry(o,e-1)},500));var t=cc.find("NavigatorNode");if(t){var i=t.getChildByName(d);i&&i.removeFromParent();var a=o.getBoundingBoxToWorld(),u=t.convertToNodeSpaceAR(a.center),c=cc.instantiate(this.focusBlockPrefab);c.name=d,c.width=Math.round(a.width+32),c.height=Math.round(a.height+32),c.x=Math.round(u.x),c.y=Math.round(u.y),t.addChild(c),console.error("KeypadFocusedUI::showFocusEffect => "+o.name+" ("+Math.round(a.x)+", "+Math.round(a.y)+")")}else console.error("KeypadFocusedUI::showFocusEffect => Missing Canvas")}},r.mInstance=void 0,r}();m.KeypadFocusedUI=s,cc._RF.pop()},{}],KeypadFrameLoader:[function(l,P,m){"use strict";cc._RF.push(P,"bdf95X3IzVDBLFLNC2h3uht","KeypadFrameLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../atlas/SimpleAtlas"),s=function(){function r(){this.mAtlas=null,this.mInit=!1,this.mAtlas=new d.default}return r.getInstance=function(){return r.sInstance==null&&(r.sInstance=new r),r.sInstance},r.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return this.mInit?[2]:(this.mInit=!0,[4,this.mAtlas.load("gameImage/keypad")]);case 1:return o.sent(),[2]}})})},r.prototype.getAtlas=function(){return this.mAtlas},r.prototype.getKeyImageItem=function(o){return this.mAtlas.getItem(o)},r.sInstance=null,r}();m.default=s,cc._RF.pop()},{"../../atlas/SimpleAtlas":"SimpleAtlas"}],KeypadNavigatorBase:[function(l,P,m){"use strict";cc._RF.push(P,"49a2bO6e25Ar7YB42oRuB4L","KeypadNavigatorBase"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("./KeypadFocusedUI"),o=l("./KeypadUtil"),e=l("../UI/GameEntraScene/MusicLib/NormalMusicCardItemPrefb"),n=l("../UI/GameEntraScene/MusicLib/LevelMusicListCtrl"),t=l("../UI/GameEntraScene/MusicLib/HotMusicListCtrl"),i=l("../UI/GameEntraScene/MusicLib/HotMusicCardItemPrefb"),a=l("../Logic/MoneySystem"),u=function(S,I){return Math.sqrt(Math.pow(Math.abs(S.x-I.x),2)+Math.pow(Math.abs(S.y-I.y),2))},c=function(S,I){return Math.abs(S.y-I.y)<=12},p=function(S,I){return Math.abs(S.x-I.x)<=12},h=function(S){return!(!S.active||!S.activeInHierarchy)};(s=d||(d={}))[s.PUSH_DIALOG=0]="PUSH_DIALOG",s[s.GOTO_SCENE=1]="GOTO_SCENE",s[s.POP_DIALOG=2]="POP_DIALOG",s[s.REFRESH=3]="REFRESH";var f=console.error,g=console.warn,_=function(S){return S&&S.preventDefault?S.preventDefault():window.event.returnValue=!1,!1},y=function(){function S(){var I=this;this.isHorizontalMode=!1,this.mPageStack=[],this.currPageName=void 0,this.currPageData=void 0,this.currPageNode=void 0,this.currFocusParent=void 0,this.currFocusNode=void 0,this.currFocusIndex=void 0,this.mTaskList=[],this.mCurrTask=void 0,this.mIsDebugMode=!0,this.mKeyDownCB=[],this.mKeyUpCB=[],this.mDispatchEventFunc=void 0,this.lastPageTime=0,this.lastPageName="",this.lastPageAction=void 0,this.mIsDebugMode=CMPlay.getQueryString("_cm_debug_","false")=="true",this.isHorizontalMode=o.default.isHorizon(),this.isHorizontalMode&&(cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDownSys,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUpSys,this),r.KeypadFocusedUI.getInstance(),window.document.body.onkeydown=function(v){I.onKeyDownBody(v),_(v)},window.document.body.onkeyup=function(v){I.onKeyUpBody(v),_(v)})}return S.prototype.addKeyDownCB=function(I){this.mKeyDownCB.indexOf(I)==-1&&this.mKeyDownCB.push(I)},S.prototype.removeKeyDownCB=function(I){var v=this.mKeyDownCB.indexOf(I);v!=-1&&this.mKeyDownCB.splice(v,1)},S.prototype.addKeyUpCB=function(I){this.mKeyUpCB.indexOf(I)==-1&&this.mKeyUpCB.push(I)},S.prototype.removeKeyUpCB=function(I){var v=this.mKeyUpCB.indexOf(I);v!=-1&&this.mKeyUpCB.splice(v,1)},S.prototype.setDispatchEventFunc=function(I){this.mDispatchEventFunc=I},S.prototype.pushDialog=function(I,v){if(v===void 0&&(v=void 0),this.isHorizontalMode){var C=v||I.name;g("KeypadNavigator::pushDialog => "+C),this.handlePage(I,C,d.PUSH_DIALOG)}},S.prototype.popDialog=function(I,v){if(v===void 0&&(v=void 0),this.isHorizontalMode){var C=v||I.name;g("KeypadNavigator::popDialog => "+C),this.handlePage(I,C,d.POP_DIALOG)}},S.prototype.gotoPage=function(I,v,C){if(v===void 0&&(v=void 0),C===void 0&&(C=""),this.isHorizontalMode){var T=v||I.name;g("KeypadNavigator::gotoPage => "+T+C?"from tag["+C+"]":""),this.handlePage(I,T,d.GOTO_SCENE)}},S.prototype.refreshPage=function(I,v,C){if(v===void 0&&(v=void 0),C===void 0&&(C=void 0),this.isHorizontalMode){var T=v||I.name;g("KeypadNavigator::refreshPage => "+T),this.handlePage(I,T,d.REFRESH,C)}},S.prototype.handlePage=function(I,v,C,T){v===void 0&&(v=void 0),T===void 0&&(T=void 0);var E=new Date().getTime();this.lastPageName==v&&this.lastPageAction==C&&Math.abs(E-this.lastPageTime)<500?f("KeypadNavigator::handlePage => "+v+" ERROR: skip for duplicate"):(this.lastPageAction=C,this.lastPageName=v,this.lastPageTime=E,this.mTaskList.push({node:I,action:C,name:v,callback:T}),this.processPageTask())},S.prototype.processPageTask=function(){var I=this;if(!(this.mTaskList.length<=0)&&!this.mCurrTask&&(this.mCurrTask=this.mTaskList.shift(),this.mCurrTask)){var v=this.mCurrTask.callback;this.processPageItem(this.mCurrTask.node,this.mCurrTask.action,this.mCurrTask.name,function(){I.mCurrTask=void 0,I.processPageTask(),v&&v()})}},S.prototype.processPageItem=function(I,v,C,T){var E=this;if(C===void 0&&(C=void 0),v==d.REFRESH)if(this.currPageName!=C)g("KeypadNavigator::processPageItem => REFRESH # name:"+C+" => SKIP for currPage:"+this.currPageName),T&&T();else{g("KeypadNavigator::processPageItem => REFRESH # name:"+C),this.hideFocusEffect();var A=this.currPageNode,M=this.currFocusParent,k=this.currFocusNode,D=this.currFocusIndex;this._updateCurrPage(function(){var N=E.getLatestNode(A,M,k,D)||E.goFirstNode();N&&E.focusNode(N),T&&T()})}else if(v==d.POP_DIALOG){if(this.currPageName!=C)g("KeypadNavigator::processPageItem => POP_DIALOG # name:"+C+" => SKIP for currPage:"+this.currPageName);else{g("KeypadNavigator::processPageItem => POP_DIALOG # name:"+C),this.hideFocusEffect();var L=this.mPageStack.pop();L?(g("POP => name:"+L.name),this.currPageName=L.name,this.currPageData=L.data,this.focusNode({candidate:L.node,focusParent:L.focusParent,focusNode:L.focusNode,focusIndex:L.focusIndex})):(this.currPageName=void 0,this.currPageData=void 0,this.currPageNode=void 0,this.currFocusParent=void 0,this.currFocusNode=void 0,this.currFocusIndex=void 0,g("POP => WARN: NO MORE PAGE FOUND!!!"))}T&&T()}else{this.hideFocusEffect(),v==d.PUSH_DIALOG?(g("KeypadNavigator::processPageItem => PUSH_DIALOG # name:"+C),g("PUSH => name:"+this.currPageName),this.mPageStack.push({name:this.currPageName,data:this.currPageData,node:this.currPageNode,focusParent:this.currFocusParent,focusNode:this.currFocusNode,focusIndex:this.currFocusIndex})):(g("KeypadNavigator::processPageItem => GOTO_SCENE # name:"+C),this.mPageStack=[]);var b=function(){this.goFirstNode(),T&&T()}.bind(this);this._processPageItem(I,v,C,b)}},S.prototype.isNodeExists=function(I){if(this.currPageData&&this.currPageData.buttons){for(var v=this.currPageData.buttons,C=v.length,T=0;T<C;T++)if(v[T].name==I)return!0}return!1},S.prototype._processPageItem=function(I,v,C,T){var E=this.getPageMap(C);if(!E)return f("KeypadNavigator::processTaskItem => Unsupport page: "+C),this.currPageName=void 0,this.currPageData=void 0,this.currPageNode=void 0,void(T&&T());f("KeypadNavigator::processTaskItem => BEGIN: "+C),this.currPageName=C,this.currPageData=E,this.currPageData.rootNode=I,this.currPageData.action=v,this._updateCurrPage(T)},S.prototype._updateCurrPage=function(I){var v=this.currPageData.rootNode,C=this.currPageName;this.currPageData.buttons=[],this.currPageNode=void 0;var T=this.currPageData.nameList,E=this.currPageData.multiList,A=function(){var M=[];this.findAllNodeByComponent(v,T,E,M);for(var k=0;k<T.length;k++)for(var D=0;D<M.length;D++)if((b=M[D]).name==T[k]&&h(b)){var L=this.getNodeVec(b);this.mIsDebugMode&&g("Found node => "+b.name+" ("+Math.round(L.x)+", "+Math.round(L.y)+")"),this.currPageData.buttons.push(b)}for(D=0;E&&D<M.length;D++){var b;h(b=M[D])&&E.indexOf(b.name)!=-1&&(L=this.getNodeVec(b),this.mIsDebugMode&&g("Found multi node => "+b.name+" ("+Math.round(L.x)+", "+Math.round(L.y)+")"),this.currPageData.buttons.push(b))}f("KeypadNavigator::processTaskItem => count("+this.currPageData.buttons.length+") END: "+C),I&&I()}.bind(this);0<this.currPageData.delayMS?setTimeout(A,this.currPageData.delayMS):A()},S.prototype.findAllNodeByComponent=function(I,v,C,T){for(var E=I&&I.children?I.children:[],A=0;A<E.length;A++){var M=E[A];M.name!=""&&(this.currPageName=="MainPagePrefab"&&M.name=="start_btn"?M.parent.name=="entra_middle_mainpage"&&v.indexOf(M.name)!=-1&&(this.mIsDebugMode&&g("push => "+M.name),T.push(M)):v.indexOf(M.name)!=-1?(this.mIsDebugMode&&f("push => "+M.name),T.push(M)):C&&C.indexOf(M.name)!=-1&&(this.mIsDebugMode&&f("push => "+M.name),T.push(M))),M.children&&0<M.children.length&&this.findAllNodeByComponent(M,v,C,T)}},S.prototype.findFirstChildByName=function(I,v){for(var C=I&&I.children?I.children:[],T=0;T<C.length;T++){var E=C[T];if(E&&E.name!=""&&v.indexOf(E.name)!=-1&&h(E))return E;if(E.children&&0<E.children.length){var A=this.findFirstChildByName(E,v);if(A!=null)return A}}},S.prototype.findGroupChildNode=function(I,v){if(v.parent)return v.parent==I?v:this.findGroupChildNode(I,v.parent)},S.prototype.focusNode=function(I){I&&I.candidate&&I.focusNode&&(this.currPageNode=I.candidate,this.currFocusNode=I.focusNode,this.currFocusIndex=I.focusIndex||0,this.currFocusParent=I.focusParent||I.focusNode,this._focusNode_(I.delayMS))},S.prototype._focusNode_=function(I){try{var v=this.currFocusNode;v&&v instanceof cc.Node&&(I&&0<I?(r.KeypadFocusedUI.getInstance().hideFocusEffect(),setTimeout(function(){r.KeypadFocusedUI.getInstance().showFocusEffect(v)},I)):r.KeypadFocusedUI.getInstance().showFocusEffect(v),this.currPageNode&&this.currPageNode!=v?console.warn("_focusNode_ => "+v.name+"("+this.currPageNode.name+")"):console.warn("_focusNode_ => "+v.name))}catch(C){console.error("_focusNode_ => "+C.message)}},S.prototype.hideFocusEffect=function(){this.isHorizontalMode&&r.KeypadFocusedUI.getInstance().hideFocusEffect()},S.prototype.onKeyDownSys=function(I){this.onKeyDown(I)},S.prototype.onKeyUpSys=function(I){this.onKeyUp(I)},S.prototype.onKeyDownBody=function(I){this.onKeyDown(I)},S.prototype.onKeyUpBody=function(I){this.onKeyUp(I)},S.prototype.onKeyUp=function(I){for(var v=this.mKeyUpCB,C=0;C<v.length;C++)v[C](I)},S.prototype.onKeyDown=function(I){for(var v=this.mKeyDownCB,C=0;C<v.length;C++)v[C](I);try{if(this.mDispatchEventFunc&&this.mDispatchEventFunc(I))return}catch(T){console.error("KeypadNavigator => A ERROR: "+JSON.stringify(T.stack))}try{switch(I.keyCode){case 27:this.onPressBack();break;case 9:this.onPressTab();break;case 37:this.onPressLeft();break;case 38:this.onPressUp();break;case 39:this.onPressRight();break;case 40:this.onPressDown();break;case 13:this.onPressEnter();break;case 32:this.onPressSpace();break;case 123:this.mIsDebugMode&&a.MoneySystem.increaseDiamond(100)}}catch(T){console.error("KeypadNavigator => B ERROR: "+JSON.stringify(T.stack))}},S.prototype.isNodeFocus=function(){return this.currPageNode!=null},S.prototype.emitTouchEnd=function(){var I=this.currFocusNode||this.currPageNode;I instanceof cc.Node&&(f("emitTouchEnd => node: "+I.name),I.emit(cc.Node.EventType.TOUCH_END))},S.prototype.goFirstNode=function(){var I=this.getFirstNode();I&&this.focusNode(I)},S.prototype.getLatestNode=function(I,v,C,T){for(var E=this.currPageData.buttons,A=E.length,M=void 0,k=0;k<A;k++)if(h(E[k])&&E[k]==I){M=E[k];break}var D=M&&M.getComponent(cc.ScrollView);if(D){var L=D.content.children;if(M.name=="StoreSkinScrollView")for(this.mIsDebugMode&&f("getLatestNode => StoreSkinScrollView"),k=0;k<L.length;k++){var b=L[k];if(console.error("node.name="+b.name+", focusParent.name="+v.name+", VALID_NODE="+h(b)),b&&b==v&&h(b)){var N=this.findFirstChildByName(b,[C.name]);N=N||this.findFirstChildByName(b,this.currPageData.wildList)||b;var H=1-k*b.height/D.content.height*.7;return D.scrollToPercentVertical(H,.12),{candidate:M,focusParent:v,focusNode:N,focusIndex:T,delayMS:150}}}else if(M.name=="LevelMusicScrollView"||M.name=="HotMusicScrollView"){this.mIsDebugMode&&f("getLatestNode => "+M.name);var R=M.name=="LevelMusicScrollView",F=(R?M.parent.getComponent(n.default):M.parent.getComponent(t.default)).getTotalCount();for(k=0;k<L.length;k++){b=L[k];var x=this.getNodeRealIndex(b);if(this.mIsDebugMode&&f("getLatestNode => ["+k+"] index="+x+" focusIndex="+T),b&&x==T&&h(b)){var U=this.findFirstChildByName(b,[C.name]);return(U=U||this.findFirstChildByName(b,this.currPageData.wildList))?(H=Math.max((x-2)/(F-(R?3:4)),0),D.scrollToPercentVertical(1-H,.12),this.mIsDebugMode&&f("getDownNode => FOUND index:"+x+" total:"+F),{candidate:M,focusParent:v,focusNode:U,focusIndex:T,delayMS:150}):(this.mIsDebugMode&&f("getDownNode => FOUND ERROR"),{candidate:M,focusParent:v,focusNode:C,focusIndex:T})}}}}if(M)return{candidate:M,focusNode:M}},S.prototype.getFirstNode=function(){if(this.currPageData&&this.currPageData.buttons){for(var I,v=this.currPageData.firstName,C=this.currPageData.buttons,T=C.length,E=void 0,A=0;A<T;A++)if(h(C[A])){if(v instanceof Array){if(v.indexOf(C[A].name)!=-1){E=C[A];break}}else if(v==C[A].name){E=C[A];break}}!E&&0<T&&(E=C[0]);var M=E&&E.getComponent(cc.ScrollView);if(M){var k=0,D=M.content.childrenCount;if(0<D){if(M.vertical){this.mIsDebugMode&&f("getFirstNode => candidate Vertical List");var L=(k=D-1)/D,b=new cc.Vec2(0,L);3<D&&M.scrollTo(b)}else this.mIsDebugMode&&f("getFirstNode => candidate Horizontal List"),L=k/D,b=new cc.Vec2(L,0),3<D&&M.scrollTo(b);return{candidate:E,focusParent:I=M.content.children[k],focusNode:this.findFirstChildByName(I,this.currPageData.wildList)||I,focusIndex:k}}}if(E)return{candidate:E,focusNode:E}}},S.prototype.getBackNode=function(){if(this.currPageData&&this.currPageData.buttons){var I=void 0,v=this.currPageData.backName;if(this.currPageData&&v){for(var C=this.currPageData.buttons,T=0;T<C.length;T++)if(v instanceof Array){if(v.indexOf(C[T].name)!=-1){I=C[T];break}}else if(v==C[T].name){I=C[T];break}}if(I)return{candidate:I,focusNode:I}}},S.prototype.getNextNode=function(){if(this.currPageData&&this.currPageData.buttons){if(!this.currPageNode)return this.getFirstNode();for(var I,v=void 0,C=this.currPageData.buttons,T=C.length,E=0;E<T;E++){if(this.currPageNode==C[E])for(var A=1;A<T;A++){var M=(E+A)%T;if(h(C[M])){v=C[M];break}}if(v)break}var k=v&&v.getComponent(cc.ScrollView);if(k){var D=0,L=k.content.childrenCount;if(0<L){if(k.vertical){this.mIsDebugMode&&f("getNextNode => candidate Vertical List");var b=(D=L-1)/L,N=new cc.Vec2(0,b);3<L&&k.scrollTo(N)}else this.mIsDebugMode&&f("getNextNode => candidate Horizontal List"),b=D/L,N=new cc.Vec2(b,0),3<L&&k.scrollTo(N);return{candidate:v,focusParent:I=k.content.children[D],focusNode:this.findFirstChildByName(I,this.currPageData.wildList)||I,focusIndex:D}}}if(v)return{candidate:v,focusNode:v}}},S.prototype.getLeftNode=function(){if(this.currPageData&&this.currPageData.buttons){if(!this.currPageNode)return this.getFirstNode();var I=this.currPageNode&&this.currPageNode.getComponent(cc.ScrollView);if(this.mIsDebugMode&&f("getLeftNode => currPageNode.name="+this.currPageNode.name),I){this.mIsDebugMode&&f("getLeftNode => "+this.currPageNode.name);var v=this.currFocusParent,C=this.currFocusNode,T=this.currFocusIndex,E=I.content.children;if(this.currPageNode.name=="StoreSkinScrollView"){if(C.name=="gain_btn"&&v){var A=this.findFirstChildByName(v,["try_btn"])||C;return{candidate:this.currPageNode,focusParent:v,focusNode:A,focusIndex:T}}if(0<=T&&T<E.length-1){for(var M=this.getNodeVec(C),k=0;k<E.length;k++)if((R=E[k])&&k!=T&&h(R)&&(F=this.getNodeVec(R)).x<M.x&&c(M,F)&&!p(M,F)){var D=["gain_btn","use_btn"];return A=this.findFirstChildByName(R,D)||R,{candidate:this.currPageNode,focusParent:R,focusNode:A,focusIndex:k}}}}else if((this.currPageNode.name=="LevelMusicScrollView"||this.currPageNode.name=="HotMusicScrollView")&&v){var L=(D=this.currPageData.wildList.concat([])).indexOf(C.name);return-1<L&&D.splice(L,1),A=this.findFirstChildByName(v,D)||C,{candidate:this.currPageNode,focusParent:v,focusNode:A,focusIndex:T}}}var b=this.getNodeVec(this.currPageNode),N=this.currPageData.buttons,H=void 0;for(k=0;k<N.length;k++){var R,F;if((R=N[k])&&R!=this.currPageNode&&h(R)&&(F=this.getNodeVec(R)).x<b.x&&c(b,F))if(H==null)H=R;else{var x=this.getNodeVec(H);u(F,b)<u(x,b)&&(H=R)}}if(H)return{candidate:H,focusNode:H}}},S.prototype.getRightNode=function(){if(this.currPageData&&this.currPageData.buttons){if(!this.currPageNode)return this.getFirstNode();var I=this.currPageNode&&this.currPageNode.getComponent(cc.ScrollView);if(I){var v=I.content.children;if(this.mIsDebugMode&&f("getRightNode => "+this.currPageNode.name),this.currPageNode.name=="StoreSkinScrollView"){if(this.currFocusNode.name=="try_btn"&&0<=this.currFocusIndex){var C=v[A=this.currFocusIndex],T=this.findFirstChildByName(C,["gain_btn"])||C;return{candidate:this.currPageNode,focusParent:C,focusNode:T,focusIndex:A}}if(0<=this.currFocusIndex&&this.currFocusIndex<v.length-1){for(var E=this.getNodeVec(this.currFocusNode),A=0;A<v.length;A++)if((C=v[A])&&A!=this.currFocusIndex&&h(C)&&(F=this.getNodeVec(C)).x>E.x&&c(E,F)&&!p(E,F))return T=this.findFirstChildByName(C,this.currPageData.wildList)||C,{candidate:this.currPageNode,focusParent:C,focusNode:T,focusIndex:A}}}else if(this.currPageNode.name=="LevelMusicScrollView"||this.currPageNode.name=="HotMusicScrollView"){var M=this.currFocusParent;if(M){var k=this.currFocusIndex,D=this.currFocusNode,L=this.currPageData.wildList.concat([]),b=L.indexOf(D.name);return-1<b&&L.splice(b,1),T=this.findFirstChildByName(M,L)||D,{candidate:this.currPageNode,focusParent:M,focusNode:T,focusIndex:k}}}}var N=this.getNodeVec(this.currPageNode),H=this.currPageData.buttons,R=void 0;for(A=0;A<H.length;A++){var F;if((C=H[A])&&C!=this.currPageNode&&h(C)&&(F=this.getNodeVec(C)).x>N.x&&c(N,F))if(R==null)R=C;else{var x=this.getNodeVec(R);u(F,N)<u(x,N)&&(R=C)}}if(R)return{candidate:R,focusNode:R}}},S.prototype.getDownNode=function(I){var v=this;if(I===void 0&&(I=void 0),this.currPageData&&this.currPageData.buttons){if(!this.currPageNode)return this.getFirstNode();var C,T,E=this.currPageNode,A=this.currFocusIndex,M=this.currFocusParent,k=this.currFocusNode,D=E&&E.getComponent(cc.ScrollView);if(D){var L=D.content.children;if(E.name=="StoreSkinScrollView"){this.mIsDebugMode&&f("getDownNode => StoreSkinScrollView");for(var b=this.getNodeVec(k),N=k.name,H=0;H<L.length;H++)if((Q=L[H])&&H!=this.currFocusIndex&&h(Q)&&(T=(T=this.findFirstChildByName(Q,[N]))||this.findFirstChildByName(Q,this.currPageData.wildList)||Q,(Y=this.getNodeVec(T)).y<b.y&&!c(b,Y)&&p(b,Y))){var R=1-H*Q.height/D.content.height*.7;return D.scrollToPercentVertical(R,.12),{candidate:E,focusParent:Q,focusNode:T,focusIndex:H,delayMS:150}}return{candidate:E,focusParent:M,focusNode:k,focusIndex:A}}if(E.name=="LevelMusicScrollView"||E.name=="HotMusicScrollView"){this.mIsDebugMode&&f("getDownNode => "+E.name),N=k.name;var F=this.currFocusIndex,x=F+1,U=E.name=="LevelMusicScrollView",B=(U?E.parent.getComponent(n.default):E.parent.getComponent(t.default)).getTotalCount();for(H=0;H<L.length;H++){var Q=L[H],Z=this.getNodeRealIndex(Q);if(this.mIsDebugMode&&f("getDownNode => ["+H+"] index="+Z+" targetIndex="+x+" focusIndex="+F),Q&&Z==x&&h(Q))return(T=(T=this.findFirstChildByName(Q,[N]))||this.findFirstChildByName(Q,this.currPageData.wildList))?(R=Math.max((Z-2)/(B-(U?3:4)),0),D.scrollToPercentVertical(1-R,.12),this.mIsDebugMode&&f("getDownNode => FOUND index:"+Z+" total:"+B),{candidate:E,focusParent:Q,focusNode:T,focusIndex:Z,delayMS:150}):(this.mIsDebugMode&&f("getDownNode => FOUND ERROR"),{candidate:E,focusParent:this.currFocusParent,focusNode:k,focusIndex:this.currFocusIndex})}}}var z=this.getNodeVec(E),W=this.currPageData.buttons,V=void 0;for(H=0;H<W.length;H++){var Y;if((Q=W[H])&&Q!=E&&h(Q)&&(Y=this.getNodeVec(Q)).y<z.y&&!c(z,Y))if(V==null)V=Q;else{var q=this.getNodeVec(V);q.y<Y.y&&(c(q,Y)?u(Y,z)<u(q,z)&&(V=Q):V=Q)}}if(D=V&&V.getComponent(cc.ScrollView)){if(V.name=="StoreSkinScrollView")return D.scrollToTop(.12),C=D.content.children[1],T=this.findFirstChildByName(C,["gain_btn","use_btn"])||C,{candidate:V,focusParent:C,focusNode:T,focusIndex:1,delayMS:150};if(V.name=="LevelMusicScrollView"||V.name=="HotMusicScrollView"){var J=this.currFocusParent,ee=this.currFocusIndex,$=V.name=="LevelMusicScrollView";return D.scrollToTop(.12),void setTimeout(function(){for(var j=$?1:0,ie=0,oe=99999,ue=D.content.children,pe=0;pe<ue.length;pe++){var de=ue[pe],he=v.getNodeRealIndex(de);if(he==j){ie=pe;break}he<oe&&(oe=he,ie=pe)}var me=void 0,ye=D.content.children[ie];if(T=v.findFirstChildByName(ye,v.currPageData.wildList)){var ge=v.getNodeRealIndex(ye);v.mIsDebugMode&&f("getDownNode => "+V.name+" init index:"+ge),me={candidate:V,focusParent:ye,focusNode:T,focusIndex:ge,delayMS:150}}else v.mIsDebugMode&&f("getDownNode => "+V.name+" ERROR"),me={candidate:E,focusParent:J,focusNode:k,focusIndex:ee};I&&I(me)},120)}}return this.currFocusNode=void 0,this.mIsDebugMode&&f("getDownNode => candidate.name: "+(V?V.name:"UNKNOWN")),V?{candidate:V,focusNode:V}:{candidate:E,focusNode:k}}},S.prototype.getUpNode=function(){if(this.currPageData&&this.currPageData.buttons){if(!this.currPageNode)return this.getFirstNode();var I=this.currPageNode,v=this.currFocusNode,C=I&&I.getComponent(cc.ScrollView);if(C){var T=C.content.children;if(I.name=="StoreSkinScrollView"){this.mIsDebugMode&&f("getUpNode => StoreSkinScrollView");for(var E=this.getNodeVec(v),A=v.name,M=T.length-1;0<=M;M--)if((H=T[M])&&M!=this.currFocusIndex&&h(H)&&(F=(F=this.findFirstChildByName(H,[A]))||this.findFirstChildByName(H,this.currPageData.wildList)||H,(Q=this.getNodeVec(F)).y>E.y&&!c(E,Q)&&p(E,Q))){if(M<2)C.scrollToTop(.12);else{var k=1-M*H.height/C.content.height*.7;C.scrollToPercentVertical(k,.12)}return{candidate:I,focusParent:H,focusNode:F,focusIndex:M,delayMS:150}}}else if(I.name=="LevelMusicScrollView"||I.name=="HotMusicScrollView"){this.mIsDebugMode&&f("getUpNode => "+I.name),A=v.name;var D=this.currFocusIndex,L=D-1,b=I.name=="LevelMusicScrollView",N=(b?I.parent.getComponent(n.default):I.parent.getComponent(t.default)).getTotalCount();for(M=T.length-1;0<=M;M--){var H=T[M],R=this.getNodeRealIndex(H);if(this.mIsDebugMode&&f("getUpNode => ["+M+"] index="+R+" targetIndex="+L+" focusIndex="+D),H&&R==L&&h(H)){var F;return(F=(F=this.findFirstChildByName(H,[A]))||this.findFirstChildByName(H,this.currPageData.wildList))?(k=Math.max((R-2)/(N-(b?3:4)),0),C.scrollToPercentVertical(1-k,.12),this.mIsDebugMode&&f("getUpNode => FOUND index:"+R+" total:"+N),{candidate:I,focusParent:H,focusNode:F,focusIndex:R,delayMS:150}):(this.mIsDebugMode&&f("getUpNode => FOUND ERROR"),{candidate:I,focusParent:this.currFocusParent,focusNode:v,focusIndex:this.currFocusIndex})}}}}var x=this.getNodeVec(I),U=this.currPageData.buttons,B=void 0;for(M=0;M<U.length;M++){var Q;if((H=U[M])&&H!=I&&h(H)&&(this.mIsDebugMode&&f("getUpNode => currNode.name:"+I.name+", node.name:"+H.name),(Q=this.getNodeVec(H)).y>x.y&&!c(x,Q)))if(B==null)B=H,this.mIsDebugMode&&f("getUpNode => A SET candidate "+H.name);else{var Z=this.getNodeVec(B);Z.y>Q.y&&(c(Z,Q)?u(Q,x)<u(Z,x)&&(B=H,this.mIsDebugMode&&f("getUpNode => B SET candidate "+H.name)):(B=H,this.mIsDebugMode&&f("getUpNode => C SET candidate "+H.name)))}}return this.currFocusNode=void 0,this.mIsDebugMode&&f("getUpNode => candidate.name: "+(B?B.name:"UNKNOWN")),B?{candidate:B,focusNode:B}:{candidate:I,focusNode:v}}},S.prototype.getNodeVec=function(I){try{if(I&&I instanceof cc.Node)return I.getBoundingBoxToWorld()}catch(v){console.error("KeypadNavigator::getNodeVec => "+v.message)}return{x:-1,y:-1,width:0,height:0}},S.prototype.getNodeRealIndex=function(I){var v=I.getComponent(e.default);if(v)return v.mIndex;var C=I.getComponent(i.default);return C?C.itemID:-1},S}();m.default=y,cc._RF.pop()},{"../Logic/MoneySystem":"MoneySystem","../UI/GameEntraScene/MusicLib/HotMusicCardItemPrefb":"HotMusicCardItemPrefb","../UI/GameEntraScene/MusicLib/HotMusicListCtrl":"HotMusicListCtrl","../UI/GameEntraScene/MusicLib/LevelMusicListCtrl":"LevelMusicListCtrl","../UI/GameEntraScene/MusicLib/NormalMusicCardItemPrefb":"NormalMusicCardItemPrefb","./KeypadFocusedUI":"KeypadFocusedUI","./KeypadUtil":"KeypadUtil"}],KeypadNavigator:[function(l,P,m){"use strict";cc._RF.push(P,"e8cedyKFStN4405NGT2m7fE","KeypadNavigator"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./KeypadNavigatorBase"),s=l("./KeypadUtil"),r=l("../../base/G"),o={FirstEnter:{firstName:"startBtn",nameList:["startBtn"],rootNode:void 0,buttons:[],delayMS:500},MainPagePrefab:{firstName:"start_btn",nameList:["energy_btn","gold_btn","diamond_btn","LucyDipOutBtn","ChosenBtn","DailyBtn","start_btn","MusicLIbBtn","HotSongBtn"],rootNode:void 0,buttons:[],delayMS:500},DailyAttendancePrefb:{firstName:"GetBtn",backName:"CloseBtn",nameList:["CloseBtn","day1","day2","day3","day4","day5","day6","day7","toggleRV","GetBtn"],rootNode:void 0,buttons:[],delayMS:500},LotteryPrefab:{firstName:"startBtn",backName:"closeBtn",nameList:["startBtn","getAwardBtn","closeBtn"],rootNode:void 0,buttons:[],delayMS:500},DiamondPopupProfab:{firstName:"close_btn",backName:"close_btn",nameList:["video_btn","count_down_timer_btn","close_btn"],rootNode:void 0,buttons:[],delayMS:500},EnergyPopupProfab:{firstName:"close_btn",backName:"close_btn",nameList:["close_btn","1_free_btn","1_buy_btn","2_free_btn","2_buy_btn","3_free_btn","3_buy_btn","4_free_btn","4_buy_btn"],wildList:[],rootNode:void 0,buttons:[],delayMS:500},GoldPopupProfab:{firstName:"close_btn",backName:"close_btn",nameList:["close_btn","get_gold_100_btn","get_gold_1100_btn","get_gold_12999_btn"],rootNode:void 0,buttons:[],delayMS:500},MusicLibraryPrefabLevel:{firstName:"BackBtn",backName:"BackBtn",nameList:["LevelMusicTab","HotMusicTab","LevelMusicScrollView","BackBtn"],wildList:["start_btn","SpecialStartButton","SpecialConditionBtn"],rootNode:void 0,buttons:[],delayMS:500},MusicLibraryPrefabHot:{firstName:"HotMusicTab",backName:"BackBtn",nameList:["HotMusicTab","BackBtn","HotMusicScrollView","LevelMusicTab"],wildList:["TryBtn","StartBtn","UnlockBtn1"],rootNode:void 0,buttons:[],delayMS:500},SkinStorePrefab:{firstName:"back_btn",backName:"back_btn",nameList:["back_btn","defaultBtn","StoreSkinScrollView"],wildList:["try_btn","gain_btn","use_btn"],rootNode:void 0,buttons:[],delayMS:500},SkinGainPrefab:{firstName:"gainBtn1",backName:"closeBtn",nameList:["closeBtn","gainBtn1","gainBtn2","gainBtn3"],rootNode:void 0,buttons:[],delayMS:200},FirstFailTipDialog:{firstName:"Btn",backName:"Btn",nameList:["Btn"],rootNode:void 0,buttons:[],delayMS:600},GameOverPrefab:{firstName:"TryAgainButton",backName:"GoHomeButton",nameList:["TryAgainButton","GoNextButton","TopEnergyPanel","TopGoldPanel","TopDiamondPanel","GoHomeButton"],wildList:["invite_btn"],rootNode:void 0,buttons:[],delayMS:500},giftBox:{firstName:"",backName:"",nameList:[],rootNode:void 0,buttons:[],delayMS:500},RelivePrefbTotal:{firstName:"relive_video_btn",backName:"skip_layout",nameList:["skip_layout","relive_video_btn","relive_diamond_btn"],rootNode:void 0,buttons:[],delayMS:500},UnlockConfirmDialogPrefab:{firstName:"CloseBtn",backName:"CloseBtn",nameList:["CloseBtn","ConfirmBtn"],rootNode:void 0,buttons:[],delayMS:500},AwardCommonResultPrefab:{firstName:"viodeButton",backName:"SkipLabel",nameList:["viodeButton","OKButton","closeBtn","SkipLabel"],rootNode:void 0,buttons:[],delayMS:500},UpdateDialog:{firstName:"updateContentBtn",backName:"updateContentBtn",nameList:["updateContentBtn"],rootNode:void 0,buttons:[],delayMS:800},UpdateContent:{firstName:"button",backName:"button",nameList:["button"],multiList:["start_btn","SpecialStartButton","SpecialConditionBtn"],rootNode:void 0,buttons:[],delayMS:500},GameSceneEntry:{firstName:"propertyicondash",backName:"",nameList:["AdvRewardBtn","propertyicondash","propertyiconslow","propertyiconshield"],rootNode:void 0,buttons:[],delayMS:500},AdvGetPropertyDialog:{firstName:"button",backName:"button",nameList:["button"],rootNode:void 0,buttons:[],delayMS:500},PropertyStorePrefab:{firstName:"freeButton",backName:"closebutton",nameList:["buybutton","freeButton","closebutton","leftbtn","rightbtn"],rootNode:void 0,buttons:[],delayMS:300},PropertyIntroduction:{firstName:"confirm_button",backName:"confirm_button",nameList:["confirm_button"],rootNode:void 0,buttons:[],delayMS:300},DecelerateConfirm:{firstName:"confirmbutton",backName:"closebutton",nameList:["closebutton","confirmbutton"],rootNode:void 0,buttons:[],delayMS:300},InviteTipsPrefab:{firstName:"button",backName:"closeBtn",nameList:["button","closeBtn"],rootNode:void 0,buttons:[],delayMS:300},DialogOneButtonPrefab:{firstName:"button",backName:"button",nameList:["button"],rootNode:void 0,buttons:[],delayMS:300},LevelVideoGetSkinPrefab:{firstName:"viodeButton",backName:"closeBtn",nameList:["viodeButton","OKButton","closeBtn","SkipLabel"],rootNode:void 0,buttons:[],delayMS:300}},e=function(n){function t(){var i=n.call(this)||this;return i.currPageName=void 0,i.currPageData=void 0,i.currPageNode=void 0,i.mEnable=!1,i.mEnable=!0,s.default.isHorizon()&&(window.addEventListener("focus",function(){console.log("=> focus")},!0),window.addEventListener("blur",function(){setTimeout(function(){console.log("=> window.focus"),window.focus()},0)},!0)),i}return __extends(t,n),t.getInstance=function(){return t.mInstance||(t.mInstance=new t),t.mInstance},t.prototype.getPageMap=function(i){var a=o[i];return a==null&&(console.error("getPageMap => name:"+i),console.error(o)),a},t.prototype.setEnable=function(i){this.mEnable=i},t.prototype.onPressTab=function(){if(this.mEnable){var i=this.getNextNode();i&&this.focusNode(i)}else console.warn("onPressTab => skip for disabled")},t.prototype.onPressLeft=function(){if(this.mEnable){var i=this.getLeftNode();i&&this.focusNode(i)}else console.warn("onPressTab => skip for disabled")},t.prototype.onPressRight=function(){if(this.mEnable){var i=this.getRightNode();i&&this.focusNode(i)}else console.warn("onPressTab => skip for disabled")},t.prototype.onPressUp=function(){if(this.mEnable){var i=this.getUpNode();i&&this.focusNode(i)}else console.warn("onPressTab => skip for disabled")},t.prototype.onPressDown=function(){var i=this;if(this.mEnable){var a=this.getDownNode(function(u){i.focusNode(u)});a&&this.focusNode(a)}else console.warn("onPressTab => skip for disabled")},t.prototype.onPressEnter=function(){this.mEnable?this.currPageData&&(this.currPageNode?this.emitTouchEnd():this.goFirstNode()):console.warn("onPressTab => skip for disabled")},t.prototype.onPressSpace=function(){this.mEnable?this.currPageData&&(this.currPageNode?this.emitTouchEnd():this.goFirstNode()):console.warn("onPressTab => skip for disabled")},t.prototype.onPressBack=function(){var i=this;if(this.mEnable){if(this.isNodeFocus()){var a=this.getBackNode();a?(this.focusNode(a),setTimeout(function(){i.emitTouchEnd()},100)):this.currPageName=="GameSceneEntry"&&r.G.Ap.presenter.enterScene("MainScene")}}else console.warn("onPressTab => skip for disabled")},t.prototype.hideFocus=function(){n.prototype.hideFocusEffect.call(this)},t.mInstance=void 0,t}(d.default);m.default=e,cc._RF.pop()},{"../../base/G":"G","./KeypadNavigatorBase":"KeypadNavigatorBase","./KeypadUtil":"KeypadUtil"}],KeypadUtil:[function(l,P,m){"use strict";cc._RF.push(P,"7e03ceSEk9MdoEBNnQ83eiD","KeypadUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.isHorizon=function(){return this.isHori==null&&(this.isHori=window.innerWidth>window.innerHeight),this.isHori},s.isOversea=function(){return CMPlay.getQueryString("region","oversea")=="oversea"},s.isHori=void 0,s}();m.default=d,cc._RF.pop()},{}],LRUCache:[function(l,P,m){"use strict";cc._RF.push(P,"318d7yOKclCXYAdDrCNwMIC","LRUCache"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),s=l("./InsFactory"),r=function(){function o(e){this.memoryObj=null,this.mKeyAll="user_chat",this.mErrorVal="0.0",this.isBatchSave=!1,this.mSavedVal="",this.memoryObj=new Object,this.mKeyAll=e;var n=this.readFromFlash(this.mKeyAll,this.mErrorVal);n==this.mErrorVal||this.isEmpty(n)||(this.memoryObj=JSON.parse(n))}return o.Ins=function(e){var n="LRUCache-"+e,t=s.default.getIns(n);return t||(s.default.setIns(n,new o(e)),s.default.getIns(n))},o.prototype.isEmpty=function(e){return e==null||e==null||e.length==0},o.prototype.batchSaveStart=function(){this.isBatchSave=!0},o.prototype.batchSaveEnd=function(){this.isBatchSave=!1,this.flushToFile()},o.prototype.save=function(e,n){this.isEmpty(e)||(this.memoryObj[e]=n,this.isBatchSave||this.flushToFile())},o.prototype.read=function(e,n){return n===void 0&&(n=null),this.isEmpty(e)?n:this.memoryObj[e]},o.prototype.remove=function(e){if(!this.isEmpty(e))try{if(e==this.mKeyAll){for(var n=Object.keys(this.memoryObj),t=0;t<n.length;t++){var i=n[t];i!=null&&i!=null&&delete this.memoryObj[i]}this.removeFromFlash(this.mKeyAll)}else delete this.memoryObj[e];this.flushToFile()}catch(a){}},o.prototype.flushToFile=function(){var e=this,n=JSON.stringify(this.memoryObj);this.mSavedVal!==n&&setTimeout(function(){e.saveToFlash(e.mKeyAll,n)&&(e.mSavedVal=n)},10)},o.prototype.saveToFlash=function(e,n){try{return d.MGBasic.setStorage(e,n)}catch(t){return!1}},o.prototype.readFromFlash=function(e,n){n===void 0&&(n="");try{return d.MGBasic.getStorage(e)}catch(t){return n}},o.prototype.removeFromFlash=function(e){d.MGBasic.delStorage(e)},o.TAG="cache => ",o}();m.default=r,cc._RF.pop()},{"../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","./InsFactory":"InsFactory"}],LSKey:[function(l,P,m){"use strict";cc._RF.push(P,"54a61cjFNBC1Jz48tRMawly","LSKey"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.CMG_DEBUG_USE_LOCAL_TIME="cmg_debug_use_local_time",s.CMG_USE_INOFC_DEBUG_SERVER="cmg_use_infoc_debug_server",s.UserInfo="UIF",s.UserLevelRecord="LevelRecord",s.UserLastLevelMid="last_level_mid",s.BASIC_DATA_VER="bs_data_ver",s.IS_NEED_REDOWNLOAD="re_downloadss",s.RES_PRELOAD_INFO="res_preload",s.RES_SKIN_INFO="res_skin",s.TODAY_SHARE_RELIVE_COUNT="today_share_relive_count",s.LAST_SHARE_RELIVE_TIME="last_share_relive_time",s.HAS_FIRST_PLAY_LITTLE_STAR="has_first_play_little_star",s.LAST_WATCH_VIDEO_WITH_PROP_RELIVE_TIME="last_watch_video_with_prop_relive_time",s.TODAY_SHARE_GAIN_ENERGY_COUNT="today_share_gain_energy_count",s.LAST_SHARE_GAIN_ENERGY_TIME="last_share_gain_energy_time",s.TODAY_SHARE_GAIN_GOLD_COUNT_ON_RELIVE="today_share_gain_gold_count_on_relive",s.LAST_SHARE_GAIN_GOLD_TIME_ON_RELIVE="last_share_gain_gold_time_on_relive",s.TODAY_SHARE_GAIN_DIAMOND_COUNT="today_share_gain_diamond_count",s.LAST_SHARE_GAIN_DIAMOND_TIME="last_share_gain_diamond_time",s.TODAY_SHARE_GAIN_DIAMOND_GROUP_IDS="today_share_gain_diamond_group_ids",s.LAST_SHARE_GAIN_DIAMOND_GROUP_IDS_TIME="last_share_gain_diamond_group_ids_time",s.TODAY_SHARE_GAIN_DIAMOND_RELIVE_GROUP_IDS="today_share_gain_diamond_relive_group_ids",s.LAST_SHARE_GAIN_DIAMOND_RELIVE_GROUP_IDS_TIME="last_share_gain_diamond_relive_group_ids_time",s.UD_DROP_CD_INFO="drop_cd_info",s.UD_LAST_OPEN_TIME="drop_last_open_time",s.UD_OPEN_COUNT="drop_open_count",s.HAS_SHOW_DOWNLOADING_PROGRESS="show_download_progress",s.HAS_SHARE_TO_GROUP="has_share_to_group",s.NEED_REPUSH="RPCOREINF",s.FIRST_ENTER_TIME="first_enter_time",s.NOT_SHOW_GAME_GUIDE="not_show_game_guide",s.INVITE_DATE="invite_date",s.SURPRISE_GIFT_BOX="surprise_gift_box",s.INVITE_REWARD_INFO_LIST="invite_reward_info_list",s.HAS_CLICK_SHARE_GIFT_ICON="has_click_share_gift_icon",s.LEVEL_MUSIC_LIB_SCROLL_POSITION="level_music_lib_scroll_position",s.HOT_MUSIC_LIB_SCROLL_POSITION="hot_music_lib_scroll_position",s.HAS_SCORLL_TO_TARGET_POSITION="has_scroll_to_target_position",s.BENCHMARK_LEVEL="benchmark_level",s.SIGN_IN_LAST_DATE="sign_in_last_date",s.SIGN_IN_TIMES="sign_in_times",s.SHOW_DAILY_AWARD_DIALOG_LAST_TIMES="show_daily_award_dailg_last_times",s.HAS_SHOW_SHORTCUT_GUIDE="has_show_shortcut_guide",s.MAIN_PAGE_SHOW_COUNT="main_page_show_count",s.SKIN_PIECE_DATA="skin_chip_data",s.SKIN_OWNED="owned_skins",s.SKIN_USING="skin_using",s.Cm_SKIN_ADS_INFO="cm_skin_ads_info",s.HAS_SHOW_SKIN_SPLASH="has_show_skin_splash",s.ACTIVE_GIVE_TRADE_ID_ARRAY="active_give_trade_id_array",s.ACTIVE_DEMAND_BILL_ID_ARRAY="active_ask_for_trade_id_array",s.HAS_CLICK_SKIN_CHIP_ENTRY="has_click_skin_chip_enter",s.LAST_CLICK_SKIN_CHIP_ENTRY_TIME="last_click_skin_chip_enter_time",s.SKIN_CHIP_REFRESH_COUNT_DOWN="skin_chip_refresh_count_down",s.JIGSAW_INVITE_LIST="jigsaw_invite_list",s.JIGSAW_INVITE_DATE="jigsaw_invite_date",s.LAST_CLEAN_CHIP_TIME="last_clean_chip_time",s.HAS_REWARD_15_TIMES="has_reward_15_times",s.ACTIVITY_INVITE_BEAN_LIST="activity_invite_bean_list",s.ACTIVITY_INVITE_BEAN_DIC="activity_invite_bean_dic",s.LAST_SHOW_INVITE_SKIN_TIMES="last_show_invite_skin_times",s.HAS_UNLOACK_INVITE_SKIN="has_unlock_invite_skin",s.HAS_SHOW_INVITE_3_FOR_SKIN_DIALOG="has_show_invite_3_for_skin_dialog",s.SHOWED_GROUP_RANK_TOTAL_DIALOG="showed_group_rank_total_dialog",s.SHOWED_GROUP_RANK_SONG_DIALOG="showed_group_rank_song_dialog",s.HAS_SHOW_INVITE_FOR_SONG_DIALOG="has_show_invite_for_song_dialog",s.HOME_WATCH_VIDEO_REMAINING_TIMES_THE_DAY="home_watch_video_remaining_times_the_day",s.SHOW_HOT_SONG_SPLASH_TIMES="show_hot_song_splash_times",s.HAS_SHOW_MUSIC_RED_SPOT="has_show_music_red_spot",s.STORAGE_VERSION="sver",s.CHALLENGECOMPETITION_KEY="cp_key",s.CHALLENGECOMPETITION_MUSIC_STATUS="cp_music_status",s.CHALLENGECOMPETITION_TIMES="challenge_times",s.CHALLENGECOMPETITION_FRIEND_HELP_SUCC_TIMES="challenge_friend_help_succ_time",s.LAST_CHALLENGE_TIME="last_challenge_time",s.HAS_FIGHT_WIN="has_fight_win",s.SINGLE_DAY_TOP_SCORE="single_day_top_score",s.CHALLENGE_MUSIC_NAME="challenge_music_name",s.CHALLENGE_INVITE_LIST="challenge_invite_list",s.CHALLENGE_INVITE_DATE="challenge_invite_date",s.RESULT_REWARD_COUNT="result_reward_count",s.RESULT_REWARD_COUNT_DATE="result_reward_count_date",s.SHOP_GOODS_ALREADY_BUY_TIMES="shop_goods_already_buy_times",s.SHOP_GOODS_PAY_COUNT="shop_goods_pay_count",s.SHOP_FIRST_PAY_AB_RESULT="shop_first_pay_ab_result",s.SHOW_PLAYER_TASK_ENTRY="show_player_task_entry",s.PLAYER_TASK_REWARD_TAKEN="player_task_reward_taken",s.GAMESCENE_GUIDE_SHOWED="game_scene_guide_showed",s.SHARE_FOR_GIFT_SHARED="share_for_gift_shared",s.HOT_SONG_UNLOCKED="hot_song_unlocked",s.HAS_RELIVE_FREE="has_relive_free",s.DEBUG_INFINITE_CHALLENGE_TIME="debug_infinite_challenge_times",s.QQ_RED_PACKET_ACTIVITY_SOURCE="qq_red_packet_activity_source",s.QQ_RED_PACKET_ACTIVITY_TIME="qq_red_packet_activity_time",s.QQ_RED_PACKET_ACTIVITY_ENTER_TIME="qq_red_packet_activity_enter_time",s.QQ_RED_PACKET_ACTIVITY_HIGH_SCORE="qq_red_packet_activity_high_score",s.QQ_RED_PACKET_ACTIVITY_HIGH_SCORE_TIME="qq_red_packet_activity_high_score_time",s.PROPERTY_DATA="g_p_data_oot",s.HAS_SHOW_GAMEOVER_GUIDE="has_show_gameover_guide",s.HAS_CLICK_MORE_GAME_ICON="has_click_more_game_icon",s.USER_AVATAR_PATH="user_avatar_path",s.LAST_SHOW_LUCKY_DIP_DIALOG_TIME="last_show_lucky_dip_dialog_time",s.LAST_LOTTERY_DATE="last_lottery_date",s.LOTTERY_DATA_RECENTLY="lottery_data_recently",s.LOTTERY_COUNT="lottery_count",s.LOTTERY_COUNTDOWN="lottery_countdown",s.DEBUG_INFINITE_LOTTERY="debug_infinite_lottery",s.DEBUG_ENABLE_FLAUNT_PAGE="DEBUG_ENABLE_FLAUNT_PAGE",s.PIANO_TONE_OWN="piano_tone_own",s.PIANO_TONE_USE="piano_tone_use",s.PIANO_STORAGE_KEY="PIANO_Local_CACHE",s.VIP_LOCAL_CACHE="vip_level",s.VIP_DAILY_REWARD_TAKEN_TIME="vip_daily_reward_taken_time",s.VIP_INTERRUPTED="vip_buy_interrupted",s.HAS_SHOW_VIP_PAGE="has_show_vip_page",s.HAS_SHOW_TOPPED_PAGE="has_show_topped_page",s.HOT_SONG_KEY="lver_hotsong",s.GAME_OVER_INVITE_SHOW_INDEX="game_over_invite_show_index",s.GAME_OVER_LAST_SHOW_TIME="game_over_last_show_time",s.GAME_OVER_INVIE_SKIN_LAST_SHOW_TIME="game_over_invite_skin_last_show_time",s.GAME_OVER_INVITE_SONG_LAST_SHOW_TIME="game_over_invite_song_last_show_time",s.GAME_OVER_HAS_SHOW_FIRST_PAY="game_over_has_show_first_pay",s.GAME_OVER_SHOW_COUNT="game_over_show_show_count",s.PROPERTY_INTRODUCTION_SHOW="property_introduction_show",s.MUSIC_PIANO="music_piano",s.MUSIC_PIANO_ZIP_PATH="music_piano_zip_path",s.MUSIC_PIANO_NEED_UPDATE="music_piano_need_update",s.GAME_OVER_LAST_SHOW_HOT_MUSIC_BATTLE_TIPS_TIME="game_over_last_show_hot_music_battle_tips_time",s.HAS_SHOW_HOME_PAGE="has_show_home_page",s.QQ_SHARE_RELIVE_CHECK_TIME="qq_share_relive_check_time",s.QQ_SHARE_RELIVE_SUCC_TIMES="qq_share_relive_succ_times",s.RELIVE_SHARE_FIRST_TIME="relive_share_first_time",s.IS_NEW_TO_SHOW_GUIDE="is_new_to_show_guide",s.IS_NEW_RECORD_TIME="is_new_record_time",s.IS_SHARE_CLICK_RECORD_TIME="is_share_click_record_time",s.IS_SKIN_CLICK_RECORD_TIME="is_skin_click_record_time",s.IS_NEWER_TARGET_RECORD_TIME="is_newer_target_record_time",s.PROP_BIG_GIFT_BAG_RECHARGE_TIME_1="prop_big_gift_bag_recharge_time_1",s.PROP_BIG_GIFT_BAG_RECHARGE_TIME_2="prop_big_gift_bag_recharge_time_2",s.HAS_SHOW_SHARE_ANIM="has_show_share_anim",s.RECOMMEND_GAME_A_OR_B="recommend_game_a_or_b",s.RECOMMEND_GAME_RED_SPOT_CLICKED="recommend_game_red_spot_clicked",s.ENTER_GAME_BY_HOT_SONG_SHARE="enter_game_by_hot_song_share",s.RESULT_PAGE_TIME_WITH_NORMAL_MUSIC="result_page_time_with_normal_music",s.SHARE_FOR_GIFT_DAILY_SHOWED_DATE="share_for_gift_daily_showed_date",s.HAS_PLAY_CHALLENGE="has_play_challenge",s.HAS_CLICK_QQ_SUB="has_click_QQ_SUB",s.USE_ADV_GET_PROPERTY_COUNT="use_adv_get_property_count",s.LAST_USE_ADV_GET_PROPERTY_TIME="last_use_adv_get_property_time",s.ADD_FAV_ICON_SHOW_TIME="add_fav_icon_show_time",s.QQ_REPORT_UNLOCK_SONG_NUM="qq_report_unlock_song_num",s.QQ_REPORT_GRADE="qq_report_grade",s.START_UP_CHANNEL="startup_channel",s.FIGHT_DAILY_REWARD_INFO="fight_daily_reward",s.FIGHT_DAY_TIMES="fight_day_times",s.FIGHT_AUTO_SHOW_SAESON_REWARD="fight_auto_show_season_reward",s.FIGHT_VIDEO_AD_RECORD="fight_video_ad_record",s.FIGHT_CLOUD_CFG="fight_cloud_cfg",s.HAS_WIN_FIGHT="has_win_fight",s.GUIDE_TO_FIGHT_TIMES="guide_to_fight_times",s.LAST_GUIDE_TO_FIGHT_TIME="last_guide_to_fight_time",s.HAS_SHOW_GAME_ENTRA="has_show_game_entra",s.AD_VIDEO_PROPERTY_SHOW_INFO="ad_video_property_show_info",s.SKIN_TASK_STEP_STATUS="skin_task_step_status",s.LOTTERY_TOTAL_COUNT="lottery_total_count",s.OPEN_GAMEOVER_FROM="open_game_from",s.HAS_AUTO_OPEN_LEFT="has_auto_open_left",s.LAST_AUTO_OPEN_TIME="last_auto_open_time",s.HAS_SHOW_SKIN_PIECE_TIPS_DIALOG="has_show_skin_piece_tips_dialog",s.KEY_CLOUD_CFG="KEY_CLOUD_CFG",s.HAS_CLICK_HOME_AVATOR="has_click_home_avator",s.HAS_ENTER_FROM_ATTENTION="has_enter_from_attention",s.WELFARE_SHOWED_TAB="welfare_showed_tab",s.GET_REWARD_FROM_SUBSCRIPTION_FOLLOW="get_reward_from_subscription_follow",s.TRUMPET_COUNT="trumpet_count",s.FRIEND_FROM_SHARE_REWARD="friend_from_share",s.FRIEND_POP_APPLYLIST="firend_pop_applylist",s.HOLIDAY_TASK_LIST="holiday_task_list",s.DAILY_TRY_ANIM_PLAY="daily_tone_anim_play",s.PIANO_TONE_SHOW_COVER="piano_tone_show_cover",s.HOTMUSIC_ACTIVITY="hotmusic_activity",s.KEYS_NEED_SYNC=[s.UserInfo,s.UserLevelRecord,s.HAS_FIRST_PLAY_LITTLE_STAR,s.TODAY_SHARE_GAIN_DIAMOND_COUNT,s.LAST_SHARE_GAIN_DIAMOND_TIME,s.TODAY_SHARE_GAIN_ENERGY_COUNT,s.LAST_SHARE_GAIN_ENERGY_TIME,s.TODAY_SHARE_RELIVE_COUNT,s.LAST_SHARE_RELIVE_TIME,s.HAS_SHARE_TO_GROUP,s.TODAY_SHARE_GAIN_GOLD_COUNT_ON_RELIVE,s.LAST_SHARE_GAIN_GOLD_TIME_ON_RELIVE,s.INVITE_DATE,s.SURPRISE_GIFT_BOX,s.INVITE_REWARD_INFO_LIST,s.SIGN_IN_LAST_DATE,s.SIGN_IN_TIMES,s.SKIN_PIECE_DATA,s.SKIN_OWNED,s.SKIN_USING,s.JIGSAW_INVITE_DATE,s.JIGSAW_INVITE_LIST,s.LAST_CLEAN_CHIP_TIME,s.HAS_REWARD_15_TIMES,s.ACTIVITY_INVITE_BEAN_LIST,s.ACTIVITY_INVITE_BEAN_DIC,s.HAS_UNLOACK_INVITE_SKIN,s.HOME_WATCH_VIDEO_REMAINING_TIMES_THE_DAY,s.STORAGE_VERSION,s.CHALLENGECOMPETITION_TIMES,s.LAST_CHALLENGE_TIME,s.HAS_FIGHT_WIN,s.SINGLE_DAY_TOP_SCORE,s.CHALLENGE_INVITE_LIST,s.CHALLENGE_INVITE_DATE,s.CHALLENGECOMPETITION_FRIEND_HELP_SUCC_TIMES,s.SHOP_GOODS_ALREADY_BUY_TIMES,s.SHOP_GOODS_PAY_COUNT,s.PLAYER_TASK_REWARD_TAKEN,s.SHOW_PLAYER_TASK_ENTRY,s.HAS_RELIVE_FREE,s.PROPERTY_DATA,s.HAS_SHOW_GAMEOVER_GUIDE,s.LAST_SHOW_LUCKY_DIP_DIALOG_TIME,s.LAST_LOTTERY_DATE,s.LOTTERY_COUNT,s.VIP_DAILY_REWARD_TAKEN_TIME,s.VIP_INTERRUPTED,s.LOTTERY_COUNTDOWN,s.PROPERTY_INTRODUCTION_SHOW,s.QQ_SHARE_RELIVE_CHECK_TIME,s.QQ_SHARE_RELIVE_SUCC_TIMES,s.RELIVE_SHARE_FIRST_TIME,s.IS_NEW_TO_SHOW_GUIDE,s.IS_NEW_RECORD_TIME,s.HAS_SHOW_SHARE_ANIM,s.HAS_PLAY_CHALLENGE,s.HAS_CLICK_QQ_SUB,s.FIGHT_DAILY_REWARD_INFO,s.HAS_WIN_FIGHT,s.USE_ADV_GET_PROPERTY_COUNT,s.LAST_USE_ADV_GET_PROPERTY_TIME,s.ADD_FAV_ICON_SHOW_TIME,s.FIGHT_AUTO_SHOW_SAESON_REWARD,s.GUIDE_TO_FIGHT_TIMES,s.LAST_GUIDE_TO_FIGHT_TIME,s.QQ_REPORT_GRADE,s.SKIN_TASK_STEP_STATUS,s.LOTTERY_TOTAL_COUNT,s.LAST_AUTO_OPEN_TIME,s.HAS_SHOW_GAME_ENTRA,s.HAS_AUTO_OPEN_LEFT,s.GET_REWARD_FROM_SUBSCRIPTION_FOLLOW,s.TRUMPET_COUNT,s.FRIEND_FROM_SHARE_REWARD,s.PIANO_TONE_OWN,s.PIANO_TONE_USE,s.Cm_SKIN_ADS_INFO,s.HOLIDAY_TASK_LIST],s}();m.default=d,cc._RF.pop()},{}],LangMgr:[function(l,P,m){"use strict";cc._RF.push(P,"e35ea1vaDBH9px1B1rvdrxn","LangMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/I18nManager"),s=function(){function r(){this.mCache={}}return r.gIns=function(){return r.sInstance==null&&(r.sInstance=new r),r.sInstance},r.prototype.setLanguage=function(o,e){d.default.getInstance().setLanguage(o,e)},r.prototype.getLanguageByKey=function(o){return d.default.getInstance().getLanguageByKey(o)},r.sInstance=null,r}();m.default=s,cc._RF.pop()},{"../Logic/I18nManager":"I18nManager"}],LanguageData:[function(l,P,m){"use strict";cc._RF.push(P,"61de062n4dJ7ZM9/Xdumozn","LanguageData");var d=l("polyglot.min"),s=null;function r(e){return window.i18n.languages[e]}function o(e){e&&(s?s.replace(e):s=new d({phrases:e,allowMissing:!0}))}window.i18n||(window.i18n={languages:{},curLang:""}),P.exports={init:function(e){if(e!==window.i18n.curLang){var n=r(e)||{};window.i18n.curLang=e,o(n),this.inst=s}},t:function(e,n){if(s)return s.t(e,n)},inst:s,updateSceneRenderers:function(){for(var e=cc.director.getScene().children,n=[],t=0;t<e.length;++t){var i=e[t].getComponentsInChildren("LocalizedLabel");Array.prototype.push.apply(n,i)}for(var a=0;a<n.length;++a)n[a].updateLabel();for(var u=[],c=0;c<e.length;++c){var p=e[c].getComponentsInChildren("LocalizedSprite");Array.prototype.push.apply(u,p)}for(var h=0;h<u.length;++h)u[h].updateSprite(window.i18n.curLang)}},cc._RF.pop()},{"polyglot.min":"polyglot.min"}],LanguageSongData:[function(l,P,m){"use strict";cc._RF.push(P,"8ceaalNgdxMOZSTTwfC8bk/","LanguageSongData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findLanguage=function(n){return this.find("TID",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.default=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getTID=function(){return this.getString("TID")},e.prototype.getCN=function(){return this.getString("CN")},e.prototype.getTW=function(){return this.getString("TW")},e}(d.default);m.LanguageSongRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],LevelConsumeData:[function(l,P,m){"use strict";cc._RF.push(P,"b9bc1lMHlNOjovwWT9RvGFE","LevelConsumeData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findMid=function(n){return this.find("Mid",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.LevelConsumeData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getID=function(){return this.getInt("Id")},e.prototype.getMid=function(){return this.getInt("Mid")},e.prototype.getSpendType=function(){return this.getInt("SpendType")},e.prototype.getSpendEnergy=function(){return this.getInt("SpendEnergy")},e.prototype.getSpendGold=function(){return this.getInt("SpendGold")},e.prototype.getSpendDiamond=function(){return this.getInt("SpendDiamond")},e.prototype.getTestType=function(){return this.getInt("TestType")},e.prototype.getTestEnergy=function(){return this.getInt("TestEnergy")},e.prototype.getTestGold=function(){return this.getInt("TestGold")},e.prototype.getTestDiamond=function(){return this.getFloat("TestDiamond")},e.prototype.getUnlockActive=function(){return this.getFloat("UnlockActive")},e.prototype.getActiveBeginTime=function(){return this.getFloat("ActiveBeginTime")},e.prototype.getActiveEndTime=function(){return this.getFloat("ActiveEndTime")},e.prototype.getUnlockCount=function(){return this.getFloat("UnlockCount")},e.prototype.getIsNew=function(){return this.getFloat("IsNew")},e.prototype.getBackgroundImg=function(){return this.getString("BackgroundImg")},e}(d.default);m.LevelConsumeRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],LevelData:[function(l,P,m){"use strict";cc._RF.push(P,"18693MqTXhIVItuZ0Lwu59n","LevelData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findLevel=function(n){return this.find("Id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.default=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("Id")},e.prototype.getMid=function(){return this.getInt("Mid")},e.prototype.getType=function(){return this.getInt("Type")},e.prototype.getLock=function(){return this.getInt("Lock")},e.prototype.getNeedLv=function(){return this.getInt("NeedLv")},e.prototype.getNeedGold=function(){return this.getInt("NeedGold")},e.prototype.getNeedDiamond=function(){return this.getInt("NeedDiamond")},e.prototype.getMusicLevel=function(){return this.getInt("Musiclevel")},e.prototype.getRewarID=function(){return this.getInt("RewarID")},e.prototype.getLocalMusicVer=function(){return this.getInt("LocalMusicVer")},e.prototype.getMusicCard=function(){return this.getInt("MusicCard")},e.prototype.getMusicTime=function(){return this.getString("MusicTime")},e.prototype.getHomeOrder=function(){return this.getInt("HomeOrder")},e.prototype.getVipMusicVersion=function(){return this.getInt("VipMusicVersion")},e.prototype.getFavoriteRate=function(){return this.getInt("FavoriteRate")},e.prototype.getVipCn=function(){return this.getInt("VipCn")},e.prototype.getName=function(){return this.getString("Name")},e.prototype.getBpm=function(){return this.getInt("bpm")},e.prototype.getBpmIncrease=function(){return this.getFloat("bpmIncrease")},e.prototype.getPlusType=function(){return this.getInt("PlusType")},e.prototype.getPlusTime=function(){return this.getInt("PlusTime")},e.prototype.getPlusID1=function(){return this.getInt("PlusID1")},e.prototype.getPlusID2=function(){return this.getInt("PlusID2")},e.prototype.getPlusID3=function(){return this.getInt("PlusID3")},e.prototype.getRewarLife=function(){return this.getInt("RewarLife")},e.prototype.getRewarGoal=function(){return this.getInt("RewarGoal")},e.prototype.getRewarGoalRevise=function(){return this.getInt("RewarGoalRevise")},e.prototype.getMusiclevel=function(){return this.getInt("Musiclevel")},e.prototype.getNeedlevel=function(){return this.getInt("Needlevel")},e.prototype.getNeedStar=function(){return this.getInt("NeedStar")},e.prototype.getNeedCrow=function(){return this.getInt("NeedCrow")},e.prototype.getNeedCrow2=function(){return this.getInt("NeedCrow2")},e.prototype.getMusicJson=function(){return this.getString("MusicJson")},e.prototype.getMusician=function(){return this.getString("Musician")},e}(d.default);m.LevelRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],LevelMgr:[function(l,P,m){"use strict";cc._RF.push(P,"2964d9m/21HTJLgUxs64V0p","LevelMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Level"),s=l("../../util/Dictionary"),r=l("../DB/DBMgr"),o=l("../Core/GameDefine"),e=l("./CopyrightManager"),n=function(){function t(){this.FIRSTCELL=1,this.SECONDCELL=2,this.THIRDCELL=3,this.DEFAULT_ANIID_1=1024001,this.DEFAULT_ANIID_2=1024002,this.DEFAULT_ANIID_3=1024003,this.DEFAULT_BRIDGEANI_1=2048001,this.DEFAULT_BRIDGEANI_2=2048002,this.m_LocalMusicVer=0,this.isMusicIndexMapIndexed=!1,this.reset()}return t.Ins=function(){return t.mInstance||(t.mInstance=new t),t.mInstance},t.prototype.reset=function(){this.m_Levels=new s.Dictionary,this.m_mapSuoYinInfo=new s.Dictionary,this.suoyinMapInfo=new s.Dictionary,this.m_showLevels=[],this.m_mapNeedLvToLevel=new s.Dictionary,this.m_mapLevelInfo=new s.Dictionary,this.m_midToLevelId=new s.Dictionary;var i=Date.now();this.initLevel(),console.warn("[LevelManager.initLevel] timecost="+(Date.now()-i)+"ms")},t.prototype.getShowLevels=function(){return this.m_showLevels},t.prototype.getLevel=function(i){return this.m_Levels.get(i)},t.prototype.getLevelByMid=function(i){for(var a=this.m_Levels.getPairs(),u=0;u<a.length;++u){var c=a[u].value;if(c.music.mid==i)return c}return null},t.prototype.getDefaultAwardStar=function(){var i=new d.AwardStar;return i.insertAward(1,t.STARONE),i.insertAward(2,t.STARTWO),i.insertAward(3,t.STARTHREE),i.insertAward(4,t.STARFOUR),i.insertAward(5,t.STARFIVE),i.insertAward(6,t.STARSIXE),i},t.prototype.initLevel=function(){var i=Date.now(),a=r.default.Ins(),u=a.getData(r.eDataBase.eDB_Level);if(u){console.warn("[LevelManager.initLevel] timecost2="+(Date.now()-i)+"ms"),i=Date.now();for(var c=u.getAllDB(),p=0;p<c.length;++p){var h=c[p];if(h.length!=0){var f=a.getDBRow(r.eDataBase.eDB_Level,h[0]);if(f&&f.getId()!=0){var g=f.getMid();if(!e.default.getInstance().isCopyrightMusic(g)){this.m_midToLevelId.put(g,f.getId());var _=f.getId(),y=new d.Level;y.id=f.getId(),y.type=f.getType(),y.needLv=f.getNeedLv();var S=new d.LevelUnlock;switch(S.unlockType=f.getLock(),f.getLock()){case d.eUnlockType.UNLOCK_TYPE_LV:S.unlockValue=f.getNeedLv();break;case d.eUnlockType.UNLOCK_TYPE_GOLD:S.unlockValue=f.getNeedGold();break;case d.eUnlockType.UNLOCK_TYPE_DIAMOND:S.unlockValue=f.getNeedDiamond();break;case d.eUnlockType.UNLOCK_TYPE_VIDEO:S.unlockValue=1}y.levelUnlock=S,y.awardStar=this.getDefaultAwardStar();var I=new d.LevelMusic;I.mid=f.getMid(),I.musicLevel=f.getMusicLevel(),(I.bpmIncrease=0)<f.getMusicTime().length&&(I.musicTime=0),I.homeOrder=f.getHomeOrder(),I.musicCard=f.getMusicCard(),I.localMusicVer=f.getLocalMusicVer(),this.m_LocalMusicVer<I.localMusicVer&&(this.m_LocalMusicVer=I.localMusicVer),I.musicName=f.getMusicJson(),I.musician=f.getMusician(),y.music=I,this.m_Levels.put(_,y),this.m_showLevels.push(_),this.putNeedLvToLevel(y.needLv,y),this.initLevelInfo(f)}}}}console.warn("[LevelManager.initLevel] timecost3="+(Date.now()-i)+"ms",this.m_Levels)}else console.log("XError: CSV Level is error.")},t.prototype.initLevelReward=function(i){var a=r.default.Ins(),u=r.default.Ins().getDBRow(r.eDataBase.eDB_Level,String(i.id)),c=new d.ClearanceAward;if(0<u.getRewarID()){var p=String(u.getRewarID()),h=a.getDBRow(r.eDataBase.eDB_LevelReward,p);i.reward3Gold=h.getRewar3Gold(),i.reward3Goldline=h.getRewar3Goldline();var f=new d.Earnings;f.exp=h.getRewar1Exp(),f.gold=0,c.insertAward(1,f);var g=new d.Earnings;g.exp=h.getRewar2ExpFirst(),g.gold=0,c.insertAward(2,g);var _=new d.Earnings;_.exp=h.getRewar3Exp(),_.gold=0,c.insertAward(3,_)}else i.reward3Gold=0,i.reward3Goldline=0;i.clearanceAward=c},t.prototype.initMusicIndexMap=function(){if(!this.isMusicIndexMapIndexed){var i=r.default.Ins().getData(r.eDataBase.eDB_MusicJson);if(i){for(var a=i.getAllDB(),u=0;u<a.length;++u){var c=a[u];if(0<c.length){var p=parseInt(c[0]),h=Math.floor(p/100),f=this.suoyinMapInfo.get(h);if(f)f.push(p);else{var g=new Array;g.push(p),this.suoyinMapInfo.put(h,g)}this.m_mapSuoYinInfo.put(p,u)}}this.isMusicIndexMapIndexed=!0}else console.log("XError: CSV MusicJson is error.")}},t.prototype.intMusicCells=function(i){var a=this;if(i&&i.getMusicCellCount()==0){this.initMusicIndexMap();var u=this.parseMidToLevelId(i.mid),c=r.default.Ins(),p=r.default.Ins().getDBRow(r.eDataBase.eDB_Level,u),h=this.suoyinMapInfo.get(u);h&&p?h.forEach(function(f){var g=a.m_mapSuoYinInfo.get(f),_=c.getDBRowByRowID(r.eDataBase.eDB_MusicJson,g);if(_&&p.getMid()==_.getMid()){var y=new d.MusicCell;y.BPM=_.getBPM(),y.musicJson=_.getMusicJson(),y.baseBeats=parseFloat(_.mRowData[3]);var S=_.getId()%10;y.musicCellid=S,_.getAniID()!=0?(y.aniID=_.getAniID(),y.bridgeAniID=_.getBridgeAniID()):S==a.FIRSTCELL?(y.aniID=a.DEFAULT_ANIID_1,y.bridgeAniID=a.DEFAULT_BRIDGEANI_1):S==a.SECONDCELL?(y.aniID=a.DEFAULT_ANIID_2,y.bridgeAniID=a.DEFAULT_BRIDGEANI_2):S==a.THIRDCELL?y.aniID=a.DEFAULT_ANIID_3:(y.aniID=_.getAniID(),y.bridgeAniID=_.getBridgeAniID()),y.acceleration=_.getAcceleration(),i.insertMusicCell(S,y)}else console.log("XError: MusicJsonRow error!")}):console.info("initMusicCells error musicitem or rowlevel is null.",h,p)}},t.prototype.getClearanceAward=function(i){var a=this.m_Levels.get(i);return a.clearanceAward!=null&&a.clearanceAward!=null||this.initLevelReward(a),a.clearanceAward},t.prototype.getRewardGold=function(i){var a=this.m_Levels.get(i);return a.reward3Gold!=-1&&a.reward3Goldline!=-1||this.initLevelReward(a),{gold:a.reward3Gold,goldline:a.reward3Goldline}},t.prototype.initLevelInfo=function(i){var a=new o.LevelInfo;if(i){if(a.mId=i.getId(),a.mMid=i.getMid(),a.mBpm=i.getBpm(),a.mBpmIncrease=i.getBpmIncrease(),a.mName=i.getName(),a.mPlusID1=i.getPlusID1(),a.mPlusID2=i.getPlusID2(),a.mPlusID3=i.getPlusID3(),a.mPlusTime=i.getPlusTime(),a.mPlusType=i.getPlusType(),a.mScoreType=t.SCORETYPE,a.mStarOne=t.STARONE,a.mStarTwo=t.STARTWO,a.mStarThree=t.STARTHREE,a.mStarFour=t.STARFOUR,a.mStarFive=t.STARFIVE,a.mStarSix=t.STARSIXE,a.mRewarLife=i.getRewarLife(),a.mRewarGoal=i.getRewarGoal(),a.mRewarGoalRevise=i.getRewarGoalRevise(),a.mType=i.getType(),a.mMusicLevel=i.getMusiclevel()<0?1:i.getMusiclevel(),a.m_needCrown=i.getNeedCrow(),a.m_needCrown2=i.getNeedCrow2(),a.mUnlockType=i.getLock(),a.mUnlockLevel=i.getNeedlevel(),a.mUnlockLv=i.getNeedLv(),a.mUnlockStar=i.getNeedStar(),a.mUnlockGold=i.getNeedGold(),a.mUnlockDiamond=i.getNeedDiamond(),a.mUnlockDiamondOnSale=i.getNeedDiamond()/2,0<i.getRewarID()){var u=r.default.Ins().getDBRow(r.eDataBase.eDB_LevelReward,i.getRewarID()+"");u&&(a.mRewarPro=u.getRewarPro(),a.mRewar3Gold=u.getRewar3Gold(),a.mRewar3Goldline=u.getRewar3Goldline(),a.mRewarID=i.getRewarID(),a.mRewarMax=u.getRewarMax())}a.mBasicDiamond=0,this.m_mapLevelInfo.put(a.mId,a)}},t.prototype.getLevelInfo=function(i){return this.m_mapLevelInfo.get(i)},t.prototype.getLevelByNeedLv=function(i){return this.m_mapNeedLvToLevel.get(i)},t.prototype.putNeedLvToLevel=function(i,a){var u=this.m_mapNeedLvToLevel.get(i);u?u.push(a):((u=[]).push(a),this.m_mapNeedLvToLevel.put(i,u))},t.prototype.parseMidToLevelId=function(i){return this.m_midToLevelId.get(i)},t.SCORETYPE=1,t.STARONE=1,t.STARTWO=2,t.STARTHREE=3,t.STARFOUR=4,t.STARFIVE=6,t.STARSIXE=9,t}();m.LevelMgr=n,cc._RF.pop()},{"../../util/Dictionary":"Dictionary","../Core/GameDefine":"GameDefine","../DB/DBMgr":"DBMgr","./CopyrightManager":"CopyrightManager","./Level":"Level"}],LevelMusicListCtrl:[function(l,P,m){"use strict";cc._RF.push(P,"2eba4omr/1JGbCw5ua7uWI4","LevelMusicListCtrl"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../MusicLevelDataLoader"),s=l("./NormalMusicCardItemPrefb"),r=l("../../../Network/Protocol/StorageUtil"),o=l("../../../../config/LSKey"),e=l("../ImgCache"),n=l("../../../keypad/KeypadUtil"),t=cc._decorator,i=t.ccclass,a=t.property,u=function(c){function p(){var h=c!==null&&c.apply(this,arguments)||this;return h.itemPrefb=null,h.scrollView=null,h.spawnCount=0,h.totalCount=0,h.spacing=0,h.bufferZone=0,h.items=[],h.lastContentPosY=0,h.musicInfoArray=new Array,h.updateMusicItemCount=0,h.mRealIndex=[],h.mLevelGroupHeight=36,h.mContentGroupHeight=176,h.mSpecialGroupHeight=222,h.mInitHideShowState=!1,h.mHideAfterLoad=!1,h.mSkipCount=0,h.mAlreadyShow=!1,h.mHasLoadedListView=!1,h.mLoadingListView=!1,h.mUpdateTask=[],h.mLastItemHeight=0,h}return __extends(p,c),Object.defineProperty(p.prototype,"hideAfterLoad",{get:function(){return this.mHideAfterLoad},set:function(h){this.mHideAfterLoad=h},enumerable:!0,configurable:!0}),p.prototype.getTotalCount=function(){return this.musicInfoArray.length},p.prototype.onLoad=function(){this.content=this.scrollView.content},p.prototype.start=function(){},p.prototype.loadData=function(){return __awaiter(this,void 0,void 0,function(){var h=this;return __generator(this,function(f){return this.postUpdateTask(function(){cc.isValid(h.node)&&e.default.saveMusicItemBgImageAtlas("/musiclist/music_list_item_bg",["bg_music_list_item_lock","bg_music_list_item_star","bg_music_list_item_crown"],function(g,_){cc.isValid(h.node)&&h.postUpdateTask(function(){h.musicInfoArray=d.MusicLevelDataLoader.getAllItemInfo(),h.updateMusicItemCount=h.spawnCount;var y=new d.ItemInfo;y.id=s.default.exceptionMoreId,y.level=s.default.exceptionMoreId,h.musicInfoArray.push(y),h.postUpdateTask(function(){h.initListView(h.musicInfoArray)})})})}),[2]})})},p.prototype.initListView=function(h){return __awaiter(this,void 0,void 0,function(){var f,g,_,y,S,I,v,C,T,E=this;return __generator(this,function(A){for(Date.now(),f=-9999,T=S=y=_=0;T<h.length;T++)h[T].id!=s.default.exceptionMoreId&&(h[T].isCrownLock?S++:y++,h[T].level!=f&&(_++,f=h[T].level));for(g=(this.mContentGroupHeight+this.spacing)*y+(this.mSpecialGroupHeight+this.spacing)*S+this.mLevelGroupHeight*_+this.spacing+this.mContentGroupHeight+this.spacing,Date.now(),I=-9999,this.content.height=g,v=function(M){var k=h[M],D=M;C.postUpdateTask(function(){var L=cc.instantiate(E.itemPrefb),b=L.getComponent(s.default);if(b.setData(k,D),k.isCrownLock){var N={isSpecial:!0};L.attr(N)}else N={isSpecial:!1},L.attr(N);if(I!=k.level){if(I=k.level,b.setLevel(k.level),D==0)L.setPosition(0,-E.spacing);else{var H=E.items[D-1];L.setPosition(0,H.y-E.mLastItemHeight-E.spacing)}L.tag=1,L.height=E.mContentGroupHeight+E.mLevelGroupHeight}else b.removeLevel(),D==0?L.setPosition(0,-E.spacing):(H=E.items[D-1],L.setPosition(0,H.y-E.mLastItemHeight-E.spacing)),L.tag=0,k.isCrownLock?L.height=E.mSpecialGroupHeight:L.height=E.mContentGroupHeight;E.content.addChild(L),E.items.push(L),E.mRealIndex.push(D),E.mLastItemHeight=L.height,E.updateMusicItemCount-=1,E.updateMusicItemCount<=0&&(E.mAlreadyShow=!0,E.mHasLoadedListView=!0,E.mLoadingListView=!1,E.scrollView.enabled=!0,E.scheduleOnce(function(){E.scrollToRememberPosition()},.001))})},C=this,T=0;T<this.spawnCount;T++)v(T);return[2]})})},p.prototype.getPositionInView=function(h){var f=h.parent.convertToWorldSpaceAR(h.position);return this.scrollView.node.convertToNodeSpaceAR(f)},p.prototype.update=function(h){this.mInitHideShowState||(this.mHideAfterLoad,this.mSkipCount++,3<=this.mSkipCount&&(this.mHideAfterLoad=!1,this.mInitHideShowState=!0)),0<this.mUpdateTask.length&&this.mUpdateTask.shift()()},p.prototype.postUpdateTask=function(h){this.mUpdateTask.push(h)},p.prototype.onShow=function(){this.mHasLoadedListView||this.mLoadingListView?this.updateListView():(this.mLoadingListView=!0,this.scrollView.enabled=!1,this.loadData())},p.prototype.updateListView=function(){this.scrollView.enabled=!0,this.mAlreadyShow=!0,this.musicInfoArray=d.MusicLevelDataLoader.getAllItemInfo();var h=new d.ItemInfo;h.id=s.default.exceptionMoreId,this.musicInfoArray.push(h);for(var f,g,_=this.mRealIndex.length,y=0;y<_;y++)f=this.mRealIndex[y],(g=this.items[f].getComponent(s.default)).setData(this.musicInfoArray[g.itemID],g.itemID);this.scrollToRememberPosition()},p.prototype.onHide=function(){this.scrollView.stopAutoScroll(),this.mAlreadyShow&&this.rememberScrollPosition()},p.prototype.setEnable=function(h){this.scrollView.enabled=h},p.prototype.update2=function(){var h,f,g,_,y,S,I,v,C,T,E,A,M,k=this.items,D=this.bufferZone;if(this.scrollView.content.y<this.lastContentPosY)for(var L=this.mRealIndex.length-1;0<=L&&(h=this.mRealIndex[L],f=this.mRealIndex[0],g=k[h],_=k[f],(y=this.getPositionInView(g)).y<-D&&_.y+this.spacing+g.height<0);L--){if((I=(S=g.getComponent(s.default)).itemID-this.spawnCount)==0&&console.log(""),I==0){S.setLevel(this.musicInfoArray[I].level),S.setData(this.musicInfoArray[I],I),v=this.mRealIndex.pop(),this.mRealIndex.unshift(v),C=this.mContentGroupHeight+this.mLevelGroupHeight,g.tag=1,g.setPositionY(_.y+this.spacing+C);break}if(this.musicInfoArray[I].id==s.default.exceptionMoreId?(g.tag=0,g.height=this.mContentGroupHeight,S.removeLevel()):this.musicInfoArray[I].level!=this.musicInfoArray[I-1].level?(S.setLevel(this.musicInfoArray[I].level),g.tag=1,g.height=this.mContentGroupHeight+this.mLevelGroupHeight):(S.removeLevel(),g.tag=0,this.musicInfoArray[I].isCrownLock?g.height=this.mSpecialGroupHeight:g.height=this.mContentGroupHeight),S.setData(this.musicInfoArray[I],I),v=this.mRealIndex.pop(),this.mRealIndex.unshift(v),C=this.musicInfoArray[I].isCrownLock?g.tag==1?this.mSpecialGroupHeight+this.mLevelGroupHeight:this.mSpecialGroupHeight:g.tag==1?this.mContentGroupHeight+this.mLevelGroupHeight:this.mContentGroupHeight,g.setPositionY(_.y+this.spacing+C),this.musicInfoArray[I].isCrownLock){var b={isSpecial:!0};g.attr(b)}else b={isSpecial:!1},g.attr(b);L++}else for(L=0;L<this.mRealIndex.length&&(h=this.mRealIndex[L],T=this.mRealIndex[this.mRealIndex.length-1],g=this.items[h],E=this.items[T],y=this.getPositionInView(g),A=E.isSpecial?E.tag==1?this.mSpecialGroupHeight+this.mLevelGroupHeight:this.mSpecialGroupHeight:E.tag==1?this.mContentGroupHeight+this.mLevelGroupHeight:this.mContentGroupHeight,y.y>D&&E.y-A-this.spacing>-this.content.height);L++)I=(S=g.getComponent(s.default)).itemID+this.spawnCount,this.musicInfoArray[I].id==s.default.exceptionMoreId?(g.tag=0,g.height=this.mContentGroupHeight,S.removeLevel()):this.musicInfoArray[I].level!=this.musicInfoArray[I-1].level?(S.setLevel(this.musicInfoArray[I].level),g.tag=1,g.height=this.mContentGroupHeight+this.mLevelGroupHeight):(S.removeLevel(),g.tag=0,this.musicInfoArray[I].isCrownLock?g.height=this.mSpecialGroupHeight:g.height=this.mContentGroupHeight),S.setData(this.musicInfoArray[I],I),M=this.mRealIndex.shift(),this.mRealIndex.push(M),g.setPositionY(E.y-A-this.spacing),this.musicInfoArray[I].isCrownLock?(b={isSpecial:!0},g.attr(b)):(b={isSpecial:!1},g.attr(b)),L--;this.lastContentPosY=this.scrollView.content.y},p.prototype.scrollEvent=function(h,f){switch(f){case 0:case 1:case 2:case 3:break;case 4:this.update2()}},p.prototype.addHeight=function(){},p.prototype.rememberScrollPosition=function(){r.default.save(o.default.LEVEL_MUSIC_LIB_SCROLL_POSITION,this.scrollView.getScrollOffset().y+""),r.default.read(o.default.LEVEL_MUSIC_LIB_SCROLL_POSITION)},p.prototype.scrollToRememberPosition=function(){if(n.default.isHorizon())console.warn("== skip scrollToRememberPosition for horizontal ==");else{var h=r.default.read(o.default.LEVEL_MUSIC_LIB_SCROLL_POSITION);h?this.scrollView.scrollTo(cc.p(0,1-parseFloat(h)/this.scrollView.getMaxScrollOffset().y),.1):this.scrollView.scrollToTop()}},__decorate([a(cc.Prefab)],p.prototype,"itemPrefb",void 0),__decorate([a(cc.ScrollView)],p.prototype,"scrollView",void 0),__decorate([a],p.prototype,"spawnCount",void 0),__decorate([a],p.prototype,"totalCount",void 0),__decorate([a],p.prototype,"spacing",void 0),__decorate([a],p.prototype,"bufferZone",void 0),p=__decorate([i],p)}(cc.Component);m.default=u,cc._RF.pop()},{"../../../../config/LSKey":"LSKey","../../../Network/Protocol/StorageUtil":"StorageUtil","../../../keypad/KeypadUtil":"KeypadUtil","../../MusicLevelDataLoader":"MusicLevelDataLoader","../ImgCache":"ImgCache","./NormalMusicCardItemPrefb":"NormalMusicCardItemPrefb"}],LevelRewardData:[function(l,P,m){"use strict";cc._RF.push(P,"5e6e9cIfmtNrbRTmwKyQiwO","LevelRewardData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findLevel=function(n){return this.find("RewarID",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.LevelRewardData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getRewardID=function(){return this.getInt("RewarID")},e.prototype.getRewar1Exp=function(){return this.getInt("Rewar1Exp")},e.prototype.getRewar2ExpFirst=function(){return this.getInt("Rewar2ExpFirst")},e.prototype.getRewar3Exp=function(){return this.getInt("Rewar3Exp")},e.prototype.getRewar3Gold=function(){return this.getInt("Rewar3Gold")},e.prototype.getRewar3Goldline=function(){return this.getInt("Rewar3Goldline")},e.prototype.getRewarMax=function(){return this.getInt("RewarMax")},e.prototype.getRewarDaily=function(){return this.getInt("RewarDaily")},e.prototype.getRewarMax2=function(){return this.getInt("RewarMax2")},e.prototype.getRewarPro=function(){return this.getFloat("RewarPro")},e}(d.default);m.LevelRewardRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],LevelThreeTask:[function(l,P,m){"use strict";cc._RF.push(P,"e215d/Cz0NA0JFeYfCRdcnB","LevelThreeTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TaskItemImpl"),s=l("../../Logic/PlayerMgr"),r=l("../TaskItem"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.update=function(){var t=s.default.Ins().getUserLevel();3<=t?(this.currentStep=this.totalStep,this.status=r.TaskStatus.TASK_STATUS_SUCCESS):(this.currentStep=t,this.status=r.TaskStatus.TASK_STATUS_DOING)},n}(d.default);m.default=o,cc._RF.pop()},{"../../Logic/PlayerMgr":"PlayerMgr","../TaskItem":"TaskItem","./TaskItemImpl":"TaskItemImpl"}],LevelVideoGetSkinPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"0e24fmkzjpFor9goqYqOMsZ","LevelVideoGetSkinPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),s=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),r=l("../../base/Log"),o=l("../Logic/SkinDataManager"),e=l("../skin/SkinUtils"),n=l("../UI/GameEntraScene/PrefabMgr"),t=l("../UI/GameEntraScene/ToastPrefab"),i=l("../keypad/KeypadNavigator"),a=cc._decorator,u=a.ccclass,c=a.property,p=function(h){function f(){var _=h!==null&&h.apply(this,arguments)||this;return _.equitBtn=null,_.doubleBtn=null,_.skipBtn=null,_.closeBtn=null,_.closeCallback=null,_.useSkinLock=!1,_}var g;return __extends(f,h),(g=f).prototype.start=function(){var _=this;this.addListener(),this.scheduleOnce(function(){i.default.getInstance().pushDialog(_.node)},.1)},f.prototype.addListener=function(){this.closeBtn.on(cc.Node.EventType.TOUCH_END,this.closeComplete,this),this.equitBtn.on(cc.Node.EventType.TOUCH_END,this.equitComplete,this),this.doubleBtn.on(cc.Node.EventType.TOUCH_END,this.doubleComplete,this),this.skipBtn.on(cc.Node.EventType.TOUCH_END,this.skipComplete,this)},f.prototype.removeListener=function(){this.closeBtn.off(cc.Node.EventType.TOUCH_END,this.closeComplete,this),this.equitBtn.off(cc.Node.EventType.TOUCH_END,this.equitComplete,this),this.doubleBtn.off(cc.Node.EventType.TOUCH_END,this.doubleComplete,this),this.skipBtn.off(cc.Node.EventType.TOUCH_END,this.skipComplete,this)},f.prototype.equitComplete=function(){var _=this;if(this.useSkinLock)this.showToastTips("new skin loading !");else{this.useSkinLock=!0;var y=o.SkinDataMgr.Ins().getSkinListExceptDefault()[5],S=o.SkinDataMgr.Ins().getSkinItemInfo(y.name);e.default.useSkin(S,this.node,function(){},function(){_.useSkinLock=!1,_.showToastTips("Failed to load skin")},function(){_.closeComplete()},function(){_.useSkinLock=!1,_.showToastTips("Failed to use skin")})}},f.prototype.doubleComplete=function(){this.watchAds()},f.prototype.skipComplete=function(){this.closeComplete()},f.prototype.closeComplete=function(){i.default.getInstance().popDialog(this.node),this.removeListener(),this.node.parent.removeChild(this.node),this.closeCallback&&this.closeCallback()},f.prototype.watchAds=function(){var _=this,y=s.ADScene.SCENE_CM_PLAY_SKIN_WATCH_ADS;d.MGAdv.show(y,s.QQ_ADV_TYPE.VIDEO_TYPE_SKIN_UNLOCK,function(S){if(cc.isValid(_,!0))switch(S){case s.ADStat.NOT_NETWORK:_.showToastTips("No network available");break;case s.ADStat.SHOW_SUCCESS_CLOSE:r.default.i(g.TAG+" watchAds success "),_.onWatchAdsSuccess();break;case s.ADStat.SHOW_NOT_ENED_CLOSE:_.showToastTips("show not end close");break;case s.ADStat.SHOW_GET_AD_FAILED:_.showToastTips("No video ads available")}})},f.prototype.showToastTips=function(_){var y=this;n.default.load("prefab/ToastPrefab",function(S,I){I.getComponent(t.default).showTips(_,function(){I.destroy()}),y.node.addChild(I)})},f.prototype.onWatchAdsSuccess=function(){var _=o.SkinDataMgr.Ins().getSkinListExceptDefault()[5];o.SkinDataMgr.Ins().unlockSkin(_.name),this.doubleBtn.active=!1,i.default.getInstance().refreshPage(this.node)},f.TAG="LevelVideoGetSkinPrefab",__decorate([c(cc.Node)],f.prototype,"equitBtn",void 0),__decorate([c(cc.Node)],f.prototype,"doubleBtn",void 0),__decorate([c(cc.Node)],f.prototype,"skipBtn",void 0),__decorate([c(cc.Node)],f.prototype,"closeBtn",void 0),f=g=__decorate([u],f)}(cc.Component);m.default=p,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../base/Log":"Log","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../keypad/KeypadNavigator":"KeypadNavigator","../skin/SkinUtils":"SkinUtils"}],Level:[function(l,P,m){"use strict";cc._RF.push(P,"9ac8530fKlBjbH5kYz+IsOE","Level"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Dictionary"),s=function(){this.id=0,this.type=0,this.reward3Gold=-1,this.reward3Goldline=-1};m.Level=s;var r=function(){function p(){this.mid=0,this.musicLevel=0,this.bpmIncrease=0,this.musicTime=0,this.homeOrder=0,this.localMusicVer=0,this.musicCard=0,this._cells=new d.Dictionary}return p.prototype.insertMusicCell=function(h,f){this._cells.put(h,f)},p.prototype.getMusicCells=function(){return this._cells},p.prototype.getMusicCellCount=function(){return this._cells.size()},p}();m.LevelMusic=r;var o=function(){this.unlockType=0,this.unlockValue=0};m.LevelUnlock=o;var e=function(){function p(){this.m_Star=new d.Dictionary}return p.prototype.insertAward=function(h,f){this.m_Star.put(h,f)},p.prototype.getAward=function(h){return this.m_Star.get(h)},p}();m.AwardStar=e;var n=function(){this.BPM=0,this.musicCellid=0,this.aniID=0,this.bridgeAniID=0,this.baseBeats=0,this.volFactor=0,this.acceleration=0,this.startX=0,this.startY=0,this.endX=0,this.endY=0};m.MusicCell=n;var t=function(){this.gold=0,this.exp=0};m.Earnings=t;var i,a,u,c=function(){function p(){this._earnings=new d.Dictionary}return p.prototype.insertAward=function(h,f){this._earnings.put(h,f)},p.prototype.getAward=function(h){return this._earnings.get(h)},p}();m.ClearanceAward=c,(i=m.eLevelKind||(m.eLevelKind={}))[i.eLevel_Normal=1]="eLevel_Normal",i[i.eLevel_Gold=2]="eLevel_Gold",i[i.eLevel_Honor=3]="eLevel_Honor",i[i.eLevel_Diamond=4]="eLevel_Diamond",i[i.eLevel_Class=10]="eLevel_Class",i[i.eLevel_Popular=16]="eLevel_Popular",i[i.eLevel_Choiceness=19]="eLevel_Choiceness",(a=m.eUnlockType||(m.eUnlockType={}))[a.UNLOCK_TYPE_LV=1]="UNLOCK_TYPE_LV",a[a.UNLOCK_TYPE_GOLD=2]="UNLOCK_TYPE_GOLD",a[a.UNLOCK_TYPE_STAR=3]="UNLOCK_TYPE_STAR",a[a.UNLOCK_TYPE_DIAMOND=13]="UNLOCK_TYPE_DIAMOND",a[a.UNLOCK_TYPE_ACTIVITY=14]="UNLOCK_TYPE_ACTIVITY",a[a.UNLOCK_TYPE_LV_TRY=17]="UNLOCK_TYPE_LV_TRY",a[a.UNLOCK_TYPE_VIP=21]="UNLOCK_TYPE_VIP",a[a.UNLOCK_TYPE_VIDEO=22]="UNLOCK_TYPE_VIDEO",(u=m.eSymbolKind||(m.eSymbolKind={}))[u.eSymbolDefault=0]="eSymbolDefault",u[u.eSymbolOrigin=1]="eSymbolOrigin",cc._RF.pop()},{"../../util/Dictionary":"Dictionary"}],LifeData:[function(l,P,m){"use strict";cc._RF.push(P,"d7f45yR3VBGUppkSep3nrJo","LifeData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.LifeData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.getlv=function(){return this.getInt("lv")},e.prototype.getLife=function(){return this.getInt("Life")},e.prototype.getLifeRecovery=function(){return this.getInt("LifeRecovery")},e}(d.default);m.LifeRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],Lifecycle:[function(l,P,m){"use strict";cc._RF.push(P,"37584Vg2p1Avaj57Irfgasa","Lifecycle"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../social/SocialHelper"),s=l("../social/SocialManager"),r=l("../business/Network/Protocol/StorageUtil"),o=l("../infoc/m_p2_PData"),e=l("../business/Logic/PlayerMgr"),n=l("./G"),t=l("../business/Logic/EventBus"),i=l("../business/Logic/NotifyEvent"),a=l("../business/Logic/SkinDataManager"),u=l("../business/UI/GameEntraScene/MusicLib/InviteUnlockMusicCountdownUtil"),c=l("../infoc/minigame_piano2_leave_page"),p=l("../util/PageHeap"),h=function(){function f(){this.mIsInited=!1,this.mIsShow=!1,this.onShowFunc=null,this.onHideFunc=null}return f.getIntance=function(){return f.mInstance||(f.mInstance=new f),f.mInstance},f.prototype.init=function(){var g=this;this.mIsInited||(d.SocialHelper.onShowListen(function(_){g.onShow(_)}),d.SocialHelper.onHideListen(function(){g.onHide()}),this.onShowFunc=function(){console.log("--- onActivityShow ---"),g.onShow(null)},this.onHideFunc=function(){console.log("--- onActivityHide ---"),g.onHide()},CMPlay.onShow(this.onShowFunc),CMPlay.onHide(this.onHideFunc),this.mIsInited=!0,this.mIsShow=!0)},f.prototype.onShow=function(g){if(!this.mIsShow){this.mIsShow=!0,n.G.enterGameTime=new Date().getTime();var _=e.default.Ins();o.default.report(o.default.ENTER_GAME,0,_.getUserLevel(),_.getUserCurrentExp(),_.getUserCoin(),_.getHP(),_.getUserDiamond(),_.getTotalCrown(),_.getTotalStar(),o.default.HOT_AWAKE,a.SkinDataMgr.Ins().getCurSkin(),a.SkinDataMgr.Ins().getUnLockSkinNum()),s.default.getInstance().onShow(g),n.G.launchOption=g,t.default.fire(i.default.LIFE_CYCLE_ON_SHOW,g),u.default.Ins().updateServerTime()}},f.prototype.onHide=function(){if(this.mIsShow){this.mIsShow=!1,s.default.getInstance().onHide();var g=new Date().getTime(),_=0;n.G.enterGameTime!=null&&n.G.enterGameTime!=0&&(_=Math.ceil((g-n.G.enterGameTime)/1e3))<0&&(_=0);var y=e.default.Ins();o.default.report(o.default.EXIT_GAME,_,y.getUserLevel(),y.getUserCurrentExp(),y.getUserCoin(),y.getHP(),y.getUserDiamond(),y.getTotalCrown(),y.getTotalStar(),o.default.QUIT,a.SkinDataMgr.Ins().getCurSkin(),a.SkinDataMgr.Ins().getUnLockSkinNum()),c.default.report(p.default.Ins().toString()),r.default.pushAsync(),t.default.fire(i.default.LIFE_CYCLE_ON_HIDE)}},f.prototype.onNetworkStatusChange=function(g){n.G.networkType=g.networkType,n.G.networkIsConnected=g.isConnected},f}();m.default=h,cc._RF.pop()},{"../business/Logic/EventBus":"EventBus","../business/Logic/NotifyEvent":"NotifyEvent","../business/Logic/PlayerMgr":"PlayerMgr","../business/Logic/SkinDataManager":"SkinDataManager","../business/Network/Protocol/StorageUtil":"StorageUtil","../business/UI/GameEntraScene/MusicLib/InviteUnlockMusicCountdownUtil":"InviteUnlockMusicCountdownUtil","../infoc/m_p2_PData":"m_p2_PData","../infoc/minigame_piano2_leave_page":"minigame_piano2_leave_page","../social/SocialHelper":"SocialHelper","../social/SocialManager":"SocialManager","../util/PageHeap":"PageHeap","./G":"G"}],List:[function(l,P,m){"use strict";cc._RF.push(P,"53780t0F8JPo6ru/BIw7o07","List"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.data=null,this.prev=null,this.next=null},s=function(){function r(){this.create()}return r.prototype.push=function(o){var e=this.tail.prev,n=new d;n.data=o,n.next=null,(n.prev=e).next=n,this.tail.prev=n},r.prototype.pop=function(){var o=this.tail.prev;if(o===this.head)return null;var e=o.prev;return e.next=this.tail,this.tail.prev=e,o.data},r.prototype.at=function(o){return o.data},r.prototype.begin=function(){return this.head.next},r.prototype.next=function(o){return o.next},r.prototype.end=function(){return this.tail},r.prototype.create=function(){this.head=new d,this.tail=new d,this.tail.prev=this.head,this.head.next=this.tail},r}();m.default=s,cc._RF.pop()},{}],LoaderInit:[function(l,P,m){"use strict";cc._RF.push(P,"5cdb370AsZO/pIANCF9T3mD","LoaderInit"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BeginFrameLoader"),s=l("./GameSceneFrameLoader"),r=l("./NumberFrameLoader"),o=l("./KeypadFrameLoader");(m.LoaderInit||(m.LoaderInit={})).initilize=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){switch(n.label){case 0:return[4,d.default.getInstance().init()];case 1:return n.sent(),s.default.getInstance().init(function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,r.default.getInstance().init()];case 1:return t.sent(),[4,o.default.getInstance().init()];case 2:return t.sent(),[2]}})})},this),[2]}})})},cc._RF.pop()},{"./BeginFrameLoader":"BeginFrameLoader","./GameSceneFrameLoader":"GameSceneFrameLoader","./KeypadFrameLoader":"KeypadFrameLoader","./NumberFrameLoader":"NumberFrameLoader"}],LoadingFailedPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"97237Bflm5BF75opDQI3BEB","LoadingFailedPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BasicTouchEvent"),s=l("../../../util/StringUtil"),r=l("../../../util/PU"),o=l("../../../../modules/MGUtils/QQHelper"),e=l("../../Logic/I18nManager"),n=cc._decorator,t=n.ccclass,i=n.property,a=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.retryAgain=null,p.labelMsg=null,p.mErrorCode=null,p.callback=null,p}return __extends(c,u),c.prototype.onLoad=function(){var p=this;this.retryAgain.node.on(cc.Node.EventType.TOUCH_END,this.retryBtnTouchCallback,this);var h=new d.default(function(){p.showPlayerId()});this.labelMsg.node.on(cc.Node.EventType.TOUCH_END,h.click,h),this.updateTips()},c.prototype.showPlayerId=function(){var p=this;r.default.isQQ()&&o.QQHelper.fetchOpenKey({success:function(h){cc.isValid(p,!0)&&h&&p.labelMsg.string.indexOf(h)==-1&&(p.labelMsg.string+="\n("+h+")")}})},c.prototype.updateTips=function(){var p="\u8D44\u6E90\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u72B6\u6001\u540E\u91CD\u8BD5";e.default.getInstance().isEnglish()&&(p="Loading failed.Please check the network and try again"),s.StringUtil.isNullOrUndefined(this.mErrorCode)||(p=p+"\uFF08"+this.mErrorCode+"\uFF09"),this.labelMsg.string=p},c.prototype.retryBtnTouchCallback=function(){this.callback&&this.callback()},c.prototype.setErrorCode=function(p){this.mErrorCode=p},c.prototype.setRetryCallback=function(p){this.callback=p},__decorate([i(cc.Button)],c.prototype,"retryAgain",void 0),__decorate([i(cc.Label)],c.prototype,"labelMsg",void 0),c=__decorate([t],c)}(cc.Component);m.default=a,cc._RF.pop()},{"../../../../modules/MGUtils/QQHelper":"QQHelper","../../../util/PU":"PU","../../../util/StringUtil":"StringUtil","../../Logic/I18nManager":"I18nManager","./BasicTouchEvent":"BasicTouchEvent"}],LoadingScene:[function(l,P,m){"use strict";cc._RF.push(P,"747e7T6bQZNb6qvf3Adh4W7","LoadingScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/G"),s=l("../../../gamescene/element/loader/LoaderInit"),r=l("../../../base/GameApp"),o=l("../../../base/Log"),e=l("../../Logic/Plugin/PluginMgr"),n=l("../../Logic/PlayerMgr"),t=l("../../Network/Protocol/StorageUtil"),i=l("../../../config/LSKey"),a=l("../../../social/SocialHelper"),u=l("../../Logic/EventBus"),c=l("../../Logic/NotifyEvent"),p=l("./LoadingFailedPrefab"),h=l("../../../base/Lifecycle"),f=l("../../../social/SocialManager"),g=l("../../../infoc/m_p2_PData"),_=l("../../../util/SUtil"),y=l("../../../util/PU"),S=l("../../Logic/SkinDataManager"),I=l("../../../upgrade/ResMgr"),v=l("../../../infoc/Infoc"),C=l("../../../base/CrashMonitor"),T=l("../../skin/SkinManager"),E=l("../../../base/GameInfoMgr"),A=l("../../../infoc/m_p2_DL"),M=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),k=l("../../Network/Protocol/MemCache"),D=l("./PrefabMgr"),L=l("./GameEntranceScene"),b=l("../../../gamescene/MUI/MUIDefines"),N=l("../../../LogicPlatform/PlatformProxy"),H=l("../../../../modules/MGAppShare/scripts/MGShareUtil"),R=l("../../../../modules/MGAppShare/scripts/ShareHelper"),F=l("../../DB/DBMgr"),x=l("../UserInfoBtnManager"),U=l("../../../util/QQReport"),B=l("./../../propAddition/Define"),Q=l("../../../../modules/MGBasic/scripts/LocalStorageHelplerWeb"),Z=l("../HotmusicActivityMgr"),z=l("./PreLoadAssets"),W=l("../../../business/Logic/I18nManager"),V=cc._decorator,Y=V.ccclass,q=V.property;cc.sys.platform==cc.sys.QQ_PLAY&&(Promise=l("../../../../../node_modules/promise"));var J=function(ee){function $(){var j=ee!==null&&ee.apply(this,arguments)||this;return j.downloadProgress=null,j.downloadPrgBar=null,j.downloadSprite=null,j.headPhoneSprite=null,j.headPhoneTips=null,j.staticTips=null,j.downloadFailedMaskLayout=null,j.mRightNode=null,j.mRightLine1=null,j.mRightLine2=null,j.version_label=null,j.gd_label=null,j.mLastProgress=-1,j.download_total_prg=79,j.load_image_total_prg=5,j.load_db_total_prg=15,j.mDownloadTotalPercent=1,j.mProgressMap=new Object,j.mPullUserOpportunity=1,j.USER_PULL_DATA_NOW=1,j.USER_DELAY_PULL_DATA=2,j.USER_ERROR=3,j.USER_NEW=4,j}return __extends($,ee),$.prototype.onLoadingProgressChanged=function(j,ie){var oe=this;try{if(console.info("onLoadingProgressChanged =>"+event+"  args="+JSON.stringify(ie)),c.default.LOADING_DOWNLOAD===j){if(this.mProgressMap[ie[0]]!=ie[1]){this.mProgressMap[ie[0]]=ie[1];var ue=Object.keys(this.mProgressMap),pe=0;ue.forEach(function(he){pe+=oe.mProgressMap[he]});var de=pe/(1*this.mDownloadTotalPercent);this.setGlobalProgress(de*this.download_total_prg)}}else c.default.LOADING_IMAGE===j?this.setGlobalProgress(this.download_total_prg+ie*this.load_image_total_prg):c.default.LOADING_DB===j&&this.setGlobalProgress(this.download_total_prg+this.load_image_total_prg+ie*this.load_db_total_prg)}catch(he){o.default.e("[LoadingScene] onLoadingProgressChanged:"+he,j,ie)}},$.prototype.setGlobalProgress=function(j){if(Number.isNaN(j)&&(j=0),j=parseInt(j+""),!(this.mLastProgress>=j)){this.mLastProgress=j,W.default.getInstance().isEnglish()?this.downloadProgress.string="Loading music resources..."+j+"%":this.downloadProgress.string="\u6B63\u5728\u52A0\u8F7D\u97F3\u4E50\u8D44\u6E90..."+j+"%",this.downloadPrgBar.progress=j/100;var ie=this.downloadPrgBar.getComponent(cc.Widget);this.downloadSprite.getComponent(cc.Widget).node.x=ie.node.x+ie.node.width*j/100}},$.prototype.initUI=function(j){j?(this.downloadProgress.node.active=!0,this.downloadPrgBar.node.active=!0,this.downloadSprite.node.active=!0,this.headPhoneSprite.node.active=!1,this.headPhoneTips.node.active=!1):(this.downloadProgress.node.active=!1,this.downloadPrgBar.node.active=!1,this.downloadSprite.node.active=!1,this.headPhoneSprite.node.active=!0,this.headPhoneTips.node.active=!0)},$.prototype.setBg=function(j){},$.prototype.updateUI=function(j,ie){if(c.default.LOADING_UI_NOTIFY===j){this.setGlobalProgress(0);var oe="";ie&&0<ie.length&&(oe=ie[0]),this.mDownloadTotalPercent=1;for(var ue=Object.keys(this.mProgressMap),pe=0;pe<ue.length;pe++)delete this.mProgressMap[ue[pe]];oe=="download"&&1<oe.length&&(this.mDownloadTotalPercent=ie[1]),this.initUI(oe=="download")}},$.prototype.showLoadingFailed=function(j,ie,oe){var ue=this;D.default.load("prefab/LoadingFailedPrefab",function(pe,de){var he=de.getComponent(p.default);he.setErrorCode(ie),he.setRetryCallback(function(){de.destroy(),oe?oe():ue.doLoad()}),ue.downloadFailedMaskLayout.node.addChild(de)})},$.prototype.resetDownloadProgress=function(){this.mLastProgress=-1},$.prototype.checkResFileIsExist=function(j){var ie=y.default.getResourcePath("resources/DB/level.txt");N.default.Ins().getFileSystemManager().access({path:ie,success:function(oe){j(!!oe)},fail:function(oe){o.default.i("LoadingScence. checkResFileIsExist ",ie,oe.errMsg),j(!1)}})},$.prototype.onDestroy=function(){u.default.remove(c.default.LIFE_CYCLE_ON_SHOW,this.onShow,this),u.default.remove(c.default.LIFE_CYCLE_ON_HIDE,this.onHide,this),cc.sys.garbageCollect()},$.prototype.updateMUIGlobal=function(){cc._renderType!==cc.game.RENDER_TYPE_CANVAS?b.MUI.global.initilize(b.MUI.RenderType.WEBGL,cc.game.canvas.getContext("webgl"),cc.game.canvas.width,cc.game.canvas.height):b.MUI.global.initilize(b.MUI.RenderType.CANVAS,cc.game.canvas.getContext("2d"),cc.game.canvas.width,cc.game.canvas.height)},$.prototype.onLoad=function(){console.log("[loadingscene] onload0");var j=E.GameInfoMgr.Ins().getInfo();Q.LocalStorageHelperWeb.init(j.gameid),o.default.init(j),y.default.init(),y.default.initGameModel(j,o.default.isDebug()),x.UserInfoBtnManager.getInstance().init(),this.saveFirstEnterTime(),console.log("[loadingscene] onload1"),this.updateMUIGlobal(),this.doInit()},$.prototype.saveFirstEnterTime=function(){var j=t.default.read(i.default.FIRST_ENTER_TIME);if(j==null||j==null||j.length==0){var ie=new Date().getTime();t.default.save(i.default.FIRST_ENTER_TIME,ie+"")}},$.prototype.doInit=function(){var j=this;this.init(E.GameInfoMgr.Ins().getInfo(),function(){j.initGlobalInfo(),j.doLoad()})},$.prototype.init=function(j,ie){var oe=this;console.log("[loadingscene] init"),j&&(this.version_label&&this.version_label.isValid&&(this.version_label.string="1.9.27.1"),Date.now(),console.info("start getuserinfo."),M.MGUser.getUserBasicInfo({complete:function(ue){console.info("getuserinfo finished."),oe.tryStartupTestReportServer(),Date.now(),y.default.initGameUserModel(j,o.default.isDebug(),function(pe){(pe=!0)?I.default.Ins().init(function(de){if(!y.default.isCM()&&!y.default.isWeb())for(var he=I.default.Ins().getBasicInfoBeans(),me=0;me<he.length&&!(he[me]&&he[me].isNeedUpdate());++me);ie()}):oe.showLoadingFailed("gameUserLoginInfoFailed","001",oe.doInit.bind(oe))})}}))},$.prototype.tryStartupTestReportServer=function(){t.default.read(i.default.CMG_USE_INOFC_DEBUG_SERVER,"0")=="1"&&(v.Infoc.UseTestReportHost=!0)},$.prototype.initGlobalInfo=function(){if(u.default.register(c.default.LIFE_CYCLE_ON_SHOW,this.onShow,this),u.default.register(c.default.LIFE_CYCLE_ON_HIDE,this.onHide,this),C.default.begin(),d.G.Ap==null){d.G.Ap=new r.default;var j=function(){var ie=d.G.Ap.config;ie.presentScale=cc.game.canvas.width/ie.designWidth,ie.presentWidth=ie.designWidth,ie.presentHeight=Math.floor(cc.game.canvas.height/ie.presentScale),ie.mBaseBlockWidth=ie.presentWidth>>>2,ie.mBaseBlockHeight=ie.presentHeight>>>2,ie.mBaseBlockWidthScale=1,ie.mBaseBlockHeightScale=ie.mBaseBlockHeight/ie.designBlockHeight,this.updateMUIGlobal()}.bind(this);window.addEventListener("resize",function(){j()}),j()}d.G.propAddition==null&&(d.G.propAddition=new B.PropAddition),d.G.enterGameTime=new Date().getTime(),_.SUtil.ins().isLiuHai()?d.G.Ap.skinMgr.setScreenType("s3"):_.SUtil.ins().isQuanMian()?d.G.Ap.skinMgr.setScreenType("s2"):_.SUtil.ins().isPuTong()&&d.G.Ap.skinMgr.setScreenType("s1")},$.prototype.doLoad=function(){var j=this;console.log("[loadingscene] doload"),this.registLoadingEvent(),N.default.Ins().needDownloadRes()?(o.default.l("[LoadingScene] platform need download res"),this.adapterUI(),this.validateLocalRes(function(){a.SocialHelper.updateCache(),j.startup()})):z.PreLoadAssets.preload(function(){a.SocialHelper.updateCache(),j.startup()}),t.default.save(i.default.HAS_SCORLL_TO_TARGET_POSITION,"false"),t.default.save(i.default.HAS_SHOW_HOME_PAGE,"false")},$.prototype.adapterUI=function(){_.SUtil.ins().isLiuHai()?(_.SUtil.ins().toBottomByPercent(this.downloadProgress,20.9),_.SUtil.ins().toBottomByPercent(this.downloadPrgBar,17.2),_.SUtil.ins().toBottomByPercent(this.downloadSprite,17.1),_.SUtil.ins().toBottomByPercent(this.headPhoneSprite,22.84),_.SUtil.ins().toBottomByPercent(this.headPhoneTips,22.39),_.SUtil.ins().toBottomByPercent(this.staticTips,8.8),this.setBg(0),this.mRightNode.height=127,_.SUtil.ins().toBottomByPercent(this.mRightNode,0),_.SUtil.ins().toTop(this.mRightLine1,1.2),_.SUtil.ins().toTop(this.mRightLine2,3),_.SUtil.ins().toBottomByPercent(this.mRightLine1,5.4),_.SUtil.ins().toBottomByPercent(this.mRightLine2,3.6),_.SUtil.ins().toTopByPixel(this.version_label,104)):_.SUtil.ins().isQuanMian()?(_.SUtil.ins().toBottomByPercent(this.downloadProgress,19.6),_.SUtil.ins().toBottomByPercent(this.downloadPrgBar,15.8),_.SUtil.ins().toBottomByPercent(this.downloadSprite,15.4),_.SUtil.ins().toBottomByPercent(this.headPhoneSprite,21.37),_.SUtil.ins().toBottomByPercent(this.headPhoneTips,20.9),_.SUtil.ins().toBottomByPercent(this.staticTips,6.5),this.mRightNode.height=83,_.SUtil.ins().toBottomByPercent(this.mRightNode,0),_.SUtil.ins().toTop(this.mRightLine1,1),_.SUtil.ins().toTop(this.mRightLine2,3),_.SUtil.ins().toBottomByPercent(this.mRightLine1,3),_.SUtil.ins().toBottomByPercent(this.mRightLine2,1),_.SUtil.ins().toTopByPixel(this.version_label,45),this.setBg(-40)):_.SUtil.ins().isPuTong()&&this.setBg(-140)},$.prototype.registLoadingEvent=function(){u.default.register(c.default.LOADING_UI_NOTIFY,this.updateUI,this),u.default.register(c.default.LOADING_DOWNLOAD,this.onLoadingProgressChanged,this),u.default.register(c.default.LOADING_IMAGE,this.onLoadingProgressChanged,this),u.default.register(c.default.LOADING_DB,this.onLoadingProgressChanged,this)},$.prototype.removeLoadingNotifyEvent=function(){u.default.remove(c.default.LOADING_DOWNLOAD,this.onLoadingProgressChanged,this),u.default.remove(c.default.LOADING_IMAGE,this.onLoadingProgressChanged,this),u.default.remove(c.default.LOADING_DB,this.onLoadingProgressChanged,this),u.default.remove(c.default.LOADING_UI_NOTIFY,this.updateUI,this)},$.prototype.validateLocalRes=function(j){var ie=this;this.resetDownloadProgress(),o.default.i("ResManager.gIns().init"),Date.now(),this.checkResFileIsExist(function(oe){oe==0&&I.default.Ins().clearLocalResInfo(),A.default.start(),I.default.Ins().downloadBasicRes(I.default.Ins().getBasicInfoBeans()).then(function(ue){j&&j()},function(){ie.removeLoadingNotifyEvent(),ie.showLoadingFailed("resDonwloadError","100")})})},$.prototype.onShow=function(){},$.prototype.onHide=function(){},$.prototype.startup=function(){return __awaiter(this,void 0,void 0,function(){var j=this;return __generator(this,function(ie){return this.doWork(function(){Date.now(),j.loadSkin(function(){j.reportPlayerData(),j.switchScene()},function(){j.showLoadingFailed("loadSkinError","300")})},function(){j.showLoadingFailed("doworkError","200")}),[2]})})},$.prototype.doWork=function(j,ie){return __awaiter(this,void 0,void 0,function(){var oe,ue,pe=this;return __generator(this,function(de){switch(de.label){case 0:H.MGShareUtils.initShare(),h.default.getIntance().init(),(oe=a.SocialHelper.getLaunchParameter())&&oe.query&&oe.query.source?console.log("doWork Launch Option  source \u5B57\u6BB5\u5B58\u5728"+oe.query.source):console.log("doWork Launch Option  source \u5B57\u6BB5\u4E0D\u5B58\u5728"),U.QQReport.reportUnLockSong(0),de.label=1;case 1:return de.trys.push([1,3,,4]),Date.now(),[4,s.LoaderInit.initilize()];case 2:return de.sent(),[3,4];case 3:return ue=de.sent(),o.default.e("[LoadingScene] LoaderInit.initilize error: ",ue),ie(),[2];case 4:return Date.now(),F.default.Ins().loadAllDataAsync(function(){return __awaiter(pe,void 0,void 0,function(){var he=this;return __generator(this,function(me){return n.default.Ins().init(),e.default.Ins().init(),Date.now(),n.default.Ins().pullCloudInfo().then(function(){he.afterLoadBasicData(j),setTimeout(function(){M.MGUser.uploadUserLevelInfo({user_level:n.default.Ins().getUserLevel()})})}),[2]})})}),d.G.Ap.initlizeOnLoadFinish(),[2]}})})},$.prototype.getPullCloudDataOpportunity=function(){var j=this;return new Promise(function(ie,oe){M.MGUser.getUserLoginInfo({complete:function(ue){ue?ue.isNewUser?ie(j.USER_NEW):ue.isNewUser||k.MemCache.Ins().hasLocalData()?ie(j.USER_DELAY_PULL_DATA):ie(j.USER_PULL_DATA_NOW):ie(j.USER_ERROR)}})})},$.prototype.afterLoadBasicData=function(j){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(ie){return(y.default.isQQ()||y.default.isWeiXin())&&a.SocialHelper.refreshSelfRankData(),this.removeLoadingNotifyEvent(),d.G.Ap.initializeOnLoadDataFinish(),Z.default.Ins().init(j),[2]})})},$.prototype.loadSkin=function(j,ie){var oe=this;T.SkinMgr.Ins().checkCurrentSkinTimeLimit();var ue=S.SkinDataMgr.Ins().getCurSkinItemInfo();o.default.i("loadSkin:",ue),S.SkinDataMgr.isSkinExist(ue.name,function(pe){if(pe){if(S.SkinDataMgr.SKIN_DEFAULT==ue.name)return void oe.changeSkin(ue,j,function(){oe.loadDefaultSkin(j,ie)});var de=I.default.Ins().getSkinBean(ue.name);if(de==null)return void ie();de.isNeedUpdate()?(o.default.w("update skin start.",de),S.SkinDataMgr.downloadSkin(ue.name,j,ie).then(function(){o.default.w("update skin finish.",de),oe.changeSkin(ue,j,function(){oe.loadDefaultSkin(j,ie)})},function(){ie()})):oe.changeSkin(ue,j,function(){oe.loadDefaultSkin(j,ie)})}else oe.loadDefaultSkin(j,ie)})},$.prototype.changeSkin=function(j,ie,oe){S.SkinDataMgr.Ins().changeSkin(j,function(ue){ue==0?ie():oe()},function(){oe()})},$.prototype.loadDefaultSkin=function(j,ie){this.changeSkin(S.SkinDataMgr.Ins().getDefaultSkinItem(),j,ie)},$.prototype.switchScene=function(){var j=a.SocialHelper.getLaunchParameter();j&&j.query&&j.query.source?console.log("switchScene Launch Option  source \u5B57\u6BB5\u5B58\u5728"+j.query.source):console.log("switchScene Launch Option  source \u5B57\u6BB5\u4E0D\u5B58\u5728"),f.default.shouldEnterGameSceneByHotSongShare(j)?(f.default.getInstance().enterGameForHotSong(j),t.default.save(i.default.ENTER_GAME_BY_HOT_SONG_SHARE,"true")):(this.toSpcialPage(j),this.gotoMainPage())},$.prototype.toSpcialPage=function(j){j&&j.query&&j.query.src&&j.query.src==a.SocialHelper.SHARE_TYPE_SHARE&&j.query.source&&(j.query.source==R.ShareHelper.SHARE_SOURCE_INVITE_SONG?L.default.DefaultPageIndex=L.default.GAME_ENTRA_SCENE_INDEX.TO_HOT_INDEX:j.query.source==R.ShareHelper.SHARE_SOURCE_FIGHT_WIN&&(L.default.DefaultPageIndex=L.default.GAME_ENTRA_SCENE_INDEX.TO_FIGHT_INDEX))},$.prototype.gotoMainPage=function(){this.mGotoMainPageListener()},$.prototype.reportPlayerData=function(){var j=n.default.Ins();g.default.report(g.default.ENTER_GAME,0,j.getUserLevel(),j.getUserCurrentExp(),j.getUserCoin(),j.getHP(),j.getUserDiamond(),j.getTotalCrown(),j.getTotalStar(),g.default.COLD_AWAKE,S.SkinDataMgr.Ins().getCurSkin(),S.SkinDataMgr.Ins().getUnLockSkinNum())},$.prototype.setGotoMainPageListener=function(j){this.mGotoMainPageListener=j},$.prototype.preloadEnglishRes=function(j){window.i18n.curLang=="en"?cc.loader.loadResArray(["/static_res/share_gift_congratulation_title_en","/static_res/share_gift_congratulation_title_en","/static_res/btn_getreward_normal_en","/static_res/btn_getreward_press_en","static_res/gameover/relive_by_video_with_dash_en","static_res/gameover/relive_by_video_with_sheild_en","static_res/gamestore_en","/static_res/button_daily_checkin_award_normal_en","/static_res/button_daily_checkin_award_pressed_en","/static_res/share_gift_congratulation_title_en","static_res/gamestore_en","/static_res/share_gift_congratulation_title_en","/ui/skin_store_use_default_press_en","/ui/skin_store_use_default_en","/static_res/share_gift_congratulation_title_en","static_res/homepage/home_music_lib_icon_en","static_res/homepage/home_music_lib_icon_press_en","static_res/homepage/home_hot_music_icon_en","static_res/homepage/home_hot_music_icon_press_en","static_res/homepage/home_lottary_btn_en","static_res/homepage/home_lottary_btn_press_en","static_res/homepage/home_chosen_music_en","static_res/homepage/home_chosen_music_press_en","static_res/homepage/home_daily_btn_en","static_res/homepage/home_daily_btn_press_en","/musiclist/new_music_corner_icon_en","/static_res/share_gift_congratulation_title_en","gameImage/gameScene2_en","static_res/gamestore_en"],function(){j&&j()}):j&&j()},__decorate([q(cc.Label)],$.prototype,"downloadProgress",void 0),__decorate([q(cc.ProgressBar)],$.prototype,"downloadPrgBar",void 0),__decorate([q(cc.Sprite)],$.prototype,"downloadSprite",void 0),__decorate([q(cc.Sprite)],$.prototype,"headPhoneSprite",void 0),__decorate([q(cc.Label)],$.prototype,"headPhoneTips",void 0),__decorate([q(cc.Label)],$.prototype,"staticTips",void 0),__decorate([q(cc.Layout)],$.prototype,"downloadFailedMaskLayout",void 0),__decorate([q(cc.Node)],$.prototype,"mRightNode",void 0),__decorate([q(cc.Node)],$.prototype,"mRightLine1",void 0),__decorate([q(cc.Node)],$.prototype,"mRightLine2",void 0),__decorate([q(cc.Label)],$.prototype,"version_label",void 0),__decorate([q(cc.Label)],$.prototype,"gd_label",void 0),$=__decorate([Y],$)}(cc.Component);m.default=J,cc._RF.pop()},{"../../../../../node_modules/promise":1,"../../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../../modules/MGAppShare/scripts/ShareHelper":"ShareHelper","../../../../modules/MGBasic/scripts/LocalStorageHelplerWeb":"LocalStorageHelplerWeb","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../LogicPlatform/PlatformProxy":"PlatformProxy","../../../base/CrashMonitor":"CrashMonitor","../../../base/G":"G","../../../base/GameApp":"GameApp","../../../base/GameInfoMgr":"GameInfoMgr","../../../base/Lifecycle":"Lifecycle","../../../base/Log":"Log","../../../business/Logic/I18nManager":"I18nManager","../../../config/LSKey":"LSKey","../../../gamescene/MUI/MUIDefines":"MUIDefines","../../../gamescene/element/loader/LoaderInit":"LoaderInit","../../../infoc/Infoc":"Infoc","../../../infoc/m_p2_DL":"m_p2_DL","../../../infoc/m_p2_PData":"m_p2_PData","../../../social/SocialHelper":"SocialHelper","../../../social/SocialManager":"SocialManager","../../../upgrade/ResMgr":"ResMgr","../../../util/PU":"PU","../../../util/QQReport":"QQReport","../../../util/SUtil":"SUtil","../../DB/DBMgr":"DBMgr","../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../Logic/PlayerMgr":"PlayerMgr","../../Logic/Plugin/PluginMgr":"PluginMgr","../../Logic/SkinDataManager":"SkinDataManager","../../Network/Protocol/MemCache":"MemCache","../../Network/Protocol/StorageUtil":"StorageUtil","../../skin/SkinManager":"SkinManager","../HotmusicActivityMgr":"HotmusicActivityMgr","../UserInfoBtnManager":"UserInfoBtnManager","./../../propAddition/Define":"Define","./GameEntranceScene":"GameEntranceScene","./LoadingFailedPrefab":"LoadingFailedPrefab","./PreLoadAssets":"PreLoadAssets","./PrefabMgr":"PrefabMgr"}],LoadingTimecost:[function(l,P,m){"use strict";cc._RF.push(P,"413ceOUNY9CZZgKaUnJhgAq","LoadingTimecost"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/Log"),s=function(){function r(){}return r.start=function(){d.default.isDebug()&&(r.startTime=Date.now(),r.lastTime=r.startTime,r.content="[LoadingTimecost] ")},r.mark=function(o){if(d.default.isDebug()){var e=Date.now();r.content+=o+" "+(e-r.lastTime)+"ms,\n",r.lastTime=e}},r.end=function(){if(d.default.isDebug()){var o=Date.now();r.content+="total_timecost: "+(o-r.startTime)+"ms",console.warn(r.content)}},r.content="",r}();m.default=s,cc._RF.pop()},{"../base/Log":"Log"}],LocalStorageHelplerWeb:[function(l,P,m){"use strict";cc._RF.push(P,"66a89OFDOVHlLyjpwT14Iqc","LocalStorageHelplerWeb"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.init=function(r){s.mGameid=r},s.setItem=function(r,o){var e=s.mGameid+"_"+r;return cc.sys.localStorage.setItem(e,o),!0},s.getItem=function(r){var o=s.mGameid+"_"+r,e=cc.sys.localStorage.getItem(o);if(e!=null&&e!=null)return e;var n=cc.sys.localStorage.getItem(r);return n!=null&&n!=null&&s.setItem(r,n),n},s.removeItem=function(r){var o=s.mGameid+"_"+r;return cc.sys.localStorage.removeItem(o),!0},s.mGameid="0",s}();m.LocalStorageHelperWeb=d,cc._RF.pop()},{}],LocalizedLabel:[function(l,P,m){"use strict";cc._RF.push(P,"744dcs4DCdNprNhG0xwq6FK","LocalizedLabel");var d=l("LanguageData");cc.Class({extends:cc.Component,editor:{executeInEditMode:!0,menu:"i18n/LocalizedLabel"},properties:{dataID:{get:function(){return this._dataID},set:function(s){this._dataID!==s&&(this._dataID=s,this.updateLabel())}},_dataID:""},onLoad:function(){d.inst||d.init(),this.fetchRender()},fetchRender:function(){var s=this.getComponent(cc.Label);if(s)return this.label=s,void this.updateLabel()},updateLabel:function(){this.label?d.t(this.dataID)&&(this.label.string=d.t(this.dataID)):cc.error("Failed to update localized label, label component is invalid!")}}),cc._RF.pop()},{LanguageData:"LanguageData"}],LocalizedSprite:[function(l,P,m){"use strict";cc._RF.push(P,"f34ac2GGiVOBbG6XlfvgYP4","LocalizedSprite");var d=l("SpriteFrameSet");cc.Class({extends:cc.Component,editor:{executeInEditMode:!0,inspector:"packages://i18n/inspector/localized-sprite.js",menu:"i18n/LocalizedSprite"},properties:{spriteFrameSet:{default:[],type:d}},onLoad:function(){this.fetchRender()},fetchRender:function(){var s=this.getComponent(cc.Sprite);if(s)return this.sprite=s,void this.updateSprite(window.i18n.curLang)},getSpriteFrameByLang:function(s){for(var r=0;r<this.spriteFrameSet.length;++r)if(this.spriteFrameSet[r].language===s)return this.spriteFrameSet[r].spriteFrame},updateSprite:function(s){if(this.sprite){var r=this.getSpriteFrameByLang(s);!r&&this.spriteFrameSet[0]&&(r=this.spriteFrameSet[0].spriteFrame),this.sprite.spriteFrame=r}else cc.error("Failed to update localized sprite, sprite component is invalid!")}}),cc._RF.pop()},{SpriteFrameSet:"SpriteFrameSet"}],Log4JS:[function(l,P,m){"use strict";cc._RF.push(P,"1dfa3KcUYxBP5itOtSWAX7Y","Log4JS"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./LRUCache"),s=l("../util/StringUtil"),r=function(){function o(){}return o.appendLog4JS=function(e,n){n===void 0&&(n="loading"),o.mCache||(o.mCache=d.default.Ins("log.txt")).remove(n);var t=o.mCache.read(n);s.StringUtil.isEmpty(t)?t=e:t+="\r\n"+e,o.mCache.batchSaveStart(),o.mCache.save(n,t),setTimeout(function(){o.mCache.batchSaveEnd()},1e3)},o.l=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];o.appendLog4JS(o.getSingleStr.apply(o,[e].concat(n)))},o.getSingleStr=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];s.StringUtil.isNullOrUndefined(e)&&(e="");var i=o.getPrefix();return i+=typeof e=="string"?e:o.toJsonString(e),n&&0<n.length&&(i+="   \u3010"+o.toJsonString(n)+"\u3011"),i},o.toJsonString=function(e){if(e==null||e==null)return"";try{return JSON.stringify(e)}catch(n){return""}},o.formatDateTime=function(){var e=new Date,n=e.getHours().toString(),t=e.getMinutes().toString(),i=e.getSeconds().toString(),a=e.getMilliseconds().toString();if(t.length<2&&(t="0"+t),i.length<2&&(i="0"+i),a.length<3)for(var u=0;u<3-a.length;u++)a="0"+a;return n+":"+t+":"+i+" "+a},o.getPrefix=function(){return this.formatDateTime()+"  =>  "},o}();m.default=r,cc._RF.pop()},{"../util/StringUtil":"StringUtil","./LRUCache":"LRUCache"}],LoginRewardManager:[function(l,P,m){"use strict";cc._RF.push(P,"6130b/zcsRIqII1QWz3wGOm","LoginRewardManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=function(){function o(){}return o.Ins=function(){return o.mInstance||(o.mInstance=new o),o.mInstance},o.prototype.getLoginRewardVM=function(e){for(var n=[],t=0,i=d.default.Ins().getDBRows(d.eDataBase.eDB_LoginReward,e+"");t<i.length;t++){var a=i[t],u=new r;u.id=a.getId(),u.logOnDays=a.getLogOnDays(),u.newComing=a.getNewComing(),u.skinPiece=a.getSkinPiece(),u.diamonds=a.getDiamonds(),u.skins=a.getSkins(),n.push(u)}return Object.seal(n)},o}();m.LoginRewardMgr=s;var r=function(){};m.LoginRewardVM=r,cc._RF.pop()},{"../DB/DBMgr":"DBMgr"}],LoginReward:[function(l,P,m){"use strict";cc._RF.push(P,"58c9cxmadBLIoVn4H68M3gH","LoginReward"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findLoginRewardById=function(n){return this.find("id",n)},e.prototype.findLoginRewardsByNewCome=function(n){var t=this.csvGetRows("new_coming",n),i=[];if(t&&0<t.length)for(var a=0,u=t;a<u.length;a++){var c=u[a],p=new r;p.mRowData=c,p.mCsvFile=this,i.push(p)}return Object.seal(i)},e.prototype.getAllLoginReward=function(){return Object.seal(this.getAllDB())},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.LoginReward=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.setId=function(n){this.setInt("id",n)},e.prototype.getLogOnDays=function(){return this.getInt("log_on_days")},e.prototype.setLogOnDays=function(n){this.setInt("log_on_days",n)},e.prototype.getNewComing=function(){return this.getInt("new_coming")},e.prototype.setNewComing=function(n){this.setInt("new_coming",n)},e.prototype.getSkinPiece=function(){return this.getString("skin_piece")},e.prototype.setSkinPiece=function(n){this.setString("skin_piece",n)},e.prototype.getDiamonds=function(){return this.getInt("diamonds")},e.prototype.setDiamonds=function(n){this.setInt("diamonds",n)},e.prototype.getSkins=function(){return this.getInt("skins")},e.prototype.setSkins=function(n){this.setInt("skins",n)},e}(d.default);m.LoginRewardRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],Log:[function(l,P,m){"use strict";cc._RF.push(P,"a53cdRZS/JLlY/mC9shG1Ex","Log"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../util/PU"),s=l("../../modules/MGUtils/MGLog"),r=function(){function o(){}return o.init=function(e){o.sIsDebug=!1,s.default.init(o.sIsDebug)},o.isDebug=function(){return o.sIsDebug},o.getPrefix=function(){return s.default.getPrefix()},o.l=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];o.isDebug()&&(d.default.isQQ()||d.default.isCM()?console.log(o.getPrefix()+" msg: "+e+" subst: "+this.toJsonString(n)):console.log(o.getPrefix(),e,n))},o.w=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];d.default.isQQ()||d.default.isCM()?console.warn(o.getPrefix()+" msg: "+e+" subst: "+this.toJsonString(n)):console.warn(o.getPrefix(),e,n)},o.e=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];d.default.isQQ()||d.default.isCM()?console.error(o.getPrefix()+" msg: "+e+" subst: "+this.toJsonString(n)):console.error(o.getPrefix(),e,n)},o.i=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];o.isDebug()&&(d.default.isQQ()||d.default.isCM()?console.info(o.getPrefix()+" msg: "+e+" subst: "+this.toJsonString(n)):console.info(o.getPrefix(),e,n))},o.toJsonString=function(e){if(e==null||e==null)return"";try{return JSON.stringify(e)}catch(n){return""}},o.GAME_ID_RELEASE_VERSION_WX=1001,o.GAME_ID_RELEASE_VERSION_QQ=2001,o}();m.default=r,cc._RF.pop()},{"../../modules/MGUtils/MGLog":"MGLog","../util/PU":"PU"}],LongBlockAnimation:[function(l,P,m){"use strict";cc._RF.push(P,"e732c3elSZFoYT4ypMv2ZsF","LongBlockAnimation"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../GameBus"),s=l("../../animation/action/MFadeTo"),r=l("../../animation/action/MSequence"),o=l("../../animation/action/MScaleTo"),e=l("../../animation/action/MSpawn"),n=l("../../animation/action/MDelay"),t=l("../../animation/action/MMoveTo"),i=l("../../animation/action/MCallFunc"),a=l("../../animation/action/MResizeTo"),u=l("../../../base/G"),c=function(){function f(g,_){this.mDotAnimLayer=null,this.mDotLightRootLayer=null,this.mCircleNode=null,this.mDotNode=null,this.mSpeed=0,this.mNormalScale=0,this.mMaxCircleScale=0,this.mDotAnimOffset=0,this.mCircleAction=null,this.mDotAction=null,this.mDotAnimLayer=g,this.mDotLightRootLayer=_,this.mDotAnimLayer&&(this.mDotNode=this.mDotAnimLayer.getChildByTag(h.TAG_NODE_ANIM_DOT),this.mCircleNode=this.mDotAnimLayer.getChildByTag(h.TAG_NODE_ANIM_CIRCLE),this.mDotAnimOffset=this.mCircleNode.getHeight()*this.mCircleNode.getScale()/2,this.mNormalScale=this.mCircleNode.getScale(),this.mMaxCircleScale=1.3*this.mNormalScale)}return f.prototype.setSpeed=function(g){this.mSpeed=g},f.prototype.reset=function(){this.mSpeed=0},f.prototype.hideAnimation=function(){this.mDotNode!=null&&this.mDotNode.setOpacity(0),this.mCircleNode!=null&&this.mCircleNode.setOpacity(0)},f.prototype.showAnimation=function(g,_,y){if(u.G.Ap.config.longBlockDotPosShow){var S=this.mDotLightRootLayer.getChildByTag(y);S!=null&&S.setVisible(!1)}if(u.G.Ap.config.longBlockDotAnimEnable){var I=_-g;if(I<=0)return;var v=I/this.mSpeed;v<.1?v=.2:1<v&&(v=.5),this.mDotAnimLayer.setPositionY(g),this.startCircleAnimation(v),this.startDotAnimation(v)}},f.prototype.startCircleAnimation=function(g){if(this.mCircleNode.setOpacity(0),this.mCircleNode.setScale(this.mNormalScale),!this.mCircleAction){var _=g/3,y=g-_,S=new r.default(new s.default(1,_),new s.default(0,y)),I=new o.default(this.mMaxCircleScale,this.mMaxCircleScale,_+y);this.mCircleAction=new e.default(I,S)}d.default.getInstance().animationMgr.runAction(this.mCircleNode,this.mCircleAction)},f.prototype.startDotAnimation=function(g){if(this.mDotNode.setOpacity(1),this.mDotNode.setScale(this.mNormalScale),!this.mDotAction){var _=g/3,y=g-_,S=new e.default(new o.default(0,0,y),new s.default(0,y));this.mDotAction=new r.default(new n.default(_),S)}d.default.getInstance().animationMgr.runAction(this.mDotNode,this.mDotAction)},f.prototype.stopAnimation=function(){},f}(),p=function(){function f(g,_){this.mLightLayer=null,this.mNumberText=null,this.mNormalTextScale=0,this.mMaxTextScale=0,this.mAction=null,this.mLightAlpha=null,this.mLightLayer=g,this.mNumberText=_,this.mNormalTextScale=_.getScale(),this.mMaxTextScale=1.08*this.mNormalTextScale}return f.prototype.showAnimation=function(g){this.showLightHideAnimation(g),this.showScoreAnimation(g)},f.prototype.showLightHideAnimation=function(g){this.mLightAlpha||(this.mLightAlpha=new s.default(0,.3)),d.default.getInstance().animationMgr.runAction(this.mLightLayer,this.mLightAlpha)},f.prototype.showScoreAnimation=function(g){if(this.mNumberText.setPosition(0,g.rect.height+23),this.mNumberText.setNumberValue(g.attainScore),this.mNumberText.setVisible(!0),this.mNumberText.setOpacity(1),this.mNumberText.setScale(this.mNormalTextScale),!this.mAction){var _=new s.default(0,.5),y=new r.default(new o.default(this.mMaxTextScale,this.mMaxTextScale,.25),new o.default(this.mNormalTextScale,this.mNormalTextScale,.25));this.mAction=new e.default(_,y)}d.default.getInstance().animationMgr.runAction(this.mNumberText,this.mAction)},f}(),h=function(){function f(g){this.mState=f.STATE_NORMAL,this.mBlock=null,this.mTailLayer=null,this.mHeadLayer=null,this.mLightLayer=null,this.mLightTopLayer=null,this.mScoreLayer=null,this.mDotAnimLayer=null,this.mDotLightRootLayer=null,this.mDotPosArray=null,this.mHasDots=!1,this.mLastTouchMove=0,this.mRootNode=null,this.mLightTopOffset=0,this.mCircleDotAnimation=null,this.mFinishAnimation=null,this.mBlock=g}return f.prototype.onLayerCreated=function(g,_){this.mRootNode=g,this.mLightTopOffset=_,(u.G.Ap.config.longBlockDotAnimEnable||u.G.Ap.config.longBlockDotPosShow)&&(this.mCircleDotAnimation=new c(this.mDotAnimLayer,this.mDotLightRootLayer)),this.mFinishAnimation=new p(this.mLightLayer,this.mScoreLayer),this.updateBlockState(f.STATE_NORMAL)},f.prototype.reuse=function(g){this.mBlock=g,this.mLastTouchMove=0,this.mLightLayer.setOpacity(1),u.G.Ap.config.longBlockChangeLength&&this.mTailLayer.setPosition(0,0),(u.G.Ap.config.longBlockDotAnimEnable||u.G.Ap.config.longBlockDotPosShow)&&this.mCircleDotAnimation.reset(),this.updateBlockState(f.STATE_NORMAL)},f.prototype.updateBlockState=function(g){switch(this.mState=g){case f.STATE_NORMAL:this.mTailLayer.setVisible(!0),this.mHeadLayer.setVisible(!0),this.mLightLayer.setVisible(!1),this.mLightTopLayer.setVisible(!1),this.mScoreLayer.setVisible(!1),u.G.Ap.config.longBlockDotAnimEnable&&this.mDotAnimLayer.setVisible(!1),u.G.Ap.config.longBlockDotPosShow&&this.mDotLightRootLayer.setVisible(!1);break;case f.STATE_ROLLING:this.mTailLayer.setVisible(!0),this.mHeadLayer.setVisible(!1),this.mLightLayer.setVisible(!0),this.mLightTopLayer.setVisible(!0),this.mScoreLayer.setVisible(!1),u.G.Ap.config.longBlockDotAnimEnable&&this.mDotAnimLayer.setVisible(!0),u.G.Ap.config.longBlockDotPosShow&&this.mDotLightRootLayer.setVisible(!0);break;case f.STATE_FINISH:this.mTailLayer.setVisible(!1),this.mHeadLayer.setVisible(!1),this.mLightLayer.setVisible(!0),this.mLightTopLayer.setVisible(!1),this.mScoreLayer.setVisible(!0),u.G.Ap.config.longBlockDotAnimEnable&&this.mDotAnimLayer.setVisible(!0),u.G.Ap.config.longBlockDotPosShow&&this.mDotLightRootLayer.setVisible(!1);break;case f.STATE_PAUSE:this.mTailLayer.setVisible(!0),this.mHeadLayer.setVisible(!0),this.mLightLayer.setVisible(!1),this.mLightTopLayer.setVisible(!1),this.mScoreLayer.setVisible(!1),u.G.Ap.config.longBlockDotAnimEnable&&this.mDotAnimLayer.setVisible(!1),u.G.Ap.config.longBlockDotPosShow&&this.mDotLightRootLayer.setVisible(!1)}},f.prototype.update=function(g){if(this.mBlock!=null&&this.mState==f.STATE_ROLLING){u.G.Ap.config.longBlockDotAnimEnable&&this.mCircleDotAnimation.setSpeed(g);var _=this.mBlock.touchMove,y=this.mBlock.rect.height-this.mLightTopOffset;this.mLastTouchMove!=_&&(y<=_?this.moveFinish():this.moveBlockLight(),this.mLastTouchMove=_)}},f.prototype.updateTouchState=function(g){g?this.updateBlockState(f.STATE_ROLLING):this.checkFinishAndMoveLightHead()},f.prototype.moveFinish=function(){this.mRootNode.getOpacity()!==0&&(u.G.Ap.config.longBlockChangeLength&&this.mTailLayer.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height),this.mLightLayer.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height),this.updateBlockState(f.STATE_FINISH),this.mFinishAnimation.showAnimation(this.mBlock))},f.prototype.moveBlockLight=function(){this.mLightLayer.setContentSize(this.mBlock.rect.width,this.mBlock.touchMove+this.mLightTopOffset),u.G.Ap.config.longBlockChangeLength&&this.mTailLayer.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height-this.mBlock.touchMove);var g=this.mBlock.touchMove+this.mLightTopOffset;g<this.mBlock.rect.height+20&&(this.mLightTopLayer.setPositionY(this.mBlock.touchMove),u.G.Ap.config.longBlockChangeLength&&this.mTailLayer.setPositionY(this.mBlock.touchMove),u.G.Ap.config.longBlockDotAnimEnable&&this.mDotAnimLayer.setPositionY(g)),this.showCircleDotAnimation(g)},f.prototype.showCircleDotAnimation=function(g){if(u.G.Ap.config.longBlockDotAnimEnable||u.G.Ap.config.longBlockDotPosShow)if(this.mHasDots)for(var _=0;_<this.mDotPosArray.length;_++){var y=this.mDotPosArray[_];if(y<=g){var S=-1;S=_+1<this.mDotPosArray.length?this.mDotPosArray[_+1]:this.mBlock.rect.height,this.mCircleDotAnimation.showAnimation(y,S,y),this.mDotPosArray.splice(_,1);break}}else this.mCircleDotAnimation.hideAnimation()},f.prototype.checkFinishAndMoveLightHead=function(){var g=this,_=this.mBlock.rect.height-this.mLightTopOffset;if(this.mBlock.touchMove>_-50&&this.mBlock.touchMove<_){var y=new a.default(this.mBlock.rect.width,this.mBlock.rect.height,.2);d.default.getInstance().animationMgr.runAction(this.mLightLayer,y);var S=new t.default(0,_,.2),I=new r.default(S,new i.default(function(v){g.moveFinish()}));d.default.getInstance().animationMgr.runAction(this.mLightTopLayer,I),this.checkRestDots()}else(u.G.Ap.config.longBlockDotAnimEnable||u.G.Ap.config.longBlockDotPosShow)&&this.mCircleDotAnimation.stopAnimation()},f.prototype.checkRestDots=function(){if((u.G.Ap.config.longBlockDotAnimEnable||u.G.Ap.config.longBlockDotPosShow)&&0<this.mDotPosArray.length){var g=this.mDotPosArray[0];this.mCircleDotAnimation.showAnimation(g,this.mBlock.rect.height,g),this.mDotPosArray=[]}},f.prototype.updatePauseState=function(g){g&&this.updateBlockState(f.STATE_PAUSE)},f.prototype.setTailLayer=function(g){this.mTailLayer=g},f.prototype.getTailLayer=function(){return this.mTailLayer},f.prototype.setHeadLayer=function(g){this.mHeadLayer=g},f.prototype.setLightLayer=function(g){this.mLightLayer=g},f.prototype.getLightLayer=function(){return this.mLightLayer},f.prototype.setLightTopLayer=function(g){this.mLightTopLayer=g},f.prototype.getLightTopLayer=function(){return this.mLightTopLayer},f.prototype.setDotLightLayer=function(g,_){this.mDotLightRootLayer=g,this.mDotPosArray=_,this.mDotPosArray&&0<this.mDotPosArray.length?this.mHasDots=!0:this.mHasDots=!1},f.prototype.getDotLightLayer=function(){return this.mDotLightRootLayer},f.prototype.setDotAnimLayer=function(g){this.mDotAnimLayer=g},f.prototype.getDotAnimLayer=function(){return this.mDotAnimLayer},f.prototype.setScoreLayer=function(g){this.mScoreLayer=g},f.TAG_NODE_ANIM_CIRCLE=10086,f.TAG_NODE_ANIM_DOT=10010,f.STATE_NORMAL=0,f.STATE_ROLLING=1,f.STATE_FINISH=2,f.STATE_PAUSE=3,f}();m.default=h,cc._RF.pop()},{"../../../base/G":"G","../../GameBus":"GameBus","../../animation/action/MCallFunc":"MCallFunc","../../animation/action/MDelay":"MDelay","../../animation/action/MFadeTo":"MFadeTo","../../animation/action/MMoveTo":"MMoveTo","../../animation/action/MResizeTo":"MResizeTo","../../animation/action/MScaleTo":"MScaleTo","../../animation/action/MSequence":"MSequence","../../animation/action/MSpawn":"MSpawn"}],LongBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"1d197I5y0tKMJPu46NBnlfp","LongBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/GameSceneFrameLoader"),s=l("../loader/BlockSkinFrameLoader"),r=l("./BlockNode"),o=l("../anim/LongBlockAnimation"),e=l("../../../base/G"),n=l("./ReuseNodePool"),t=l("./ReuseNode"),i=l("../../MUI/MUISprite"),a=l("../../MUI/MUINode"),u=l("../component/MUINumber"),c=l("../loader/NumberFrameLoader"),p=l("../../MUI/MUINineScaleSprite"),h=l("../../../util/Utility"),f=function(g){function _(){return g!==null&&g.apply(this,arguments)||this}return __extends(_,g),_.getBlockHeightScale=function(){return _.sBlockScale==0&&(_.sBlockScale=e.G.Ap.config.getBlockHeight()/e.G.Ap.config.getDesignBlockHeight()),_.sBlockScale},_.prototype.unuse=function(){if(g.prototype.unuse.call(this),e.G.Ap.config.longBlockDotPosShow)for(var y=0,S=this.mLongBlockAnimation.getDotLightLayer().getAllChildren();y<S.length;y++){var I=S[y];I.setTag(0),this.mDotNodeCache.put(I)}},_.prototype.reuse=function(y){if(g.prototype.reuse.call(this,y),this.updatePauseState(!1),this.mLongBlockAnimation.reuse(this.mBlock),this.mLongBlockAnimation.getTailLayer().setContentSize(this.mBlock.rect.width,this.mBlock.rect.height),e.G.Ap.config.longBlockDotAnimEnable){var S=this.mLongBlockAnimation.getDotAnimLayer();S.setPositionY(0),S.setVisible(!1)}if(e.G.Ap.config.longBlockDotPosShow){var I=this.mLongBlockAnimation.getLightTopLayer(),v=I.getWidth()/I.imageItem.rect.width,C=this.mLongBlockAnimation.getDotLightLayer(),T=this.addDotNodes(C,v,I.getHeight());this.mLongBlockAnimation.setDotLightLayer(C,T)}},_.prototype.updateLayers=function(y){this.mLongBlockAnimation.update(y)},_.prototype.createLayers=function(){g.prototype.createLayers.call(this),this.mLongBlockAnimation=new o.default(this.mBlock),this.mDotNodeCache=new n.default;var y=s.default.getInstance().getLongBlockTail(),S=new p.default;S.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height),S.imageItem=y,S.imageData=s.default.getInstance().getAtlas();var I=y.isScale9Grid?y.scale9Grid:new h.Utility.Rect(0,60,0,0);S.setInset(I.x,I.y,I.width,I.height),S.setVisible(!1),this.addChild(S),this.mLongBlockAnimation.setTailLayer(S);var v=s.default.getInstance().getLongBlockHead(),C=new i.default;C.setContentSize(this.mBlock.rect.width,v.rect.height*this.mBlock.rect.width/v.rect.width),C.imageItem=v,C.imageData=s.default.getInstance().getAtlas(),C.setVisible(!1),this.addChild(C),this.mLongBlockAnimation.setHeadLayer(C);var T=s.default.getInstance().getLongBlockLightTop(),E=new p.default;E.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height),E.imageItem=T,E.imageData=s.default.getInstance().getAtlas();var A=T.isScale9Grid?T.scale9Grid:new h.Utility.Rect(0,100,0,0);E.setInset(A.x,A.y,A.width,A.height),E.setVisible(!1),this.addChild(E),this.mLongBlockAnimation.setLightLayer(E);var M=s.default.getInstance().getLongBlockLightTop(),k=new i.default;if(k.setContentSize(this.mBlock.rect.width,M.rect.height*_.getBlockHeightScale()),k.imageItem=M,k.imageData=s.default.getInstance().getAtlas(),k.setOpacity(0),k.setVisible(!1),this.mLongBlockAnimation.setLightTopLayer(k),e.G.Ap.config.longBlockDotAnimEnable){var D=new a.default;D.setPositionX(this.mBlock.rect.width/2);var L=k.getWidth()/k.imageItem.rect.width,b=d.default.getInstance().getCircleLight(),N=new i.default;N.imageData=d.default.getInstance().getAtlas(),N.setImageItem(b),N.setScale(L),N.setPositionX(-N.imageItem.rect.width/2),N.setPositionY(-N.imageItem.rect.height/2);var H=d.default.getInstance().getDotLight(),R=new i.default;R.imageData=d.default.getInstance().getAtlas(),R.setImageItem(H),R.setScale(L),R.setPositionX(-R.imageItem.rect.width/2),R.setPositionY(-R.imageItem.rect.height/2),D.addChild(N,o.default.TAG_NODE_ANIM_CIRCLE),D.addChild(R,o.default.TAG_NODE_ANIM_DOT),this.addChild(D),D.setVisible(!1),this.mLongBlockAnimation.setDotAnimLayer(D)}e.G.Ap.config.longBlockDotPosShow&&(L=k.getWidth()/k.imageItem.rect.width,this.addLightDotsLayer(L,k.getHeight()));var F=s.default.getInstance().getLongBlockFinish();this.imageItem=F,this.imageData=s.default.getInstance().getAtlas();var x=new u.default(c.default.getInstance().getAtlas(),2);x.setContentSize(this.mBlock.rect.width,132),x.setScale(.78),x.setShowSign(!0),x.setCenterNumber(!0),x.setNumberColor(u.NumberColor.BLUE),x.setVisible(!1),this.addChild(x),this.mLongBlockAnimation.setScoreLayer(x),this.mLongBlockAnimation.onLayerCreated(this,k.getHeight())},_.prototype.addLightDotsLayer=function(y,S){var I=new a.default;I.setPosition(this.mBlock.rect.width/2,0);var v=this.addDotNodes(I,y,S);this.addChild(I),this.mLongBlockAnimation.setDotLightLayer(I,v)},_.prototype.addDotNodes=function(y,S,I){for(var v=[],C=this.mBlock.bounus,T=s.default.getInstance().getDot(),E=-T.rect.width/2,A=0,M=C;A<M.length;A++){var k=M[A].time*e.G.Ap.config.getBlockHeight()+I-T.rect.height/2;v.push(k);var D=this.mDotNodeCache.get();D==null&&((D=new t.default).imageData=s.default.getInstance().getAtlas(),D.setImageItem(T),D.setScale(S)),D.setPosition(E,k),D.isAdded()?D.setTag(k):y.addChild(D,k)}return v},_.prototype.updateTouchState=function(y){this.mLongBlockAnimation.updateTouchState(y)},_.prototype.updatePauseState=function(y){var S=this.getChildByTag(_.TAG_NODE_PAUSE);if(y&&!S){var I=s.default.getInstance().getStartLabel(),v=this.mBlock.rect.width/I.rect.width,C=this.mBlock.rect.width,T=I.rect.height*v,E=new i.default;E.imageData=s.default.getInstance().getAtlas(),E.imageItem=I,E.move(0,(120-T)/2,C,T),this.addChild(E,_.TAG_NODE_PAUSE)}S&&S.setVisible(y)},_.sBlockScale=0,_.TAG_NODE_PAUSE=100,_}(r.default);m.default=f,cc._RF.pop()},{"../../../base/G":"G","../../../util/Utility":"Utility","../../MUI/MUINineScaleSprite":"MUINineScaleSprite","../../MUI/MUINode":"MUINode","../../MUI/MUISprite":"MUISprite","../anim/LongBlockAnimation":"LongBlockAnimation","../component/MUINumber":"MUINumber","../loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","../loader/GameSceneFrameLoader":"GameSceneFrameLoader","../loader/NumberFrameLoader":"NumberFrameLoader","./BlockNode":"BlockNode","./ReuseNode":"ReuseNode","./ReuseNodePool":"ReuseNodePool"}],Looper:[function(l,P,m){"use strict";cc._RF.push(P,"2913dCc+mFIMoGO46Dt+Yh7","Looper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Network/Protocol/UserUtil"),s=function(r){function o(){var e=r.call(this)||this;return e.mInterval=4,e.isWorking=!1,e.isStarted=!1,e.scheduler=cc.director.getScheduler(),e}return __extends(o,r),o.prototype.start=function(e){var n=this;e===void 0&&(e=5),this.isStarted=!0,this.mInterval=e;var t=d.default.getCurSysTime();this.scheduler.scheduleUpdate(this,cc.Scheduler.PRIORITY_NON_SYSTEM,!1,function(){if(!n.isWorking){var i=d.default.getCurSysTime();i-t>n.mInterval&&(n.doWork(),t=i,n.isWorking=!1)}})},o.prototype.stop=function(){this.isStarted&&(this.scheduler.unscheduleUpdate(this),this.isStarted=!1)},o.prototype.doWork=function(){this.isWorking=!0,this.mWork&&this.mWork()},o.prototype.setWork=function(e,n){n===void 0&&(n=4),this.mWork=e,this.mInterval=n},o.prototype.setInterval=function(e){e&&0<=e&&(this.mInterval=e)},o.prototype.getStarted=function(){return this.isStarted},o}(cc.Node);m.default=s,cc._RF.pop()},{"../Network/Protocol/UserUtil":"UserUtil"}],LotteryDataManager:[function(l,P,m){"use strict";cc._RF.push(P,"2a6ab0GNjpCx6/tGAqbx3mO","LotteryDataManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=function(){function o(){}return o.Ins=function(){return o.mInstance||(o.mInstance=new o),o.mInstance},o.prototype.getLotteryDataVM=function(e){for(var n=[],t=0,i=d.default.Ins().getDBRows(d.eDataBase.eDB_Lottery,e+"");t<i.length;t++){var a=i[t],u=parseInt(a.mRowData[0]);if(u&&typeof u=="number"){var c=new r,p=a;c.id=p.getId(),c.rewardType=p.getRewardType(),c.newComing=p.getNewComing(),c.chanceMin=p.getChanceMin(),c.chanceMax=p.getChanceMax(),c.count=p.getCount(),c.isSkinPiece=p.getIsSkinPiece(),n.push(c)}}return Object.seal(n)},o}();m.LotteryDataMgr=s;var r=function(){};m.LotteryDataVM=r,cc._RF.pop()},{"../DB/DBMgr":"DBMgr"}],LotteryData:[function(l,P,m){"use strict";cc._RF.push(P,"da5c6Hzg7ZMnLreFQL1IwRl","LotteryData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findLotteryDataById=function(n){return this.find("rewardType",n)},e.prototype.findLotteryDataByNewCome=function(n){n===void 0&&(n="0");var t=this.csvGetRows("newComing",n),i=[];if(t&&0<t.length)for(var a=0,u=t;a<u.length;a++){var c=u[a],p=new r;p.mRowData=c,p.mCsvFile=this,i.push(p)}return Object.seal(i)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.LotteryData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.getRewardType=function(){return this.getString("rewardType")},e.prototype.getNewComing=function(){return this.getInt("newComing")},e.prototype.getChanceMin=function(){return this.getInt("chanceMin")},e.prototype.getChanceMax=function(){return this.getInt("chanceMax")},e.prototype.getCount=function(){return this.getInt("count")},e.prototype.getIsSkinPiece=function(){return this.getInt("isSkinPiece")},e}(d.default);m.LotteryDataRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],LotteryEnum:[function(l,P,m){"use strict";var d,s,r,o,e,n,t;cc._RF.push(P,"832f7hOQgRDj4FrqChb0FP2","LotteryEnum"),Object.defineProperty(m,"__esModule",{value:!0}),(d=m.UserEnum||(m.UserEnum={}))[d.NONE=0]="NONE",d[d.NEW_COMING=1]="NEW_COMING",d[d.PASS_COMING=2]="PASS_COMING",(s=m.BUTTON_STATUS||(m.BUTTON_STATUS={}))[s.NONE=0]="NONE",s[s.SUCCESS=1]="SUCCESS",s[s.FAIL=2]="FAIL",s[s.INTERACTABLE=3]="INTERACTABLE",s[s.END=4]="END",(r=m.AD_STATUS||(m.AD_STATUS={}))[r.NONE=0]="NONE",r[r.SKIP_AD=1]="SKIP_AD",r[r.NETWORK_FAIL=2]="NETWORK_FAIL",r[r.EXIT_AD=3]="EXIT_AD",(o=m.REWARD_TYPE||(m.REWARD_TYPE={}))[o.GOLD=0]="GOLD",o[o.ENERGY=1]="ENERGY",o[o.DIAMOND=2]="DIAMOND",o[o.SKIN=3]="SKIN",o[o.PROP_DASH=4]="PROP_DASH",o[o.PROP_SLOW=5]="PROP_SLOW",o[o.PROP_SHIELD=6]="PROP_SHIELD",(e=m.SKIN_TYPE||(m.SKIN_TYPE={}))[e.ONE_DAY=1]="ONE_DAY",e[e.TWO_DAY=2]="TWO_DAY",e[e.THREE_DAY=4]="THREE_DAY",e[e.LIMIT=8]="LIMIT",e[e.FOREVER=16]="FOREVER",e[e.NONE=32]="NONE",(n=m.TIP_TYPE||(m.TIP_TYPE={}))[n.TIP_COUNT_DOWN=0]="TIP_COUNT_DOWN",n[n.TIP_RUN_OUT=1]="TIP_RUN_OUT",n[n.TIP_NORMAL=2]="TIP_NORMAL",(t=m.LOTTERY_MODE||(m.LOTTERY_MODE={}))[t.MODE_AD=0]="MODE_AD",t[t.MODE_AUTO=1]="MODE_AUTO",cc._RF.pop()},{}],LotteryHandler:[function(l,P,m){"use strict";cc._RF.push(P,"73b5c7cM45MoYcCEhURqFvi","LotteryHandler"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../gamescene/services/ServiceProvider"),s=l("./workers/DataEntryWorker"),r=l("./workers/SwitchWorker"),o=l("../../gamescene/workers/WorkerState"),e=l("../../util/TimeUtil"),n=l("../Network/Protocol/StorageUtil"),t=l("../../config/LSKey"),i=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),a=l("../looper/Looper"),u=l("../../util/StringUtil"),c=function(){function p(){this.lotteryProvider=new d.ServiceProvider,this.dataEntryWorker=null,this.switchWorker=null,this.LotteryVMList=null,this.countDown=0,this.countDownRunning=!1,this.doneCount=0,this.currentLotteryStat=!1,this.lastLotteryDate="",this.serverDate=null,this.looper=null,this.rollingEndCallback=null,this.countDownCallback=null,this.COUNT_DOWN=60,this.initDate()}return p.prototype.startDataEntry=function(h){console.log("--- startDataEntry newComing---",h),this.dataEntryWorker&&this.dataEntryWorker.state===o.WorkerState.running||(this.lotteryProvider.register("DataEntryWorker",new s.default),this.dataEntryWorker=this.lotteryProvider.resolve("DataEntryWorker"),this.dataEntryWorker.canPauseAndContinue=!0,this.dataEntryWorker.start(this,h))},p.prototype.stopDataEntry=function(){this.dataEntryWorker&&this.dataEntryWorker.stop()},p.prototype.startSwitchWorker=function(h,f){this.switchWorker&&this.switchWorker.state===o.WorkerState.running||(this.lotteryProvider.register("SwitchWorker",new r.default),this.switchWorker=this.lotteryProvider.resolve("SwitchWorker"),this.switchWorker.canPauseAndContinue=!0,this.switchWorker.start(this,h,f),this.saveData())},p.prototype.stopSwitchWorker=function(){this.switchWorker&&this.switchWorker.stop()},p.prototype.initDate=function(){this.lastLotteryDate=n.default.read(t.default.LAST_LOTTERY_DATE,"1970_01_01"),!this.lastLotteryDate&&(this.lastLotteryDate="1970_01_01")},p.prototype.saveData=function(){try{if(this.addDoneCount(),this.doneCount>p.EVERYDAY_LOTTERY_COUNT)return;var h=this.serverDate;this.lastLotteryDate=h?e.default.formatDate(h.valueOf()):"",n.default.save(t.default.LAST_LOTTERY_DATE,this.lastLotteryDate),n.default.save(t.default.LOTTERY_COUNT,this.doneCount+""),this.addLotteryTimes()}catch(f){console.log("--- handler saveData err---",f)}},p.prototype.addLotteryTimes=function(){var h=n.default.read(t.default.LOTTERY_TOTAL_COUNT);if(u.StringUtil.isEmpty(h))n.default.save(t.default.LOTTERY_TOTAL_COUNT,"1");else{if(10<parseInt(h))return;n.default.save(t.default.LOTTERY_TOTAL_COUNT,parseInt(h)+1+"")}},p.prototype.addDoneCount=function(){0<=this.doneCount&&this.doneCount<p.EVERYDAY_LOTTERY_COUNT&&this.doneCount++,console.log("addDoneCount this.doneCount",this.doneCount)},p.prototype.getLotteryStat=function(h){var f=this;try{this.getServerTime(function(g,_){f.currentLotteryStat=!1,g&&(f.currentLotteryStat=f.getRefreshState(_)),h(f.currentLotteryStat)})}catch(g){console.log("--- handler getLotteryStat err---",g)}},p.prototype.getRefreshState=function(h){var f=p.EVERYDAY_LOTTERY_COUNT,g=new Date(h),_=e.default.formatDate(g.valueOf());this.serverDate=g,this.lastLotteryDate=n.default.read(t.default.LAST_LOTTERY_DATE,this.lastLotteryDate),this.doneCount=Math.floor(parseInt(n.default.read(t.default.LOTTERY_COUNT,this.doneCount)))||0;var y=!1;return _===this.lastLotteryDate?y=0<=this.doneCount&&this.doneCount<f:(_>this.lastLotteryDate||!this.lastLotteryDate)&&(y=!0,this.doneCount=0,n.default.save(t.default.LOTTERY_COUNT,this.doneCount+"")),y},p.prototype.getServerTime=function(h){i.MGUser.getCurrentServerRealTime({complete:function(f,g){h(f,g)}})},p.prototype.setLotteryVMList=function(h){h&&(this.LotteryVMList=h)},p.prototype.getLotteryVMList=function(){return this.LotteryVMList},p.prototype.getDoneCount=function(){return this.doneCount},p.prototype.startCountDown=function(h){var f=this;h===void 0&&(h=this.COUNT_DOWN);try{this.getLotteryStat(function(g){console.log("--- getLotteryStat currentLotteryStat ---"+g),0<f.countDown||!g||f.countDownRunning||f.buildTimer(h)})}catch(g){this.setCountDown(0),this.countDownCallback&&this.countDownCallback(),this.countDownRunning=!1}},p.prototype.buildTimer=function(h){this.looper=new a.default,this.countDown=h,this.countDownRunning=!0,this.looper.setWork(this.timer.bind(this)),this.looper.start(1)},p.prototype.timer=function(){0<this.countDown?(this.setCountDown(this.countDown),this.countDown--):(this.setCountDown(this.countDown),this.countDownCallback&&this.countDownCallback(),this.countDownRunning=!1,this.looper.stop())},p.prototype.setCountDown=function(h){h<0||n.default.save(t.default.LOTTERY_COUNTDOWN,this.countDown+"")},p.prototype.getCountDown=function(){var h=parseInt(n.default.read(t.default.LOTTERY_COUNTDOWN,this.countDown));return 0<(h=h===0?this.countDown:h)&&!this.countDownRunning&&this.startCountDown(h),h},p.prototype.getCurrentLotteryStat=function(h){h&&(n.default.read(t.default.DEBUG_INFINITE_LOTTERY)==="true"?this.countDown===0?h(!0):h(!1):this.getLotteryStat(h))},p.prototype.setRollingEndCallback=function(h){h&&(this.rollingEndCallback=h)},p.prototype.getRollingEndCallback=function(){return this.rollingEndCallback},p.prototype.setCountDownCallback=function(h){h&&(this.countDownCallback=h)},p.prototype.getCountDownCallback=function(){return this.countDownCallback},p.prototype.getWorkerState=function(h){var f=null;switch(h){case"DataEntryWorker":f=this.dataEntryWorker;break;case"SwitchWorker":f=this.switchWorker}return f?f.state:o.WorkerState.stopped},p.EVERYDAY_LOTTERY_COUNT=3,p}();m.LotteryHandler=c,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../config/LSKey":"LSKey","../../gamescene/services/ServiceProvider":"ServiceProvider","../../gamescene/workers/WorkerState":"WorkerState","../../util/StringUtil":"StringUtil","../../util/TimeUtil":"TimeUtil","../Network/Protocol/StorageUtil":"StorageUtil","../looper/Looper":"Looper","./workers/DataEntryWorker":"DataEntryWorker","./workers/SwitchWorker":"SwitchWorker"}],LotteryIndex:[function(l,P,m){"use strict";cc._RF.push(P,"73972N8uJ1Db71LK67h5rGY","LotteryIndex"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./../skin/frag/SkinTaskMgr"),s=l("../UI/GameEntraScene/BasicTouchEvent"),r=l("./LotteryProcess"),o=l("./LotteryItem"),e=l("../UI/GameEntraScene/ToastPrefab"),n=l("../UI/GameEntraScene/ImgCache"),t=l("../../gamescene/workers/WorkerState"),i=l("../Network/Protocol/StorageUtil"),a=l("../../config/LSKey"),u=l("../awardcontroller/AwardController"),c=l("../Logic/GameItemsManager"),p=l("./LotteryEnum"),h=l("../../infoc/m_p2_PData_Dia"),f=l("../../infoc/m_p2_Uaction"),g=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),_=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),y=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),S=l("../UI/GameEntraScene/PrefabMgr"),I=l("../../base/Log"),v=l("../../util/StringUtil"),C=l("../Logic/SkinDataManager"),T=l("../skin/frag/SkinTaskMgr"),E=l("../../util/PU"),A=l("../../upgrade/BannerDelayShowToggle"),M=l("../../upgrade/ToggleBean"),k=l("../Logic/I18nManager"),D=l("../keypad/KeypadNavigator"),L=cc._decorator,b=L.ccclass,N=L.property,H=function(R){function F(){var x=R!==null&&R.apply(this,arguments)||this;return x.mainPanel=null,x.startBtn=null,x.getAwardBtn=null,x.skip=null,x.content=null,x.item=null,x.bkg=null,x.tipTxt=null,x.mSkinTipsLabel=null,x.mSkinCountLabel=null,x.lotteryProcess=null,x.lotteryHandler=null,x.startBtnClickEvent=null,x.getAwardBtnClickEvent=null,x.closeBtnClickEvent=null,x.currentLotteryStat=!0,x.itemNodes=[],x.lotteryAwards=null,x.adBackStatus=null,x.isADFeatureEnable=!0,x.TIP_NORMAL_TXT_WX="\u770B15s\u5E7F\u544A\u5373\u53EF\u514D\u8D39\u62BD\u5956",x.TIP_NORMAL_TXT_QQ="\u89C2\u770B\u5B8C\u6574\u89C6\u9891\u53EF\u83B7\u5F97\u6E38\u620F\u5956\u52B1",x.TIP_RUN_OUT_TXT="\u4ECA\u65E5\u62BD\u5956\u6B21\u6570\u5DF2\u7528\u5B8C",x.STAR_SKIN_ID="5-7-0",x._lotteryMode=p.LOTTERY_MODE.MODE_AD,x.mbBannerShowed=!1,x}return __extends(F,R),F.prototype.enResLoad=function(){},F.prototype.enSpriteSetNull=function(){this.startBtn.getComponent(cc.Sprite).spriteFrame=null,this.getAwardBtn.getComponent(cc.Sprite).spriteFrame=null},F.prototype.onLoad=function(){k.default.getInstance().isEnglish()&&this.enResLoad(),this.saveShowTime(),E.default.isWeiXin()||(y.MGAdv.load(_.ADScene.LOTTERY,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),y.MGAdv.load(_.ADScene.LOTTERY_DOUBLE_AWARD,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)),D.default.getInstance().pushDialog(this.node)},F.prototype.onDestroy=function(){this.destroyBannerAd(),D.default.getInstance().popDialog(this.node)},F.prototype.destroyBannerAd=function(){this.isBannerShowed()&&y.MGAdv.destroyBanner(_.ADScene.SOURCE_LOTTERY_BANNER)},F.prototype.init=function(x){try{this.lotteryProcess=x,this.lotteryProcess.callLotteryFrame(),this.lotteryHandler=this.lotteryProcess.getLotteryHandler(),this.buildBkg(),this.buildContent(),this.initLotteryMode(),this.initCloseBtnClickEvent(),this.initTipTxt(p.TIP_TYPE.TIP_NORMAL),this.initAds(),this.initToast(),this.initRollingEndCallback(),this.initCountDownCallback(),this.adaptorUI(),this.showBannerAd(),this.report(2),this.setSkinItem()}catch(U){console.log("--- lottery index err:---",U)}},F.wx2cc=function(x){var U=cc.winSize,B=wx.getSystemInfoSync();return U&&B?x*U.height/B.windowHeight:0},F.prototype.showBannerAd=function(){var x=this;if(console.log("[MGB_DEBUG] showBannerAd enter"),!E.default.isWeb()){var U=void 0,B=void 0,Q=void 0;if(E.default.isQQ())Q=B=U=0;else if(E.default.isWeiXin()){var Z=wx.getSystemInfoSync();U=Z.screenWidth,B=Z.screenHeight,Q=0}var z=this.tagBannerShowed.bind(this),W=this.isBannerShowed.bind(this);if(y.MGAdv.isBannerCached(_.ADScene.SOURCE_LOTTERY_BANNER)){var V=A.default.getBannerDelayTime(M.ToggleKey.BANNER_DELAY_LOTTERY_PAGE);this.scheduleOnce(function(){cc.isValid(x,!0)&&y.MGAdv.showBanner(_.ADScene.SOURCE_LOTTERY_BANNER,function(Y,q,J){console.log("[MGB_DEBUG] success show SOURCE_LOTTERY_BANNER, bannerHeight:"+J),x.adjustPos(J),z()})},V.normalDelayTime/1e3)}else console.log("[MGB_DEBUG] before load SOURCE_LOTTERY_BANNER"),y.MGAdv.loadBanner(U,Q,B,function(Y,q){if(Y==_.ADStat.LOAD_SUCCESS)if(console.log("[MGB_DEBUG] after load LOAD_SUCCESS"),cc.isValid(x,!0)&&!W()){console.log("[MGB_DEBUG] before show SOURCE_LOTTERY_BANNER");var J=A.default.getBannerDelayTime(M.ToggleKey.BANNER_DELAY_LOTTERY_PAGE);x.scheduleOnce(function(){cc.isValid(x,!0)&&y.MGAdv.showBanner(_.ADScene.SOURCE_LOTTERY_BANNER,function(ee,$,j){console.log("[MGB_DEBUG] success show SOURCE_LOTTERY_BANNER, bannerHeight:"+j),x.adjustPos(j),z()})},J.normalDelayTime/1e3)}else y.MGAdv.hideBanner(_.ADScene.SOURCE_LOTTERY_BANNER),y.MGAdv.destroyBanner(_.ADScene.SOURCE_LOTTERY_BANNER)},_.ADScene.SOURCE_LOTTERY_BANNER)}},F.prototype.adjustPos=function(x){console.log("[MGB_DEBUG] adjustPos bannerHeight:"+x)},F.prototype.tagBannerShowed=function(){this.mbBannerShowed=!0},F.prototype.isBannerShowed=function(){return this.mbBannerShowed},F.prototype.setSkinItem=function(){var x=i.default.read(a.default.LOTTERY_TOTAL_COUNT),U=null;U=!v.StringUtil.isEmpty(x)&&5<=parseInt(x)?"/lottery/forever_skin":"/lottery/star_skin",n.default.get2(U,this.mSkinTipsLabel);var B="";v.StringUtil.isEmpty(x)?B="/lottery/5":parseInt(x)<5&&(B="/lottery/"+(5-parseInt(x))),v.StringUtil.isEmpty(B)?this.mSkinCountLabel.node.active=!1:n.default.get2(B,this.mSkinCountLabel)},F.prototype.isStarSkinLocked=function(){for(var x=!0,U=C.SkinDataMgr.Ins().getSkinList(),B=0;B<U.length;B++)if(U[B].name=="stars"){x=U[B].isLock;break}return x},F.prototype.buildContent=function(){for(var x=0,U=0,B=this.getLotteryVMList();U<B.length;U++){var Q=B[U],Z=cc.instantiate(this.item),z=Z.getComponent(o.default);this.content.getChildByName(x+"").addChild(Z),z.init(Q),this.itemNodes.push(Z),x++}},F.prototype.buildBkg=function(){var x=this.bkg;x&&(x.on(cc.Node.EventType.TOUCH_START,function(U){U.stopPropagation()}),x.on(cc.Node.EventType.TOUCH_END,function(U){U.stopPropagation()}))},F.prototype.initStartBtn=function(){var x=this;this.lotteryHandler&&this.lotteryHandler.getCurrentLotteryStat(function(U){cc.isValid(x,!0)&&(x.tipTxt.node.active=!0,x.currentLotteryStat=U,x.getAwardBtn.node.active=!1,x.startBtn.node.active=!0,x.removeStartBtnClickEvent(),x.currentLotteryStat?(x.updateStartBtn(p.BUTTON_STATUS.NONE),x.initStartBtnClickEvent()):x.updateStartBtn(p.BUTTON_STATUS.INTERACTABLE))})},F.prototype.initGetAwardbtn=function(){this.tipTxt.node.active=!1,this.startBtn.node.active=!1,this.getAwardBtn.node.active=!0,this.initGetAwardClickEvent()},F.prototype.initCloseBtnClickEvent=function(){var x=this,U=this.skip.node;U&&(this.closeBtnClickEvent=new s.default(function(){x.closeCallback&&(x.removeEvents(),x.lotteryHandler.stopSwitchWorker(),x.closeCallback())}),U.on(cc.Node.EventType.TOUCH_END,this.closeBtnClickEvent.click,this.closeBtnClickEvent))},F.prototype.initStartBtnClickEvent=function(){this.startBtnClickEvent=new s.default(this.startBtnClick.bind(this)),this.startBtn.node.on(cc.Node.EventType.TOUCH_END,this.startBtnClickEvent.click,this.startBtnClickEvent)},F.prototype.initGetAwardClickEvent=function(){this.getAwardBtnClickEvent=new s.default(this.getAwardBtnClick.bind(this)),this.getAwardBtn.node.on(cc.Node.EventType.TOUCH_END,this.getAwardBtnClickEvent.click,this.getAwardBtnClickEvent)},F.prototype.initTipTxt=function(x,U){this.TIP_NORMAL_TXT_WX;var B=this.TIP_NORMAL_TXT_QQ,Q=this.TIP_RUN_OUT_TXT,Z="\u540E\u53EF\u518D\u6B21\u62BD\u5956";if(k.default.getInstance().isEnglish()&&(B="Watch the video completely to get rewards",Q="no chance left today",Z="after , get rewards again"),this.tipTxt){var z="";switch(x){case p.TIP_TYPE.TIP_NORMAL:E.default.isCM()&&(z=B);break;case p.TIP_TYPE.TIP_COUNT_DOWN:z="00:00:"+(U<10?"0"+U:""+U)+" "+Z;break;case p.TIP_TYPE.TIP_RUN_OUT:z=Q}this.tipTxt.string=z}},F.prototype.initAds=function(){E.default.isWeiXin()||y.MGAdv.load(_.ADScene.LOTTERY,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),this.isADFeatureEnable=cc.sys.isBrowser||y.MGAdv.isADFeatureEnable()},F.prototype.initRollingEndCallback=function(){var x=this;this.lotteryHandler.setRollingEndCallback(function(U){x.lotteryProcess&&x.lotteryHandler&&(x.currentLotteryStat=!1,x.lotteryHandler.getCurrentLotteryStat(function(B){var Q;cc.isValid(x,!0)&&(x.currentLotteryStat=B,x.doRollingButton.node.active=!0,Q=x.currentLotteryStat?p.BUTTON_STATUS.END:p.BUTTON_STATUS.INTERACTABLE,x.changeBtnStyle(Q,function(Z,z){cc.isValid(x,!0)&&(Z&&console.log("--- changeBtnStyle err ---",Z),x.doRollingButton.disabledSprite=z,x.initLotteryMode(),x.setSkinItem(),U&&(x.showRewardPage(U),x.report(1,U),x.notifyTaskSys()))}))}))})},F.prototype.initCountDownCallback=function(){var x=this;this.lotteryHandler.setCountDownCallback(function(){x.initStartBtn()})},F.prototype.initToast=function(){var x=this;this.setToastEndCallback(function(){x.lotteryHandler&&(3<=x.lotteryHandler.getDoneCount()?(x.currentLotteryStat=!1,x.updateStartBtn(p.BUTTON_STATUS.INTERACTABLE)):x.updateStartBtn(p.BUTTON_STATUS.SUCCESS))})},Object.defineProperty(F.prototype,"lotteryMode",{set:function(x){(this._lotteryMode=x)==p.LOTTERY_MODE.MODE_AD?(this.getAwardBtn.node.active=!1,this.updateStartBtn(p.BUTTON_STATUS.NONE),this.removeGetAwardBtnClickEvent(),this.initStartBtn()):x==p.LOTTERY_MODE.MODE_AUTO&&(this.startBtn.node.active=!1,this.updateStartBtn(p.BUTTON_STATUS.NONE),this.removeStartBtnClickEvent(),this.initGetAwardbtn())},enumerable:!0,configurable:!0}),F.prototype.initLotteryMode=function(){this.lotteryMode=p.LOTTERY_MODE.MODE_AD},F.prototype.startBtnClick=function(){if(y.MGAdv.isADCached(_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)||E.default.isWeb()){console.log("--- startBtnClick --- ");var x=this.lotteryHandler.getWorkerState("SwitchWorker");if(!this.currentLotteryStat||x!==t.WorkerState.stopped)return void console.log(1);console.log(2),this.buildAds(),this.report(3)}else k.default.getInstance().isEnglish()?this.showToastTips("No video ads available,please try again later",!1):this.showToastTips("\u6682\u65E0\u53EF\u7528\u89C6\u9891\u5E7F\u544A\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",!1),E.default.isWeiXin()||y.MGAdv.load(_.ADScene.LOTTERY,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)},F.prototype.getAwardBtnClick=function(){this.updateStartBtn(p.BUTTON_STATUS.SUCCESS)},Object.defineProperty(F.prototype,"doRollingButton",{get:function(){return this._lotteryMode==p.LOTTERY_MODE.MODE_AD?this.startBtn:this._lotteryMode==p.LOTTERY_MODE.MODE_AUTO?this.getAwardBtn:this.startBtn},enumerable:!0,configurable:!0}),F.prototype.updateStartBtn=function(x){var U=this;switch(console.log("--- updateStartBtn type --- ",x),x){case p.BUTTON_STATUS.SUCCESS:this._lotteryMode==p.LOTTERY_MODE.MODE_AD?this.lotteryProcess.updateLotteryRecently():this._lotteryMode==p.LOTTERY_MODE.MODE_AUTO&&this.lotteryProcess.setLotteryYestoday();var B=this.itemNodes,Q=this.adBackStatus;this.lotteryProcess.startRoll(B,Q),this.changeBtnStyle(p.BUTTON_STATUS.SUCCESS,function(Z,z){Z&&console.log("--- changeBtnStyle err ---",Z),U.doRollingButton.interactable=!1,U.doRollingButton.disabledSprite=z});break;case p.BUTTON_STATUS.FAIL:break;case p.BUTTON_STATUS.INTERACTABLE:this.doRollingButton.interactable=!1;break;case p.BUTTON_STATUS.NONE:this.doRollingButton.interactable=!0;break;default:this.doRollingButton.interactable=!1}},F.prototype.removeEvents=function(){this.removeCloseBtnClickEvent(),this.removeStartBtnClickEvent()},F.prototype.removeCloseBtnClickEvent=function(){this.closeBtnClickEvent&&this.skip.node.off(cc.Node.EventType.TOUCH_END,this.closeBtnClickEvent.click,this.closeBtnClickEvent)},F.prototype.removeStartBtnClickEvent=function(){this.startBtnClickEvent&&this.startBtn.node.off(cc.Node.EventType.TOUCH_END,this.startBtnClickEvent.click,this.startBtnClickEvent)},F.prototype.removeGetAwardBtnClickEvent=function(){this.getAwardBtnClickEvent&&this.getAwardBtn.node.off(cc.Node.EventType.TOUCH_END,this.getAwardBtnClickEvent.click,this.getAwardBtnClickEvent)},F.prototype.saveShowTime=function(){var x=g.MGUser.getCurrentServerTime()+"";i.default.save(a.default.LAST_SHOW_LUCKY_DIP_DIALOG_TIME,x)},F.prototype.setToastEndCallback=function(x){x&&(this.toastEndCallback=x)},F.prototype.getLotteryVMList=function(){return this.lotteryHandler.getLotteryVMList()},F.prototype.setCloseCallback=function(x){this.closeCallback=x},F.prototype.buildAds=function(){var x=this;if(this.isADFeatureEnable){var U=i.default.read(a.default.DEBUG_INFINITE_LOTTERY)==="true",B=_.ADScene.LOTTERY_RESULT_REWARD;!U&&y.MGAdv.show(B,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(Q){if(Q){switch(Q){case _.ADStat.NOT_NETWORK:x.showToastTips("No network available",!1);break;case _.ADStat.SHOW_SUCCESS_CLOSE:x.updateStartBtn(p.BUTTON_STATUS.SUCCESS);break;case _.ADStat.SHOW_NOT_ENED_CLOSE:break;case _.ADStat.SHOW_GET_AD_FAILED:x.adBackStatus=p.AD_STATUS.SKIP_AD,x.showToastTips("No video ads available",!1,x.toastEndCallback)}E.default.isWeiXin()||y.MGAdv.load(_.ADScene.LOTTERY,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)}}),U&&this.updateStartBtn(p.BUTTON_STATUS.SUCCESS)}else this.showToastTips("\u5FAE\u4FE1\u7248\u672C\u8FC7\u4F4E\uFF0C\u8BF7\u5347\u81F3\u6700\u65B0\u7248\u5FAE\u4FE1\u518D\u62BD\u5956!",!1)},F.prototype.showToastTips=function(x,U,B){var Q=this;S.default.load("prefab/ToastPrefab",function(Z,z){if(z){var W=z.getComponent(e.default);W.showTips(x,function(){z.destroy(),B&&B()}),W.setLong(U),Q.node.addChild(z)}})},F.prototype.changeBtnStyle=function(x,U){var B={},Q={};k.default.getInstance().isEnglish()?(Q[p.LOTTERY_MODE.MODE_AD]="lottery/button_rolling_en",Q[p.LOTTERY_MODE.MODE_AUTO]="lottery/get_award_btn_disable_en"):(Q[p.LOTTERY_MODE.MODE_AD]="lottery/button_rolling",Q[p.LOTTERY_MODE.MODE_AUTO]="lottery/get_award_btn_disable"),B[p.BUTTON_STATUS.SUCCESS]=Q,Q={},k.default.getInstance().isEnglish()?(Q[p.LOTTERY_MODE.MODE_AD]="lottery/button_normal_en",Q[p.LOTTERY_MODE.MODE_AUTO]="lottery/get_award_btn_enable_en"):(Q[p.LOTTERY_MODE.MODE_AD]="lottery/button_normal",Q[p.LOTTERY_MODE.MODE_AUTO]="lottery/get_award_btn_enable"),B[p.BUTTON_STATUS.END]=Q,Q={},k.default.getInstance().isEnglish()?(Q[p.LOTTERY_MODE.MODE_AD]="lottery/button_disable_en",Q[p.LOTTERY_MODE.MODE_AUTO]="lottery/get_award_btn_disable_en"):(Q[p.LOTTERY_MODE.MODE_AD]="lottery/button_disable",Q[p.LOTTERY_MODE.MODE_AUTO]="lottery/get_award_btn_disable"),B[p.BUTTON_STATUS.INTERACTABLE]=Q;var Z=B[x][this._lotteryMode];n.default.get(Z,U)},F.prototype.adaptorUI=function(){},F.prototype.update=function(x){3<=this.lotteryHandler.getDoneCount()&&this.initTipTxt(p.TIP_TYPE.TIP_RUN_OUT)},F.prototype.checkStopLottery=function(){(!y.MGAdv.isADCached(_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)||3<=r.LotteryProcess.getInstance().getLotteryHandler().getDoneCount())&&this.closeCallback&&(this.closeCallback(),this.removeEvents(),this.lotteryHandler.stopSwitchWorker())},F.prototype.showRewardPage=function(x){var U,B=this,Q=new u.AwardResultInfo;if(Q.setIsNeedGiveAwardInfo(!0).steSource(u.AwardResultInfo.SOURCE_LOTTERY),x.getIsSkinPiece()==1||(U=new u.AwardContent(c.GameItemsManager.getIns().getItemTypeByItemId(x.getId()),x.getCount(),x.getId())),Q.addAwardContentItem(U),this.isStarSkinLocked()&&i.default.read(a.default.LOTTERY_TOTAL_COUNT)=="5"){var Z=new u.AwardContent(c.GameItemsManager.getIns().getItemTypeByItemId(this.STAR_SKIN_ID),1,this.STAR_SKIN_ID);Q.addAwardContentItem(Z)}Q.setCloseParentCallback(function(){B.closeCallback&&(B.closeCallback(),B.removeEvents(),B.lotteryHandler.stopSwitchWorker())});var z="/static_res/button_daily_checkin_award_normal",W="/static_res/button_daily_checkin_award_pressed";if(k.default.getInstance().isEnglish()&&(z="/static_res/button_daily_checkin_award_normal_en",W="/static_res/button_daily_checkin_award_pressed_en"),u.AwardController.shouldDoubleAward(U))Q.setIsShowText(!1),Q.setRichOkBtn("",z,W,function(){B.showAdvForDoubleAwards(function(Y,q){if(Y)if(B.lotteryAwards){I.default.i("LotteryIndex","video adv shown, give awards.");var J=u.AwardController.filterAwardsForDouble(B.lotteryAwards);u.AwardController.giveAwardInfo(J),B.lotteryAwards=null}else I.default.i("LotteryIndex","video adv shown, but awards is invalidate");else I.default.i("LotteryIndex","video adv status callback");q?u.AwardController.getIns().dismissAwardResultPage(Q):I.default.i("LotteryIndex","video adv status callback BUT don't dismiss page")})}),Q.enableSkipLabel("",function(){u.AwardController.getIns().dismissAwardResultPage(Q),B.checkStopLottery()});else{var V="\u597D\u7684";k.default.getInstance().isEnglish()&&(V="OK"),Q.setOkBtn(V,function(){u.AwardController.getIns().dismissAwardResultPage(Q),B.checkStopLottery()})}k.default.getInstance().isEnglish()?Q.setTitlePicPath("/static_res/share_gift_congratulation_title_en"):Q.setTitlePicPath("/static_res/share_gift_congratulation_title"),this.lotteryAwards=Q.getAwardContentList(),u.AwardController.getIns().showCommonAwardResultPage(Q,this.node)},F.prototype.showAdvForDoubleAwards=function(x){var U=this,B=_.ADScene.LOTTERY_DOUBLE_AWARD;E.default.isCM()&&(B=window.SUPERVIDEO_LOTTERY_DOUBLE_AWARD),y.MGAdv.show(B,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(Q){var Z=!1,z=!1;switch(Q){case _.ADStat.NOT_NETWORK:U.showToastTips("No network available",!1),z=!0;break;case _.ADStat.SHOW_SUCCESS_CLOSE:if(z=Z=!0,U.lotteryAwards){var W=u.AwardController.filterAwardsForDouble(U.lotteryAwards);U.showToastTips(u.AwardController.getAwardsToastTip(W),!1)}break;case _.ADStat.SHOW_NOT_ENED_CLOSE:z=!0;break;case _.ADStat.SHOW_GET_AD_FAILED:U.showToastTips("No video ads available",!1),E.default.isWeiXin()||y.MGAdv.load(_.ADScene.LOTTERY_DOUBLE_AWARD,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),z=!0}x&&x(Z,z),E.default.isWeiXin()||y.MGAdv.load(_.ADScene.LOTTERY,_.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)})},F.prototype.report=function(x,U){switch(x){case 1:if(!U)return;var B=U.getId();c.GameItemsManager.getIns().isDiamondsType(B)&&h.default.report(U.getCount(),h.default.SOURCE_GET_LOTTERY,h.default.ACTION_GET_DIAMOND);break;case 2:f.default.report(0,f.default.ACTION_SHOW_LOTTERY_FRAME);break;case 3:f.default.report(0,f.default.ACTION_CLICK_LOTTERY_START)}},F.prototype.notifyTaskSys=function(){I.default.i("notifyTaskSys => notify lottery");var x=new d.NormalEvent;x.type=d.NormalEventType.LOTTERY,T.default.Ins().notifyNormalEvent(x)},__decorate([N(cc.Node)],F.prototype,"mainPanel",void 0),__decorate([N(cc.Button)],F.prototype,"startBtn",void 0),__decorate([N(cc.Button)],F.prototype,"getAwardBtn",void 0),__decorate([N(cc.Label)],F.prototype,"skip",void 0),__decorate([N(cc.Node)],F.prototype,"content",void 0),__decorate([N(cc.Prefab)],F.prototype,"item",void 0),__decorate([N(cc.Node)],F.prototype,"bkg",void 0),__decorate([N(cc.Label)],F.prototype,"tipTxt",void 0),__decorate([N(cc.Sprite)],F.prototype,"mSkinTipsLabel",void 0),__decorate([N(cc.Sprite)],F.prototype,"mSkinCountLabel",void 0),F=__decorate([b],F)}(cc.Component);m.default=H,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../config/LSKey":"LSKey","../../gamescene/workers/WorkerState":"WorkerState","../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../infoc/m_p2_Uaction":"m_p2_Uaction","../../upgrade/BannerDelayShowToggle":"BannerDelayShowToggle","../../upgrade/ToggleBean":"ToggleBean","../../util/PU":"PU","../../util/StringUtil":"StringUtil","../Logic/GameItemsManager":"GameItemsManager","../Logic/I18nManager":"I18nManager","../Logic/SkinDataManager":"SkinDataManager","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../awardcontroller/AwardController":"AwardController","../keypad/KeypadNavigator":"KeypadNavigator","../skin/frag/SkinTaskMgr":"SkinTaskMgr","./../skin/frag/SkinTaskMgr":"SkinTaskMgr","./LotteryEnum":"LotteryEnum","./LotteryItem":"LotteryItem","./LotteryProcess":"LotteryProcess"}],LotteryItem:[function(l,P,m){"use strict";cc._RF.push(P,"40731aCC7xNmZ0XIpwNOdfJ","LotteryItem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/ImgCache"),s=l("./LotteryEnum"),r=l("../Logic/I18nManager"),o=cc._decorator,e=o.ccclass,n=o.property,t=function(i){function a(){var u=i!==null&&i.apply(this,arguments)||this;return u.icon=null,u.numTxt=null,u}return __extends(a,i),a.prototype.init=function(u){u&&(this.initIcon(u),this.initNumTxt(u))},a.prototype.initIcon=function(u){if(u.getIsSkinPiece()==1){var c="/static_res/skin_chip/common_skin_piece";d.default.get2(c,this.icon)}else(c=u.getIcon())&&d.default.get2(c,this.icon)},a.prototype.initNumTxt=function(u){if(this.numTxt)if(u.getIsSkinPiece()==1){var c="",p=u.getCount();c="\u76AE\u80A4\u788E\u7247 x "+u.getCount(),this.numTxt.string=c}else{c="",p=u.getCount();var h=u.getSkinType();c=h===s.SKIN_TYPE.FOREVER?r.default.getInstance().getLanguageByKey("label_text.lottery_prize1"):h===s.SKIN_TYPE.LIMIT?r.default.getInstance().getLanguageByKey("label_text.lottery_prize2"):"x "+p,this.numTxt.string=c}},__decorate([n(cc.Sprite)],a.prototype,"icon",void 0),__decorate([n(cc.Label)],a.prototype,"numTxt",void 0),a=__decorate([e],a)}(cc.Component);m.default=t,cc._RF.pop()},{"../Logic/I18nManager":"I18nManager","../UI/GameEntraScene/ImgCache":"ImgCache","./LotteryEnum":"LotteryEnum"}],LotteryProcess:[function(l,P,m){"use strict";cc._RF.push(P,"c7a15X0miJFybr2Yytx/9Dr","LotteryProcess"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./LotteryHandler"),s=l("../Network/Protocol/StorageUtil"),r=l("../../config/LSKey"),o=l("../../util/StringUtil"),e=l("../../util/TimeUtil"),n=l("../../base/Log"),t=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),i=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),a=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),u=function(){function c(){this.lotteryHandler=null,this.newComing=null,this.hasShowLotteryOpenCold=!1,this.lotteryHandler=new d.LotteryHandler}return c.getInstance=function(){return c.mInstance||(c.mInstance=new c),c.mInstance},c.prototype.setNewComing=function(p){this.newComing=p},c.prototype.callLotteryFrame=function(){this.lotteryHandler.startDataEntry(this.newComing)},c.prototype.startRoll=function(p,h){this.lotteryHandler.startSwitchWorker(p,h)},c.prototype.getCurrentLotteryStat=function(p){this.lotteryHandler&&this.lotteryHandler.getCurrentLotteryStat(p)},c.prototype.getLotteryHandler=function(){return this.lotteryHandler},c.prototype.autoShowLottoryDlg=function(){var p=s.default.read(r.default.LAST_SHOW_LUCKY_DIP_DIALOG_TIME);if(o.StringUtil.isEmpty(p))return!0;var h=new Date(p),f=h.getFullYear(),g=h.getMonth()+1,_=h.getDay(),y=new Date,S=y.getFullYear(),I=y.getMonth()+1,v=y.getDay();return f<S||g<I||_<v},c.prototype.needShowLottoryDlgOpenCold=function(p){var h=this;if(this.hasShowLotteryOpenCold||!i.MGAdv.isADCached(a.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK))return n.default.i("[zf]LotteryProcess.needShowLottoryDlgOpenCold this.hasShowLotteryOpenCold = "+this.hasShowLotteryOpenCold+", this.getCountDown() = ,!ADLoadManager.gIns().isADCached() = "+!i.MGAdv.isADCached(a.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK)),void p(!1);t.MGUser.getCurrentServerRealTime({complete:function(f,g){if(f){var _=e.default.formatDate(g),y=s.default.read(r.default.LAST_LOTTERY_DATE,"");if(console.log("[zf]LotteryProcess.needShowLottoryDlgOpenCold currentDate = "+_+",lastLotteryDate = "+y),_===y){var S=d.LotteryHandler.EVERYDAY_LOTTERY_COUNT-Math.floor(parseInt(s.default.read(r.default.LOTTERY_COUNT,0)));console.log("[zf]LotteryProcess.needShowLottoryDlgOpenCold doneCount = "+S),0<S?(h.hasShowLotteryOpenCold=!0,p(!0)):p(!1)}else(y<_||!y)&&(h.hasShowLotteryOpenCold=!0,p(!0))}else p(!1)}})},c.prototype.updateLotteryRecently=function(){var p=this;this.ServerDateNow().then(function(h){if(h!=0){var f=e.default.formatDate(h);p.setLotteryRecentlyByKey(f)}else console.error("Call Server Time Error Occur")})},c.prototype.setLotteryRecentlyByKey=function(p){if(!o.StringUtil.isNullOrUndefined(p)){var h=s.default.read(r.default.LOTTERY_DATA_RECENTLY,"{}"),f=JSON.parse(h);f.hasOwnProperty(p)?f[p]=f[p]+1:f[p]=1;for(var g=Object.keys(f).sort(),_=7;_<g.length;_++)delete f[g[_]];s.default.save(r.default.LOTTERY_DATA_RECENTLY,JSON.stringify(f))}},c.prototype.getLotteryRecentlyBykey=function(p){var h=s.default.read(r.default.LOTTERY_DATA_RECENTLY,"{}"),f=JSON.parse(h);return p&&f.hasOwnProperty(p)?f[p]:0},c.prototype.ServerDateNow=function(){return new Promise(function(p){t.MGUser.getCurrentServerRealTime({complete:function(h,f){p(h?f:0)}})})},c.prototype.hasLotteryYestoday=function(){return __awaiter(this,void 0,Promise,function(){var p,h,f,g;return __generator(this,function(_){switch(_.label){case 0:return[4,this.ServerDateNow()];case 1:return(p=_.sent())==0?(console.error("Call Server Time Error Occur"),[2,!1]):(h=new Date(p),f=h.setDate(h.getDate()-1),g=e.default.formatDate(f),[2,0<this.getLotteryRecentlyBykey(g)])}})})},c.prototype.setLotteryYestoday=function(){var p=this;this.ServerDateNow().then(function(h){if(h!=0){var f=new Date(h),g=f.setDate(f.getDate()-1),_=e.default.formatDate(g);p.setLotteryRecentlyByKey(_)}else console.error("Call Server Time Error Occur")})},c}();m.LotteryProcess=u,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../config/LSKey":"LSKey","../../util/StringUtil":"StringUtil","../../util/TimeUtil":"TimeUtil","../Network/Protocol/StorageUtil":"StorageUtil","./LotteryHandler":"LotteryHandler"}],LotteryRoll:[function(l,P,m){"use strict";cc._RF.push(P,"95604c0xgJEK7xQSPjypywS","LotteryRoll"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.index=0,this.count=8,this.timer=0,this.speed=70,this.times=0,this.cycle=30,this.prize=-1}return s.prototype.start=function(r){try{if(!r)return;var o=this.index,e=this.count,n=r[o];n&&n.children&&(n.getChildByName("active").active=!1),e-1<(o+=1)&&(o=0);var t=r[o];t&&n.children&&(t.getChildByName("active").active=!0),this.index=o}catch(i){console.log("--- roll start err---",i)}},s.prototype.stop=function(r){this.prize=r},s}();m.LotteryRoll=d,cc._RF.pop()},{}],LotteryTask:[function(l,P,m){"use strict";cc._RF.push(P,"9a152BE0FtFR4uTo0ofy5Y0","LotteryTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],LotteryVM:[function(l,P,m){"use strict";cc._RF.push(P,"0ea48yhcOxKXJ71QJbOU6vv","LotteryVM"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.prototype.getId=function(){return this.id},s.prototype.setId=function(r){r&&(this.id=r)},s.prototype.getChanceMin=function(){return this.chanceMin},s.prototype.setChanceMin=function(r){r&&(this.chanceMin=r)},s.prototype.getChanceMax=function(){return this.chanceMax},s.prototype.setChanceMax=function(r){r&&(this.chanceMax=r)},s.prototype.getCount=function(){return this.count},s.prototype.setCount=function(r){r&&(this.count=r)},s.prototype.getIcon=function(){return this.icon},s.prototype.setIcon=function(r){r&&(this.icon=r)},s.prototype.setRewardType=function(r){r&&(this.rewardType=r)},s.prototype.getRewardType=function(){return this.rewardType},s.prototype.setSkinType=function(r){r&&(this.skinType=r)},s.prototype.getSkinType=function(){return this.skinType},s.prototype.setIndex=function(r){r&&(this.index=r)},s.prototype.getIndex=function(){return this.index},s.prototype.setBigIcon=function(r){r&&(this.bigIcon=r)},s.prototype.getBigIcon=function(){return this.bigIcon},s.prototype.setIsSkinPiece=function(r){this.isSkinPiece=r},s.prototype.getIsSkinPiece=function(){return this.isSkinPiece},s}();m.LotteryVM=d,cc._RF.pop()},{}],LvData:[function(l,P,m){"use strict";cc._RF.push(P,"5c875K9PlNCR7uksVP8cpMl","LvData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findLv=function(n){return this.find("lv",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.LvData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getLv=function(){return this.getInt("lv")},e.prototype.getExp=function(){return this.getInt("exp")},e.prototype.getRewarGold=function(){return this.getInt("RewarGold")},e.prototype.getRewarLife=function(){return this.getInt("RewarLife")},e}(d.default);m.LvRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],MActionFactory:[function(l,P,m){"use strict";cc._RF.push(P,"2c318aaNMlCtpG1PELWjEn8","MActionFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MScaleBy"),s=l("./MScaleTo"),r=l("./MFadeTo"),o=l("./MMoveTo"),e=l("./MMoveBy"),n=l("./MSequence"),t=l("./MSpawn"),i=l("./MAdvanceAnimation"),a=l("./MFrameSequence"),u=l("./MChildAction"),c=l("./MPropValue"),p=l("./MCircleMoveBy"),h=l("./MCircleMoveTo"),f=l("./MDelay"),g=l("./MRandomMove"),_=l("./MRandomFade"),y=l("./MRandomScale"),S=l("./MRandomChange"),I=l("../../MUI/MUIDefines"),v=l("./MSetProperty"),C=l("./MCallFunc"),T=function(){function E(){this.nameToIdMap=new Object,this.nameToIdMap.MAdvanceAnimation=I.MUI.ActionId.AdvanceAnimation,this.nameToIdMap.MBlink=I.MUI.ActionId.Blink,this.nameToIdMap.MCallFunc=I.MUI.ActionId.CallFunc,this.nameToIdMap.MChildAction=I.MUI.ActionId.ChildAction,this.nameToIdMap.MCircleMoveBy=I.MUI.ActionId.CircleMoveBy,this.nameToIdMap.MCircleMoveTo=I.MUI.ActionId.CircleMoveTo,this.nameToIdMap.MDelay=I.MUI.ActionId.Delay,this.nameToIdMap.MFadeTo=I.MUI.ActionId.FadeTo,this.nameToIdMap.MFrameSequence=I.MUI.ActionId.FrameSequence,this.nameToIdMap.MMoveBy=I.MUI.ActionId.MoveBy,this.nameToIdMap.MMoveTo=I.MUI.ActionId.MoveTo,this.nameToIdMap.MPropValue=I.MUI.ActionId.PropValue,this.nameToIdMap.MRandomChange=I.MUI.ActionId.RandomChange,this.nameToIdMap.MRandomFade=I.MUI.ActionId.RandomFade,this.nameToIdMap.MRandomMove=I.MUI.ActionId.RandomMove,this.nameToIdMap.MRandomScale=I.MUI.ActionId.RandomScale,this.nameToIdMap.MResizeBy=I.MUI.ActionId.ResizeBy,this.nameToIdMap.MResizeTo=I.MUI.ActionId.ResizeTo,this.nameToIdMap.MScaleBy=I.MUI.ActionId.ScaleBy,this.nameToIdMap.MScaleTo=I.MUI.ActionId.ScaleTo,this.nameToIdMap.MSelfDefine=I.MUI.ActionId.SelfDefine,this.nameToIdMap.MSequence=I.MUI.ActionId.Sequence,this.nameToIdMap.MSpawn=I.MUI.ActionId.Spawn,this.nameToIdMap.MSetProperty=I.MUI.ActionId.SetProperty}return E.prototype.getIdByName=function(A){var M=this.nameToIdMap[A];return M==null&&(M=I.MUI.ActionId.None),M},E.prototype.createMCallFuncAction=function(A){return new C.default(A)},E.prototype.createMChildAction=function(A,M){return new u.default(A,M)},E.prototype.createMDelayAction=function(A){return new f.default(A)},E.prototype.createMScaleTo=function(A,M,k){return new s.default(A,M,k)},E.prototype.createMScaleBy=function(A,M,k){return new d.default(A,M,k)},E.prototype.createMFadeTo=function(A,M){return new r.default(A,M)},E.prototype.createMMoveTo=function(A,M,k){return new o.default(A,M,k)},E.prototype.createMMoveBy=function(A,M,k){return new e.default(A,M,k)},E.prototype.createMCircleMoveTo=function(A,M,k,D){return new h.default(A,M,k,D)},E.prototype.createMCircleMoveBy=function(A,M,k,D){return new p.default(A,M,k,D)},E.prototype.createMPropValue=function(A,M){return new c.default(A,M)},E.prototype.createMAdvanceAnimation=function(A){return new i.default(A)},E.prototype.createMFrameSequence=function(A,M){return new a.default(A,M)},E.prototype.createMSequence=function(){for(var A=[],M=0;M<arguments.length;M++)A[M]=arguments[M];return new(n.default.bind.apply(n.default,[void 0].concat(A)))},E.prototype.createMSpawn=function(){for(var A=[],M=0;M<arguments.length;M++)A[M]=arguments[M];return new(t.default.bind.apply(t.default,[void 0].concat(A)))},E.prototype.createMRandomMove=function(A,M,k,D){return new g.default(A,M,k,D)},E.prototype.createMRandomFade=function(A,M){return new _.default(A,M)},E.prototype.createMRandomScale=function(A,M,k,D){return new y.default(A,M,k,D)},E.prototype.createMRandomChange=function(A,M,k,D,L,b,N,H,R,F,x,U,B,Q,Z,z,W,V,Y){return new S.default(A,M,k,D,L,b,N,H,R,F,x,U,B,Q,Z,z,W,V,Y)},E.prototype.createMSetProperty=function(A){return new v.default(A)},E.instance=new E,E}();m.default=T,cc._RF.pop()},{"../../MUI/MUIDefines":"MUIDefines","./MAdvanceAnimation":"MAdvanceAnimation","./MCallFunc":"MCallFunc","./MChildAction":"MChildAction","./MCircleMoveBy":"MCircleMoveBy","./MCircleMoveTo":"MCircleMoveTo","./MDelay":"MDelay","./MFadeTo":"MFadeTo","./MFrameSequence":"MFrameSequence","./MMoveBy":"MMoveBy","./MMoveTo":"MMoveTo","./MPropValue":"MPropValue","./MRandomChange":"MRandomChange","./MRandomFade":"MRandomFade","./MRandomMove":"MRandomMove","./MRandomScale":"MRandomScale","./MScaleBy":"MScaleBy","./MScaleTo":"MScaleTo","./MSequence":"MSequence","./MSetProperty":"MSetProperty","./MSpawn":"MSpawn"}],MAction:[function(l,P,m){"use strict";cc._RF.push(P,"5500fYapYBIZKfj4uc/AvHV","MAction"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r){this.name="",this.duration=0,this.time=0,this.target=null,this.duration=r}return s.prototype.getDuration=function(){return this.duration},s.prototype.getTime=function(){return this.time},s.prototype.getTarget=function(){return this.target},s.prototype.ready=function(){this.time=0,this.target=null},s.prototype.start=function(r){this.target=r},s.prototype.update=function(r){return this.time+=r,this.time>=this.duration},s.prototype.last=function(r){this.target=null},s.prototype.finish=function(){return this.time>=this.duration},s.prototype.stopForce=function(){this.time=this.duration},s.prototype.percent=function(){return this.duration<=0?0:this.time/this.duration},s}();m.default=d,cc._RF.pop()},{}],MAdvanceAnimation:[function(l,P,m){"use strict";cc._RF.push(P,"afd989lj8pAHKJtbEKXlgGI","MAdvanceAnimation"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MAction"),s=l("./AnimationWork"),r=l("../../../util/Utility"),o=function(){this.node=null,this.rect=new r.Utility.Rect(0,0,0,0)},e=function(n){function t(i){var a=n.call(this,0)||this;return a.work=new s.default,a.work.load(i),a.duration=a.work._duration,a}return __extends(t,n),t.prototype.ready=function(){n.prototype.ready.call(this),this.objectMap=null},t.prototype.start=function(i){n.prototype.start.call(this,i),this.work.start()},t.prototype.update=function(i){var a=n.prototype.update.call(this,i);if(this.work.update(i),this.target)for(var u in this.work._allValues){var c=this.work._allValues[u],p=this.getNodeAndCache(u);if(p!=null)for(var h in c)if(h==="scale"){var f=c[h];p.node.setScale(f.x)}else h==="position"?(f=c[h],p.node.setPosition(f.x+p.rect.x,f.y+p.rect.y)):h==="x"?(f=c[h],p.node.setPositionX(f+p.rect.x)):h==="y"?(f=c[h],p.node.setPositionY(f+p.rect.y)):h==="opacity"?(f=c[h],p.node.setOpacity(f/255)):h==="rotation"&&(f=c[h],p.node.setRotation(f/360*Math.PI))}return a},t.prototype.last=function(i){for(var a in i===void 0&&(i=!1),this.objectMap){var u=this.objectMap[a];u.node.move(u.rect.x,u.rect.y,u.rect.width,u.rect.height)}this.objectMap=null,n.prototype.last.call(this,i)},t.prototype.getNodeAndCache=function(i){this.objectMap==null&&(this.objectMap=new Object);var a=this.objectMap[i];if(a==null){var u=this.target,c=null;(c=i==="root"?u:u.getChildByName(i))&&((a=new o).node=c,a.rect.copy(a.node.getRect()),this.objectMap[i]=a)}return a},t}(d.default);m.default=e,cc._RF.pop()},{"../../../util/Utility":"Utility","./AnimationWork":"AnimationWork","./MAction":"MAction"}],MAnimationMgr:[function(l,P,m){"use strict";cc._RF.push(P,"aa7eaKTtmVMtI/b6oxkKZhI","MAnimationMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.data=null,this.repeat=!1,this.deleted=!1},s=function(){function r(){this.actionItems=[]}return r.prototype.update=function(o){for(var e=0,n=this.actionItems.length;e<n;++e)if(!(i=this.actionItems[e]).deleted&&i.data.update(o))if(i.repeat){var t=i.data.getTarget();i.data.last(!1),i.data.ready(),i.data.start(t)}else i.data.last(!1),i.deleted=!0;for(e=0,n=this.actionItems.length;e<n;++e){var i;(i=this.actionItems[e]).deleted&&(this.actionItems.splice(e,1),--e,--n)}},r.prototype.runAction=function(o,e,n){if(n===void 0&&(n=null),!e||!o)return null;e.getTarget()&&this.stopAction(e),n&&(e.name=n),e.ready(),e.start(o);var t=new d;return t.data=e,this.actionItems.push(t),t},r.prototype.runActionRepeat=function(o,e,n){n===void 0&&(n=null);var t=this.runAction(o,e,n);t&&(t.repeat=!0)},r.prototype.stopAction=function(o){for(var e=0,n=this.actionItems.length;e<n;++e){var t=this.actionItems[e];if(o==t.data)return t.deleted=!0,t.data.last(!0),!0}return!1},r.prototype.stopActionByName=function(o){for(var e=0,n=this.actionItems.length;e<n;++e){var t=this.actionItems[e];if(t.data.name===o)return t.deleted=!0,t.data.last(!0),!0}return!1},r.prototype.stopTargetActions=function(o){for(var e=!1,n=0,t=this.actionItems.length;n<t;++n){var i=this.actionItems[n];i.data.getTarget()==o&&(i.deleted=!0,i.data.last(!0),e=!0)}return e},r.prototype.stopAllActions=function(){for(var o=0,e=this.actionItems.length;o<e;++o){var n=this.actionItems[o];n.deleted=!0,n.data.last(!0)}},r}();m.default=s,cc._RF.pop()},{}],MBlink:[function(l,P,m){"use strict";cc._RF.push(P,"d1713FiOE1JNaF0ykUHyX6m","MBlink"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){var n=s.call(this,e)||this;return n.currentFrame=0,n.frameCount=2*o,n}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.currentFrame=0},r.prototype.update=function(o){var e=s.prototype.update.call(this,o),n=Math.floor(this.percent()*this.frameCount);if(n>this.currentFrame){this.currentFrame=n;var t=this.target;if(t){var i=!t.getVisible();t.setVisible(i)}}return e},r.prototype.stopForce=function(){s.prototype.stopForce.call(this),this.currentFrame=this.frameCount},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MCallFunc:[function(l,P,m){"use strict";cc._RF.push(P,"141aeEpNkdAyos3PyNbe0WS","MCallFunc"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o){var e=s.call(this,0)||this;return e.cb=null,e.executed=!1,e.cb=o,e}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.executed=!1},r.prototype.update=function(o){return s.prototype.update.call(this,o),this.cb&&this.cb(),this.executed=!0},r.prototype.finish=function(){return this.executed},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MChildAction:[function(l,P,m){"use strict";cc._RF.push(P,"c4ce61l1lZHCrOpLTNIxwk3","MChildAction"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){var n=s.call(this,e.getDuration())||this;return n.childName=o,n.childNode=null,n.innerAction=e,n}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.childNode=null,this.innerAction.ready()},r.prototype.start=function(o){s.prototype.start.call(this,o),this.childNode=o.getChildByName(this.childName),this.innerAction.start(this.childNode)},r.prototype.update=function(o){return this.time+=o,this.innerAction.update(o)},r.prototype.last=function(o){s.prototype.last.call(this,o),this.childNode=null,this.innerAction.last(o)},r.prototype.stopForce=function(){s.prototype.stopForce.call(this),this.innerAction.stopForce()},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MCircleMoveBy:[function(l,P,m){"use strict";cc._RF.push(P,"33a6f/1jMBOVKwborLoYilH","MCircleMoveBy"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n,t){var i=s.call(this,t)||this;return i.origRadians=0,i.byRadians=0,i.radius=0,i.centerX=0,i.centerY=0,i.centerX=o,i.centerY=e,i.byRadians=cc.degreesToRadians(n),i}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.radius=0,this.origRadians=0},r.prototype.start=function(o){s.prototype.start.call(this,o);var e=this.target;if(e){e.getRect();var n=this.centerX,t=this.centerY;this.radius=cc.pDistance(new cc.Vec2(0,0),new cc.Vec2(this.centerX,this.centerY)),this.origRadians=Math.atan2(t,n)}},r.prototype.update=function(o){var e=s.prototype.update.call(this,o),n=this.target;if(n){var t=this.origRadians+this.byRadians*this.percent(),i=this.centerX+this.radius*Math.cos(t),a=this.centerY+this.radius*Math.sin(t);n.move(i,a)}return e},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MCircleMoveTo:[function(l,P,m){"use strict";cc._RF.push(P,"e13d10oOSlPprMQLjwBk5tM","MCircleMoveTo"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n,t){return s.call(this,o,e,n,t)||this}return __extends(r,s),r.prototype.start=function(o){s.prototype.start.call(this,o),this.byRadians=this.byRadians-this.origRadians},r}(l("./MCircleMoveBy").default);m.default=d,cc._RF.pop()},{"./MCircleMoveBy":"MCircleMoveBy"}],MDelay:[function(l,P,m){"use strict";cc._RF.push(P,"bbee5CqkHdOTqE8D97to3/v","MDelay"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o){return s.call(this,o)||this}return __extends(r,s),r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MFadeTo:[function(l,P,m){"use strict";cc._RF.push(P,"7e19aTYxrNK/LRVWjZfN6lL","MFadeTo"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){var n=s.call(this,e)||this;return n.originOpacity=0,n.destOpacity=0,n.deltaOpacity=0,n.destOpacity=o,n}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.originOpacity=0,this.deltaOpacity=0},r.prototype.start=function(o){s.prototype.start.call(this,o);var e=this.target;e&&(this.originOpacity=e.getOpacity(),this.deltaOpacity=this.destOpacity-this.originOpacity)},r.prototype.update=function(o){var e=s.prototype.update.call(this,o),n=this.target;if(n){var t=this.deltaOpacity*this.percent()+this.originOpacity;n.setOpacity(t)}return e},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MFrameSequence:[function(l,P,m){"use strict";cc._RF.push(P,"05e33HBfMZO7YJve1FPp4CI","MFrameSequence"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){var n=s.call(this,e)||this;return n.currentFrame=0,n.frameCount=o,n}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.currentFrame=0},r.prototype.update=function(o){var e=s.prototype.update.call(this,o),n=Math.floor(this.percent()*this.frameCount);if(n>this.currentFrame){this.currentFrame=n;var t=this.target;t&&t.setFrame(n)}return e},r.prototype.stopForce=function(){s.prototype.stopForce.call(this),this.currentFrame=this.frameCount},r.prototype.last=function(o){s.prototype.last.call(this,o),this.currentFrame!=this.frameCount&&console.warn("this.currentFrame != this.frameCount")},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MGAdUnitManager:[function(l,P,m){"use strict";cc._RF.push(P,"dae1bwDz/5IbpeaK7Cuuggm","MGAdUnitManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../scripts/base/Log"),s=l("../../scripts/LogicPlatform/PlatformProxy"),r=l("../MGBasic/scripts/Logic/MGBasicEntrance"),o=function(){function e(){this.mData=null,this.inited=!1}return e.Instance=function(){return e.sinstance==null&&(e.sinstance=new e).init(),e.sinstance},e.prototype.init=function(){this.getConfig()},e.prototype.getConfig=function(){var n=this;this.requestCfg(function(t){n.mData=t,n.inited=!0},function(){n.inited=!0})},e.prototype.getBannerAdUnit=function(n,t){if(!this.inited)return t;var i=this.getObjByChannel(n);if(!i)return t;if(i.hasOwnProperty("banner")&&i.hasOwnProperty("begin_time")&&i.hasOwnProperty("end_time")){var a=i.begin_time,u=i.end_time,c=i.banner;if(a&&u){var p=new Date,h=new Date(a);if(p<new Date(u)&&h<p)return c}return t}return t},e.prototype.getVideoAdUnit=function(n,t){if(!this.inited)return t;var i=this.getObjByChannel(n);if(!i)return t;if(i.hasOwnProperty("video")&&i.hasOwnProperty("begin_time")&&i.hasOwnProperty("end_time")){var a=i.begin_time,u=i.end_time,c=i.video;if(a&&u){var p=new Date,h=new Date(a);if(p<new Date(u)&&h<p)return c}return t}return t},e.prototype.getObjByChannel=function(n){if(!this.mData||!n)return null;for(var t=0;t<this.mData.length;t++){var i=this.mData[t];if(i&&i.hasOwnProperty("channel")&&n===i.channel)return i}},e.prototype.uinit=function(){this.mData=null,this.inited=!1},e.prototype.requestCfg=function(n,t){s.default.Ins().downloadFile(e.CFG_URL,function(i){r.MGBasic.readFile({filePath:i,encoding:"utf8",success:function(a){n(a)},fail:function(){t()}})},function(){d.default.e("download failed."+e.CFG_URL),t()},0,!1)},e.sinstance=null,e.CFG_URL="https://piano-weixin-game.cmcm.com/pianotiles2/mammon/channel_adunit_cfg.json",e}();m.default=o,cc._RF.pop()},{"../../scripts/LogicPlatform/PlatformProxy":"PlatformProxy","../../scripts/base/Log":"Log","../MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance"}],MGAdvDefine:[function(l,P,m){"use strict";cc._RF.push(P,"143a9pExjdID6jNoqh35C3H","MGAdvDefine"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function e(){}return e.NONE=-2,e.NOT_SUPPORT=-1,e.NOT_NETWORK=0,e.LOAD_SUCCESS=1,e.LOAD_FAILED=2,e.SHOW_SUCCESS_CLOSE=3,e.SHOW_NOT_ENED_CLOSE=4,e.SHOW_GET_AD_FAILED=5,e.SHOWING_PAGE=6,e.CLICK_BANNER=7,e}();m.ADStat=d;var s=function(){function e(){}return e.GET_DIAMOND_POPUP=1,e.GET_ENERGY_POPUP=2,e.RELIVE_POPUP=3,e.NORMAL_RESULT_REWARD=4,e.CHALLENGE_RESULT_REWARD=5,e.PLAY_GAME=40,e.PLAY_AGAIN=41,e.LOTTERY_RESULT_REWARD=6,e.LOTTERY=7,e.GAME_RESULT_BANNER=8,e.BATTLE_MAIN_PAGE=9,e.GAME_SCENE_REWARD_PROP=10,e.FIGHT_RESULT_BANNER=11,e.DAILY_ATTENDANCE_CHECKIN=12,e.SCENE_VIDEO_PRIZE_PROPERTY=13,e.LOTTERY_DOUBLE_AWARD=14,e.SCENE_VIDEO_FIGHT_RESULT=15,e.SCENE_CHANLENGE_FLAUNT_RESULT=16,e.SCENE_SINGLESONG_FLAUNT_RESULT=17,e.SCENE_VIDEO_RELIVE_NORMAL=18,e.SCENE_VIDEO_RELIVE_CHALLENGE=19,e.SCENE_FIGHT_FAILED=20,e.SCENE_FIGHT_WIN2=21,e.SCENE_SKIN_TASK=22,e.SCENE_PLAYING_DASH=24,e.SCENE_PLAYING_SLOW=25,e.SCENE_PLAYING_COUNTERACT=26,e.SCENE_LOTTERY_FREE=27,e.SOURCE_RELIVE_WITH_DASH_NORMAL=23,e.SOURCE_RELIVE_WITH_SHEILD_NORMAL=30,e.SOURCE_RELIVE_WITH_DASH_CHALLENG=28,e.SOURCE_RELIVE_WITH_SHEILD_CHALLENG=29,e.SOURCE_NORMAL_RESULT_BANNER_DYNAMIC=31,e.SOURCE_DAILY_ATTENDANCE_FRONT=32,e.SOURCE_LOTTERY_BANNER=33,e.SOURCE_DAILY_WELFARE=34,e.SOURCE_SHOW_AWARD=35,e.SOURCE_DAILY_AWARD=36,e.SOURCE_FIGHT_RESULT_SHOW_OFF=37,e.SCENE_CM_PLAY_SKIN_WATCH_ADS=38,e.SOURCE_HOTMUSIC_UNLOCK=39,e}();m.ADScene=s;var r=function(){function e(){}return e.VIDEO_TYPE_GAME_BANNER=0,e.VIDEO_TYPE_GAME_OVER=1,e.VIDEO_TYPE_GAME_TASK=2,e.VIDEO_TYPE_GAME_RELIVE=3,e.VIDEO_TYPE_HOTMUSIC_UNLOCK=4,e.VIDEO_TYPE_SKIN_UNLOCK=5,e.VIDEO_TYPE_PLAY_GAME=6,e.VIDEO_TYPE_PLAY_AGAIN=7,e}();m.QQ_ADV_TYPE=r;var o=function(){function e(){}return e.STATIC_BANNER=1001,e.DYNAMIC_BANNER=1002,e.GDT_BANNER=1003,e}();m.QQ_BANNER_TYPE=o,cc._RF.pop()},{}],MGAdvEntrance:[function(l,P,m){"use strict";cc._RF.push(P,"9f057DA6RtFrpjX4YRso3pK","MGAdvEntrance"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MGAdvDefine"),s=l("../Adapter/AdvHelperCMplay"),r=function(){function o(){this.mLastGetADFailedTime=0,this.mCurrentBannerScene=-1}return o.prototype.init=function(e){this.mMGAdvHelper=new s.default(e),this.mMGAdvHelper.init()},o.prototype.isADFeatureEnable=function(){return!!this.mMGAdvHelper&&this.mMGAdvHelper.isEnable()},o.prototype.load=function(e,n,t){this.isADCached(n)?t&&t(d.ADStat.LOAD_SUCCESS):this.doLoad(n,function(i,a){t&&t(i)})},o.prototype.doLoad=function(e,n){this.isADFeatureEnable()!=0?this.isNetWorkConnected()!=0?this.mMGAdvHelper&&this.mMGAdvHelper.load(e,n):n&&n(d.ADStat.NOT_NETWORK):n&&n(d.ADStat.NOT_SUPPORT)},o.isClickRVAdTooMuch=function(){var e,n=Date.now();return e=n-o.timeClickRVBtnLast<2e3,o.timeClickRVBtnLast=n,e&&MGB.Log.i("MGB_DEBUG","click video btn too much."),e},o.prototype.show=function(e,n,t){o.isClickRVAdTooMuch()?MGB.Log.i("MGB_DEBUG","click reward video button too much."):this.doShow(n,function(i,a){t&&t(i)},e)},o.prototype.commercialBreak=function(e,n,t){o.isClickRVAdTooMuch()?MGB.Log.i("MGB_DEBUG","click commercialBreak button too much."):this.isNetWorkConnected()!=0?this.mMGAdvHelper.commercialBreak(n,function(i,a){t&&t(i,a)},e):t&&t(d.ADStat.NOT_NETWORK)},o.prototype.gameplayStart=function(){this.isNetWorkConnected()!=0&&this.mMGAdvHelper.gameplayStart()},o.prototype.gameplayStop=function(){this.isNetWorkConnected()!=0&&this.mMGAdvHelper.gameplayStop()},o.prototype.roundStart=function(e){this.isNetWorkConnected()!=0&&this.mMGAdvHelper.roundStart(e)},o.prototype.roundEnd=function(e){this.isNetWorkConnected()!=0&&this.mMGAdvHelper.roundEnd(e)},o.prototype.displayAD=function(e){e===void 0&&(e=!0),this.isNetWorkConnected()!=0&&this.mMGAdvHelper.displayAD(e)},o.prototype.customEvent=function(e,n,t){this.isNetWorkConnected()!=0&&this.mMGAdvHelper.customEvent(e,n,t)},o.prototype.doShow=function(e,n,t){var i=this;this.isADFeatureEnable()!=0?this.isNetWorkConnected()!=0?this.mMGAdvHelper.show(e,function(a,u){a===d.ADStat.SHOW_GET_AD_FAILED&&(i.mLastGetADFailedTime=new Date().getTime()),n&&n(a,u)},t):n&&n(d.ADStat.NOT_NETWORK):n&&n(d.ADStat.NOT_SUPPORT)},o.prototype.isNetWorkConnected=function(){return!!this.mMGAdvHelper&&this.mMGAdvHelper.isNetWorkConnected()},o.prototype.isADCached=function(e){return!!this.mMGAdvHelper&&this.mMGAdvHelper.isADCached(e)},o.prototype.lastFailIs30Minutes=function(){return this.mLastGetADFailedTime==0||new Date().getTime()-this.mLastGetADFailedTime>=o.LAST_FAILS_TIME_INTERVAL},o.prototype.isBannerShow=function(){return this.mCurrentBannerScene!=-1},o.prototype.loadBanner=function(e,n,t,i,a,u){console.log("MGAdv loadBanner"),this.mMGAdvHelper&&this.mMGAdvHelper.loadBanner(e,n,t,i,a,u),this.mCurrentBannerScene=a||0},o.prototype.showBanner=function(e,n){console.log("MGAdv showBanner"),this.isADFeatureEnable()!=0?this.isNetWorkConnected()!=0?(this.mCurrentBannerScene=e,this.mMGAdvHelper.showBanner(function(t,i,a){n&&n(d.ADStat.SHOWING_PAGE,i,a)},function(){},null,e)):n&&n(d.ADStat.NOT_NETWORK):n&&n(d.ADStat.NOT_SUPPORT)},o.prototype.hideBanner=function(e){this.mMGAdvHelper&&this.mMGAdvHelper.hideBanner(e)},o.prototype.destroyBanner=function(e){this.mMGAdvHelper&&this.mMGAdvHelper.destoryBanner(e),e==this.mCurrentBannerScene&&(this.mCurrentBannerScene=-1)},o.prototype.isBannerCached=function(e){return console.log("MGAdv isBannerCache: "+(this.mMGAdvHelper&&this.mMGAdvHelper.isBannerCached())),this.mMGAdvHelper&&this.mMGAdvHelper.isBannerCached(e)},o.prototype.isOverPageBannerShow=function(){return this.mMGAdvHelper&&this.mMGAdvHelper.isOverPageBannerShowed()},o.LAST_FAILS_TIME_INTERVAL=18e5,o.timeClickRVBtnLast=0,o}();m.default=r,m.MGAdv=new r,cc._RF.pop()},{"../Adapter/AdvHelperCMplay":"AdvHelperCMplay","./MGAdvDefine":"MGAdvDefine"}],MGAdvHelper:[function(l,P,m){"use strict";cc._RF.push(P,"4a070Ww58FBHrk33U4RH09j","MGAdvHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r){this.mPlatformType=r}return s.prototype.getPlatformType=function(){return this.mPlatformType},s}();m.default=d,cc._RF.pop()},{}],MGAppShare:[function(l,P,m){"use strict";cc._RF.push(P,"3a799ulyEFO+YB4EK54+f+3","MGAppShare"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Utils"),s=l("../../../scripts/util/PU"),r=l("../../../scripts/base/Log"),o=function(){function a(){}return a.share=function(u,c){if(r.default.i("[MGAppShare] share : "+(u?JSON.stringify(u):"")),!a.mShareAdapter)if(cc.sys.platform==cc.sys.WECHAT_GAME)a.mShareAdapter=new t;else if(cc.sys.platform==cc.sys.QQ_PLAY)a.mShareAdapter=new n;else{if(!s.default.isCM)return void(c&&c({result:!1}));a.mShareAdapter=new i}cc.sys.platform==cc.sys.WECHAT_GAME&&(u.query&&u.type?u.query+="&src="+u.type:u.type&&(u.query="src="+u.type)),a.mShareAdapter.share(u,c)},a.initShare=function(u,c,p,h){var f=this;s.default.isWeiXin()&&this.showShareMenu(!0,function(g){g?f.onShareAppMessage(u,c,p,h):h&&h(!1)})},a.showShareMenu=function(u,c){wx.showShareMenu({withShareTicket:u,success:function(){c&&c(!0)},fail:function(){c&&c(!1)}})},a.onShareAppMessage=function(u,c,p,h){wx.onShareAppMessage(function(f,g){return{title:u,imageUrl:c,query:p,success:function(){h&&h(!0)},fail:function(){h&&h(!1)}}})},a}();m.default=o;var e=function(){},n=function(a){function u(){return a!==null&&a.apply(this,arguments)||this}return __extends(u,a),u.prototype.share=function(c,p){c.imgUrlSocial?(console.log("shareAppMessageWithDialog"),d.Utils.shareAppMessageWithDialog(c.title,c.imgUrl,c.imgUrlSocial,c.query,c.type,p)):(console.log("shareAppMessageQQ"),d.Utils.shareAppMessageQQ(c.title,c.imgUrl,c.query,c.type,p))},u}(e),t=function(a){function u(){return a!==null&&a.apply(this,arguments)||this}return __extends(u,a),u.prototype.share=function(c,p){d.Utils.shareAppMessageWX(c.title,c.imgUrl,c.query,p)},u}(e),i=function(a){function u(){return a!==null&&a.apply(this,arguments)||this}return __extends(u,a),u.prototype.share=function(c,p){d.Utils.shareAppMessageCM(c.title,c.type,c.query,p)},u}(e);cc._RF.pop()},{"../../../scripts/base/Log":"Log","../../../scripts/util/PU":"PU","./Utils":"Utils"}],MGBGiftBoxWrapper:[function(l,P,m){"use strict";cc._RF.push(P,"4b0d4mlzOhB950s1vmwpv3/","MGBGiftBoxWrapper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../looper/Looper"),s=l("./MGBSdkInit"),r=function(){function o(){this.mRcmdDest=null,this.mSprite=null,this.mDlBrickesLooper=null}return o.prototype.initGiftBox=function(e,n,t){t===void 0&&(t=o.INTERVAL_TIME),s.default.initMGBSdk(n),this.mSprite=e,this.fetchData("1001102",!0,t)},o.prototype.fetchData=function(e,n,t){var i=this;new MGB.MGBRcmd4GiftBox(e,{onReady:function(a){MGRPT.minigame_common_ad.report(e,MGB.MGBAdAction.ACTION_BUTTON_SHOW,0,MGB.MGBAdDefs.APTYPE_RCMD_GIFTBOX),i.startLoop(a,t)},onFailed:function(){n&&(MGB.MGBRcmd4GiftBox.fillCache(i.localData4RcmdGiftBox()),i.fetchData(e,!1,t))}})},o.prototype.startLoop=function(e,n){var t=this;e&&(this.mRcmdDest=e,this.mRcmdDest&&this.loadIcon(this.startAnim.bind(this)),this.mDlBrickesLooper||(this.mDlBrickesLooper=new d.default,this.mDlBrickesLooper.setWork(function(){t.mRcmdDest.next(),t.loadIcon(t.startAnim.bind(t))}),this.mDlBrickesLooper.start(n)),this.mSprite&&this.mSprite.node&&this.mSprite.node.on(cc.Node.EventType.TOUCH_END,this.onClickDestIcon.bind(this)))},o.prototype.loadIcon=function(e){if(this.mRcmdDest){var n=this.mRcmdDest.getIconUrlCur();cc.loader.load(n,function(t,i){e&&e(t,i)})}},o.prototype.startAnim=function(e,n){if(this.mSprite&&!e){this.mSprite.node.stopAllActions(),this.mSprite.spriteFrame=new cc.SpriteFrame(n);var t=this.getAnimAction();this.mSprite.node.runAction(t),this.mSprite.node.active=!0,this.mSprite.node.width=60,this.mSprite.node.height=80}},o.prototype.onClickDestIcon=function(){var e=this;setTimeout(function(){e.mRcmdDest.jump()},0)},o.prototype.getAnimAction=function(){var e=cc.scaleTo(.3,1.15),n=cc.scaleTo(.2,1.2),t=cc.scaleTo(.5,.9),i=cc.scaleTo(.3,1),a=cc.scaleTo(.5,1);return cc.repeatForever(cc.sequence(e,n,t,i,a))},o.prototype.onDestroy=function(){this.mDlBrickesLooper&&this.mDlBrickesLooper.stop(),this.mSprite&&this.mSprite.node&&this.mSprite.node.stopAllActions()},o.prototype.onHide=function(){this.mDlBrickesLooper&&this.mDlBrickesLooper.stop(),this.mSprite&&this.mSprite.node&&this.mSprite.node.pauseAllActions()},o.prototype.onShow=function(e){e===void 0&&(e=o.INTERVAL_TIME),this.mDlBrickesLooper&&(this.mDlBrickesLooper.getStarted()||this.mDlBrickesLooper.start(e)),this.mSprite&&this.mSprite.node&&this.mSprite.node.resumeAllActions()},o.prototype.localData4RcmdGiftBox=function(){return'{            "games": [                {                    "name": "BNB",                    "gameid_wx": "wx3ab3658aab34d7db",                    "gameid_qq": "3511",                    "icon": "https://piano-weixin-game.cmcm.com/pianotiles2/cfg/game_rcmd/2001/brickes.png"                },                {                    "name": "DL",                    "gameid_wx": "wxf976a9e8c25dedf2",                    "gameid_qq": "3091",                    "icon": "https://piano-weixin-game.cmcm.com/pianotiles2/cfg/game_rcmd/2001/dancinglineA.png"                }            ],            "posconfig": [                {                    "posid": 1001102,                    "start_pos": 0                },                {                    "posid": 1001103,                    "start_pos": 1                }            ]        }'},o.INTERVAL_TIME=8,o}();m.default=r,cc._RF.pop()},{"../looper/Looper":"Looper","./MGBSdkInit":"MGBSdkInit"}],MGBSdkInit:[function(l,P,m){"use strict";cc._RF.push(P,"1c792oNN1lONIHcZl6XFlp5","MGBSdkInit"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/GameInfoMgr"),s=function(){function r(){}return r.initMGBSdk=function(o){if(!this.mbInited){var e=d.GameInfoMgr.Ins().getInfo();MGB.MGBRcmdModule.inst().init(e.gameid),this.mbInited=!0}},r.mbInited=!1,r}();m.default=s,cc._RF.pop()},{"../../base/GameInfoMgr":"GameInfoMgr"}],MGBasicEntrance:[function(l,P,m){"use strict";cc._RF.push(P,"16b091rE4RLrbmywr5PI0ag","MGBasicEntrance"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Adapter/BasicHelperWX"),s=l("../Adapter/BasicHelperQQ"),r=l("../Adapter/BasicHelperFB"),o=l("../Adapter/BasicHelperWeb"),e=l("../../../MGUtils/TypeDefinition"),n=l("../Adapter/BasicHelperCM"),t=function(){function i(){}return i.prototype.init=function(a){switch(a){case e.PlatformType.PLATFORM_H5SDK:case e.PlatformType.PLATFORM_GAMEHALL:case e.PlatformType.PLATFORM_WECHAT:this.mMGBasicHelper=new d.BasicHelperWX(a);break;case e.PlatformType.PLATFORM_FACEBOOK:this.mMGBasicHelper=new r.BasicHelperFB(a);break;case e.PlatformType.PLATFORM_QQPLAY:this.mMGBasicHelper=new s.BasicHelperQQ(a);break;case e.PlatformType.PLATFORM_CMPLAY:this.mMGBasicHelper=new n.BasicHelperCM(a);break;default:this.mMGBasicHelper=new o.BasicHelperWeb(a)}},i.prototype.setStorage=function(a,u){return!!this.mMGBasicHelper&&this.mMGBasicHelper.setStorage(a,u)},i.prototype.getStorage=function(a){return this.mMGBasicHelper?this.mMGBasicHelper.getStorage(a):""},i.prototype.delStorage=function(a){return!!this.mMGBasicHelper&&this.mMGBasicHelper.delStorage(a)},i.prototype.networkRequest=function(a){if(this.mMGBasicHelper)return this.mMGBasicHelper.networkRequest(a)},i.prototype.getLaunchParameter=function(){return this.mMGBasicHelper?this.mMGBasicHelper.getLaunchParameter():new e.LaunchOption},i.prototype.readFile=function(a){if(!this.mMGBasicHelper)return a.complete&&a.complete(!1,null),void(a.fail&&a.fail());this.mMGBasicHelper.readFile(a)},i.prototype.navigateToMiniProgram=function(a){if(!this.mMGBasicHelper)return a.complete&&a.complete(!1,null),void(a.fail&&a.fail());this.mMGBasicHelper.navigateToMiniProgram(a)},i.prototype.getChannelId=function(){return this.mMGBasicHelper.getChannelId()},i}();m.default=t,m.MGBasic=new t,cc._RF.pop()},{"../../../MGUtils/TypeDefinition":"TypeDefinition","../Adapter/BasicHelperCM":"BasicHelperCM","../Adapter/BasicHelperFB":"BasicHelperFB","../Adapter/BasicHelperQQ":"BasicHelperQQ","../Adapter/BasicHelperWX":"BasicHelperWX","../Adapter/BasicHelperWeb":"BasicHelperWeb"}],MGBasicHelper:[function(l,P,m){"use strict";cc._RF.push(P,"87826w1lC1AkIP1lrV2av5Q","MGBasicHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../MGUtils/NetworkUtils"),s=function(){function r(o){this.mPlatformType=o}return r.prototype.networkRequest=function(o){d.default.request({platform:this.mPlatformType,url:o.url,data:o.data,header:o.header,method:o.method,dataType:o.dataType,token:o.token,checkAuthorization:o.checkAuthorization,success:function(e){o.complete&&o.complete(!0,e),o.success&&o.success(e)},fail:function(e,n){o.complete&&o.complete(!1,n),o.fail&&o.fail(e,n)}})},r.prototype.getChannelId=function(){return""},r}();m.default=s,cc._RF.pop()},{"../../../MGUtils/NetworkUtils":"NetworkUtils"}],MGCloudStorageEntrance:[function(l,P,m){"use strict";cc._RF.push(P,"23fe1aZJC1G4pLKorDECxYF","MGCloudStorageEntrance"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Adapter/CloudStorageHelperWX"),s=l("../Adapter/CloudStorageHelperQQ"),r=l("../Adapter/CloudStorageHelperFB"),o=l("../Adapter/CloudStorageHelperWeb"),e=l("../../../MGUtils/TypeDefinition"),n=l("../Adapter/CloudStorageHelperCM"),t=function(){function i(){this.mMGCloudStorageHelper=null}return i.prototype.init=function(a,u,c,p,h){switch(a){case e.PlatformType.PLATFORM_H5SDK:case e.PlatformType.PLATFORM_GAMEHALL:case e.PlatformType.PLATFORM_WECHAT:this.mMGCloudStorageHelper=new d.CloudStorageHelperWX(a,u,c,p,h);break;case e.PlatformType.PLATFORM_FACEBOOK:this.mMGCloudStorageHelper=new r.CloudStorageHelperFB(a,u,c,p,h);break;case e.PlatformType.PLATFORM_QQPLAY:this.mMGCloudStorageHelper=new s.CloudStorageHelperQQ(a,u,c,p,h);break;case e.PlatformType.PLATFORM_CMPLAY:this.mMGCloudStorageHelper=new n.CloudStorageHelperCM(a,u,c,p,h);break;default:this.mMGCloudStorageHelper=new o.CloudStorageHelperWeb(a,u,c,p,h)}},i.prototype.setStorage=function(a){this.mMGCloudStorageHelper?this.mMGCloudStorageHelper.setStorage(a):a.fail&&a.fail(-1)},i.prototype.getStorage=function(a){this.mMGCloudStorageHelper?this.mMGCloudStorageHelper.getStorage(a):a.fail&&a.fail(-1)},i.prototype.delStorage=function(a){this.mMGCloudStorageHelper?this.mMGCloudStorageHelper.delStorage(a):a.fail&&a.fail(-1)},i}();m.default=t,m.MGCloudStorage=new t,cc._RF.pop()},{"../../../MGUtils/TypeDefinition":"TypeDefinition","../Adapter/CloudStorageHelperCM":"CloudStorageHelperCM","../Adapter/CloudStorageHelperFB":"CloudStorageHelperFB","../Adapter/CloudStorageHelperQQ":"CloudStorageHelperQQ","../Adapter/CloudStorageHelperWX":"CloudStorageHelperWX","../Adapter/CloudStorageHelperWeb":"CloudStorageHelperWeb"}],MGCloudStorageHelper:[function(l,P,m){"use strict";cc._RF.push(P,"f7ea4t0nAlO44u5jxEySHRu","MGCloudStorageHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../MGUtils/NetworkUtils"),s=function(){function r(o,e,n,t,i){this.mPlatformType=o,this.mGameId=e,this.mToken=n,this.mPlayerId=t,this.mIsDebug=i}return r.prototype.isDebug=function(){return this.mIsDebug},r.prototype.setStorage=function(o){if(!this.mGameId||!this.mPlayerId||!this.mToken)return o.complete&&o.complete(!1),void(o.fail&&o.fail(-1));this.request({url:this.getUrlToSetStorage(),data:o.kvDatas,complete:o.complete,success:o.success,fail:o.fail})},r.prototype.getStorage=function(o){if(!this.mGameId||!this.mPlayerId||!this.mToken)return o.complete&&o.complete(!1,null),void(o.fail&&o.fail(-1));this.request({url:this.getUrlToGetStorage(),data:o.keys,complete:function(e,n){if(o.complete)if(e&&n)try{var t=JSON.parse(n);t&&t.result&&t.result.data&&o.complete(!0,t.result.data)}catch(i){o.complete(!1,n)}else o.complete(!1,n)},success:function(e){if(e)try{var n=JSON.parse(e);n&&n.result&&n.result.data&&o.success&&o.success(n.result.data)}catch(t){o.fail&&o.fail(-1)}else o.fail&&o.fail(-1)},fail:o.fail})},r.prototype.delStorage=function(o){if(!this.mGameId||!this.mPlayerId||!this.mToken)return o.complete&&o.complete(!1),void(o.fail&&o.fail(-1));this.request({url:this.getUrlToDetStorage(),data:o.keys,complete:o.complete,success:o.success,fail:o.fail})},r.prototype.request=function(o){var e=this.getBody(this.mPlayerId,this.mGameId,o.data),n=d.default.createAuthorization(e,this.mToken);d.default.request({platform:this.mPlatformType,url:o.url,data:e,header:{Authorization:n},method:d.default.METHOD_POST,dataType:"string",token:this.mToken,checkAuthorization:!0,success:function(t){o.complete&&o.complete(!0,t),o.success&&o.success(t)},fail:function(t,i){o.complete&&o.complete(!1,null),o.fail&&o.fail(t,i)}})},r.prototype.getBody=function(o,e,n){return{playerid:o,timestamp:new Date().getTime(),gameid:e,data:n}},r}();m.default=s,cc._RF.pop()},{"../../../MGUtils/NetworkUtils":"NetworkUtils"}],MGLog:[function(l,P,m){"use strict";cc._RF.push(P,"5941fdKY5NIabq0W+7QmPBo","MGLog"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.init=function(r){s.sIsDebug=r},s.isDebug=function(){return s.sIsDebug},s.formatDateTime=function(){var r=new Date,o=r.getHours().toString(),e=r.getMinutes().toString(),n=r.getSeconds().toString(),t=r.getMilliseconds().toString();if(e.length<2&&(e="0"+e),n.length<2&&(n="0"+n),t.length<3)for(var i=0;i<3-t.length;i++)t="0"+t;return o+":"+e+":"+n+" "+t},s.getPrefix=function(){return this.formatDateTime()+"  =>  "},s.l=function(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];s.isDebug()&&console.log(this.getPrefix()+r+s.stringifyData(o))},s.w=function(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];console.warn(this.getPrefix()+r+s.stringifyData(o))},s.e=function(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];console.error(this.getPrefix()+r+s.stringifyData(o))},s.i=function(r){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];s.isDebug()&&console.info(this.getPrefix()+r+s.stringifyData(o))},s.stringifyData=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return r&&r.length,JSON.stringify(r)},s.sIsDebug=!1,s}();m.default=d,cc._RF.pop()},{}],MGPlatform:[function(l,P,m){"use strict";cc._RF.push(P,"5ba21cWkPpLRbjl4KHWO+Z6","MGPlatform"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./SystemInfo"),s=l("../../scripts/util/SUtil"),r=function(){function o(){}return o.getSystemInfoSync=function(){return cc.sys.platform==cc.sys.WECHAT_GAME?wx.getSystemInfoSync():cc.sys.platform==cc.sys.QQ_PLAY?o.getSystemInfoQQ():o.getSystemInfoCM()},o.getSystemInfoCM=function(){var e=new d.SystemInfo;return e.brand="",e.model="",e.pixelRatio=0,e.version="",e.system="",e.SDKVersion="",e.screenWidth=s.SUtil.ins().mScreenWidth,e.screenHeight=s.SUtil.ins().mScreenHeight,e.language="",e.platform=cc.sys.platform+"",e.fontSizeSetting=0,e},o.getSystemInfoQQ=function(){var e=new d.SystemInfo;return e.brand="",e.model="",e.pixelRatio=0,e.version=GameStatusInfo.QQVer,e.system=GameStatusInfo.platform+" "+GameStatusInfo.osVersion,e.SDKVersion="",e.screenWidth=BK.Director.screenPixelSize.width,e.screenHeight=BK.Director.screenPixelSize.height,e.language="",e.platform=GameStatusInfo.platform,e.fontSizeSetting=0,e},o}();m.MGPlatform=r,cc._RF.pop()},{"../../scripts/util/SUtil":"SUtil","./SystemInfo":"SystemInfo"}],MGSha1:[function(l,P,m){"use strict";cc._RF.push(P,"08e1e2nRUtKAIflALh5znlG","MGSha1"),Object.defineProperty(m,"__esModule",{value:!0});var d=0,s="";function r(_){return n(o(a(_)))}function o(_){return c(p(u(_),8*_.length))}function e(_,y){var S=u(_);16<S.length&&(S=p(S,8*_.length));for(var I=Array(16),v=Array(16),C=0;C<16;C++)I[C]=909522486^S[C],v[C]=1549556828^S[C];var T=p(I.concat(u(y)),512+8*y.length);return c(p(v.concat(T),672))}function n(_){for(var y,S=d?"0123456789ABCDEF":"0123456789abcdef",I="",v=0;v<_.length;v++)y=_.charCodeAt(v),I+=S.charAt(y>>>4&15)+S.charAt(15&y);return I}function t(_){for(var y="",S=_.length,I=0;I<S;I+=3)for(var v=_.charCodeAt(I)<<16|(I+1<S?_.charCodeAt(I+1)<<8:0)|(I+2<S?_.charCodeAt(I+2):0),C=0;C<4;C++)8*I+6*C>8*_.length?y+=s:y+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(v>>>6*(3-C)&63);return y}function i(_,y){var S,I,v,C,T=y.length,E=Array(),A=Array(Math.ceil(_.length/2));for(S=0;S<A.length;S++)A[S]=_.charCodeAt(2*S)<<8|_.charCodeAt(2*S+1);for(;0<A.length;){for(C=Array(),S=v=0;S<A.length;S++)v=(v<<16)+A[S],v-=(I=Math.floor(v/T))*T,(0<C.length||0<I)&&(C[C.length]=I);E[E.length]=v,A=C}var M="";for(S=E.length-1;0<=S;S--)M+=y.charAt(E[S]);var k=Math.ceil(8*_.length/(Math.log(y.length)/Math.log(2)));for(S=M.length;S<k;S++)M=y[0]+M;return M}function a(_){for(var y,S,I="",v=-1;++v<_.length;)y=_.charCodeAt(v),S=v+1<_.length?_.charCodeAt(v+1):0,55296<=y&&y<=56319&&56320<=S&&S<=57343&&(y=65536+((1023&y)<<10)+(1023&S),v++),y<=127?I+=String.fromCharCode(y):y<=2047?I+=String.fromCharCode(192|y>>>6&31,128|63&y):y<=65535?I+=String.fromCharCode(224|y>>>12&15,128|y>>>6&63,128|63&y):y<=2097151&&(I+=String.fromCharCode(240|y>>>18&7,128|y>>>12&63,128|y>>>6&63,128|63&y));return I}function u(_){for(var y=Array(_.length>>2),S=0;S<y.length;S++)y[S]=0;for(S=0;S<8*_.length;S+=8)y[S>>5]|=(255&_.charCodeAt(S/8))<<24-S%32;return y}function c(_){for(var y="",S=0;S<32*_.length;S+=8)y+=String.fromCharCode(_[S>>5]>>>24-S%32&255);return y}function p(_,y){_[y>>5]|=128<<24-y%32,_[15+(y+64>>9<<4)]=y;for(var S,I=Array(80),v=1732584193,C=-271733879,T=-1732584194,E=271733878,A=-1009589776,M=0;M<_.length;M+=16){for(var k=v,D=C,L=T,b=E,N=A,H=0;H<80;H++){I[H]=H<16?_[M+H]:g(I[H-3]^I[H-8]^I[H-14]^I[H-16],1);var R=f(f(g(v,5),h(H,C,T,E)),f(f(A,I[H]),(S=H)<20?1518500249:S<40?1859775393:S<60?-1894007588:-899497514));A=E,E=T,T=g(C,30),C=v,v=R}v=f(v,k),C=f(C,D),T=f(T,L),E=f(E,b),A=f(A,N)}return Array(v,C,T,E,A)}function h(_,y,S,I){return _<20?y&S|~y&I:_<40?y^S^I:_<60?y&S|y&I|S&I:y^S^I}function f(_,y){var S=(65535&_)+(65535&y);return(_>>16)+(y>>16)+(S>>16)<<16|65535&S}function g(_,y){return _<<y|_>>>32-y}m.hex_sha1=r,m.b64_sha1=function(_){return t(o(a(_)))},m.any_sha1=function(_,y){return i(o(a(_)),y)},m.hex_hmac_sha1=function(_,y){return n(e(a(_),a(y)))},m.b64_hmac_sha1=function(_,y){return t(e(a(_),a(y)))},m.any_hmac_sha1=function(_,y,S){return i(e(a(_),a(y)),S)},cc._RF.pop()},{}],MGShareUtil:[function(l,P,m){"use strict";cc._RF.push(P,"6adacTtQnND0KYTss1Yc3gg","MGShareUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ShareHelper"),s=l("./MGAppShare"),r=l("../../../scripts/infoc/m_p2_share"),o=l("../../../scripts/util/PU"),e=l("../../../scripts/business/Network/Protocol/StorageUtil"),n=l("../../../scripts/config/LSKey"),t=l("../../../scripts/util/StringUtil"),i=l("../../MGUser/scripts/Logic/MGUserEntrance"),a=l("./ShareImageUtils"),u=l("../../../scripts/social/SocialHelper"),c=l("./ShareImage"),p=l("../../../scripts/business/Logic/SkinDataManager"),h=l("../../MGUtils/MGLog"),f=l("../../../scripts/base/Log"),g=function(){function _(){}return _.initShare=function(){o.default.isWeiXin()&&(h.default.i("initShare ="),d.ShareHelper.getDefaultShareData(function(y,S,I){r.default.reportForMultiPlatform(r.default.ACTION_LAUNCH_SHARE,r.default.SOURCE_INIT,y),u.SocialHelper.initShare(S,I,"source="+d.ShareHelper.SHARE_SOURCE_INIT+"&card_type="+y,u.SocialHelper.SHARE_TYPE_SHARE,function(v){v?r.default.reportForMultiPlatform(r.default.ACTION_SHARE_SUCCESS,r.default.SOURCE_INIT,y):r.default.reportForMultiPlatform(r.default.ACTION_SHARE_FAIL,r.default.SOURCE_INIT,y)})}))},_.shareForReliveFdHelp=function(y,S){if(o.default.isWeiXin()||o.default.isQQ()){var I=r.default.CARD_TYPE_EIGHT_ONE;o.default.isWeiXin()?d.ShareHelper.SHARE_TITLE_WX_RELIVE:d.ShareHelper.SHARE_TITLE_QQ_RELIVE,d.ShareHelper.SHARE_SOURCE_RELIVE,u.SocialHelper.SHARE_TYPE_SHARE}},_.shareForGiftReward=function(y,S,I){if(o.default.isWeiXin()){var v=r.default.CARD_TYPE_SIX_ONE,C=r.default.SOURCE_INVITE_FRIEND;S==1&&(C=r.default.SOURCE_SHARE_GIFT_POPUP_INVITE);var T={title:d.ShareHelper.SHARE_TITLEB_WX_SHARE_FOR_GIFT,query:"source="+d.ShareHelper.SHARE_SOURCE_INVITE_FRIEND+"&inviterId="+y+"&card_type="+v,imgUrl:"",type:u.SocialHelper.SHARE_TYPE_SHARE},E=function(A){I(A.result),A.result?r.default.reportForMultiPlatform(r.default.ACTION_SHARE_SUCCESS,r.default.SOURCE_RELIVE,0):r.default.reportForMultiPlatform(r.default.ACTION_SHARE_FAIL,r.default.SOURCE_RELIVE,0)};new a.default().getShareImage(c.ShareImage.TYPE_SHARE_FOR_REWARD_B,function(A,M){A&&(T.imgUrl=M,s.default.share(T,E),r.default.reportForMultiPlatform(r.default.ACTION_LAUNCH_SHARE,C,v),e.default.save(n.default.SHARE_FOR_GIFT_SHARED,"true"))})}else o.default.isQQ()},_.shareForInviteSkin=function(y,S,I,v,C,T){if(h.default.i("MgShareUtils shareForInviteSkin inviterId = "+y),o.default.isCM()){var E={title:S,query:(f.default.isDebug()?this.inviteUrlDebug:this.inviteUrlRelease)+"?scene_id="+S+"&prop_name="+encodeURIComponent(C)+"&friend_num="+T,imgUrl:"",type:v};s.default.share(E,function(A){A.result&&f.default.i("CMPlayShare: MGShareUtil===>share succeed!")})}},_.shareForInviteSong=function(y,S,I,v,C,T){if(o.default.isCM()){var E={title:S,query:(f.default.isDebug()?this.inviteUrlDebug:this.inviteUrlRelease)+"?scene_id="+S+"&prop_name="+encodeURIComponent(v)+"&friend_num=1",imgUrl:"",type:"1"};s.default.share(E,function(A){A.result})}},_.shareForChallengeInvite=function(y,S,I){if(o.default.isWeiXin()||o.default.isQQ()){var v=c.ShareImage.TYPE_SHARE_INVITE_CHALLENGE_TIMES;.5<Math.random()&&(v=c.ShareImage.TYPE_SHARE_INVITE_CHALLENGE_TIMES_B);var C=d.ShareHelper.SHARE_TITLE_CHALLENGE_TIMES.replace("musicName",t.StringUtil.getFixedlengthStr(S,14)),T=r.default.CARD_TYPE_NINE;v==c.ShareImage.TYPE_SHARE_INVITE_CHALLENGE_TIMES_B&&(C=d.ShareHelper.SHARE_TITLE_CHALLENGE_TIMES_B,T=r.default.CARD_TYPE_NINE_ONE);var E={title:C,query:"source="+d.ShareHelper.SHARE_SOURCE_INVITE_CHALLENGE_TIMES+"&inviterId="+y+"&card_type="+T,imgUrl:"",type:u.SocialHelper.SHARE_TYPE_SHARE},A=function(M){I&&I(M.result),M.result?r.default.reportForMultiPlatform(r.default.ACTION_SHARE_SUCCESS,r.default.SOURCE_SHARE_CHALLENGE_INVITE_GAIN_TIMES,0):r.default.reportForMultiPlatform(r.default.ACTION_SHARE_FAIL,r.default.SOURCE_SHARE_CHALLENGE_INVITE_GAIN_TIMES,0)};o.default.isWeiXin()?new a.default().getShareImage(v,function(M,k){M&&(E.imgUrl=k,s.default.share(E,A),r.default.reportForMultiPlatform(r.default.ACTION_LAUNCH_SHARE,r.default.SOURCE_SHARE_CHALLENGE_INVITE_GAIN_TIMES,0))}):o.default.isQQ()}},_.shareChallengeShowOff=function(y,S,I,v){if(o.default.isWeiXin()||o.default.isQQ()){var C="";if(I<=10)C="\u6211\u5728\u4E16\u754C\u64C2\u53F0\u8D5B\u4E2D\u6392\u7B2C"+I+"\u540D,\u4F60\u80FD\u8D85\u8FC7\u6211\u5417?";else if(I<=999999)if(v==null||v==null)C="\u6211\u5728\u4E16\u754C\u64C2\u53F0\u8D5B\u4E2D\u6392\u7B2C"+I+"\u540D,\u4F60\u80FD\u8D85\u8FC7\u6211\u5417?";else{var T=v;C=(T=v<=5?5:10*Math.ceil(v/10))<=90?"\u6211\u5728\u4E16\u754C\u64C2\u53F0\u8D5B\u4E2D\u6392\u7B2C"+I+"\u540D(\u524D"+T+"%),\u4F60\u80FD\u8D85\u8FC7\u6211\u5417?":"\u6211\u5728\u4E16\u754C\u64C2\u53F0\u8D5B\u4E2D\u6392\u7B2C"+I+"\u540D,\u4F60\u80FD\u8D85\u8FC7\u6211\u5417?"}else{var E=10*Math.floor(I/1e5);v==null||v==null?C="\u6211\u5728\u4E16\u754C\u64C2\u53F0\u8D5B\u4E2D\u6392"+E+"\u4E07+,\u4F60\u80FD\u8D85\u8FC7\u6211\u5417?":(T=v,C=(T=v<=5?5:10*Math.ceil(v/10))<=90?"\u6211\u5728\u4E16\u754C\u64C2\u53F0\u8D5B\u4E2D\u6392"+E+"\u4E07+(\u524D"+T+"%),\u4F60\u80FD\u8D85\u8FC7\u6211\u5417?":"\u6211\u5728\u4E16\u754C\u64C2\u53F0\u8D5B\u4E2D\u6392"+E+"\u4E07+,\u4F60\u80FD\u8D85\u8FC7\u6211\u5417?")}var A={title:C,query:"source="+d.ShareHelper.SHARE_SOURCE_CHALLENGE_SHOW_OFF,imgUrl:"",type:u.SocialHelper.SHARE_TYPE_SHARE},M=function(D){D.result?r.default.reportForMultiPlatform(r.default.ACTION_SHARE_SUCCESS,r.default.SOURCE_SHARE_CHALLENGE_RESULT_SHOW_OFF,0):r.default.reportForMultiPlatform(r.default.ACTION_SHARE_FAIL,r.default.SOURCE_SHARE_CHALLENGE_RESULT_SHOW_OFF,0)};if(o.default.isWeiXin()){var k=new a.default;k.setChallengeShowOff(y,S,I),k.getShareImage(c.ShareImage.TYPE_SHARE_CHALLENGE_SHOW_OFF,function(D,L){D&&(A.imgUrl=L,s.default.share(A,M),r.default.reportForMultiPlatform(r.default.ACTION_LAUNCH_SHARE,r.default.SOURCE_SHARE_CHALLENGE_RESULT_SHOW_OFF,0))})}else o.default.isQQ()}},_.shareForSKinPiece=function(y,S,I,v){h.default.l("[MGShare] shareForSKinPiece  ....... skinId = "+v);var C={title:d.ShareHelper.SHATR_TITLE_SKIN_PIECE,query:"source="+d.ShareHelper.SHARE_SOURCE_SKIN_PIECE+"&nickName="+y+"&inviterId="+S+"&activityId="+I+"&skinId="+v,imgUrl:"",type:u.SocialHelper.SHARE_TYPE_SHARE},T=function(E){E.result?r.default.reportForMultiPlatform(r.default.ACTION_SHARE_SUCCESS,r.default.SOURCE_SHARE_SKIN_PIECE,0):r.default.reportForMultiPlatform(r.default.ACTION_SHARE_FAIL,r.default.SOURCE_SHARE_SKIN_PIECE,0)};o.default.isWeiXin()?new a.default().getShareImage(c.ShareImage.TYPE_SHARE_SKIN_PIECE,function(E,A){E&&(C.imgUrl=A,s.default.share(C,T),r.default.reportForMultiPlatform(r.default.ACTION_LAUNCH_SHARE,r.default.SOURCE_SHARE_SKIN_PIECE,0))},{skinName:p.SkinDataMgr.Ins().getSkinItemInfoBySkinId(v).name}):o.default.isQQ()},_.shareForUnlockTone=function(y,S){i.MGUser.getUserLoginInfo({complete:function(I){i.MGUser.getUserBasicInfo({complete:function(v){if(o.default.isWeiXin()||o.default.isQQ()){var C={title:d.ShareHelper.SHARE_TITLE_FOR_TONE,query:"source="+d.ShareHelper.SHARE_SOURCE_TONE+"&inviterId="+I.playerId+"&activityId="+y+"&nickName="+(v?v.nickName:"--"),imgUrl:"",type:u.SocialHelper.SHARE_TYPE_SHARE},T=function(E){S&&S(E.result),E.result?r.default.reportForMultiPlatform(r.default.ACTION_SHARE_SUCCESS,r.default.SOURCE_SHARE_TONE,0):r.default.reportForMultiPlatform(r.default.ACTION_SHARE_FAIL,r.default.SOURCE_SHARE_TONE,0)};o.default.isWeiXin()?new a.default().getShareImage(c.ShareImage.TYPE_SHARE_TONE,function(E,A){E&&(C.imgUrl=A,s.default.share(C,T),r.default.reportForMultiPlatform(r.default.ACTION_LAUNCH_SHARE,r.default.SOURCE_SHARE_TONE,0))}):o.default.isQQ()}}})}})},_.inviteUrlDebug="http://gmmall.liebao.cn/share/funny_game_piano_landing",_.inviteUrlRelease="https://gmmall.liebao.cn/share/funny_game_piano_landing",_.QQ_SHARE_TYPE_SINGLE_CHAMP=1,_.QQ_SHARE_TYPE_SHOW_OFF=2,_.QQ_SHARE_TYPE_NEW_RECORD=3,_}();m.MGShareUtils=g,cc._RF.pop()},{"../../../scripts/base/Log":"Log","../../../scripts/business/Logic/SkinDataManager":"SkinDataManager","../../../scripts/business/Network/Protocol/StorageUtil":"StorageUtil","../../../scripts/config/LSKey":"LSKey","../../../scripts/infoc/m_p2_share":"m_p2_share","../../../scripts/social/SocialHelper":"SocialHelper","../../../scripts/util/PU":"PU","../../../scripts/util/StringUtil":"StringUtil","../../MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../MGUtils/MGLog":"MGLog","./MGAppShare":"MGAppShare","./ShareHelper":"ShareHelper","./ShareImage":"ShareImage","./ShareImageUtils":"ShareImageUtils"}],MGUserEntrance:[function(l,P,m){"use strict";cc._RF.push(P,"4f2f3y4skBGk63+zTjf1saq","MGUserEntrance"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../MGUtils/TypeDefinition"),s=l("../Adapter/UserHelperWX"),r=l("../Adapter/UserHelperH5SDK"),o=l("../Adapter/UserHelperGameHall"),e=l("../Adapter/UserHelperQQ"),n=l("../Adapter/UserHelperFB"),t=l("../Adapter/UserHelperWeb"),i=l("../Adapter/UserHelperCM"),a=function(){function u(){}return u.prototype.init=function(c,p,h,f,g){switch(c){case d.PlatformType.PLATFORM_H5SDK:this.mMGUserHelper=new r.default(c,p,h,f,g);break;case d.PlatformType.PLATFORM_GAMEHALL:this.mMGUserHelper=new o.default(c,p,h,f,g);break;case d.PlatformType.PLATFORM_WECHAT:this.mMGUserHelper=new s.default(c,p,h,f,g);break;case d.PlatformType.PLATFORM_FACEBOOK:this.mMGUserHelper=new n.default(c,p,h,f,g);break;case d.PlatformType.PLATFORM_QQPLAY:this.mMGUserHelper=new e.default(c,p,h,f,g);break;case d.PlatformType.PLATFORM_CMPLAY:this.mMGUserHelper=new i.default(c,p,h,f,g);break;default:this.mMGUserHelper=new t.default(c,p,h,f,g)}},u.prototype.getUserLoginInfo=function(c){if(CMPlay.isCMPlay())return this.mMGUserHelper?void this.mMGUserHelper.getUserLoginInfo(c):(c&&c.complete&&c.complete(null),void(c&&c.fail&&c.fail()));c.fail&&c.fail()},u.prototype.getUserBasicInfo=function(c){if(!this.mMGUserHelper)return c&&c.complete&&c.complete(null),void(c&&c.fail&&c.fail());this.mMGUserHelper.getUserBasicInfo(c)},u.prototype.uploadUserLevelInfo=function(c){if(!this.mMGUserHelper)return c&&c.complete&&c.complete(!1),void(c&&c.fail&&c.fail(-1));this.mMGUserHelper.uploadUserLevelInfo(c)},u.prototype.uploadUserInfo=function(c){if(!this.mMGUserHelper)return c&&c.complete&&c.complete(!1),void(c&&c.fail&&c.fail(-1));this.mMGUserHelper.uploadUserInfo(c)},u.prototype.uploadUserInfoEx=function(c){if(!this.mMGUserHelper)return c&&c.complete&&c.complete(!1),void(c&&c.fail&&c.fail(-1));this.mMGUserHelper.uploadUserInfoEx(c)},u.prototype.switchUseLocalTime=function(c){this.mMGUserHelper&&this.mMGUserHelper.switchUseLocalTime(c)},u.prototype.getCurrentServerTime=function(){return this.mMGUserHelper?this.mMGUserHelper.getCurrentServerTime():0},u.prototype.getCurrentServerRealTime=function(c){if(!this.mMGUserHelper)return c&&c.complete&&c.complete(!1,0),void(c&&c.fail&&c.fail(-1));this.mMGUserHelper.getCurrentServerRealTime(c)},u}();m.default=a,m.MGUser=new a,cc._RF.pop()},{"../../../MGUtils/TypeDefinition":"TypeDefinition","../Adapter/UserHelperCM":"UserHelperCM","../Adapter/UserHelperFB":"UserHelperFB","../Adapter/UserHelperGameHall":"UserHelperGameHall","../Adapter/UserHelperH5SDK":"UserHelperH5SDK","../Adapter/UserHelperQQ":"UserHelperQQ","../Adapter/UserHelperWX":"UserHelperWX","../Adapter/UserHelperWeb":"UserHelperWeb"}],MGUserHelper:[function(l,P,m){"use strict";cc._RF.push(P,"8b04fKnReFBMY3lsWj3zp8k","MGUserHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../MGUtils/TypeDefinition"),s=l("../../../MGUtils/NetworkUtils"),r=function(){function o(e,n,t,i,a){this.mTimeDifference=0,this.mIsLoadingBaseInfo=!1,this.mBaseInfoCallbackList=[],this.mIsLoadingLoginInfo=!1,this.mLoginInfoCallbackList=[],this.mPlatformType=e,this.mGameId=n,this.mAppId=t,this.mIsDebug=a}return o.prototype.getGameId=function(){return this.mGameId},o.prototype.getAppId=function(){return this.mAppId},o.prototype.getPlatformType=function(){return this.mPlatformType},o.prototype.getTimeDifference=function(){return this.mTimeDifference},o.prototype.setTimeDifference=function(e){this.mTimeDifference=e},o.prototype.isDebug=function(){return this.mIsDebug},o.prototype.getUserBasicInfo=function(e){var n=this;this.mUserInfo||(this.mUserInfo=new d.UserInfo),this.mUserInfo.userBasicInfo?o.baseInfoCallback(!0,this.mUserInfo.userBasicInfo,e):(this.mBaseInfoCallbackList.push(e),this.mIsLoadingBaseInfo||(this.mIsLoadingBaseInfo=!0,this.getUserBaseInfoInner({complete:function(t){},success:function(t){n.mUserInfo.userBasicInfo=t,n.mIsLoadingBaseInfo=!1,n.baseInfoInnerCallback(!0,n.mBaseInfoCallbackList)},fail:function(){n.mIsLoadingBaseInfo=!1,n.baseInfoInnerCallback(!1,n.mBaseInfoCallbackList)}})))},o.prototype.baseInfoInnerCallback=function(e,n){for(;n&&0<n.length;){var t=n.pop();o.baseInfoCallback(e,this.mUserInfo.userBasicInfo,t)}},o.prototype.getUserLoginInfo=function(e){var n=this;this.mUserInfo||(this.mUserInfo=new d.UserInfo),this.mUserInfo.userLoginInfo?o.loginInfoCallback(!0,this.mUserInfo.userLoginInfo,e):(this.mLoginInfoCallbackList.push(e),this.mIsLoadingLoginInfo||(this.mIsLoadingLoginInfo=!0,this.getUserLoginInfoInner({complete:function(t){},success:function(t){n.mUserInfo.userLoginInfo=t,n.mIsLoadingLoginInfo=!1,n.loginInfoInnerCallback(!0,n.mLoginInfoCallbackList)},fail:function(){n.mIsLoadingLoginInfo=!1,n.loginInfoInnerCallback(!1,n.mLoginInfoCallbackList)}})))},o.prototype.loginInfoInnerCallback=function(e,n){for(;n&&0<n.length;){var t=n.pop();o.loginInfoCallback(e,this.mUserInfo.userLoginInfo,t)}},o.prototype.uploadUserInfoEx=function(e){var n=this;this.getUserLoginInfo({success:function(t){if(!t)return e.complete&&e.complete(!1),void(e.fail&&e.fail(-1));var i={nickname:e.userBasicInfo.nickName,avatar_url:e.userBasicInfo.avatarUrl,gender:e.userBasicInfo.gender,city:e.userBasicInfo.city,province:e.userBasicInfo.province,country:e.userBasicInfo.country},a={playerid:t.playerId,timestamp:new Date().getTime(),gameid:n.getGameId(),data:i},u=s.default.createAuthorization(a,t.token);s.default.request({platform:n.getPlatformType(),url:n.getUrlToUploadUserInfo(),data:a,header:{Authorization:u},method:s.default.METHOD_POST,dataType:"string",token:t.token,checkAuthorization:!0,success:function(c){e.complete&&e.complete(!0),e.success&&e.success()},fail:function(c,p){e.complete&&e.complete(!1),e.fail&&e.fail(c)}})},fail:function(){e.complete&&e.complete(!1),e.fail&&e.fail(-1)}})},o.prototype.uploadUserLevelInfo=function(e){var n=this;this.getUserLoginInfo({success:function(t){if(!t)return e.complete&&e.complete(!1),void(e.fail&&e.fail(-1));var i={playerid:t.playerId,timestamp:new Date().getTime(),gameid:n.getGameId(),user_level:e.user_level},a=s.default.createAuthorization(i,t.token);s.default.request({platform:n.getPlatformType(),url:n.getUrlToUploadUserLevel(),data:i,header:{Authorization:a},method:s.default.METHOD_POST,dataType:"string",token:t.token,checkAuthorization:!0,success:function(u){e.complete&&e.complete(!0),e.success&&e.success()},fail:function(u,c){e.complete&&e.complete(!1),e.fail&&e.fail(u)}})},fail:function(){e.complete&&e.complete(!1),e.fail&&e.fail(-1)}})},o.prototype.uploadUserInfo=function(e){var n=this;this.getUserBasicInfo({success:function(t){n.uploadUserInfoEx({userBasicInfo:t,complete:e.complete,success:e.success,fail:e.fail})},fail:function(){e.complete&&e.complete(!1),e.fail&&e.fail(-1)}})},o.prototype.switchUseLocalTime=function(e){this.mUseLocalTime=e},o.prototype.getCurrentServerTime=function(){return this.mUseLocalTime?new Date().getTime():new Date().getTime()-this.getTimeDifference()},o.prototype.getCurrentServerRealTime=function(e){var n=this;if(this.mUseLocalTime||cc.sys.platform!=cc.sys.WECHAT_GAME&&cc.sys.platform!=cc.sys.QQ_PLAY){var t=new Date().getTime();return e.complete&&e.complete(!0,t),void(e.success&&e.success(t))}this.getUserLoginInfo({success:function(i){if(!i||!i.token||!i.playerId)return e.complete&&e.complete(!1,0),void(e.fail&&e.fail(-1));var a={playerid:i.playerId,timestamp:new Date().getTime(),gameid:n.getGameId()},u=s.default.createAuthorization(a,i.token);s.default.request({platform:n.getPlatformType(),url:n.getUrlToGetCurrentServerRealTime(),data:a,header:{Authorization:u},method:s.default.METHOD_POST,dataType:"string",token:i.token,checkAuthorization:!0,success:function(c){if(c){var p=JSON.parse(c);if(p&&p.timestamp)return e.complete&&e.complete(!0,1e3*p.timestamp),void(e.success&&e.success(1e3*p.timestamp))}e.complete&&e.complete(!1,0),e.fail&&e.fail(-1)},fail:function(c,p){e.complete&&e.complete(!1,0),e.fail&&e.fail(c)}})},fail:function(){e.complete&&e.complete(!1,0),e.fail&&e.fail(-1)}})},o.loginInfoCallback=function(e,n,t){e?(t.complete&&t.complete(n),t.success&&t.success(n)):(t.complete&&t.complete(null),t.fail&&t.fail())},o.baseInfoCallback=function(e,n,t){e?(t.complete&&t.complete(n),t.success&&t.success(n)):(t.complete&&t.complete(null),t.fail&&t.fail())},o}();m.default=r,cc._RF.pop()},{"../../../MGUtils/NetworkUtils":"NetworkUtils","../../../MGUtils/TypeDefinition":"TypeDefinition"}],MMoveBy:[function(l,P,m){"use strict";cc._RF.push(P,"2ac47Wrd+lFj7Xw29/BRLhM","MMoveBy"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n){var t=s.call(this,n)||this;return t.deltaX=0,t.deltaY=0,t.originX=0,t.originY=0,t.deltaX=o,t.deltaY=e,t}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.originX=0,this.originY=0},r.prototype.start=function(o){s.prototype.start.call(this,o);var e=this.target;if(e){var n=e.getRect();this.originX=n.x,this.originY=n.y}},r.prototype.update=function(o){var e=s.prototype.update.call(this,o),n=this.target;if(n){var t=this.percent();n.move(t*this.deltaX+this.originX,t*this.deltaY+this.originY)}return e},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MMoveTo:[function(l,P,m){"use strict";cc._RF.push(P,"161d73qTeFH0baySa5qnbp5","MMoveTo"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n){var t=s.call(this,0,0,n)||this;return t.destX=0,t.destY=0,t.destX=o,t.destY=e,t}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.deltaX=0,this.deltaY=0},r.prototype.start=function(o){s.prototype.start.call(this,o),this.target&&(this.deltaX=this.destX-this.originX,this.deltaY=this.destY-this.originY)},r}(l("./MMoveBy").default);m.default=d,cc._RF.pop()},{"./MMoveBy":"MMoveBy"}],MPropValue:[function(l,P,m){"use strict";cc._RF.push(P,"ab26719sTlF8L8TcoWWV6rh","MPropValue"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){var n=s.call(this,0)||this;return n.prop=null,n.value=null,n.executed=!1,n.prop=o,n.value=e,n}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.executed=!1},r.prototype.update=function(o){s.prototype.update.call(this,o);var e=this.target;return e&&(e[this.prop]=this.value),this.executed=!0},r.prototype.finish=function(){return this.executed},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MRandomChange:[function(l,P,m){"use strict";cc._RF.push(P,"7510cHa+OtFD5zAjFUS7EF+","MRandomChange"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MAction"),s=l("../../../util/Utility"),r=function(o){function e(n,t,i,a,u,c,p,h,f,g,_,y,S,I,v,C,T,E,A){var M=o.call(this,A)||this;return M.cycle=0,M.moveStepX=0,M.moveStepY=0,M.moveRegion=new s.Utility.Rect(0,0,0,0),M.directX=0,M.directY=0,M.randomMoveOnHitEdge=0,M.scaleMin=0,M.scaleMax=0,M.scaleOncePreCycle=!0,M.opacityMin=0,M.opacityMax=0,M.randomMoveOnFade=!1,M.opacityFollowScale=0,M.frameCount=0,M.frameSpeedMin=0,M.frameSpeedMax=0,M.bornRegion=new s.Utility.Rect(0,0,0,0),M.runTimes=0,M.vx=0,M.vy=0,M.opacitySpeed=0,M.scaleSpeed=0,M.frameSpeed=0,M.frameIndex=0,M.cycle=Math.max(1,n),M.runTimes=0,M.moveStepX=t,M.moveStepY=i,M.moveRegion.copy(a),M.directX=u,M.directY=c,M.scaleMin=p,M.scaleMax=h,M.scaleOncePreCycle=f,M.opacityMin=g,M.opacityMax=_,M.opacityFollowScale=y,M.frameCount=S,M.frameSpeedMin=I,M.frameSpeedMax=v,M.randomMoveOnHitEdge=C,M.randomMoveOnFade=T,M.bornRegion.copy(E),M}return __extends(e,o),e.prototype.ready=function(){o.prototype.ready.call(this),this.runTimes=this.cycle,this.vx=this.moveStepX,this.vy=this.moveStepY,this.opacitySpeed=0,this.scaleSpeed=0,this.frameSpeed=0,this.frameIndex=0},e.prototype.start=function(n){o.prototype.start.call(this,n)},e.prototype.update=function(n){var t=o.prototype.update.call(this,n);this.runTimes++,this.runTimes>=this.cycle&&this.newFrame();var i=this.target;if(i){var a=i.getRect();a.x+=this.vx,a.y+=this.vy;var u=0;a.x<=this.moveRegion.x?(a.x=this.moveRegion.x,u+=1):a.x>=this.moveRegion.xMax&&(a.x=this.moveRegion.xMax,u+=2),a.y<=this.moveRegion.y?(a.y=this.moveRegion.y,u+=4):a.y>=this.moveRegion.yMax&&(a.y=this.moveRegion.yMax,u+=8),u&this.randomMoveOnHitEdge&&this.randomMove();var c=i.getScale();if(this.scaleOncePreCycle||((c+=this.scaleSpeed)<this.scaleMin?c=this.scaleMin:c>this.scaleMax&&(c=this.scaleMax),i.setScale(c)),this.opacityFollowScale===0){var p=i.getOpacity();(p+=this.opacitySpeed)<=0?(p=0,this.randomMoveOnFade&&this.randomMove()):1<p&&(p=1),i.setOpacity(p)}else i.setOpacity(Math.min(c,1));0<this.frameCount&&(this.frameIndex+=this.frameSpeed,this.frameIndex>=this.frameCount+1&&(this.frameIndex-=this.frameCount),i.setFrame(Math.floor(this.frameIndex)))}return t},e.prototype.randomMove=function(){var n=this.target;if(n){var t=this.bornRegion.x,i=this.bornRegion.y;t+=Math.random()*this.bornRegion.width,i+=Math.random()*this.bornRegion.height,n.setPosition(t,i),n.setOpacity(this.opacityMin),this.opacitySpeed=Math.abs(this.opacitySpeed)}},e.prototype.newFrame=function(){if(this.runTimes=0,this.moveStepX<0?this.vx=-this.moveStepX:this.vx=(Math.random()-.5)*this.moveStepX,this.moveStepY<0?this.vy=-this.moveStepY:this.vy=(Math.random()-.5)*this.moveStepY,this.directX!=0&&(this.vx=this.vx*this.directX),this.directY!=0&&(this.vy=Math.abs(this.vy)*this.directY),this.opacitySpeed=(2*Math.random()-1)*(this.opacityMax-this.opacityMin)/this.cycle,this.scaleOncePreCycle){var n=this.scaleMin+(this.scaleMax-this.scaleMin)*Math.random(),t=this.target;t&&t.setScale(n)}else this.scaleSpeed=(2*Math.random()-1)*(this.scaleMax-this.scaleMin)/this.cycle;0<this.frameCount&&(this.frameSpeed=this.frameSpeedMin+(this.frameSpeedMax-this.frameSpeedMin)*Math.random())},e}(d.default);m.default=r,cc._RF.pop()},{"../../../util/Utility":"Utility","./MAction":"MAction"}],MRandomFade:[function(l,P,m){"use strict";cc._RF.push(P,"cd878ztGSNNZ59LFSh+cWLC","MRandomFade"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){var n=s.call(this,e)||this;return n.frames=0,n.cycle=0,n.opacityDelta=0,n.cycle=Math.max(1,o),n.frames=0,n}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.frames=this.cycle},r.prototype.start=function(o){s.prototype.start.call(this,o)},r.prototype.update=function(o){var e=s.prototype.update.call(this,o);this.frames++,this.frames>=this.cycle&&(this.frames=0,this.opacityDelta=(Math.random()-.5)*(1/this.cycle));var n=this.target;if(n){var t=n.getOpacity();(t+=this.opacityDelta)<=0?t=0:1<t&&(t=1),n.setOpacity(t)}return e},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MRandomMove:[function(l,P,m){"use strict";cc._RF.push(P,"bfa93MJuHRLHZvUOW1ZlLSD","MRandomMove"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MAction"),s=l("../../../util/Utility"),r=function(o){function e(n,t,i,a){var u=o.call(this,a)||this;return u.frames=0,u.cycle=0,u.moveStep=0,u.vx=0,u.vy=0,u.moveRegion=new s.Utility.Rect(0,0,0,0),u.cycle=n,u.moveStep=t,u.frames=0,u.moveRegion.copy(i),u}return __extends(e,o),e.prototype.ready=function(){o.prototype.ready.call(this),this.frames=this.cycle,this.vx=0,this.vy=0},e.prototype.start=function(n){o.prototype.start.call(this,n)},e.prototype.update=function(n){var t=o.prototype.update.call(this,n);this.frames++,this.frames>=this.cycle&&(this.frames=0,this.vx=(Math.random()-.5)*this.moveStep,this.vy=(Math.random()-.5)*this.moveStep);var i=this.target;if(i){var a=i.getRect();a.x+=this.vx,a.y+=this.vy,a.x<=this.moveRegion.x?a.x=this.moveRegion.x:a.x>=this.moveRegion.xMax&&(a.x=this.moveRegion.xMax),a.y<=this.moveRegion.y?a.y=this.moveRegion.y:a.y>=this.moveRegion.yMax&&(a.y=this.moveRegion.yMax)}return t},e}(d.default);m.default=r,cc._RF.pop()},{"../../../util/Utility":"Utility","./MAction":"MAction"}],MRandomScale:[function(l,P,m){"use strict";cc._RF.push(P,"ac6c4/zCuFDLYIdW1ccgLC1","MRandomScale"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n,t){var i=s.call(this,t)||this;return i.frames=0,i.cycle=0,i.scaleMin=0,i.scaleMax=0,i.cycle=Math.max(1,o),i.frames=0,i.scaleMin=e,i.scaleMax=n,i}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.frames=this.cycle},r.prototype.start=function(o){s.prototype.start.call(this,o)},r.prototype.update=function(o){var e=s.prototype.update.call(this,o);if(this.frames++,this.frames>=this.cycle){this.frames=0;var n=this.scaleMin+(this.scaleMax-this.scaleMin)*Math.random(),t=this.target;t&&t.setScale(n)}return e},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MResizeBy:[function(l,P,m){"use strict";cc._RF.push(P,"c400eNB0RNJpJdw5LwDMxaZ","MResizeBy"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n){var t=s.call(this,n)||this;return t.deltaWidth=0,t.deltaHeight=0,t.originWidth=0,t.originHeight=0,t.deltaWidth=o,t.deltaHeight=e,t}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.originWidth=0,this.originHeight=0},r.prototype.start=function(o){s.prototype.start.call(this,o);var e=this.target;if(e){var n=e.getRect();this.originWidth=n.width,this.originHeight=n.height}},r.prototype.update=function(o){var e=s.prototype.update.call(this,o),n=this.percent(),t=this.target;return t&&t.setContentSize(n*this.deltaWidth+this.originWidth,n*this.deltaHeight+this.originHeight),e},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MResizeTo:[function(l,P,m){"use strict";cc._RF.push(P,"88a52kSaiRGu7ksx4mZkW+u","MResizeTo"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n){var t=s.call(this,0,0,n)||this;return t.destWidth=0,t.destHeight=0,t.destWidth=o,t.destHeight=e,t}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.deltaWidth=0,this.deltaHeight=0},r.prototype.start=function(o){s.prototype.start.call(this,o),this.target&&(this.deltaWidth=this.destWidth-this.originWidth,this.deltaHeight=this.destHeight-this.originHeight)},r}(l("./MResizeBy").default);m.default=d,cc._RF.pop()},{"./MResizeBy":"MResizeBy"}],MScaleBy:[function(l,P,m){"use strict";cc._RF.push(P,"a23d9qn6sxCerGgUvFLk89Z","MScaleBy"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n){var t=s.call(this,n)||this;return t.originScaleX=0,t.originScaleY=0,t.deltaScaleX=0,t.deltaScaleY=0,t.deltaScaleX=o,t.deltaScaleY=e,t}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.originScaleX=0,this.originScaleY=0},r.prototype.start=function(o){s.prototype.start.call(this,o);var e=this.target;e&&(this.originScaleX=e.getScale(),this.originScaleY=this.originScaleX)},r.prototype.update=function(o){var e=s.prototype.update.call(this,o),n=this.target;if(n){var t=this.deltaScaleX*this.percent()+this.originScaleX;n.setScale(t)}return e},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MScaleTo:[function(l,P,m){"use strict";cc._RF.push(P,"a4e75+HD51Ier8IvEc1lF/3","MScaleTo"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n){var t=s.call(this,0,0,n)||this;return t.destScaleX=0,t.destScaleY=0,t.destScaleX=o,t.destScaleY=e,t}return __extends(r,s),r.prototype.ready=function(){s.prototype.ready.call(this),this.deltaScaleX=0,this.deltaScaleY=0},r.prototype.start=function(o){s.prototype.start.call(this,o),this.target&&(this.deltaScaleX=this.destScaleX-this.originScaleX,this.deltaScaleY=this.destScaleY-this.originScaleY)},r}(l("./MScaleBy").default);m.default=d,cc._RF.pop()},{"./MScaleBy":"MScaleBy"}],MScheduler:[function(l,P,m){"use strict";cc._RF.push(P,"9ffb6K4vMRKmpT2sMrHm7l6","MScheduler"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/ObjectPool"),s=function(){function o(){this.delay=0,this.times=0,this.interval=0,this.runDuration=0,this.runTimes=0,this.nextTimeMark=0,this.needPercent=!1,this.deleted=!1,this.cb=null}return o.prototype.reset=function(){this.delay=0,this.times=0,this.interval=0,this.runDuration=0,this.runTimes=0,this.nextTimeMark=0,this.cb=null,this.deleted=!1,this.needPercent=!1},o}(),r=function(){function o(){this.items=[],this.pool=new d.default(o.createItem)}return o.prototype.update=function(e){for(var n=0,t=this.items.length;n<t;++n)if(!(a=this.items[n]).deleted&&(a.runDuration+=e,a.runDuration>=a.nextTimeMark)){if(a.runTimes++,a.nextTimeMark+=a.interval,a.needPercent)if(a.times===0)a.cb(1);else{var i=a.runTimes/a.times;a.cb(i)}else a.cb();a.runTimes>=a.times&&(a.deleted=!0)}for(n=0,t=this.items.length;n<t;++n){var a;(a=this.items[n]).deleted&&(this.items.splice(n,1),a.reset(),this.pool.put(a),--n,--t)}},o.prototype.scheduleOnce=function(e,n){return this.scheduleLoop(e,0,1,n)},o.prototype.scheduleLoop=function(e,n,t,i,a){if(a===void 0&&(a=!1),t==0)return!1;var u=this.pool.get();return u.delay=i,u.interval=n,u.times=t,u.needPercent=a,u.nextTimeMark=i,u.cb=e,this.items.push(u),!0},o.prototype.unSchedule=function(e){for(var n=0,t=this.items.length;n<t;++n){var i=this.items[n];if(i.cb==e)return i.deleted=!0}return!1},o.prototype.unScheduleAll=function(){for(var e=0,n=this.items.length;e<n;++e)this.items[e].deleted=!0},o.createItem=function(){return new s},o.INFINITE=999999,o}();m.default=r,cc._RF.pop()},{"../../util/ObjectPool":"ObjectPool"}],MSelfDefine:[function(l,P,m){"use strict";cc._RF.push(P,"25e03Ad/zBBFYrda2H7fR37","MSelfDefine"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){var n=s.call(this,e)||this;return n.cb=null,n.cb=o,n}return __extends(r,s),r.prototype.update=function(o){var e=this.percent(),n=s.prototype.update.call(this,o),t=this.percent();return this.cb(t,t-e),n},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MSequence:[function(l,P,m){"use strict";cc._RF.push(P,"0223fZmRz9HU64HCaYX5t8F","MSequence"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];var n=s.call(this,0)||this;return n.subActions=[],n.current=0,n.addActions(o),n}return __extends(r,s),r.prototype.addActions=function(o){for(var e=0,n=o.length;e<n;++e)this.subActions.push(o[e]);this.duration=this.calcTotalDuration()},r.prototype.ready=function(){s.prototype.ready.call(this);for(var o=this.current=0,e=this.subActions.length;o<e;++o)this.subActions[o].ready()},r.prototype.start=function(o){s.prototype.start.call(this,o),this.current<this.subActions.length&&this.subActions[this.current].start(this.target)},r.prototype.update=function(o){var e=s.prototype.update.call(this,o);if(this.current<this.subActions.length){var n=this.subActions[this.current];if(n.update(o)){var t=n.getTime()-n.getDuration();n.last(!1),this.nextAction(t)}}return e},r.prototype.finish=function(){return this.current>=this.subActions.length},r.prototype.last=function(o){if(s.prototype.last.call(this,o),o)for(var e=0,n=this.subActions.length;e<n;++e)this.subActions[e].last(o)},r.prototype.calcTotalDuration=function(){for(var o=0,e=0,n=this.subActions.length;e<n;++e)o+=this.subActions[e].getDuration();return o},r.prototype.nextAction=function(o){if(o===void 0&&(o=0),this.current++,!(this.current>=this.subActions.length)){var e=this.subActions[this.current];if(e.start(this.target),e.update(o),e.finish()){var n=e.getTime()-e.getDuration();e.last(!1),this.nextAction(n)}}},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MSetProperty:[function(l,P,m){"use strict";cc._RF.push(P,"bd5e7TuoOFJDZC1Q02136Px","MSetProperty"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o){var e=s.call(this,function(){var n=e.target;for(var t in o){var i=o[t];n[t]!==void 0&&(n[t]=i)}})||this;return e}return __extends(r,s),r}(l("./MCallFunc").default);m.default=d,cc._RF.pop()},{"./MCallFunc":"MCallFunc"}],MSpawn:[function(l,P,m){"use strict";cc._RF.push(P,"50602Gwsn9By73C0FCy5o24","MSpawn"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];var n=s.call(this,0)||this;return n.subActions=[],n.addActions(o),n}return __extends(r,s),r.prototype.addActions=function(o){for(var e=0,n=o.length;e<n;++e)this.subActions.push(o[e]);this.duration=this.calcMaxDuration()},r.prototype.ready=function(){s.prototype.ready.call(this);for(var o=0,e=this.subActions.length;o<e;++o)this.subActions[o].ready()},r.prototype.start=function(o){s.prototype.start.call(this,o);for(var e=0,n=this.subActions.length;e<n;++e)this.subActions[e].start(o)},r.prototype.update=function(o){for(var e=s.prototype.update.call(this,o),n=0,t=this.subActions.length;n<t;++n){var i=this.subActions[n];i.finish()||i.update(o)&&i.last(!1)}return e},r.prototype.last=function(o){if(o===void 0&&(o=!1),s.prototype.last.call(this,o),o)for(var e=0,n=this.subActions.length;e<n;++e)this.subActions[e].last(o)},r.prototype.calcMaxDuration=function(){for(var o=0,e=0,n=this.subActions.length;e<n;++e){var t=this.subActions[e].getDuration();o<t&&(o=t)}return o},r}(l("./MAction").default);m.default=d,cc._RF.pop()},{"./MAction":"MAction"}],MUIBoard:[function(l,P,m){"use strict";cc._RF.push(P,"1ce5ezW31xDdq5n+g7RbRuA","MUIBoard"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUINode"),s=l("./MUIDefines"),r=l("../../util/Utility"),o=function(){function i(){}return i.prototype.initilize=function(a){},i.prototype.uninitilize=function(a){},i.prototype.begin=function(a){},i.prototype.commit=function(a){},i.prototype.beginRTT=function(a,u){},i.prototype.commitRTT=function(a){},i}(),e=function(){function i(){switch(this.rootNode=new d.default,this.renderParam=new s.MUI.RenderParam,this.width=0,this.height=0,s.MUI.global.renderType){case s.MUI.RenderType.CANVAS:this.implement=new t;break;case s.MUI.RenderType.WEBGL:this.implement=new n}}return i.prototype.setSize=function(a,u){this.width=a,this.height=u},i.prototype.getWidth=function(){return this.width},i.prototype.getHeight=function(){return this.height},i.prototype.initilize=function(a){this.implement.initilize(a)},i.prototype.uninitilize=function(a){this.implement.uninitilize(a),this.getRootNode().destroy()},i.prototype.render=function(a){this.implement.begin(a),this.renderParam.scale=this.rootNode.getScale(),this.rootNode.draw(a,this.renderParam),this.implement.commit(a)},i.prototype.renderToTexture=function(a,u){this.implement.beginRTT(a,u),this.renderParam.scale=this.rootNode.getScale(),this.rootNode.draw(a,this.renderParam),this.implement.commitRTT(a)},i.prototype.getRootNode=function(){return this.rootNode},i}();m.default=e;var n=function(i){function a(){var u=i.call(this)||this;return u.fragmentShaderSrc="",u.rttFramebuffer=null,u.rttRenderBuffer=null,u.oldFrameBuffer=null,u.oldShaderProgram=null,u.oldViewPort=new r.Utility.Rect(0,0,0,0),u}return __extends(a,i),a.prototype.initilize=function(u){},a.prototype.uninitilize=function(u){var c=u;this.rttFramebuffer&&(c.deleteFramebuffer(this.rttFramebuffer),this.rttFramebuffer=null),this.rttRenderBuffer&&(c.deleteRenderbuffer(this.rttRenderBuffer),this.rttRenderBuffer=null)},a.prototype.begin=function(u){var c=u;this.storeGLStatues(c),c.enable(c.BLEND),c.disable(c.DEPTH_TEST),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.clearColor(0,0,0,0),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),s.MUI.global.shaderObject!==null&&c.useProgram(s.MUI.global.shaderObject.shaderProgram)},a.prototype.commit=function(u){var c=u;cc.sys.platform===cc.sys.QQ_PLAY&&c.glCommit(),this.reStoreGLStatues(c)},a.prototype.beginRTT=function(u,c){var p=u,h=c;if(this.rttFramebuffer||this.createRTTFrameBuffer(p,h),this.storeRTTGLStatues(p),this.rttFramebuffer){p.enable(p.BLEND),p.disable(p.DEPTH_TEST),p.blendFunc(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA),p.bindFramebuffer(p.FRAMEBUFFER,this.rttFramebuffer);var f=s.MUI.global.rttViewPort;p.viewport(f[0],f[1],f[2],f[3]),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,h,0),p.clearColor(0,0,0,0),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),s.MUI.global.shaderObject!==null&&p.useProgram(s.MUI.global.shaderObject.shaderProgram)}},a.prototype.commitRTT=function(u){var c=u;cc.sys.platform===cc.sys.QQ_PLAY&&c.glCommit(),this.reStoreRTTGLStatues(c)},a.prototype.storeGLStatues=function(u){this.oldShaderProgram=u.getParameter(u.CURRENT_PROGRAM)},a.prototype.reStoreGLStatues=function(u){u.useProgram(this.oldShaderProgram)},a.prototype.storeRTTGLStatues=function(u){this.oldFrameBuffer=u.getParameter(u.FRAMEBUFFER_BINDING),this.oldShaderProgram=u.getParameter(u.CURRENT_PROGRAM)},a.prototype.reStoreRTTGLStatues=function(u){u.bindFramebuffer(u.FRAMEBUFFER,this.oldFrameBuffer),u.useProgram(this.oldShaderProgram),u.viewport(0,0,s.MUI.global.viewWidth,s.MUI.global.viewHeight)},a.prototype.createRTTFrameBuffer=function(u,c){if(this.rttFramebuffer=u.createFramebuffer(),this.rttFramebuffer!=null){this.rttRenderBuffer=u.createRenderbuffer();var p=u.getParameter(u.RENDERBUFFER_BINDING);u.bindRenderbuffer(u.RENDERBUFFER,this.rttRenderBuffer),u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_COMPONENT16,s.MUI.global.rttWidth,s.MUI.global.rttHeight),u.bindRenderbuffer(u.RENDERBUFFER,p),u.bindFramebuffer(u.FRAMEBUFFER,this.rttFramebuffer),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,this.rttRenderBuffer);var h=u.checkFramebufferStatus(u.FRAMEBUFFER);h!=u.FRAMEBUFFER_COMPLETE&&console.log("gl.checkFramebufferStatus e = "+h),u.bindFramebuffer(u.FRAMEBUFFER,null)}},a}(o);m.MUIBoardWebGLImpl=n;var t=function(i){function a(){return i.call(this)||this}return __extends(a,i),a.prototype.begin=function(u){u.clearRect(0,0,s.MUI.global.viewWidth,s.MUI.global.viewHeight)},a.prototype.commit=function(u){},a.prototype.beginRTT=function(u,c){u.clearRect(0,0,s.MUI.global.viewWidth,s.MUI.global.viewHeight)},a.prototype.commitRTT=function(u){},a}(o);m.MUIBoardCanvasImpl=t,cc._RF.pop()},{"../../util/Utility":"Utility","./MUIDefines":"MUIDefines","./MUINode":"MUINode"}],MUIButton:[function(l,P,m){"use strict";cc._RF.push(P,"cc2eeOUPulElYelwgHG0o7H","MUIButton"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n,t){t===void 0&&(t=null);var i=s.call(this)||this;return i.touched=!1,i.enabled=!0,i.normalImageItem=null,i.pressedImageItem=null,i.onTouchListener=null,i.touchHandler=null,i.imageData=o,i.setImageItem(e),i.normalImageItem=e,n&&(i.pressedImageItem=n),i}return __extends(r,s),r.prototype.setOnTouchListener=function(o){this.onTouchListener=o},r.prototype.setEnable=function(o){this.enabled=o},r.prototype.touchStart=function(o){if(!this.enabled||!this.visible)return!1;for(var e=!1,n=0,t=o.length;n<t;++n){var i=o[n];if(this.rect.contains(i.clientX,i.clientY)){e=!0;break}}return e&&(this.touched=!0,this.pressedImageItem&&(this.imageItem=this.pressedImageItem),this.onTouchListener&&this.onTouchListener()),e},r.prototype.touchEnd=function(){return!!this.touched&&(this.touched=!1,this.imageItem=this.normalImageItem,!0)},r.prototype.setTouchHandler=function(o){o&&(this.touchHandler=o)},r}(l("./MUISprite").default);m.default=d,cc._RF.pop()},{"./MUISprite":"MUISprite"}],MUIDefines:[function(l,P,m){"use strict";cc._RF.push(P,"437fbkI5AlDP5uUZbT1JRMP","MUIDefines"),Object.defineProperty(m,"__esModule",{value:!0}),function(d){var s,r;(r=s=d.RenderType||(d.RenderType={}))[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS";var o=function(){this.shaderProgram=null,this.vertexPositionAttribute=null,this.vertexTextureAttribute=null,this.texture0Uniform=null,this.opacityUniform=null,this.typeUniform=null,this.color0Uniform=null};d.ShaderObject=o;var e=function(){function i(){}return i.initilize=function(a,u,c,p){var h=i;if(a===d.RenderType.WEBGL){h.renderType=d.RenderType.WEBGL,h.ctx=u,h.viewWidth=Math.max(1,c),h.viewHeight=Math.max(1,p);var f=u;h.pickFitRTTSize(f),h.calcRttViewPort(),h.shaderObject=h.initShaderProgram(f,h.vertexShaderSrc,h.fragmentShaderSrc),console.log("rttWidth = "+h.rttWidth+" ,  rttHeight = "+h.rttHeight)}else h.renderType=d.RenderType.CANVAS,h.ctx=u,h.viewWidth=c,h.viewHeight=p,h.rttWidth=c,h.rttHeight=p,i.rttViewPort[0]=0,i.rttViewPort[1]=0,i.rttViewPort[2]=c,i.rttViewPort[3]=p},i.unInitilize=function(){var a=i;if(a.renderType===d.RenderType.WEBGL){var u=a.ctx;a.shaderObject&&a.shaderObject.shaderProgram&&(u.deleteProgram(a.shaderObject.shaderProgram),a.shaderObject=null)}},i.initShaderProgram=function(a,u,c){var p=new d.ShaderObject,h=this.loadShader(a,a.VERTEX_SHADER,u);if(h==null)return null;var f=this.loadShader(a,a.FRAGMENT_SHADER,c);if(f==null)return a.deleteShader(h),null;var g=a.createProgram();return a.attachShader(g,h),a.attachShader(g,f),a.linkProgram(g),a.getProgramParameter(g,a.LINK_STATUS)?(a.deleteShader(h),a.deleteShader(f),p.shaderProgram=g,p.vertexPositionAttribute=a.getAttribLocation(g,"pos"),a.enableVertexAttribArray(p.vertexPositionAttribute),p.vertexTextureAttribute=a.getAttribLocation(g,"aTexPos"),a.enableVertexAttribArray(p.vertexTextureAttribute),p.texture0Uniform=a.getUniformLocation(g,"texture0"),p.opacityUniform=a.getUniformLocation(g,"opacity"),p.typeUniform=a.getUniformLocation(g,"type"),p.color0Uniform=a.getUniformLocation(g,"color0"),p):(console.warn("gl.getProgramParameter error"),a.deleteShader(h),a.deleteShader(f),null)},i.loadShader=function(a,u,c){var p=a.createShader(u);return a.shaderSource(p,c),a.compileShader(p),a.getShaderParameter(p,a.COMPILE_STATUS)?p:(console.warn("gl.getShaderParameter error"),a.deleteShader(p),null)},i.pickFitRTTSize=function(a){var u=a.getParameter(a.MAX_TEXTURE_SIZE);u===0&&(u=512);var c=i;for(c.viewHeight>c.rttHeight&&(c.rttHeight=i.nextPot(Math.floor(c.viewHeight))),c.viewWidth>c.rttWidth&&(c.rttWidth=i.nextPot(Math.floor(c.viewWidth)));c.rttHeight>u;)c.rttHeight=c.rttHeight>>>1;for(;c.rttWidth>u;)c.rttWidth=c.rttWidth>>>1},i.calcRttViewPort=function(){i.rttViewPort[0]=0,i.rttViewPort[1]=0;var a=i.viewWidth/i.viewHeight,u=Math.min(i.rttHeight,i.viewHeight),c=u*a;i.rttWidth<u*a&&(u=(c=i.rttWidth)/a),i.rttViewPort[2]=c,i.rttViewPort[3]=u},i.nextPot=function(a){return a-=1,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,(a|=a>>16)+1},i.renderType=s.WEBGL,i.ctx=null,i.shaderObject=null,i.viewWidth=1,i.viewHeight=1,i.rttWidth=512,i.rttHeight=512,i.rttViewPort=[0,0,0,0],i.vertexShaderSrc="\n        attribute vec3 pos;\n        attribute vec2 aTexPos;\n\n        varying vec2 vTexPos;\n        void main() {\n            gl_Position = vec4(pos.x, pos.y, pos.z, 1.0);\n\n            vTexPos = aTexPos;\n        }\n        ",i.fragmentShaderSrc="\n        precision mediump float;\n        varying vec2 vTexPos;\n\n        uniform int type;\n        uniform float opacity;\n\n        uniform sampler2D texture0;\n        uniform vec4 color0;\n\n        void main() {\n            //gl_FragColor = vec4(vTexPos.s, vTexPos.t, vTexPos.s, 1.0);\n            if (type == 0) {\n                vec4 color = texture2D(texture0, vTexPos);\n                gl_FragColor = vec4(color.r, color.g, color.b,  color.a * opacity);\n            } else {\n                gl_FragColor = vec4(color0.r, color0.g, color0.b,  color0.a * opacity);\n            }\n            \n        }\n        ",i}();d.global=e;var n,t=function(){this.centerX=0,this.centerY=0,this.width=0,this.height=0,this.scale=1,this.opacity=1,this.rotation=0,this.dirty=!0};d.RenderParam=t,(n=d.ActionId||(d.ActionId={}))[n.None=0]="None",n[n.AdvanceAnimation=1]="AdvanceAnimation",n[n.Blink=2]="Blink",n[n.CallFunc=3]="CallFunc",n[n.ChildAction=4]="ChildAction",n[n.CircleMoveBy=5]="CircleMoveBy",n[n.CircleMoveTo=6]="CircleMoveTo",n[n.Delay=7]="Delay",n[n.FadeTo=8]="FadeTo",n[n.FrameSequence=9]="FrameSequence",n[n.MoveBy=10]="MoveBy",n[n.MoveTo=11]="MoveTo",n[n.PropValue=12]="PropValue",n[n.RandomChange=13]="RandomChange",n[n.RandomFade=14]="RandomFade",n[n.RandomMove=15]="RandomMove",n[n.RandomScale=16]="RandomScale",n[n.ResizeBy=17]="ResizeBy",n[n.ScaleBy=18]="ScaleBy",n[n.ScaleTo=19]="ScaleTo",n[n.SelfDefine=20]="SelfDefine",n[n.Sequence=21]="Sequence",n[n.Spawn=22]="Spawn",n[n.ResizeTo=23]="ResizeTo",n[n.SetProperty=24]="SetProperty"}(m.MUI||(m.MUI={})),cc._RF.pop()},{}],MUIDrawNode:[function(l,P,m){"use strict";cc._RF.push(P,"ab7e81tnm1M+IH4b56LGziQ","MUIDrawNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){e===void 0&&(e=null);var n=s.call(this,e)||this;return n.drawFunction=o,n}return __extends(r,s),r.prototype.draw=function(o,e){this.drawFunction(o,e),s.prototype.drawChildren.call(this,o,e)},r}(l("./MUINode").default);m.default=d,cc._RF.pop()},{"./MUINode":"MUINode"}],MUIFactory:[function(l,P,m){"use strict";cc._RF.push(P,"0355dcZ7ttDE7Gjj+8kKYOM","MUIFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUINode"),s=l("./MUISprite"),r=l("./MUINineScaleSprite"),o=function(){function e(){}return e.prototype.createNode=function(n){return n===void 0&&(n=null),new d.default(n)},e.prototype.createSpriteNode=function(n){return n===void 0&&(n=null),new s.default(n)},e.prototype.createNineScaleSpriteNode=function(n){return n===void 0&&(n=null),new r.default(n)},e.prototype.createParticularNode=function(n,t){return t===void 0&&(t=null),n==="MUISprite"?this.createSpriteNode(t):n==="MUINineScaleSprite"?this.createNineScaleSpriteNode(t):null},e.instance=new e,e}();m.default=o,cc._RF.pop()},{"./MUINineScaleSprite":"MUINineScaleSprite","./MUINode":"MUINode","./MUISprite":"MUISprite"}],MUILabel:[function(l,P,m){"use strict";cc._RF.push(P,"74fc1hu9AVDTJLdL728SF0d","MUILabel"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUINode"),s=l("./MUIDefines"),r=function(o){function e(){var n=o!==null&&o.apply(this,arguments)||this;return n.text=null,n.size=null,n.font=null,n.color=null,n.align=null,n.baseline=null,n}return __extends(e,o),e.prototype.draw=function(n,t){switch(s.MUI.global.renderType){case s.MUI.RenderType.WEBGL:break;case s.MUI.RenderType.CANVAS:if(this.text&&0<this.size){var i=n,a=i.fillStyle,u=i.globalAlpha;i.globalAlpha=t.opacity;var c=Math.floor(t.centerX),p=Math.floor(i.canvas.height-t.centerY);i.translate(c,p);var h=-(t.width>>>1),f=-(t.height>>>1);i.fillStyle=this.color||"#000000",i.textAlign=this.align||"center",i.textBaseline=this.baseline||"center";var g=this.font||"Arial";i.font=Math.round(this.size*t.scale)+"px "+g,i.fillText(this.text,h,f),i.translate(-c,-p),i.globalAlpha=u,i.fillStyle=a}}o.prototype.drawChildren.call(this,n,t)},e.prototype.reload=function(){s.MUI.global.renderType,s.MUI.RenderType.WEBGL},e}(d.default);m.default=r,cc._RF.pop()},{"./MUIDefines":"MUIDefines","./MUINode":"MUINode"}],MUILine:[function(l,P,m){"use strict";cc._RF.push(P,"0d240nEthJAXZTNI/iMIWAW","MUILine"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUINode"),s=l("./MUIDefines"),r=function(o){function e(n){n===void 0&&(n=null);var t=o.call(this,n)||this;return t.pts=[],t.color=new cc.Color(0,0,0,255),t.colorHex="#000000",t.dirty=!1,t.vertexBuffer=null,t}return __extends(e,o),e.prototype.draw=function(n,t){switch(s.MUI.global.renderType){case s.MUI.RenderType.WEBGL:var i=n;this.dirty&&(this.updateVertexBuffer(n),this.dirty=!1),s.MUI.global.shaderObject&&this.vertexBuffer&&(i.uniform1i(s.MUI.global.shaderObject.typeUniform,1),i.uniform1f(s.MUI.global.shaderObject.opacityUniform,t.opacity),i.uniform4f(s.MUI.global.shaderObject.color0Uniform,this.color.getR()/255,this.color.getG()/255,this.color.getB()/255,this.color.getA()/255),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.vertexAttribPointer(s.MUI.global.shaderObject.vertexPositionAttribute,3,i.FLOAT,!0,20,0),i.vertexAttribPointer(s.MUI.global.shaderObject.vertexTextureAttribute,2,i.FLOAT,!0,20,12),i.drawArrays(i.LINES,0,this.pts.length),i.bindBuffer(i.ARRAY_BUFFER,null));break;case s.MUI.RenderType.CANVAS:var a=n;a.lineWidth=1,a.strokeStyle=this.colorHex,a.beginPath();for(var u=0,c=this.pts.length;u+1<c;u+=2)a.moveTo(this.pts[u].x,this.pts[u].y),a.lineTo(this.pts[u+1].x,this.pts[u+1].y);a.closePath(),a.stroke()}o.prototype.drawChildren.call(this,n,t)},e.prototype.setColor=function(n){this.color=n.clone(),this.colorHex="#"+this.color.toHEX("#rrggbb")},e.prototype.setLine=function(n){for(var t=0,i=n.length;t<i;++t)this.pts.push(n[t]);this.dirty=!0},e.prototype.updateVertexBuffer=function(n){this.vertexBuffer||(this.vertexBuffer=n.createBuffer());for(var t=new Float32Array(5*this.pts.length),i=0,a=this.pts.length;i<a;++i){var u=this.pts[i],c=5*i;t[c++]=u.x/s.MUI.global.viewWidth*2-1,t[c++]=u.y/s.MUI.global.viewHeight*2-1,t[c++]=0,t[c++]=0,t[c++]=0}n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bufferData(n.ARRAY_BUFFER,t,n.STREAM_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null)},e}(d.default);m.default=r,cc._RF.pop()},{"./MUIDefines":"MUIDefines","./MUINode":"MUINode"}],MUINineScaleSprite:[function(l,P,m){"use strict";cc._RF.push(P,"9326dvHjUhK/b1zhXLBiUcc","MUINineScaleSprite"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUISprite"),s=l("./MUIDefines"),r=l("../atlas/CanvasFunction"),o=function(){function n(){this.sl=0,this.ss=0,this.l=0,this.s=0,this.minusL=!1,this.minusS=!1}return n.prototype.set=function(t,i,a,u,c,p){c===void 0&&(c=!1),p===void 0&&(p=!1),this.sl=t,this.ss=i,this.l=a,this.s=u,this.minusL=c,this.minusS=p},n}(),e=function(n){function t(i){i===void 0&&(i=null);var a=n.call(this,i)||this;return a.insetTop=0,a.insetBottom=0,a.insetLeft=0,a.insetRight=0,a.insetDirty=!0,a.xparams=[],a.yparams=[],a}return __extends(t,n),t.prototype.setInset=function(i,a,u,c){0<=a&&(this.insetTop=a),0<=c&&(this.insetBottom=c),0<=i&&(this.insetLeft=i),0<=u&&(this.insetRight=u),this.calcNineParam()},t.prototype.draw=function(i,a){var u=this.imageItem;if(0<this.frame&&(u=this.frameSequence.frames[this.frame-1]),u){if(s.MUI.global.renderType===s.MUI.RenderType.WEBGL){var c=i;if(this.updateVertex(i,a,u),this.updateVertexBuffer(i),a.dirty=!1,s.MUI.global.shaderObject){c.uniform1i(s.MUI.global.shaderObject.typeUniform,0),c.uniform1f(s.MUI.global.shaderObject.opacityUniform,a.opacity),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,this.imageData.texture),c.uniform1i(s.MUI.global.shaderObject.texture0Uniform,0),c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);var p=this.vertexArray.BYTES_PER_ELEMENT;c.vertexAttribPointer(s.MUI.global.shaderObject.vertexPositionAttribute,3,c.FLOAT,!0,5*p,0),c.vertexAttribPointer(s.MUI.global.shaderObject.vertexTextureAttribute,2,c.FLOAT,!0,5*p,3*p);for(var h=0;h<3;++h)if((v=this.xparams[h])!=null)for(var f=0;f<3;++f)(C=this.yparams[f])!=null&&c.drawArrays(c.TRIANGLE_STRIP,4*(3*h+f),4);c.bindBuffer(c.ARRAY_BUFFER,null)}}else{var g=i.globalAlpha;i.globalAlpha=a.opacity;var _=a.centerX,y=i.canvas.height-a.centerY;i.translate(_,y);var S=-a.width/2,I=-a.height/2;for(h=0;h<3;++h){var v;if((v=this.xparams[h])!=null)for(f=0;f<3;++f){var C;(C=this.yparams[f])!=null&&(a.scale!=1?r.CanvasFunction.drawPartImageItemScale(i,this.imageData,u,v.sl,C.sl,v.ss,C.ss,S+(v.minusL?a.width+v.l*a.scale:v.l*a.scale),I+(C.minusL?a.height+C.l*a.scale:C.l*a.scale),v.minusS?a.width+v.s*a.scale:v.s*a.scale,C.minusS?a.height+C.s*a.scale:C.s*a.scale):r.CanvasFunction.drawPartImageItemScale(i,this.imageData,u,v.sl,C.sl,v.ss,C.ss,S+(v.minusL?a.width+v.l:v.l),I+(C.minusL?a.height+C.l:C.l),v.minusS?a.width+v.s:v.s,C.minusS?a.height+C.s:C.s))}}i.translate(-_,-y),i.globalAlpha=g}n.prototype.drawChildren.call(this,i,a)}else n.prototype.drawChildren.call(this,i,a)},t.prototype.calcNineParam=function(){var i=this.imageItem;if(0<this.frame&&(i=this.frameSequence.frames[this.frame-1]),i!=null){this.xparams=[],this.yparams=[];for(var a=0;a<3;++a){if(a===0){if(this.insetLeft===0)continue;this.xparams[a]==null&&(this.xparams[a]=new o),this.xparams[a].set(0,this.insetLeft,0,this.insetLeft)}else if(a===1){var u=this.insetLeft+this.insetRight;if(u>=i.rect.width)continue;this.xparams[a]==null&&(this.xparams[a]=new o),this.xparams[a].set(this.insetLeft,i.rect.width-u,this.insetLeft,-u,!1,!0)}else{if(this.insetRight===0)continue;this.xparams[a]==null&&(this.xparams[a]=new o),this.xparams[a].set(i.rect.width-this.insetRight,this.insetRight,-this.insetRight,this.insetRight,!0,!1)}for(var c=0;c<3;++c)if(c===0){if(this.insetTop===0)continue;this.yparams[c]==null&&(this.yparams[c]=new o),this.yparams[c].set(0,this.insetTop,0,this.insetTop)}else if(c===1){var p=this.insetTop+this.insetBottom;if(p>=i.rect.height)continue;this.yparams[c]==null&&(this.yparams[c]=new o),this.yparams[c].set(this.insetTop,i.rect.height-p,this.insetTop,-p,!1,!0)}else{if(this.insetBottom===0)continue;this.yparams[c]==null&&(this.yparams[c]=new o),this.yparams[c].set(i.rect.height-this.insetBottom,this.insetBottom,-this.insetBottom,this.insetBottom,!0,!1)}}}else console.warn("MUINineScaleSprite.calcNineParam imageItem is null.")},t.prototype.updateVertex=function(i,a,u){var c=a.centerX-a.width/2,p=a.centerY-a.height/2;this.vertexArray||(this.vertexArray=new Float32Array(180));for(var h=this.vertexArray,f=0;f<3;++f){var g=this.xparams[f];if(g!=null)for(var _=0;_<3;++_){var y=this.yparams[_];if(y!=null){var S=20*(3*f+_),I=(y.minusS?a.height+y.s*a.scale:y.s*a.scale)/s.MUI.global.viewHeight*2,v=(c+(g.minusL?a.width+g.l*a.scale:g.l*a.scale))/s.MUI.global.viewWidth*2-1,C=-I+(p+a.height-(y.minusL?a.height+y.l*a.scale:y.l*a.scale))/s.MUI.global.viewHeight*2-1,T=v+(g.minusS?a.width+g.s*a.scale:g.s*a.scale)/s.MUI.global.viewWidth*2,E=C+I,A=(u.rect.x+g.sl)/this.imageData.image.width,M=(u.rect.y+y.sl)/this.imageData.image.height,k=A+g.ss/this.imageData.image.width,D=M+y.ss/this.imageData.image.height;h[S++]=v,h[S++]=E,h[S++]=0,h[S++]=A,h[S++]=M,h[S++]=v,h[S++]=C,h[S++]=0,h[S++]=A,h[S++]=D,h[S++]=T,h[S++]=E,h[S++]=0,h[S++]=k,h[S++]=M,h[S++]=T,h[S++]=C,h[S++]=0,h[S++]=k,h[S++]=D}}}},t}(d.default);m.default=e,cc._RF.pop()},{"../atlas/CanvasFunction":"CanvasFunction","./MUIDefines":"MUIDefines","./MUISprite":"MUISprite"}],MUINodePool:[function(l,P,m){"use strict";cc._RF.push(P,"e79adUwkXpIApGRJpARMApQ","MUINodePool"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r,o,e){this.rootNode=r,this.createFunc=o,this.updateFunc=e,this.nodeCaches=[]}return s.prototype.initPool=function(r){for(var o=0;o<r;++o){var e=this.createNode(null);e.setVisible(!1),this.put(e)}},s.prototype.get=function(r,o){if(o===void 0&&(o=!0),0<this.nodeCaches.length){var e=this.nodeCaches.pop();return e.setVisible(o),this.updateNode(e,r),e}var n=this.createNode(r);return n.setVisible(o),n},s.prototype.put=function(r){r&&(r.setVisible(!1),this.nodeCaches.push(r))},s.prototype.createNode=function(r){var o=this.createFunc(this.rootNode,this);return this.updateNode(r,o),o},s.prototype.updateNode=function(r,o){this.updateFunc(r,o)},s}();m.default=d,cc._RF.pop()},{}],MUINode:[function(l,P,m){"use strict";cc._RF.push(P,"00458yfV8tIj4c0p3IV0sly","MUINode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=l("./MUIDefines"),r=function(){function o(e){e===void 0&&(e=null),this.parent=null,this.tag=0,this.visible=!0,this.opacity=1,this.scale=1,this.frame=0,this.ratation=0,this.rect=new d.Utility.Rect(0,0,0,0),this.renderParam=new s.MUI.RenderParam,this.children=[],this.name=e,this.userData=null,this.onCreate()}return o.prototype.removeFromParent=function(){this.parent!=null&&this.parent.removeChild(this)},o.prototype.draw=function(e,n){this.drawChildren(e,n)},o.prototype.drawChildren=function(e,n){for(var t=0,i=this.children.length;t<i;++t){var a=this.children[t];if(a.visible){var u=a.renderParam;n.scale==1?(u.scale=a.scale,u.centerX=n.centerX-n.width/2+a.rect.xCenter,u.centerY=n.centerY-n.height/2+a.rect.yCenter,u.scale==1?(u.width=a.rect.width,u.height=a.rect.height):(u.width=a.rect.width*u.scale,u.height=a.rect.height*u.scale)):(u.scale=n.scale*a.scale,u.centerX=n.centerX-n.width/2+a.rect.xCenter*n.scale,u.centerY=n.centerY-n.height/2+a.rect.yCenter*n.scale,u.width=a.rect.width*u.scale,u.height=a.rect.height*u.scale),n.opacity==1?u.opacity=a.opacity:u.opacity=n.opacity*a.opacity,u.opacity!=0&&a.draw(e,u)}}},o.prototype.setUserData=function(e){this.userData=e},o.prototype.getUserData=function(){return this.userData},o.prototype.setTag=function(e){this.tag=e},o.prototype.getTag=function(){return this.tag},o.prototype.setName=function(e){this.name=e},o.prototype.getName=function(){return this.name},o.prototype.getPosition=function(){return new cc.Vec2(this.rect.x,this.rect.y)},o.prototype.setPositionX=function(e){this.rect.x=e,this.renderParam.dirty=!0},o.prototype.setPositionY=function(e){this.rect.y=e,this.renderParam.dirty=!0},o.prototype.setPosition=function(e,n){this.move(e,n)},o.prototype.setContentSize=function(e,n){this.rect.width=e,this.rect.height=n,this.renderParam.dirty=!0},o.prototype.getHeight=function(){return this.rect.height},o.prototype.getWidth=function(){return this.rect.width},o.prototype.addChild=function(e,n){return n===void 0&&(n=0),e.tag=n,(e.parent=this).children.push(e),this.children.length-1},o.prototype.insertChild=function(e,n,t){return t===void 0&&(t=0),n.tag=t,(n.parent=this).children.splice(e,0,n),this.children.length-1},o.prototype.removeChild=function(e){var n=this.getChildIndex(e);return this.removeChildByIndex(n)},o.prototype.removeChildByIndex=function(e){if(e<0||e>=this.children.length)return!1;this.children[e].parent=null,this.children.splice(e,1)},o.prototype.removeAllChildren=function(){this.children=[]},o.prototype.getChildByTag=function(e){for(var n=0,t=this.children.length;n<t;++n)if(this.children[n].tag==e)return this.children[n];return null},o.prototype.getChildByName=function(e){for(var n=0,t=this.children.length;n<t;++n)if(this.children[n].name===e)return this.children[n];return null},o.prototype.getChildByIndex=function(e){return this.children[e]},o.prototype.getChildIndex=function(e){for(var n=0,t=this.children.length;n<t;++n)if(e==this.children[n])return n;return-1},o.prototype.getAllChildren=function(){return this.children},o.prototype.setVisible=function(e){this.visible=e,this.renderParam.dirty=!0},o.prototype.getVisible=function(){return this.visible},o.prototype.move=function(e,n,t,i){t===void 0&&(t=null),i===void 0&&(i=null),t==null&&(t=this.rect.width),i==null&&(i=this.rect.height),this.rect.set(e,n,t,i),this.renderParam.dirty=!0},o.prototype.moveBy=function(e,n){this.rect.x+=e,this.rect.y+=n,this.renderParam.dirty=!0},o.prototype.getRect=function(){return this.rect},o.prototype.getScale=function(){return this.scale},o.prototype.setScale=function(e,n){n===void 0&&(n=1),this.scale=e,this.renderParam.dirty=!0},o.prototype.getOpacity=function(){return this.opacity},o.prototype.setOpacity=function(e){1<e?e=1:e<0&&(e=0),this.opacity=e,this.renderParam.dirty=!0},o.prototype.setRotation=function(e){this.ratation=e},o.prototype.getRotation=function(){return this.ratation},o.prototype.setFrame=function(e){this.frame=e},o.prototype.isAdded=function(){return this.parent!==null},o.prototype.destroy=function(){for(var e=0,n=this.children.length;e<n;++e)this.children[e].destroy();this.onDestroy()},o.prototype.onCreate=function(){},o.prototype.onDestroy=function(){},o}();m.default=r,cc._RF.pop()},{"../../util/Utility":"Utility","./MUIDefines":"MUIDefines"}],MUINumber:[function(l,P,m){"use strict";cc._RF.push(P,"2f839ACzBdNfo0/aHGxjF/t","MUINumber"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("../../MUI/MUINode"),r=l("../../MUI/MUISprite");(d=m.NumberColor||(m.NumberColor={})).WHITE="white",d.RED="red",d.BLUE="blue",d.YELLOW="yellow",d.LIGHTYELLOW="lightyellow",d.LIGHTBLUE="lightblue",d.YELLOWSMALL="yellowsmall",d.COMBO="combo",d.GO="go",d.GOSMALL="gosmall";var o=function(e){function n(t,i,a){a===void 0&&(a=null);var u=e.call(this,a)||this;return u.numberAtlas=null,u.numberColor=null,u.nodeWidthScale=1,u.preCreateNodeCount=2,u.showSign=!1,u.numberValue=1/0,u.centerNumber=n.HLEFT,u.lastShowCount=0,u.numberNodeWidth=0,u.numberNodeHeight=0,u.halfNumberNodeWidth=0,u.nodeWidthOffset=0,u.numberNodeList=null,u.spriteFrames=null,u.numberAtlas=t,u.preCreateNodeCount=i,u.onLoad(),u}return __extends(n,e),n.prototype.onLoad=function(){this.numberNodeList=[],this.preCreateNodeCount<=0&&(this.preCreateNodeCount=1);for(var t=0;t<this.preCreateNodeCount;t++)this.addNewNumberNode()},n.prototype.setNumberColor=function(t,i){i===void 0&&(i=1.18),this.numberColor!==t&&(this.numberColor=t,i&&this.setNodeWidthScale(i),this.initSpriteFrames())},n.prototype.setNodeWidthScale=function(t){if(this.numberColor&&!(t<1)&&this.nodeWidthScale!==t&&(this.nodeWidthScale=t,this.numberAtlas!=null)){var i=this.numberAtlas.getItem(this.numberColor+"_+").rect.width,a=i*t,u=(a-i)/2;this.resetNumberNodeWidth(a,u)}},n.prototype.setNumberValue=function(t){this.numberValue!==t&&(this.numberValue=t,this.update())},n.prototype.setCenterNumber=function(t,i){i===void 0&&(i=!1);var a=t?n.HCENTER:n.HLEFT;this.centerNumber!==a&&(this.centerNumber=a,i&&this.update())},n.prototype.setHAlineType=function(t,i){i===void 0&&(i=!1),this.centerNumber!==t&&(this.centerNumber=t,i&&this.update())},n.prototype.setShowSign=function(t,i){i===void 0&&(i=!1),this.showSign!==t&&(this.showSign=t,i&&this.update())},n.prototype.setNumberSize=function(t,i){this.numberNodeWidth=t,this.numberNodeHeight=i,this.halfNumberNodeWidth=this.numberNodeWidth/2},n.prototype.addNewNumberNode=function(t){t===void 0&&(t=!1);var i=new r.default;i.imageData=this.numberAtlas,this.addChild(i),t?this.numberNodeList.unshift(i):this.numberNodeList.push(i)},n.prototype.initSpriteFrames=function(){if(this.numberAtlas!=null){this.spriteFrames=[];for(var t=0;t<10;t++)this.spriteFrames.push(this.numberAtlas.getItem(this.numberColor+"_"+t.toString()));this.spriteFrames.push(this.numberAtlas.getItem(this.numberColor+"_+"))}},n.prototype.resetNumberNodeWidth=function(t,i){t&&(this.numberNodeWidth=t),i&&(this.nodeWidthOffset=i),this.halfNumberNodeWidth=this.numberNodeWidth/2},n.prototype.update=function(){this.numberAtlas!==null&&this.numberValue!==1/0&&this.setScoreData(this.numberValue)},n.prototype.setScoreData=function(t){var i=Math.abs(t),a=this.getNumberLength(i);if(a!==0){this.updateNumberSprite(a,i);var u=a;if(this.showSign){u++,this.numberNodeList.length<u&&this.addNewNumberNode(!0);var c=this.numberNodeList.length-u,p=this.numberNodeList[c];p.setImageItem(this.spriteFrames[10]),0<this.numberNodeHeight&&p.setContentSize(this.numberNodeWidth,this.numberNodeHeight)}if(this.lastShowCount!==a)switch(this.lastShowCount=a,this.centerNumber){case n.HLEFT:this.updateNodePositionLeft(u);break;case n.HCENTER:this.updateNodePositionCenter(u);break;case n.HRIGHT:this.updateNodePositionRight(u)}}},n.prototype.getNumberLength=function(t){return t<10?1:t<100?2:t<1e3?3:t<1e4?4:Math.floor(Math.log10(t))+1},n.prototype.updateNumberSprite=function(t,i){var a=this.numberNodeList.length,u=0;if(a<t)for(var c=a;c<t;c++)this.addNewNumberNode();else if(t<a){u=a-t;for(var p=0;p<u;p++)this.numberNodeList[p].imageItem=null}for(var h=10,f=0,g=this.numberNodeList.length-1,_=g;u<=_;_--)_===g?f=i%10:_===u?f=Math.floor(i/h):(f=Math.floor(i/h)%10,h*=10),this.numberNodeList[_].setImageItem(this.getNumberSpriteFrame(f)),0<this.numberNodeHeight&&this.numberNodeList[_].setContentSize(this.numberNodeWidth,this.numberNodeHeight)},n.prototype.updateNodePosition=function(t,i){for(var a=this.numberNodeList.length,u=a-t,c=i,p=a-1;u<=p;p--)this.numberNodeList[p].setPositionX(c),c-=this.numberNodeWidth},n.prototype.updateNodePositionCenter=function(t){var i=this.rect.width/2+this.halfNumberNodeWidth*(t-2)+this.nodeWidthOffset;this.updateNodePosition(t,i)},n.prototype.updateNodePositionLeft=function(t){var i=this.numberNodeWidth*(t-1)+this.nodeWidthOffset;this.updateNodePosition(t,i)},n.prototype.updateNodePositionRight=function(t){var i=this.rect.width-this.numberNodeWidth-this.nodeWidthOffset;this.updateNodePosition(t,i)},n.prototype.getNumberSpriteFrame=function(t){return t<0||9<t?null:this.spriteFrames[t]},n.HLEFT=0,n.HCENTER=1,n.HRIGHT=2,n}(s.default);m.default=o,cc._RF.pop()},{"../../MUI/MUINode":"MUINode","../../MUI/MUISprite":"MUISprite"}],MUIParticle:[function(l,P,m){"use strict";cc._RF.push(P,"a6109QWZO9LqazDezvw4Rqj","MUIParticle"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUINode"),s=function(){this.atlas=null,this.atlasItems=[],this.duration=0,this.emissionRate=0,this.particleLifespan=0,this.particleLifespanVariance=0,this.finishParticleSize=0,this.finishParticleSizeVariance=0,this.maxParticles=0,this.angle=0,this.angleVariance=0};m.ParticleParam=s;var r=function(o){function e(){return o.call(this)||this}return __extends(e,o),e}(d.default);m.default=r,cc._RF.pop()},{"./MUINode":"MUINode"}],MUIProgressBar:[function(l,P,m){"use strict";cc._RF.push(P,"87bacaewOJPhKlz5rPV6Fd2","MUIProgressBar"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n){n===void 0&&(n=null);var t=s.call(this,n)||this;return t.progress=0,t.updateFunc=e,o(t),t}return __extends(r,s),r.prototype.setProgress=function(o){this.progress=o,this.updateFunc(this,o)},r}(l("./MUINode").default);m.default=d,cc._RF.pop()},{"./MUINode":"MUINode"}],MUISprite:[function(l,P,m){"use strict";cc._RF.push(P,"deeeaSeiEdAmrmd/v+F5z3+","MUISprite"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUINode"),s=l("../atlas/SimpleImage"),r=l("./MUIDefines"),o=l("../atlas/CanvasFunction"),e=l("../../util/Utility"),n=function(t){function i(a){a===void 0&&(a=null);var u=t.call(this,a)||this;return u.imageData=null,u.imageItem=null,u.frameSequence=null,u.vertexBuffer=null,u.vertexArray=null,u}return __extends(i,t),i.prototype.onCreate=function(){},i.prototype.draw=function(a,u){var c=this.imageItem;if(0<this.frame&&(c=this.frameSequence.frames[this.frame-1]),c){switch(r.MUI.global.renderType){case r.MUI.RenderType.WEBGL:var p=a;if(this.updateVertex(a,u,c),this.updateVertexBuffer(a),u.dirty=!1,r.MUI.global.shaderObject){p.uniform1i(r.MUI.global.shaderObject.typeUniform,0),p.uniform1f(r.MUI.global.shaderObject.opacityUniform,u.opacity),p.activeTexture(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,this.imageData.texture),p.uniform1i(r.MUI.global.shaderObject.texture0Uniform,0),p.bindBuffer(p.ARRAY_BUFFER,this.vertexBuffer);var h=this.vertexArray.BYTES_PER_ELEMENT;p.vertexAttribPointer(r.MUI.global.shaderObject.vertexPositionAttribute,3,p.FLOAT,!0,5*h,0),p.vertexAttribPointer(r.MUI.global.shaderObject.vertexTextureAttribute,2,p.FLOAT,!0,5*h,3*h),p.drawArrays(p.TRIANGLE_STRIP,0,4),p.bindBuffer(p.ARRAY_BUFFER,null)}break;case r.MUI.RenderType.CANVAS:var f=a,g=f.globalAlpha;f.globalAlpha=u.opacity;var _=Math.floor(u.centerX),y=Math.floor(f.canvas.height-u.centerY);f.translate(_,y);var S=-(u.width>>>1),I=-(u.height>>>1);this.frame<=0?o.CanvasFunction.drawImageItemScale(f,this.imageData,this.imageItem,S,I,u.width,u.height):o.CanvasFunction.drawImageItemScale(f,this.imageData,this.frameSequence.frames[this.frame-1],S,I,u.width,u.height),f.translate(-_,-y),f.globalAlpha=g}t.prototype.drawChildren.call(this,a,u)}else t.prototype.drawChildren.call(this,a,u)},i.prototype.setFrame=function(a){this.frameSequence&&a>this.frameSequence.frames.length||t.prototype.setFrame.call(this,a)},i.prototype.setImageItem=function(a){(this.imageItem=a)&&this.setContentSize(a.rect.width,a.rect.height)},i.prototype.loadLocalImage=function(a,u,c){var p=this;this.imageData=new s.default,this.imageData.image.onload=function(){var h=p.imageData.image.width,f=p.imageData.image.height;p.imageItem=new s.SimpleImageItem,p.imageItem.rect=new e.Utility.Rect(0,0,h,f),p.imageItem.rotated=u,c&&c()},this.imageData.image.src=a},i.prototype.onDestroy=function(){if(r.MUI.global.renderType===r.MUI.RenderType.WEBGL){var a=r.MUI.global.ctx;this.vertexBuffer&&(a.deleteBuffer(this.vertexBuffer),this.vertexBuffer=null)}},i.prototype.updateVertex=function(a,u,c){var p=u.width/2,h=u.height/2,f=(u.centerX-p)/r.MUI.global.viewWidth*2-1,g=(u.centerY-h)/r.MUI.global.viewHeight*2-1,_=f+u.width/r.MUI.global.viewWidth*2,y=g+u.height/r.MUI.global.viewHeight*2,S=c.rect.x/this.imageData.image.width,I=c.rect.y/this.imageData.image.height,v=S+c.rect.width/this.imageData.image.width,C=I+c.rect.height/this.imageData.image.height;this.vertexArray||(this.vertexArray=new Float32Array(20));var T=this.vertexArray,E=0;T[E++]=f,T[E++]=y,T[E++]=0,T[E++]=S,T[E++]=I,T[E++]=f,T[E++]=g,T[E++]=0,T[E++]=S,T[E++]=C,T[E++]=_,T[E++]=y,T[E++]=0,T[E++]=v,T[E++]=I,T[E++]=_,T[E++]=g,T[E++]=0,T[E++]=v,T[E++]=C},i.prototype.updateVertexBuffer=function(a){this.vertexBuffer||(this.vertexBuffer=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertexArray,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null)},i}(d.default);m.default=n,cc._RF.pop()},{"../../util/Utility":"Utility","../atlas/CanvasFunction":"CanvasFunction","../atlas/SimpleImage":"SimpleImage","./MUIDefines":"MUIDefines","./MUINode":"MUINode"}],MainScene:[function(l,P,m){"use strict";cc._RF.push(P,"281c7YtyvVPN5O1jjj34bMC","MainScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../business/UI/GameEntraScene/PrefabMgr"),s=l("../business/UI/GameEntraScene/LoadingScene"),r=l("../base/Startup"),o=l("../business/UI/GameEntraScene/UICache"),e=l("../business/Logic/I18nManager"),n=l("../business/Network/Protocol/StorageUtil"),t=l("../config/LSKey"),i=cc._decorator,a=i.ccclass,u=i.property,c=function(p){function h(){var f=p!==null&&p.apply(this,arguments)||this;return f.loadingPage_layout=null,f.mainPage_layout=null,f.transferNode=null,f.timeoutHandler=void 0,f}return __extends(h,p),h.prototype.onLoad=function(){var f=this;e.default.init(),r.default.enterTimeStamp=Date.now(),f.showLoadingPage(),r.default.isColdStart=!1,f.showMainPage(null)},h.prototype.initCMPlay=function(f){var g=this;if(!window.CMPlay)return this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=void 0),console.error("=====> initCMPlay delay"),void(this.timeoutHandler=setTimeout(function(){g.initCMPlay(f)},500));console.error("=====> initCMPlay OK"),CMPlay.init({pageId:28,gameId:6001,gameName:"\u94A2\u7434\u57572",videoAdId:"908427310",bannerAdId:"908427599",gdtVideoAdId:"3060856285839507",interstitalAdId:"908427296"}),f&&f()},h.prototype.showLoadingPage=function(){var f=this;CMPlay.GameState.onGameLoadStart(),d.default.load("prefab/LoadingPagePrefab",function(g,_){_.getComponent(s.default).setGotoMainPageListener(function(){CMPlay.GameState.onGameLoadFinished();var y=function(){_.destroy(),f.loadingPage_layout.removeAllChildren()};n.default.read(t.default.HAS_FIRST_PLAY_LITTLE_STAR)?f.showMainPage(function(){y()}):f.showLittleStart(function(){y()})}),f.loadingPage_layout.addChild(_)})},h.prototype.showLittleStart=function(f){var g=this;d.default.load("prefab/GameEntranceSceneFirstEnter",function(_,y){g.mainPage_layout.addChild(y),f&&f(),g.transferNode!=null&&(g.transferNode.removeFromParent(),g.transferNode=void 0)})},h.prototype.showMainPage=function(f){var g=this;o.UICache.musicListView?o.UICache.showMusicView():d.default.load("prefab/MainPagePrefab",function(_,y){g.mainPage_layout.addChild(y),o.UICache.musicListView=g.mainPage_layout,cc.game.addPersistRootNode(g.mainPage_layout),CMPlay.GameState.onGameMainStart(),f&&f(),g.transferNode!=null&&(g.transferNode.removeFromParent(),g.transferNode=void 0)})},__decorate([u(cc.Node)],h.prototype,"loadingPage_layout",void 0),__decorate([u(cc.Node)],h.prototype,"mainPage_layout",void 0),__decorate([u(cc.Node)],h.prototype,"transferNode",void 0),h=__decorate([a],h)}(cc.Component);m.default=c,cc._RF.pop()},{"../base/Startup":"Startup","../business/Logic/I18nManager":"I18nManager","../business/Network/Protocol/StorageUtil":"StorageUtil","../business/UI/GameEntraScene/LoadingScene":"LoadingScene","../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr","../business/UI/GameEntraScene/UICache":"UICache","../config/LSKey":"LSKey"}],MainpageBaseComponent:[function(l,P,m){"use strict";cc._RF.push(P,"8ec97WPSpJNTrj8v1wW3oDo","MainpageBaseComponent"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./WelfareController"),s=cc._decorator,r=s.ccclass,o=(s.property,function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.mSource=d.default.SRC_HOME_PAGE_CLICK,t.mUpdateTask=[],t}return __extends(n,e),n.prototype.setSource=function(t){this.mSource=t},n.prototype.setOnCloseCb=function(t){this.mCloseCb=t},n.prototype.setSubItem=function(t){this.mSubItem=t},n.prototype.getSubItem=function(){return this.mSubItem},n.prototype.invokeCloseCb=function(){this.mCloseCb&&this.mCloseCb(this.getSubItem())},n.prototype.refreshUi=function(){},n.prototype.postUpdateTask=function(t){this.mUpdateTask.push(t)},n.prototype.update=function(t){if(0<this.mUpdateTask.length){var i=this.mUpdateTask.shift();i&&i()}},n=__decorate([r],n)}(cc.Component));m.default=o,cc._RF.pop()},{"./WelfareController":"WelfareController"}],MainpageLeftBtnPanelOld:[function(l,P,m){"use strict";cc._RF.push(P,"a750c5HSRZOOZot9PFisr5E","MainpageLeftBtnPanelOld"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../infoc/m_p2_Uaction"),s=l("./BasicTouchEvent"),r=l("../../Logic/EventBus"),o=l("../../Logic/NotifyEvent"),e=l("../../../util/PU"),n=l("../../../util/Utility"),t=l("./ImgCache"),i=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),a=cc._decorator,u=a.ccclass,c=a.property,p=function(h){function f(){var g=h!==null&&h.apply(this,arguments)||this;return g.mMailTouchCallback=null,g.mToMailPageCallback=null,g.mVipTouchCallback=null,g.mToVipPageCallback=null,g.mStoreTouchCallback=null,g.mToStorePageCallback=null,g.mToDailyPageCallback=null,g.mGameClubCallbacak=null,g}return __extends(f,h),f.prototype.onLoad=function(){this.initViews(),this.initEvents()},f.prototype.onDestroy=function(){},f.prototype.initViews=function(){e.default.isIOS()&&this.setStoreIcon()},f.prototype.setStoreIcon=function(){var g=this;t.default.get("static_res/homepage/home_daily_left_btn",function(_,y){cc.isValid(g,!0)&&(g.mStoreBtn.normalSprite=y)}),t.default.get("static_res/homepage/home_daily_left_btn_press",function(_,y){cc.isValid(g,!0)&&(g.mStoreBtn.pressedSprite=y)})},f.prototype.setEventStopCallback=function(g){this.mEventStopCallback=g},f.prototype.initEvents=function(){var g=this;d.default.report(0,d.default.ACTION_SHOW_MAIL_ICON),this.mMailTouchCallback=new s.default(function(){d.default.report(0,d.default.ACTION_CLICK_MAIL_ICON),g.mToMailPageCallback&&g.mToMailPageCallback(),g.mEventStopCallback&&g.mEventStopCallback(cc.Node.EventType.TOUCH_END)},function(){g.mEventStopCallback&&g.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mMailBtn.node.on(cc.Node.EventType.TOUCH_END,this.mMailTouchCallback.click,this.mMailTouchCallback),this.handleMutiTouch(this.mMailBtn.node),this.mVipTouchCallback=new s.default(function(){g.mToVipPageCallback&&g.mToVipPageCallback(),g.mEventStopCallback&&g.mEventStopCallback(cc.Node.EventType.TOUCH_END)},function(){g.mEventStopCallback&&g.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mVipBtn.node.on(cc.Node.EventType.TOUCH_END,this.mVipTouchCallback.click,this.mVipTouchCallback),this.handleMutiTouch(this.mVipBtn.node),this.mStoreTouchCallback=new s.default(function(){e.default.isIOS()?(i.MGUser.getCurrentServerTime(),g.mToDailyPageCallback&&g.mToDailyPageCallback()):g.mToStorePageCallback&&g.mToStorePageCallback(),g.mEventStopCallback&&g.mEventStopCallback(cc.Node.EventType.TOUCH_END)},function(){g.mEventStopCallback&&g.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mStoreBtn.node.on(cc.Node.EventType.TOUCH_END,this.mStoreTouchCallback.click,this.mStoreTouchCallback),this.handleMutiTouch(this.mStoreBtn.node),this.mGameClubCallbacak=new s.default(function(){e.default.isQQ()?BK.MQQ.Webview.open("https://buluo.qq.com/mobile/barindex.html?_bid=128&_wv=1027&bid=406042"):(n.Utility.compareVersion(e.default.SDKVersion,"2.0.3"),n.Utility.compareVersion(e.default.SDKVersion,"2.0.3")<0&&r.default.fire(o.default.UPDATE_WX_VERSION_TOAST))}),this.mGameClubSprite.node.on(cc.Node.EventType.TOUCH_END,this.mGameClubCallbacak.click,this.mGameClubCallbacak)},f.prototype.setToStorePageCallback=function(g){this.mToStorePageCallback=g},f.prototype.setToDailyPageCallback=function(g){this.mToDailyPageCallback=g},f.prototype.handleMutiTouch=function(g){var _=this;g.on(cc.Node.EventType.TOUCH_START,function(){_.mEventStopCallback&&_.mEventStopCallback(cc.Node.EventType.TOUCH_START)},this),g.on(cc.Node.EventType.TOUCH_CANCEL,function(){_.mEventStopCallback&&_.mEventStopCallback(cc.Node.EventType.TOUCH_CANCEL)},this)},__decorate([c(cc.Button)],f.prototype,"mMailBtn",void 0),__decorate([c(cc.Sprite)],f.prototype,"mMailCountBg",void 0),__decorate([c(cc.Label)],f.prototype,"mMailCountLabel",void 0),__decorate([c(cc.Node)],f.prototype,"mVipBtnPanel",void 0),__decorate([c(cc.Button)],f.prototype,"mVipBtn",void 0),__decorate([c(cc.Sprite)],f.prototype,"mVipRedSpot",void 0),__decorate([c(cc.Button)],f.prototype,"mStoreBtn",void 0),__decorate([c(cc.Sprite)],f.prototype,"mGameClubSprite",void 0),f=__decorate([u],f)}(cc.Component);m.default=p,cc._RF.pop()},{"../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../util/PU":"PU","../../../util/Utility":"Utility","../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","./BasicTouchEvent":"BasicTouchEvent","./ImgCache":"ImgCache"}],MainpageLeftBtnPanel:[function(l,P,m){"use strict";cc._RF.push(P,"fe5800g+CpIqIPs06bffrz6","MainpageLeftBtnPanel"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../infoc/m_p2_Uaction"),s=l("./BasicTouchEvent"),r=l("../../Network/Protocol/StorageUtil"),o=l("../../../config/LSKey"),e=l("../../Logic/EventBus"),n=l("../../Logic/NotifyEvent"),t=l("../GameClub"),i=l("../../../util/PU"),a=l("../../../util/Utility"),u=l("./ImgCache"),c=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),p=l("../../../util/StringUtil"),h=l("../../../util/TimeUtil"),f=l("../../daily/DAwardMgr"),g=cc._decorator,_=g.ccclass,y=g.property,S=function(I){function v(){var C=I!==null&&I.apply(this,arguments)||this;return C.mRootNode=null,C.mDailyBtn=null,C.mDailyRedSpot=null,C.mExchangeBtn=null,C.mArrowBtn=null,C.mArrowPanel=null,C.mIconPanel=null,C.mRedspotLabel=null,C.mRedspotSprite=null,C.mMailTouchCallback=null,C.mToMailPageCallback=null,C.mVipTouchCallback=null,C.mToVipPageCallback=null,C.mStoreTouchCallback=null,C.mToStorePageCallback=null,C.mDailyTouchCallback=null,C.mToDailyPageCallback=null,C.mExchangeTouchCallback=null,C.mToExchangePageCallback=null,C.mGameClubCallbacak=null,C.mOnIconShowCallback=null,C.mOnIconHideCallback=null,C.mOnLoadFinishCB=null,C.mStatus=0,C.mAutoOpen=!1,C.mIsIconShow=!1,C}return __extends(v,I),v.prototype.onLoad=function(){this.initViews(),this.initEvents(),e.default.register(n.default.DAILY_GET_AWARD,this.setDailyAttendanceIcon,this)},v.prototype.onDestroy=function(){e.default.remove(n.default.DAILY_GET_AWARD,this.setDailyAttendanceIcon,this)},v.prototype.initViews=function(){this.setStoreBtn(),this.setDailyAttendanceIcon(),this.initAnim(),this.updateIconsPos()},v.prototype.autoOpen=function(C){var T=this;if(this.mAutoOpen){var E=r.default.read(o.default.HAS_AUTO_OPEN_LEFT),A=r.default.read(o.default.LAST_AUTO_OPEN_TIME);p.StringUtil.isEmpty(A)||h.default.isSameDay(new Date(parseInt(A)),new Date(c.MGUser.getCurrentServerTime()))||(E="false"),E=="true"?(this.mAutoOpen=!1,C&&C()):(r.default.save(o.default.HAS_AUTO_OPEN_LEFT,"true"),this.scheduleOnce(function(){r.default.save(o.default.LAST_AUTO_OPEN_TIME,c.MGUser.getCurrentServerTime().toString()),T.playOpenAnim(C)},.1))}else C&&C()},v.prototype.setDailyAttendanceIcon=function(){var C=this;f.DAwardMgr.getIns().checkReceiveStatAsyn(function(T){C.mDailyRedSpot.node.active=T,cc.isValid(C,!0)&&C.showRedspot()})},v.prototype.updateIconsPos=function(){var C,T,E,A,M=this.canShowStoreIcon();M||(this.mStatus=2,this.mDailyBtn.node.active=!0,(C=this.mDailyBtn.getComponent(cc.Widget)).top=111,C.updateAlignment(),(T=this.mMailBtn.getComponent(cc.Widget)).top=210,T.updateAlignment(),(E=this.mExchangeBtn.getComponent(cc.Widget)).top=306,E.updateAlignment(),(A=this.mGameClubSprite.getComponent(cc.Widget)).top=410,A.updateAlignment())},v.prototype.setEventStopCallback=function(C){this.mEventStopCallback=C},v.prototype.initEvents=function(){var C=this;this.node.on(cc.Node.EventType.TOUCH_START,function(T){T.stopPropagation()}),this.mArrowPanel.on(cc.Node.EventType.TOUCH_START,function(T){T.stopPropagation()}),d.default.report(0,d.default.ACTION_SHOW_MAIL_ICON),this.mMailTouchCallback=new s.default(function(){d.default.report(0,d.default.ACTION_CLICK_MAIL_ICON),C.mToMailPageCallback&&C.mToMailPageCallback(),C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)},function(){C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mMailBtn.node.on(cc.Node.EventType.TOUCH_END,this.mMailTouchCallback.click,this.mMailTouchCallback),this.handleMutiTouch(this.mMailBtn.node),this.mVipTouchCallback=new s.default(function(){C.mToVipPageCallback&&C.mToVipPageCallback(),C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)},function(){C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mVipBtn.node.on(cc.Node.EventType.TOUCH_END,this.mVipTouchCallback.click,this.mVipTouchCallback),this.handleMutiTouch(this.mVipBtn.node),this.mStoreTouchCallback=new s.default(function(){C.mToStorePageCallback&&C.mToStorePageCallback(),C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)},function(){C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mStoreBtn.node.on(cc.Node.EventType.TOUCH_END,this.mStoreTouchCallback.click,this.mStoreTouchCallback),this.handleMutiTouch(this.mStoreBtn.node),this.mGameClubCallbacak=new s.default(function(){i.default.isQQ()?BK.MQQ.Webview.open("https://buluo.qq.com/mobile/barindex.html?_bid=128&_wv=1027&bid=406042"):a.Utility.compareVersion(i.default.SDKVersion,"2.0.3")<0&&e.default.fire(n.default.UPDATE_WX_VERSION_TOAST)}),this.mGameClubSprite.node.on(cc.Node.EventType.TOUCH_END,this.mGameClubCallbacak.click,this.mGameClubCallbacak),this.mDailyTouchCallback=new s.default(function(){C.mToDailyPageCallback&&C.mToDailyPageCallback()},function(){C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mDailyBtn.node.on(cc.Node.EventType.TOUCH_END,this.mDailyTouchCallback.click,this.mDailyTouchCallback),this.handleMutiTouch(this.mDailyBtn.node),this.mExchangeTouchCallback=new s.default(function(){C.mToExchangePageCallback&&C.mToExchangePageCallback()},function(){C.mEventStopCallback&&C.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mExchangeBtn.node.on(cc.Node.EventType.TOUCH_END,this.mExchangeTouchCallback.click,this.mExchangeTouchCallback),this.handleMutiTouch(this.mExchangeBtn.node)},v.prototype.setToExchangePageCallback=function(C){this.mToExchangePageCallback=C},v.prototype.setToStorePageCallback=function(C){this.mToStorePageCallback=C},v.prototype.setToDailyPageCallback=function(C){this.mToDailyPageCallback=C},v.prototype.setToVipPageCallback=function(C){this.mToVipPageCallback=C},v.prototype.setToMailPageCallback=function(C){this.mToMailPageCallback=C},v.prototype.handleMutiTouch=function(C){var T=this;C.on(cc.Node.EventType.TOUCH_START,function(){T.mEventStopCallback&&T.mEventStopCallback(cc.Node.EventType.TOUCH_START)},this),C.on(cc.Node.EventType.TOUCH_CANCEL,function(){T.mEventStopCallback&&T.mEventStopCallback(cc.Node.EventType.TOUCH_CANCEL)},this)},v.prototype.initAnim=function(){var C=this,T=new s.default(function(){C.mAutoOpen?(C.mAutoOpen=!1,C.playHideAnim()):C.mIsIconShow||C.playOpenAnim()});this.mArrowBtn.node.once(cc.Node.EventType.TOUCH_END,T.click,T)},v.prototype.playOpenAnim=function(C){var T=this;this.hideRedspot(),e.default.fire(n.default.RCM_SHOW_MAIN_ENTRY_ICO,!0),this.mIsIconShow=!0;var E=this,A=E.mRootNode.getComponent(cc.Animation);A.targetOff(E),A.on("finished",function(){T.showGameClub(),u.default.get2("/static_res/homepage/home_down_up",E.mArrowBtn);var M=new s.default(function(){T.playHideAnim()});E.mArrowBtn.node.once(cc.Node.EventType.TOUCH_END,M.click,M),A.targetOff(T),T.mStatus==0?A.stop("home_left_show_icon"):T.mStatus==1?A.stop("home_left_show_icon1"):T.mStatus==2&&A.stop("home_left_show_icon2"),C&&C()},this),A.on("play",function(){T.canShowStoreIcon()&&(E.mStoreBtn.node.active=!0),E.mVipBtnPanel.active=!1,E.mDailyBtn.node.active=!0,E.mMailBtn.node.active=!0,E.mExchangeBtn.node.active=!0,E.mGameClubSprite.node.active=!0,T.mOnIconHideCallback&&T.mOnIconHideCallback()}),this.mStatus==0?A.play("home_left_show_icon"):this.mStatus==1?A.play("home_left_show_icon1"):this.mStatus==2&&A.play("home_left_show_icon2")},v.prototype.isShowIcon=function(){return this.mIsIconShow},v.prototype.hideRedspot=function(){this.mRedspotLabel.string="",this.mRedspotSprite.node.active=!1},v.prototype.showRedspot=function(){this.doShowRedspot(0)},v.prototype.isVipAndDialyHasRedspot=function(){var C=!1;this.mVipRedSpot&&this.mVipRedSpot.node&&(C=this.mVipRedSpot.node.active);var T=!1;return this.mDailyRedSpot&&this.mDailyRedSpot.node&&(T=this.mDailyRedSpot.node.active),C||T},v.prototype.doShowRedspot=function(C){this.isShowIcon()?this.hideRedspot():i.default.isIOS()?0<C?(this.mRedspotLabel.string=C+"",this.mRedspotSprite.node.active=!0):this.hideRedspot():0<C?(this.mRedspotLabel.string=C+"",this.mRedspotSprite.node.active=!0):this.isVipAndDialyHasRedspot()?(this.mRedspotLabel.string="",this.mRedspotSprite.node.active=!0):this.hideRedspot()},v.prototype.playHideAnim=function(){var C=this;e.default.fire(n.default.RCM_SHOW_MAIN_ENTRY_ICO,!1),this.mIsIconShow=!1;var T=this,E=T.mRootNode.getComponent(cc.Animation);E.targetOff(T),E.on("finished",function(){u.default.get2("/static_res/homepage/home_down_arrow",T.mArrowBtn),E.stop("home_left_hide_icon"),E.targetOff(C),T.mOnIconShowCallback&&T.mOnIconShowCallback(),C.mVipBtnPanel.active==1&&C.mStoreBtn.node.active==1?T.mDailyBtn.node.active=!1:C.mVipBtnPanel.active==1&&C.mStoreBtn.node.active==0?(T.mVipBtnPanel.active=!0,C.mVipBtnPanel.opacity=255,T.mDailyBtn.node.active=!1):C.mVipBtnPanel.active==0&&C.mStoreBtn.node.active==0&&(T.mDailyBtn.node.active=!0,T.mDailyBtn.node.opacity=255),T.mMailBtn.node.active=!1,T.mExchangeBtn.node.active=!1,T.mGameClubSprite.node.active=!1,T.initAnim(),C.showRedspot()},this),T.hideGameClub(),this.mStatus==0?E.play("home_left_hide_icon"):this.mStatus==1?E.play("home_left_hide_icon1"):this.mStatus==2&&E.play("home_left_hide_icon2")},v.prototype.showGameClub=function(){t.default.show(this.mStatus)},v.prototype.hideGameClub=function(){t.default.hide()},v.prototype.setStoreBtn=function(){this.canShowStoreIcon()?this.mStoreBtn.node.active=!0:this.mStoreBtn.node.active=!1},v.prototype.canShowStoreIcon=function(){return!i.default.isIOS()},v.prototype.playVipBgAnim=function(){var C=this.mVipBtnPanel.getComponent(cc.Animation);C&&C.play("vip_bg_light")},v.prototype.setOnIconShowCallback=function(C){this.mOnIconShowCallback=C},v.prototype.setOnIconHideCallback=function(C){this.mOnIconHideCallback=C},v.prototype.setOnLoadFinishCb=function(C){this.mOnLoadFinishCB=C},v.prototype.invokeOnLoadFinish=function(){this.mOnLoadFinishCB&&this.mOnLoadFinishCB()},__decorate([y(cc.Node)],v.prototype,"mRootNode",void 0),__decorate([y(cc.Button)],v.prototype,"mMailBtn",void 0),__decorate([y(cc.Sprite)],v.prototype,"mMailCountBg",void 0),__decorate([y(cc.Label)],v.prototype,"mMailCountLabel",void 0),__decorate([y(cc.Node)],v.prototype,"mVipBtnPanel",void 0),__decorate([y(cc.Button)],v.prototype,"mVipBtn",void 0),__decorate([y(cc.Sprite)],v.prototype,"mVipRedSpot",void 0),__decorate([y(cc.Button)],v.prototype,"mStoreBtn",void 0),__decorate([y(cc.Sprite)],v.prototype,"mGameClubSprite",void 0),__decorate([y(cc.Button)],v.prototype,"mDailyBtn",void 0),__decorate([y(cc.Sprite)],v.prototype,"mDailyRedSpot",void 0),__decorate([y(cc.Button)],v.prototype,"mExchangeBtn",void 0),__decorate([y(cc.Sprite)],v.prototype,"mArrowBtn",void 0),__decorate([y(cc.Node)],v.prototype,"mArrowPanel",void 0),__decorate([y(cc.Node)],v.prototype,"mIconPanel",void 0),__decorate([y(cc.Label)],v.prototype,"mRedspotLabel",void 0),__decorate([y(cc.Sprite)],v.prototype,"mRedspotSprite",void 0),v=__decorate([_],v)}(cc.Component);m.default=S,cc._RF.pop()},{"../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../config/LSKey":"LSKey","../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../util/PU":"PU","../../../util/StringUtil":"StringUtil","../../../util/TimeUtil":"TimeUtil","../../../util/Utility":"Utility","../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../Network/Protocol/StorageUtil":"StorageUtil","../../daily/DAwardMgr":"DAwardMgr","../GameClub":"GameClub","./BasicTouchEvent":"BasicTouchEvent","./ImgCache":"ImgCache"}],MainpageRecommendPanel:[function(l,P,m){"use strict";cc._RF.push(P,"44f0bNXvBpOk4aM/zuuvbTo","MainpageRecommendPanel"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../util/PU"),s=l("../MgPluginManager"),r=l("../../../infoc/InfocHelper"),o=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=cc._decorator,n=e.ccclass,t=e.property,i=function(a){function u(){var c=a!==null&&a.apply(this,arguments)||this;return c.recommend0=null,c.redSpot0=null,c.recommend1=null,c.redSpot1=null,c.recommend2=null,c.recommend3=null,c.mMgPluginMananger=null,c}return __extends(u,a),u.prototype.onLoad=function(){var c=this;if(d.default.isQQ()){if(r.InfocHelper.isNewUser()===1)return void o.MGUser.getUserLoginInfo({complete:function(p){p&&p.playerId&&c.initQQ(p.playerId)}});this.initQQ()}else d.default.isWeiXin()&&this.initWX()},u.prototype.initQQ=function(c){this.mMgPluginMananger||(this.mMgPluginMananger=new s.default),this.mMgPluginMananger.initFollowGifts(this.recommend1,this.redSpot1),this.mMgPluginMananger.initMGBGiftBox(this.recommend3,c),this.mMgPluginMananger.initRecommend(this.recommend2)},u.prototype.initWX=function(){this.mMgPluginMananger||(this.mMgPluginMananger=new s.default),this.mMgPluginMananger.initFollowGifts(this.recommend0,this.redSpot0),this.mMgPluginMananger.initEntryLooper(this.recommend1),this.mMgPluginMananger.initQQGame(this.recommend2),this.mMgPluginMananger.initRecommend(this.recommend3)},u.prototype.onDestroy=function(){this.mMgPluginMananger&&this.mMgPluginMananger.onDestroy()},u.prototype.initViews=function(){},u.prototype.onHide=function(){this.node.active=!1,this.mMgPluginMananger&&this.mMgPluginMananger.onHide()},u.prototype.onShow=function(){this.node.active=!0,this.mMgPluginMananger&&this.mMgPluginMananger.onShow()},__decorate([t(cc.Sprite)],u.prototype,"recommend0",void 0),__decorate([t(cc.Sprite)],u.prototype,"redSpot0",void 0),__decorate([t(cc.Sprite)],u.prototype,"recommend1",void 0),__decorate([t(cc.Sprite)],u.prototype,"redSpot1",void 0),__decorate([t(cc.Sprite)],u.prototype,"recommend2",void 0),__decorate([t(cc.Sprite)],u.prototype,"recommend3",void 0),u=__decorate([n],u)}(cc.Component);m.default=i,cc._RF.pop()},{"../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../infoc/InfocHelper":"InfocHelper","../../../util/PU":"PU","../MgPluginManager":"MgPluginManager"}],MainpageRightBtnPanel:[function(l,P,m){"use strict";cc._RF.push(P,"d6169JSKiFA1aEC1EL/FXzA","MainpageRightBtnPanel"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("../../../infoc/m_p2_Uaction"),r=l("../../Logic/EventBus"),o=l("../../Logic/NotifyEvent"),e=l("./BasicTouchEvent"),n=l("../../task/newguidance/NewGuidanceLoader"),t=l("../MusicLevelDataLoader"),i=l("../../daily/DAwardMgr"),a=l("../../Logic/I18nManager"),u=l("./ImgCache"),c=cc._decorator,p=c.ccclass,h=c.property,f=function(g){function _(){var y=g!==null&&g.apply(this,arguments)||this;return y.mLottoryPanelOut=null,y.mLottoryBtnOut=null,y.mLottoryRedSpotOut=null,y.mChoseMucicNode=null,y.mChosenMusicBtn=null,y.mChosenMusicTips=null,y.mChosenMusicTipslabel=null,y.mDailyBtn=null,y.mDailyRedSpot=null,y.isClickedShareBtn=!1,y.isClickedNewSongBtn=!1,y.isClickedSKinBtn=!1,y.isNewerTargetClickedBtn=!1,y.mWelfareClickCB=null,y.mToWelfarePageCallback=null,y.mShareClickCallback=null,y.mToSharePageCallback=null,y.mNewerRewardClickCallback=null,y.mToChatPageCallback=null,y.mLottaryOutClickCallback=null,y.mToLottaryPageCallback=null,y.mChosenMusicClickCallback=null,y.mToChosenMusicPageCallback=null,y.mSkinPieceClickCallback=null,y.mToSkinPiecePageCallback=null,y.mTMallPromotionClickCallback=null,y.mToTMallPromotionCallback=null,y.mDailyTouchCallback=null,y.mToDailyPageCallback=null,y.mHasShowFinger=!1,y}return __extends(_,g),_.prototype.setToWelfarePageCb=function(y){this.mToWelfarePageCallback=y},_.prototype.setToSharePageCallback=function(y){this.mToSharePageCallback=y},_.prototype.setToChatPageCallback=function(y){this.mToChatPageCallback=y},_.prototype.setToLottaryPageCallback=function(y){this.mToLottaryPageCallback=y},_.prototype.setToSkinPiecesPageCallback=function(y){this.mToSkinPiecePageCallback=y},_.prototype.setToChosenMusicPageCallback=function(y){this.mToChosenMusicPageCallback=y},_.prototype.setToTMallPromotionCallback=function(y){this.mToTMallPromotionCallback=y},_.prototype.setToDailyPageCallback=function(y){this.mToDailyPageCallback=y},_.prototype.enResLoad=function(){var y=this;this.enSpriteSetNull(),u.default.get("static_res/homepage/en/home_lottary_btn_en",function(S,I){cc.isValid(y,!0)&&(y.mLottoryBtnOut.normalSprite=I)}),u.default.get("static_res/homepage/en/home_lottary_btn_press_en",function(S,I){cc.isValid(y,!0)&&(y.mLottoryBtnOut.pressedSprite=I)}),u.default.get("static_res/homepage/en/home_chosen_music_en",function(S,I){cc.isValid(y,!0)&&(y.mChosenMusicBtn.normalSprite=I)}),u.default.get("static_res/homepage/en/home_chosen_music_press_en",function(S,I){cc.isValid(y,!0)&&(y.mChosenMusicBtn.pressedSprite=I)}),u.default.get("static_res/homepage/en/home_daily_btn_en",function(S,I){cc.isValid(y,!0)&&(y.mDailyBtn.normalSprite=I)}),u.default.get("static_res/homepage/en/home_daily_btn_press_en",function(S,I){cc.isValid(y,!0)&&(y.mDailyBtn.pressedSprite=I)})},_.prototype.enSpriteSetNull=function(){this.mLottoryBtnOut.getComponent(cc.Sprite).spriteFrame=null,this.mChosenMusicBtn.getComponent(cc.Sprite).spriteFrame=null,this.mDailyBtn.getComponent(cc.Sprite).spriteFrame=null},_.prototype.onLoad=function(){a.default.getInstance().isEnglish()&&this.enResLoad(),this.initViews(),this.initEvents(),this.registerEvent(),this.initNode()},_.prototype.initNode=function(){},_.prototype.onDestroy=function(){this.unRegisterEvent()},_.prototype.initViews=function(){this.setIcons(),this.setChosenMusicTips(),this.setDailyAttendanceIcon()},_.prototype.hideEventStop=function(y){this.mEventStopCallback&&this.mEventStopCallback(y)},_.prototype.initEvents=function(){var y=this;this.mLottaryOutClickCallback=new e.default(function(){s.default.report(0,s.default.ACTION_CLICK_LOTTERY_ICON),y.mToLottaryPageCallback&&y.mToLottaryPageCallback(),y.hideEventStop(cc.Node.EventType.TOUCH_END),y.mLottoryRedSpotOut.node.active=!1},function(){y.hideEventStop(cc.Node.EventType.TOUCH_END)}),this.mLottoryBtnOut.node.on(cc.Node.EventType.TOUCH_END,this.mLottaryOutClickCallback.click,this.mLottaryOutClickCallback),this.handleMutiTouch(this.mLottoryBtnOut.node),this.mChosenMusicClickCallback=new e.default(function(){y.scheduleOnce(function(){y.mToChosenMusicPageCallback&&y.mToChosenMusicPageCallback()},.1),y.isClickedNewSongBtn=!0},function(){y.hideEventStop(cc.Node.EventType.TOUCH_END)}),this.mChosenMusicBtn.node.on(cc.Node.EventType.TOUCH_END,this.mChosenMusicClickCallback.click,this.mChosenMusicClickCallback),this.handleMutiTouch(this.mChosenMusicBtn.node),this.mDailyTouchCallback=new e.default(function(){y.mToDailyPageCallback&&y.mToDailyPageCallback()},function(){y.mEventStopCallback&&y.mEventStopCallback(cc.Node.EventType.TOUCH_END)}),this.mDailyBtn.node.on(cc.Node.EventType.TOUCH_END,this.mDailyTouchCallback.click,this.mDailyTouchCallback),this.handleMutiTouch(this.mDailyBtn.node)},_.prototype.registerEvent=function(){r.default.register(o.default.HIDE_GUIDE_FINGER,this.hideFinger,this),r.default.register(o.default.WELFARE_SHOW_FRESH,this.initNode,this),r.default.register(o.default.DAILY_GET_AWARD,this.setDailyAttendanceIcon,this)},_.prototype.unRegisterEvent=function(){r.default.remove(o.default.HIDE_GUIDE_FINGER,this.hideFinger,this),r.default.remove(o.default.DAILY_GET_AWARD,this.setDailyAttendanceIcon,this),r.default.remove(o.default.WELFARE_SHOW_FRESH,this.initNode,this)},_.prototype.setIcons=function(){this.setChoseMusicShow()},_.prototype.startLottoryAnim=function(){if(this.mLottoryBtnOut&&this.mLottoryBtnOut.node.active==1){var y=this.mLottoryBtnOut.getComponent(cc.Animation);y.getAnimationState("lottory_jump")&&!y.getAnimationState("lottory_jump").isPlaying&&y.play("lottory_jump")}},_.prototype.stopLottoryAnim=function(){if(this.mLottoryBtnOut&&this.mLottoryBtnOut.node.active==1){var y=this.mLottoryBtnOut.getComponent(cc.Animation);y.getAnimationState("lottory_jump")&&y.getAnimationState("lottory_jump").isPlaying&&y.stop("lottory_jump")}},_.prototype.setDailyAttendanceIcon=function(){var y=this;i.DAwardMgr.getIns().checkReceiveStatAsyn(function(S){y.mDailyRedSpot.node.active=S})},_.prototype.setChosenMusicTips=function(){var y=t.MusicLevelDataLoader.getNewSongCountInChoiceness();this.mChosenMusicTipslabel.string=y+" new"},_.prototype.setChoseMusicShow=function(){this.isClickedNewSongBtn?this.mChosenMusicTips.node.active=!1:this.mChosenMusicTips.node.active=!0},_.prototype.hideFinger=function(){var y=this.node.parent.parent.getChildByTag(n.default.FINGER_NODE_TARGET_ICON_TAG);y&&this.node.parent.parent.removeChild(y)},_.prototype.handleMutiTouch=function(y){var S=this;y.on(cc.Node.EventType.TOUCH_START,function(){S.mEventStopCallback&&S.mEventStopCallback(cc.Node.EventType.TOUCH_START)},this),y.on(cc.Node.EventType.TOUCH_CANCEL,function(){S.mEventStopCallback&&S.mEventStopCallback(cc.Node.EventType.TOUCH_CANCEL)},this)},_.prototype.setEventStopCallback=function(y){this.mEventStopCallback=y},_.prototype.hideRightPanelByClickAnyWhere=function(){this.hideEventStop(cc.Node.EventType.TOUCH_CANCEL)},__decorate([h(cc.Node)],_.prototype,"mLottoryPanelOut",void 0),__decorate([h(cc.Button)],_.prototype,"mLottoryBtnOut",void 0),__decorate([h(cc.Sprite)],_.prototype,"mLottoryRedSpotOut",void 0),__decorate([h(cc.Node)],_.prototype,"mChoseMucicNode",void 0),__decorate([h(cc.Button)],_.prototype,"mChosenMusicBtn",void 0),__decorate([h(cc.Sprite)],_.prototype,"mChosenMusicTips",void 0),__decorate([h(cc.Label)],_.prototype,"mChosenMusicTipslabel",void 0),__decorate([h(cc.Button)],_.prototype,"mDailyBtn",void 0),__decorate([h(cc.Sprite)],_.prototype,"mDailyRedSpot",void 0),_=__decorate([p],_)}(cc.Component);m.default=f,(d=m.ChatBtnType||(m.ChatBtnType={}))[d.NORMAL=0]="NORMAL",d[d.NEW_FIGHT=1]="NEW_FIGHT",d[d.NEW_FRIEND=2]="NEW_FRIEND",cc._RF.pop()},{"../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../Logic/EventBus":"EventBus","../../Logic/I18nManager":"I18nManager","../../Logic/NotifyEvent":"NotifyEvent","../../daily/DAwardMgr":"DAwardMgr","../../task/newguidance/NewGuidanceLoader":"NewGuidanceLoader","../MusicLevelDataLoader":"MusicLevelDataLoader","./BasicTouchEvent":"BasicTouchEvent","./ImgCache":"ImgCache"}],MapGenerator:[function(l,P,m){"use strict";cc._RF.push(P,"b5574euJGNKk5ZdAx0CqRS7","MapGenerator"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=l("../../music/MusicDefines"),r=l("./Map"),o=l("./Map"),e=l("../../base/G");function n(i,a){return i<a?-1:a<i?1:0}var t=function(){function i(){}return i.generate=function(a,u,c,p,h,f){var g=new o.default(u,c),_=i.createBeginSegment(u,c,p);g.segments.push(_);var y=i.getFreeSlotsBySegment(u.slotCount,_),S=_.rect.height;if(a)for(var I=a.getMusicParts(),v=0;v<I.length;++v){var C=i.generateFromMusicPart(a,v,u,c,y);if(C.length!=0){for(var T=0,E=0;E<C.length;++E){var A=C[E];A.rect.y+=S,g.segments.push(A),A.blocks.forEach(function(N){e.G.Ap.state.perfectScore+=N.score,N.type==d.Utility.BLOCKTYPE.LONG&&(e.G.Ap.state.perfectScore+=1)}),T+=A.rect.height}var M=h.length;for(E=0;E<M;++E)v+1===h[E]&&(C[C.length-1].haveHonor=!0);y=this.getFreeSlotsBySegment(u.slotCount,C[C.length-1]),S+=T}}if(f){(L=i.createDestinationSegment(u,c)).rect.height=0,L.rect.y+=S;for(var k=g.segments[g.segments.length-1],D=(v=0,k.slots.length);v<D;++v)L.slots.push(k.slots[v]);g.segments.push(L)}else{var L;(L=i.createDestinationSegment(u,c)).rect.height=0,L.rect.y+=S,g.segments.push(L);var b=i.createBlankSegment(u,c);b.rect.y+=S,b.rect.height=5*u.baseBlockHeight,g.segments.push(b)}return g},i.generateBattle=function(a,u,c,p){var h=new o.default(u,c),f=p,g=0;if(a){a.getMusicParts();for(var _=0;_<1;++_){var y=i.generateFromMusicPart(a,_,u,c,f);if(y.length!=0){for(var S=0,I=0;I<1;++I){var v=y[I];v.rect.y+=g,h.segments.push(v),S+=v.rect.height}f=this.getFreeSlotsBySegment(u.slotCount,y[y.length-1]),g+=S}}}return h},i.generateTrial=function(a,u,c,p){var h=new o.default(u,c),f=i.createBeginSegment(u,c,p);h.segments.push(f);var g=i.getFreeSlotsBySegment(u.slotCount,f),_=f.rect.height;if(a)for(var y=a.getMusicParts(),S=0;S<3&&S<y.length;++S){var I=i.generateFromMusicPart(a,S,u,c,g);if(I.length!=0){for(var v=0,C=0;C<I.length;++C){var T=I[C];T.rect.y+=_,h.segments.push(T),v+=T.rect.height}g=this.getFreeSlotsBySegment(u.slotCount,I[I.length-1]),_+=v,S<2&&0<I.length&&(I[I.length-1].haveHonor=!0)}}var E=i.createBlankSegment(u,c);E.rect.y+=_,E.rect.height=5*u.baseBlockHeight,h.segments.push(E),_+=E.rect.height;var A=i.createDestinationSegment(u,c);return A.rect.height=0,A.rect.y+=_,h.segments.push(A),h},i.generateTrialSong=function(a,u,c,p,h){h===void 0&&(h=3);var f=new o.default(u,c),g=i.createBeginSegment(u,c,p);f.segments.push(g);var _=i.getFreeSlotsBySegment(u.slotCount,g),y=g.rect.height;if(a)for(var S=a.getMusicParts(),I=0;I<2&&I<S.length;++I){var v=i.generateFromMusicPart(a,I,u,c,_);if(v.length!=0){for(var C=0,T=0;T<v.length;++T){var E=v[T];E.rect.y+=y,f.segments.push(E),C+=E.rect.height}_=this.getFreeSlotsBySegment(u.slotCount,v[v.length-1]),y+=C,I<1&&0<v.length&&(v[v.length-1].haveHonor=!0)}}var A=i.createBlankSegment(u,c);A.rect.y+=y,A.rect.height=5*u.baseBlockHeight,f.segments.push(A),y+=A.rect.height;var M=i.createDestinationSegment(u,c);return M.rect.height=0,M.rect.y+=y,f.segments.push(M),f},i.generateGuide=function(a,u){var c=new o.default(a,u),p=0,h=i.createBlankSegment(a,u);h.type=d.Utility.SEGMENTTYPE.BEGIN,i.createShortBlockWithSegment(a,h,[0],!0),c.segments.push(h),p+=h.rect.height;var f=i.createBlankSegment(a,u);i.createLongBlockWithSegment(a,f,[2],!0),c.segments.push(f),f.rect.y+=p,p+=f.rect.height;var g=i.createBlankSegment(a,u);g.rect.y+=p,g.rect.height=5*a.baseBlockHeight,c.segments.push(g),p+=g.rect.height;var _=i.createDestinationSegment(a,u);return _.rect.height=0,_.rect.y+=p,c.segments.push(_),c},i.generateFromMusicPart=function(a,u,c,p,h){var f=[];if(a==null)return f;var g=a.getMusicParts();if(u<0||u>=g.length)return f;var _=0,y=[];h.forEach(function(C){y.push(C)});for(var S=g[u].getMusicBlocks(),I=0;I<S.length;++I){var v=i.createSegmentByMusicBlock(a,u,I,c,p,y);v&&(v.rect.y+=_,f.push(v),_+=v.rect.height,y=i.getFreeSlotsBySegment(c.slotCount,v))}return f},i.generateMoneyMap=function(a,u,c,p){for(var h=new o.default(c,p),f=a,g=[],_=0;0<f&&_<u;++_){var y=0;f<(y=_%2==0?d.Utility.getRandom(1,2):3-g[g.length-1])&&(y=f),g.push(y),f-=y}var S=Math.floor(u/2-1),I=Math.floor(f/3),v=f%3;S<=I&&(console.warn("generateMoneyMap money line is less."),I=S);var C=0,T=0,E=d.Utility.getRandoms(0,S,I);E.sort(n);var A=d.Utility.getRandoms(0,S,I);A.sort(n),_=0;for(var M=g.length;_<M;++_)g[_]==1?(C++,0<E.length&&C-1==E[0]&&(g[_]+=2,E.splice(0,1),f-=2)):(T++,0<A.length&&T-1==A[0]&&(g[_]+=1,A.splice(0,1),f-=1)),0<v&&g[_]==1&&(g[_]+=v,f-=v,v=0);f!=0&&console.warn("put money error, left "+f);var k=0;for(_=0,M=g.length;_<M;++_){var D=i.createMoneySegment(g[_],c,p);D&&(D.rect.y+=k,h.segments.push(D),k+=D.rect.height)}var L=i.createDestinationSegment(c,p);return L&&(L.rect.y+=k,h.segments.push(L),k+=L.rect.height),h},i.createBeginSegment=function(a,u,c){a.slotCount;var p=a.baseBlockHeight,h=new r.Segment(d.Utility.SEGMENTTYPE.BEGIN);h.rect.set(0,0,u.width,p),h.inhereBlockCount=1;var f=0;f=0<c.length?c[d.Utility.getRandom(0,c.length-1)]:d.Utility.getRandom(0,a.slotCount);var g=a.slotWidth,_=new r.Block;return _.id=0,_.type=d.Utility.BLOCKTYPE.BEGIN,_.slotIndex=f,_.rect.set(_.slotIndex*g,0,g,h.rect.height),_.paused=!0,h.blocks.push(_),h.slots.push(_.slotIndex),h},i.createDestinationSegment=function(a,u){var c=new r.Segment(d.Utility.SEGMENTTYPE.DESTINATION);return c.rect.set(0,0,u.width,4*a.baseBlockHeight),c},i.createBlankSegment=function(a,u){var c=new r.Segment(d.Utility.SEGMENTTYPE.MEDIUM);return c.rect.set(0,0,u.width,a.baseBlockHeight),c},i.createMoneySegment=function(a,u,c){var p=new r.Segment(d.Utility.SEGMENTTYPE.MEDIUM);p.rect.set(0,0,c.width,u.baseBlockHeight);for(var h=u.slotWidth,f=d.Utility.getRandoms(0,u.slotCount-1,a),g=0;g<f.length;++g){var _=new r.Block;_.type=d.Utility.BLOCKTYPE.MONEY,_.slotIndex=f[g],_.rect.set(f[g]*h,0,h,u.baseBlockHeight),_.musicPartIndex=-1,_.musicBlockIndex=0,_.score=1,p.blocks.push(_),p.slots.push(_.slotIndex)}return p},i.calcLessScoreByMusicBlock=function(a){var u=0;return a==null||(a.getMark()===s.MUSICMARK.DoubleBlack?u+=4:a.getMark()===s.MUSICMARK.StopMark||(a.getMark()===s.MUSICMARK.LongPress||(a.getMark(),s.MUSICMARK.Accompaniment),u+=1)),u},i.createSegmentByMusicBlock=function(a,u,c,p,h,f){if(a==null)return null;f.length==0&&console.error("createSegmentByMusicBlock startSlots is empty.");var g=a.getMusicPart(u),_=g?g.getMusicBlock(c):null;if(_==null)return null;var y=p.slotWidth,S=new r.Segment(d.Utility.SEGMENTTYPE.MEDIUM);if(S.rect.set(0,0,h.width,0),S.musicPartIndex=u,S.musicBlockIndex=c,_.getMark()===s.MUSICMARK.DoubleBlack){for(var I=i.getFreeSlotsForTwins(p.slotCount,f),v=0,C=[v=0<I.length?I[d.Utility.getRandom(0,I.length-1)]:d.Utility.getRandom(0,1),v+2],T=0;T<2;++T)(L=new r.Block).type=d.Utility.BLOCKTYPE.TWINS,L.slotIndex=C[T],L.rect.set(C[T]*y,0,y,p.baseBlockHeight),L.musicPartIndex=u,L.musicBlockIndex=c,L.score=2,L.id=T,S.blocks.push(L),S.slots.push(L.slotIndex);S.rect.height=p.baseBlockHeight,S.inhereBlockCount=2}else if(_.getMark()===s.MUSICMARK.StopMark){var E=_.getBlockDuration()/(32*g.getBaseBeats());S.rect.height=p.baseBlockHeight*E}else if(_.getMark()===s.MUSICMARK.LongPress||_.getMark()===s.MUSICMARK.Accompaniment){E=_.getBlockDuration()/(32*g.getBaseBeats());var A=0;0<f.length?A=f[d.Utility.getRandom(0,f.length-1)]:A=d.Utility.getRandom(0,p.slotCount),(L=new r.Block).type=d.Utility.BLOCKTYPE.LONG,L.slotIndex=A,L.rect.set(A*y,0,y,p.baseBlockHeight*E),L.musicPartIndex=u,L.musicBlockIndex=c,L.score=Math.floor(E),S.blocks.push(L),S.slots.push(L.slotIndex);for(var M=_.GetAccompanyDelayTimes(),k=0;k<M.length;++k){var D=new r.Bounus;D.time=M[k].time/(32*g.getBaseBeats()),D.isBass=M[k].isBass,L.bounus.push(D)}S.rect.height=L.rect.height,S.inhereBlockCount=1}else{var L;A=0,A=0<f.length?f[d.Utility.getRandom(0,f.length-1)]:d.Utility.getRandom(0,p.slotCount),(L=new r.Block).type=d.Utility.BLOCKTYPE.SHORT,L.slotIndex=A,L.rect.set(A*y,0,y,p.baseBlockHeight),L.musicPartIndex=u,L.musicBlockIndex=c,L.score=1,S.blocks.push(L),S.slots.push(L.slotIndex),S.rect.height=L.rect.height,S.inhereBlockCount=1}return S},i.createSegmentByPreMusicBlock=function(a,u,c,p,h,f){if(a==null)return null;var g=a.getMusicPart(u);if(g==null)return null;var _=u,y=c+1;return y>=g.getMusicBlocks().length&&(_=(_+1)%a.getMusicParts().length,y=0),i.createSegmentByMusicBlock(a,_,y,p,h,f)},i.createShortBlockWithSegment=function(a,u,c,p){p===void 0&&(p=!1);var h=0;h=0<c.length?c[d.Utility.getRandom(0,c.length-1)]:d.Utility.getRandom(0,a.slotCount);var f=new r.Block;f.type=d.Utility.BLOCKTYPE.SHORT,f.slotIndex=h,f.rect.set(h*a.slotWidth,0,a.slotWidth,a.baseBlockHeight),f.musicPartIndex=-1,f.musicBlockIndex=-1,f.score=1,f.paused=p,u.blocks.push(f),u.slots.push(f.slotIndex),u.rect.height=f.rect.height,u.inhereBlockCount=1},i.createLongBlockWithSegment=function(a,u,c,p){p===void 0&&(p=!1);var h=0;0<c.length?h=c[d.Utility.getRandom(0,c.length-1)]:h=d.Utility.getRandom(0,a.slotCount);var f=new r.Block;f.type=d.Utility.BLOCKTYPE.LONG,f.slotIndex=h,f.rect.set(h*a.slotWidth,0,a.slotWidth,2*a.baseBlockHeight),f.musicPartIndex=-1,f.musicBlockIndex=-1,f.score=3,f.paused=p,u.blocks.push(f),u.slots.push(f.slotIndex),u.rect.height=f.rect.height,u.inhereBlockCount=1},i.createBlock=function(a,u){var c=new r.Block;return c.rect.copy(a),c.type=u,c},i.createGiftBlock=function(a,u){var c=new r.GiftBlock;return c.rect.copy(a),c.type=d.Utility.BLOCKTYPE.GIFT,c.propChest=u,c},i.createObstacleBlock=function(a,u){var c=new r.ObstacleBlock;return c.rect.copy(a),c.type=d.Utility.BLOCKTYPE.OBSTACLE,c.obstacleType=u,c},i.createPropertyBlock=function(a,u){var c=new r.PropertyBlock;return c.rect.copy(a),c.type=d.Utility.BLOCKTYPE.PROPERTY,c.property=u.clone(),c},i.getSlotsFromSegment=function(a){for(var u=[],c=a.slots.length,p=0;p<c;++p)u.push(a.slots[p]);return u},i.getFreeSlotsBySegmentForObstacle=function(a,u){return i.getFreeSlotsBySegment(a,u)},i.getFreeSlotsBySegmentForGift=function(a,u){var c=[];if(u.slots.length==1)u.slots[0]<2?c.push(u.slots[0]+2):c.push(u.slots[0]-2);else for(var p=0;p<a;++p)c.push(p);return c},i.getFreeSlotsForTwins=function(a,u){for(var c=[],p=0;p<a/2;++p){for(var h=0,f=0;f<u.length;++f)u[f]!=p&&u[f]!=p+2||++h;2<=h&&c.push(p)}return c},i.getFreeSlotsBySegment=function(a,u){for(var c=[],p=0;p<a;++p){for(var h=!1,f=0,g=u.slots.length;f<g;++f)if(u.slots[f]==p){h=!0;break}h||c.push(p)}return c},i.getFreeSlots=function(a){for(var u=[],c=0;c<a;++c)u.push(c);return u},i}();m.default=t,cc._RF.pop()},{"../../base/G":"G","../../music/MusicDefines":"MusicDefines","../../util/Utility":"Utility","./Map":"Map"}],Map:[function(l,P,m){"use strict";cc._RF.push(P,"4f4a7z8WjdBh4zihj0+Xlx8","Map"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=function(){this.slotCount=0,this.baseBlockHeight=0,this.slotWidth=0,this.runSpeed=0,this.slotWidthsCache=[]};m.MapGenerateParam=s;var r=function(){this.time=0,this.isBass=!1,this.attain=!1};m.Bounus=r;var o=function(){this.node=null,this.type=d.Utility.BLOCKTYPE.SHORT,this.rect=new d.Utility.Rect(0,0,0,0),this.slotIndex=-1,this.id=0,this.musicPartIndex=-1,this.musicBlockIndex=-1,this.bounus=[],this.score=0,this.attainScore=0,this.added=!1,this.touchCount=0,this.touchId=-1,this.touchMove=0,this.paused=!1,this.touchTime=0,this.counter=0},e=function(u){function c(){return u!==null&&u.apply(this,arguments)||this}return __extends(c,u),c}(m.Block=o);m.GiftBlock=e;var n=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.obstacleType=d.Utility.BLOCKTYPE.SHORT,p}return __extends(c,u),c}(o);m.ObstacleBlock=n;var t=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.property=null,p}return __extends(c,u),c}(o);m.PropertyBlock=t;var i=function(u){this.blocks=[],this.slots=[],this.rect=new d.Utility.Rect(0,0,0,0),this.haveHonor=!1,this.musicPartIndex=-1,this.musicBlockIndex=-1,this.inhereBlockCount=0,this.type=d.Utility.SEGMENTTYPE.NONE,this.type=u};m.Segment=i;var a=function(u,c){this.segments=[],this.params=null,this.bottom=0,this.top=0,this.move=0,this.params=u};m.default=a,cc._RF.pop()},{"../../util/Utility":"Utility"}],Md5:[function(l,P,m){"use strict";cc._RF.push(P,"16f1eaYegtLmJq85F3WAJ68","Md5"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return s.hashStr=function(r,o){return o===void 0&&(o=!1),this.onePassHasher.start().appendStr(r).end(o)},s.hashAsciiStr=function(r,o){return o===void 0&&(o=!1),this.onePassHasher.start().appendAsciiStr(r).end(o)},s._hex=function(r){var o,e,n,t,i=s.hexChars,a=s.hexOut;for(t=0;t<4;t+=1)for(e=8*t,o=r[t],n=0;n<8;n+=2)a[e+1+n]=i.charAt(15&o),o>>>=4,a[e+0+n]=i.charAt(15&o),o>>>=4;return a.join("")},s._md5cycle=function(r,o){var e=r[0],n=r[1],t=r[2],i=r[3];n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&t|~n&i)+o[0]-680876936|0)<<7|e>>>25)+n|0)&n|~e&t)+o[1]-389564586|0)<<12|i>>>20)+e|0)&e|~i&n)+o[2]+606105819|0)<<17|t>>>15)+i|0)&i|~t&e)+o[3]-1044525330|0)<<22|n>>>10)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&t|~n&i)+o[4]-176418897|0)<<7|e>>>25)+n|0)&n|~e&t)+o[5]+1200080426|0)<<12|i>>>20)+e|0)&e|~i&n)+o[6]-1473231341|0)<<17|t>>>15)+i|0)&i|~t&e)+o[7]-45705983|0)<<22|n>>>10)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&t|~n&i)+o[8]+1770035416|0)<<7|e>>>25)+n|0)&n|~e&t)+o[9]-1958414417|0)<<12|i>>>20)+e|0)&e|~i&n)+o[10]-42063|0)<<17|t>>>15)+i|0)&i|~t&e)+o[11]-1990404162|0)<<22|n>>>10)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&t|~n&i)+o[12]+1804603682|0)<<7|e>>>25)+n|0)&n|~e&t)+o[13]-40341101|0)<<12|i>>>20)+e|0)&e|~i&n)+o[14]-1502002290|0)<<17|t>>>15)+i|0)&i|~t&e)+o[15]+1236535329|0)<<22|n>>>10)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&i|t&~i)+o[1]-165796510|0)<<5|e>>>27)+n|0)&t|n&~t)+o[6]-1069501632|0)<<9|i>>>23)+e|0)&n|e&~n)+o[11]+643717713|0)<<14|t>>>18)+i|0)&e|i&~e)+o[0]-373897302|0)<<20|n>>>12)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&i|t&~i)+o[5]-701558691|0)<<5|e>>>27)+n|0)&t|n&~t)+o[10]+38016083|0)<<9|i>>>23)+e|0)&n|e&~n)+o[15]-660478335|0)<<14|t>>>18)+i|0)&e|i&~e)+o[4]-405537848|0)<<20|n>>>12)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&i|t&~i)+o[9]+568446438|0)<<5|e>>>27)+n|0)&t|n&~t)+o[14]-1019803690|0)<<9|i>>>23)+e|0)&n|e&~n)+o[3]-187363961|0)<<14|t>>>18)+i|0)&e|i&~e)+o[8]+1163531501|0)<<20|n>>>12)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n&i|t&~i)+o[13]-1444681467|0)<<5|e>>>27)+n|0)&t|n&~t)+o[2]-51403784|0)<<9|i>>>23)+e|0)&n|e&~n)+o[7]+1735328473|0)<<14|t>>>18)+i|0)&e|i&~e)+o[12]-1926607734|0)<<20|n>>>12)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n^t^i)+o[5]-378558|0)<<4|e>>>28)+n|0)^n^t)+o[8]-2022574463|0)<<11|i>>>21)+e|0)^e^n)+o[11]+1839030562|0)<<16|t>>>16)+i|0)^i^e)+o[14]-35309556|0)<<23|n>>>9)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n^t^i)+o[1]-1530992060|0)<<4|e>>>28)+n|0)^n^t)+o[4]+1272893353|0)<<11|i>>>21)+e|0)^e^n)+o[7]-155497632|0)<<16|t>>>16)+i|0)^i^e)+o[10]-1094730640|0)<<23|n>>>9)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n^t^i)+o[13]+681279174|0)<<4|e>>>28)+n|0)^n^t)+o[0]-358537222|0)<<11|i>>>21)+e|0)^e^n)+o[3]-722521979|0)<<16|t>>>16)+i|0)^i^e)+o[6]+76029189|0)<<23|n>>>9)+t|0,n=((n+=((t=((t+=((i=((i+=((e=((e+=(n^t^i)+o[9]-640364487|0)<<4|e>>>28)+n|0)^n^t)+o[12]-421815835|0)<<11|i>>>21)+e|0)^e^n)+o[15]+530742520|0)<<16|t>>>16)+i|0)^i^e)+o[2]-995338651|0)<<23|n>>>9)+t|0,n=((n+=((i=((i+=(n^((e=((e+=(t^(n|~i))+o[0]-198630844|0)<<6|e>>>26)+n|0)|~t))+o[7]+1126891415|0)<<10|i>>>22)+e|0)^((t=((t+=(e^(i|~n))+o[14]-1416354905|0)<<15|t>>>17)+i|0)|~e))+o[5]-57434055|0)<<21|n>>>11)+t|0,n=((n+=((i=((i+=(n^((e=((e+=(t^(n|~i))+o[12]+1700485571|0)<<6|e>>>26)+n|0)|~t))+o[3]-1894986606|0)<<10|i>>>22)+e|0)^((t=((t+=(e^(i|~n))+o[10]-1051523|0)<<15|t>>>17)+i|0)|~e))+o[1]-2054922799|0)<<21|n>>>11)+t|0,n=((n+=((i=((i+=(n^((e=((e+=(t^(n|~i))+o[8]+1873313359|0)<<6|e>>>26)+n|0)|~t))+o[15]-30611744|0)<<10|i>>>22)+e|0)^((t=((t+=(e^(i|~n))+o[6]-1560198380|0)<<15|t>>>17)+i|0)|~e))+o[13]+1309151649|0)<<21|n>>>11)+t|0,n=((n+=((i=((i+=(n^((e=((e+=(t^(n|~i))+o[4]-145523070|0)<<6|e>>>26)+n|0)|~t))+o[11]-1120210379|0)<<10|i>>>22)+e|0)^((t=((t+=(e^(i|~n))+o[2]+718787259|0)<<15|t>>>17)+i|0)|~e))+o[9]-343485551|0)<<21|n>>>11)+t|0,r[0]=e+r[0]|0,r[1]=n+r[1]|0,r[2]=t+r[2]|0,r[3]=i+r[3]|0},s.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(s.stateIdentity),this},s.prototype.appendStr=function(r){var o,e,n=this._buffer8,t=this._buffer32,i=this._bufferLength;for(e=0;e<r.length;e+=1){if((o=r.charCodeAt(e))<128)n[i++]=o;else if(o<2048)n[i++]=192+(o>>>6),n[i++]=63&o|128;else if(o<55296||56319<o)n[i++]=224+(o>>>12),n[i++]=o>>>6&63|128,n[i++]=63&o|128;else{if(1114111<(o=1024*(o-55296)+(r.charCodeAt(++e)-56320)+65536))throw new Error("Unicode standard supports code points up to U+10FFFF");n[i++]=240+(o>>>18),n[i++]=o>>>12&63|128,n[i++]=o>>>6&63|128,n[i++]=63&o|128}64<=i&&(this._dataLength+=64,s._md5cycle(this._state,t),i-=64,t[0]=t[16])}return this._bufferLength=i,this},s.prototype.appendAsciiStr=function(r){for(var o,e=this._buffer8,n=this._buffer32,t=this._bufferLength,i=0;;){for(o=Math.min(r.length-i,64-t);o--;)e[t++]=r.charCodeAt(i++);if(t<64)break;this._dataLength+=64,s._md5cycle(this._state,n),t=0}return this._bufferLength=t,this},s.prototype.appendByteArray=function(r){for(var o,e=this._buffer8,n=this._buffer32,t=this._bufferLength,i=0;;){for(o=Math.min(r.length-i,64-t);o--;)e[t++]=r[i++];if(t<64)break;this._dataLength+=64,s._md5cycle(this._state,n),t=0}return this._bufferLength=t,this},s.prototype.getState=function(){var r=this._state;return{buffer:String.fromCharCode.apply(null,this._buffer8),buflen:this._bufferLength,length:this._dataLength,state:[r[0],r[1],r[2],r[3]]}},s.prototype.setState=function(r){var o,e=r.buffer,n=r.state,t=this._state;for(this._dataLength=r.length,this._bufferLength=r.buflen,t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],o=0;o<e.length;o+=1)this._buffer8[o]=e.charCodeAt(o)},s.prototype.end=function(r){r===void 0&&(r=!1);var o,e=this._bufferLength,n=this._buffer8,t=this._buffer32,i=1+(e>>2);if(this._dataLength+=e,n[e]=128,n[e+1]=n[e+2]=n[e+3]=0,t.set(s.buffer32Identity.subarray(i),i),55<e&&(s._md5cycle(this._state,t),t.set(s.buffer32Identity)),(o=8*this._dataLength)<=4294967295)t[14]=o;else{var a=o.toString(16).match(/(.*?)(.{0,8})$/);if(a===null)return;var u=parseInt(a[2],16),c=parseInt(a[1],16)||0;t[14]=u,t[15]=c}return s._md5cycle(this._state,t),r?this._state:s._hex(this._state)},s.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),s.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s.hexChars="0123456789abcdef",s.hexOut=[],s.onePassHasher=new s,s}();(m.default=d).hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592"&&console.error("Md5 self test failed."),cc._RF.pop()},{}],MemCache:[function(l,P,m){"use strict";cc._RF.push(P,"74ff7KSKPlOOYnSZoqeHK94","MemCache"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../config/LSKey"),s=l("../../../util/StringUtil"),r=l("../../../base/Log"),o=l("../../../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),e=function(){function n(){this.memoryObj=null,this.mCanUseMemoryCache=!0,this.mErrorVal="0.0",this.isHasLocalData=!1,this.isBatchSave=!1,this.mSavedVal="",this.memoryObj=new Object;var t=this.readFromFlash(n.KEY_ALL,this.mErrorVal);t==this.mErrorVal||s.StringUtil.isEmpty(t)||(this.memoryObj=JSON.parse(t)),this.mergeLocalData()}return n.prototype.mergeLocalData=function(){var t=Object.keys(this.memoryObj);if(Date.now(),t&&t.length!=0)this.isHasLocalData=!0;else{var i=this.readFromFlash(d.default.UserInfo,this.mErrorVal);if(i==this.mErrorVal)this.mCanUseMemoryCache=!1,this.isHasLocalData=!1;else if(!s.StringUtil.isEmpty(i)){this.isHasLocalData=!0,this.memoryObj[d.default.UserInfo]=i;var a=new Object;this.mCanUseMemoryCache=this.readOldData(a),this.mCanUseMemoryCache&&(this.memoryObj=a,this.memoryObj[d.default.UserInfo]=i,this.removeOldData())}}},n.prototype.hasLocalData=function(){return this.isHasLocalData},n.prototype.removeOldData=function(){for(var t=Object.keys(d.default),i=0;i<t.length;i++){var a=t[i];a!="KEYS_NEED_SYNC"&&this.removeFromFlash(d.default[a])}},n.prototype.readOldData=function(t){for(var i=Object.keys(d.default),a=0;a<i.length;a++){var u=i[a];if(u!="KEYS_NEED_SYNC"&&u!="UserInfo"){var c=d.default[u],p=this.readFromFlash(c,this.mErrorVal);if(p==this.mErrorVal)return!1;t[c]=p}}return!0},n.Ins=function(){return n._instance||(n._instance=new n),n._instance},n.prototype.batchSaveStart=function(){this.isBatchSave=!0},n.prototype.batchSaveEnd=function(){this.isBatchSave=!1,this.flushToFile()},n.prototype.save=function(t,i){s.StringUtil.isNullOrUndefined(t)||(this.mCanUseMemoryCache?(this.memoryObj[t]=i,this.isBatchSave||this.flushToFile()):this.saveToFlash(t,i))},n.prototype.read=function(t,i){return i===void 0&&(i=null),s.StringUtil.isNullOrUndefined(t)?i:this.mCanUseMemoryCache?this.memoryObj[t]:this.readFromFlash(t,i)},n.prototype.remove=function(t){if(!s.StringUtil.isNullOrUndefined(t))try{if(this.mCanUseMemoryCache){if(t==n.KEY_ALL)for(var i=Object.keys(this.memoryObj),a=0;a<i.length;a++){var u=i[a];u!=null&&u!=null&&delete this.memoryObj[u]}else delete this.memoryObj[t];this.flushToFile()}else this.removeFromFlash(t)}catch(c){r.default.e(n.TAG+"remove error",t,c)}},n.prototype.flushToFile=function(){var t=this,i=JSON.stringify(this.memoryObj);this.mSavedVal!==i&&setTimeout(function(){t.saveToFlash(n.KEY_ALL,i)&&(t.mSavedVal=i)},0)},n.prototype.saveToFlash=function(t,i){try{return o.MGBasic.setStorage(t,i)}catch(a){return r.default.e(n.TAG+"flush to file, error: ",a),!1}},n.prototype.readFromFlash=function(t,i){i===void 0&&(i="");try{return o.MGBasic.getStorage(t)}catch(a){return r.default.e(n.TAG+"readFromCache",a),i}},n.prototype.removeFromFlash=function(t){try{o.MGBasic.delStorage(t)}catch(i){}},n.KEY_ALL="wx_id",n.TAG="FileCache => ",n}();m.MemCache=e,cc._RF.pop()},{"../../../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../util/StringUtil":"StringUtil"}],MgPluginManager:[function(l,P,m){"use strict";cc._RF.push(P,"68eabUDSzJHiZCiWtxnB/GJ","MgPluginManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),s=l("../../util/PU"),r=l("../../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),o=l("../Network/Protocol/StorageUtil"),e=l("../../config/LSKey"),n=l("../../infoc/m_p2_Uaction"),t=l("../../base/Log"),i=l("../looper/Looper"),a=l("./GameEntraScene/ImgCache"),u=l("./GameEntraScene/PrefabMgr"),c=l("../skin/FollowGiftsPrefab"),p=l("../../util/PageHeap"),h=l("../../upgrade/ToggleChecker"),f=l("../../upgrade/ToggleBean"),g=l("./MGBGiftBoxWrapper"),_=l("../../util/Utility");l("../../libs/recommender.min");var y,S,I=function(){function v(){this.POSID_RCM="1001102",this.ACTION_SHOW=10001,this.ACTION_CLICK=10002,this.ACTION_JUMP=551,this.ADTYPE_RCM=5,this.imageCache={},this.dancingLineAppId="wxf976a9e8c25dedf2",this.dancingLineExtraDataSrc="piano2",this.dancingLineGameId=3091,this.dlIcon="/static_res/homepage/recommend_game/dancinglineA",this.brickesAppId="wx3ab3658aab34d7db",this.brickesExtraDataSrc="piano2",this.brickesGameId=3511,this.brickesIcon="/static_res/homepage/recommend_game/brickes",this.entryIconRollingsky="/static_res/homepage/recommend_game/icon_rolling_sky",this.extraDataSrcRollingsky="piano2",this.appIdRollingsky="wx60001e99e6f99e70",this.gameIdRollingsky="",this.followIcon="/static_res/homepage/recommend_game/follow_icon",this.mDlBrickesLooper=null,this.mGiftBoxWrpper=null,this.mEntryType=v.PARAMS_TYPE_ROLLINGSKY}return v.prototype.createUI=function(){},v.prototype.getRecommend=function(C){var T="wx3ff4ef6cb6e496a4",E=v.PLATFORM_WX;return s.default.isQQ()&&(T="2749",E=v.PLATFORM_QQ),new Recommender({appid:T,openid:C,forceOpen:!1,platform:E,debug:!1,env:v.ENV_PROD})},v.prototype.onDestroy=function(){t.default.i(v.TAG+",onDestroy "),this.mDlBrickesLooper&&this.mDlBrickesLooper.stop(),this.mGiftBoxWrpper&&this.mGiftBoxWrpper.onDestroy()},v.prototype.onHide=function(){t.default.i(v.TAG+",onHide "),this.mDlBrickesLooper&&this.mDlBrickesLooper.stop(),this.mGiftBoxWrpper&&this.mGiftBoxWrpper.onHide()},v.prototype.onShow=function(C){C===void 0&&(C=v.INTERVAL_TIME),t.default.i(v.TAG+",onShow "),this.mDlBrickesLooper&&(t.default.i(v.TAG+",onShow this.mDlBrickesLooper = "+this.mDlBrickesLooper.getStarted()),this.mDlBrickesLooper.getStarted()||this.mDlBrickesLooper.start(C)),this.mGiftBoxWrpper&&this.mGiftBoxWrpper.onShow()},v.prototype.initMGBGiftBox=function(C,T){this.mGiftBoxWrpper||(this.mGiftBoxWrpper=new g.default),this.mGiftBoxWrpper.initGiftBox(C,T)},v.prototype.initEntryLooper=function(C,T){var E=this;T===void 0&&(T=v.INTERVAL_TIME);var A=this.getDLParams(),M=this.getRollingskyParams();MGRPT.minigame_common_ad.report(this.POSID_RCM,this.ACTION_SHOW,0,this.ADTYPE_RCM),this.initEntryIcon(this.mEntryType,C),this.mDlBrickesLooper||(this.mDlBrickesLooper=new i.default,this.mDlBrickesLooper.setWork(function(){E.mEntryType==v.PARAMS_TYPE_DL?E.mEntryType=v.PARAMS_TYPE_ROLLINGSKY:E.mEntryType=v.PARAMS_TYPE_DL,E.initEntryIcon(E.mEntryType,C)}),this.mDlBrickesLooper.start(T)),C.node.on(cc.Node.EventType.TOUCH_END,function(){setTimeout(function(){var k=null;k=E.mEntryType==v.PARAMS_TYPE_DL?A:M,MGRPT.minigame_common_ad.report(E.POSID_RCM,E.ACTION_CLICK,k.appId,E.ADTYPE_RCM),k.success=function(){MGRPT.minigame_common_ad.report(E.POSID_RCM,E.ACTION_JUMP,k.appId,E.ADTYPE_RCM)},r.MGBasic.navigateToMiniProgram(k)},0)})},v.prototype.initEntryIcon=function(C,T){var E=this.dlIcon;C==v.PARAMS_TYPE_ROLLINGSKY&&(E=this.entryIconRollingsky),a.default.get2(E,T)},v.prototype.initBrickes=function(C){t.default.i(v.TAG+",initBrickes "),a.default.get2(this.brickesIcon,C);var T=this.getBrickesParmas();C.node.on(cc.Node.EventType.TOUCH_START,function(){t.default.i(v.TAG+",initBrickes click params = ",T),setTimeout(function(){r.MGBasic.navigateToMiniProgram(T)},0)})},v.prototype.initFollowGifts=function(C,T){var E=this;t.default.i(v.TAG+",initFollowGifs "),this.canShowIcon(C)?this.initShowFollowGifts(function(A){if(A){a.default.get2(E.followIcon,C);var M=o.default.read("follow_gifts");M!=null&&M!=""&&M!=null||(T.node.active=!0),n.default.report(0,n.default.ACTION_FOLLOW_ICON_SHOW),C.node.on(cc.Node.EventType.TOUCH_START,function(){t.default.i(v.TAG+",initFollowGifs "),n.default.report(0,n.default.ACTION_FOLLOW_ICON_CLICK),T.node.active=!1,o.default.save("follow_gifts","true"),E.showFollowForGiftPrefb(C.node.parent.parent.parent)})}}):console.warn(v.TAG+" initFollow failed  ")},v.prototype.canShowIcon=function(C){return!(!C||C.node==null)&&C.node.parent!=null&&C.node.parent.parent!=null&&!(s.default.isWeiXin()&&_.Utility.compareVersion(s.default.SDKVersion,"2.0.3")<0)&&C.node.parent.parent.parent!=null},v.prototype.initDL=function(C){var T=this;t.default.i(v.TAG+",initDL "),a.default.get2(this.dlIcon,C);var E=this.getDLParams();this.report(1,"dancinglineA"),C.node.on(cc.Node.EventType.TOUCH_START,function(){t.default.i(v.TAG+",initDL click params = ",E),T.report(2,"dancinglineA"),setTimeout(function(){r.MGBasic.navigateToMiniProgram(E)},0)})},v.prototype.getBrickesParmas=function(){var C=this.brickesAppId;return s.default.isQQ()&&(C=this.brickesGameId+""),{appId:C,path:"",extraData:{src:this.brickesExtraDataSrc}}},v.prototype.getDLParams=function(){var C=this.dancingLineAppId;return s.default.isQQ()&&(C=this.dancingLineGameId+""),{appId:C,path:"",extraData:{src:this.dancingLineExtraDataSrc}}},v.prototype.getRollingskyParams=function(){return{appId:s.default.isWeiXin()?this.appIdRollingsky:this.gameIdRollingsky,path:"",extraData:{src:this.extraDataSrcRollingsky}}},v.prototype.initQQGame=function(C){var T=this;(s.default.isWeiXin()||s.default.isQQ())&&(t.default.i("[Recommender] initQQ: "),d.MGUser.getUserLoginInfo({complete:function(E){E&&T.startQQ(E.playerId,C)}}))},v.prototype.initRecommend=function(C){var T=this;s.default.isWeiXin()||s.default.isQQ()?(t.default.i("[Recommender] initRecommend: "),d.MGUser.getUserLoginInfo({complete:function(E){E&&T.startRecommend(E.playerId,C)}})):t.default.i("MgPlugin platform not support")},v.prototype.startQQ=function(C,T){var E=this;this.getRecommend(C).getQQGameEntry(function(A){if(t.default.i("[Recommender] GetQQGameEntry: ",A),A&&A.isOpen){T.node.active=!0;var M=A.icon;E.setImage(T,M),T.node.on(cc.Node.EventType.TOUCH_START,function(){t.default.i("[Recommender] QQ onlcik: jumpToCurrentGame "),A.navigateToMiniProgram()})}else T.node.active=!1})},v.prototype.showFollowForGiftPrefb=function(C){u.default.load("prefab/FollowGiftsPrefab",function(T,E){t.default.i(" show node => "+E+"error ->"+T),E&&(E.getComponent(c.default).setCloseCallback(function(){t.default.i(" showFollowForGiftPrefb destroy"),p.default.Ins().pop("FollowGiftsPrefab"),E.destroy()}),C.addChild(E),p.default.Ins().push("FollowGiftsPrefab"))})},v.prototype.startRecommend=function(C,T){var E=this,A=this.getRecommend(C);A.onReady(function(M,k){t.default.i("[Recommender] onReady: isOpen = "+M+", game = ",k),M?(T.node.active=!0,E.setImage(T,k.icon),T.node.on(cc.Node.EventType.TOUCH_START,function(){t.default.i("[Recommender] onlcik: jumpToCurrentGame "),A.jumpToCurrentGame()})):T.node.active=!1}),A.onChange(function(M){T&&T.isValid&&E.setImage(T,M.icon)})},v.prototype.buildRedSpot=function(C){var T=o.default.read(e.default.RECOMMEND_GAME_RED_SPOT_CLICKED)==="true";C.active=!T},v.prototype.setImage=function(C,T,E){var A=this;if(this.imageCache[T]){if(C.spriteFrame=this.imageCache[T],!E){var M=C.spriteFrame.width<=60?C.spriteFrame.width:60,k=C.spriteFrame.height<=80?C.spriteFrame.height:80;C.node.width=M,C.node.height=k}}else cc.loader.load({url:T},function(D,L){if(A.imageCache[T]=C.spriteFrame=new cc.SpriteFrame(L),!E){var b=C.spriteFrame.width<=60?C.spriteFrame.width:60,N=C.spriteFrame.height<=80?C.spriteFrame.height:80;C.node.width=b,C.node.height=N}})},v.prototype.report=function(C,T){var E=T==="dancinglineA"?y.DancingLineA:y.DancingLineB;switch(C){case 1:v.reportShow(E);break;case 2:v.reportClick(E)}},v.reportShow=function(C){switch(C){case y.DancingLineA:n.default.report(0,n.default.ACTION_HOMEPAGE_RECOMMEND_GAME_SHOW_A);break;case y.DancingLineB:n.default.report(0,n.default.ACTION_HOMEPAGE_RECOMMEND_GAME_SHOW_B)}},v.reportClick=function(C){switch(C){case y.DancingLineA:n.default.report(0,n.default.ACTION_HOMEPAGE_RECOMMEND_GAME_CLICK_A);break;case y.DancingLineB:n.default.report(0,n.default.ACTION_HOMEPAGE_RECOMMEND_GAME_CLICK_B)}},v.prototype.getServerTime=function(C){d.MGUser.getCurrentServerRealTime({complete:function(T,E){C(T,E)}})},v.prototype.initShowFollowGifts=function(C){h.default.ins().init(function(){var T=h.default.ins().getToggleStatus(f.ToggleKey.SUBSCRIPTION_ICON,0,0);C(T==1)})},v.TAG="MgPluginManager====>>>",v.ENV_PRE="pre",v.ENV=v.ENV_PROD="prod",v.PLATFORM_WX="wx",v.PLATFORM_QQ="qq",v.PLATFORM=v.PLATFORM_WX,v.isEnable=!0,v.PARAMS_TYPE_DL=0,v.PARAMS_TYPE_BRICKES=1,v.PARAMS_TYPE_ROLLINGSKY=2,v.INTERVAL_TIME=8,v}();m.default=I,(S=y=m.RECOMMEND_GAME_NAME||(m.RECOMMEND_GAME_NAME={}))[S.DancingLineA=0]="DancingLineA",S[S.DancingLineB=1]="DancingLineB",cc._RF.pop()},{"../../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../config/LSKey":"LSKey","../../infoc/m_p2_Uaction":"m_p2_Uaction","../../libs/recommender.min":"recommender.min","../../upgrade/ToggleBean":"ToggleBean","../../upgrade/ToggleChecker":"ToggleChecker","../../util/PU":"PU","../../util/PageHeap":"PageHeap","../../util/Utility":"Utility","../Network/Protocol/StorageUtil":"StorageUtil","../looper/Looper":"Looper","../skin/FollowGiftsPrefab":"FollowGiftsPrefab","./GameEntraScene/ImgCache":"ImgCache","./GameEntraScene/PrefabMgr":"PrefabMgr","./MGBGiftBoxWrapper":"MGBGiftBoxWrapper"}],MistakeBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"7c904jbo5pDfKSPZsk5e744","MistakeBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/BlockSkinFrameLoader"),s=function(r){function o(){return r!==null&&r.apply(this,arguments)||this}return __extends(o,r),o.prototype.createLayers=function(){this.setPosition(this.mBlock.rect.x,this.mBlock.rect.y),this.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height);var e=d.default.getInstance().getMistakeBlockBackground();this.imageItem=e,this.imageData=d.default.getInstance().getAtlas()},o.prototype.updateTouchState=function(e){this.opacity=e?.2:1},o}(l("./BlockNode").default);m.default=s,cc._RF.pop()},{"../loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./BlockNode":"BlockNode"}],MoneyBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"76f47OGjN5OYLrDTHTUPH31","MoneyBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/GameSceneFrameLoader"),s=function(r){function o(){return r!==null&&r.apply(this,arguments)||this}return __extends(o,r),o.prototype.createLayers=function(){r.prototype.createLayers.call(this);var e=d.default.getInstance().getMoneyBlockBackground();this.imageItem=e,this.imageData=d.default.getInstance().getAtlas()},o.prototype.updateTouchState=function(e){this.opacity=e?.2:1},o}(l("./BlockNode").default);m.default=s,cc._RF.pop()},{"../loader/GameSceneFrameLoader":"GameSceneFrameLoader","./BlockNode":"BlockNode"}],MoneySystem:[function(l,P,m){"use strict";cc._RF.push(P,"11a63MVO+dCV4Jt4/dfIWmE","MoneySystem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Plugin/PluginMgr"),s=l("./Plugin/IPlugin"),r=function(){function o(){}return o.costCoinToHp=function(e){var n=d.default.Ins().getPluginEx(s.default.Plugin_Economy),t=d.default.Ins().getPluginEx(s.default.Plugin_Energy);if(n.getCurGold()<e)return!1;var i=!0;switch(e){case 0:t.addEnergy(2);break;case 100:n.gainGold(-100),t.addEnergy(2);break;case 220:n.gainGold(-220),t.addEnergy(5);break;case 430:n.gainGold(-430),t.addEnergy(10);break;case 850:n.gainGold(-850),t.addEnergy(20);break;default:i=!1}return i},o.costDiamondToCoin=function(e){var n=!1,t=d.default.Ins().getPluginEx(s.default.Plugin_Economy);switch(e){case 1:t.costDiamond(1)&&(t.gainGold(100),n=!0);break;case 10:t.costDiamond(10)&&(t.gainGold(1100),n=!0);break;case 100:t.costDiamond(100)&&(t.gainGold(12999),n=!0)}return n},o.increaseHp=function(e){Number.isNaN(e)&&(e=0),d.default.Ins().getPluginEx(s.default.Plugin_Energy).addEnergy(e)},o.getHpCount=function(){return d.default.Ins().getPluginEx(s.default.Plugin_Energy).getCurrentEnergy()},o.consumeHp=function(e){Number.isNaN(e)&&(e=0);var n=d.default.Ins().getPluginEx(s.default.Plugin_Energy);return e<=n.getCurrentEnergy()&&(n.decreaseEnergy(e),!0)},o.increaseGold=function(e){Number.isNaN(e)&&(e=0),d.default.Ins().getPluginEx(s.default.Plugin_Economy).gainGold(e)},o.getGoldCount=function(){return d.default.Ins().getPluginEx(s.default.Plugin_Economy).getCurGold()},o.consumeGold=function(e){if(e<=0)throw new Error("count must bigger than 0.");var n=d.default.Ins().getPluginEx(s.default.Plugin_Economy);return e<=n.getCurGold()&&(n.gainGold(-1*e),!0)},o.increaseDiamond=function(e){Number.isNaN(e)&&(e=0),d.default.Ins().getPluginEx(s.default.Plugin_Economy).addDiamond(e)},o.getDiamondCount=function(){return d.default.Ins().getPluginEx(s.default.Plugin_Economy).getCurDiamond()},o.consumeDiamond=function(e){if(0<e){var n=d.default.Ins().getPluginEx(s.default.Plugin_Economy);return n.getCurDiamond()>=e&&(n.costDiamond(e),!0)}return!0},o}();m.MoneySystem=r,cc._RF.pop()},{"./Plugin/IPlugin":"IPlugin","./Plugin/PluginMgr":"PluginMgr"}],MusicBeat:[function(l,P,m){"use strict";cc._RF.push(P,"b7f68wfVapGR7HS6/n7SYJU","MusicBeat"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.beatName="",this.fileName="",this.realPath="",this.isStopMark=!1,this.audioId=-1};m.default=d,cc._RF.pop()},{}],MusicBlock:[function(l,P,m){"use strict";cc._RF.push(P,"947b91X2GFCSqgjaqmcvNbd","MusicBlock"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicDefines"),s=function(){function r(){this.syllableRefs=[],this.accompanySyllableRefs=[],this.accompanyDelays=[],this.mark=d.MUSICMARK.None,this.duration=0}return r.prototype.addSyllable=function(o){this.syllableRefs.push(o)},r.prototype.addAccompanySyllable=function(o,e){o.addAccDelay(e),o.setDelayFromParent(0);var n=new d.AccompanyDelay;n.time=o.getAccDelay(),n.isBass=o.getInstrument().isName("bass"),this.addaccompanyDelay(n),this.accompanySyllableRefs.push(o)},r.prototype.addAccompanySyllables=function(o,e){for(var n=0;n<o.length;++n)this.addAccompanySyllable(o[n],e)},r.prototype.setMark=function(o){this.mark=o},r.prototype.getMark=function(){return this.mark},r.prototype.getBlockDuration=function(){for(var o=0,e=0;e<this.syllableRefs.length;++e)o+=this.syllableRefs[e].getDuration();return o},r.prototype.GetAccompanyDelayTimes=function(){return this.accompanyDelays},r.prototype.playSingleSyllable=function(o,e){o!=null&&0<=e&&e<this.syllableRefs.length&&o.addSyllable(this.syllableRefs[e])},r.prototype.playAllSyllablsInOrder=function(o){if(o!=null)for(var e=0,n=0;n<this.syllableRefs.length;n++){var t=this.syllableRefs[n];t.resetPlayData(),t.setStartTime(e),o.addSyllable(t),e+=t.getDuration()}},r.prototype.playAccompanySyllablsInOrder=function(o){if(o!=null)for(var e=0,n=0;n<this.accompanySyllableRefs.length;n++){var t=this.accompanySyllableRefs[n];t.setStartTime(e),e+=t.getDuration(),o.addSyllable(t)}},r.prototype.playAccompanySyllable=function(o,e){if(o!=null){if(0<=e&&e<this.accompanyDelays.length)for(var n=this.accompanyDelays[e],t=0;t<this.accompanySyllableRefs.length;t++)(i=this.accompanySyllableRefs[t]).getAccDelay()==n.time&&(i.resetPlayData(),i.playState.gain=1,o.addSyllable(i));else if(e==-1)for(t=0;t<this.accompanySyllableRefs.length;t++){var i;(i=this.accompanySyllableRefs[t]).setStartTime(i.getAccDelay()),i.playState.gain=1,o.addSyllable(i)}}},r.prototype.addaccompanyDelay=function(o){for(var e=0;e<this.accompanyDelays.length;e++){if(o.time==this.accompanyDelays[e].time)return;if(o.time<this.accompanyDelays[e].time)return void this.accompanyDelays.splice(e,0,o)}this.accompanyDelays.push(o)},r}();m.default=s,cc._RF.pop()},{"./MusicDefines":"MusicDefines"}],MusicCache:[function(l,P,m){"use strict";cc._RF.push(P,"76d43HcHRdOFZ5Ry1h7W2Qu","MusicCache"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicParser"),s=l("../base/G"),r=l("../business/Logic/LevelMgr"),o=function(){function e(){this.musicCaches=[]}return e.prototype.getMusic=function(n){for(var t=null,i=0;i<this.musicCaches.length;++i){var a=this.musicCaches[i];a.getName()===n&&(t=a)}return t},e.prototype.loadMusic=function(n,t,i){var a=this.getMusic(t);if(a)return a;var u=null;u=s.G.Ap.config.debugPlayerIdCustomMusic?null:n?n.getMusicCells():null,!s.G.Ap.config.debugPlayerIdCustomMusic&&n&&(r.LevelMgr.Ins().intMusicCells(n),u=n.getMusicCells());var c=new d.MusicParserParam;if(u)for(var p=0;p<u.size();++p){var h=u.get(p+1);h&&(c.bpm.push(h.BPM),c.basebeats.push(h.baseBeats))}return(a=d.default.parseJson(t,i,c,s.G.Ap.sound.getInstrumentFactory()))&&(this.musicCaches=[],this.musicCaches.push(a)),a},e}();m.default=o,cc._RF.pop()},{"../base/G":"G","../business/Logic/LevelMgr":"LevelMgr","./MusicParser":"MusicParser"}],MusicContext:[function(l,P,m){"use strict";cc._RF.push(P,"b024aCQdz1L4bP8tGiJ3DFw","MusicContext"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Adapter/QQMusicContext"),s=l("./Adapter/WXMusicContext"),r=function(){function o(e,n){this.mIMusicContext=null,cc.sys.platform==cc.sys.QQ_PLAY?this.mIMusicContext=new d.default(e,n):cc.sys.platform===cc.sys.WECHAT_GAME&&(this.mIMusicContext=new s.default(e))}return o.prototype.getIndex=function(){return this.mIMusicContext.getIndex()},o.prototype.getPath=function(){return this.mIMusicContext.getPath()},o.prototype.play=function(){this.mIMusicContext.play()},o.prototype.playA=function(e,n){this.mIMusicContext.playA(e,n)},o.prototype.playB=function(e,n){this.mIMusicContext.playB(e,n)},o.prototype.stop=function(){this.mIMusicContext.stop()},o.prototype.pause=function(){this.mIMusicContext.pause()},o.prototype.seek=function(e){this.mIMusicContext.seek(e)},o.prototype.getTimeStamp=function(){return this.mIMusicContext.getTimeStamp()},o.prototype.isEnded=function(){return this.mIMusicContext.isEnded()},o}();m.default=r,cc._RF.pop()},{"./Adapter/QQMusicContext":"QQMusicContext","./Adapter/WXMusicContext":"WXMusicContext"}],MusicDefines:[function(l,P,m){"use strict";cc._RF.push(P,"410b9aXKcROAohCdQJ4Q5LX","MusicDefines"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r,o,e=l("../util/runtime/ClassType"),n=function(){function g(){}return g.durationStart="[",g.durationEnd="]",g.groupStart="<",g.groupEnd=">",g.mixingStart="(",g.mixingEnd=")",g}();m.FORMATSYMBOL=n,(s=d=m.MUSICMARK||(m.MUSICMARK={}))[s.None=0]="None",s[s.Normal=1]="Normal",s[s.LongPress=2]="LongPress",s[s.Craze=3]="Craze",s[s.DoubleBlack=5]="DoubleBlack",s[s.Accompaniment=6]="Accompaniment",s[s.TiltAccompaniment=7]="TiltAccompaniment",s[s.FixedTiltAccompaniment=8]="FixedTiltAccompaniment",s[s.StopMark=1024]="StopMark",(o=r=m.SYLLABLEPLAYMETHOD||(m.SYLLABLEPLAYMETHOD={}))[o.StopMark=1]="StopMark",o[o.Simple=2]="Simple",o[o.Chord=4]="Chord",o[o.Arpeggio=8]="Arpeggio",o[o.Legato=16]="Legato",o[o.Staccato=32]="Staccato",o[o.Wave=64]="Wave",o[o.Trill=128]="Trill",o[o.Echo=256]="Echo",o[o.LAppoggiatura=512]="LAppoggiatura",o[o.SAppoggiatura=1024]="SAppoggiatura";var t=function(){function g(){}return g.contents=[{form:"1<",mark:d.None},{form:"2<",mark:d.LongPress},{form:"3<",mark:d.Craze},{form:"5<",mark:d.DoubleBlack},{form:"6<",mark:d.Accompaniment},{form:"7<",mark:d.TiltAccompaniment},{form:"8<",mark:d.FixedTiltAccompaniment}],g}();m.GROUPFORM=t;var i=function(){function g(){}return g.contents=[{form:"Q",time:256},{form:"R",time:128},{form:"S",time:64},{form:"T",time:32},{form:"U",time:16},{form:"V",time:8},{form:"W",time:4},{form:"X",time:2},{form:"Y",time:1}],g}();m.STOPFORM=i;var a=function(){function g(){}return g.contents=[{form:"H",time:256},{form:"I",time:128},{form:"J",time:64},{form:"K",time:32},{form:"L",time:16},{form:"M",time:8},{form:"N",time:4},{form:"O",time:2},{form:"P",time:1}],g}();m.DURATIONFORM=a;var u=function(){function g(){}return g.content=".~@&^$%!",g.reloveMethods=[r.Chord,r.Legato,r.Arpeggio,r.Wave,r.Trill,r.Echo,r.LAppoggiatura,r.SAppoggiatura],g}();m.BEATSPLIT=u;var c=function(){this.time=0,this.isBass=!1};m.AccompanyDelay=c;var p,h,f=function(){function g(){}return g.contents=["A-3","#A-3","B-3","C-2","#C-2","D-2","#D-2","E-2","F-2","#F-2","G-2","#G-2","A-2","#A-2","B-2","C-1","#C-1","D-1","#D-1","E-1","F-1","#F-1","G-1","#G-1","A-1","#A-1","B-1","c","#c","d","#d","e","f","#f","g","#g","a","#a","b","c1","#c1","d1","#d1","e1","f1","#f1","g1","#g1","a1","#a1","b1","c2","#c2","d2","#d2","e2","f2","#f2","g2","#g2","a2","#a2","b2","c3","#c3","d3","#d3","e3","f3","#f3","g3","#g3","a3","#a3","b3","c4","#c4","d4","#d4","e4","f4","#f4","g4","#g4","a4","#a4","b4","c5","mute"],g}();m.BEATNAMES=f,(h=p=m.INTENSITY_TYPE||(m.INTENSITY_TYPE={}))[h.LOW=0]="LOW",h[h.MIDDLE=1]="MIDDLE",h[h.HIGH=2]="HIGH",e.Type.setMetadata(p,{LOW:{description:"piano_low"},MIDDLE:{description:"piano"},HIGH:{description:"piano_high"}}),cc._RF.pop()},{"../util/runtime/ClassType":"ClassType"}],MusicDownLoadPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"edb15gNkZRNBbiBnVjfDYe7","MusicDownLoadPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("./MusicDownloadProcess"),r=l("./MusicDownloadHandler"),o=cc._decorator,e=o.ccclass,n=o.property,t=function(i){function a(){var u=i!==null&&i.apply(this,arguments)||this;return u.downloadLabel=null,u.cancelBtn=null,u.progressbar=null,u.unZiping=null,u}return __extends(a,i),a.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(u){u.stopPropagation()}),this.initEvent()},a.prototype.start=function(){this.getComponent(cc.Animation).play("dowanloading_popup")},a.prototype.initEvent=function(){var u=this,c=new d.default(function(){u.cancelClick()});this.cancelBtn.node.on(cc.Node.EventType.TOUCH_END,c.click,c)},a.prototype.cancelClick=function(){this.cancelCallback&&this.cancelCallback()},a.prototype.setCancelCallback=function(u){this.cancelCallback=u},a.prototype.setSuccessCallback=function(u){this.successCallback=u},a.prototype.setFailCallback=function(u){this.failCallback=u},a.prototype.update=function(u){var c=s.MusicDownloadProcess.Ins(),p=c.getProcess(),h=c.getDownloadStatus();this.progressbar&&0<=p&&(this.progressbar.progress=p),this.downloadLabel.string="\u6B63\u5728\u66F4\u65B0\u94A2\u7434\u8D44\u6E90..."+Math.round(100*p)+"%",h===r.DOWNLOAD_STATUS.Success?(!this.unZiping&&c.unZipFile(),this.unZiping=!0,1<=p&&this.successCallback()):h===r.DOWNLOAD_STATUS.Downloading||h===r.DOWNLOAD_STATUS.Fail&&this.failCallback()},__decorate([n(cc.Label)],a.prototype,"downloadLabel",void 0),__decorate([n(cc.Button)],a.prototype,"cancelBtn",void 0),__decorate([n(cc.ProgressBar)],a.prototype,"progressbar",void 0),a=__decorate([e],a)}(cc.Component);m.default=t,cc._RF.pop()},{"../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","./MusicDownloadHandler":"MusicDownloadHandler","./MusicDownloadProcess":"MusicDownloadProcess"}],MusicDownloadHandler:[function(l,P,m){"use strict";cc._RF.push(P,"49992ceXVdITbpop6VIr+cc","MusicDownloadHandler"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../../gamescene/services/ServiceProvider"),o=l("../../gamescene/workers/WorkerState"),e=l("./MusicDownloadWorker"),n=l("../../util/PU"),t=l("../Network/Protocol/StorageUtil"),i=l("../../config/LSKey"),a=l("../../LogicPlatform/PlatformProxy"),u=l("../../base/Log");(s=d=m.DOWNLOAD_STATUS||(m.DOWNLOAD_STATUS={}))[s.Success=0]="Success",s[s.Fail=1]="Fail",s[s.Other=2]="Other",s[s.Downloading=3]="Downloading";var c=function(){function p(){this.musicDownloadProvider=new r.ServiceProvider,this.musicDownloadWorker=null,this.process=0,this.downloadStatus=null,this.manager=null,this.musicBean=null,this.musicPianoPath=null,this.needUpdate=null,this.musicPianoExist=null}return p.prototype.startMusicDownload=function(){var h=this;(!this.musicDownloadWorker||this.musicDownloadWorker.state!==o.WorkerState.running)&&(this.musicDownloadProvider.register("MusicDownloadWorker",new e.default),this.musicDownloadWorker=this.musicDownloadProvider.resolve("MusicDownloadWorker"),this.musicDownloadWorker.canPauseAndContinue=!0,this.musicDownloadWorker.start(this,function(f){(h.downloadStatus=f)===d.Fail&&h.stopMusicDownload()}))},p.prototype.stopMusicDownload=function(){this.musicDownloadWorker&&this.musicDownloadWorker.stop()},p.prototype.isDownloadWorking=function(){return this.musicDownloadWorker&&this.musicDownloadWorker.state===o.WorkerState.running},p.prototype.checkMusicPianoExist=function(h){var f=this;try{if(cc.sys.isBrowser)return;this.isMusicPianoExist("/piano_high/a",function(g){f.isMusicPianoExist("/piano_low/a",function(_){f.musicPianoExist=g&&_,h&&h(f.musicPianoExist),u.default.l("--- checkMusicPianoExist this.musicPianoExist ---"+f.musicPianoExist)})})}catch(g){this.musicPianoExist=!1,h&&h(!1),u.default.l("--- checkMusicPianoExist err ---"+g)}},p.prototype.isMusicPianoExist=function(h,f){if(h){var g=n.default.getResourcePath("resources/music"+h+".mp3");try{a.default.Ins().getFileSystemManager().access({path:g,success:function(_){u.default.i("--- isMusicPianoExist success result ---"+_),f(!!_)},fail:function(_){u.default.i("--- isMusicPianoExist false ---"),f(!1)}})}catch(_){u.default.w("--- isMusicPianoExist err ---"+_),f(!1)}}else f(!1)},p.prototype.isUnzipFileExist=function(h,f){h===void 0&&(h="");try{if(!h||h==="")return void f(!1);a.default.Ins().getFileSystemManager().access({path:h,success:function(g){f(!!g),u.default.w("--- isUnzipFileExist success result ---")},fail:function(g){f(!1),u.default.w("--- isUnzipFileExist fail false ---")}})}catch(g){u.default.w("--- isUnzipFileExist err ---"+g),f(!1)}},p.prototype.unZipFile=function(){var h=this;try{if(this.musicDownloadWorker&&this.musicDownloadWorker.state!==o.WorkerState.running||!this.musicBean)return;this.manager.unZipFile(this.musicPianoPath).then(function(){u.default.w("--- \u97F3\u4E50piano\u89E3\u538B \u5B8C\u6BD5 ---"),h.unzipFileSuccess()},function(){u.default.w("--- \u97F3\u4E50piano\u89E3\u538B \u5931\u8D25 ---"),h.unzipFileFail()})}catch(f){u.default.l("--- unZipFile err---"+f),this.unzipFileFail()}},p.prototype.unzipFileSuccess=function(){this.stopMusicDownload(),this.setNeedUpdateToCache("false"),this.musicPianoExist=!0,this.downloadStatus=d.Success},p.prototype.unzipFileFail=function(){var h=this;this.checkMusicPianoExist(function(f){h.stopMusicDownload(),h.setNeedUpdateToCache("false"),h.downloadStatus=d.Fail})},p.prototype.setManager=function(h){this.manager=h},p.prototype.setMusicBean=function(h){this.musicBean=h},p.prototype.setMusicPianoPath=function(h){this.musicPianoPath=h},p.prototype.setProcess=function(h){this.process=h},p.prototype.setNeedUpdate=function(h){(this.needUpdate=h)&&this.setNeedUpdateToCache("true")},p.prototype.setNeedUpdateToCache=function(h){t.default.save(i.default.MUSIC_PIANO_NEED_UPDATE,h)},p.prototype.getNeedUpdate=function(){return this.needUpdate},p.prototype.getNeedUpdateFromCache=function(){return t.default.read(i.default.MUSIC_PIANO_NEED_UPDATE,"false")==="true"},p.prototype.getProcess=function(){return this.process},p.prototype.getDownloadStatus=function(){return this.downloadStatus},p.prototype.getIsMusicPianoExist=function(){return this.musicPianoExist},p}();m.MusicDownloadHandler=c,cc._RF.pop()},{"../../LogicPlatform/PlatformProxy":"PlatformProxy","../../base/Log":"Log","../../config/LSKey":"LSKey","../../gamescene/services/ServiceProvider":"ServiceProvider","../../gamescene/workers/WorkerState":"WorkerState","../../util/PU":"PU","../Network/Protocol/StorageUtil":"StorageUtil","./MusicDownloadWorker":"MusicDownloadWorker"}],MusicDownloadProcess:[function(l,P,m){"use strict";cc._RF.push(P,"96dcc0qOsRLCJE0f5w5kic6","MusicDownloadProcess"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicDownloadHandler"),s=l("./MusicDownLoadPrefab"),r=l("../UI/GameEntraScene/ToastPrefab"),o=l("../../gamescene/GameSceneSetting"),e=l("../UI/GameEntraScene/PrefabMgr"),n=function(){function t(){this.musicDownloadHandler=null,this.mList=[],this.isLoading=!1,this.musicDownloadHandler=new d.MusicDownloadHandler,this.musicDownloadHandler.checkMusicPianoExist()}return t.Ins=function(){return this.mInstance||(this.mInstance=new t),this.mInstance},t.prototype.updateMusicPiano=function(){var i=o.default.getInstance().getFromSource();cc.sys.isBrowser||this.musicDownloadHandler.isDownloadWorking()||i===o.FromSource.SOURCE_GUIDE||this.musicDownloadHandler.startMusicDownload()},t.prototype.invokeDownloadCb=function(i){for(;this.mList&&0<this.mList.length;){var a=this.mList.pop();a&&a(i)}this.isLoading=!1},t.prototype.showMusicDownloadingPopup=function(i,a){var u=this;if(this.mList.push(a),!this.isLoading){this.isLoading=!0;try{var c=o.default.getInstance().getFromSource(),p=this.musicDownloadHandler.getNeedUpdate(),h=this.musicDownloadHandler.getNeedUpdateFromCache(),f=this.musicDownloadHandler.getIsMusicPianoExist(),g=cc.sys.isBrowser;(p||h||!f)&&!g&&c!==o.FromSource.SOURCE_GUIDE&&c!=o.FromSource.SOURCE_RESULT_UPGRADE?e.default.load("prefab/musicdownload/MusicDownLoading",function(_,y){var S=y.getComponent(s.default);S.setCancelCallback(function(){y.destroy(),u.musicDownloadHandler.stopMusicDownload(),u.invokeDownloadCb(!0)}),S.setSuccessCallback(function(){y.destroy(),u.invokeDownloadCb(!0)}),S.setFailCallback(function(){y.destroy(),u.invokeDownloadCb(!0)}),i.addChild(y),console.log("--- showMusicDownloadingPopup loadRes success ---")}):this.invokeDownloadCb(!0)}catch(_){console.log("--- showMusicDownloadingPopup err ---"+_),this.invokeDownloadCb(!0)}}},t.prototype.showToast=function(i,a){e.default.load("prefab/ToastPrefab",function(u,c){c.getComponent(r.default).showTips(i,function(){c.destroy()}),a.addChild(c)})},t.prototype.unZipFile=function(){this.musicDownloadHandler.isDownloadWorking()&&this.musicDownloadHandler.unZipFile()},t.prototype.isMusicPianoExist=function(){if(this.musicDownloadHandler)return this.musicDownloadHandler.getIsMusicPianoExist()},t.prototype.getProcess=function(){return this.musicDownloadHandler.getProcess()},t.prototype.getDownloadStatus=function(){return this.musicDownloadHandler.getDownloadStatus()},t}();m.MusicDownloadProcess=n,cc._RF.pop()},{"../../gamescene/GameSceneSetting":"GameSceneSetting","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","./MusicDownLoadPrefab":"MusicDownLoadPrefab","./MusicDownloadHandler":"MusicDownloadHandler"}],MusicDownloadWorker:[function(l,P,m){"use strict";cc._RF.push(P,"25cbewqyFZI+YNvsBvBjYSX","MusicDownloadWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../gamescene/workers/WorkerBase"),s=l("./MusicDownloadHandler"),r=l("../../upgrade/CloudResMgr"),o=l("../../config/LSKey"),e=l("../Logic/NotifyEvent"),n=l("../Logic/EventBus"),t=l("../../upgrade/Downloader"),i=l("../Network/Protocol/StorageUtil"),a=function(u){function c(){var p=u.call(this,"MusicDownloadWorker")||this;return p.musicDownloadHandler=null,p.workCallback=null,p.manager=null,p.musicBean=null,p.CLOUD_MUSIC_PIANO_URL="https://piano-weixin-game.cmcm.com/pianotiles2/cfg/musicpiano/music_config.json",p}return __extends(c,u),c.prototype.init=function(p,h){this.musicDownloadHandler=p,this.workCallback=h},c.prototype.onStart=function(){for(var p=[],h=0;h<arguments.length;h++)p[h]=arguments[h];try{if(p&&p.length<=0)return;console.log("--- onStart ---"+new Date().valueOf());var f=p[0],g=p[1];this.init(f,g),this.musicPianoWork()}catch(_){console.log("--- MusicDownloadWorker onStart err:---"+_)}},c.prototype.onStop=function(){for(var p=[],h=0;h<arguments.length;h++)p[h]=arguments[h];try{return this.musicDownloadHandler.setProcess(1),this.cancelMusicPianoWork(),this.reset(),void console.log("--- onStop ---"+new Date().valueOf())}catch(f){console.log("--- MusicDownloadWorker onStop err:---"+f)}},c.prototype.musicPianoWork=function(){this.manager=new r.CloudResMgr("MusicPiano",o.default.MUSIC_PIANO,this.CLOUD_MUSIC_PIANO_URL),this.manager.request(this.successCallback.bind(this),this.failCallback.bind(this)),n.default.register(e.default.LOADING_DOWNLOAD,this.downloadProcess,this),this.musicDownloadHandler.setManager(this.manager)},c.prototype.cancelMusicPianoWork=function(){this.musicBean&&t.default.Ins().cancelDownload(this.musicBean)},c.prototype.downloadProcess=function(p,h){if(h&&2<=h.length&&h[1]&&0<=h[1]&&h[1]<=1){var f=Math.min(h[1],.99);this.musicDownloadHandler.setProcess(f),f===1&&console.log(new Date().valueOf())}},c.prototype.successCallback=function(){var p=this;if(this.manager)try{var h=this.manager,f=h.getData(),g=i.default.read(o.default.MUSIC_PIANO_ZIP_PATH,"")||"";this.musicDownloadHandler.isUnzipFileExist(g,function(_){if(p.musicDownloadHandler.setMusicPianoPath(g),f&&0<f.length){var y=f.filter(function(I){return I.type==="music_piano"&&I.key==="music_config"});if(y&&0<y.length&&y[0]){p.musicBean=y[0];var S=p.musicBean.isNeedUpdate()||!_;console.warn("--- successCallback needUpdate---"+S),p.musicDownloadHandler.setMusicBean(p.musicBean),p.musicDownloadHandler.setNeedUpdate(S),p.musicBean&&S?(h.download(p.musicBean,!0).then(function(I){console.warn("--- \u97F3\u4E50piano\u66F4\u65B0\u5B8C\u6BD5 path: ---"+I),p.musicBean.localMd5=p.musicBean.md5,p.musicBean.localVer=p.musicBean.serverVer,h.saveData(),i.default.save(o.default.MUSIC_PIANO_ZIP_PATH,I),p.musicDownloadHandler.setMusicPianoPath(I),p.workCallback&&p.workCallback(s.DOWNLOAD_STATUS.Success)}),p.workCallback&&p.workCallback(s.DOWNLOAD_STATUS.Downloading)):(p.musicDownloadHandler.setProcess(.99),p.workCallback&&p.workCallback(s.DOWNLOAD_STATUS.Success))}}})}catch(_){console.log("---MusicDownloadWorker successCallback err---"+_)}},c.prototype.failCallback=function(){console.warn("\u97F3\u4E50piano\u66F4\u65B0\u5931\u8D25"),this.workCallback&&this.workCallback(s.DOWNLOAD_STATUS.Fail)},c.prototype.onStateChanged=function(p){},c.prototype.reset=function(){this.musicDownloadHandler=null,this.workCallback=null,this.manager=null,this.musicBean=null,n.default.remove(e.default.LOADING_DOWNLOAD,this.downloadProcess,this)},c.prototype.onPause=function(){console.log("--- MusicDownloadWorker onPause---")},c.prototype.onResume=function(){console.log("--- MusicDownloadWorker onResume---")},c}(d.WorkerBase);m.default=a,cc._RF.pop()},{"../../config/LSKey":"LSKey","../../gamescene/workers/WorkerBase":"WorkerBase","../../upgrade/CloudResMgr":"CloudResMgr","../../upgrade/Downloader":"Downloader","../Logic/EventBus":"EventBus","../Logic/NotifyEvent":"NotifyEvent","../Network/Protocol/StorageUtil":"StorageUtil","./MusicDownloadHandler":"MusicDownloadHandler"}],MusicInstrument:[function(l,P,m){"use strict";cc._RF.push(P,"20e2c4sz/NNkZj3u0d6gsT0","MusicInstrument"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicBeat"),s=l("./MusicDefines"),r=l("../util/PU"),o=function(){function e(n){this.beats=[],this.name="",this.name=n}return e.prototype.getBeat=function(n){for(var t=0;t<this.beats.length;++t)if(n==this.beats[t].beatName)return this.beats[t];return null},e.prototype.makeUp=function(){this.beats=[];for(var n=0;n<s.BEATNAMES.contents.length;++n)(t=new d.default).beatName=s.BEATNAMES.contents[n],t.fileName="resources/music/"+this.name+"/"+s.BEATNAMES.contents[n]+".mp3",t.fileName=t.fileName.replace("#","-35-"),t.realPath=t.fileName,t.isStopMark=!1,t.audioId=n,this.beats.push(t);for(n=0;n<s.STOPFORM.contents.length;++n){var t;(t=new d.default).beatName=s.STOPFORM.contents[n].form,t.fileName="resources/music/"+this.name+"/"+s.STOPFORM.contents[n].form+".mp3",t.isStopMark=!0,this.beats.push(t)}this.resetMusicRealPath()},e.prototype.resetMusicRealPath=function(){for(var n=0,t=this.beats;n<t.length;n++){var i=t[n],a=r.default.getResourcePath(i.fileName);i.realPath=a}},e.prototype.isName=function(n){return this.name===n},e}();m.default=o,cc._RF.pop()},{"../util/PU":"PU","./MusicBeat":"MusicBeat","./MusicDefines":"MusicDefines"}],MusicJsonData:[function(l,P,m){"use strict";cc._RF.push(P,"c1a5eIuTkdOtLrSDeSerpOG","MusicJsonData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findMusic=function(n){return this.find("Id",n)},e.prototype.findMusicByRowID=function(n){if(-1<n&&n<this.mRowArr.length){var t=new r;return t.mRowData=this.mRowArr[n],t.mCsvFile=this,t}return null},e.prototype.findMusicBiany=function(n){var t=this.csvFindRowBiany("Id",n);if(t){var i=new r;return i.mRowData=t,i.mCsvFile=this,i}return this.findMusic(n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.MusicJsonData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("Id")},e.prototype.getMid=function(){return this.getInt("Mid")},e.prototype.getBPM=function(){return this.getInt("BPM")},e.prototype.getMusicJson=function(){return this.getString("MusicJson")},e.prototype.getAniID=function(){return this.getInt("AniID")},e.prototype.getBridgeAniID=function(){return this.getInt("BridgeAniID")},e.prototype.getMusician=function(){return this.getString("Musician")},e.prototype.getAcceleration=function(){return this.getFloat("Acceleration")},e}(d.default);m.MusicJsonRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],MusicKeyData:[function(l,P,m){"use strict";cc._RF.push(P,"6de53fgUlZD8JVbGN0DVssA","MusicKeyData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findMusicByMid=function(n){return this.find("Mid",n)},e.prototype.getAllMusic=function(){return this.getAllDB()},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.MusicKeyData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getKid=function(){return this.getInt("Kid")},e.prototype.getMid=function(){return this.getInt("Mid")},e}(d.default);m.MusicKeyRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],MusicLevelDataLoader:[function(l,P,m){"use strict";cc._RF.push(P,"c479armrDBLMouYDgCESns7","MusicLevelDataLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/ActivityManager"),s=l("../Logic/Level"),r=l("../Logic/LevelMgr"),o=l("../Core/GameDefine"),e=l("../DB/DBMgr"),n=l("../Logic/PlayerMgr"),t=l("../Logic/LangMgr"),i=l("../../util/Dictionary"),a=l("../../base/Log"),u=l("./HotmusicActivityMgr"),c=l("../../util/PU"),p=function(){function g(){}return g.preload=function(){var _=g.getMusicLevelId(),y=1;_.forEach(function(v){g.mIndexMap.put(v,y++)});var S=d.default.getInstance().getChoicenessLevels(),I=1;S.forEach(function(v){g.mIndexMap.put(v,I++)})},g.getIndex=function(_){return g.sPreloadIndexMap||(g.preload(),g.sPreloadIndexMap=!0),this.mIndexMap.get(_)},g.getConsumeData=function(_){if(_==null||_==null)return null;var y=e.default.Ins().getDBRow(e.eDataBase.eDB_LevelConsume,_+""),S=null;if(y){var I=y;I&&((S=new f).id=I.getID(),S.mid=I.getMid(),S.spendType=I.getSpendType(),S.spendEnergy=I.getSpendEnergy(),S.spendGold=I.getSpendGold(),S.spendDiamond=I.getSpendDiamond(),S.testType=I.getTestType(),S.testEnergy=I.getTestEnergy(),S.testGold=I.getTestGold(),S.testDiamond=I.getTestDiamond(),S.unlockActive=I.getUnlockActive()==1,S.activeBeginTime=I.getActiveBeginTime(),S.activeEndTime=I.getActiveEndTime(),S.unlockCount=I.getUnlockCount(),S.isNew=I.getIsNew()==1,S.backgroundImg=I.getBackgroundImg())}return S},g.getItemInfoById=function(_){var y=r.LevelMgr.Ins().getLevel(_);if(!y)return null;var S=n.default.Ins().getLevelRecordByMid(y.music.mid),I=new h,v=g.getConsumeData(y.music.mid);if(I.id=y.id,I.level=y.needLv,I.unlockType=y.levelUnlock,I.isLocked=!S||S.isRecordLocked(),I.musicId=y.music.mid,I.index=g.getIndex(y.id),I.bestScore=S?S.mBestScore:0,I.mGameComsume=v,I.musicName=t.default.gIns().getLanguageByKey(y.music.musicName),I.musician=t.default.gIns().getLanguageByKey(y.music.musician),I.bestStar=S?S.mBestStar:0,I.unlockType.unlockType==s.eUnlockType.UNLOCK_TYPE_LV_TRY){I.isCrownLock=!0;var C=r.LevelMgr.Ins().getLevelInfo(y.id);I.needStarNum=C.m_needCrown,I.needCrownNum=C.m_needCrown2;var T=g.getTotalCrownByLv(y.needLv);I.curTotalStarNum=T.star,I.curTotalCrownNum=T.crown}return I},g.getItemInfoByMid=function(_){for(var y=d.default.getInstance().getAllLevels(),S=0;S<y.length;++S){var I=g.getItemInfoById(y[S]);if(I&&I.musicId===_)return I}return a.default.e("[MusicLevelDataLoader.getItemInfoToMid] item is null"),null},g.getAllItemInfo=function(){for(var _=g.getMusicLevelId(),y=[],S=0;S<_.length;++S){var I=g.getItemInfoById(_[S]);I&&y.push(I)}return y},g.getNormalMusicUnlockInfo=function(_){if(_!=null){for(var y=g.getAllItemInfo(),S=0,I=y.length,v=0;v<y.length;++v){var C=y[v];C&&!C.isLocked&&S++}_(S,I)}},g.getMusicLevelId=function(){var _=[];return d.default.getInstance().getShowLevels().forEach(function(y){var S=r.LevelMgr.Ins().getLevel(y);g.isLvUnLockMusic(S)&&_.push(y)}),_},g.getNewSongCountInChoiceness=function(){var _=g.getChoicenessAllItemInfo(),y=0;if(_)for(var S=0;S<_.length;S++){var I=_[S];I&&I.mGameComsume&&I.mGameComsume.isNew&&y++}return y},g.getChoicenessAllItemInfo=function(){return c.default.isCM()?this.doGetChoicenessOnCMPlay():this.doGetChoicenessNormal()},g.doGetChoicenessNormal=function(){for(var _=d.default.getInstance().getChoicenessLevels(),y=[],S=function(C){var T=g.getItemInfoById(_[C]);if(T){if(0<I.mIgnoreMusicArray.filter(function(E){return E==T.musicId}).length&&T.isLocked)return"continue";y.push(T)}},I=this,v=0;v<_.length;++v)S(v);return y},g.doGetChoicenessOnCMPlay=function(){for(var _=d.default.getInstance().getChoicenessLevels(),y=[],S=u.default.Ins().getTodayActivityMusic(),I=[],v=function(E){var A=g.getItemInfoById(_[E]);if(A){if(0<C.mIgnoreMusicArray.filter(function(k){return k==A.musicId}).length&&A.isLocked)return"continue";var M=S.find(function(k,D,L){return k&&k.mid==A.musicId});M&&A.mGameComsume?(A.mGameComsume.activeBeginTime=M.start,A.mGameComsume.activeEndTime=M.end,A.mGameComsume.unlockActive=!0,I.push(A)):(A.mGameComsume&&(A.mGameComsume.unlockActive=!1),y.push(A))}},C=this,T=0;T<_.length;++T)v(T);return I=I.sort(function(E,A){return S.findIndex(function(M){return M.mid==E.musicId})-S.findIndex(function(M){return M.mid==A.musicId})}),y=I.concat(y)},g.getNewChoiceness=function(_){_===void 0&&(_=3);var y=g.getChoicenessAllItemInfo(),S=[];if(y)for(var I=0;I<y.length;I++){var v=y[I];if(v&&v.mGameComsume&&v.mGameComsume.isNew&&(S.push(v),S.length>=_))break}return S},g.getValidActiveInfo=function(_,y){y===void 0&&(y=3),y<=0&&(y=3);var S=g.getChoicenessAllItemInfo(),I=[];if(S)for(var v=0;v<S.length;v++){var C=S[v];if(C&&C.mGameComsume&&C.mGameComsume.isActive(_)&&(I.push(C),I.length>=y))break}return I},g.getMusicLevel=function(){var _=[];return d.default.getInstance().getShowLevels().forEach(function(y){var S=r.LevelMgr.Ins().getLevel(y);g.isLvUnLockMusic(S)&&_.push(S)}),_},g.getAllMusiclLevels=function(){var _=[];return d.default.getInstance().getAllLevels().forEach(function(y){var S=r.LevelMgr.Ins().getLevel(y);S&&_.push(S)}),_},g.getMusicLevelsByLv=function(_){var y=[];return r.LevelMgr.Ins().getLevelByNeedLv(_).forEach(function(S){g.isLvUnLockMusic(S)&&y.push(S)}),y},g.getHomePageItemInfo=function(){var _,y=new h,S=n.default.Ins(),I=S.getUserLevel(),v=r.LevelMgr.Ins().getLevelByNeedLv(I),C=0,T=null;return v&&v.forEach(function(E){if(g.isLvUnLockMusic(E)){var A=S.getLevelRecordByMid(E.music.mid);A&&!A.isRecordLocked()&&(T?A.mBestScore<C&&(C=A.mBestScore,T=A,_=E):(C=A.mBestScore,T=A,_=E))}}),T||(a.default.e("[MusicLevelDataLoader] getHomePageItemInfo find minLevelRecord error"),_=r.LevelMgr.Ins().getLevel(1),T=S.getLevelRecordByMid(_.music.mid)),g.setItemInfo(y,_,T),y},g.setItemInfo=function(_,y,S){_.id=y.id,_.level=y.needLv,_.unlockType=y.levelUnlock,_.musicId=y.music.mid,_.index=g.getIndex(y.id),_.musicName=t.default.gIns().getLanguageByKey(y.music.musicName),_.musician=t.default.gIns().getLanguageByKey(y.music.musician),S&&(_.isLocked=S.isRecordLocked(),_.bestStar=S.mBestStar)},g.getItemInfoByNeedLv=function(_){var y=[];return r.LevelMgr.Ins().getLevelByNeedLv(_).forEach(function(S){if(g.isLvUnLockMusic(S)){var I=g.getItemInfoById(S.id);y.push(I)}}),y},g.isLvUnLockMusic=function(_){return!(!_||_.type!=s.eLevelKind.eLevel_Normal||_.levelUnlock.unlockType!=s.eUnlockType.UNLOCK_TYPE_LV&&_.levelUnlock.unlockType!=s.eUnlockType.UNLOCK_TYPE_LV_TRY||!(_.id<o.Constant.DIAMONDSONG_STARTID))},g.isLastLv=function(_){return e.default.Ins().getDBRow(e.eDataBase.eDB_Lv,_+"").getExp()==-1},g.getNextLvGold=function(_){var y=_+1,S=e.default.Ins().getDBRow(e.eDataBase.eDB_Lv,y+"");return S?S.getRewarGold():0},g.getNextLvUnLockMusic=function(_){var y=_+1,S=[];return r.LevelMgr.Ins().getLevelByNeedLv(y).forEach(function(I){if(g.isLvUnLockMusic(I)&&I.levelUnlock.unlockType!=s.eUnlockType.UNLOCK_TYPE_LV_TRY){var v=new h;g.setItemInfo(v,I),S.push(v)}}),S},g.getNextLevel=function(_){for(var y=null,S=!1,I=d.default.getInstance().getShowLevels(),v=0;v<I.length;++v)if(S||_!=I[v]){if(S){var C=r.LevelMgr.Ins().getLevel(I[v]);if(g.isLvUnLockMusic(C)){y=C;break}}}else S=!0;return y},g.getTotalCrownByLv=function(_){var y=g.getMusicLevelsByLv(_),S=0,I=0;return y.forEach(function(v){if(v.levelUnlock.unlockType==s.eUnlockType.UNLOCK_TYPE_LV){var C=n.default.Ins().getLevelRecord(v.id);C&&!C.isRecordLocked()&&(3<C.mBestStar?(S+=3,I+=C.mBestStar-3):S+=C.mBestStar)}}),{star:S,crown:I}},g.getUnlockItemInfo=function(){for(var _=g.getMusicLevelId(),y=[],S=0;S<_.length;++S){var I=g.getItemInfoById(_[S]);I&&!I.isLocked&&y.push(I)}return y},g.mIndexMap=new i.Dictionary,g.sPreloadIndexMap=!1,g.mIgnoreMusicArray=[400009,400028,400020,400026,400027],g}();m.MusicLevelDataLoader=p;var h=function(){this.id=0,this.level=0,this.index=0,this.isLocked=!1,this.isCrownLock=!1,this.needStarNum=0,this.needCrownNum=0,this.curTotalStarNum=0,this.curTotalCrownNum=0,this.bestScore=0,this.musicId=0,this.musicName="",this.musician="",this.bestStar=0,this.mGameComsume=null};m.ItemInfo=h;var f=function(){function g(){this.id=0,this.mid=0,this.spendType=g.SPENDTYPE_DEFAULT,this.spendEnergy=0,this.spendGold=0,this.spendDiamond=0,this.testType=g.TESTTYPE_DEFAULT,this.testEnergy=0,this.testGold=0,this.testDiamond=0,this.unlockActive=!1,this.activeBeginTime=0,this.activeEndTime=0,this.unlockCount=0,this.isNew=!1,this.backgroundImg=""}return g.prototype.isActive=function(_){return!!c.default.isCM()||!!this.unlockActive&&this.activeBeginTime<=_&&_<this.activeEndTime},g.prototype.isPlayConsumeGameProps=function(){return this.spendType==g.SPENDTYPE_ENERGY||this.spendType==g.SPENDTYPE_GOLD||this.spendType==g.SPENDTYPE_DIAMOND},g.prototype.isTestConsumeGameProps=function(){return this.testType==g.TESTTYPE_ENERGY||this.testType==g.TESTTYPE_GOLD||this.testType==g.TESTTYPE_DIAMOND},g.SPENDTYPE_DEFAULT=0,g.SPENDTYPE_ENERGY=3,g.SPENDTYPE_GOLD=4,g.SPENDTYPE_DIAMOND=5,g.TESTTYPE_ENERGY=3,g.TESTTYPE_GOLD=4,g.TESTTYPE_DIAMOND=5,g.TESTTYPE_DEFAULT=0,g}();m.GameConsume=f,cc._RF.pop()},{"../../base/Log":"Log","../../util/Dictionary":"Dictionary","../../util/PU":"PU","../Core/GameDefine":"GameDefine","../DB/DBMgr":"DBMgr","../Logic/ActivityManager":"ActivityManager","../Logic/LangMgr":"LangMgr","../Logic/Level":"Level","../Logic/LevelMgr":"LevelMgr","../Logic/PlayerMgr":"PlayerMgr","./HotmusicActivityMgr":"HotmusicActivityMgr"}],MusicLibraryManager:[function(l,P,m){"use strict";cc._RF.push(P,"3506abbYJhDP6uHXSw62UTP","MusicLibraryManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./HotMusicListCtrl"),s=l("../BasicTouchEvent"),r=l("./LevelMusicListCtrl"),o=l("../ImgCache"),e=l("../../../../util/SUtil"),n=l("../../../Network/Protocol/StorageUtil"),t=l("../../../../config/LSKey"),i=l("../../MusicLevelDataLoader"),a=l("./InviteUnlockMusicCountdownUtil"),u=l("../../../Logic/EventBus"),c=l("../../../Logic/NotifyEvent"),p=l("../../../../infoc/m_p2_Uaction"),h=l("../../../../util/Delay"),f=l("../../../../util/PU"),g=l("../../../keypad/KeypadNavigator"),_=cc._decorator,y=_.ccclass,S=_.property,I=function(v){function C(){var E=v!==null&&v.apply(this,arguments)||this;return E.mUnSelectBg1=null,E.mUnSelectBg2=null,E.mLevelMusicLibBtn=null,E.mHotMusicLibBtn=null,E.mRankTabBtn=null,E.mLevelMusicTabTouchCallback=null,E.mHotMusicTabTouchCallback=null,E.mRankTabTouchCallback=null,E.mBackBtnClickCallback=null,E.mToVipPageCallback=null,E.mToVipCallback=null,E.mCloseCallback=null,E.mOnLoadCallback=null,E.mLevelMusicList=null,E.mHotMusicList=null,E.mRankPageNode=null,E.mTabNode=null,E.mTabBg=null,E.mNewCountLabel=null,E.mRedSpotSprite=null,E.mBackBtn=null,E.mVipPanel=null,E.mVipUnlockNode=null,E.mVipUnlockBtn=null,E.mVipEightSaleBanner=null,E.mLevelMusicListCtrl=null,E.mHotMusicListCtrl=null,E.mDialogMgr=null,E.mPageIndex=T.NONE_INDEX,E.currHotTab=void 0,E}var T;return __extends(C,v),(T=C).prototype.onLoad=function(){var E=this;Date.now(),this.initVipBanner(),f.default.isCM()&&(this.mRankTabBtn.node.active=!1,this.mUnSelectBg2.node.active=!1),this.mTabNode.active=!1,this.initialize(),this.initEvents(),this.hideAfterLoad(),this.adaptorUI(),u.default.register(c.default.BUY_VIP_SUCCESS_NOTIFICATION,this.initVipBanner,this),u.default.register(c.default.NOTIFY_MUSIC_LIBRARY_UPDATE,this.notifyDataChange,this),h.Delay.wait(10).then(function(){cc.isValid(E.node)&&E.mOnLoadCallback&&E.mOnLoadCallback()}),h.Delay.wait(10).then(function(){cc.isValid(E.node)&&E.initVipBanner()})},C.prototype.start=function(){},C.prototype.notifyDataChange=function(E,A){var M=A[0];this.onShow(M)},C.prototype.initVipBanner=function(){var E=this;if(this.mPageIndex!=T.NONE_INDEX)if(this.mPageIndex!=T.RANK_INDEX){var A=null,M=null,k=null,D=null;this.mVipPanel.active=!1,f.default.isIOS()?this.mPageIndex==T.LEVEL_MUSIC_LIB_INDEX?(this.mVipPanel.active=!1,e.SUtil.ins().isQuanMian()?(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-106,e.SUtil.ins().toTopByPx(this.mLevelMusicList,106)):e.SUtil.ins().isLiuHai()?(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-172,e.SUtil.ins().toTopByPx(this.mLevelMusicList,172)):e.SUtil.ins().isPuTong()&&(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-106,e.SUtil.ins().toTopByPx(this.mLevelMusicList,106)),this.updateWidget(this.mLevelMusicList),this.updateChild(!1)):this.mPageIndex==T.HOT_MUSIC_LIB_INDEX&&(this.mVipPanel.active=!1,this.mHotMusicList.y=-103,e.SUtil.ins().isQuanMian()?(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-206,e.SUtil.ins().toTopByPx(this.mHotMusicList,206)):e.SUtil.ins().isLiuHai()?(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-272,e.SUtil.ins().toTopByPx(this.mHotMusicList,272)):e.SUtil.ins().isPuTong()&&(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-206,e.SUtil.ins().toTopByPx(this.mHotMusicList,206)),this.updateChild(!0),this.updateWidget(this.mHotMusicList)):this.mPageIndex==T.LEVEL_MUSIC_LIB_INDEX?(f.default.isCM()?(this.mVipPanel.active=!1,this.mLevelMusicList.getPosition().x,e.SUtil.ins().isQuanMian()?(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-106,e.SUtil.ins().toTopByPx(this.mLevelMusicList,106)):e.SUtil.ins().isLiuHai()?(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-172,e.SUtil.ins().toTopByPx(this.mLevelMusicList,172)):e.SUtil.ins().isPuTong()&&(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-106,e.SUtil.ins().toTopByPx(this.mLevelMusicList,106))):(this.mVipPanel.active=!0,this.mVipEightSaleBanner.node.active=!1,this.mVipUnlockNode.node.active=!0,M="/musiclist/vip_unlock_level_btn",k="/musiclist/vip_unlock_btn",D="/musiclist/vip_unlock_btn_press",e.SUtil.ins().isQuanMian()?(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-330,e.SUtil.ins().toTopByPx(this.mLevelMusicList,330)):e.SUtil.ins().isLiuHai()?(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-403,e.SUtil.ins().toTopByPx(this.mLevelMusicList,403),e.SUtil.ins().toTopByPx(this.mVipPanel,259)):e.SUtil.ins().isPuTong()&&(this.mLevelMusicList.height=e.SUtil.ins().mScreenHeight-330,e.SUtil.ins().toTopByPx(this.mLevelMusicList,330)),p.default.report(0,p.default.ACTION_SHOW_NORMAL_MUSIC_UNLOCK_ALL)),this.updateChild(!1),this.updateWidget(this.mLevelMusicList)):this.mPageIndex==T.HOT_MUSIC_LIB_INDEX&&(f.default.isCM()?(this.mVipPanel.active=!1,this.mHotMusicList.y=-103,e.SUtil.ins().isQuanMian()?(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-206,e.SUtil.ins().toTopByPx(this.mHotMusicList,206)):e.SUtil.ins().isLiuHai()?(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-272,e.SUtil.ins().toTopByPx(this.mHotMusicList,272)):e.SUtil.ins().isPuTong()&&(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-206,e.SUtil.ins().toTopByPx(this.mHotMusicList,206))):(this.mVipPanel.active=!0,this.mVipEightSaleBanner.node.active=!1,this.mVipUnlockNode.node.active=!0,M="/musiclist/vip_unlock_hot_btn",k="/musiclist/vip_youhui_btn",D="/musiclist/vip_youhui_btn_press",e.SUtil.ins().isQuanMian()?(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-330,e.SUtil.ins().toTopByPx(this.mHotMusicList,330)):e.SUtil.ins().isLiuHai()?(e.SUtil.ins().toTopByPx(this.mVipPanel,259),this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-403,e.SUtil.ins().toTopByPx(this.mHotMusicList,403)):e.SUtil.ins().isPuTong()&&(this.mHotMusicList.height=e.SUtil.ins().mScreenHeight-330,e.SUtil.ins().toTopByPx(this.mHotMusicList,330)),p.default.report(0,p.default.ACTION_SHOW_HOT_MUSIC_SALE_ALL)),this.updateChild(!0),this.updateWidget(this.mHotMusicList)),A!=null&&o.default.get(A,function(L,b){cc.isValid(E.node)&&(E.mVipEightSaleBanner.spriteFrame=b)}),M!=null&&o.default.get(M,function(L,b){cc.isValid(E.node)&&(E.mVipUnlockNode.spriteFrame=b)}),k&&o.default.get(k,function(L,b){cc.isValid(E.node)&&(E.mVipUnlockBtn.normalSprite=b)}),D&&o.default.get(D,function(L,b){cc.isValid(E.node)&&(E.mVipUnlockBtn.pressedSprite=b)})}else this.mVipPanel.active=!1},C.prototype.updateWidget=function(E){E.getComponent(cc.Widget).updateAlignment()},C.prototype.updateChild=function(E){var A;A=E?this.mHotMusicList.getChildByName("HotMusicScrollView"):this.mLevelMusicList.getChildByName("LevelMusicScrollView"),e.SUtil.ins().toTopByPx(A,0),e.SUtil.ins().toBottomByPx(A,0),this.updateWidget(A);var M=A.getChildByName("view");e.SUtil.ins().toTopByPx(M,0),e.SUtil.ins().toBottomByPx(M,0),this.updateWidget(M)},C.prototype.setHideAfterLoad=function(E){this.mHideAfterLoad=E},C.prototype.setCloseCallback=function(E){this.mCloseCallback=E},C.prototype.setOnLoadCallback=function(E){this.mOnLoadCallback=E},C.prototype.initEvents=function(){var E=this;this.mLevelMusicTabTouchCallback=new s.default(function(){E.changePage(T.LEVEL_MUSIC_LIB_INDEX),o.default.get("/musiclist/level_lib_tab_bg",function(A,M){cc.isValid(this.node)&&(this.mTabBg.spriteFrame=M)}.bind(E)),E.mUnSelectBg1.node.x=0}),this.mLevelMusicLibBtn.node.on(cc.Node.EventType.TOUCH_END,this.mLevelMusicTabTouchCallback.click,this.mLevelMusicTabTouchCallback),this.mBackBtnClickCallback=new s.default(function(){E.mLevelMusicListCtrl.rememberScrollPosition(),E.mHotMusicListCtrl.rememberScrollPosition(),E.mCloseCallback&&E.mCloseCallback(),E.hideNavigator()}),this.mBackBtn.node.on(cc.Node.EventType.TOUCH_END,this.mBackBtnClickCallback.click,this.mBackBtnClickCallback)},C.prototype.setToVipCallback=function(E){this.mToVipCallback=E},C.prototype.initialize=function(){if(this.mLevelMusicListCtrl=this.mLevelMusicList.getComponent(r.default),this.mHotMusicListCtrl=this.mHotMusicList.getComponent(d.default),n.default.read(t.default.HAS_SHOW_MUSIC_RED_SPOT))this.mRedSpotSprite.node.active=!1;else{var E=i.MusicLevelDataLoader.getNewSongCountInChoiceness();0<E?(this.mNewCountLabel.string=E+"",this.mRedSpotSprite.node.active=!0):this.mRedSpotSprite.node.active=!1}},C.prototype.hideRedIcon=function(){this.mRedSpotSprite.node.active=!1},C.prototype.showNavigator=function(E){if(this.currHotTab!=E){this.currHotTab=E,console.log("MusicLibraryManager::showNavigator => currHotTab: "+this.currHotTab);var A=this.currHotTab?"MusicLibraryPrefabHot":"MusicLibraryPrefabLevel";g.default.getInstance().pushDialog(this.node,A)}},C.prototype.hideNavigator=function(){if(this.currHotTab!=null){this.currHotTab=void 0,console.log("MusicLibraryManager::hideNavigator =>");var E=this.currHotTab?"MusicLibraryPrefabHot":"MusicLibraryPrefabLevel";g.default.getInstance().popDialog(this.node,E)}},C.prototype.setTabBg=function(E){(this.mPageIndex=E)==T.LEVEL_MUSIC_LIB_INDEX?(o.default.get("/musiclist/level_lib_tab_bg",function(A,M){cc.isValid(this.node)&&(this.mTabBg.spriteFrame=M)}.bind(this)),this.mUnSelectBg1.node.x=0):E==T.HOT_MUSIC_LIB_INDEX?(o.default.get("/musiclist/hot_lib_tab_bg",function(A,M){cc.isValid(this.node)&&(this.mTabBg.spriteFrame=M)}.bind(this)),this.mUnSelectBg1.node.x=-234):E==T.RANK_INDEX&&(o.default.get("/musiclist/rank_tab_bg",function(A,M){cc.isValid(this.node)&&(this.mTabBg.spriteFrame=M)}.bind(this)),this.mUnSelectBg1.node.x=0)},C.prototype.changePage=function(E){this.mPageIndex!=E&&(this.mPageIndex=E,this.mPageIndex==T.LEVEL_MUSIC_LIB_INDEX?(e.SUtil.ins().toLeftByPx(this.mLevelMusicList,0),e.SUtil.ins().toLeftByPx(this.mHotMusicList,-1e4),e.SUtil.ins().toLeftByPx(this.mRankPageNode,-1e4),this.mLevelMusicList.active=!0,this.mHotMusicList.active=!1,this.mRankPageNode.active=!1,this.mLevelMusicListCtrl.onShow(),this.mHotMusicListCtrl.onHide()):this.mPageIndex==T.HOT_MUSIC_LIB_INDEX?(e.SUtil.ins().toLeftByPx(this.mLevelMusicList,-2e4),e.SUtil.ins().toLeftByPx(this.mHotMusicList,0),e.SUtil.ins().toLeftByPx(this.mRankPageNode,-2e4),this.mLevelMusicList.active=!1,this.mHotMusicList.active=!0,this.mRankPageNode.active=!1,this.mLevelMusicListCtrl.onHide(),this.mHotMusicListCtrl.onShow(),u.default.fire(c.default.INVITE_CHECK_ACTIVITY_SONG)):this.mPageIndex==T.RANK_INDEX&&(e.SUtil.ins().toLeftByPx(this.mLevelMusicList,-2e4),e.SUtil.ins().toLeftByPx(this.mHotMusicList,-2e4),e.SUtil.ins().toLeftByPx(this.mRankPageNode,0),this.mLevelMusicList.active=!1,this.mHotMusicList.active=!1,this.mRankPageNode.active=!0,this.mLevelMusicListCtrl.onHide(),this.mHotMusicListCtrl.onHide()),this.updateWidget(this.mLevelMusicList),this.updateWidget(this.mHotMusicList),this.updateWidget(this.mRankPageNode),this.initVipBanner(),this.mPageIndex==T.LEVEL_MUSIC_LIB_INDEX?this.showNavigator(!1):this.mPageIndex==T.HOT_MUSIC_LIB_INDEX&&this.showNavigator(!0))},C.prototype.hideAfterLoad=function(){this.mLevelMusicListCtrl.hideAfterLoad=this.mHideAfterLoad,this.mHotMusicListCtrl.hideAfterLoad=this.mHideAfterLoad},C.prototype.onStart=function(){var E=this;this.mOnLoadCallback!=null&&h.Delay.wait(10).then(function(){cc.isValid(E.node)&&E.mOnLoadCallback&&(E.mOnLoadCallback(),E.mOnLoadCallback=null)})},C.prototype.onStop=function(){},C.prototype.onShow=function(E){var A=this;this.scheduleOnce(function(){A.initialize(),A.node.x=0,a.default.Ins().updateServerTime(),A.mPageIndex==T.LEVEL_MUSIC_LIB_INDEX?A.mLevelMusicListCtrl.onShow():A.mPageIndex==T.HOT_MUSIC_LIB_INDEX&&A.mHotMusicListCtrl.onShow(E)},1e-4)},C.prototype.onHide=function(){this.initialize(),this.node.x=-1e4,this.mPageIndex==T.LEVEL_MUSIC_LIB_INDEX?this.mLevelMusicListCtrl.onHide():this.mPageIndex==T.HOT_MUSIC_LIB_INDEX&&this.mHotMusicListCtrl.onHide(),this.hideNavigator()},C.prototype.adaptorUI=function(){e.SUtil.ins().isLiuHai()?(e.SUtil.ins().toTopByPx(this.mTabNode,175),e.SUtil.ins().toTopByPx(this.mBackBtn,84),e.SUtil.ins().toTopByPx(this.mRankPageNode,280)):e.SUtil.ins().isQuanMian()&&(e.SUtil.ins().toTopByPx(this.mTabNode,105),e.SUtil.ins().toTopByPx(this.mBackBtn,18))},C.prototype.setDialogMgr=function(E){this.mDialogMgr=E},C.prototype.onDestroy=function(){u.default.remove(c.default.BUY_VIP_SUCCESS_NOTIFICATION,this.initVipBanner,this),u.default.remove(c.default.NOTIFY_MUSIC_LIBRARY_UPDATE,this.notifyDataChange,this),this.hideNavigator()},C.LEVEL_MUSIC_LIB_INDEX=0,C.HOT_MUSIC_LIB_INDEX=1,C.RANK_INDEX=2,C.NONE_INDEX=-1,__decorate([S(cc.Sprite)],C.prototype,"mUnSelectBg1",void 0),__decorate([S(cc.Sprite)],C.prototype,"mUnSelectBg2",void 0),__decorate([S(cc.Label)],C.prototype,"mLevelMusicLibBtn",void 0),__decorate([S(cc.Label)],C.prototype,"mHotMusicLibBtn",void 0),__decorate([S(cc.Label)],C.prototype,"mRankTabBtn",void 0),__decorate([S(cc.Node)],C.prototype,"mLevelMusicList",void 0),__decorate([S(cc.Node)],C.prototype,"mHotMusicList",void 0),__decorate([S(cc.Node)],C.prototype,"mRankPageNode",void 0),__decorate([S(cc.Node)],C.prototype,"mTabNode",void 0),__decorate([S(cc.Sprite)],C.prototype,"mTabBg",void 0),__decorate([S(cc.Label)],C.prototype,"mNewCountLabel",void 0),__decorate([S(cc.Sprite)],C.prototype,"mRedSpotSprite",void 0),__decorate([S(cc.Button)],C.prototype,"mBackBtn",void 0),__decorate([S(cc.Node)],C.prototype,"mVipPanel",void 0),__decorate([S(cc.Sprite)],C.prototype,"mVipUnlockNode",void 0),__decorate([S(cc.Button)],C.prototype,"mVipUnlockBtn",void 0),__decorate([S(cc.Sprite)],C.prototype,"mVipEightSaleBanner",void 0),C=T=__decorate([y],C)}(cc.Component);m.default=I,cc._RF.pop()},{"../../../../config/LSKey":"LSKey","../../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../../util/Delay":"Delay","../../../../util/PU":"PU","../../../../util/SUtil":"SUtil","../../../Logic/EventBus":"EventBus","../../../Logic/NotifyEvent":"NotifyEvent","../../../Network/Protocol/StorageUtil":"StorageUtil","../../../keypad/KeypadNavigator":"KeypadNavigator","../../MusicLevelDataLoader":"MusicLevelDataLoader","../BasicTouchEvent":"BasicTouchEvent","../ImgCache":"ImgCache","./HotMusicListCtrl":"HotMusicListCtrl","./InviteUnlockMusicCountdownUtil":"InviteUnlockMusicCountdownUtil","./LevelMusicListCtrl":"LevelMusicListCtrl"}],MusicParser:[function(l,P,m){"use strict";cc._RF.push(P,"ae6c7bEampP3pCss/juOsBR","MusicParser"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Music"),s=l("./MusicPart"),r=function(){this.bpm=[],this.basebeats=[]};m.MusicParserParam=r;var o=function(){function e(){}return e.parseJson=function(n,t,i,a){for(var u=new d.default(n),c=t.baseBpm,p=0;p<t.musics.length;++p){var h=t.musics[p],f=h.scores[0],g=h.instruments&&0<h.instruments.length?h.instruments[0]:"piano";e.isInstrumentReady(g)||(g="piano");for(var _=[],y=[],S=1;S<h.scores.length;++S){_.push(h.scores[S]);var I=h.instruments&&h.instruments.length>S?h.instruments[S]:"piano";e.isInstrumentReady(I)||(I="piano"),y.push(I)}var v=i.bpm[p];v==null&&(v=h.bpm==null?c:h.bpm);var C=i.basebeats[p];C==null&&(C=h.baseBeats);var T=new s.default;T.setBPM(v),T.setBaseBeats(C),T.setTrackGain(h.highTrackGain,h.lowTrackGain),T.init(f,g,_,y,a),u.addMusicPart(T)}return u},e.isInstrumentReady=function(n){return n==="piano"},e}();m.default=o,cc._RF.pop()},{"./Music":"Music","./MusicPart":"MusicPart"}],MusicPart:[function(l,P,m){"use strict";cc._RF.push(P,"3a78frMX0NNfaG9mT2fOIK1","MusicPart"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicSyllable"),s=l("./MusicBlock"),r=l("./MusicDefines"),o=l("../business/music/MusicDownloadProcess"),e=function(){this.startIndex=0,this.endIndex=0,this.mark=r.MUSICMARK.None},n=function(){this.groups=[],this.syllables=[],this.musicInstrumentRef=null},t=function(){function u(){}return u.reconiseHead=function(c){if(c.length<2||c[1]!="<")return!1;for(var p=0;p<r.GROUPFORM.contents.length;++p)if(c.substr(0,r.GROUPFORM.contents[p].form.length)===r.GROUPFORM.contents[p].form)return!0;return console.error("reconiseHead error:"+c),!1},u.reconiseTail=function(c){return c===">"},u.parse=function(c,p){for(var h=0,f=0;f<r.GROUPFORM.contents.length;++f)if(c.substr(0,r.GROUPFORM.contents[f].form.length)===r.GROUPFORM.contents[f].form){p.mark=r.GROUPFORM.contents[f].mark,h=r.GROUPFORM.contents[f].form.length;break}return h},u}(),i=function(){function u(){}return u.reconiseHead=function(c){if(c.length===0)return!1;if(u.reconiseStop(c))return!0;var p,h=0;return c[0]==="!"&&(h=1),!((p=c.indexOf("["))<h)&&(c=c.substr(h,p-h)).length!==0&&(c[0]==="("&&c[c.length-1]===")"||u.reconiseBeat(c))},u.parse=function(c,p,h,f,g){var _=u.parseStop(c);if(0<_)return h.setPlayMethod(r.SYLLABLEPLAYMETHOD.StopMark),h.setDuration(_),!0;var y=!1,S=0,I=c.indexOf("["),v=c.indexOf("]"),C=c.indexOf("{"),T=c.indexOf("}"),E=~T?T+1:v+1,A=0<c.lastIndexOf(r.FORMATSYMBOL.groupEnd)?c.length-r.FORMATSYMBOL.groupEnd.length:c.length;if(E<A&&h.setVolnum(u.parseSyllableVolnum(c,E,A)),I<0||v<0||v<=I)return console.log("parse error : "+c),y;if(h.setDuration(u.parseSyllableDuration(c,I+1,v-1)),C<T&&h.setIntensity(u.parseSyllableIntensity(c,C+1,T,f,g)),c[0]==="!"&&(h.setPlayMethod(r.SYLLABLEPLAYMETHOD.Staccato),S=1),S<I){var M="";c[S]==="("&&c[I-1]===")"?S+1<I-1&&(M=c.substring(S+1,I-1),h.getPlayMethod()===r.SYLLABLEPLAYMETHOD.Simple&&h.setPlayMethod(r.SYLLABLEPLAYMETHOD.Chord)):M=c.substring(S,I),y=u.parseBeats(M,p,h)}return y},u.parseBeats=function(c,p,h){if(c.length==0)return!1;for(var f=!0,g=0,_=0;_<=c.length;++_){var y=-1;if(_<c.length){for(var S=0;S<r.BEATSPLIT.content.length;++S)if(c[_]===r.BEATSPLIT.content[S]){y=S;break}if(y==-1)continue}var I=c.substring(g,_),v=p.getBeat(I);if(!v){console.log("parse beats error : "+I),f=!1;break}h.addBeats(v),y!=-1&&(h.addExtraPlayMethod(r.BEATSPLIT.reloveMethods[y]),y!=0&&h.setPlayMethod(r.BEATSPLIT.reloveMethods[y])),g=_+1}return f},u.parseSyllableDuration=function(c,p,h){for(var f=0,g=p;g<=h;++g)for(var _=0;_<r.DURATIONFORM.contents.length;++_)if(c[g]===r.DURATIONFORM.contents[_].form){f+=r.DURATIONFORM.contents[_].time;break}return f},u.parseSyllableVolnum=function(c,p,h){var f=1,g=c.slice(p,h);if(g!=""){var _=parseFloat("0."+g);f=Number.isNaN(_)?_:1}return f},u.parseSyllableIntensity=function(c,p,h,f,g){var _=r.INTENSITY_TYPE.MIDDLE,y=c.slice(p,h);return g?y&&y!==""&&~["L","M","H"].indexOf(y)?y==="L"?_=r.INTENSITY_TYPE.LOW:y==="M"?_=r.INTENSITY_TYPE.MIDDLE:y==="H"&&(_=r.INTENSITY_TYPE.HIGH):_=f?r.INTENSITY_TYPE.MIDDLE:r.INTENSITY_TYPE.LOW:_=r.INTENSITY_TYPE.MIDDLE,_},u.parseStop=function(c){for(var p=0,h=0;h<=c.length;++h)for(var f=0;f<r.STOPFORM.contents.length;++f)if(c[h]===r.STOPFORM.contents[f].form[0]){p+=r.STOPFORM.contents[f].time;break}return p},u.reconiseStop=function(c){for(var p=!1,h=0;h<=c.length;++h){for(var f=0;f<r.STOPFORM.contents.length;++f)if(c[h]===r.STOPFORM.contents[f].form[0]){p=!0;break}if(p)break}return p},u.reconiseBeat=function(c){for(var p=!1,h=0;h<r.BEATNAMES.contents.length;++h)if(c.indexOf(r.BEATNAMES.contents[h])==0){p=!0;break}return p},u}(),a=function(){function u(){this.highMusicTrack=new n,this.lowMusicTracks=[],this.musicBlocks=[],this.baseBeat=0,this.bpm=0,this.acceleration=0,this.lowTrackGain=1,this.highTrackGain=1,this.isMusicPianoExist=null}return u.prototype.getMusicBlocks=function(){return this.musicBlocks},u.prototype.getMusicBlock=function(c){return c<0||c>=this.musicBlocks.length?null:this.musicBlocks[c]},u.prototype.getAcceleration=function(){return this.acceleration},u.prototype.setAcceleration=function(c){this.acceleration=c},u.prototype.setBPM=function(c){this.bpm=c},u.prototype.getBPM=function(){return this.bpm},u.prototype.setBaseBeats=function(c){this.baseBeat=c},u.prototype.getBaseBeats=function(){return this.baseBeat},u.prototype.setTrackGain=function(c,p){c&&(this.highTrackGain=c),p&&(this.lowTrackGain=p)},u.prototype.init=function(c,p,h,f,g){var _=o.MusicDownloadProcess.Ins().isMusicPianoExist();if(this.highMusicTrack.musicInstrumentRef=g.get(p),this.parseSyllableString(c,this.highMusicTrack,!0,_),this.changeTrackGain(this.highMusicTrack,this.highTrackGain),!u.ADD_SINGLE_BEAT)for(var y=0;y<h.length;++y){var S=new n;S.musicInstrumentRef=g.get(f[y]),this.parseSyllableString(h[y],S,!1,_)&&(this.changeTrackGain(S,this.lowTrackGain),this.lowMusicTracks.push(S))}this.blendTrack(),this.musicBlocks=this.generatePieces(32*this.baseBeat),this.lowMusicTracks=[],this.highMusicTrack=null},u.prototype.changeTrackGain=function(c,p){for(var h=0,f=c.syllables.length;h<f;++h)c.syllables[h].playState.partGain=p},u.prototype.blendTrack=function(){for(var c=0,p=0;p<this.highMusicTrack.syllables.length;++p){for(var h=this.highMusicTrack.syllables[p],f=h.getDuration(),g=this.lowMusicTracks.length,_=0;_<g;++_)for(var y=this.lowMusicTracks[_],S=0,I=0;I<y.syllables.length;++I){var v=y.syllables[I];if(S<c)S+=v.getDuration();else{if(!(c<=S&&S<c+f))break;h.attatchLowSyllable(v,S-c),S+=v.getDuration()}}c+=f}},u.prototype.stringifySyllableTrack=function(c){for(var p="",h=0;h<c.syllables.length;++h){var f=this.calcGroupIndex(h,c.groups);if(f==-1)p+=c.syllables[h].toString(),h!=c.syllables.length-1&&(p+=",");else{for(var g=c.groups[f],_=0;_<r.GROUPFORM.contents.length;++_)if(r.GROUPFORM.contents[_].mark==g.mark){p+=r.GROUPFORM.contents[_].form;break}for(_=g.startIndex;_<=g.endIndex;++_)p+=c.syllables[_].toString(),_!=g.endIndex&&(p+=",");p+=">,",h=g.endIndex}}return p},u.prototype.generatePieces=function(c){for(var p=[],h=0;h<this.highMusicTrack.syllables.length;++h){var f=new s.default;p.push(f);var g=this.calcGroupIndex(h,this.highMusicTrack.groups);if(g==-1){var _=this.highMusicTrack.syllables[h];_.isStop()?(f.addSyllable(_),f.setMark(r.MUSICMARK.StopMark)):_.getDuration()>c?(f.setMark(r.MUSICMARK.Accompaniment),v=_.getLowSyllables(),f.addAccompanySyllables(v,0),_.clearLowSyllables(),f.addSyllable(_)):(f.addSyllable(_),f.setMark(r.MUSICMARK.Normal))}else{var y=this.highMusicTrack.groups[g];if(y.mark==r.MUSICMARK.Accompaniment||y.mark==r.MUSICMARK.TiltAccompaniment||y.mark==r.MUSICMARK.FixedTiltAccompaniment)for(var S=0,I=y.startIndex;I<=y.endIndex;++I){var v=this.highMusicTrack.syllables[I].getLowSyllables();f.addAccompanySyllables(v,S),this.highMusicTrack.syllables[I].clearLowSyllables(),f.addSyllable(this.highMusicTrack.syllables[I]),S+=this.highMusicTrack.syllables[I].getDuration()}else for(I=y.startIndex;I<=y.endIndex;++I)f.addSyllable(this.highMusicTrack.syllables[I]);f.setMark(y.mark),h=y.endIndex}}return p},u.prototype.calcGroupIndex=function(c,p){for(var h=-1,f=0;f<p.length;++f){var g=p[f];if(c>=g.startIndex&&c<=g.endIndex){h=f;break}}return h},u.prototype.parseSyllableString=function(c,p,h,f){h===void 0&&(h=!1);var g=p.syllables,_=p.groups,y=c;y.replace(" ","");for(var S=null,I=y.split(";"),v=!0,C=0;C<I.length;++C){for(var T=I[C].split(","),E=0;E<T.length;++E){var A=T[E];if(t.reconiseHead(A)){if(S){v=!1;break}var M=new e,k=t.parse(A,M);M.startIndex=g.length,_.push(M),S=M,A=A.slice(k)}if(i.reconiseHead(A)){var D=new d.default(p.musicInstrumentRef);if(!i.parse(A,p.musicInstrumentRef,D,h,f)){v=!1;break}g.push(D)}if(t.reconiseTail(A[A.length-1])){if(S==null){v=!1;break}S.endIndex=g.length-1,S=null}}if(!v)break}return v},u.prototype.getHighMusicTrack=function(){return this.highMusicTrack},u.ADD_SINGLE_BEAT=!1,u}();m.default=a,cc._RF.pop()},{"../business/music/MusicDownloadProcess":"MusicDownloadProcess","./MusicBlock":"MusicBlock","./MusicDefines":"MusicDefines","./MusicSyllable":"MusicSyllable"}],MusicPlayCompat:[function(l,P,m){"use strict";cc._RF.push(P,"6770fCUlMVPs6N3SQ8vsQIC","MusicPlayCompat"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicContext"),s=function(){function r(){this.index=0,this.updateCompatEnabled(r.DEFAULT_COMPAT_ENABLED)}return r.getInstance=function(){return r.sInstance==null&&(r.sInstance=new r),r.sInstance},r.prototype.updateCompatEnabled=function(o){if(this.WECHAT_COMPAT_ENABLED=cc.sys.platform===cc.sys.WECHAT_GAME&&o,this.QQ_COMPAT_ENABLED=cc.sys.platform===cc.sys.QQ_PLAY&&o,this.WECHAT_COMPAT_ENABLED&&!this.mContextList){this.mContextList=[];for(var e=0;e<r.MAX_CONTEXT_COUNT;e++)this.mContextList.push(new d.default(e))}else this.QQ_COMPAT_ENABLED&&!this.mContextList&&(BK.Audio.switch=!0,this.mContextList=[])},r.prototype.isNeedFullPath=function(){return this.WECHAT_COMPAT_ENABLED||this.QQ_COMPAT_ENABLED},r.prototype.play=function(o,e,n){this.WECHAT_COMPAT_ENABLED?this.playMusicContext(e,n):cc.sys.platform===cc.sys.QQ_PLAY?this.playMusicContextForQQ(e):cc.audioEngine.play(e,!1,n)},r.prototype.playMusicContext=function(o,e){for(var n=-1,t=-1,i=Date.now(),a=0;a<this.mContextList.length;a++){var u=this.mContextList[a];if(u.isEnded()){n=a;break}u.getTimeStamp()<i&&(t=a,i=u.getTimeStamp())}(n!=-1?this.mContextList[n]:this.mContextList[t]).playA(o,e)},r.prototype.playMusicContextForQQ=function(o){var e=this.mContextList.find(function(n){return n.getPath()===o});e?e.play():(this.commonAddContextList(this.index,o).play(),this.index++)},r.prototype.commonAddContextList=function(o,e){var n=new d.default(o,e);return this.mContextList.push(n),n},r.DEFAULT_COMPAT_ENABLED=!0,r.MAX_CONTEXT_COUNT=30,r.sInstance=null,r}();m.default=s,cc._RF.pop()},{"./MusicContext":"MusicContext"}],MusicPlayer:[function(l,P,m){"use strict";cc._RF.push(P,"d820fkKEhNH3Zg5w/0WgakZ","MusicPlayer"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicDefines"),s=l("./MusicPlayCompat"),r=l("../base/G"),o=l("../gamescene/animation/MScheduler"),e=l("./MusicThread"),n=l("../util/common/EnumUtils"),t=l("../business/music/tone/PianoToneMgr"),i=function(){function a(u){this.musicSyllableRefs=[],this.bpm=0,this.scheduler=new o.default,this.thread=new e.default,this.bpm=u}return a.playMusicBeat=function(u,c,p,h){u.isStopMark||s.default.getInstance().play(u.audioId,u.realPath,p)},a.prototype.setBpm=function(u){this.bpm=u},a.prototype.addSyllable=function(u){this.musicSyllableRefs.push(u)},a.prototype.update=function(u){for(var c=0;c<this.musicSyllableRefs.length;){var p=this.musicSyllableRefs[c];this.tryPlay(p,u)?(p.resetPlayData(),this.musicSyllableRefs.splice(c,1)):++c}this.scheduler.update(u),r.G.Ap.config.debugNoComplicatedPlayMode&&this.thread.update(u)},a.prototype.playMusicBeatByThread=function(u,c,p,h,f){if(f===void 0&&(f=d.INTENSITY_TYPE.MIDDLE),!r.G.Ap.config.debugNoBlockSound&&!u.isStopMark)if(r.G.Ap.config.debugNoComplicatedPlayMode)this.thread.addBeat(u);else{var g=this.getPathByIntensity(f,u);s.default.getInstance().play(u.audioId,g,p)}},a.prototype.tryPlay=function(u,c){u.playState.playBpm=this.bpm,u.playState.totalPlayedTime+=c;var p=u.playState.playBpm/60*u.playState.totalPlayedTime*32,h=u.playState.played;if(!u.playState.played){if(!(0<=p-(u.playState.startTime+u.getDelayFromParent())))return!1;u.playState.played=this.play(u),u.playState.played&&(h=!0)}for(var f=u.getLowSyllables(),g=0;g<f.length;g++){var _=f[g];this.tryPlay(_,c)||(h=!1)}return h},a.prototype.tryPlaySubSyllableIsolate=function(u,c,p){return u.playState.played?2:(u.playState.playBpm=this.bpm,u.playState.totalPlayedTime+=c,p?0:(0<=u.playState.playBpm/60*u.playState.totalPlayedTime*32-(u.playState.startTime+u.getDelayFromParent())&&(this.play(u),u.playState.played=!0),u.playState.played?1:0))},a.prototype.play=function(u){switch(u.getPlayMethod()){case d.SYLLABLEPLAYMETHOD.StopMark:return!0;case d.SYLLABLEPLAYMETHOD.Simple:case d.SYLLABLEPLAYMETHOD.Staccato:case d.SYLLABLEPLAYMETHOD.Chord:return this.playSimple(u);case d.SYLLABLEPLAYMETHOD.Legato:return this.playLegato(u);case d.SYLLABLEPLAYMETHOD.Arpeggio:return this.playArpeggio(u);case d.SYLLABLEPLAYMETHOD.Wave:case d.SYLLABLEPLAYMETHOD.Trill:return this.playWav(u);case d.SYLLABLEPLAYMETHOD.Echo:return this.playEcho(u);case d.SYLLABLEPLAYMETHOD.LAppoggiatura:return this.playLAppoggiatura(u);case d.SYLLABLEPLAYMETHOD.SAppoggiatura:return this.playSAppoggiatura(u)}return!1},a.prototype.playSimple=function(u){var c=this.calcSyllableTime(u);u.playState.symPlayTime=c;for(var p=u.getMusicBeats(),h=p.length,f=0;f<h;f++)this.playMusicBeatByThread(p[f],u.playState.gain,u.getVolnum()*u.playState.partGain,u.playState.symPlayTime,u.getIntensity());return!0},a.prototype.playLegato=function(u){var c=this,p=this.calcSyllableTime(u),h=u.getExtraPlayMethodTimes(d.SYLLABLEPLAYMETHOD.Legato);return h==0||(p/=h+1,u.playState.symPlayTime=p,u.playState.lastPlayPos=0,a.log("playLegato:"+(h-1)),this.playingAppoggiatura(u),this.scheduler.scheduleLoop(function(){c.playingAppoggiatura(u)},p,h,p)),!0},a.prototype.playArpeggio=function(u){var c=this,p=this.calcSyllableTime(u),h=u.getExtraPlayMethodTimes(d.SYLLABLEPLAYMETHOD.Arpeggio);return h==0||(p*=.1,2<=h&&(p/=h-1),u.playState.symPlayTime=p,u.playState.lastPlayPos=0,a.log("playArpeggio:"+(h-1)),this.playingAppoggiatura(u),this.scheduler.scheduleLoop(function(){c.playingAppoggiatura(u)},p,h,p)),!0},a.prototype.playEcho=function(u){var c=this,p=this.calcSyllableTime(u),h=u.getExtraPlayMethodTimes(d.SYLLABLEPLAYMETHOD.Echo);return h==0||(p/=h+1,u.playState.symPlayTime=p,u.playState.lastPlayPos=0,a.log("playEcho:"+(h-1)),this.playingAppoggiatura(u),this.scheduler.scheduleLoop(function(){c.playingAppoggiatura(u)},p,h,p)),!0},a.prototype.playWav=function(u){var c=this,p=this.calcSyllableTime(u),h=p/160*1e3*2;return p/=h,u.playState.symPlayTime=p,u.playState.lastPlayPos=0,a.log("playWav:"+(h-1)),this.playingWav(u),this.scheduler.scheduleLoop(function(){c.playingWav(u)},p,h,p),!0},a.prototype.playSAppoggiatura=function(u){var c=this;a.log("playSAppoggiatura:"+(u.getMusicBeats().length-1));var p=this.calcSyllableTime(u);return p*=.15,p/=Math.max(1,u.getMusicBeats().length-1),u.playState.symPlayTime=p,u.playState.lastPlayPos=0,this.playingAppoggiatura(u),this.scheduler.scheduleLoop(function(){c.playingAppoggiatura(u)},p,u.getMusicBeats().length,p),!0},a.prototype.playLAppoggiatura=function(u){var c=this;a.log("playLAppoggiatura:"+(u.getMusicBeats().length-1));var p=this.calcSyllableTime(u);return p*=.3,p/=Math.max(1,u.getMusicBeats().length-1),u.playState.symPlayTime=p,u.playState.lastPlayPos=0,this.playingAppoggiatura(u),this.scheduler.scheduleLoop(function(){c.playingAppoggiatura(u)},p,u.getMusicBeats().length,p),!0},a.prototype.playingWav=function(u){a.log("playingWav playpos="+u.playState.lastPlayPos);var c=u.getMusicBeats();c.length==2&&(this.playMusicBeatByThread(c[u.playState.lastPlayPos%2],u.playState.gain,u.getVolnum()*u.playState.partGain,u.getDuration(),u.getIntensity()),u.playState.lastPlayPos++)},a.prototype.playingAppoggiatura=function(u){a.log("playingAppoggiatura playpos="+u.playState.lastPlayPos);var c=u.getMusicBeats();if(u.playState.lastPlayPos<c.length){this.playMusicBeatByThread(c[u.playState.lastPlayPos],u.playState.gain,u.getVolnum()*u.playState.partGain,u.getDuration(),u.getIntensity());var p=u.getExtraPlayMethods();u.playState.lastPlayPos<p.length&&p[u.playState.lastPlayPos]===d.SYLLABLEPLAYMETHOD.Chord?(u.playState.lastPlayPos++,this.playingAppoggiatura(u)):u.playState.lastPlayPos++}},a.prototype.getPathByIntensity=function(u,c){var p="";try{var h=t.default.Ins().getCurTone();if(t.default.Ins().isUseDefaultTone())switch(u){case d.INTENSITY_TYPE.LOW:var f=n.EnumUtils.getEntry(d.INTENSITY_TYPE.LOW,d.INTENSITY_TYPE);p=c.realPath.replace("piano/",f.description+"/");break;case d.INTENSITY_TYPE.MIDDLE:p=c.realPath;break;case d.INTENSITY_TYPE.HIGH:var g=n.EnumUtils.getEntry(d.INTENSITY_TYPE.HIGH,d.INTENSITY_TYPE);p=c.realPath.replace("piano/",g.description+"/");break;default:p=c.realPath}else p=c.realPath.replace("piano/",h+"/")}catch(_){p=c.realPath}return p},a.prototype.calcSyllableTime=function(u){return 60/u.playState.playBpm*u.getDuration()/32},a.log=function(u){},a}();m.default=i,cc._RF.pop()},{"../base/G":"G","../business/music/tone/PianoToneMgr":"PianoToneMgr","../gamescene/animation/MScheduler":"MScheduler","../util/common/EnumUtils":"EnumUtils","./MusicDefines":"MusicDefines","./MusicPlayCompat":"MusicPlayCompat","./MusicThread":"MusicThread"}],MusicPreloader:[function(l,P,m){"use strict";cc._RF.push(P,"4e6963OFkdGXLbCDmZ7PWIh","MusicPreloader"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.preload=function(){cc.loader.loadResDir("music/piano",cc.AudioClip,function(r,o,e){for(var n=0,t=e;n<t.length;n++){var i=t[n];console.log("preload music: "+i)}})},s}();m.default=d,cc._RF.pop()},{}],MusicSyllable:[function(l,P,m){"use strict";cc._RF.push(P,"44194l3JkdItra18bP3F4c7","MusicSyllable"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicDefines"),s=l("./MusicDefines"),r=function(){function e(){this.playBpm=0,this.startTime=0,this.lastPlayPos=0,this.symPlayTime=0,this.played=!1,this.totalPlayedTime=0,this.gain=1,this.partGain=1}return e.prototype.reset=function(){this.played=!1,this.totalPlayedTime=0,this.symPlayTime=0,this.startTime=0,this.playBpm=0,this.lastPlayPos=0},e}();m.MusicSyllablePlay=r;var o=function(){function e(n){this.volnum=1,this.musicBeatRefs=[],this.duration=0,this.delayFromParent=0,this.delayTime=0,this.intensity=d.INTENSITY_TYPE.MIDDLE,this.playMethod=s.SYLLABLEPLAYMETHOD.Simple,this.extraPlayMethods=[],this.attachLowSyllableRefs=[],this.instrumentRef=null,this.playState=new r,this.instrumentRef=n}return e.prototype.getInstrument=function(){return this.instrumentRef},e.prototype.getPlayMethod=function(){return this.playMethod},e.prototype.setPlayMethod=function(n){this.playMethod=n},e.prototype.getMusicBeats=function(){return this.musicBeatRefs},e.prototype.addBeats=function(n){this.musicBeatRefs.push(n)},e.prototype.getDuration=function(){return this.duration},e.prototype.setDuration=function(n){this.duration=n},e.prototype.getVolnum=function(){return this.volnum},e.prototype.setVolnum=function(n){this.volnum=n},e.prototype.getDelayFromParent=function(){return this.delayFromParent},e.prototype.setDelayFromParent=function(n){this.delayFromParent=n},e.prototype.getAccDelay=function(){return this.delayTime},e.prototype.setDelay=function(n){this.delayTime=n},e.prototype.getIntensity=function(){return this.intensity},e.prototype.setIntensity=function(n){this.intensity=n},e.prototype.addAccDelay=function(n){this.delayTime+=n},e.prototype.isStop=function(){if(this.getPlayMethod()!=s.SYLLABLEPLAYMETHOD.StopMark)return!1;for(var n=0;n<this.attachLowSyllableRefs.length;n++)if(s.SYLLABLEPLAYMETHOD.StopMark!=this.attachLowSyllableRefs[n].getPlayMethod())return!1;return!0},e.prototype.attatchLowSyllable=function(n,t){n.setDelayFromParent(t),n.setDelay(t),this.attachLowSyllableRefs.push(n)},e.prototype.getLowSyllables=function(){return this.attachLowSyllableRefs},e.prototype.clearLowSyllables=function(){this.attachLowSyllableRefs=[]},e.prototype.addExtraPlayMethod=function(n){this.extraPlayMethods.push(n)},e.prototype.getExtraPlayMethods=function(){return this.extraPlayMethods},e.prototype.getExtraPlayMethodTimes=function(n){for(var t=0,i=this.extraPlayMethods,a=0;a<i.length;a++)i[a]==n&&t++;return t},e.prototype.resetPlayData=function(){this.playState.reset();for(var n=0;n<this.attachLowSyllableRefs.length;n++)this.attachLowSyllableRefs[n].resetPlayData()},e.prototype.setStartTime=function(n){this.playState.startTime=n;for(var t=0;t<this.attachLowSyllableRefs.length;t++)this.attachLowSyllableRefs[t].setStartTime(n)},e.prototype.toString=function(){var n="";if(this.playMethod==s.SYLLABLEPLAYMETHOD.StopMark)for(var t=this.getDuration(),i=0;i<s.STOPFORM.contents.length;++i)t>=s.STOPFORM.contents[i].time&&(n+=s.STOPFORM.contents[i].form,t-=s.STOPFORM.contents[i].time);else{var a=this.musicBeatRefs.length;1<a&&(n+="("),i=0;for(var u=this.musicBeatRefs.length;i<u;++i){if(0<i){for(var c=this.extraPlayMethods[i-1],p=0;p<s.BEATSPLIT.reloveMethods.length;++p)if(s.BEATSPLIT.reloveMethods[p]==c){n+=s.BEATSPLIT.content[p];break}}n+=this.musicBeatRefs[i].beatName}for(1<a&&(n+=")"),n+="[",t=this.getDuration(),i=0;i<s.DURATIONFORM.contents.length;++i)t>=s.DURATIONFORM.contents[i].time&&(n+=s.DURATIONFORM.contents[i].form,t-=s.DURATIONFORM.contents[i].time);n+="]"}return n},e}();m.default=o,cc._RF.pop()},{"./MusicDefines":"MusicDefines"}],MusicThread:[function(l,P,m){"use strict";cc._RF.push(P,"31c796b5xtELLmIDwTRha6c","MusicThread"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MusicPlayCompat"),s=function(){function r(){this.beats=[],this.frame=0,this.beatsPreFrame=0,this.beatsAllFrame=0}return r.prototype.update=function(o){if(0<this.beats.length){var e=this.beats[0];d.default.getInstance().play(e.audioId,e.realPath,1),this.beats.splice(0,1)}},r.prototype.addBeat=function(o){this.beats.push(o)},r}();m.default=s,cc._RF.pop()},{"./MusicPlayCompat":"MusicPlayCompat"}],Music:[function(l,P,m){"use strict";cc._RF.push(P,"8f393BeJe5Nw7Q3HtZ3qpbj","Music"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r){this.musicName="",this.musicParts=[],this.musicName=r}return s.prototype.getName=function(){return this.musicName},s.prototype.getMusicParts=function(){return this.musicParts},s.prototype.addMusicPart=function(r){this.musicParts.push(r)},s.prototype.getMusicPart=function(r){return r<0||r>=this.musicParts.length?null:this.musicParts[r]},s.prototype.getMusicBlock=function(r,o){var e=this.getMusicPart(r);return e==null?null:e.getMusicBlock(o)},s}();m.default=d,cc._RF.pop()},{}],NetworkUtils:[function(l,P,m){"use strict";cc._RF.push(P,"85be0cWDfBBlI3kXX2mylsI","NetworkUtils"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./WeappHelper"),s=l("./MGLog"),r=l("./MGSha1"),o=l("./QQHelper"),e=l("./TypeDefinition"),n=function(){function t(){}return t.request=function(i){if(i)switch(i.platform){case e.PlatformType.PLATFORM_H5SDK:case e.PlatformType.PLATFORM_GAMEHALL:case e.PlatformType.PLATFORM_WECHAT:t.requestWX(i);break;case e.PlatformType.PLATFORM_WEB:case e.PlatformType.PLATFORM_FACEBOOK:t.requestFB(i);break;case e.PlatformType.PLATFORM_QQPLAY:t.requestQQ(i);break;case e.PlatformType.PLATFORM_CMPLAY:t.requestCMPlay(i);break;default:i.fail&&i.fail(-1,null)}},t.requestWX=function(i){d.WeappHelper.networkRequest({url:i.url,data:i.data,header:i.header,method:i.method,dataType:i.dataType,success:function(a,u,c){i.token&&i.checkAuthorization&&!t.checkAuthorization(c,u,i.token)?i.fail(a,u):i.success(u)},fail:function(a,u){i.fail(a,u)}})},t.requestFB=function(i){s.default.l("NetworkUtils requestFB, parameter:",i);var a=new XMLHttpRequest;for(var u in a.open(i.method,i.url),i.header)a.setRequestHeader(u,i.header[u]);a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200){if(s.default.l("NetworkUtils requestFB, success:",a.responseText),i.token&&i.checkAuthorization&&!t.checkAuthorization(a.getAllResponseHeaders(),a.responseText,i.token))return void(i.fail&&i.fail(a.status,a.responseText));if(i.success){var p=a.responseText;if(i.dataType=="json")try{p=JSON.parse(a.responseText)}catch(h){}i.success(p)}}else s.default.l("NetworkUtils requestFB, fail:",a.responseText),i.fail&&i.fail(a.status,a.responseText)};var c=i.data?JSON.stringify(i.data):"";a.send(c)},t.requestQQ=function(i){console.log("===NetworkUtils requestQQ parameter:"+i.url),o.QQHelper.networkRequest({url:i.url,data:i.data,header:i.header,method:i.method,dataType:i.dataType,success:function(a,u,c){i.success&&i.success(u)},fail:function(a,u){console.error("===NetworkUtils requestQQ fail:"+a+","+(u?JSON.stringify(u):"")),i.fail&&i.fail(a,u)}})},t.requestCMPlay=function(i){s.default.l("NetworkUtils requestCMPlay, parameter:",i);var a=new XMLHttpRequest;for(var u in a.open(i.method,i.url),i.header)a.setRequestHeader(u,i.header[u]);a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200){if(s.default.l("NetworkUtils requestCMPlay, success:",i,a.responseText),i.success){var p=a.responseText;if(i.dataType=="json")try{p=JSON.parse(a.responseText)}catch(h){}i.success(p)}}else s.default.l("NetworkUtils requestCMPlay, fail:",i,a.responseText),i.fail&&i.fail(a.status,a.responseText)};var c=i.data?JSON.stringify(i.data):"";a.send(c)},t.checkAuthorization=function(i,a,u){return i&&(i.Authorization||i.authorization)?"CMCM "+r.hex_hmac_sha1(u,a)===(i.Authorization?i.Authorization:i.authorization)||(s.default.e("NetworkUtils checkAuthorization, fail: Invalid authorization."),!1):(s.default.e("NetworkUtils checkAuthorization, fail: Authorization is empty."),!1)},t.createAuthorization=function(i,a){return"CMCM "+r.hex_hmac_sha1(a,JSON.stringify(i))},t.METHOD_GET="GET",t.METHOD_HEAD="HEAD",t.METHOD_POST="POST",t.METHOD_PUT="PUT",t.METHOD_DELETE="DELETE",t.METHOD_TRACE="TRACE",t.METHOD_CONNECT="CONNECT",t}();m.default=n,cc._RF.pop()},{"./MGLog":"MGLog","./MGSha1":"MGSha1","./QQHelper":"QQHelper","./TypeDefinition":"TypeDefinition","./WeappHelper":"WeappHelper"}],NewGuidanceLoader:[function(l,P,m){"use strict";cc._RF.push(P,"78b51f2el5CNb7eR+GYz9p7","NewGuidanceLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../util/ResLoader"),s=l("../../../util/PU"),r=l("./GuidanceInfo"),o=l("./NewGuidancePrefab"),e=l("../../../util/SUtil"),n=l("../../UI/GameEntraScene/PrefabMgr"),t=function(){function i(){this.mGuidanceInfos=null}return i.getInstance=function(){return this._instance==null&&(this._instance=new i),this._instance},i.prototype.showGuideFinger=function(a,u,c,p,h,f){this.getGuidanceItems(function(g){g.forEach(function(_){_.sceneName==a&&_.prefabItems.forEach(function(y){y.prefabName==u&&y.items.forEach(function(S){S.itemName==c&&n.default.load("prefab/newtarget/NewGuidancePrefab",function(I,v){var C=v.getComponent(o.default);C.setClickNotHide(h),S.itemName=="GuideToTarget"?v.tag=i.FINGER_NODE_TARGET_ICON_TAG:v.tag=i.FINGER_NODE_OTHER_TAG,p.addChild(v),C.setItem(S),f&&f()})})})})},function(g){console.log(g)})},i.prototype.getGuidanceItems=function(a,u){var c=this;if(this.mGuidanceInfos)a(this.mGuidanceInfos);else{var p=s.default.getResourcePath("resources/guidance/guidance_config.json");d.default.loadJson(p,function(h,f){if(h)u(h);else if(f)try{c.mGuidanceInfos||(c.mGuidanceInfos=[]);var g=function(y){var S=new r.default;if(f.hasOwnProperty(y)){var I=f[y];S.sceneName=y;var v=[];I.forEach(function(C){var T=[],E=new r.PrefabItem;E.prefabName=C.prefabName,C.items.forEach(function(A){var M=new r.GuidanceItem;M.itemName=A.name,M.index=A.index;var k=new cc.Vec2,D=null;e.SUtil.ins().isPuTong()?(k.x=A.position_1280.x,k.y=A.position_1280.y,A.position2_1280&&!D&&A.position2_1280&&((D=new cc.Vec2).x=A.position2_1280.x,D.y=A.position2_1280.y)):e.SUtil.ins().isQuanMian()?(k.x=A.position_1440.x,k.y=A.position_1440.y,!D&&A.position2_1440&&((D=new cc.Vec2).x=A.position2_1440.x,D.y=A.position2_1440.y)):e.SUtil.ins().isLiuHai()&&(k.x=A.position_1559.x,k.y=A.position_1559.y,!D&&A.position2_1559&&((D=new cc.Vec2).x=A.position2_1559.x,D.y=A.position2_1559.y)),M.isRich=A.isRichLabel,M.tipsPos=A.tipsPos,M.isDown=A.isDown,M.isLeft=A.isLeft,M.position=k,D&&(M.position2=D),M.next=A.next,M.autoHide=A.autoHide,M.text=A.text,M.duration=A.duration,T.push(M)}),E.items=T,v.push(E)}),S.prefabItems=v}c.mGuidanceInfos.push(S)};for(var _ in f)g(_);a(c.mGuidanceInfos)}catch(y){u(y)}})}},i.FINGER_NODE_TARGET_ICON_TAG=66,i.FINGER_NODE_OTHER_TAG=67,i}();m.default=t,cc._RF.pop()},{"../../../util/PU":"PU","../../../util/ResLoader":"ResLoader","../../../util/SUtil":"SUtil","../../UI/GameEntraScene/PrefabMgr":"PrefabMgr","./GuidanceInfo":"GuidanceInfo","./NewGuidancePrefab":"NewGuidancePrefab"}],NewGuidancePrefab:[function(l,P,m){"use strict";cc._RF.push(P,"8c1b2GMUm9JK57s0tu4eaGO","NewGuidancePrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r,o,e=l("./GuidanceInfo"),n=l("../../UI/GameEntraScene/ImgCache"),t=l("../../Logic/EventBus"),i=l("../../Logic/NotifyEvent"),a=cc._decorator,u=a.ccclass,c=a.property;(s=d=m.CircleColor||(m.CircleColor={}))[s.WHITE=0]="WHITE",s[s.YELLOW=1]="YELLOW",(o=r=m.TipPos||(m.TipPos={}))[o.DOWN=0]="DOWN",o[o.RIGHT=1]="RIGHT",o[o.LEFT_DOWN=2]="LEFT_DOWN",o[o.LEFT_TOP=3]="LEFT_TOP",o[o.TOP=4]="TOP";var p=function(h){function f(){var g=h!==null&&h.apply(this,arguments)||this;return g.mClickNotHide=!1,g}return __extends(f,h),f.prototype.onLoad=function(){var g=this;this.node.on(cc.Node.EventType.TOUCH_START,function(_){g.mClickNotHide||(g.node.removeFromParent(),g.node.destroy(),t.default.fire(i.default.REFRESH_HOMEPAGE_NEW_TARGET_RED_SPOT))},this),this.node._touchListener&&this.node._touchListener.setSwallowTouches(!1)},f.prototype.start=function(){this.mPanel.getComponent(cc.Animation).play("guide_circle_scale")},f.prototype.initViews=function(){this.mItem},f.prototype.setDataFroGameScene=function(g,_,y,S,I){var v=this;this.mItem=new e.GuidanceItem,this.mItem.isDown=_,this.mItem.text=g,this.mItem.position=I,this.mItem.isRich=!1,S==r.DOWN?this.mItem.tipsPos="down":S==r.LEFT_DOWN?this.mItem.tipsPos="left_down":S==r.LEFT_TOP?this.mItem.tipsPos="left_top":S==r.RIGHT?this.mItem.tipsPos="right":S==r.TOP&&(this.mItem.tipsPos="top");var C=null;y==d.YELLOW?C="static_res/guide_light_circle_yellow":y==d.WHITE&&(C="static_res/guide_light_circle_white"),C&&n.default.get(C,function(T,E){cc.isValid(v,!0)&&v.node&&v.node.isValid&&(v.mFingerSprite1.spriteFrame=E,v.mFingerSprite2.spriteFrame=E,v.mFingerSprite3.spriteFrame=E)}),this.initViews()},f.prototype.setPosition=function(g){this.mPanel.position=g},f.prototype.setItem=function(g){this.mItem=g,this.initViews()},f.prototype.setClickNotHide=function(g){this.mClickNotHide=g},__decorate([c(cc.Node)],f.prototype,"mPanel",void 0),__decorate([c(cc.Node)],f.prototype,"mDownFingerNode",void 0),__decorate([c(cc.Node)],f.prototype,"mUpFingerNode",void 0),__decorate([c(cc.Node)],f.prototype,"mLeftFingerNode",void 0),__decorate([c(cc.Sprite)],f.prototype,"mFingerDownFinger",void 0),__decorate([c(cc.RichText)],f.prototype,"mDownLabel",void 0),__decorate([c(cc.Sprite)],f.prototype,"mDownTipsBg",void 0),__decorate([c(cc.Sprite)],f.prototype,"mFingerUpFinger",void 0),__decorate([c(cc.Label)],f.prototype,"mUpLabel",void 0),__decorate([c(cc.Sprite)],f.prototype,"mUpTipsBg",void 0),__decorate([c(cc.RichText)],f.prototype,"mUpLabelRich",void 0),__decorate([c(cc.Sprite)],f.prototype,"mFingerSprite1",void 0),__decorate([c(cc.Sprite)],f.prototype,"mFingerSprite2",void 0),__decorate([c(cc.Sprite)],f.prototype,"mFingerSprite3",void 0),f=__decorate([u],f)}(cc.Component);m.default=p,cc._RF.pop()},{"../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../UI/GameEntraScene/ImgCache":"ImgCache","./GuidanceInfo":"GuidanceInfo"}],NewPlayerTargerItemPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"86e79oynrZOgokP9knH+5fo","NewPlayerTargerItemPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../TaskSystem"),s=l("../TaskItem"),r=l("../../UI/GameEntraScene/ImgCache"),o=l("../../UI/GameEntraScene/BasicTouchEvent"),e=l("../../awardcontroller/AwardController"),n=l("./NewGuidanceLoader"),t=l("../../Logic/GameItemsManager"),i=l("../../Logic/EventBus"),a=l("../../Logic/NotifyEvent"),u=cc._decorator,c=u.ccclass,p=u.property,h=function(f){function g(){return f!==null&&f.apply(this,arguments)||this}return __extends(g,f),g.prototype.onLoad=function(){var _=this;this.mBtnClickCallback=new o.default(function(){_.setClickById()}),this.mBtn.node.on(cc.Node.EventType.TOUCH_END,this.mBtnClickCallback.click,this.mBtnClickCallback)},g.prototype.start=function(){},g.prototype.setClickById=function(){if(this.mTask.status==s.TaskStatus.TASK_STATUS_SUCCESS){if(this.mTask.rewardTaken)return;this.showRewardPage()}else this.mToHomePageCallback&&this.mToHomePageCallback(this.mTask.id)},g.prototype.setToHomePageCallback=function(_){this.mToHomePageCallback=_},g.prototype.showRewardPage=function(){var _=this,y=new e.AwardResultInfo;y.setTitlePicPath("/static_res/newtarget/new_target_finish_title").addAwardContent(t.GameItemType.TYPE_DIAMONDS,this.mTask.rewardValue).setIsNeedGiveAwardInfo(!0).setOkBtn("\u597D\u7684",function(){d.default.Ins().setRewardTaken(_.mTask.id,!0),i.default.fire(a.default.REFRESH_HOMEPAGE_NEW_TARGET_RED_SPOT),r.default.get2("/static_res/black_diamond_icon",_.mRewardIcon),r.default.get2("/mainpage/new_guide_done_bg",_.mBg),_.mRewardCountLabel.getComponent(cc.LabelOutline).color=new cc.Color().fromHEX("#7F7F7F"),r.default.get("/static_res/newtarget/target_btn_getted",function(S,I){cc.isValid(_,!0)&&(_.mBtn.normalSprite=I,_.mBtn.pressedSprite=I)}),_.mInActiveBg.node.active=!0,_.mActiveBg.node.active=!1,_.mTargetLabel.node.color=new cc.Color().fromHEX("#9D9D9D"),_.mProcesslabel.node.color=new cc.Color().fromHEX("#9D9D9D"),_.mProcesslabel.node.opacity=178,_.mProcessCountLabel.string=_.mTask.currentStep+"/"+_.mTask.totalStep,_.showNextFinger(),e.AwardController.getIns().dismissAwardResultPage(y)}),e.AwardController.getIns().showAwardResultPage(y)},g.prototype.setData=function(_,y){var S=this;if(this.mFingerParentNode=y,_){var I;I=(this.mTask=_).rewardTaken?"/static_res/black_diamond_icon":"/static_res/diamond_popup_diamond_icon",r.default.get2(I,this.mRewardIcon),this.mRewardCountLabel.string="x "+_.rewardValue,this.mTargetLabel.string=_.name;var v=_.rewardTaken?"/mainpage/new_guide_done_bg":"/mainpage/trial_item_bk";if(r.default.get2(v,this.mBg),_.rewardTaken)this.mRewardCountLabel.getComponent(cc.LabelOutline).color=new cc.Color().fromHEX("#7F7F7F"),r.default.get("/mainpage/new_guide_done",function(A,M){cc.isValid(S,!0)&&(S.mBtn.normalSprite=M,S.mBtn.pressedSprite=M)}),this.mInActiveBg.node.active=!0,this.mActiveBg.node.active=!1,this.mTargetLabel.node.color=new cc.Color().fromHEX("#9D9D9D"),this.mProcesslabel.node.color=new cc.Color().fromHEX("#9D9D9D"),this.mProcesslabel.node.opacity=178,this.mProcessCountLabel.string=_.currentStep+"/"+_.totalStep;else{this.mRewardCountLabel.getComponent(cc.LabelOutline).color=new cc.Color().fromHEX("#458CDC");var C=void 0,T=void 0;if(_.status==s.TaskStatus.TASK_STATUS_DOING){this.mInActiveBg.node.active=!1,this.mActiveBg.node.active=!0;var E=Math.round(240*_.currentStep/_.totalStep);this.mActiveBg.node.width=E,C="/mainpage/new_guide_go",T="/mainpage/new_guide_go_pressed"}else _.status==s.TaskStatus.TASK_STATUS_SUCCESS&&(C="/mainpage/new_guide_taken",T="/mainpage/new_guide_taken_pressed",this.mInActiveBg.node.active=!1,this.mActiveBg.node.active=!0,this.mActiveBg.node.width=240);this.mProcessCountLabel.string=_.currentStep+"/"+_.totalStep,r.default.get(C,function(A,M){cc.isValid(S,!0)&&(S.mBtn.normalSprite=M)}),r.default.get(T,function(A,M){cc.isValid(S,!0)&&(S.mBtn.pressedSprite=M)})}}},g.prototype.showNextFinger=function(){var _,y=d.default.Ins().getTaskList(),S=!1,I=!1;y.forEach(function(C){C.status!=s.TaskStatus.TASK_STATUS_SUCCESS||C.rewardTaken?C.status==s.TaskStatus.TASK_STATUS_DOING&&(S||(I=!0)):I=!(S=!0)});var v=!1;if(y.forEach(function(C){v||(S?C.status!=s.TaskStatus.TASK_STATUS_SUCCESS||C.rewardTaken||(v=!0,_=C):I&&C.status==s.TaskStatus.TASK_STATUS_DOING&&(v=!0,_=C))}),_&&(_.status==s.TaskStatus.TASK_STATUS_DOING||_.status==s.TaskStatus.TASK_STATUS_SUCCESS&&!_.rewardTaken))switch(_.id){case s.TaskID.TASK_ID_LITTLE_STAR:n.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideTargetBtnPlay",this.mFingerParentNode);break;case s.TaskID.TASK_ID_LEVEL_THREE:n.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideTargetBtnLevelThree",this.mFingerParentNode);break;case s.TaskID.TASK_ID_ATTEND_CHALLENGE:n.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideToBtnChallenge",this.mFingerParentNode);break;case s.TaskID.TASK_ID_GAME_SHARE:n.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideToBtnShare",this.mFingerParentNode);break;case s.TaskID.TASK_ID_UNLOCK_HOT_SONG:n.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideHotMusicBtn",this.mFingerParentNode)}},__decorate([p(cc.Sprite)],g.prototype,"mBg",void 0),__decorate([p(cc.Label)],g.prototype,"mRewardCountLabel",void 0),__decorate([p(cc.Sprite)],g.prototype,"mRewardIcon",void 0),__decorate([p(cc.Label)],g.prototype,"mTargetLabel",void 0),__decorate([p(cc.Label)],g.prototype,"mProcesslabel",void 0),__decorate([p(cc.Sprite)],g.prototype,"mActiveBg",void 0),__decorate([p(cc.Sprite)],g.prototype,"mInActiveBg",void 0),__decorate([p(cc.Label)],g.prototype,"mProcessCountLabel",void 0),__decorate([p(cc.Button)],g.prototype,"mBtn",void 0),g=__decorate([c],g)}(cc.Component);m.default=h,cc._RF.pop()},{"../../Logic/EventBus":"EventBus","../../Logic/GameItemsManager":"GameItemsManager","../../Logic/NotifyEvent":"NotifyEvent","../../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../../UI/GameEntraScene/ImgCache":"ImgCache","../../awardcontroller/AwardController":"AwardController","../TaskItem":"TaskItem","../TaskSystem":"TaskSystem","./NewGuidanceLoader":"NewGuidanceLoader"}],NewPlayerTargetParentPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"22035czZuFMBIHBE0WKPkLD","NewPlayerTargetParentPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Logic/NotifyEvent"),s=l("../../Logic/EventBus"),r=l("../../UI/GameEntraScene/PrefabMgr"),o=l("../../UI/GameEntraScene/mainpage/MainpageBaseComponent"),e=l("./NewPlayerTargetPrefab"),n=cc._decorator,t=n.ccclass,i=(n.property,function(a){function u(){return a!==null&&a.apply(this,arguments)||this}return __extends(u,a),u.prototype.onLoad=function(){var c=this;r.default.load("prefab/newtarget/NewPlayerTargetPrefab",function(p,h){h&&(h.getComponent(e.default).setBtnClickCallback(function(f){s.default.fire(d.default.NEW_GUIDE_GO_CLICK,f)}),c.node.addChild(h))})},u=__decorate([t],u)}(o.default));m.default=i,cc._RF.pop()},{"../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../../UI/GameEntraScene/mainpage/MainpageBaseComponent":"MainpageBaseComponent","./NewPlayerTargetPrefab":"NewPlayerTargetPrefab"}],NewPlayerTargetPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"1da35U0kVxM3pf3fYbv4LCk","NewPlayerTargetPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../TaskSystem"),s=l("../TaskItem"),r=l("./NewPlayerTargerItemPrefab"),o=l("./NewGuidanceLoader"),e=l("../../Logic/NotifyEvent"),n=l("../../Logic/EventBus"),t=l("../../UI/GameEntraScene/PrefabMgr"),i=cc._decorator,a=i.ccclass,u=i.property,c=function(p){function h(){return p!==null&&p.apply(this,arguments)||this}return __extends(h,p),h.prototype.onLoad=function(){this.addItem(),this.node.on(cc.Node.EventType.TOUCH_START,function(f){f.stopPropagation()},this)},h.prototype.setBtnClickCallback=function(f){this.mBtnClickCallback=f},h.prototype.onDestroy=function(){d.default.Ins().isNeedShowTaskSystemEntry()||n.default.fire(e.default.HIDE_GUIDE_FINGER)},h.prototype.addItem=function(){var f=this;d.default.Ins().loadData(function(g){if(g){if(!cc.isValid(f,!0))return;var _=d.default.Ins().getTaskList();if(_){var y,S=!1,I=!1;_.forEach(function(v){v.status!=s.TaskStatus.TASK_STATUS_SUCCESS||v.rewardTaken?v.status==s.TaskStatus.TASK_STATUS_DOING&&(S||(I=!0)):I=!(S=!0)}),t.default.load("prefab/newtarget/NewPlayerTargerItemPrefab",function(v,C){if(cc.isValid(f,!0)){var T=!1;if(_.forEach(function(E){var A=cc.instantiate(C),M=A.getComponent(r.default);M.setData(E,f.node.parent),M.setToHomePageCallback(f.mBtnClickCallback),T||(S?E.status!=s.TaskStatus.TASK_STATUS_SUCCESS||E.rewardTaken||(T=!0,y=E):I&&E.status==s.TaskStatus.TASK_STATUS_DOING&&(T=!0,y=E)),f.mItemPanel.addChild(A)}),y&&(y.status==s.TaskStatus.TASK_STATUS_DOING||y.status==s.TaskStatus.TASK_STATUS_SUCCESS&&!y.rewardTaken))switch(y.id){case s.TaskID.TASK_ID_LITTLE_STAR:o.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideTargetBtnPlay",f.node.parent);break;case s.TaskID.TASK_ID_LEVEL_THREE:o.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideTargetBtnLevelThree",f.node.parent);break;case s.TaskID.TASK_ID_ATTEND_CHALLENGE:o.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideToBtnChallenge",f.node.parent);break;case s.TaskID.TASK_ID_GAME_SHARE:o.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideToBtnShare",f.node.parent);break;case s.TaskID.TASK_ID_UNLOCK_HOT_SONG:o.default.getInstance().showGuideFinger("NewPlayerTarget","NewPlayerTargetPrefab","GuideHotMusicBtn",f.node.parent)}}},!1)}}})},__decorate([u(cc.Node)],h.prototype,"mItemPanel",void 0),h=__decorate([a],h)}(cc.Component);m.default=c,cc._RF.pop()},{"../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../TaskItem":"TaskItem","../TaskSystem":"TaskSystem","./NewGuidanceLoader":"NewGuidanceLoader","./NewPlayerTargerItemPrefab":"NewPlayerTargerItemPrefab"}],NewRecordPrefb:[function(l,P,m){"use strict";cc._RF.push(P,"c3eff2WNmBItIwDPiuZqAUu","NewRecordPrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../MusicLevelDataLoader"),s=l("../../../util/SUtil"),r=l("../../../util/PU"),o=l("../../../util/ParticleSystemVM"),e=l("./BasicTouchEvent"),n=l("./ToastPrefab"),t=l("../../gameover/SaveSuccessPrefab"),i=l("../../../../modules/MGAppShare/scripts/ShareImageUtils"),a=l("../../../social/WXHelper"),u=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),c=l("../../../base/Log"),p=l("../../../../modules/MGAppShare/scripts/ShareImage"),h=l("../../Network/Protocol/StorageUtil"),f=l("../../../config/LSKey"),g=l("../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),_=l("../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),y=l("../../../util/PU"),S=l("../../../upgrade/BannerDelayShowToggle"),I=l("../../../upgrade/ToggleBean"),v=l("../../../../modules/MGUtils/MGPlatform"),C=cc._decorator,T=C.ccclass,E=C.property,A=function(M){function k(){var D=M!==null&&M.apply(this,arguments)||this;return D.mMusicNameLabel=null,D.mShareBtn=null,D.mCancelBtn=null,D.mTopTitleBg=null,D.mRankContainer=null,D.popupLayout=null,D.mSaveBtn=null,D.toastprefab=null,D.saveSuccessprefab=null,D.mFingerPanel=null,D.mAnimHideNode=null,D.mTipBgNode=null,D.mShareBtnPanel=null,D.closeBtn=null,D.mShareClickCallback=null,D.mCloseClickCallback=null,D.mSaveClickCallback=null,D.mQQBannerHidden=!1,D.mQQBannerHideInit=!1,D.QQ_BANNER_HIDDEN_WARNING="QQ banner is hidden by remote config",D.QQ_BANNER_HIDDEN_WARNING_DEFAULT="QQ banner is hidden by DEFAULT",D.mBannerStatus={isShowed:!1,destroyed:!1,onLoadTime:Date.now(),isTimeout:function(){return 1e3<Date.now()-this.onLoadTime}},D}return __extends(k,M),k.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(D){D.stopPropagation()}),this.adaptorUI(),this.initParticleSystem(),this.node.on(cc.Node.EventType.TOUCH_START,function(D){D.stopPropagationImmediate()},this),this.showShareBtnAnim(),y.default.isQQ()&&this.mQQBannerHidden?c.default.w("AdvHelperQQ NewRecordPrefab.onLoad",this.mQQBannerHideInit?this.QQ_BANNER_HIDDEN_WARNING:this.QQ_BANNER_HIDDEN_WARNING_DEFAULT):this.mBannerStatus.onLoadTime=Date.now()},k.prototype.preloadBannerAd=function(){if(!y.default.isQQ()||!this.mQQBannerHidden){var D=v.MGPlatform.getSystemInfoSync();g.MGAdv.loadBanner(300,0,(this.getCancelBtnTopShowBanner()+40)*D.screenHeight/s.SUtil.ins().mScreenHeight,null,_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT)}},k.prototype.showShareBtnAnim=function(){var D=this;h.default.read(f.default.HAS_SHOW_SHARE_ANIM)!="true"&&(h.default.save(f.default.HAS_SHOW_SHARE_ANIM,"true"),this.mAnimHideNode.active=!0,this.mTipBgNode.active=!0,this.mFingerPanel.active=!0,this.mFingerPanel.getComponent(cc.Animation).play("guide_circle_scale"),this.mAnimHideNode.on(cc.Node.EventType.TOUCH_START,function(L){D.mFingerPanel.getComponent(cc.Animation).stop("guide_circle_scale"),D.mTipBgNode.destroy(),D.mFingerPanel.destroy(),D.mAnimHideNode.destroy()},this),this.mAnimHideNode._touchListener&&this.mAnimHideNode._touchListener.setSwallowTouches(!1))},k.prototype.initParticleSystem=function(){if(r.default.particalSystemCompat){var D=this.node.getChildByName("LP"),L=this.node.getChildByName("RP"),b=new o.ParticleSystemChild(!0,!0,"LGreen","particle_levelupgreen_l.plist"),N=new o.ParticleSystemChild(!0,!0,"LRed","particle_levelupred_l.plist"),H=new o.ParticleSystemChild(!0,!0,"RBlue","particle_levelupblue_r.plist"),R=new o.ParticleSystemChild(!0,!0,"RYellow","particle_yellow_r.plist"),F=[],x=[];F.push(b),F.push(N),x.push(H),x.push(R);var U=new o.ParticleSystemVM(D,F),B=new o.ParticleSystemVM(L,x);U.start(),B.start()}},k.prototype.start=function(){var D=this;this.adaptorUI(),this.mShareBtn.getComponent(cc.Animation).play("fluent_btn_bigger");var L=d.MusicLevelDataLoader.getIndex(this.mLevelId);this.mMusicNameLabel.string=L+"."+this.mMusicName,this.mShareClickCallback=new e.default(function(){D.onShareClick()}),this.mShareBtn.node.on(cc.Node.EventType.TOUCH_END,this.mShareClickCallback.click,this.mShareClickCallback),this.mCloseClickCallback=new e.default(function(){D.onCloseClick()}),this.mCancelBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback),this.closeBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback),this.mSaveClickCallback=new e.default(function(){D.onSaveClick()}),this.mSaveBtn.node.on(cc.Node.EventType.TOUCH_END,this.mSaveClickCallback.click,this.mSaveClickCallback)},k.prototype.onShareClick=function(){this.mShareListener(this.mShareType)},k.prototype.onCloseClick=function(){this.mCancelListener()},k.prototype.onSaveClick=function(){var D=this,L=this.showLoadToast(),b=L.getComponent(n.default),N=new i.default;cc.sys.platform==cc.sys.WECHAT_GAME&&u.MGUser.getUserBasicInfo({complete:function(H){if(H){H.nickName;var R=H.avatarUrl;N.setNewRecordShareFds(R,D.mMusicName,D.mCurrentScore),N.getShareImage(p.ShareImage.TYPE_SHARE_NEW_RECORD_FDS,function(F,x){console.log("[zhangfu] result = "+F+" , path = "+x),F?(b.showLoading("\u6B63\u5728\u4FDD\u5B58\u56FE\u7247..."),a.WXHelper.saveTmpImgToAlbum(x,function(){L.destroy(),D.showSaveSuccess()},function(){b.showLoadFail(function(){L.destroy()})},function(){})):b.showLoadFail(function(){L.destroy()})})}}})},k.prototype.showLoadToast=function(){var D=cc.instantiate(this.toastprefab);return D.getComponent(n.default).showLoading("\u6B63\u5728\u751F\u6210\u56FE\u7247..."),this.popupLayout.node.addChild(D),D},k.prototype.showSaveSuccess=function(){var D=cc.instantiate(this.saveSuccessprefab);D.getComponent(t.default).setTips("\u5FEB\u53D1\u9001\u670B\u53CB\u5708\u70AB\u8000\u6218\u7EE9\u5427!"),this.popupLayout.node.addChild(D)},k.prototype.setData=function(D,L,b,N,H,R){this.mMusicMid=D,this.mLevelId=L,this.mMusicName=b,this.mCurrentScore=N,this.mBestScore=H,this.mMusicGrade=R},k.prototype.setListener=function(D,L){this.mShareListener=D,this.mCancelListener=L},k.prototype.setQQBannerHidden=function(D,L){this.mQQBannerHideInit=D,this.mQQBannerHidden=L},k.prototype.adaptorUI=function(){r.default.isQQ()?s.SUtil.ins().isLiuHai()?(s.SUtil.ins().toTopByPx(this.mRankContainer,35),s.SUtil.ins().toTopByPx(this.mTopTitleBg,234),s.SUtil.ins().toTopByPx(this.closeBtn,234),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1252),s.SUtil.ins().toTopByPx(this.mCancelBtn,1419)):s.SUtil.ins().isQuanMian()&&(s.SUtil.ins().toTopByPx(this.mRankContainer,73),s.SUtil.ins().toTopByPx(this.mTopTitleBg,175),s.SUtil.ins().toTopByPx(this.closeBtn,175),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1160),s.SUtil.ins().toTopByPx(this.mCancelBtn,1327)):(r.default.isWeiXin()||r.default.isWeb())&&(s.SUtil.ins().isLiuHai()?(s.SUtil.ins().toTopByPx(this.mRankContainer,35),s.SUtil.ins().toTopByPx(this.mTopTitleBg,234),s.SUtil.ins().toTopByPx(this.closeBtn,234),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1252),s.SUtil.ins().toTopByPx(this.mCancelBtn,1419)):s.SUtil.ins().isQuanMian()&&(s.SUtil.ins().toTopByPx(this.mRankContainer,73),s.SUtil.ins().toTopByPx(this.mTopTitleBg,175),s.SUtil.ins().toTopByPx(this.closeBtn,175),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1160),s.SUtil.ins().toTopByPx(this.mCancelBtn,1327)))},k.prototype.adaptorADUI=function(){r.default.isQQ()?s.SUtil.ins().isLiuHai()?(s.SUtil.ins().toTopByPx(this.mRankContainer,20),s.SUtil.ins().toTopByPx(this.mTopTitleBg,234),s.SUtil.ins().toTopByPx(this.closeBtn,234),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1122)):s.SUtil.ins().isQuanMian()?(s.SUtil.ins().toTopByPx(this.mRankContainer,63),s.SUtil.ins().toTopByPx(this.mTopTitleBg,165),s.SUtil.ins().toTopByPx(this.closeBtn,165),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1040)):(s.SUtil.ins().toTopByPx(this.mRankContainer,-100),s.SUtil.ins().toTopByPx(this.mTopTitleBg,175),s.SUtil.ins().toTopByPx(this.closeBtn,175),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,860)):(r.default.isWeiXin()||r.default.isWeb())&&(s.SUtil.ins().isLiuHai()?(s.SUtil.ins().toTopByPx(this.mRankContainer,35),s.SUtil.ins().toTopByPx(this.mTopTitleBg,234),s.SUtil.ins().toTopByPx(this.closeBtn,234),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1072)):s.SUtil.ins().isQuanMian()?(s.SUtil.ins().toTopByPx(this.mRankContainer,73),s.SUtil.ins().toTopByPx(this.mTopTitleBg,175),s.SUtil.ins().toTopByPx(this.closeBtn,175),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,1060)):(s.SUtil.ins().toTopByPx(this.mRankContainer,-100),s.SUtil.ins().toTopByPx(this.mTopTitleBg,175),s.SUtil.ins().toTopByPx(this.closeBtn,175),s.SUtil.ins().toTopByPx(this.mShareBtnPanel,860))),s.SUtil.ins().toTopByPx(this.mCancelBtn,this.getCancelBtnTopShowBanner())},k.prototype.getCancelBtnTopShowBanner=function(){return r.default.isQQ()?s.SUtil.ins().isLiuHai()?1277:s.SUtil.ins().isQuanMian()?1185:1e3:r.default.isWeiXin()||r.default.isWeb()?s.SUtil.ins().isLiuHai()?1217:s.SUtil.ins().isQuanMian()?1205:1e3:void 0},k.prototype.update=function(){g.MGAdv.isOverPageBannerShow()&&y.default.isWeiXin()&&g.MGAdv.hideBanner(_.ADScene.GAME_RESULT_BANNER),this.mBannerStatus.isShowed||this.mBannerStatus.isTimeout()&&(this.mBannerStatus.isShowed=!0,this.showBannerAd())},k.prototype.onDestroy=function(){this.destoryBannerAd()},k.prototype.showBannerAd=function(){var D=this;if(!y.default.isWeb()){var L=void 0,b=void 0,N=void 0;if(y.default.isQQ()){if(this.mQQBannerHidden)return void c.default.w("AdvHelperQQ NewRecordPrefab.showBannerAd",this.mQQBannerHideInit?this.QQ_BANNER_HIDDEN_WARNING:this.QQ_BANNER_HIDDEN_WARNING_DEFAULT);N=b=L=0}else if(y.default.isWeiXin()){var H=wx.getSystemInfoSync();L=H.screenWidth,b=(this.getCancelBtnTopShowBanner()+40)*H.screenHeight/s.SUtil.ins().mScreenHeight,N=0}if(g.MGAdv.isBannerCached(_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT)){var R=S.default.getBannerDelayTime(I.ToggleKey.BANNER_DELAY_NORMAL_RESULT_SHOW_OFF);this.scheduleOnce(function(){cc.isValid(D,!0)&&g.MGAdv.showBanner(_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT,function(){D.adaptorADUI()})},R.normalDelayTime/1e3)}else g.MGAdv.loadBanner(L,N,b,function(F,x){if(F==_.ADStat.LOAD_SUCCESS)if(D.isValid&&!D.mBannerStatus.destroyed){var U=S.default.getBannerDelayTime(I.ToggleKey.BANNER_DELAY_NORMAL_RESULT_SHOW_OFF);D.scheduleOnce(function(){cc.isValid(D,!0)&&g.MGAdv.showBanner(_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT,function(){D.adaptorADUI()})},U.normalDelayTime/1e3)}else g.MGAdv.hideBanner(_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT),g.MGAdv.destroyBanner(_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT)},_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT)}},k.prototype.destoryBannerAd=function(){this.mBannerStatus.destroyed||y.default.isQQ()&&this.mQQBannerHidden||(this.mBannerStatus.destroyed=!0,g.MGAdv.hideBanner(_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT),g.MGAdv.destroyBanner(_.ADScene.SCENE_SINGLESONG_FLAUNT_RESULT))},__decorate([E(cc.Label)],k.prototype,"mMusicNameLabel",void 0),__decorate([E(cc.Button)],k.prototype,"mShareBtn",void 0),__decorate([E(cc.Label)],k.prototype,"mCancelBtn",void 0),__decorate([E(cc.Sprite)],k.prototype,"mTopTitleBg",void 0),__decorate([E(cc.Node)],k.prototype,"mRankContainer",void 0),__decorate([E(cc.Layout)],k.prototype,"popupLayout",void 0),__decorate([E(cc.Label)],k.prototype,"mSaveBtn",void 0),__decorate([E(cc.Prefab)],k.prototype,"toastprefab",void 0),__decorate([E(cc.Prefab)],k.prototype,"saveSuccessprefab",void 0),__decorate([E(cc.Node)],k.prototype,"mFingerPanel",void 0),__decorate([E(cc.Node)],k.prototype,"mAnimHideNode",void 0),__decorate([E(cc.Node)],k.prototype,"mTipBgNode",void 0),__decorate([E(cc.Node)],k.prototype,"mShareBtnPanel",void 0),__decorate([E(cc.Button)],k.prototype,"closeBtn",void 0),k=__decorate([T],k)}(cc.Component);m.default=A,cc._RF.pop()},{"../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../../modules/MGAppShare/scripts/ShareImage":"ShareImage","../../../../modules/MGAppShare/scripts/ShareImageUtils":"ShareImageUtils","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../../modules/MGUtils/MGPlatform":"MGPlatform","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../social/WXHelper":"WXHelper","../../../upgrade/BannerDelayShowToggle":"BannerDelayShowToggle","../../../upgrade/ToggleBean":"ToggleBean","../../../util/PU":"PU","../../../util/ParticleSystemVM":"ParticleSystemVM","../../../util/SUtil":"SUtil","../../Network/Protocol/StorageUtil":"StorageUtil","../../gameover/SaveSuccessPrefab":"SaveSuccessPrefab","../MusicLevelDataLoader":"MusicLevelDataLoader","./BasicTouchEvent":"BasicTouchEvent","./ToastPrefab":"ToastPrefab"}],NodeCreateHelper:[function(l,P,m){"use strict";cc._RF.push(P,"c285fboDG1F+JYkwKWCG2FQ","NodeCreateHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("./ReuseNode"),r=l("../../MUI/MUISprite");(d=m.NodeCreateHelper||(m.NodeCreateHelper={})).createStartNode=function(o){var e=new s.default("label");return e.setPosition(o.rect.width/2,o.rect.height/2),e.setContentSize(o.rect.width,o.rect.height),e},d.createScaleNode=function(o,e,n){n===void 0&&(n=!1);var t=new cc.Size(e.rect.width,e.rect.height),i=new r.default;i.setContentSize(t.width,t.height);var a=o.rect.width/t.width,u=a;return n&&(u=o.rect.height/t.height),i.setScale(a,u),i.imageItem=e,i},d.createNodeForceScale=function(o,e,n){n===void 0&&(n=0);var t=new cc.Size(o.rect.width,o.rect.height),i=new r.default;return i.setContentSize(t.width,t.height),i.setScale(e,n==0?e:n),i.imageItem=o,i},cc._RF.pop()},{"../../MUI/MUISprite":"MUISprite","./ReuseNode":"ReuseNode"}],NodeFacade:[function(l,P,m){"use strict";cc._RF.push(P,"a3e15q7CTlB8pQVi+O1pubs","NodeFacade"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r){this.node=r}return s.prototype.getNode=function(){return this.node},s.prototype.getChild=function(r){return new s(this.node?this.node.getChildByName(r):null)},s.prototype.setVisible=function(r){this.node&&(this.node.active=r)},s.prototype.setOpacity=function(r){this.node&&(this.node.opacity=r)},s.prototype.setChildVisible=function(r,o){if(this.node){var e=this.node.getChildByName(r);e&&(e.active=o)}},s.prototype.isChildVisible=function(r){if(!this.node)return!1;var o=this.node.getChildByName(r);return!!o&&o.active},s.prototype.setChildText=function(r,o){if(this.node){var e=this.node.getChildByName(r);if(e){var n=e.getComponent(cc.Label);n&&(n.string=o)}}},s.prototype.setChildSpriteFrame=function(r,o){if(this.node){var e=this.node.getChildByName(r);if(e){var n=e.getComponent(cc.Sprite);n&&(n.spriteFrame=o)}}},s}();m.default=d,cc._RF.pop()},{}],NodesPool:[function(l,P,m){"use strict";cc._RF.push(P,"374f3HMFdhNLb8dTw3PiCYY","NodesPool"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.mNodes=new Map,this.mPrefabs=new Map}return s.Ins=function(){return this._s||(this._s=new s),this._s},s.prototype.isPrefabSettled=function(r){var o=this.mPrefabs.get(r);return o!=null&&o!=null},s.prototype.setPrefabs=function(r,o){this.mPrefabs.set(r,o)},s.prototype.pop=function(r){var o=this.mNodes.get(r);o||(o=[],this.mNodes.set(r,o));var e=null;if(0<o.length)e=o.pop();else{var n=this.mPrefabs.get(r);n&&((e=cc.instantiate(n)).active=!0)}return e},s.prototype.returnBack=function(r,o){if(o){var e=this.mNodes.get(r);e||(e=[],this.mNodes.set(r,e)),e.push(o),o.removeFromParent(!1)}},s}();m.NodesPool=d,cc._RF.pop()},{}],NormalGainCrownTask:[function(l,P,m){"use strict";cc._RF.push(P,"50b01Mgxx1CbZWk8QxhDFfb","NormalGainCrownTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],NormalGameScene:[function(l,P,m){"use strict";cc._RF.push(P,"4e2aduLIn9NBaeQVV05+phJ","NormalGameScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e){return s.call(this,o,e)||this}return __extends(r,s),r.prototype.allowProperty=function(){return!0},r}(l("./GameScene").default);m.default=d,cc._RF.pop()},{"./GameScene":"GameScene"}],NormalMusicCardItemPrefb:[function(l,P,m){"use strict";cc._RF.push(P,"befd7stITZDg5aRIaPRQ5gR","NormalMusicCardItemPrefb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../BasicTouchEvent"),s=l("../../../Logic/EventBus"),r=l("../../../Logic/NotifyEvent"),o=l("../../../../infoc/m_p2_Uaction"),e=l("../../../Logic/Plugin/PluginMgr"),n=l("../../../Logic/Plugin/IPlugin"),t=l("../../../../base/G"),i=l("../../../../base/State"),a=l("../../UserInfoManager"),u=l("../ImgCache"),c=l("../../../skin/SkinUtils"),p=l("../../../../gamescene/GameSceneSetting"),h=l("../../../Network/Protocol/StorageUtil"),f=l("../../../../config/LSKey"),g=l("../../../../util/PU"),_=l("../../../Logic/I18nManager"),y=l("../../../../util/StringUtil"),S=l("../../../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),I=l("../../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),v=cc._decorator,C=v.ccclass,T=v.property,E=function(A){function M(){var D=A!==null&&A.apply(this,arguments)||this;return D.mLevellayout=null,D.mLevelValueLabel=null,D.mMusicIndexLabel=null,D.mMusicName=null,D.mMusicianLabel=null,D.mStarIconGroup=null,D.mStarIcon1=null,D.mStarIcon2=null,D.mStarIcon3=null,D.mRankBtn=null,D.mStartBtn=null,D.mOpenLevelLabel=null,D.mBg=null,D.mExceptMoreLabel=null,D.mNormalBg=null,D.mSpecialBg=null,D.mSpecMusicNameLabe=null,D.mSpecMusicianLabel=null,D.mSpecMusicIndexLabel=null,D.mSpecStarConditionLable=null,D.itemID=0,D.mMusicNameStr="",D.mMusicianStr="",D.mLevelId=0,D.mMusicID=0,D.mMusicLevel=0,D.mUnlockType=null,D.mIsLocked=!1,D.mStarNumber=0,D.mIndex=0,D.mStartBtnClickEvent=null,D.mRankBtnClickEvent=null,D.mIsUpdateViewOnLoad=!1,D.mIsSpecial=!1,D.mSource=k.SOURCE_DEFAULT,D}var k;return __extends(M,A),(k=M).prototype.setSource=function(D){this.mSource=D},M.prototype.onLoad=function(){_.default.getInstance().isEnglish()?this.mMusicianLabel!=null&&(this.mMusicianLabel.node.active=!1):(this.mMusicName!=null&&(this.mMusicName.node.x=this.mMusicName.node.x-15,this.mMusicName.node.y=this.mMusicName.node.y+38),this.mMusicianLabel!=null&&(this.mMusicianLabel.node.active=!0)),this.initCMView(),this.registerEvents()},M.prototype.initCMView=function(){g.default.isCM()&&(this.mRankBtn.node.active=!1,this.mSpecRankIcon.node.active=!1)},M.prototype.registerEvents=function(){var D=this;this.mRankBtnClickEvent=new d.default(function(){D.rankBtnClickCallback()}),this.mSpecRankIcon.node.on(cc.Node.EventType.TOUCH_END,this.mRankBtnClickEvent.click,this.mRankBtnClickEvent),this.mRankBtn.node.on(cc.Node.EventType.TOUCH_END,this.mRankBtnClickEvent.click,this.mRankBtnClickEvent),this.mStartBtnClickEvent=new d.default(function(){var L=S.ADScene.PLAY_AGAIN;I.MGAdv.commercialBreak(L,S.QQ_ADV_TYPE.VIDEO_TYPE_PLAY_AGAIN,function(b){D.startBtnClickCallback()})}),this.mSpecStartBtn.node.on(cc.Node.EventType.TOUCH_END,this.mStartBtnClickEvent.click,this.mStartBtnClickEvent),this.mSpecStartBtn.node.on(cc.Node.EventType.TOUCH_START,function(){s.default.fire(r.default.SHOW_HOMEPAGE_EVENT_TOP_MASK)},this),this.mSpecStartBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){s.default.fire(r.default.HIDE_HOMEPAGE_EVENT_TOP_MASK)},this),this.mStartBtn.node.on(cc.Node.EventType.TOUCH_END,this.mStartBtnClickEvent.click,this.mStartBtnClickEvent),this.mStartBtn.node.on(cc.Node.EventType.TOUCH_START,function(){s.default.fire(r.default.SHOW_HOMEPAGE_EVENT_TOP_MASK)},this),this.mStartBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){s.default.fire(r.default.HIDE_HOMEPAGE_EVENT_TOP_MASK)},this)},M.prototype.unregisterEvents=function(){},M.prototype.rankBtnClickCallback=function(){},M.prototype.startBtnClickCallback=function(){if(this.mIsUpdateViewOnLoad||o.default.report(this.mMusicID,o.default.ACTION_CLICK_MUSICLIB_START),!e.default.Ins().getPlugin(n.default.Plugin_Energy).isCurEnergyEnough())return s.default.fire(r.default.HP_NOT_ENOUGH_ITEM_CLICK),void s.default.fire(r.default.HIDE_HOMEPAGE_EVENT_TOP_MASK);if(this.mIsUpdateViewOnLoad)this.startMusic();else{var D=cc.director.getWinSize().height,L=this.node.parent.convertToWorldSpaceAR(this.node.getPosition());this.mIsSpecial?L.y=L.y-this.node.height+this.mStartBtn.node.height/2+22-46-(D-1280)/2:L.y=L.y-this.node.height+this.mStartBtn.node.height/2+22-(D-1280)/2,L.x=L.x+this.node.width/2-this.mStartBtn.node.width/2,this.startMusic()}},M.prototype.startMusic=function(){if(c.default.needTryInviteSkinSpecSong(this.mMusicID)&&this.mSource==k.SOURCE_UPDATE_CONTENT)s.default.fire(r.default.SPEC_SONG_TRY_SKIN_RESULT);else{var D=e.default.Ins().getPlugin(n.default.Plugin_Energy);t.G.Ap.state.reset(),t.G.Ap.state.mission=new i.Mission(this.mLevelId,this.mMusicID,!1);var L=0;this.mSource==k.SOURCE_UPDATE_CONTENT&&(L=4,p.default.getInstance().setFromSource(p.FromSource.SOURCE_RESULT_UPGRADE)),h.default.save(f.default.OPEN_GAMEOVER_FROM,"1"),s.default.fire(r.default.LOAD_MUSIC,L,D)}},M.prototype.start=function(){},M.prototype.showExceptMore=function(){this.mBg.spriteFrame=null,this.mNormalBg.active=!1,this.mSpecialBg.node.active=!1,this.mExceptMoreLabel.node.x=0},M.prototype.hideException=function(){this.mExceptMoreLabel.node.x=5e3},M.prototype.setData=function(D,L,b){if(this.mIsSpecial=D.isCrownLock,b===!0)this.mIsUpdateViewOnLoad=!0,this.hideException(),this.mLevellayout.node.active=!1;else{if(D.id==k.exceptionMoreId)return this.showExceptMore(),void(this.itemID=L);this.hideException()}if(this.mMusicNameStr=D.musicName,this.mMusicianStr=D.musician,this.mMusicID=D.musicId,this.mMusicLevel=D.level,this.mUnlockType=D.unlockType,this.mIsLocked=D.isLocked,this.mLevelId=D.id,this.mStarNumber=D.bestStar,this.mIndex=D.index,this.mIsSpecial)if(this.mSpecialBg.node.active=!0,this.mNormalBg.active=!1,this.mStartBtn.node.active=!1,this.mSpecMusicNameLabe.string=this.mMusicNameStr,this.mSpecMusicIndexLabel.string=this.mIndex+"",this.mSpecMusicianLabel.string=this.mMusicianStr,a.User.UserInfoManager.getUserInfo().level<D.level){this.mSpecCrownNode.active=!1,this.mSpecStarNode.active=!1,this.mSpecStartBtn.node.active=!1,this.mSpecUnlockLevelLabel.node.active=!0,this.mSpecStarConditionLable.node.active=!1,this.mSpecUnlockStarNode.active=!1,this.mSpecMusicNameLabe.node.color=cc.Color.BLACK.fromHEX("#92A7B8"),this.mSpecMusicianLabel.node.color=cc.Color.BLACK.fromHEX("#ACC2CE");var N=_.default.getInstance().getLanguageByKey("label_text.level"),H=_.default.getInstance().getLanguageByKey("label_text.unlock");this.mSpecUnlockLevelLabel.string=N+" "+D.level+" "+H}else if(this.mSpecMusicNameLabe.node.color=cc.Color.BLACK.fromHEX("#214962"),this.mSpecMusicianLabel.node.color=cc.Color.BLACK.fromHEX("#ACC2CE"),this.mSpecUnlockLevelLabel.node.active=!1,0<D.needStarNum)if(D.curTotalStarNum<D.needStarNum){this.mSpecStarNode.active=!1,this.mSpecCrownNode.active=!1,this.mSpecStarConditionLable.node.active=!0;var R=y.StringUtil.format(_.default.getInstance().getLanguageByKey("label_text.music_unlock_msg1"),D.level,D.needStarNum);this.mSpecStarConditionLable.string=R,this.mSpecUnlockStarNode.active=!0,this.mSpecStarConditionWidthIconLable.string=D.curTotalStarNum+"/"+D.needStarNum,this.mSpecStartBtn.node.active=!1,u.default.get("/musiclist/music_list_star_get",function(F,x){cc.isValid(this.node)&&(this.mSpecUnlockMarkSprite.spriteFrame=x,this.mSpecUnlockMarkSprite.node.width=44,this.mSpecUnlockMarkSprite.node.height=54)}.bind(this))}else this.mSpecStarConditionLable.node.active=!1,this.mSpecUnlockStarNode.active=!1,this.mSpecStartBtn.node.active=!0,this.mSpecStartBtnLabel.string=_.default.getInstance().getLanguageByKey("label_text.music_start1"),this.setLevelIconForSpecial(this.mStarNumber);else 0<D.needCrownNum&&(D.curTotalCrownNum<D.needCrownNum?(this.mSpecStarNode.active=!1,this.mSpecCrownNode.active=!1,this.mSpecStarConditionLable.node.active=!0,R=y.StringUtil.format(_.default.getInstance().getLanguageByKey("label_text.music_unlock_msg3"),D.level,D.needCrownNum),this.mSpecStarConditionLable.string=R,this.mSpecUnlockStarNode.active=!0,this.mSpecStarConditionWidthIconLable.string=D.curTotalCrownNum+"/"+D.needCrownNum,this.mSpecStartBtn.node.active=!1,u.default.get("/musiclist/music_list_crown_get",function(F,x){cc.isValid(this.node)&&(this.mSpecUnlockMarkSprite.spriteFrame=x,this.mSpecUnlockMarkSprite.node.width=48,this.mSpecUnlockMarkSprite.node.height=46)}.bind(this))):(this.mSpecStarConditionLable.node.active=!1,this.mSpecUnlockStarNode.active=!1,this.mSpecStartBtn.node.active=!0,this.mSpecStartBtnLabel.string=_.default.getInstance().getLanguageByKey("label_text.music_start1"),this.setLevelIconForSpecial(this.mStarNumber)));else this.mMusicIndexLabel.string=D.index+"",this.mMusicName.string=D.musicName,this.mMusicianLabel.string=D.musician,this.mNormalBg.active=!0,this.mStartBtn.node.active=!0,this.mSpecialBg.node.active=!1,this.setStarOrCrownSpriteFrame(),this.changeBgIfLocked();b||(this.itemID=L)},M.prototype.setStarOrCrownSpriteFrame=function(){if(this.mIsLocked){this.mStarIconGroup.node.active=!1,this.mStartBtn.node.active=!1,this.mOpenLevelLabel.node.active=!0;var D=_.default.getInstance().getLanguageByKey("label_text.level"),L=_.default.getInstance().getLanguageByKey("label_text.unlock");this.mOpenLevelLabel.string=D+" "+this.mMusicLevel+" "+L}else this.mOpenLevelLabel.node.active=!1,this.mStartBtn.node.active=!0,this.mStarIconGroup.node.active=!0,this.setLevelIcon(this.mStarNumber)},M.prototype.changeBgIfLocked=function(){var D=this.mIsLocked,L=this.mStarNumber;D?(u.default.getMusicItemBgImage("/musiclist/music_list_item_bg","bg_music_list_item_lock",function(b,N){cc.isValid(this.node)&&(this.mBg.spriteFrame=N)}.bind(this)),this.mMusicName.node.color=cc.Color.BLACK.fromHEX("#92A7B8"),this.mMusicianLabel.node.color=cc.Color.BLACK.fromHEX("#BCCED7")):(L<4?u.default.getMusicItemBgImage("/musiclist/music_list_item_bg","bg_music_list_item_star",function(b,N){cc.isValid(this.node)&&(this.mBg.spriteFrame=N)}.bind(this)):u.default.getMusicItemBgImage("/musiclist/music_list_item_bg","bg_music_list_item_crown",function(b,N){cc.isValid(this.node)&&(this.mBg.spriteFrame=N)}.bind(this)),this.mMusicName.node.color=cc.Color.BLACK.fromHEX("#214962"),this.mMusicianLabel.node.color=cc.Color.BLACK.fromHEX("#ACC2CE"))},M.prototype.setLevelIconForSpecial=function(D){switch(3<D?(this.mSpecStarNode.active=!1,this.mSpecCrownNode.active=!0):(this.mSpecStarNode.active=!0,this.mSpecCrownNode.active=!1),D){case 0:u.default.get("/musiclist/music_list_star_unget",function(L,b){cc.isValid(this,!0)&&(this.mSpecStar1.spriteFrame=b,this.mSpecStar2.spriteFrame=b,this.mSpecStar3.spriteFrame=b)}.bind(this));break;case 1:u.default.get("/musiclist/music_list_star_get",function(L,b){cc.isValid(this.node)&&(this.mSpecStar1.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_star_unget",function(L,b){cc.isValid(this.node)&&(this.mSpecStar2.spriteFrame=b,this.mSpecStar3.spriteFrame=b)}.bind(this));break;case 2:u.default.get("/musiclist/music_list_star_get",function(L,b){cc.isValid(this.node)&&(this.mSpecStar1.spriteFrame=b,this.mSpecStar2.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_star_unget",function(L,b){cc.isValid(this.node)&&(this.mSpecStar3.spriteFrame=b)}.bind(this));break;case 3:u.default.get("/musiclist/music_list_star_get",function(L,b){cc.isValid(this.node)&&(this.mSpecStar1.spriteFrame=b,this.mSpecStar2.spriteFrame=b,this.mSpecStar3.spriteFrame=b)}.bind(this));break;case 4:u.default.get("/musiclist/music_list_crown_get",function(L,b){cc.isValid(this.node)&&(this.mSpecCrown1.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_crown_unget",function(L,b){cc.isValid(this.node)&&(this.mSpecCrown2.spriteFrame=b,this.mSpecCrown3.spriteFrame=b)}.bind(this));break;case 5:u.default.get("/musiclist/music_list_crown_get",function(L,b){cc.isValid(this.node)&&(this.mSpecCrown1.spriteFrame=b,this.mSpecCrown2.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_crown_unget",function(L,b){cc.isValid(this.node)&&(this.mSpecCrown3.spriteFrame=b)}.bind(this));break;case 6:u.default.get("/musiclist/music_list_crown_get",function(L,b){cc.isValid(this.node)&&(this.mSpecCrown1.spriteFrame=b,this.mSpecCrown2.spriteFrame=b,this.mSpecCrown3.spriteFrame=b)}.bind(this))}},M.prototype.setLevelIcon=function(D){switch(D<4?(this.mStarIconGroup.node.width=152,this.mStarIconGroup.node.height=54,this.mStarIconGroup.node.x=-132,this.mStarIconGroup.node.y=-39,this.mStarIcon1.node.width=44,this.mStarIcon1.node.height=54,this.mStarIcon1.node.x=-54,this.mStarIcon1.node.y=0,this.mStarIcon2.node.width=44,this.mStarIcon2.node.height=54,this.mStarIcon2.node.x=0,this.mStarIcon2.node.y=0,this.mStarIcon3.node.width=44,this.mStarIcon3.node.height=54,this.mStarIcon3.node.x=54):(this.mStarIconGroup.node.width=160,this.mStarIconGroup.node.height=54,this.mStarIconGroup.node.x=-130,this.mStarIconGroup.node.y=-31,this.mStarIcon1.node.width=48,this.mStarIcon1.node.height=46,this.mStarIcon1.node.x=-56,this.mStarIcon1.node.y=0,this.mStarIcon2.node.width=48,this.mStarIcon2.node.height=46,this.mStarIcon2.node.x=0,this.mStarIcon2.node.y=0,this.mStarIcon3.node.width=48,this.mStarIcon3.node.height=46,this.mStarIcon3.node.x=56),this.mStarIcon3.node.y=0,D){case 0:u.default.get("/musiclist/music_list_star_unget",function(L,b){cc.isValid(this.node)&&(this.mStarIcon1.spriteFrame=b,this.mStarIcon2.spriteFrame=b,this.mStarIcon3.spriteFrame=b)}.bind(this));break;case 1:u.default.get("/musiclist/music_list_star_get",function(L,b){cc.isValid(this.node)&&(this.mStarIcon1.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_star_unget",function(L,b){cc.isValid(this.node)&&(this.mStarIcon2.spriteFrame=b,this.mStarIcon3.spriteFrame=b)}.bind(this));break;case 2:u.default.get("/musiclist/music_list_star_get",function(L,b){cc.isValid(this.node)&&(this.mStarIcon1.spriteFrame=b,this.mStarIcon2.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_star_unget",function(L,b){cc.isValid(this.node)&&(this.mStarIcon3.spriteFrame=b)}.bind(this));break;case 3:u.default.get("/musiclist/music_list_star_get",function(L,b){cc.isValid(this.node)&&(this.mStarIcon1.spriteFrame=b,this.mStarIcon2.spriteFrame=b,this.mStarIcon3.spriteFrame=b)}.bind(this));break;case 4:u.default.get("/musiclist/music_list_crown_get",function(L,b){cc.isValid(this.node)&&(this.mStarIcon1.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_crown_unget",function(L,b){cc.isValid(this.node)&&(this.mStarIcon3.spriteFrame=b,this.mStarIcon2.spriteFrame=b)}.bind(this));break;case 5:u.default.get("/musiclist/music_list_crown_get",function(L,b){cc.isValid(this.node)&&(this.mStarIcon1.spriteFrame=b,this.mStarIcon2.spriteFrame=b)}.bind(this)),u.default.get("/musiclist/music_list_crown_unget",function(L,b){cc.isValid(this.node)&&(this.mStarIcon3.spriteFrame=b)}.bind(this));break;case 6:u.default.get("/musiclist/music_list_crown_get",function(L,b){cc.isValid(this.node)&&(this.mStarIcon1.spriteFrame=b,this.mStarIcon2.spriteFrame=b,this.mStarIcon3.spriteFrame=b)}.bind(this))}},M.prototype.setLevel=function(D){this.mLevellayout.node.active=!0,this.mLevelValueLabel.string=""+D},M.prototype.removeLevel=function(){this.mLevellayout.node.active=!1},M.prototype.onDestroy=function(){console.log("[MusicPage] onDestory"),this.unregisterEvents()},M.exceptionMoreId=-999999,M.SOURCE_DEFAULT=0,M.SOURCE_UPDATE_CONTENT=1,__decorate([T(cc.Sprite)],M.prototype,"mLevellayout",void 0),__decorate([T(cc.Label)],M.prototype,"mLevelValueLabel",void 0),__decorate([T(cc.Label)],M.prototype,"mMusicIndexLabel",void 0),__decorate([T(cc.Label)],M.prototype,"mMusicName",void 0),__decorate([T(cc.Label)],M.prototype,"mMusicianLabel",void 0),__decorate([T(cc.Layout)],M.prototype,"mStarIconGroup",void 0),__decorate([T(cc.Sprite)],M.prototype,"mStarIcon1",void 0),__decorate([T(cc.Sprite)],M.prototype,"mStarIcon2",void 0),__decorate([T(cc.Sprite)],M.prototype,"mStarIcon3",void 0),__decorate([T(cc.Button)],M.prototype,"mRankBtn",void 0),__decorate([T(cc.Button)],M.prototype,"mStartBtn",void 0),__decorate([T(cc.Label)],M.prototype,"mOpenLevelLabel",void 0),__decorate([T(cc.Sprite)],M.prototype,"mBg",void 0),__decorate([T(cc.Label)],M.prototype,"mExceptMoreLabel",void 0),__decorate([T(cc.Node)],M.prototype,"mNormalBg",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecialBg",void 0),__decorate([T(cc.Label)],M.prototype,"mSpecMusicNameLabe",void 0),__decorate([T(cc.Label)],M.prototype,"mSpecMusicianLabel",void 0),__decorate([T(cc.Label)],M.prototype,"mSpecMusicIndexLabel",void 0),__decorate([T(cc.Label)],M.prototype,"mSpecStarConditionLable",void 0),__decorate([T(cc.Node)],M.prototype,"mSpecStarNode",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecStar1",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecStar2",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecStar3",void 0),__decorate([T(cc.Node)],M.prototype,"mSpecCrownNode",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecCrown1",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecCrown2",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecCrown3",void 0),__decorate([T(cc.Label)],M.prototype,"mSpecStarConditionWidthIconLable",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecRankIcon",void 0),__decorate([T(cc.Button)],M.prototype,"mSpecStartBtn",void 0),__decorate([T(cc.Label)],M.prototype,"mSpecUnlockLevelLabel",void 0),__decorate([T(cc.Node)],M.prototype,"mSpecUnlockStarNode",void 0),__decorate([T(cc.Sprite)],M.prototype,"mSpecUnlockMarkSprite",void 0),__decorate([T(cc.Label)],M.prototype,"mSpecStartBtnLabel",void 0),M=k=__decorate([C],M)}(cc.Component);m.default=E,cc._RF.pop()},{"../../../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../../base/G":"G","../../../../base/State":"State","../../../../config/LSKey":"LSKey","../../../../gamescene/GameSceneSetting":"GameSceneSetting","../../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../../util/PU":"PU","../../../../util/StringUtil":"StringUtil","../../../Logic/EventBus":"EventBus","../../../Logic/I18nManager":"I18nManager","../../../Logic/NotifyEvent":"NotifyEvent","../../../Logic/Plugin/IPlugin":"IPlugin","../../../Logic/Plugin/PluginMgr":"PluginMgr","../../../Network/Protocol/StorageUtil":"StorageUtil","../../../skin/SkinUtils":"SkinUtils","../../UserInfoManager":"UserInfoManager","../BasicTouchEvent":"BasicTouchEvent","../ImgCache":"ImgCache"}],NormalReliveTimesTask:[function(l,P,m){"use strict";cc._RF.push(P,"0357bMrLQxBEruWgr5O/86V","NormalReliveTimesTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],NotifyEvent:[function(l,P,m){"use strict";cc._RF.push(P,"c162eD2rf5L0ZyzMixUIw8i","NotifyEvent"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.COIN_UPDATE="coin_update",s.HP_REVIVE="hp_revive",s.LOADING_DOWNLOAD="loading_download",s.LOADING_IMAGE="loading_image",s.LOADING_DB="loading_db",s.LOADING_UI_NOTIFY="loading_ui_change",s.LOADING_ONLOAD="loading_onload",s.HP_NOT_ENOUGH_ITEM_CLICK="hp_not_enough_item_click",s.HP_NOT_ENOUGH_IMMEDIATELY_CHALLENGE="hp_not_enough_immediately_challenge",s.SHOW_HOME_RANK_PAGE="show_home_rank_page",s.SHOW_RESULT_RANK_PAGE="show_result_rank_page",s.DO_ENERGY_USE_ANIMATION="do_energy_use_animation",s.SHOW_HOMEPAGE_EVENT_TOP_MASK="show_homepage_event_stop_mask",s.HIDE_HOMEPAGE_EVENT_TOP_MASK="hide_homepage_event_stop_mask",s.RANK_SHARE_GROUP_FIRST="rank_share_group_first",s.SHOW_SHARE_GROUP_DIALOG="show_share_group_succ_dialog",s.LIFE_CYCLE_ON_SHOW="life_cycle_on_show",s.LIFE_CYCLE_ON_HIDE="life_cycle_on_hide",s.LOADING_SKIN="loading_skin",s.DAILY_GET_AWARD="daily_get_award",s.UPDATE_SHARE_GIFT_TIPS="update_share_gift_tips",s.PLAY_LOCK_MUSIC_IN_RANK="play_lock_music_in_rank",s.UPDATE_SKIN_STORE_UI="update_skin_store_ui",s.SHOW_TEST_MONEY_NOT_ENOUGH_TOAST="show_test_money_not_enough_toast",s.SHOW_MUSIC_LIB_UNLOCK_DIALOG="show_music_lib_unlock_dialog",s.UPDATE_MUSIC_LIST_CURRENT_TIME="update_music_list_current_time",s.UPDATE_MUSIC_LIST_HEIGHT="update_music_list_height",s.INVITE_SONG_LOOPER_START="invite_song_looper_start",s.INVITE_SONG_LOOPER_STOP="invite_song_looper_stop",s.INVITE_CHECK_ACTIVITY_SONG="invite_check_activity_song",s.FIRST_PAY_UNLOCK_SKIN="first_pay_unlock_skin",s.HIDE_GUIDE_FINGER="hide_guide_finger",s.REFRESH_HOMEPAGE_NEW_TARGET_RED_SPOT="refresh_homepage_new_target_red_spot",s.REWARTDPANEL_SHOW_SKINSTORE="rewardPanel_show_skinstore",s.REWARTDPANEL_SHOW_PIECE="rewardPanel_show_piece",s.BUY_VIP_SUCCESS_NOTIFICATION="buy_vip_success_notification",s.VIP_TAKEN_DAILY_REWARD="vip_taken_daily_reward",s.NOTIFY_MUSIC_LIBRARY_UPDATE="notify_music_library_update",s.UPDATE_WX_VERSION_TOAST="update_wx_version_toast",s.SHARE_RESULT_SHOW_INVITE_TIPS="share_result_show_invite_tips",s.SHARE_HOME_SHOW_INVITE_TIPS="share_home_show_invite_tips",s.SHARE_CHALLENGE_RESULT_SHOW_INVITE_TIPS="share_challenge_result_show_invite_tips",s.CHALLENGE_RESULT_SHOW_MUSIC_LIB_UNLOCK_DIALOG="challenge_result_show_music_lib_unlock_dialog",s.CHALLENGE_RESULT_SHOW_TEST_MONEY_NOT_ENOUGH_TOAST="challenge_result_show_test_money_not_enough_toast",s.NOTIFY_CHALLENGE_RESULT_MUSIC_LIBRARY_UPDATE="notify_challenge_result_music_library_update",s.SPEC_SONG_TRY_SKIN_HOME="spec_song_try_skin_home",s.SPEC_SONG_TRY_SKIN_RESULT="spec_song_try_skin_result",s.LOAD_MUSIC="load_music",s.ON_RESULT_RANK_BACK_CLICK="on_result_rank_back_click",s.FIGHT_PROP_BUY_UPDATE="fight_prop_buy_update",s.FIGHT_PROP_GET_REWARD_UPDATE="fight_prop_get_reward_update",s.SHOW_BATTLE_GAME_QUIT="show_battle_game_quit",s.SKIN_TASK_ADD_FRAGS="skin_task_add_frags",s.SKIN_TASK_GOLY_BUY_NOT_ENOUGH="skin_task_gold_buy_not_enough",s.SKIN_TASK_UPDATE_PIECES_UI="skin_task_update_pieces_ui",s.SKIN_PIECES_UNLOCK="skin_pieces_unlock",s.SKIN_UPDATE_STEP_UPDATE_UI="skin_update_step_update_ui",s.SKIN_TASK_CACHE_UPDATE_UI="skin_task_cache_update_ui",s.SKIN_TRY_FINISH_SHOW_GAIN="skin_try_finish_show_gain",s.UPDATE_SKIN_PIECES_TIPS="update_skin_pieces_tips",s.FIRST_PAY_BTN_CLICK="first_pay_btn_click",s.FIRST_PAY_SHOW_SHOP="first_pay_show_shop",s.WELFARE_SHOW_FRESH="welfare_show_fresh",s.UNLOCK_NORMAL_SKIN_EVENT="unlock_normal_skin",s.GAIN_REWARD_FROM_DESCRIPTION="gain_reward_from_description",s.UNLOCK_SKIN_PERMANENT="unlcok_skin_permanent",s.DIAMOND_BUY_TRUMPET_NOT_ENOUGH="diamond_buy_trumpet_not_enough",s.CHAT_FIGHT_SEND_SUCCESS="chat_fight_send_success",s.CHAT_FIGHT_MESSAGE_ENABLE="chat_fight_message_enable",s.CHAT_ACCEPT_FIGHT_SUCCESS="chat_accept_fight_success",s.NEW_GUIDE_GO_CLICK="new_guide_go_click",s.PERSONAL_PANEL_TO_CHAT="personal_panel_to_chat",s.OWN_CHAT_PRIVATE_FIGHT_MESSAGE="own_chat_private_fight_message",s.UPDATE_FRIEND_INFO="update_friend_info",s.TASK_ITEM_FINISH="task_finish_item",s.TASK_ITEM_GO_FIGHT="task_item_go_fight",s.TASK_ITEM_UPDATE_WELF_STEP="task_item_update_welf_step",s.TASK_ITEM_SHARE_TO_CHECK="task_item_share-to_check",s.RCM_SHOW_MAIN_ENTRY_ICO="rcm_show_main_entry_ico",s.CM_SKIN_ADS_UNLOCK="cm_skin_ads_unlock",s.PLAY_TRIAL_FINISHED="play_trail_finished",s}();m.default=d,cc._RF.pop()},{}],NumberFrameLoader:[function(l,P,m){"use strict";cc._RF.push(P,"2c317qq1h9L7r6QMgwWKSxo","NumberFrameLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../atlas/SimpleAtlas"),s=function(){function r(){this.mNumberSimpleAtlas=null,this.mInit=!1,this.mNumberSimpleAtlas=new d.default}return r.getInstance=function(){return r.sInstance==null&&(r.sInstance=new r),r.sInstance},r.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return this.mInit?[2]:(this.mInit=!0,[4,this.mNumberSimpleAtlas.load("gameImage/numberAtlas")]);case 1:return o.sent(),[2]}})})},r.prototype.getAtlas=function(){return this.mNumberSimpleAtlas},r.prototype.getItemRect=function(){return this.mNumberSimpleAtlas.getItem("white_0").rect},r.sInstance=null,r}();m.default=s,cc._RF.pop()},{"../../atlas/SimpleAtlas":"SimpleAtlas"}],NumberUtil:[function(l,P,m){"use strict";cc._RF.push(P,"118c1CweQhF058LJ3Fhp6k5","NumberUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.parseNum=function(r,o){return o===void 0&&(o=0),isNaN(+(r+""))?o:+(r+"")},s.parseIntFromString=function(r){if(!r)return 0;var o=parseInt(r);return Number.isNaN(o)?0:o},s}();m.default=d,cc._RF.pop()},{}],ObjectPool:[function(l,P,m){"use strict";cc._RF.push(P,"310acAGVe1MCrFv0uQZpPXJ","ObjectPool"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r,o){o===void 0&&(o=-1),this.objects=null,this.createFunc=null,this.exist=0,this.capacity=-1,this.createFunc=r,this.capacity=o,0<this.capacity?this.objects=new Array(o):this.objects=[]}return s.prototype.get=function(){if(this.exist<=0)return this.createFunc();var r=this.objects[this.exist-1];return this.objects[this.exist-1]=null,--this.exist,r},s.prototype.put=function(r){return!(0<=this.capacity&&this.exist>=this.capacity)&&(++this.exist,this.objects[this.exist-1]=r,!0)},s.prototype.clear=function(){this.objects=[]},s}();m.default=d,cc._RF.pop()},{}],OperatingCount:[function(l,P,m){"use strict";cc._RF.push(P,"a85a9Jk8upC47hzjeJUvnki","OperatingCount"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../libs/base64.js"),s=function(){function o(){this.valid=!1,this.touchMoved=!1,this.touchBlockPosX=0,this.touchBlockPosY=0,this.touchScreenPosX=0,this.touchScreenPosY=0,this.startTime=0,this.endTime=0,this.touchScore=0,this.blockType=0,this.slotIndex=0}return o.prototype.clone=function(){var e=new o;return e.set(this),e},o.prototype.set=function(e){this.valid=e.valid,this.touchMoved=e.touchMoved,this.touchBlockPosX=e.touchBlockPosX,this.touchBlockPosY=e.touchBlockPosY,this.touchScreenPosX=e.touchScreenPosX,this.touchScreenPosY=e.touchScreenPosY,this.startTime=e.startTime,this.endTime=e.endTime,this.touchScore=e.touchScore,this.blockType=e.blockType,this.slotIndex=e.slotIndex},o.prototype.serialize=function(e){e.setInt16(0,Math.min(Math.floor(this.touchBlockPosX),32767)),e.setInt16(2,Math.min(Math.floor(this.touchBlockPosY),32767)),e.setInt16(4,Math.min(Math.floor(this.touchScreenPosX),32767)),e.setInt16(6,Math.min(Math.floor(this.touchScreenPosY),32767)),e.setUint16(8,Math.min(this.endTime-this.startTime,65535)),e.setUint8(10,Math.min(this.touchScore,255)),e.setUint8(11,this.blockType),e.setUint8(12,this.touchMoved?1:0),e.setFloat64(13,Math.floor(this.startTime)),e.setUint8(21,this.slotIndex)},o.SIZE=function(){return 22},o}();m.OperatingCountItem=s;var r=function(){function o(){this.itemLimit=1e3,this.version=6,this.playTime=0,this.musicId=0,this.totalScore=0,this.fps=0,this.blockHeight=0,this.apm=0,this.items=[],this.fpsArray=[],this.userLevel=0,this.userDiamond=0,this.userHp=0,this.touchedCount=0}return o.prototype.usefull=function(){return this.items&&0<this.items.length},o.prototype.serialize=function(){try{var e={};e.ver=this.version,e.musicid=this.musicId,e.playtime=Math.floor(1e3*this.playTime),e.score=Math.floor(this.totalScore),e.fps=Math.floor(this.fps),e.apm=Math.floor(1e3*this.apm);var n=this.packageItems(),t=this.ArrayBufferToString(n),i=new d.default().encode(t);return e.data=i,e}catch(a){console.log("--- serialize error: ---",a)}},o.prototype.reset=function(){this.items=[],this.playTime=0,this.musicId=0,this.totalScore=0,this.fps=0,this.blockHeight=0,this.fpsArray=[],this.userLevel=0,this.userDiamond=0,this.userHp=0,this.touchedCount=0,console.log("--- reset ---")},o.prototype.addItem=function(e){this.touchedCount++,this.items===null&&(this.items=new Array),this.items.length>=this.itemLimit||this.items.push(e.clone())},o.prototype.setItemLimit=function(e){this.itemLimit=e},o.prototype.setPlayTime=function(e){this.playTime=e},o.prototype.addPlayTime=function(e){this.playTime+=e},o.prototype.setMusicId=function(e){this.musicId=e},o.prototype.setTotalScore=function(e){this.totalScore=e},o.prototype.setFPS=function(e){this.fps=Math.floor(e)},o.prototype.setBlockHeight=function(e){this.blockHeight=e},o.prototype.setAPM=function(e){this.apm=e},o.prototype.setFpsArray=function(e){this.fpsArray=e},o.prototype.setUserLevel=function(e){this.userLevel=e},o.prototype.setUserDiamond=function(e){this.userDiamond=e},o.prototype.setUserHp=function(e){this.userHp=e},o.prototype.packageItems=function(){var e=this.items?this.items.length:0,n=s.SIZE(),t=this.fpsArray,i=t.length,a=new ArrayBuffer(64+e*n+1*i),u=new DataView(a),c=Math.floor(this.userLevel||0),p=Math.floor(this.userDiamond||0),h=Math.floor(this.userHp||0),f=this.touchedCount;console.log("packageItems itemCount",e),u.setUint8(0,this.version),u.setUint16(1,e),u.setUint8(3,i),u.setUint16(4,Math.floor(this.blockHeight)),u.setUint16(8,c),u.setUint16(12,p),u.setUint16(16,h),u.setUint16(20,f);for(var g=0;g<e;++g){var _=new DataView(a,64+g*n,n);this.items[g].serialize(_)}var y=64+e*n;return this.setFPSArray(t,a,y,1),a},o.prototype.ArrayBufferToString=function(e){for(var n="",t=new Uint8Array(e),i=0,a=t.byteLength;i<a;i++)n+=String.fromCharCode(t[i]);return n},o.prototype.setFPSArray=function(e,n,t,i){for(var a=new DataView(n,t,e.length*i),u=0,c=0,p=e;c<p.length;c++){var h=p[c];a.setUint8(u++,h)}},o}();m.default=r,cc._RF.pop()},{"../../libs/base64.js":"base64"}],OvertakeFriendModule:[function(l,P,m){"use strict";cc._RF.push(P,"3d62dxbrztNjIFTmA7w+7wy","OvertakeFriendModule"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Social/OvertakeFriend"),s=l("../MUI/MUIDrawNode"),r=l("../../base/G"),o=l("../animation/action/MSequence"),e=l("../animation/action/MDelay"),n=l("../animation/action/MCallFunc"),t=l("../GameBus"),i=l("../../util/SUtil"),a=function(){function u(){this.FRAME_TIME=1/60}return u.prototype.load=function(){this.mOvertakeFriend=new d.default,this.mOvertakeFriend&&this.mOvertakeFriend.startup()},u.prototype.destroy=function(){this.mOvertakeFriend&&(this.mOvertakeFriend.shutdown(),this.mOvertakeFriend=null)},u.prototype.prepare=function(){},u.prototype.start=function(){this.mOvertakeFriend&&(this.mOvertakeFriend.refresh(),this.mOvertakeFriend.updateScore())},u.prototype.pause=function(){this.mOvertakeFriend&&this.mOvertakeFriend.pause()},u.prototype.resume=function(){this.mOvertakeFriend&&this.mOvertakeFriend.resume()},u.prototype.update=function(){return this.showAnim(),!0},u.prototype.showAnim=function(){var c=this;this.mOvertakeFriend&&(this.mAnim||(this.mAnim=new o.default(new e.default(2*this.FRAME_TIME),new n.default(function(){c.mOvertakeFriend&&c.mOvertakeFriend.updateScore()}))),this.mAnim.getTarget()||t.default.getInstance().animationMgr.runAction(this.mUINode,this.mAnim))},u.prototype.showNode=function(){this.mUINode&&this.mUINode.setVisible(!0)},u.prototype.hideNode=function(){this.mUINode&&this.mUINode.setVisible(!1)},u.prototype.getUINode=function(){var c=this;if(!this.mUINode){var p=new s.default(function(h,f){if(c.mOvertakeFriend){var g=c.mOvertakeFriend.getImage();if(g){var _=Math.floor(f.centerX),y=Math.floor(h.canvas.height-f.centerY);h.translate(_,y);var S=-(f.width>>>1),I=-(f.height>>>1);h.drawImage(g,0,0,g.width,g.height,S,I,f.width,f.height),h.translate(-_,-y)}}},"FriendHeader");p.move(14,r.G.Ap.config.presentHeight-117,260,100),this.mUINode=p,this.adaptUI()}return this.mUINode},u.prototype.adaptUI=function(){this.mUINode&&(i.SUtil.ins().isLiuHai()?this.mUINode.move(14,r.G.Ap.config.presentHeight-171,260,100):i.SUtil.ins().isQuanMian()&&this.mUINode.move(14,r.G.Ap.config.presentHeight-123,260,100))},u}();m.default=a,cc._RF.pop()},{"../../base/G":"G","../../util/SUtil":"SUtil","../GameBus":"GameBus","../MUI/MUIDrawNode":"MUIDrawNode","../Social/OvertakeFriend":"OvertakeFriend","../animation/action/MCallFunc":"MCallFunc","../animation/action/MDelay":"MDelay","../animation/action/MSequence":"MSequence"}],OvertakeFriend:[function(l,P,m){"use strict";cc._RF.push(P,"0955fXFrdhDJqks0d1N042Q","OvertakeFriend"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../social/SocialHelper"),s=l("../../base/G"),r=l("../../business/Logic/PlayerMgr"),o=l("../../util/PU"),e=function(){function n(){this.sharedCanvas=null,this.scoreParam={src:"src_game_playing",score:0}}return n.prototype.refresh=function(){if(!s.G.Ap.config.debugNoOvertake&&cc.sys.platform==cc.sys.WECHAT_GAME){var t=wx.getOpenDataContext().canvas;t.width=260,t.height=100,this.sharedCanvas=t}},n.prototype.pause=function(){s.G.Ap.config.debugNoOvertake||(this.sharedCanvas=null,d.SocialHelper.exitDrawRanking({src:"src_game_playing",pause:!0}))},n.prototype.resume=function(){s.G.Ap.config.debugNoOvertake||this.startup(!0)},n.prototype.startup=function(t){if(t===void 0&&(t=!1),!s.G.Ap.config.debugNoOvertake){var i=s.G.Ap.state;this.refresh(),d.SocialHelper.drawRanking({src:"src_game_playing",songId:i.mission.musicId,grade:r.default.Ins().getUserLevel(),levelId:i.mission.levelId,isResume:t,benchmarkLevel:o.default.benchmarkLevel,score:0})}},n.prototype.shutdown=function(){s.G.Ap.config.debugNoOvertake||(this.sharedCanvas=null,d.SocialHelper.exitDrawRanking({src:"src_game_playing",pause:!1}))},n.prototype.updateScore=function(){s.G.Ap.config.debugNoOvertake||(this.scoreParam.score=s.G.Ap.state.attainScore,d.SocialHelper.syncDrawRanking(this.scoreParam))},n.prototype.getImage=function(){return s.G.Ap.config.debugNoOvertake?null:this.sharedCanvas},n}();m.default=e,cc._RF.pop()},{"../../base/G":"G","../../business/Logic/PlayerMgr":"PlayerMgr","../../social/SocialHelper":"SocialHelper","../../util/PU":"PU"}],PU:[function(l,P,m){"use strict";cc._RF.push(P,"e17ecS04DxM8J3iAgWKyloa","PU"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/G"),s=l("../business/Network/Protocol/StorageUtil"),r=l("../config/LSKey"),o=l("../LogicPlatform/PlatformProxy"),e=l("../../modules/MGUtils/TypeDefinition"),n=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),t=l("../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),i=l("../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance"),a=l("../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),u=l("../../modules/MGUtils/MGPlatform"),c=l("../base/Log"),p=function(){function h(){}return h.init=function(){if(h.isWeiXin()){var f=u.MGPlatform.getSystemInfoSync();h.SDKVersion=f.SDKVersion,h.windowWidth=f.windowWidth,h.windowHeight=f.windowHeight,h.pixelRatio=f.pixelRatio,h.benchmarkLevel=f.benchmarkLevel,h.wxVersion=f.version,h.benchmarkLevel==null&&cc.sys.os===cc.sys.OS_IOS&&(h.benchmarkLevel=15),console.warn("BenchmarkLevel: "+h.benchmarkLevel),console.warn(f);var g=f.platform.toLowerCase(),_=f.system.toLowerCase();h.particalSystemCompat=g!=="ios"||_.search("ios 8")==-1}else h.particalSystemCompat=!0,h.mSupportCMOnshare=!!(h.isCM()&&window.GameJs&&window.GameJs.onShare),c.default.i("PU msupportCMONSHare",h.mSupportCMOnshare)},h.getPlatformType=function(f){return h.sPlatformType=e.PlatformType.PLATFORM_CMPLAY},h.guessPlatformType=function(f){var g=e.PlatformType.PLATFORM_WEB;return cc.sys.platform==cc.sys.WECHAT_GAME?f=="wechat"?g=e.PlatformType.PLATFORM_WECHAT:f=="h5sdk"?g=e.PlatformType.PLATFORM_H5SDK:f=="qqhall"&&(g=e.PlatformType.PLATFORM_GAMEHALL):g=typeof FBInstant!="undefined"?e.PlatformType.PLATFORM_FACEBOOK:cc.sys.platform==cc.sys.QQ_PLAY?e.PlatformType.PLATFORM_QQPLAY:cc.sys.isBrowser&&f=="cmplay"?e.PlatformType.PLATFORM_CMPLAY:e.PlatformType.PLATFORM_WEB,g},h.initGameModel=function(f,g){var _=this.getPlatformType(f.platform);n.MGUser.init(_,f.gameid,f.appid,f.version,g),t.MGBasic.init(_),o.default.init(_)},h.initGameUserModel=function(f,g,_){var y=this,S=this.getPlatformType(f.platform);n.MGUser.getUserLoginInfo({success:function(I){var v=I.playerId,C=I.token;cmg.platform.init(f.appid,f.version,f.gameid,S,v,C,g),y.initUseLocalTimeSetting(),i.MGCloudStorage.init(S,f.gameid,C,v,g),a.MGAdv.init(S),_(!0)},fail:function(){console.error("\u6CE8\u610F\uFF0C\u6CE8\u610F\uFF1A\u521D\u59CB\u5316\u6A21\u5757\u5931\u8D25\u4E86\uFF0C\u8BF7\u68C0\u67E5GameId\u3001AppId\u662F\u5426\u6B63\u786E\uFF01"),_(!1)}})},h.initUseLocalTimeSetting=function(){var f=s.default.read(r.default.CMG_DEBUG_USE_LOCAL_TIME);n.MGUser.switchUseLocalTime(f=="1")},h.isWeiXin=function(){return cc.sys.platform==cc.sys.WECHAT_GAME},h.isWeb=function(){return cc.sys.platform==cc.sys.DESKTOP_BROWSER},h.isQQ=function(){return cc.sys.platform==cc.sys.QQ_PLAY},h.isIOS=function(){return cc.sys.os==cc.sys.OS_IOS},h.isAndroid=function(){return cc.sys.os===cc.sys.OS_ANDROID},h.isCM=function(){return!0},h.supportCMOnshare=function(){return c.default.i("PU supportCMOnshare ",h.mSupportCMOnshare),h.mSupportCMOnshare},h.calculationBenchmarkLevel=function(f){if(!(this.sBenchmarkLevelCount>h.BENCHMARK_LEVEL_MAX_COUNT||d.G.Ap.state.isPaused())){if(h.sBenchmarkLevelCount==0){var g=s.default.read(r.default.BENCHMARK_LEVEL);if(g&&0<g.length)return void(this.sBenchmarkLevelCount=h.BENCHMARK_LEVEL_MAX_COUNT+1)}if(this.sBenchmarkLevelCount<h.BENCHMARK_LEVEL_MAX_COUNT&&(this.sBenchmarkLevelTotal+=f,this.sBenchmarkLevelCount++),this.sBenchmarkLevelCount==h.BENCHMARK_LEVEL_MAX_COUNT){var _=this.sBenchmarkLevelTotal/this.sBenchmarkLevelCount;s.default.save(r.default.BENCHMARK_LEVEL,_.toString()),this.sBenchmarkLevelTotal+=f,this.sBenchmarkLevelCount++}}},h.getResourcePath=function(f){if(f){var g=cc.url.raw(f);return(h.isWeiXin()||h.isQQ())&&(cc.loader.md5Pipe&&(g=cc.loader.md5Pipe.transformURL(g)),g=o.default.Ins().getUserDataPath()+"/"+g),g}},h.is3DTouchCompat=function(){return cc.sys.os===cc.sys.OS_IOS},h.sPlatformType=e.PlatformType.PLATFORM_UNKNOWN,h.SDKVersion="",h.windowWidth=0,h.windowHeight=0,h.pixelRatio=0,h.benchmarkLevel=0,h.wxVersion="",h.sBenchmarkLevelTotal=0,h.sBenchmarkLevelCount=0,h.BENCHMARK_LEVEL_MAX_COUNT=400,h.particalSystemCompat=void 0,h.mSupportCMOnshare=!1,h}();m.default=p,cc._RF.pop()},{"../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance":"MGCloudStorageEntrance","../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../modules/MGUtils/MGPlatform":"MGPlatform","../../modules/MGUtils/TypeDefinition":"TypeDefinition","../LogicPlatform/PlatformProxy":"PlatformProxy","../base/G":"G","../base/Log":"Log","../business/Network/Protocol/StorageUtil":"StorageUtil","../config/LSKey":"LSKey"}],PageHeap:[function(l,P,m){"use strict";cc._RF.push(P,"d3472Y0MthAhKnxwuyH4m5y","PageHeap"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/Log"),s=function(){function r(){this.Pages=[]}return r.Ins=function(){return this._Ins||(this._Ins=new r),this._Ins},r.prototype.pushScene=function(o){this.clear(),this.push(o)},r.prototype.ignore=function(o){return 0<=r.IGNORE_LIST.indexOf(o)},r.prototype.push=function(o){this.ignore(o)||(this.Pages.push(o),d.default.l("[PageHeap.push] pages="+this.toString()))},r.prototype.pop=function(o){this.ignore(o)||(this.Pages.length!=0?this.Pages[this.Pages.length-1]==o?(this.Pages.pop(),d.default.l("[PageHeap.pop] pages="+this.toString())):d.default.e("[PageHeap.pop] page error! "):d.default.e("[PageHeap.pop] Pages is empty!"))},r.prototype.clear=function(){d.default.l("[PageHeap.clear] count="+this.Pages.length),0<this.Pages.length&&this.Pages.splice(0,this.Pages.length)},r.prototype.toString=function(){return this.Pages.length==0?"":this.Pages.join("_")},r.IGNORE_LIST=["PlayerInfoPopupProfab"],r}();m.default=s,cc._RF.pop()},{"../base/Log":"Log"}],ParticleSystemVM:[function(l,P,m){"use strict";cc._RF.push(P,"3ce5fMRXEFDi7el5NeISaCe","ParticleSystemVM"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PU"),s=function(){function o(e,n){this.setParentNode(e),this.setChildren(n)}return o.prototype.setParentNode=function(e){this.parentNode=e},o.prototype.getParentNode=function(){return this.parentNode},o.prototype.setChildren=function(e){this.children=e},o.prototype.getChildren=function(){return this.children},o.prototype.start=function(){for(var e=0,n=this.children;e<n.length;e++){var t=n[e],i=t.getName(),a=this.parentNode.getChildByName(i),u=a?a.addComponent(cc.ParticleSystem):void 0;u&&(u.autoRemoveOnFinish=t.getAutoRemove(),u.playOnLoad=t.getPlayOnLoad(),u.file=d.default.getResourcePath(o.ROOT_PATH+"/"+t.getPlistPath()))}},o.ROOT_PATH="resources/particle",o}();m.ParticleSystemVM=s;var r=function(){function o(e,n,t,i){this.setPlayOnLoad(e),this.setAutoRemove(n),this.setName(t),this.setPlistPath(i)}return o.prototype.setPlayOnLoad=function(e){this.playOnLoad=e},o.prototype.getPlayOnLoad=function(){return this.playOnLoad},o.prototype.setAutoRemove=function(e){this.autoRemove=e},o.prototype.getAutoRemove=function(){return this.autoRemove},o.prototype.setName=function(e){this.name=e},o.prototype.getName=function(){return this.name},o.prototype.setPlistPath=function(e){this.plistPath=e},o.prototype.getPlistPath=function(){return this.plistPath},o}();m.ParticleSystemChild=r,cc._RF.pop()},{"./PU":"PU"}],Performance:[function(l,P,m){"use strict";cc._RF.push(P,"9765db/sZJNFYALKX/R1p1h","Performance"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../base/G");(s=d=m.PERFORMANCE_STATUS||(m.PERFORMANCE_STATUS={}))[s.Begin=0]="Begin",s[s.End=1]="End",s[s.Resume=2]="Resume",s[s.Pause=3]="Pause",function(o){var e=function(){this.preTime=0,this.id=0,this.runTimes=0,this.totolTime=0,this.lastRunDuration=0};o.Item=e;var n=function(){function i(a){a===void 0&&(a=.022),this.slowValue=1,this.performance=null,this.runInfos=[],this.runDuration=0,this.runTimes=0,this.jumpTimes=0,this.jumpDuration=0,this.totalJumpTimes=0,this.totalJumpDuration=0,this.status=null,this.fpsArray=[],this.slowValue=a,window.performance&&(this.performance=window.performance)}return i.prototype.update=function(a){var u=this.getStatus();if(u===d.Begin||u===d.Resume){this.runDuration+=a,this.runTimes++;var c=Math.floor(r.G.Ap.state.attainScore),p=this.getFPS();this.addFPS(p,c)}},i.prototype.updateAndAutoLog=function(a){this.runDuration+=a,this.runTimes++,a>=this.slowValue&&(this.jumpTimes++,this.jumpDuration+=a,this.totalJumpTimes++,this.totalJumpDuration+=a),this.runTimes%600==0&&(console.log("Jump:"+this.runDuration+" times:"+this.jumpTimes+" avg = "+(0<this.jumpTimes?this.jumpDuration/this.jumpTimes:0)),console.log("All times:"+this.totalJumpTimes+" avg = "+(0<this.totalJumpTimes?this.totalJumpDuration/this.totalJumpTimes:0)),this.jumpTimes=0,this.jumpDuration=0)},i.prototype.getFPS=function(){return this.runTimes/Math.max(this.runDuration,.016667)},i.prototype.getRunTimes=function(){return this.runTimes},i.prototype.getFpsArray=function(){return this.fpsArray},i.prototype.addFPS=function(a,u){!a||u<=0||100*(this.fpsArray.length+1)<=u&&this.fpsArray.push(a)},i.prototype.getDuration=function(){return this.runDuration},i.prototype.begin=function(a){if(this.performance){var u=this.runInfos[a];u||(u=this.runInfos[a]=new e),u.runTimes++,u.preTime=this.performance.now()}},i.prototype.end=function(a){if(this.performance){var u=this.runInfos[a],c=this.performance.now();u.lastRunDuration=c-u.preTime,u.totolTime+=u.lastRunDuration}},i.prototype.getTime=function(){return this.performance?this.performance.now():new Date().getTime()},i.prototype.report=function(){console.log("--------------------"),console.log("\u6E38\u620F\u7EDF\u8BA1\uFF1A"),console.log("FPS\uFF1A"+this.runTimes/this.runDuration),console.log("AVG\uFF1A"+this.runDuration/this.runTimes),console.log("Total time\uFF1A"+this.runDuration+"    Times: "+this.runTimes),this.printRunInfos(),console.log("\u7EDF\u8BA1\u7ED3\u675F"),console.log("--------------------"),console.log("")},i.prototype.reportAndReset=function(){this.report(),this.reset()},i.prototype.reset=function(){this.runDuration=0,this.runTimes=0},i.prototype.printJumpInfos=function(){console.log("Jump:"+this.runDuration+" times:"+this.jumpTimes+" avg = "+(0<this.jumpTimes?this.jumpDuration/this.jumpTimes:0)),this.jumpTimes=0,this.jumpDuration=0},i.prototype.printRunInfos=function(){for(var a=this.runInfos.length,u=0;u<a;++u){var c=this.runInfos[u];c!=null&&(console.warn("method:"+u+" last:"+c.lastRunDuration+" avg:"+c.totolTime/c.runTimes),console.warn("times:"+c.runTimes+"  total:"+c.totolTime))}},i.prototype.setStatus=function(a){this.status=a},i.prototype.getStatus=function(){return this.status},i}();(function(i){function a(){var u=i.call(this)||this;return u.mPerformance=wx.getPerformance(),u}__extends(a,i),a.prototype.getTime=function(){return this.mPerformance.now()}})(o.CounterImpl=n);function t(){return new n}o.newCounterInstance=t,o.Counter=t()}(m.Performance||(m.Performance={})),cc._RF.pop()},{"../base/G":"G"}],PianoToneMgr:[function(l,P,m){"use strict";cc._RF.push(P,"26804sCInBNY6RakrvGv8H0","PianoToneMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Network/Protocol/StorageUtil"),s=l("../../../config/LSKey"),r=l("../../../util/StringUtil"),o=l("../../../util/PU"),e=l("../../../LogicPlatform/PlatformProxy"),n=l("../../../base/Log"),t=l("../../Logic/GameItemsManager"),i=function(){function a(){this.ownToneList=[];var u=t.GameItemsManager.getIns().getAllItems().filter(function(c){return c&&t.GameItemsManager.getIns().isToneType(c.getItemId())});this.mAllToneList=Object.seal(u)}return a.Ins=function(){return a._s||(a._s=new a).init(),a._s},a.prototype.getPianoToneList=function(){return this.mAllToneList},a.prototype.onlyDefaultTone=function(){return this.ownToneList.length==1},a.prototype.isUseDefaultTone=function(){return this.curTone===a.PIANO_TONE_DEFAULT},a.prototype.getCurTone=function(){return this.curTone},a.prototype.getCurToneName=function(){var u=this,c=this.mAllToneList.find(function(p){return p&&p.getKey()==u.curTone});return c?c.getName():""},a.prototype.init=function(){this.initUseTone(),this.initOwnTone()},a.prototype.initUseTone=function(){var u=this;this.curTone=a.PIANO_TONE_DEFAULT;var c=d.default.read(s.default.PIANO_TONE_USE);r.StringUtil.isEmpty(c)||this.isToneExist(c,function(p){u.curTone=p?c:a.PIANO_TONE_DEFAULT})},a.prototype.initOwnTone=function(){var u=this,c=d.default.read(s.default.PIANO_TONE_OWN);this.ownToneList.push(a.PIANO_TONE_DEFAULT),r.StringUtil.isEmpty(c)||JSON.parse(c).forEach(function(p){u.ownToneList.indexOf(p)==-1&&u.mAllToneList.find(function(h){return h&&h.getKey()==p})&&u.ownToneList.push(p)})},a.prototype.isOwnTone=function(u){return-1<this.ownToneList.indexOf(u)},a.prototype.getOwnToneList=function(){return this.ownToneList},a.prototype.unlockTone=function(u){this.ownToneList.find(function(c){return c==u})||(this.ownToneList.push(u),this.saveOwnTone())},a.prototype.deletOwnTone=function(u){var c=this.ownToneList.indexOf(u);-1<c&&this.ownToneList.splice(c,1),this.curTone==u&&(this.curTone=a.PIANO_TONE_DEFAULT),this.saveOwnTone()},a.prototype.saveOwnTone=function(){d.default.save(s.default.PIANO_TONE_OWN,JSON.stringify(this.ownToneList))},a.prototype.saveUseTone=function(){d.default.save(s.default.PIANO_TONE_USE,this.curTone)},a.prototype.isToneExist=function(u,c){if(u===void 0&&(u=a.PIANO_TONE_DEFAULT),u){var p=o.default.getResourcePath("resources/music/"+u+"/a.mp3");try{e.default.Ins().getFileSystemManager().access({path:p,success:function(h){n.default.w("--- isMusicPianoExist success result ---"+h),c&&c(h)},fail:function(h){n.default.w("--- isMusicPianoExist false ---"),c&&c(!1)}})}catch(h){c&&c(!1)}}else c&&c(!1)},a.prototype.onTrialEnd=function(){this.curTone=a.PIANO_TONE_DEFAULT,this.saveUseTone()},a.prototype.switchTone=function(u){this.curTone=u,this.saveUseTone()},a.PIANO_TONE_DEFAULT="piano",a}();m.default=i,cc._RF.pop()},{"../../../LogicPlatform/PlatformProxy":"PlatformProxy","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../util/PU":"PU","../../../util/StringUtil":"StringUtil","../../Logic/GameItemsManager":"GameItemsManager","../../Network/Protocol/StorageUtil":"StorageUtil"}],PlatformProxy:[function(l,P,m){"use strict";cc._RF.push(P,"afe8bkBYVlKyYIFtpwaHKau","PlatformProxy"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./adapter/WechatGameAdapter"),s=l("./adapter/DefaultAdapter"),r=l("../../modules/MGUtils/TypeDefinition"),o=l("./adapter/CMPlayAdapter"),e=function(){function n(){this.mAdapter=null}return n.Ins=function(){return n.gs_Inst==null&&(n.gs_Inst=new n),n.gs_Inst.getAdapter()},n.init=function(t){switch(n.Ins(),t){case r.PlatformType.PLATFORM_WECHAT:case r.PlatformType.PLATFORM_H5SDK:n.gs_Inst.mAdapter=new d.default;break;case r.PlatformType.PLATFORM_QQPLAY:break;case r.PlatformType.PLATFORM_CMPLAY:n.gs_Inst.mAdapter=new o.default;break;default:n.gs_Inst.mAdapter=new s.default}},n.prototype.getAdapter=function(){return this.mAdapter},n.gs_Inst=null,n}();m.default=e,cc._RF.pop()},{"../../modules/MGUtils/TypeDefinition":"TypeDefinition","./adapter/CMPlayAdapter":"CMPlayAdapter","./adapter/DefaultAdapter":"DefaultAdapter","./adapter/WechatGameAdapter":"WechatGameAdapter"}],PlayerInfoPopupProfab:[function(l,P,m){"use strict";cc._RF.push(P,"e1361vVcZdPz5k2KVZ3PkPE","PlayerInfoPopupProfab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./EnergyPopupProfab"),s=l("./GoldPopupProfab"),r=l("./DiamondPopupProfab"),o=l("../../../infoc/m_p2_pop_coin"),e=l("../../../util/PageHeap"),n=cc._decorator,t=n.ccclass,i=n.property,a=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.player_info_popup_layout=null,p.energy_popup_prefab=null,p.gold_popup_prefab=null,p.diamond_popup_prefab=null,p.share_gift_prefab=null,p.shop_prefab=null,p.childCount=0,p}return __extends(c,u),c.prototype.setCloseSelfCallback=function(p){console.log("setCloseSelfCallback"),this.closeSelfCallback=p},c.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(p){p.stopPropagation()})},c.prototype.start=function(){},c.prototype.playerEnergyBtnClick=function(p){this.toEnergyPopupPrefab(p),console.log("playerEnergyBtnClick")},c.prototype.toEnergyPopupPrefab=function(p){var h=this;o.default.report(o.default.SCENE_GET_ENERGY_DIALOG,p,o.default.ACTION_DIALOG_SHOW);var f=cc.instantiate(this.energy_popup_prefab),g=f.getComponent(d.default);g.setCloseCallback(function(){e.default.Ins().pop("EnergyDialog"),f.destroy(),h.childCount--,h.removeSelf()}),g.setToGoldPopupPrefab(function(){h.toGoldPopupPrefab(o.default.SOURCE_GOLD_NOT_CLICK_GOLD)}),g.setSource(p),this.player_info_popup_layout.node.addChild(f),this.childCount++,console.log("toEnergyPopupPrefab"),e.default.Ins().push("EnergyDialog")},c.prototype.playerGoldBtnClick=function(p){this.toGoldPopupPrefab(p),console.log("playerGoldBtnClick")},c.prototype.toGoldPopupPrefab=function(p){var h=this;o.default.report(o.default.SCENE_GET_GOLD_DIALOG,p,o.default.ACTION_DIALOG_SHOW);var f=cc.instantiate(this.gold_popup_prefab),g=f.getComponent(s.default);g.setCloseCallback(function(){e.default.Ins().pop("GoldDialog"),f.destroy(),h.childCount--,h.removeSelf()}),g.setToDiamondPopupPrefab(function(){h.toDiamondPopupPrefab(o.default.SOURCE_DIAMOND_NOT_CLICK_DIAMOND)}),g.setSource(p),this.player_info_popup_layout.node.addChild(f),this.childCount++,console.log("toGoldPopupPrefab"),e.default.Ins().push("GoldDialog")},c.prototype.playerDiamondBtnClick=function(p){this.toDiamondPopupPrefab(p),console.log("playerDiamondBtnClick")},c.prototype.toDiamondPopupPrefab=function(p){var h=this;o.default.report(o.default.SCENE_GET_DIAMOND_DIALOG,p,o.default.ACTION_DIALOG_SHOW);var f=cc.instantiate(this.diamond_popup_prefab),g=f.getComponent(r.default);g.setCloseCallback(function(){e.default.Ins().pop("DiamondDialog"),f.destroy(),h.childCount--,h.removeSelf()}),g.setSource(p),this.player_info_popup_layout.node.addChild(f),this.childCount++,console.log("toDiamondPopupPrefab"),e.default.Ins().push("DiamondDialog")},c.prototype.removeSelf=function(){this.childCount==0&&this.closeSelfCallback&&this.closeSelfCallback()},__decorate([i(cc.Layout)],c.prototype,"player_info_popup_layout",void 0),__decorate([i(cc.Prefab)],c.prototype,"energy_popup_prefab",void 0),__decorate([i(cc.Prefab)],c.prototype,"gold_popup_prefab",void 0),__decorate([i(cc.Prefab)],c.prototype,"diamond_popup_prefab",void 0),__decorate([i(cc.Prefab)],c.prototype,"share_gift_prefab",void 0),__decorate([i(cc.Prefab)],c.prototype,"shop_prefab",void 0),c=__decorate([t],c)}(cc.Component);m.default=a,cc._RF.pop()},{"../../../infoc/m_p2_pop_coin":"m_p2_pop_coin","../../../util/PageHeap":"PageHeap","./DiamondPopupProfab":"DiamondPopupProfab","./EnergyPopupProfab":"EnergyPopupProfab","./GoldPopupProfab":"GoldPopupProfab"}],PlayerMgr:[function(l,P,m){"use strict";cc._RF.push(P,"e81e3RJ3/lETrbPL+DSninL","PlayerMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../config/LSKey"),s=l("../Network/Protocol/User"),r=l("../Core/GameDefine"),o=l("../../util/Dictionary"),e=l("./LevelMgr"),n=l("../Network/Protocol/StorageUtil"),t=l("../Network/Protocol/UserUtil"),i=l("./Level"),a=l("../../base/Log"),u=l("./Plugin/PluginMgr"),c=l("../UI/MusicLevelDataLoader"),p=l("../../util/StringUtil"),h=l("../../base/PullDataStatus"),f=l("../Network/Protocol/MemCache"),g=function(){function _(){this.mUserInfoObservers=[],this.mLevelRecords=new o.Dictionary,this.isPulling=!1,this.mUser=new s.default}return _.prototype.addUserListener=function(y){this.mUserInfoObservers.push(y),this.notifyUserListener(),console.log("[PlayerManager] add listener, number="+this.mUserInfoObservers.length)},_.prototype.removeUserListener=function(y){var S=this.mUserInfoObservers.indexOf(y);this.mUserInfoObservers.splice(S,1),console.log("[PlayerManager] remove listener, number="+this.mUserInfoObservers.length)},_.prototype.notifyUserListener=function(){var y=this;this.mUser&&this.mUserInfoObservers.forEach(function(S){S.onChange(y.mUser.hp,y.mUser.coin,y.mUser.diamond,y.mUser.level,y.mUser.curUserExp)})},_.prototype.init=function(){var y=n.default.read(d.default.UserInfo);t.default.parseToUser(y,this.mUser),this.initDefaultUnlockMusic(),this.mergeRecords(n.default.read(d.default.UserLevelRecord))},_.prototype.compareServerData=function(y,S){return y.level<S.level||y.level==S.level&&y.curUserExp<S.curUserExp},_.prototype.mergeUser=function(y,S){var I=!1;y.level!=S.level&&(y.level=S.level,I=!0),y.curUserExp!=S.curUserExp&&(y.curUserExp=S.curUserExp,I=!0),y.hp!=S.hp&&(y.hp=S.hp,I=!0),y.coin!=S.coin&&(y.coin=S.coin,I=!0),y.diamond!=S.diamond&&(y.diamond=S.diamond,I=!0),y.lastRecovery!=S.lastRecovery&&(y.lastRecovery=S.lastRecovery,I=!0),y.lastLevelMid!=S.lastLevelMid&&(y.lastLevelMid=S.lastLevelMid),I&&(this.saveUserInfo(),this.notifyUserListener())},_.prototype.pullCloudInfo=function(){var y=this;return a.default.i("start pullPlayerInfo, isPulling="+this.isPulling+"  pullStatus="+h.PullDataStatus.isPullDataSuccess),this.isPulling||h.PullDataStatus.isPullDataSuccess?new Promise(function(S){S()}):(this.isPulling=!0,new Promise(function(S,I){n.default.readFromNet(d.default.KEYS_NEED_SYNC,function(v){if(h.PullDataStatus.isPullDataSuccess=!0,v){var C=v[d.default.UserLevelRecord];C&&y.mergeRecords(C);var T=v[d.default.UserInfo],E=new s.default;t.default.parseToUser(T,E);var A=y.compareServerData(y.mUser,E);if(A||(A=y.compareStorageVersionKey(v[d.default.STORAGE_VERSION])),A){y.mergeUser(y.mUser,E),f.MemCache.Ins().batchSaveStart();for(var M=0;M<d.default.KEYS_NEED_SYNC.length;M++){var k=d.default.KEYS_NEED_SYNC[M];if(k!=d.default.UserInfo&&k!=d.default.UserLevelRecord){var D=v[k];p.StringUtil.isNullOrUndefined(D)||n.default.save(k,D)}}f.MemCache.Ins().batchSaveEnd(),u.default.Ins().reset()}}y.isPulling=!1,S&&S()},function(){y.isPulling=!1,a.default.e("PlayerManager read net failed:"),S()})}))},_.prototype.compareStorageVersionKey=function(y){var S=0;p.StringUtil.isEmpty(y)||(S=parseInt(y));var I=n.default.read(d.default.STORAGE_VERSION),v=0;return p.StringUtil.isEmpty(I)||(v=parseInt(I)),v<S},_.Ins=function(){return this._ins==null&&(this._ins=new _),this._ins},_.prototype.getHP=function(){return this.mUser.hp},_.prototype.addHP=function(){this.setHP(this.mUser.hp+1)},_.prototype.setHP=function(y){this.mUser.hp!=y&&(this.mUser.hp=y,this.saveUserInfo(),this.notifyUserListener())},_.prototype.getUserLastLevelMid=function(){return this.mUser.lastLevelMid},_.prototype.setUserLastLevelMid=function(y){this.mUser.lastLevelMid!=y&&(this.mUser.lastLevelMid=y,this.saveUserInfo())},_.prototype.getLastRecovery=function(){return this.mUser.lastRecovery},_.prototype.setLastRecovery=function(y){this.mUser.lastRecovery!=y&&(this.mUser.lastRecovery=y,this.saveUserInfo())},_.prototype.getUserLevel=function(){return this.mUser.level},_.prototype.setUserLevel=function(y){this.mUser.level!=y&&(this.mUser.level=y,this.saveUserInfo(),this.notifyUserListener())},_.prototype.getUserCurrentExp=function(){return this.mUser.curUserExp},_.prototype.setUserCurrentExp=function(y){this.mUser.curUserExp!=y&&(this.mUser.curUserExp=y,this.saveUserInfo())},_.prototype.getUserDiamond=function(){return this.mUser.diamond},_.prototype.setUserDiamond=function(y){this.mUser.diamond!=y&&(this.mUser.diamond=y,this.saveUserInfo(),this.notifyUserListener())},_.prototype.getUserCoin=function(){return this.mUser.coin},_.prototype.addUserCoin=function(){this.setUserCoin(this.mUser.coin+1)},_.prototype.setUserCoin=function(y){this.mUser.coin!=y&&(this.mUser.coin=y,this.saveUserInfo(),this.notifyUserListener())},_.prototype.saveUserInfo=function(){var y=t.default.parseUserToString(this.mUser);n.default.save(d.default.UserInfo,y)},_.prototype.increaseHp=function(y){this.mUser.hp+=y,this.saveUserInfo(),this.notifyUserListener()},_.prototype.increaseDiamond=function(y){this.mUser.diamond+=y,this.saveUserInfo(),this.notifyUserListener()},_.prototype.unlockTypeToFlag=function(y){var S=r.eUnlockFlag.FLAG_NONE;switch(y){case i.eUnlockType.UNLOCK_TYPE_LV:S=r.eUnlockFlag.FLAG_LOCKED_LV;break;case i.eUnlockType.UNLOCK_TYPE_GOLD:S=r.eUnlockFlag.FLAG_LOCKED_GOLD;break;case i.eUnlockType.UNLOCK_TYPE_DIAMOND:S=r.eUnlockFlag.FLAG_LOCKED_DIAMOND;break;case i.eUnlockType.UNLOCK_TYPE_STAR:S=r.eUnlockFlag.FLAG_LOCKED_STAR;break;case i.eUnlockType.UNLOCK_TYPE_ACTIVITY:S=r.eUnlockFlag.FLAG_LOCKED_ACTIVITY;break;case i.eUnlockType.UNLOCK_TYPE_LV_TRY:S=r.eUnlockFlag.FLAG_LOCKED_LV_TRY;break;case i.eUnlockType.UNLOCK_TYPE_VIP:S=r.eUnlockFlag.FLAG_UNLOCK_BY_VIP;break;case i.eUnlockType.UNLOCK_TYPE_VIDEO:S=r.eUnlockFlag.FLAG_LOCKED_VIDEO}return S},_.prototype.updateLvUnlockRecord=function(){var y=this;c.MusicLevelDataLoader.getMusicLevel().forEach(function(S){if(y.mLevelRecords.get(S.music.mid)==null){var I=new r.LevelRecord;I.mId=S.id,I.mMid=S.music.mid,I.mUnlockFlag=y.unlockTypeToFlag(S.levelUnlock.unlockType),y.mLevelRecords.put(I.mMid,I)}})},_.prototype.addNewRecord=function(y,S,I){var v=this.mLevelRecords.get(S);return v!=null||((v=new r.LevelRecord).mId=y,v.mMid=S,v.mUnlockFlag=this.unlockTypeToFlag(I),this.mLevelRecords.put(S,v)),v},_.prototype.initDefaultUnlockMusic=function(){this.addNewRecord(1,100001,i.eUnlockType.UNLOCK_TYPE_LV);var y=new r.LevelRecord;y.mId=1,y.mMid=100001,y.mUnlockFlag=r.eUnlockFlag.FLAG_UNLOCK_LV,this.mLevelRecords.put(y.mMid,y)},_.prototype.mergeRecords=function(y){var S=this;if(y&&0<y.length){var I=y.split("*");if(I&&0<I.length){var v=!1;I.forEach(function(C){var T=C.split("@");if(T&&0<T.length){var E=void 0,A=void 0,M=0,k=0,D=0,L=r.eUnlockFlag.FLAG_NONE;if(T&&6<=T.length&&(E=parseInt(T[0]),A=parseInt(T[1]),M=parseInt(T[2]),k=parseInt(T[3]),D=parseFloat(T[4]),(L=parseInt(T[5]))==r.eUnlockFlag.FLAG_UNLOCK_GOLD&&(L=r.eUnlockFlag.FLAG_LOCKED_GOLD)),Number.isNaN(A)||Number.isNaN(E)||A==0||E==0)return;var b=S.getLevelRecordByMid(A);b==null&&((b=new r.LevelRecord).mMid=A,b.mId=E,v=!0),S.addLevelRecord(b,M)&&(v=!0),S.addLevelStar(b,A,k)&&(v=!0),S.addLevelSpeed(b,D)&&(v=!0),S.addLevelUnlock(b,L)&&(v=!0),b.isEmpty()||S.mLevelRecords.put(A,b)}}),v&&this.saveRecord(),a.default.i("after merge records, size="+this.mLevelRecords.size())}}},_.prototype.addLevelSpeed=function(y,S){var I=!1;return y!=null&&y.mBestSpeed<S&&(y.mBestSpeed=S,I=!0),I},_.prototype.addLevelUnlock=function(y,S){var I=!1;if(y!=null){var v=!r.LevelRecord.isLocked(S),C=!r.LevelRecord.isLocked(y.mUnlockFlag);y.mUnlockFlag==r.eUnlockFlag.FLAG_NONE&&(y.mUnlockFlag=S,I=!0),!C&&v&&(y.mUnlockFlag=S,I=!0)}return I},_.prototype.addLevelStar=function(y,S,I){var v=!1;return y!=null&&y.mBestStar<I&&(y.mBestStar=I,v=!0),v},_.prototype.addLevelRecord=function(y,S){var I=!1;return y!=null&&y.mBestScore<S&&(y.mBestScore=S,I=!0),I},_.prototype.getLevelRecordByMid=function(y){return this.mLevelRecords.get(y)},_.prototype.getLevelRecords=function(){return this.mLevelRecords},_.prototype.setLevelRecord=function(y){if(y&&!isNaN(y.mId)){var S=!1,I=this.getLevelRecord(y.mId);return I==null?((I=new r.LevelRecord).mId=y.mId,I.mMid=y.mMid,I.mBestScore=y.mScore,I.mBestStar=y.mStar,I.mBestSpeed=y.mSpeed,I.mUnlockFlag=y.mUnlockFlag,this.mLevelRecords.put(y.mMid,I)):(y.mScore>I.mBestScore&&(I.mBestScore=y.mScore,S=!0),y.mStar>I.mBestStar&&(I.mBestStar=y.mStar,S=!0),y.mSpeed>I.mBestSpeed&&(I.mBestSpeed=y.mSpeed,S=!0),I.mUnlockFlag=y.mUnlockFlag),S=!0,I.mBadBlockType=y.mBadBlockType,I.mBadBlcokCount=y.mBadBlcokCount,I.mbadEndBlock=y.mbadEndBlock,I.mIsUpLevel=y.mIsUpLevel,I.mCoin=y.mCoin,I.mExp=y.mExp,S&&this.saveRecord(),null}},_.prototype.saveRecord=function(){var y=[];this.mLevelRecords.getPairs().forEach(function(I){y.push(I.value)});var S=t.default.parseLevelRecordToStr(y);n.default.save(d.default.UserLevelRecord,S)},_.prototype.getLevelRecord=function(y){for(var S=this.mLevelRecords.getPairs(),I=S.length,v=0;v<I;v++){var C=S[v].value;if(C.mId==y)return C}return null},_.prototype.getTotalStar=function(){var y=0;return this.mLevelRecords.getPairs().forEach(function(S){var I=S.value;I.mBestStar<=3&&(y+=I.mBestStar)}),y},_.prototype.getTotalCrown=function(){var y=0;return this.mLevelRecords.getPairs().forEach(function(S){var I=S.value;3<I.mBestStar&&(y+=I.mBestStar-3)}),y},_.prototype.getTotalScore=function(){var y=0;return this.mLevelRecords.getPairs().forEach(function(S){var I=S.value;0<I.mBestScore&&(y+=I.mBestScore)}),y},_.prototype.refreshUnlockState=function(y){var S=this,I=e.LevelMgr.Ins().getLevel(y),v=c.MusicLevelDataLoader.getMusicLevelsByLv(I.needLv),C=v[v.length-1];if(C.levelUnlock.unlockType==i.eUnlockType.UNLOCK_TYPE_LV_TRY){var T=this.getLevelRecord(C.id);T==null&&(T=this.addNewRecord(C.id,C.music.mid,C.levelUnlock.unlockType));var E=e.LevelMgr.Ins().getLevelInfo(C.id),A=E.m_needCrown,M=E.m_needCrown2,k=0,D=0;v.forEach(function(L){if(L.levelUnlock.unlockType==i.eUnlockType.UNLOCK_TYPE_LV){var b=S.getLevelRecord(L.id);b&&!b.isRecordLocked()&&(3<b.mBestStar?(k+=3,D+=b.mBestStar-3):k+=b.mBestStar)}}),(0<A&&A<=k||0<M&&M<=D)&&(T.mUnlockFlag=r.eUnlockFlag.FLAG_UNLOCK_LV,this.saveRecord())}},_}();m.default=g,cc._RF.pop()},{"../../base/Log":"Log","../../base/PullDataStatus":"PullDataStatus","../../config/LSKey":"LSKey","../../util/Dictionary":"Dictionary","../../util/StringUtil":"StringUtil","../Core/GameDefine":"GameDefine","../Network/Protocol/MemCache":"MemCache","../Network/Protocol/StorageUtil":"StorageUtil","../Network/Protocol/User":"User","../Network/Protocol/UserUtil":"UserUtil","../UI/MusicLevelDataLoader":"MusicLevelDataLoader","./Level":"Level","./LevelMgr":"LevelMgr","./Plugin/PluginMgr":"PluginMgr"}],PlayerTaskData:[function(l,P,m){"use strict";cc._RF.push(P,"70424qOWT1IVLJLCtY95ujr","PlayerTaskData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.PlayerTaskData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getID=function(){return this.getInt("Id")},e.prototype.getName=function(){return this.getString("Name")},e.prototype.getStep=function(){return this.getInt("Step")},e.prototype.getRewardType=function(){return this.getInt("RewardType")},e.prototype.getRewardEnergy=function(){return this.getInt("RewardEnergy")},e.prototype.getRewardGold=function(){return this.getInt("RewardGold")},e.prototype.getRewardDiamond=function(){return this.getInt("RewardDiamond")},e}(d.default);m.PlayerTaskRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],PluginMgr:[function(l,P,m){"use strict";cc._RF.push(P,"a56b7gJADNCFoj14o1TuhMo","PluginMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./IPlugin"),s=l("./EnergyPlugin"),r=l("./ExpPlugin"),o=l("../PluginScheduler"),e=l("./EconomyPlugin"),n=l("./UnlockPlugin"),t=l("../../Network/Protocol/StorageUtil"),i=function(){function a(){this.mPlugins=[],this.m_bInit=!1,this.mPluginScheduler=null}return a.Ins=function(){return this._instance==null&&(this._instance=new a,this._instance.mPluginScheduler=new o.default),this._instance},a.prototype.init=function(){this.m_bInit||(this.registerPlugin(new s.default),this.registerPlugin(new n.default),this.registerPlugin(new e.default),this.registerPlugin(new r.default),this.mPluginScheduler.start(),this.m_bInit=!0)},a.prototype.clear=function(){this.m_bInit=!1,this.mPluginScheduler.stop(),this.mPlugins.splice(0,this.mPlugins.length)},a.prototype.reset=function(){this.clear(),this.init()},a.prototype.registerPlugin=function(u){if(u!=null){var c=this.mPlugins.filter(function(p){return p.getKind()==u.getKind()});c!=null&&c.length!=0||this.mPlugins.push(u)}},a.prototype.notifyLevelChanged=function(u){this.mPlugins.forEach(function(c){return c.onLevelChanged(u)}),t.default.pushAsync()},a.prototype.getPlugin=function(u){var c=this.mPlugins.filter(function(p){return p.getKind()==u});return c&&0<c.length?c[0]:null},a.prototype.getPluginEx=function(u){var c=this.mPlugins.filter(function(p){return p.getKind()==u});return c&&0<c.length?c[0]:null},a.prototype.updataPlugin=function(u){this.mPlugins.forEach(function(c){return c.update(u)})},a.prototype.onAwake=function(){if(this.m_bInit){var u=this.getPlugin(d.default.Plugin_Singin);u&&u.onAwake(),(u=this.getPlugin(d.default.Plugin_Economy))&&u.onAwake(),(u=this.getPlugin(d.default.Plugin_Recharge))&&u.onAwake(),(u=this.getPlugin(d.default.Plugin_Skin_Chip))&&u.onAwake()}},a}();m.default=i,cc._RF.pop()},{"../../Network/Protocol/StorageUtil":"StorageUtil","../PluginScheduler":"PluginScheduler","./EconomyPlugin":"EconomyPlugin","./EnergyPlugin":"EnergyPlugin","./ExpPlugin":"ExpPlugin","./IPlugin":"IPlugin","./UnlockPlugin":"UnlockPlugin"}],PluginScheduler:[function(l,P,m){"use strict";cc._RF.push(P,"020395DqkpBs7krr/6+Z7Z8","PluginScheduler"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Network/Protocol/UserUtil"),s=l("./Plugin/PluginMgr"),r=function(o){function e(){var n=o.call(this)||this;return n.scheduler=cc.director.getScheduler(),n}return __extends(e,o),e.prototype.start=function(){var n=d.default.getCurSysTime();this.scheduler.scheduleUpdate(this,cc.Scheduler.PRIORITY_NON_SYSTEM,!1,function(){var t=d.default.getCurSysTime(),i=t-n;.1<i&&(n=t-i%.1,s.default.Ins().updataPlugin(t))})},e.prototype.stop=function(){this.scheduler.unscheduleUpdate(this)},e}(cc.Node);m.default=r,cc._RF.pop()},{"../Network/Protocol/UserUtil":"UserUtil","./Plugin/PluginMgr":"PluginMgr"}],PopupDlg:[function(l,P,m){"use strict";cc._RF.push(P,"1a6ccjPig9K/aA+KSJtfFrQ","PopupDlg"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Log"),s=l("../../../util/PageHeap"),r=function(){function o(){this.mParentLayout=null,this.mShowCount=0,this.mShowDialogCallback=null,this.mDismissDialogCallback=null}return o.prototype.setParentLayout=function(e){e&&(this.mParentLayout=e)},o.prototype.showPopupDlg=function(e,n,t){this.mParentLayout||console.error("PopupDlg showPopupDlg error: parentLayout is null");var i=cc.instantiate(e);n&&n(i),this.mParentLayout.addChild(i),t&&t(i),this.addShowCount(),s.default.Ins().push(i.name)},o.prototype.showDialog=function(e,n,t){this.mParentLayout?(n&&n(e),this.mParentLayout.addChild(e),t&&t(e),this.addShowCount(),s.default.Ins().push(e.name)):console.error("PopupDlg showPopupDlg error: parentLayout is null")},o.prototype.dismissDialog=function(e,n){e.destroy(),n&&n(),this.removeShowCount(),s.default.Ins().pop(e.name)},o.prototype.showPopupDlgDynamic=function(e,n,t){this.mParentLayout||console.error("PopupDlg showPopupDlg error: parentLayout is null"),d.default.l("showPopupDlgDynamic:  "+e);var i=this;cc.loader.loadRes(e,cc.Prefab,function(a,u){i.showPopupDlg(u,n,t)})},o.prototype.destroy=function(){this.mParentLayout=null},o.prototype.addShowCount=function(){this.mShowCount++,this.mShowDialogCallback&&this.mShowDialogCallback(this.mShowCount)},o.prototype.removeShowCount=function(){this.mShowCount--,this.mDismissDialogCallback&&this.mDismissDialogCallback(this.mShowCount)},o.prototype.setShowDialogCallback=function(e){this.mShowDialogCallback=e},o.prototype.setDismissDialogCallback=function(e){this.mDismissDialogCallback=e},o.prototype.isShowingDialog=function(){return!(this.mShowCount<=0)},o}();m.PopupDlg=r,cc._RF.pop()},{"../../../base/Log":"Log","../../../util/PageHeap":"PageHeap"}],PreLoadAssets:[function(l,P,m){"use strict";cc._RF.push(P,"bb87bi2aH1I0qxZcl4S9SqA","PreLoadAssets"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Logic/NotifyEvent"),s=l("../../Logic/EventBus");(m.PreLoadAssets||(m.PreLoadAssets={})).preload=function(r){if(window.delayPreloadResArr){var o=window.delayPreloadResArr,e=o.length;s.default.fire(d.default.LOADING_UI_NOTIFY,"download",e),cc.loader.load(o,function(n,t,i){i&&cc.loader.releaseAsset(i),console.info("progress ===>  loading "+n+"/"+t+"  url="+i.url),s.default.fire(d.default.LOADING_DOWNLOAD,i.url,1)},function(n,t){r&&r()})}else r&&r()},cc._RF.pop()},{"../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent"}],PrefabMgr:[function(l,P,m){"use strict";cc._RF.push(P,"f72e3lIiCdO7qKzlwWbK/Ne","PrefabMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Log"),s=function(){function o(){}return o.prototype.loadPrefab=function(e,n,t){cc.loader.loadRes(e,cc.Prefab,function(i,a){i&&console.error(i),t&&t(i,n?cc.instantiate(a):a)})},o.prototype.load=function(e,n,t,i,a){t===void 0&&(t=!0),i===void 0&&(i=!1);var u=this;return new Promise(function(c,p){var h=cc.find("loadingNode");h&&i==1?u.showProgress(function(f,g){g&&(h.addChild(g),d.default.l("[PrefabManager] show progress "+e)),a?a().then(function(_){_?u.loadPrefab(e,t,function(y,S){n&&n(y,S),c(),g&&cc.isValid(g)&&g.destroy()}):(c(),g&&cc.isValid(g)&&g.destroy())},function(){c(),g&&cc.isValid(g)&&g.destroy()}):u.loadPrefab(e,t,function(_,y){n&&n(_,y),c(),g&&cc.isValid(g)&&g.destroy()})}):u.loadPrefab(e,t,function(f,g){n&&n(f,g),c()})})},o.prototype.showProgress=function(e){this.loadPrefab("prefab/SkinLoadingprefab",!0,e)},o}(),r=function(){function o(){}return o.load=function(e,n,t,i,a){return t===void 0&&(t=!0),i===void 0&&(i=!1),this.ins.load(e,n,t,i,a)},o.showProgress=function(e){this.ins.showProgress(e)},o.ins=new s,o}();m.default=r,cc._RF.pop()},{"../../../base/Log":"Log"}],Presenter:[function(l,P,m){"use strict";cc._RF.push(P,"c2578eE8k1I46CpcA0iskWm","Presenter"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../social/SocialHelper"),s=l("./G"),r=l("../gamescene/GameSceneEntry"),o=l("../util/PageHeap"),e=l("./Log"),n=l("../business/UI/GameEntraScene/PrefabMgr"),t=l("../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),i=function(){function a(){this.attachSysEvent()}return a.prototype.enterScene=function(u,c,p,h,f){var g=this;h===void 0&&(h=!1);var _=cc.find("loadingNode");_&&h==1?n.default.showProgress(function(y,S){S&&_.addChild(S),g.doEnterScene(u,c,p,function(){S&&cc.isValid(S)&&S.destroy(),f&&f()})}):this.doEnterScene(u,c,p)},a.prototype.doEnterScene=function(u,c,p,h){cc.sys.platform==cc.sys.WECHAT_GAME&&wx.triggerGC(),cc.director.preloadScene(u,function(){e.default.l("[Presenter] enterScene, preloadScene; "+u),c&&(u==s.G.GAME_SCENE_NAME?t.MGAdv.roundStart(c):u==s.G.GAME_OVER_SCENE_NAME&&t.MGAdv.roundEnd(c)),setTimeout(function(){p&&p(),o.default.Ins().pushScene(u),cc.director.loadScene(u),h&&h(),e.default.l("[Presenter] enterScene finish:"+u)},50)})},a.prototype.attachSysEvent=function(){d.SocialHelper.offHideListen(this.onGameHide),d.SocialHelper.onHideListen(this.onGameHide),d.SocialHelper.offShowListen(this.onGameShow),d.SocialHelper.onShowListen(this.onGameShow)},a.prototype.onGameHide=function(){var u=cc.director.getScene();if(u.name===s.G.GAME_SCENE_NAME){var c=u.getChildByName("Canvas").getComponent(r.default);c&&(c.getGameInterface().pauseGame(),c.gameBackground())}},a.prototype.onGameShow=function(){var u=cc.director.getScene();if(u.name===s.G.GAME_SCENE_NAME){var c=u.getChildByName("Canvas").getComponent(r.default);c&&c.gameForeground()}},a}();m.default=i,cc._RF.pop()},{"../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr","../gamescene/GameSceneEntry":"GameSceneEntry","../social/SocialHelper":"SocialHelper","../util/PageHeap":"PageHeap","./G":"G","./Log":"Log"}],PropertiesPanel:[function(l,P,m){"use strict";cc._RF.push(P,"45d03wnb1VBsbwu5c1bYVMa","PropertiesPanel"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../../business/UI/GameEntraScene/BasicTouchEvent"),o=l("../../base/G"),e=l("../../property/PropertyDefines"),n=l("../../util/nodeFacade"),t=cc._decorator.ccclass,i=function(a){function u(){return a!==null&&a.apply(this,arguments)||this}return __extends(u,a),u.prototype.setShowPropPopupCb=function(c){this.mShowPropPopupCb=c},u.prototype.onLoad=function(){this.initEvent(),this.updatePropertiesPanel()},u.prototype.initEvent=function(){var c=this,p=this.node;if(p)for(var h=[e.PROPERTYTYPE.GAME_DASH,e.PROPERTYTYPE.GAME_SLOW,e.PROPERTYTYPE.GAME_SHIELD],f=function(S,I){var v=h[S],C=g.getPropertyNodeName(v),T=p.getChildByName(C);if(!T)return"continue";var E=new r.default(function(){c.onPropertyItemClick(v)});T.on(cc.Node.EventType.TOUCH_END,E.click,E)},g=this,_=0,y=h.length;_<y;++_)f(_)},u.prototype.updatePropertiesPanel=function(){var c=this.node;if(c)for(var p=o.G.Ap.propertyPack.getPlayProperty(),h=[e.PROPERTYTYPE.GAME_DASH,e.PROPERTYTYPE.GAME_SLOW,e.PROPERTYTYPE.GAME_SHIELD],f=0,g=h.length;f<g;++f){var _=h[f],y=this.getPropertyNodeName(_),S=c.getChildByName(y);if(S){var I=new e.Property(_),v=p.getPropertyCount(I),C=o.G.Ap.state.getCarryPropertyCount(I),T=new n.default(S).getChild("rect");0<C?(T.setChildVisible("add",!1),T.setChildVisible("mark",!1),T.setChildVisible("select",!0),T.setChildText("mark",""+Math.min(v,99))):(0<v?(T.setChildVisible("mark",!0),T.setChildText("mark",""+Math.min(v,99)),T.setChildVisible("add",!1)):(T.setChildVisible("add",!0),T.setChildVisible("mark",!1)),T.setChildVisible("select",!1))}}},u.prototype.playGetPropertyAnim=function(c){var p;switch(c.type){case e.PROPERTYTYPE.GAME_SLOW:p=this.node.getChildByName("propertyiconslow").getChildByName("rect").getChildByName("addOne");break;case e.PROPERTYTYPE.GAME_DASH:p=this.node.getChildByName("propertyicondash").getChildByName("rect").getChildByName("addOne");break;case e.PROPERTYTYPE.GAME_SHIELD:p=this.node.getChildByName("propertyiconshield").getChildByName("rect").getChildByName("addOne")}p.active=!0;var h=p.getComponent(cc.Animation);h&&h.play("prop_add_one")},u.prototype.onPropertyItemClick=function(c){var p=this.node;if(p){var h=this.getPropertyNodeName(c),f=p.getChildByName(h);if(f){var g=new e.Property(c),_=o.G.Ap.propertyPack.getPlayProperty().getPropertyCount(g),y=new n.default(f).getChild("rect");_===0?(y.setChildVisible("add",!0),y.setChildVisible("mark",!1),y.setChildVisible("select",!1),this.mShowPropPopupCb&&this.mShowPropPopupCb(d.Store,g)):y.isChildVisible("mark")?(y.setChildVisible("add",!1),y.setChildVisible("mark",!1),y.setChildVisible("select",!0),o.G.Ap.state.addCarryProperty(g,1),this.mShowPropPopupCb&&this.mShowPropPopupCb(d.Desc,g)):y.isChildVisible("select")&&(y.setChildVisible("add",!1),y.setChildVisible("mark",!0),y.setChildVisible("select",!1),o.G.Ap.state.removeCarryProperty(g))}}},u.prototype.getPropertyNodeName=function(c){var p="";switch(c){case e.PROPERTYTYPE.GAME_DASH:p="propertyicondash";break;case e.PROPERTYTYPE.GAME_SLOW:p="propertyiconslow";break;case e.PROPERTYTYPE.GAME_SHIELD:p="propertyiconshield"}return p},u=__decorate([t],u)}(cc.Component);m.default=i,(s=d=m.PropShowType||(m.PropShowType={}))[s.Desc=0]="Desc",s[s.Store=1]="Store",cc._RF.pop()},{"../../base/G":"G","../../business/UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../../property/PropertyDefines":"PropertyDefines","../../util/nodeFacade":"NodeFacade"}],PropertyBarrel:[function(l,P,m){"use strict";cc._RF.push(P,"943f1OqQuhGc4jHeb/am1b5","PropertyBarrel"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PropertyDefines"),s=l("../util/Dictionary"),r=l("../util/BinaryData"),o=l("../../libs/base64"),e=function(){function n(t){this.properties=new s.Dictionary2(d.Property.compare),this.config=t}return n.prototype.parse=function(t){var i=new o.default().decode(t),a=r.default.StringToArrayBufferComplex(i,n.CODE),u=new DataView(a);if(u.getUint8(0)===n.VERSION)for(var c=u.getUint32(4),p=0;p<c;++p){var h=new DataView(a,n.HEADERSIZE+p*n.ITEMSIZE,n.ITEMSIZE),f=h.getUint32(0),g=h.getUint32(4),_=h.getInt32(8);_=Math.max(_,0);var y=new d.Property(f,g);this.addProperty(y,_)}},n.prototype.stringfy=function(){var t=this.properties.size(),i=new ArrayBuffer(n.HEADERSIZE+t*n.ITEMSIZE),a=new DataView(i);a.setUint8(0,n.VERSION),a.setUint32(4,t);for(var u=this.properties.getPairs(),c=0;c<t;++c){var p=new DataView(i,n.HEADERSIZE+c*n.ITEMSIZE,n.ITEMSIZE),h=u[c].key,f=u[c].value;p.setUint32(0,h.type),p.setUint32(4,h.quality),p.setInt32(8,Math.max(0,f.count))}var g=r.default.ArrayBufferToStringComplex(i,n.CODE);return new o.default().encode(g)},n.prototype.getPropertyCount=function(t){var i=this.getPropertyData(t);return i?i.count:0},n.prototype.useProperty=function(t){var i=this.getPropertyData(t);return!(!i||i.count===0)&&(i.count--,i.count=Math.max(i.count,0),!0)},n.prototype.addProperty=function(t,i){i===void 0&&(i=1);var a=this.getPropertyData(t);return a||(a=new d.PropertyData,this.addPropertyData(t,a)),a.count+=i,a.count=Math.max(a.count,0),!0},n.prototype.decreaseProperty=function(t,i){var a=this.getPropertyData(t);a&&(a.count-=i,a.count=Math.max(a.count,0))},n.prototype.getPropertyData=function(t){return this.properties.get(t)},n.prototype.addPropertyData=function(t,i){this.properties.put(t.clone(),i)},n.HEADERSIZE=128,n.ITEMSIZE=16,n.VERSION=1,n.CODE=45,n}();m.default=e,cc._RF.pop()},{"../../libs/base64":"base64","../util/BinaryData":"BinaryData","../util/Dictionary":"Dictionary","./PropertyDefines":"PropertyDefines"}],PropertyBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"706f5x3ZsZNF4TtCALC6Iyz","PropertyBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/GameSceneFrameLoader"),s=l("./BlockNode"),r=l("../../MUI/MUISprite"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.createLayers=function(){this.setPosition(this.mBlock.rect.x,this.mBlock.rect.y),this.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height);var t=this.mBlock,i=d.default.getInstance().getAtlas(),a=null;if(t&&(a=i.getItem("propertyicon"+t.property.type)),a){var u=this.mBlock.rect.width/a.rect.width,c=this.mBlock.rect.width,p=a.rect.height*u,h=new r.default("Icon");h.imageData=i,h.imageItem=a,h.move(0,(this.mBlock.rect.height-p)/2,c,p),h.setScale(120/180),this.addChild(h,n.ICON)}},n.prototype.reuse=function(t){if(e.prototype.reuse.call(this,t),t){var i=t,a=d.default.getInstance().getAtlas().getItem("propertyicon"+i.property.type),u=this.getChildByTag(n.ICON);u&&(u.imageItem=a)}},n.prototype.updateTouchState=function(t){this.opacity=t?.2:1},n.ICON=1,n}(s.default);m.default=o,cc._RF.pop()},{"../../MUI/MUISprite":"MUISprite","../loader/GameSceneFrameLoader":"GameSceneFrameLoader","./BlockNode":"BlockNode"}],PropertyConfig:[function(l,P,m){"use strict";cc._RF.push(P,"90c60UkITFM76TzIAoiRLAP","PropertyConfig"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PropertyDefines"),s=l("../util/Dictionary"),r=l("./PropertyFactory"),o=l("../business/Logic/GameItemsManager"),e=l("../util/NumberUtil"),n=function(){function t(){this.items=new s.Dictionary2(d.Property.compare)}return t.prototype.load=function(i){for(var a=0,u=i.length;a<u;++a){var c=this.parseItem(i[a]);c&&this.items.put(c.key.clone(),c)}return!0},t.prototype.getParam=function(i){return this.items.get(i)},t.prototype.getParamByItemId=function(i){for(var a=this.items.getPairs(),u=0,c=a.length;u<c;++u){var p=a[u].value;if(p.itemId===i)return p}return null},t.prototype.parseItem=function(i){var a=e.default.parseIntFromString(i.getId()),u=Math.max(1,e.default.parseIntFromString(i.getBuyPrice())),c=this.buyTypeToCostTypeEnum(i.getBuyType()),p=new d.Property(a,0),h=new d.PropertyParam(p);h.price=u,h.costType=c,h.name=i.getName()||"",h.itemId=i.getItemId()||"",h.describe=i.getDescribe()||"",h.pic=i.getPic()||"",h.small_pic=i.getSmallPic()||"";try{var f=i.getEffect()||"";if(f!=""){var g=JSON.parse(f);h.effect=this.parseEffect(p,g)}}catch(_){h.effect=null,console.warn("\u9753\u5177effect\u5F02\u5E38 itemid = "+h.itemId+"   effect = "+i.getEffect())}return h},t.prototype.parseEffect=function(i,a){return r.PropertyEffectFactory.create(i,a)},t.prototype.buyTypeToCostTypeEnum=function(i){if(i){if(i===o.GameItemsDefine.ID_GOLD)return d.COSTTYPE.GOLD;if(i===o.GameItemsDefine.ID_DIAMOND)return d.COSTTYPE.DIAMON}return d.COSTTYPE.GOLD},t}();m.default=n,cc._RF.pop()},{"../business/Logic/GameItemsManager":"GameItemsManager","../util/Dictionary":"Dictionary","../util/NumberUtil":"NumberUtil","./PropertyDefines":"PropertyDefines","./PropertyFactory":"PropertyFactory"}],PropertyDefines:[function(l,P,m){"use strict";var d;cc._RF.push(P,"f93cbPxsVFKSbPYRbKrOwIs","PropertyDefines"),Object.defineProperty(m,"__esModule",{value:!0}),(d=m.PROPERTYTYPE||(m.PROPERTYTYPE={}))[d.NULL=0]="NULL",d[d.DIAMOND=1]="DIAMOND",d[d.GOLD=2]="GOLD",d[d.ENERGY=3]="ENERGY",d[d.STAMPS=4]="STAMPS",d[d.SKIN_DEFAULT=5]="SKIN_DEFAULT",d[d.SKIN_ICE=6]="SKIN_ICE",d[d.SKIN_SAKURA=7]="SKIN_SAKURA",d[d.SKIN_WORLDCUP=8]="SKIN_WORLDCUP",d[d.SKIN_WORLDCUP_TRY1=9]="SKIN_WORLDCUP_TRY1",d[d.SKIN_WORLDCUP_TRY2=10]="SKIN_WORLDCUP_TRY2",d[d.SKIN_WORLDCUP_TRY3=11]="SKIN_WORLDCUP_TRY3",d[d.SKIN_GREENWILD=12]="SKIN_GREENWILD",d[d.SKIN_GIRL=13]="SKIN_GIRL",d[d.SKIN_GIRL_TRY1=14]="SKIN_GIRL_TRY1",d[d.SKIN_GIRL_TRY2=15]="SKIN_GIRL_TRY2",d[d.SKIN_GIRL_TRY3=16]="SKIN_GIRL_TRY3",d[d.SKIN_STARS=17]="SKIN_STARS",d[d.SKIN_STARS_TRY1=18]="SKIN_STARS_TRY1",d[d.SKIN_STARS_TRY2=19]="SKIN_STARS_TRY2",d[d.SKIN_STARS_TRY3=20]="SKIN_STARS_TRY3",d[d.GAME_DASH=21]="GAME_DASH",d[d.GAME_SLOW=22]="GAME_SLOW",d[d.GAME_SHIELD=23]="GAME_SHIELD",d[d.GAME_AVOID=29]="GAME_AVOID",d[d.GAME_CONVERSION=30]="GAME_CONVERSION",d[d.GAME_FANATICAL=31]="GAME_FANATICAL",d[d.GAME_FOG=32]="GAME_FOG",d[d.GAME_CONTROLL=33]="GAME_CONTROLL",d[d.GAME_OBSTACLE=34]="GAME_OBSTACLE",d[d.END=35]="END";var s,r,o=function(){function S(){}return S.ID_DIAMOND="1-1-0",S.ID_COINS="2-1-0",S.ID_POWER="3-1-0",S.ID_TICKET="7-1-0",S.ID_SKIN_DEFAULT="5-1-0",S.ID_SKIN_ICE="5-2-0",S.ID_SKIN_SAKURA="5-3-0",S.ID_SKIN_WORLDCUP0="5-4-0",S.ID_SKIN_WORLDCUP1="5-4-1",S.ID_SKIN_WORLDCUP2="5-4-2",S.ID_SKIN_WORLDCUP3="5-4-3",S.ID_SKIN_GREENWILD="5-5-0",S.ID_SKIN_GIRL0="5-6-0",S.ID_SKIN_GIRL1="5-6-1",S.ID_SKIN_GIRL2="5-6-2",S.ID_SKIN_GIRL3="5-6-3",S.ID_SKIN_STARS0="5-7-0",S.ID_SKIN_STARS1="5-7-1",S.ID_SKIN_STARS2="5-7-2",S.ID_SKIN_STARS3="5-7-3",S}();m.PROPERTYITEMID=o,(r=s=m.COSTTYPE||(m.COSTTYPE={}))[r.GOLD=0]="GOLD",r[r.DIAMON=1]="DIAMON";var e=function(){function S(I,v){v===void 0&&(v=0),this.type=I,this.quality=v}return S.prototype.isSame=function(I){return I.type===this.type&&I.quality===this.quality},S.prototype.clone=function(){return new S(this.type,this.quality)},S.compare=function(I,v){return I.type!=v.type||I.quality!=v.quality?I.type>v.type?1:-1:0},S}();m.Property=e;var n=function(){};m.PropertyEffect=n;var t=function(S){this.costType=s.GOLD,this.key=S,this.price=0,this.itemId="",this.name="",this.describe="",this.effect=null};m.PropertyParam=t;var i=function(){this.count=0};m.PropertyData=i;var a=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.speed=8,v.permanentTime=15,v.temporyTime=5,v}return __extends(I,S),I}(n);m.PropertyEffectDash=a;var u=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.speed=2,v.permanentTime=15,v.temporyTime=5,v}return __extends(I,S),I}(n);m.PropertyEffectSlow=u;var c=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.permanentTime=15,v.temporyTime=5,v}return __extends(I,S),I}(n);m.PropertyEffectShiled=c;var p=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.numberOfEffects=1,v}return __extends(I,S),I}(n);m.PropertyEffectAvoid=p;var h=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.numberOfEffects=1,v}return __extends(I,S),I}(n);m.PropertyEffectConversion=h;var f=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.duration=3,v.numberOfEffects=1,v}return __extends(I,S),I}(n);m.PropertyEffectFanatical=f;var g=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.duration=5,v}return __extends(I,S),I}(n);m.PropertyEffectFog=g;var _=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.duration=5,v}return __extends(I,S),I}(n);m.PropertyEffectControl=_;var y=function(S){function I(){var v=S!==null&&S.apply(this,arguments)||this;return v.numberOfObstacles=10,v.duration=5,v}return __extends(I,S),I}(n);m.PropertyEffectObstacle=y,cc._RF.pop()},{}],PropertyFactory:[function(l,P,m){"use strict";cc._RF.push(P,"d64f6R9KzZK0IeX3WCiByg1","PropertyFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PropertyDefines"),s=function(){function o(){}return o.prototype.createProperty=function(e){return null},o}();m.default=s;var r=function(){function o(){}return o.getObjectMember=function(e,n,t){var i=e?e[n]:null;return i||t},o.create=function(e,n){var t=null;switch(e.type){case d.PROPERTYTYPE.GAME_DASH:var i=new d.PropertyEffectDash,a=o.getObjectMember(n,"speed",i.speed);i.speed=Math.max(a,1),i.permanentTime=o.getObjectMember(n,"permanentTime",i.permanentTime),i.temporyTime=o.getObjectMember(n,"temporyTime",i.temporyTime),t=i;break;case d.PROPERTYTYPE.GAME_SLOW:i=new d.PropertyEffectSlow,a=o.getObjectMember(n,"speed",i.speed),i.speed=Math.max(a,1),i.permanentTime=o.getObjectMember(n,"permanentTime",i.permanentTime),i.temporyTime=o.getObjectMember(n,"temporyTime",i.temporyTime),t=i;break;case d.PROPERTYTYPE.GAME_SHIELD:(i=new d.PropertyEffectShiled).permanentTime=o.getObjectMember(n,"permanentTime",i.permanentTime),i.temporyTime=o.getObjectMember(n,"temporyTime",i.temporyTime),t=i;break;case d.PROPERTYTYPE.GAME_AVOID:(i=new d.PropertyEffectAvoid).numberOfEffects=o.getObjectMember(n,"numberOfEffects",i.numberOfEffects),t=i;break;case d.PROPERTYTYPE.GAME_CONVERSION:(i=new d.PropertyEffectConversion).numberOfEffects=o.getObjectMember(n,"numberOfEffects",i.numberOfEffects),t=i;break;case d.PROPERTYTYPE.GAME_FANATICAL:(i=new d.PropertyEffectFanatical).duration=o.getObjectMember(n,"duration",i.duration),i.numberOfEffects=o.getObjectMember(n,"numberOfEffects",i.numberOfEffects),t=i;break;case d.PROPERTYTYPE.GAME_FOG:(i=new d.PropertyEffectFog).duration=o.getObjectMember(n,"duration",i.duration),t=i;break;case d.PROPERTYTYPE.GAME_CONTROLL:(i=new d.PropertyEffectControl).duration=o.getObjectMember(n,"duration",i.duration),t=i;break;case d.PROPERTYTYPE.GAME_OBSTACLE:(i=new d.PropertyEffectObstacle).numberOfObstacles=o.getObjectMember(n,"numberOfObstacles",i.numberOfObstacles),i.duration=o.getObjectMember(n,"duration",i.duration),t=i}return t},o}();m.PropertyEffectFactory=r,cc._RF.pop()},{"./PropertyDefines":"PropertyDefines"}],PropertyHandler:[function(l,P,m){"use strict";cc._RF.push(P,"64bd8cuxfJBUbPZ337ZFICO","PropertyHandler"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./propertywork/SprintWorker"),s=l("./propertywork/ShieldWorker"),r=l("./propertywork/DecelerateWorker"),o=l("../../base/G"),e=l("../../property/PropertyDefines"),n=l("../services/ServiceProvider"),t=l("../workers/WorkerState"),i=l("./propertywork/FogWorker"),a=l("./property2/CtrlPropertyManager"),u=function(){function c(p,h){this.gameScene=null,this.propertyProcess=null,this.propertyProvider=new n.ServiceProvider,this.sprintWorker=null,this.decelerateWorker=null,this.ShieldWorker=null,this.stopBlockEffect=!1,this.deceleratePreStart=!1,this.fogWorker=null,this.PropertyManager=new a.CtrlPropertyManager,this.propertyProcess=h,this.gameScene=p}return c.prototype.initialize=function(){},c.prototype.uninitialize=function(){},c.prototype.execute=function(p){this.PropertyManager.propertyProcess=this.propertyProcess,this.PropertyManager.exe(p)},c.prototype.startSprint=function(){var p=this;try{var h=e.PROPERTYTYPE.GAME_DASH,f=this.getPropertyEffect(h),g=this.getPropertyResume(h),_=this.sprintWorker?this.sprintWorker.state:t.WorkerState.stopped,y=this.gameScene.getCurrentStage(),S=y.type;if(this.cantPropertyWork({effect:f,state:_,stageType:S,resume:g}))return;this.propertyProvider.register("SprintWorker",new d.default),this.sprintWorker=this.propertyProvider.resolve("SprintWorker"),this.sprintWorker.canPauseAndContinue=!0,this.sprintWorker.start(y,f,function(){p.stopSprint()}),this.setStopBlockEffect(!0),this.propertyProcess&&this.propertyProcess.onStartProperty(h)}catch(I){this.sprintWorker.reset(),this.sprintWorker=null,console.log("--- game scene startSprint err:---",I)}},c.prototype.stopSprint=function(){try{if(!this.sprintWorker||this.sprintWorker.state===t.WorkerState.stopped)return;this.sprintWorker.stop(),this.setStopBlockEffect(!1),this.sprintWorker=null,this.propertyProcess&&this.propertyProcess.onEndProperty(e.PROPERTYTYPE.GAME_DASH)}catch(p){console.log("--- game scene stopSprint err:---",p)}},c.prototype.preStartDecelerate=function(){try{var p=this.getPropertyResume(e.PROPERTYTYPE.GAME_SLOW);console.log("--- game scene preStartDecelerate resume:---",p);var h=this.decelerateWorker?this.decelerateWorker.state:t.WorkerState.stopped,f=this.gameScene.getCurrentStage().type;if(this.cantPropertyWork({state:h,stageType:f,resume:p}))return;this.propertyProvider.register("DecelerateWorker",new r.default),this.decelerateWorker=this.propertyProvider.resolve("DecelerateWorker"),this.decelerateWorker.canPauseAndContinue=!0,this.setDeceleratePreStart(!0),this.propertyProcess&&this.propertyProcess.onPreStartProperty(e.PROPERTYTYPE.GAME_SLOW)}catch(g){this.decelerateWorker.reset(),this.decelerateWorker=null,console.log("--- game scene preStartDecelerate err:---",g)}},c.prototype.startDecelerate=function(){var p=this;try{var h=this.getPropertyEffect(e.PROPERTYTYPE.GAME_SLOW),f=this.gameScene.getCurrentStage();if(!h||!this.decelerateWorker||!this.deceleratePreStart)return;var g=this.decelerateWorker;g.start(f,h,function(){p.stopDecelerate()}),this.propertyProcess&&this.propertyProcess.onStartProperty(e.PROPERTYTYPE.GAME_SLOW)}catch(_){this.decelerateWorker.reset(),this.decelerateWorker=null,console.log("--- game scene startDecelerate err:---",_)}},c.prototype.stopDecelerate=function(){try{if(!this.decelerateWorker||this.decelerateWorker.state===t.WorkerState.stopped)return;this.decelerateWorker.stop(),this.decelerateWorker=null,this.propertyProcess&&this.propertyProcess.onEndProperty(e.PROPERTYTYPE.GAME_SLOW)}catch(p){console.log("--- game scene stopDecelerate err:---",p)}},c.prototype.ShieldCant=function(){var p=this.getPropertyEffect(e.PROPERTYTYPE.GAME_SHIELD),h=this.getPropertyResume(e.PROPERTYTYPE.GAME_SHIELD),f=this.ShieldWorker?this.ShieldWorker.state:t.WorkerState.stopped,g=this.gameScene.getCurrentStage().type;return this.cantPropertyWork({effect:p,state:f,stageType:g,resume:h})},c.prototype.startShield=function(){var p=this;try{var h=e.PROPERTYTYPE.GAME_SHIELD,f=this.getPropertyEffect(h),g=this.getPropertyResume(h),_=(this.ShieldWorker?this.ShieldWorker.state:t.WorkerState.stopped,this.gameScene.getCurrentStage());if(_.type,g===!1)return;this.propertyProvider.register("ShieldWorker",new s.default),this.ShieldWorker=this.propertyProvider.resolve("ShieldWorker"),this.ShieldWorker.canPauseAndContinue=!0,this.ShieldWorker.start(_,f,function(y){console.log("--- startShield callback ret---",y),y===1&&p.stopShield()},function(y){0<y&&p.propertyProcess.onWillEndProperty(h)}),this.propertyProcess&&this.propertyProcess.onStartProperty(e.PROPERTYTYPE.GAME_SHIELD)}catch(y){this.ShieldWorker=null,console.log("--- game scene startShield err:---",y)}},c.prototype.stopShield=function(){try{if(!this.ShieldWorker||this.ShieldWorker.state===t.WorkerState.stopped)return;this.ShieldWorker.stop(),this.propertyProcess&&this.propertyProcess.onEndProperty(e.PROPERTYTYPE.GAME_SHIELD),this.ShieldWorker=null,console.log("--- game scene stopShield ---",this.ShieldWorker)}catch(p){console.log("--- game scene stopShield err:---",p)}},c.prototype.cantPropertyWork=function(p){var h=p.effect,f=h===void 0?{}:h,g=p.state,_=g===void 0?0:g,y=p.stageType,S=y===void 0?0:y,I=p.resume;return!f||_!==0||S===0||S===1||S===3||!(I===void 0||I)},c.prototype.pauseProperty=function(){this.sprintWorker&&this.sprintWorker.pause(),this.decelerateWorker&&this.decelerateWorker.pause(),this.ShieldWorker&&this.ShieldWorker.pause()},c.prototype.resumeProperty=function(){this.sprintWorker&&this.sprintWorker.resume(),this.decelerateWorker&&this.decelerateWorker.resume(),this.ShieldWorker&&this.ShieldWorker.resume()},c.prototype.getShieldWorker=function(){return this.ShieldWorker},c.prototype.getSprintWorker=function(){return this.sprintWorker},c.prototype.getDecelerateWorker=function(){return this.decelerateWorker},c.prototype.getPropertyEffect=function(p){if(p){var h=o.G.Ap.propertyPack,f=new e.Property(p),g=h&&h.getConfig().getParam(f);return g?g.effect:void 0}},c.prototype.getPropertyResume=function(p){if(p){var h=o.G.Ap.state,f=new e.Property(p);return h&&h.resumeCarryProperty(f)}},c.prototype.getResumeCount=function(p){if(p){var h=o.G.Ap.state,f=new e.Property(p);return h&&h.getCarryPropertyCount(f)}},c.prototype.getStopBlockEffect=function(){return this.stopBlockEffect},c.prototype.setStopBlockEffect=function(p){this.stopBlockEffect=p},c.prototype.setDeceleratePreStart=function(p){this.deceleratePreStart=p},c.prototype.startFog=function(){var p=this;try{var h=e.PROPERTYTYPE.GAME_FOG,f=this.getPropertyEffect(h),g=(this.getPropertyResume(h),this.sprintWorker?this.sprintWorker.state:t.WorkerState.stopped,this.gameScene.getCurrentStage());g.type,this.propertyProvider.register("FogWorker",new i.default),this.fogWorker=this.propertyProvider.resolve("FogWorker"),this.fogWorker.canPauseAndContinue=!0,this.fogWorker.OnCompleted=function(){p.stopFog()},this.fogWorker.start(g,f,function(){p.stopFog()}),this.setStopBlockEffect(!0),this.propertyProcess&&this.propertyProcess.onStartProperty(h)}catch(_){this.fogWorker.reset(),this.fogWorker=null,console.log("--- game scene startSprint err:---",_)}},c.prototype.stopFog=function(){try{if(!this.fogWorker||this.fogWorker.state===t.WorkerState.stopped)return;this.fogWorker.stop(),this.setStopBlockEffect(!1),this.fogWorker=null,this.propertyProcess&&this.propertyProcess.onEndProperty(e.PROPERTYTYPE.GAME_DASH)}catch(p){console.log("--- game scene stopSprint err:---",p)}},c}();m.PropertyHandler=u,cc._RF.pop()},{"../../base/G":"G","../../property/PropertyDefines":"PropertyDefines","../services/ServiceProvider":"ServiceProvider","../workers/WorkerState":"WorkerState","./property2/CtrlPropertyManager":"CtrlPropertyManager","./propertywork/DecelerateWorker":"DecelerateWorker","./propertywork/FogWorker":"FogWorker","./propertywork/ShieldWorker":"ShieldWorker","./propertywork/SprintWorker":"SprintWorker"}],PropertyInterfaces:[function(l,P,m){"use strict";cc._RF.push(P,"b98851wxt9IXJWfTvFWPGvp","PropertyInterfaces"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],PropertyIntroduction:[function(l,P,m){"use strict";cc._RF.push(P,"84adeDGFEVJLZvHfappQy44","PropertyIntroduction"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/nodeFacade"),s=l("../../business/UI/GameEntraScene/ImgCache"),r=l("../../business/Logic/I18nManager"),o=l("../../business/keypad/KeypadNavigator"),e=cc._decorator,n=e.ccclass,t=e.property,i=function(a){function u(){var c=a!==null&&a.apply(this,arguments)||this;return c.confirmCallback=null,c.mTitleSprite=null,c.confirmButton=null,c}return __extends(u,a),u.prototype.enResLoad=function(){var c=this;this.enSpriteSetNull(),s.default.loadAtlasSpriteFrames("static_res/gamestore_en","intro_header",function(p,h){cc.isValid(c,!0)&&c.mTitleSprite&&(c.mTitleSprite.spriteFrame=h)}),s.default.loadAtlasSpriteFrames("static_res/gamestore_en","know_button",function(p,h){cc.isValid(c,!0)&&c.confirmButton&&(c.confirmButton.normalSprite=h)}),s.default.loadAtlasSpriteFrames("static_res/gamestore_en","know_button_press",function(p,h){cc.isValid(c,!0)&&c.confirmButton&&(c.confirmButton.pressedSprite=h)})},u.prototype.enSpriteSetNull=function(){this.mTitleSprite&&(this.mTitleSprite.getComponent(cc.Sprite).spriteFrame=null),this.confirmButton&&(this.confirmButton.getComponent(cc.Sprite).spriteFrame=null)},u.prototype.onLoad=function(){r.default.getInstance().isEnglish()&&this.enResLoad();var c=new d.default(this.node).getChild("content");c&&(this.buildBkg(),this.buildConfirmBtn(c),o.default.getInstance().pushDialog(this.node,"PropertyIntroduction"))},u.prototype.buildBkg=function(){var c=this.node.getChildByName("bkg");c&&(c.on(cc.Node.EventType.TOUCH_START,function(p){p.stopPropagation()}),c.on(cc.Node.EventType.TOUCH_END,function(p){p.stopPropagation()}))},u.prototype.buildConfirmBtn=function(c){var p=this,h=c.getChild("confirm_button").getNode();h&&h.on(cc.Node.EventType.TOUCH_END,function(f){p.onConfirmBtnClick(),p.confirmCallback(),f.stopPropagation(),o.default.getInstance().popDialog(p.node,"PropertyIntroduction")})},u.prototype.onConfirmBtnClick=function(){this.node.active=!1},u.prototype.setConfirmCallback=function(c){c&&(this.confirmCallback=c)},__decorate([t(cc.Sprite)],u.prototype,"mTitleSprite",void 0),__decorate([t(cc.Button)],u.prototype,"confirmButton",void 0),u=__decorate([n],u)}(cc.Component);m.default=i,cc._RF.pop()},{"../../business/Logic/I18nManager":"I18nManager","../../business/UI/GameEntraScene/ImgCache":"ImgCache","../../business/keypad/KeypadNavigator":"KeypadNavigator","../../util/nodeFacade":"NodeFacade"}],PropertyPack:[function(l,P,m){"use strict";cc._RF.push(P,"e4cab+LrEdI0KKh04aJwMRk","PropertyPack"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PropertyBarrel"),s=l("./PropertyConfig"),r=l("../business/Network/Protocol/StorageUtil"),o=l("../config/LSKey"),e=l("../business/Logic/GameItemsManager"),n=function(){function t(){this.config=new s.default,this.playPropertyBarrel=new d.default(this.config)}return t.prototype.initilize=function(){var i=e.GameItemsManager.getIns().getAllItems();this.config.load(i);var a=r.default.read(o.default.PROPERTY_DATA,"{}");a!=""&&this.loadProperties(a)},t.prototype.save=function(){var i=new Object;i.play=this.playPropertyBarrel.stringfy();var a=JSON.stringify(i);r.default.save(o.default.PROPERTY_DATA,a)},t.prototype.getConfig=function(){return this.config},t.prototype.getPlayProperty=function(){return this.playPropertyBarrel},t.prototype.loadProperties=function(i){try{var a=JSON.parse(i);if(a===null)return;var u=a.play;u!=null&&this.playPropertyBarrel.parse(u)}catch(c){console.warn("\u9053\u5177\u6570\u636E\u5F02\u5E38")}},t}();m.default=n,cc._RF.pop()},{"../business/Logic/GameItemsManager":"GameItemsManager","../business/Network/Protocol/StorageUtil":"StorageUtil","../config/LSKey":"LSKey","./PropertyBarrel":"PropertyBarrel","./PropertyConfig":"PropertyConfig"}],PropertyProcess:[function(l,P,m){"use strict";cc._RF.push(P,"ad2a1PHfgJK6qmVoEpTu3iy","PropertyProcess"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PropertySeeing"),s=l("./PropertyReport"),r=l("./PropertyHandler"),o=l("../../property/PropertyDefines"),e=l("../../util/Utility"),n=l("../GameBus"),t=l("../workers/WorkerState"),i=l("./PropertyIntroduction"),a=l("../../business/Logic/PlayerMgr"),u=l("../../config/LSKey"),c=l("../../business/Network/Protocol/StorageUtil"),p=l("../../business/UI/GameEntraScene/PrefabMgr"),h=l("../../base/G"),f=function(){this.iconNode=null,this.effectNode=null};m.PropertyHandlerParam=f;var g=function(){function _(y){this.rootNode=null,this.propertyIntroductionPrefabName=null,this.propertyIntroClickCallback=null,this.gameScene=null,this.decelerateLoad=!1,this.gameScene=y,this.propertySeeing=new d.default,this.propertyReport=new s.default,this.propertyHandler=new r.PropertyHandler(this.gameScene,this)}return _.prototype.initialize=function(y,S){this.propertySeeing.initialize(y.iconNode,y.effectNode),this.propertyReport.initialize(),this.rootNode=S,this.initPropertyIntroduction()},_.prototype.uninitialize=function(){this.propertySeeing.uninitialize(),this.propertyReport.uninitialize()},_.prototype.initPropertyIntroduction=function(){var y=this;try{var S=this.gameScene.allowProperty();if(!this.propertyIntroductionPrefabName||!S)return;var I=a.default.Ins().getUserLevel(),v=c.default.read(u.default.PROPERTY_INTRODUCTION_SHOW,"0")==="1";console.log("--- initPropertyIntroduction level---",I),console.log("--- initPropertyIntroduction showed---",v),I&&3<=I&&!v?p.default.load(this.propertyIntroductionPrefabName,function(C,T){if(T){var E=T.getComponent(i.default);y.rootNode.addChild(T,101),y.propertyIntroClickCallback(!1),E.setConfirmCallback(function(){T.destroy(),y.propertyIntroClickCallback(!0)}),c.default.save(u.default.PROPERTY_INTRODUCTION_SHOW,"1")}}):this.propertyIntroClickCallback(!0)}catch(C){this.propertyIntroClickCallback(!0),console.log("--- initPropertyIntroduction err ---",C)}},_.prototype.onGameStart=function(){this.propertySeeing.onGameStart(),this.propertyReport.onGameStart(),this.propertyHandler.startSprint()},_.prototype.beforeGameOver=function(y,S){this.propertyHandler.getResumeCount(o.PROPERTYTYPE.GAME_SHIELD)?this.propertyHandler.startShield():y!=null&&y.call(S)},_.prototype.onGameOver=function(){this.stopRunningProperty()},_.prototype.onGameCancel=function(){this.propertySeeing.onGameCancel(),this.propertyReport.onGameCancel()},_.prototype.onGameRelive=function(){this.decelerateLoad&&this.propertyHandler.preStartDecelerate()},_.prototype.onGamePause=function(){this.stopRunningProperty()},_.prototype.onGameResume=function(){this.propertyHandler.resumeProperty(),this.decelerateLoad?this.propertyHandler.startDecelerate():this.relivePropType&&(this.relivePropType==o.PROPERTYTYPE.GAME_DASH?this.propertyHandler.startSprint():(this.relivePropType,o.PROPERTYTYPE.GAME_SHIELD))},_.prototype.onGameStageStart=function(y){},_.prototype.onGameStageFinish=function(y){y===e.Utility.GAMESTAGE.MUSIC&&this.existRunningProperty()&&(this.propertyHandler.stopSprint(),this.propertyHandler.stopDecelerate(),this.propertyHandler.stopShield(),this.propertyHandler.stopFog())},_.prototype.onAttainHonor=function(y,S){},_.prototype.onConsumeProperty=function(y){return h.G.Ap.state.resumeCarryProperty(new o.Property(y))},_.prototype.onPreStartProperty=function(y){y===o.PROPERTYTYPE.GAME_SLOW&&(this.propertySeeing.createProperties(o.PROPERTYTYPE.GAME_SLOW),this.propertySeeing.onResumeProperty(new o.Property(o.PROPERTYTYPE.GAME_SLOW)))},_.prototype.onStartProperty=function(y){y===o.PROPERTYTYPE.GAME_DASH?this.propertySeeing.createProperties(y).sprintNodeAnim():y===o.PROPERTYTYPE.GAME_SLOW?this.propertySeeing.decelerateNodeAnim():y===o.PROPERTYTYPE.GAME_SHIELD?(this.propertySeeing.createProperties(y),this.propertySeeing.shieldNodeAnim()):o.PROPERTYTYPE.GAME_FOG,this.propertySeeing.onResumeProperty(new o.Property(y))},_.prototype.onEndProperty=function(y){var S=this;if(y===o.PROPERTYTYPE.GAME_DASH){var I=function(){S.propertySeeing.destroyProperties(o.PROPERTYTYPE.GAME_DASH)};n.default.getInstance().scheduler.scheduleOnce(function(){S.propertySeeing.setSprintAnimEndCb(I).stopSprintNodeAnim()},1)}else this.propertySeeing.destroyProperties(y)},_.prototype.onWillEndProperty=function(y){try{y===o.PROPERTYTYPE.GAME_SHIELD&&this.propertySeeing.shieldNodeWillAnim()}catch(S){console.log("--- onWillEndProperty err---",S)}},_.prototype.getStopBlockEffect=function(){return this.propertyHandler.getStopBlockEffect()},_.prototype.existRunningProperty=function(){var y=this.getSprintWorker(),S=this.getDecelerateWorker(),I=this.getShieldWorker();return y&&y.state===t.WorkerState.running||S&&S.state===t.WorkerState.running||I&&I.state===t.WorkerState.running},_.prototype.getRunningProperty=function(){var y=this.getSprintWorker(),S=this.getDecelerateWorker(),I=this.getShieldWorker(),v=null;return y&&y.state===t.WorkerState.running?v=y:S&&S.state===t.WorkerState.running?v=S:I&&I.state===t.WorkerState.running&&(v=I),v},_.prototype.destroyPropertyIcon=function(y){y&&this.propertySeeing.onResumeProperty(new o.Property(o.PROPERTYTYPE.GAME_SLOW))},_.prototype.stopRunningProperty=function(){var y=this.getRunningProperty();y&&(this.propertySeeing.destroyPropertyByName(y.name),y.stop()),this.propertyHandler.setDeceleratePreStart(!1)},_.prototype.getSprintWorker=function(){return this.propertyHandler.getSprintWorker()},_.prototype.getDecelerateWorker=function(){return this.propertyHandler.getDecelerateWorker()},_.prototype.getShieldWorker=function(){return this.propertyHandler.getShieldWorker()},_.prototype.getPropertyResume=function(y){return this.propertyHandler.getPropertyResume(y)},_.prototype.getResumeCount=function(y){return this.propertyHandler.getResumeCount(y)},_.prototype.setDecelerateLoad=function(y){this.decelerateLoad=y},_.prototype.setRelivePropType=function(y){this.relivePropType=y},_.prototype.setPropertyIntroductionPrefab=function(y){this.propertyIntroductionPrefabName=y},_.prototype.setPropertyIntroductionClickCb=function(y){y&&(this.propertyIntroClickCallback=y)},_.prototype.getView=function(){return this.propertySeeing},_}();m.default=g,cc._RF.pop()},{"../../base/G":"G","../../business/Logic/PlayerMgr":"PlayerMgr","../../business/Network/Protocol/StorageUtil":"StorageUtil","../../business/UI/GameEntraScene/PrefabMgr":"PrefabMgr","../../config/LSKey":"LSKey","../../property/PropertyDefines":"PropertyDefines","../../util/Utility":"Utility","../GameBus":"GameBus","../workers/WorkerState":"WorkerState","./PropertyHandler":"PropertyHandler","./PropertyIntroduction":"PropertyIntroduction","./PropertyReport":"PropertyReport","./PropertySeeing":"PropertySeeing"}],PropertyReport:[function(l,P,m){"use strict";cc._RF.push(P,"41c264AjiBEipq63YHGZuD2","PropertyReport"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/G"),s=l("../../property/PropertyDefines"),r=l("../../infoc/easyReport"),o=function(){function e(){}return e.prototype.initialize=function(){},e.prototype.uninitialize=function(){},e.prototype.onGameStart=function(){},e.prototype.onGameCancel=function(){this.reportUsage()},e.prototype.reportUsage=function(){for(var n=d.G.Ap.state,t=new r.default(173),i=[s.PROPERTYTYPE.GAME_DASH,s.PROPERTYTYPE.GAME_SLOW,s.PROPERTYTYPE.GAME_SHIELD],a=0,u=i.length;a<u;++a){var c="item"+i[a],p=n.carryProperties.get(new s.Property(i[a]));p?(t.add(c+"_carry",p.originCount),t.add(c+"_use",Math.max(p.originCount-p.count,0))):(t.add(c+"_carry",0),t.add(c+"_use",0))}t.report()},e}();m.default=o,cc._RF.pop()},{"../../base/G":"G","../../infoc/easyReport":"EasyReport","../../property/PropertyDefines":"PropertyDefines"}],PropertySeeing:[function(l,P,m){"use strict";cc._RF.push(P,"c71e8qQFRlBUaZBK96ebPQw","PropertySeeing"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../MUI/MUINode"),s=l("../element/loader/GameSceneFrameLoader"),r=l("../../property/PropertyDefines"),o=l("../MUI/MUISprite"),e=l("../../base/G"),n=l("../animation/action/MFadeTo"),t=l("../animation/action/MFrameSequence"),i=l("../GameBus"),a=l("../animation/action/MSequence"),u=l("../animation/action/MActionFactory"),c=l("../animation/action/MMoveTo"),p=l("../animation/action/MCallFunc"),h=l("../MUI/MUINineScaleSprite"),f=l("../MUI/MUIDefines"),g=function(){function _(){this.actionFactory=new u.default,this.sprintAnimEndCb=null,this.sprintCallback=null,this.iconNode=null,this.effectNode=null,this.iconPanelNode=null,this.shieldAnimNode=null}return _.prototype.initialize=function(y,S){this.iconNode=y,this.effectNode=S},_.prototype.uninitialize=function(){},_.prototype.onGameStart=function(){this.createIcons()},_.prototype.onGameCancel=function(){},_.prototype.createIcons=function(){if(this.iconNode){var y=this.iconNode.getRect(),S=new cc.Size(48,48);this.iconPanelNode=new d.default("PanelNode"),this.iconPanelNode.move(y.width-S.width-4,y.height-280,0,0),this.iconNode.addChild(this.iconPanelNode);for(var I=s.default.getInstance().getAtlas(),v=[r.PROPERTYTYPE.GAME_DASH,r.PROPERTYTYPE.GAME_SLOW,r.PROPERTYTYPE.GAME_SHIELD],C=0,T=0;T<3;++T)if(e.G.Ap.state.getCarryPropertyCount(new r.Property(v[T]))!==0){var E=new o.default("propertyicon"+v[T]);E.setContentSize(S.width,S.height),E.setPosition(0,162-(S.height+6)*C),E.imageData=s.default.getInstance().getAtlas(),E.imageItem=I.getItem("propertyicon"+v[T]),this.iconPanelNode.addChild(E,v[T]),++C}}},_.prototype.onResumeProperty=function(y){if(this.iconPanelNode){var S=this.iconPanelNode.getChildByTag(y.type);if(e.G.Ap.state.getCarryPropertyCount(y)===0){var I=new n.default(0,.5);i.default.getInstance().getAnimationMgr().runAction(S,I)}else{I=new n.default(0,.5);var v=new n.default(1,.5),C=new a.default(I,v);i.default.getInstance().getAnimationMgr().runAction(S,C)}}},_.prototype.createProperties=function(y){try{if(!y||!this.effectNode)return;var S=null;switch(y){case r.PROPERTYTYPE.GAME_DASH:S=this.getSprintNode();break;case r.PROPERTYTYPE.GAME_SLOW:S=this.getDecelerateNode();break;case r.PROPERTYTYPE.GAME_SHIELD:S=this.getShieldNode();break;case r.PROPERTYTYPE.GAME_FOG:S=this.getFogNode()}return S&&this.effectNode.addChild(S),this}catch(I){console.log("--- createProperties err:---",I)}},_.prototype.getFogNode=function(){var y=this.effectNode.getRect(),S=s.default.getInstance().getAtlas2(),I=y.width,v=y.height,C=new d.default("Fog"),T=new o.default("SprintBkg"),E=new o.default("SprintLine");if(T.imageItem=S.getItem("spr_bkg"),E.imageItem=S.getItem("spr_line"),T.imageItem&&E.imageItem)return T.setContentSize(2*T.imageItem.rect.width,2*T.imageItem.rect.height),T.setPosition(0,0),E.imageData=T.imageData=S,E.setContentSize(I,v),E.setPosition(0,0),C.addChild(T),C.addChild(E),C},_.prototype.getSprintNode=function(){var y=this.effectNode.getRect(),S=s.default.getInstance().getAtlas2(),I=y.width,v=y.height,C=-v,T=new d.default("Sprint"),E=new o.default("SprintBkg"),A=new o.default("SprintLine");if(E.imageItem=S.getItem("spr_bkg"),A.imageItem=S.getItem("spr_line"),E.imageItem&&A.imageItem)return E.setContentSize(2*E.imageItem.rect.width,2*E.imageItem.rect.height),E.setPosition(0,C),A.imageData=E.imageData=S,A.setContentSize(I,v),A.setPosition(0,C),T.addChild(E),T.addChild(A),T},_.prototype.sprintNodeAnim=function(){var y=this.effectNode.getChildByName("Sprint");if(y){var S=y.getChildByName("SprintBkg"),I=y.getChildByName("SprintLine");this.sprintBkgPlay(S),this.sprintLinePlay(I)}},_.prototype.sprintBkgPlay=function(y){var S=this.effectNode.getRect().height/2-122,I=new c.default(0,S,.4),v=new c.default(0,S-45,.4),C=new a.default(v,I),T=function(){i.default.getInstance().animationMgr.runAction(y,C)};this.sprintCallback=T;var E=new c.default(0,S,.6),A=new a.default(E,new p.default(function(M){i.default.getInstance().scheduler.scheduleLoop(T,.8,99,0)}));i.default.getInstance().animationMgr.runAction(y,A)},_.prototype.sprintLinePlay=function(y){var S=this.effectNode.getRect().height,I=new c.default(0,-S/2,.01),v=new c.default(0,-S,.5),C=new a.default(v,I),T=function(){i.default.getInstance().animationMgr.runAction(y,C)},E=new a.default(I,new p.default(function(A){i.default.getInstance().scheduler.scheduleLoop(T,.6,99,0)}));i.default.getInstance().animationMgr.runAction(y,E)},_.prototype.stopSprintNodeAnim=function(){var y=this,S=this.effectNode.getChildByName("Sprint");if(S){var I=i.default.getInstance().animationMgr,v=this.effectNode.getRect().height,C=S.getChildByName("SprintBkg"),T=S.getChildByName("SprintLine");I.stopTargetActions(C),this.sprintCallback&&i.default.getInstance().scheduler.unSchedule(this.sprintCallback),S.removeChild(T);var E=new c.default(0,v,.3),A=new c.default(0,0,.2),M=new a.default(A,E,new p.default(function(k){y.sprintAnimEndCb&&y.sprintAnimEndCb()}));I.runAction(C,M)}},_.prototype.getDecelerateNode=function(){var y=this.effectNode.getRect(),S=s.default.getInstance().getAtlas2(),I=y.width,v=y.height,C=I/4,T=v/4,E=new d.default("Decelerate"),A=new h.default;if(A.setContentSize(I/2,v/2),A.setPosition(C,T),A.setScale(2,2),A.imageData=S,A.imageItem=S.getItem("dec_bkg"),A.imageItem)return A.setInset(179,235,180,236.5),E.setOpacity(1),E.addChild(A),E},_.prototype.decelerateNodeAnim=function(){},_.prototype.shieldNodeAnim=function(){var y=this.effectNode.getChildByName("shield"),S=y.getChildByName("shieldMiss"),I=y.getChildByName("shieldBkg"),v=this.actionFactory.createMScaleTo(1.1,1.1,.3),C=this.actionFactory.createMScaleTo(.9,.9,.3),T=new a.default(v,C),E=function(){i.default.getInstance().animationMgr.runAction(y,T)};i.default.getInstance().scheduler.scheduleOnce(function(){y.removeChild(S),I.setOpacity(1),i.default.getInstance().scheduler.scheduleLoop(E,1,60,0)},1)},_.prototype.shieldNodeWillAnim=function(){if(this.shieldAnimNode!=null){console.log("shieldNodeWillAnim shieldNodeWillAnim");var y=this.effectNode.getRect(),S=y.width,I=y.height,v=this.effectNode.getChildByName("shield");if(v&&f.MUI.global.renderType!=f.MUI.RenderType.WEBGL){var C=this.shieldAnimNode;v.removeAllChildren(),v.addChild(C),v.setPosition(.5*S,I-320);var T=new t.default(81,3);i.default.getInstance().animationMgr.runAction(C,T)}}},_.prototype.getShieldWillAnim=function(){this.effectNode.getRect();for(var y=s.default.getInstance().getShieldAnimation(),S=new o.default("shieldAnim"),I=[],v=1;v<=81;v++){var C=v.toString();C.length<2?C="00"+C:C.length==2&&(C="0"+C),C="shield_"+C,I.push(C)}if(S.imageData=y,S.imageItem=y.getItem("shield_001"),S.imageItem)return S.frameSequence=y.createFrameSequence(I),S.setContentSize(720,690),S.setPosition(-360,-345),S},_.prototype.getShieldNode=function(){var y=this.effectNode.getRect(),S=s.default.getInstance().getAtlas2(),I=y.width,v=y.height,C=new d.default("shield"),T=new o.default("shieldBkg"),E=new o.default("shieldMiss"),A=S.getItem("shield"),M=S.getItem("miss");return A.rect.center(),T.imageData=S,T.imageItem=A,E.imageData=S,E.imageItem=M,T.setContentSize(2*A.rect.width,2*A.rect.height),T.setPosition(-A.rect.width,-A.rect.height),T.setOpacity(0),E.setContentSize(217,68),E.setPosition(-M.rect.width,-M.rect.height),C.addChild(T,0),C.addChild(E,1),C.setPosition(.5*I,v-320),this.shieldAnimNode=this.getShieldWillAnim(),C},_.prototype.destroyProperties=function(y){try{if(!y||!this.effectNode)return;var S,I="";switch(y){case r.PROPERTYTYPE.GAME_DASH:I="Sprint";break;case r.PROPERTYTYPE.GAME_SLOW:I="Decelerate";break;case r.PROPERTYTYPE.GAME_SHIELD:I="shield"}(S=this.effectNode.getChildByName(I))&&this.effectNode.removeChild(S)}catch(v){console.log("--- destroyProperties err:---",v)}},_.prototype.destroyPropertyByName=function(y){try{var S=null;switch(y){case"SprintWorker":S=r.PROPERTYTYPE.GAME_DASH;break;case"DecelerateWorker":S=r.PROPERTYTYPE.GAME_SLOW;break;case"ShieldWorker":S=r.PROPERTYTYPE.GAME_SHIELD}S&&this.destroyProperties(S)}catch(I){console.log("--- destroyRunningProperties err:---",I)}},_.prototype.setSprintAnimEndCb=function(y){return this.sprintAnimEndCb=y,this},_.prototype.onAttainProperty=function(){},_.prototype.getEffectNode=function(){return this.effectNode},_}();m.default=g,cc._RF.pop()},{"../../base/G":"G","../../property/PropertyDefines":"PropertyDefines","../GameBus":"GameBus","../MUI/MUIDefines":"MUIDefines","../MUI/MUINineScaleSprite":"MUINineScaleSprite","../MUI/MUINode":"MUINode","../MUI/MUISprite":"MUISprite","../animation/action/MActionFactory":"MActionFactory","../animation/action/MCallFunc":"MCallFunc","../animation/action/MFadeTo":"MFadeTo","../animation/action/MFrameSequence":"MFrameSequence","../animation/action/MMoveTo":"MMoveTo","../animation/action/MSequence":"MSequence","../element/loader/GameSceneFrameLoader":"GameSceneFrameLoader"}],PropertyStorePrefab:[function(l,P,m){"use strict";cc._RF.push(P,"be7ae6ufmBB+b5249GZdYa/","PropertyStorePrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../property/PropertyDefines"),s=l("../../base/G"),r=l("../../util/nodeFacade"),o=l("../Logic/MoneySystem"),e=l("../UI/GameEntraScene/BasicTouchEvent"),n=l("../../infoc/easyReport"),t=l("../UI/GameEntraScene/ImgCache"),i=l("../Logic/GameItemsManager"),a=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),u=l("../Network/Protocol/StorageUtil"),c=l("../../config/LSKey"),p=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),h=l("../../util/PU"),f=l("../UI/GameEntraScene/PrefabMgr"),g=l("../UI/playerInfoPopup/PlayerInfoPopupProfab"),_=l("../../infoc/m_p2_pop_coin"),y=l("../Logic/I18nManager"),S=l("../keypad/KeypadNavigator"),I=cc._decorator,v=I.ccclass,C=I.property,T=function(E){function A(){var k=E!==null&&E.apply(this,arguments)||this;return k.freePrizeButton=null,k.freeTimeLabel=null,k.mBuyBtn=null,k.mBuyBtnGoldIcon=null,k.mBuyBtnDiamondIcon=null,k.mBuyBtnLabel=null,k.mDescLabel=null,k.mPropertyIcon=null,k.mAddBtn=null,k.mJianBtn=null,k.mPropertyCountLabel=null,k.mProgressFront=null,k.mProgressBack=null,k.mSlider=null,k.mTitleSprite=null,k.mProgress=1,k.lastUpdateTime=0,k.coolingCountdownTime=0,k.coolingCheckTime={lastCheckTime:0,timeout:function(){return 1e3<Date.now()-k.coolingCheckTime.lastCheckTime&&(k.coolingCheckTime.lastCheckTime=Date.now(),!0)}},k.AD_INTERVAL_COOLING_TIME=18e4,k.AD_DAILY_SHOW_TIME=3,k.callback=null,k.priortyProperty=null,k.freeButtonTouchCallback=null,k.buyButtonTouchCallback=null,k.closeButtonTouchCallback=null,k.mAddBtnTouchCallback=null,k.mJianBtnTouchCallback=null,k}var M;return __extends(A,E),(M=A).prototype.enResLoad=function(){var k=this;t.default.loadAtlasSpriteFrames("static_res/gamestore_en","title",function(D,L){cc.isValid(k,!0)&&k.mTitleSprite&&(k.mTitleSprite.spriteFrame=L)}),t.default.loadAtlasSpriteFrames("static_res/gamestore_en","video_ad_button_normal",function(D,L){cc.isValid(k,!0)&&(k.freePrizeButton.normalSprite=L)}),t.default.loadAtlasSpriteFrames("static_res/gamestore_en","video_ad_button_press",function(D,L){cc.isValid(k,!0)&&(k.freePrizeButton.pressedSprite=L)}),t.default.loadAtlasSpriteFrames("static_res/gamestore_en","video_ad_button_disable",function(D,L){cc.isValid(k,!0)&&(k.freePrizeButton.disabledSprite=L)})},A.prototype.onLoad=function(){var k=this;y.default.getInstance().isEnglish()&&this.enResLoad(),this.node.on(cc.Node.EventType.TOUCH_END,function(){},this),h.default.isWeiXin()||p.MGAdv.load(a.ADScene.SCENE_VIDEO_PRIZE_PROPERTY,a.QQ_ADV_TYPE.VIDEO_TYPE_GAME_OVER);var D=new r.default(this.node).getChild("dlg"),L=D.getChild("closebutton").getNode();L&&(this.closeButtonTouchCallback=new e.default(function(){k.onClickCloseButton()}),L.on(cc.Node.EventType.TOUCH_END,this.closeButtonTouchCallback.click,this.closeButtonTouchCallback)),this.buyButtonTouchCallback=new e.default(function(){if(k.mProgress==0){var H="\u9053\u5177\u6570\u91CF\u9700\u5927\u4E8E0";return y.default.getInstance().isEnglish()&&(H="More props required"),void k.showToast(H)}k.onClickBuyButton(k.priortyProperty,k.mProgress)}),this.mBuyBtn.node.on(cc.Node.EventType.TOUCH_END,this.buyButtonTouchCallback.click,this.buyButtonTouchCallback),this.freeButtonTouchCallback=new e.default(function(){if(k.mProgress==0){var H="\u9053\u5177\u6570\u91CF\u9700\u5927\u4E8E0";return y.default.getInstance().isEnglish()&&(H="More props required"),void k.showToast(H)}k.onClickFreeButton(k.priortyProperty,1)}),this.freePrizeButton.node.on(cc.Node.EventType.TOUCH_END,this.freeButtonTouchCallback.click,this.freeButtonTouchCallback),this.enableFreePrizeButton(!0,!1);var b=D.getChild("light");if(b.getNode()){var N=cc.rotateBy(5,360);b.getNode().runAction(N.repeatForever())}this.mSlider.node.on("slide",function(H){var R=H.detail;k.mProgress=Math.floor(10*R.progress),k.mPropertyCountLabel.string=k.mProgress.toString(),k.mProgressFront.node.width=k.mProgressBack.node.width*k.mProgress/10;var F=s.G.Ap.propertyPack.getConfig().getParam(k.priortyProperty);k.mBuyBtnLabel.string=""+k.mProgress*F.price},this),this.mAddBtnTouchCallback=new e.default(function(){if(!(10<=k.mProgress)){k.mSlider.progress=k.mProgress/10+.1,k.mProgress++,k.mProgressFront.node.width=k.mProgressBack.node.width*k.mProgress/10,k.mPropertyCountLabel.string=k.mProgress.toString();var H=s.G.Ap.propertyPack.getConfig().getParam(k.priortyProperty);k.mBuyBtnLabel.string=""+k.mProgress*H.price}}),this.mAddBtn.node.on(cc.Node.EventType.TOUCH_END,this.mAddBtnTouchCallback.click,this.mAddBtnTouchCallback),this.mJianBtnTouchCallback=new e.default(function(){if(!(k.mProgress<=0)){k.mSlider.progress=k.mProgress/10-.1,k.mProgress--,k.mProgressFront.node.width=k.mProgressBack.node.width*k.mProgress/10,k.mPropertyCountLabel.string=k.mProgress.toString();var H=s.G.Ap.propertyPack.getConfig().getParam(k.priortyProperty);k.mBuyBtnLabel.string=""+k.mProgress*H.price}}),this.mJianBtn.node.on(cc.Node.EventType.TOUCH_END,this.mJianBtnTouchCallback.click,this.mJianBtnTouchCallback)},A.prototype.start=function(){},A.prototype.update=function(k){this.coolingCheckTime.timeout()&&this.updateFreePrizeButton()},A.prototype.enableFreePrizeButton=function(k,D){D===void 0&&(D=!1),this.freePrizeButton.enabled=k,this.freePrizeButton.interactable=k,this.freeTimeLabel.node.active=D},A.prototype.updateFreePrizeButton=function(){if(this.freePrizeButton&&this.freePrizeButton.isValid){var k,D,L=this.isAdCooling();switch(L.type){case 0:this.freePrizeButton.enabled||this.enableFreePrizeButton(!0,!1);break;case 1:this.freePrizeButton.enabled&&this.enableFreePrizeButton(!1,!1);break;case 2:this.freePrizeButton.enabled&&this.enableFreePrizeButton(!1,!0),this.coolingCountdownTime=this.AD_INTERVAL_COOLING_TIME-(Date.now()-L.ts);var b=(k=this.coolingCountdownTime,(D=new Date(k)).getMinutes()+":"+D.getSeconds());this.coolingCountdownTime<=0&&(this.coolingCountdownTime=0),this.freeTimeLabel.string=b}}},A.prototype.isAdCooling=function(){var k=u.default.read(c.default.AD_VIDEO_PROPERTY_SHOW_INFO,null);if(!k)return{type:0,ts:0};var D=JSON.parse(k),L=new Date(D.ts),b=D.count,N=function(H){return H.getFullYear()+"-"+(H.getMonth()+1)+"-"+H.getDate()};return N(new Date)==N(L)&&b>=this.AD_DAILY_SHOW_TIME?{type:1,ts:D.ts}:Date.now()-D.ts<this.AD_INTERVAL_COOLING_TIME?{type:2,ts:D.ts}:{type:0,ts:0}},A.prototype.updateAdShowInfo=function(){var k,D=u.default.read(c.default.AD_VIDEO_PROPERTY_SHOW_INFO,null);D?k={count:JSON.parse(D).count+1,ts:Date.now()}:k={count:1,ts:Date.now()},u.default.save(c.default.AD_VIDEO_PROPERTY_SHOW_INFO,JSON.stringify(k))},A.prototype.log=function(k){M.DEBUG&&(h.default.isQQ()?BK.Script.log(1,0,k):console.log(k))},A.prototype.showPrizeVideoAd=function(k,D){var L=this;this.log("[qzs] showPrizeVideoAd() called");var b=a.ADScene.SCENE_VIDEO_PRIZE_PROPERTY;p.MGAdv.show(b,a.QQ_ADV_TYPE.VIDEO_TYPE_GAME_OVER,function(N){switch(N){case a.ADStat.NOT_NETWORK:L.showToast("No network available");break;case a.ADStat.SHOW_SUCCESS_CLOSE:L.onPrizeAdShowedSuccessful(k,D);break;case a.ADStat.SHOW_NOT_ENED_CLOSE:break;case a.ADStat.LOAD_FAILED:case a.ADStat.NOT_SUPPORT:case a.ADStat.SHOW_GET_AD_FAILED:L.showToast("No video ads available"),h.default.isWeiXin()||p.MGAdv.load(a.ADScene.SCENE_VIDEO_PRIZE_PROPERTY,a.QQ_ADV_TYPE.VIDEO_TYPE_GAME_OVER)}})},A.prototype.onPrizeAdShowedSuccessful=function(k,D){var L=this,b=s.G.Ap.propertyPack.getConfig().getParam(k),N="\u606D\u559C\u83B7\u5F97"+b.name+"x"+D;y.default.getInstance().isEnglish()&&(N="Congratulations "+b.name+" x "+D),this.showToast(N),this.updateAdShowInfo(),s.G.Ap.propertyPack.getPlayProperty().addProperty(k,D),s.G.Ap.propertyPack.save(),this.callback&&this.callback.onBuyProperty(k,D),setTimeout(function(){L.onClickCloseButton()},1e3)},A.prototype.setCallBack=function(k){this.callback=k},A.prototype.setPriortyProperty=function(k){this.priortyProperty=k.clone()},A.prototype.show=function(){this.refreshUI(),this.reportOpen(),S.default.getInstance().pushDialog(this.node,"PropertyStorePrefab")},A.prototype.refreshUI=function(){var k=this;if(this.priortyProperty){var D=s.G.Ap.propertyPack.getConfig().getParam(this.priortyProperty);if(D){D.costType===d.COSTTYPE.DIAMON?(this.mBuyBtnDiamondIcon.node.active=!0,this.mBuyBtnGoldIcon.node.active=!1):(this.mBuyBtnDiamondIcon.node.active=!1,this.mBuyBtnGoldIcon.node.active=!0),this.mBuyBtnLabel.string=""+this.mProgress*D.price;var L=this.parseDesc(D.describe);this.mDescLabel.string=L,t.default.loadAtlasSpriteFrames(i.GameItemsManager.getPropPlistPath(),D.pic,function(b,N){cc.isValid(k,!0)&&(k.mPropertyIcon.spriteFrame=N)})}}},A.prototype.onClickCloseButton=function(){this.node.active=!1,new r.default(this.node.getChildByName("costpop")).setVisible(!1),this.callback&&this.callback.onPropertyStoreClose(this.priortyProperty),S.default.getInstance().popDialog(this.node,"PropertyStorePrefab")},A.prototype.onClickBuyButton=function(k,D){var L=s.G.Ap.propertyPack.getConfig().getParam(k);if(L){if(L.costType===d.COSTTYPE.DIAMON){var b=L.price*D;if(!o.MoneySystem.consumeDiamond(Math.max(b,1))){var N=y.default.getInstance().getLanguageByKey("label_text.prop_tip2");return this.showToast(N),void this.showBuyDiamondDialog()}}else{var H=L.price*D;if(!o.MoneySystem.consumeGold(Math.max(H,1)))return N=y.default.getInstance().getLanguageByKey("label_text.prop_tip1"),this.showToast(N),void this.showBuyGoldDialog()}s.G.Ap.propertyPack.getPlayProperty().addProperty(k,D),s.G.Ap.propertyPack.save(),this.callback&&this.callback.onBuyProperty(k,D),this.reportBuy(),this.onClickCloseButton()}},A.prototype.showBuyGoldDialog=function(){var k=this;f.default.load("prefab/PlayerInfoPopupProfab",function(D,L){var b=L.getComponent(g.default);b.setCloseSelfCallback(function(){k.node.removeChild(L)}),b.playerGoldBtnClick(_.default.SOURCE_FIGHT_BUY_PROPERTY),k.node.addChild(L),console.log("goldBtnClick")})},A.prototype.showBuyDiamondDialog=function(){var k=this;f.default.load("prefab/PlayerInfoPopupProfab",function(D,L){var b=L.getComponent("PlayerInfoPopupProfab");b.setCloseSelfCallback(function(){k.node.removeChild(L)}),b.playerDiamondBtnClick(_.default.SOURCE_FIGHT_BUY_PROPERTY),k.node.addChild(L)})},A.prototype.onClickFreeButton=function(k,D){this.freePrizeButton.enabled?this.showPrizeVideoAd(k,D):this.log("[qzs] free Prize Button Not enable")},A.prototype.showToast=function(k){this.log("[qzs] show Toast: "+k);var D=new r.default(this.node.getChildByName("costpop"));if(D.setChildText("caption",k),D.setOpacity(255),D.setVisible(!0),D.getNode()){D.getNode().stopAllActions();var L=cc.delayTime(1),b=cc.fadeTo(.2,0);D.getNode().runAction(cc.sequence(L,b))}},A.prototype.reportOpen=function(){var k=new n.default(171);k.add("action",1),k.add("item_id",this.priortyProperty?this.priortyProperty.type:0),k.report()},A.prototype.reportBuy=function(){var k=new n.default(171);k.add("action",2),k.add("item_id",this.priortyProperty?this.priortyProperty.type:0),k.report()},A.prototype.parseDesc=function(k){var D="";if(~k.indexOf(";"))for(var L=k.split(";"),b=0,N=0,H=L;N<H.length;N++){var R=H[N];D=D.concat(R),++b!==L.length&&(D=D.concat("\n"))}else D=k;return D},A.DEBUG=!1,__decorate([C(cc.Button)],A.prototype,"freePrizeButton",void 0),__decorate([C(cc.Label)],A.prototype,"freeTimeLabel",void 0),__decorate([C(cc.Button)],A.prototype,"mBuyBtn",void 0),__decorate([C(cc.Sprite)],A.prototype,"mBuyBtnGoldIcon",void 0),__decorate([C(cc.Sprite)],A.prototype,"mBuyBtnDiamondIcon",void 0),__decorate([C(cc.Label)],A.prototype,"mBuyBtnLabel",void 0),__decorate([C(cc.Label)],A.prototype,"mDescLabel",void 0),__decorate([C(cc.Sprite)],A.prototype,"mPropertyIcon",void 0),__decorate([C(cc.Button)],A.prototype,"mAddBtn",void 0),__decorate([C(cc.Button)],A.prototype,"mJianBtn",void 0),__decorate([C(cc.Label)],A.prototype,"mPropertyCountLabel",void 0),__decorate([C(cc.Sprite)],A.prototype,"mProgressFront",void 0),__decorate([C(cc.Sprite)],A.prototype,"mProgressBack",void 0),__decorate([C(cc.Slider)],A.prototype,"mSlider",void 0),__decorate([C(cc.Sprite)],A.prototype,"mTitleSprite",void 0),A=M=__decorate([v],A)}(cc.Component);m.default=T,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../base/G":"G","../../config/LSKey":"LSKey","../../infoc/easyReport":"EasyReport","../../infoc/m_p2_pop_coin":"m_p2_pop_coin","../../property/PropertyDefines":"PropertyDefines","../../util/PU":"PU","../../util/nodeFacade":"NodeFacade","../Logic/GameItemsManager":"GameItemsManager","../Logic/I18nManager":"I18nManager","../Logic/MoneySystem":"MoneySystem","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/playerInfoPopup/PlayerInfoPopupProfab":"PlayerInfoPopupProfab","../keypad/KeypadNavigator":"KeypadNavigator"}],PullDataStatus:[function(l,P,m){"use strict";cc._RF.push(P,"6bbd13+As9IgJsTa/1ZkuDn","PullDataStatus"),Object.defineProperty(m,"__esModule",{value:!0}),(m.PullDataStatus||(m.PullDataStatus={})).isPullDataSuccess=!1,cc._RF.pop()},{}],QQBKAudioManager:[function(l,P,m){"use strict";cc._RF.push(P,"5bae9z1QwRP358Qc9oSFxZN","QQBKAudioManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/Log"),s=function(){function r(){}return r.getBKIns=function(o,e,n){if(d.default.isDebug()&&d.default.e("QQBKAudioManager => play,["+o+"]   "+e),o==0){var t=new BK.Audio(0,e,n);return t.audioType=0,t}var i=null;return BK.Misc.qqVerLessthan(GameStatusInfo.QQVer,"7.8.0")==0?(this.audioContext||(this.audioContext=BK.createAudioContext({type:"effect"})),i=new(function(a){function u(c,p,h){var f=a.call(this,c,p,h)||this;return f.effectObject=r.audioContext,f}return __extends(u,a),u.prototype.stopMusic=function(){this.audioObject&&!this.audioObject.destroyed&&this.audioObject.destroy()},u}(BK.Audio))(o,e,n)):i=new BK.Audio(1,e,n),i.audioType=1,i.musicPath=e,i.loopCount=n,i},r}();m.default=s,cc._RF.pop()},{"../../base/Log":"Log"}],QQGameConvertCode:[function(l,P,m){"use strict";cc._RF.push(P,"13586NmmERGr54wpWCfm5Z/","QQGameConvertCode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/Log"),s=function(){function r(){}return r.isConverCodeScene=function(o){d.default.i(this.TAG+" isConverCodeScene launchOption = ",o),(this.isQRCode(o)||this.isConverCode(o))&&(r.needShowCodePage=!0)},r.isQRCode=function(o){return o&&o.query&&o.query.source&&o.query.source==r.LAUNCH_DATA},r.isConverCode=function(o){return o&&o.referrerInfo&&o.referrerInfo.extraData&&o.referrerInfo.extraData.data&&o.referrerInfo.extraData.data==r.LAUNCH_DATA},r.getConvertCode=function(o){var e=this;wx.getClipboardData({success:function(n){d.default.i(e.TAG+"getConvertCode.wx.getClipboardData success result = ",n),o(n.data)},fail:function(n){d.default.e(e.TAG+"getConvertCode.wx.getClipboardData fail err = ",n),o(null)},complete:function(){d.default.i(e.TAG+"getConvertCode.wx.getClipboardData complete ")}})},r.TAG="[QQGameConvertCode]====> ",r.LAUNCH_DATA="gqk",r.needShowCodePage=!1,r}();m.QQGameConvertCode=s,cc._RF.pop()},{"../base/Log":"Log"}],QQHelper:[function(l,P,m){"use strict";cc._RF.push(P,"fb786tht8NBs69+ngPFcxFC","QQHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./NetworkUtils"),s=l("./MGLog"),r=function(){function o(){}return o.networkRequest=function(e){s.default.l("QQHelper networkRequest:"+e.url,e);var n=new BK.HttpUtil(e.url);if(e.method&&0<e.method.length?n.setHttpMethod(e.method):n.setHttpMethod(d.default.METHOD_POST),e.header)for(var t in e.header)n.setHttpHeader(t,e.header[t]);if(e.data){var i=new BK.Buffer(0,!1);i.writeAsString(JSON.stringify(e.data),!1),n.setHttpRawBody(i)}n.requestAsync(function(a,u){var c=a?a.readAsString(!0):"";if(s.default.l("QQHelper networkRequest, complete, code:"+u+" rsp:"+c),u==200&&c){if(e.success){var p=c;if(e.dataType=="json")try{p=JSON.parse(c)}catch(h){}e.success(u,p,null)}}else e.fail&&e.fail(u,c)})},o.fetchOpenKey=function(e){BK.QQ.fetchOpenKey(function(n,t,i){console.info("fetch open key="+(i?i.openKey:"")),n==0&&i&&i.openKey?e.success&&e.success(i.openKey):e.fail&&e.fail()})},o.getNick=function(e){BK.MQQ.Account.getNick(GameStatusInfo.openId,function(n,t){e&&e(t)})},o.getHeadEx=function(e){BK.MQQ.Account.getHeadEx(GameStatusInfo.openId,function(n,t){e&&e(t)})},o.getCachePath=function(){BK.FileUtil.isFileExist(o.CACHE_DIR)!=1&&BK.FileUtil.makeDir(o.CACHE_DIR);var e=o.CACHE_DIR+GameStatusInfo.openId+"//";return BK.FileUtil.isFileExist(e)!=1&&BK.FileUtil.makeDir(e),e},o.setStorage=function(e,n){var t=o.getCachePath()+e;BK.FileUtil.writeFile(t,n)},o.getStorage=function(e){var n=o.getCachePath()+e;return BK.FileUtil.isFileExist(n)!=1?"":BK.FileUtil.readFile(n).readAsString()},o.delStorage=function(e){var n=o.getCachePath()+e;BK.FileUtil.isFileExist(n)==1&&BK.FileUtil.deleteFile(n)},o.skipGame=function(e,n){BK.QQ.skipGame(e,n)},o.CACHE_DIR="GameSandBox://cache//",o}();m.QQHelper=r,cc._RF.pop()},{"./MGLog":"MGLog","./NetworkUtils":"NetworkUtils"}],QQMusicContext:[function(l,P,m){"use strict";cc._RF.push(P,"6247e50MxtNtK909051ZpPC","QQMusicContext"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./QQBKAudioManager"),s=function(){function r(o,e){this.index=0,this.handle=null,this.volume=1,this.ended=!0,this.timestamp=0,this.path="",this.index=o,this.path=e,this.handle=d.default.getBKIns(1,e,0)}return r.prototype.getIndex=function(){return this.index},r.prototype.getPath=function(){return this.path},r.prototype.play=function(){this.ended=!1,this.handle&&this.handle.startMusic(this._onEnd),this.timestamp=Date.now()},r.prototype.playA=function(o,e){this.ended=!1,this.handle=d.default.getBKIns(1,o,0),this.handle.startMusic(this._onEnd),this.volume=e,this.timestamp=Date.now()},r.prototype.playB=function(o,e){this.ended=!1,this.handle!=null&&this.handle.pauseMusic(),this.handle=d.default.getBKIns(1,o,0),this.handle.startMusic(this._onEnd),this.volume=e,this.timestamp=Date.now()},r.prototype.stop=function(){this.handle!=null&&this.handle.stopMusic()},r.prototype.pause=function(){this.handle!=null&&this.handle.pauseMusic()},r.prototype.seek=function(o){},r.prototype.getTimeStamp=function(){return this.timestamp},r.prototype.isEnded=function(){return this.ended},r.prototype._onEnd=function(){this.ended=!0,this.timestamp=0},r}();m.default=s,cc._RF.pop()},{"./QQBKAudioManager":"QQBKAudioManager"}],QQRedPacketModule:[function(l,P,m){"use strict";cc._RF.push(P,"4b423+oHFBNwJg3c84zp1RI","QQRedPacketModule"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../MUI/MUINode"),s=l("../MUI/MUISprite"),r=l("../../util/PU"),o=l("../../base/G"),e=l("../MUI/MUILabel"),n=l("../../util/SUtil"),t=function(){function i(){}return i.prototype.load=function(){this.mScoreReached=!1,this.mFinished=!1,this.createTargetSprite(),this.createFinishSprite()},i.prototype.destroy=function(){},i.prototype.prepare=function(){var a=this;this.createToastNode(function(){a.mUINode&&a.mToast&&(a.mUINode.addChild(a.mToast),a.setToastShowTime())})},i.prototype.start=function(){this.mUINode&&this.mTargetSprite&&this.mUINode.addChild(this.mTargetSprite)},i.prototype.pause=function(){this.mUINode&&this.mUINode.setVisible(!1)},i.prototype.resume=function(){this.mUINode&&this.mUINode.setVisible(!0)},i.prototype.update=function(){var a=o.G.Ap.state.attainScore;return i.TARGET_SCORE<=a&&!this.mScoreReached&&(this.mScoreReached=!0,this.mTargetSprite&&(this.mTargetSprite.removeFromParent(),this.mTargetSprite=null),this.mFinishSprite&&this.mUINode.addChild(this.mFinishSprite)),!this.mFinished},i.prototype.setFinishShowTime=function(){var a=this;setTimeout(function(){a.mFinishSprite&&(a.mFinishSprite.removeFromParent(),a.mFinishSprite=null),a.mFinished=!0},i.FINISH_LENGTH)},i.prototype.createTargetSprite=function(){var a=this,u=new s.default,c=r.default.getResourcePath("resources/gameImage/qq_red_packet_target.png");u.loadLocalImage(c,!1,function(){var p=(a.mTargetSprite=u).imageData.image.width,h=u.imageData.image.height;a.updateSpriteRect(u,p,h)})},i.prototype.createFinishSprite=function(){var a=this,u=new s.default,c=r.default.getResourcePath("resources/gameImage/qq_red_packet_finish.png");u.loadLocalImage(c,!1,function(){var p=(a.mFinishSprite=u).imageData.image.width,h=u.imageData.image.height;a.updateSpriteRect(u,p,h)})},i.prototype.updateSpriteRect=function(a,u,c){n.SUtil.ins().isLiuHai()?a.move(16,o.G.Ap.config.presentHeight-c-78,u,c):a.move(16,o.G.Ap.config.presentHeight-c-17,u,c)},i.prototype.getUINode=function(){return this.mUINode||(this.mUINode=new d.default,this.mUINode.move(0,0,o.G.Ap.config.presentWidth,o.G.Ap.config.presentHeight)),this.mUINode},i.prototype.createToastNode=function(a){var u=this,c=new s.default,p=r.default.getResourcePath("resources/static_res/toast.png");c.loadLocalImage(p,!1,function(){var h=(u.mToast=c).imageData.image.width,f=c.imageData.image.height;u.updateToastRect(c,h,f),a&&a()})},i.prototype.updateToastRect=function(a,u,c){this.addToastText(a,500,c),a.move((o.G.Ap.config.presentWidth-500)/2,(o.G.Ap.config.presentHeight-c)/2,500,c)},i.prototype.addToastText=function(a,u,c){var p=new e.default;p.size=28,p.color="white",p.text="\u6B22\u8FCE\u53C2\u52A0\u73B0\u91D1\u7EA2\u5305\u8D5B",p.setPosition(u/2,c/2+12);var h=new e.default;h.size=p.size,h.color=p.color,h.text=cc.js.formatStr("\u8FBE\u5230%s\u5206\uFF0C\u5373\u53EF\u74DC\u5206\u4E07\u5143\u7EA2\u5305",i.TARGET_SCORE),h.setPosition(u/2,c/2-32),a.addChild(p),a.addChild(h)},i.prototype.setToastShowTime=function(){var a=this;setTimeout(function(){a.mToast&&a.mToast.setVisible(!1)},i.TOAST_LENGTH)},i.prototype.showNode=function(){this.mUINode&&this.mUINode.setVisible(!0)},i.prototype.hideNode=function(){this.mUINode&&this.mUINode.setVisible(!1)},i.TARGET_SCORE=750,i.TOAST_LENGTH=3e3,i.FINISH_LENGTH=2e3,i}();m.default=t,cc._RF.pop()},{"../../base/G":"G","../../util/PU":"PU","../../util/SUtil":"SUtil","../MUI/MUILabel":"MUILabel","../MUI/MUINode":"MUINode","../MUI/MUISprite":"MUISprite"}],QQRedPacketRelive:[function(l,P,m){"use strict";cc._RF.push(P,"fd882M+5UFHm5SlK6wj1tIg","QQRedPacketRelive"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/G"),s=l("../../gamescene/module/QQRedPacketModule"),r=cc._decorator,o=r.ccclass,e=r.property,n=function(t){function i(){var a=t!==null&&t.apply(this,arguments)||this;return a.relive_score_label=null,a.relive_stage_label=null,a}return __extends(i,t),i.prototype.attatchToRootLayout=function(a){a.addChild(this.node)},i.prototype.onLoad=function(){this.updateReliveLayout()},i.prototype.updateReliveLayout=function(){var a=d.G.Ap.state.attainScore,u=s.default.TARGET_SCORE-a;this.relive_score_label.string="\u8FD8\u5DEE <color=#FF5252><size=90>"+u+"</s></c> \u5206\u5373\u53EF\u74DC\u5206",this.relive_stage_label.string="\u4E07\u5143\u73B0\u91D1\u7EA2\u5305"},__decorate([e(cc.RichText)],i.prototype,"relive_score_label",void 0),__decorate([e(cc.RichText)],i.prototype,"relive_stage_label",void 0),i=__decorate([o],i)}(cc.Component);m.default=n,cc._RF.pop()},{"../../base/G":"G","../../gamescene/module/QQRedPacketModule":"QQRedPacketModule"}],QQReport:[function(l,P,m){"use strict";cc._RF.push(P,"505bfC35OlGHYJoSgjGi7pk","QQReport"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PU"),s=l("../base/Log"),r=l("../business/Network/Protocol/StorageUtil"),o=l("./StringUtil"),e=l("./TimeUtil"),n=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),t=l("../config/LSKey"),i=l("./PU"),a=function(){function u(){}return u.reportFightWin=function(){i.default.isQQ()&&(console.info("[QQReport]=>reportFightWin"),BK.QQ.reportGameResult({infoList:[{type:13,op:1,num:1}]},function(c,p,h){console.info(c!==0?"[QQReport]=>reportFightWin reportGameResult fail errCode = ":"[QQReport]=>reportFightWin reportGameResult success errCode = ",c,",cmd = ",p,",data = ",h)}))},u.reportGradeUpdate=function(){i.default.isQQ()&&(console.info("[QQReport]=>reportGradeUpdate"),BK.QQ.reportGameResult({infoList:[{type:22,op:1,num:1}]},function(c,p,h){console.info(c!==0?"[QQReport]=>reportGradeUpdate reportGameResult fail errCode = ":"[QQReport]=>reportGradeUpdate reportGameResult success errCode = ",c,",cmd = ",p,",data = ",h)}))},u.reportSongScore=function(c){if(s.default.i("[QQReport]=>reportSongScore score = "+c),d.default.isQQ()&&0<c){var p={infoList:[{type:8,op:2,num:c}]};BK.QQ.reportGameResult(p,function(h,f,g){h!==0?s.default.i("[QQReport]=>reportSongScore reportGameResult fail errCode = ",h,",cmd = ",f,",data = ",g):s.default.i("[QQReport]=>reportSongScore reportGameResult success errCode = ",h,",cmd = ",f,",data = ",g)})}},u.reportUnLockSong=function(c){if(s.default.i("[QQReport]=>reportUnLockSong unLock = "+c),d.default.isQQ()){var p={infoList:[{type:15,op:2,num:this.getTodayUnlockNum(c)}]};BK.QQ.reportGameResult(p,function(h,f,g){h!==0?s.default.i("[QQReport]=>reportUnLockSong reportGameResult fail errCode = ",h,",cmd = ",f,",data = ",g):s.default.i("[QQReport]=>reportUnLockSong reportGameResult success errCode = ",h,",cmd = ",f,",data = ",g)})}},u.getTodayUnlockNum=function(c){var p=r.default.read(t.default.QQ_REPORT_UNLOCK_SONG_NUM);if(o.StringUtil.isEmpty(p))return r.default.save(t.default.QQ_REPORT_UNLOCK_SONG_NUM,e.default.formatDate(n.MGUser.getCurrentServerTime())+":"+c),s.default.i("[QQReport]=>getTodayUnlockNum1 unLock = "+c),c;var h=p.split(":");if(h[0]==e.default.formatDate(n.MGUser.getCurrentServerTime())){var f=parseInt(h[1]);return r.default.save(t.default.QQ_REPORT_UNLOCK_SONG_NUM,e.default.formatDate(n.MGUser.getCurrentServerTime())+":"+(c+f)),s.default.i("[QQReport]=>getTodayUnlockNum2 unLock = "+(c+f)),f+c}return r.default.save(t.default.QQ_REPORT_UNLOCK_SONG_NUM,e.default.formatDate(n.MGUser.getCurrentServerTime())+":"+c),s.default.i("[QQReport]=>getTodayUnlockNum3 unLock = "+c),c},u.GRADE_UPDATE_START_TIME=20180921,u.GRADE_UPDATE_END_TIME=20181031,u}();m.QQReport=a,cc._RF.pop()},{"../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../base/Log":"Log","../business/Network/Protocol/StorageUtil":"StorageUtil","../config/LSKey":"LSKey","./PU":"PU","./StringUtil":"StringUtil","./TimeUtil":"TimeUtil"}],RankAdapter:[function(l,P,m){"use strict";cc._RF.push(P,"44223xUfadCqbclXcUWU9jR","RankAdapter"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../business/Logic/PlayerMgr"),s=l("../base/Log"),r=l("../util/PU"),o=l("../business/UI/MusicLevelDataLoader"),e=function(){function n(){}return n.getKeyIndex=function(t){return!t||Number.isNaN(t)?-1:Math.floor((t-1)/n.SONG_SCORES_SINGLE_KEY_SONGS_NUMBER)},n.getReviveData=function(t,i,a,u,c){r.default.isCM()&&this.getReviveCMData(t,i,a,u,c)},n.getReviveCMData=function(t,i,a,u,c){var p=d.default.Ins().getLevelRecordByMid(o.MusicLevelDataLoader.getItemInfoByMid(t).musicId),h=p.mBestScore;s.default.i("getReviveCMData musicId = "+t+",score="+i+",levelRecord = ",p);var f,g=5,_=0;(f=!(500<(_=h-i+1)||_<=0))&&(g=4),f||a==null||a==0||u==null||u==0||(g=500<(_=u)?5:1),c&&c(g,_,3<a?a-3:0,a<=3?a:0,1,"","")},n.SONG_SCORES_SINGLE_KEY_SONGS_NUMBER=40,n}();m.default=e,cc._RF.pop()},{"../base/Log":"Log","../business/Logic/PlayerMgr":"PlayerMgr","../business/UI/MusicLevelDataLoader":"MusicLevelDataLoader","../util/PU":"PU"}],RankRevivePageContainer:[function(l,P,m){"use strict";cc._RF.push(P,"c9bb20vqtFAOKca5XF0ozu0","RankRevivePageContainer"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Log"),s=l("../../../util/PU"),r=l("./RankRevivePageQQ"),o=l("../GameEntraScene/PrefabMgr"),e=cc._decorator,n=e.ccclass,t=(e.property,function(i){function a(){var u=i!==null&&i.apply(this,arguments)||this;return u.mReviveController=null,u}return __extends(a,i),a.prototype.initData=function(u,c){this.mReviveController=u,this.mReliveScoreDataCallback=c,d.default.l("[RankRevivePageContainer] initData mReviveController: "+this.mReviveController+" mReliveScoreDataCallback: "+this.mReliveScoreDataCallback)},a.prototype.onLoad=function(){var u=this;d.default.l("[RankRevivePageContainer] onLoad"),s.default.isCM()?o.default.load("prefab/rank/RankRevivePageQQ",function(c,p){p.getComponent(r.default).initData(u.mReviveController,u.mReliveScoreDataCallback),p&&u.node.addChild(p)}):s.default.isQQ()&&o.default.load("prefab/rank/RankRevivePageQQ",function(c,p){p.getComponent(r.default).initData(u.mReviveController,u.mReliveScoreDataCallback),p&&u.node.addChild(p)})},a.prototype.start=function(){},a=__decorate([n],a)}(cc.Component));m.default=t,cc._RF.pop()},{"../../../base/Log":"Log","../../../util/PU":"PU","../GameEntraScene/PrefabMgr":"PrefabMgr","./RankRevivePageQQ":"RankRevivePageQQ"}],RankRevivePageQQ:[function(l,P,m){"use strict";cc._RF.push(P,"2b55fPqBLJGqLWGlOIXPI7j","RankRevivePageQQ"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../LogicPlatform/SpriteCacheLoader"),s=l("../../gameover/ReviveController"),r=l("../../../base/G"),o=l("../../Logic/LevelMgr"),e=l("../MusicLevelDataLoader"),n=l("../../../base/Log"),t=l("../../Logic/I18nManager"),i=l("../../RankAdapter"),a=cc._decorator,u=a.ccclass,c=a.property,p=function(h){function f(){var g=h!==null&&h.apply(this,arguments)||this;return g.needScore=null,g.crown_layout=null,g.star_layout=null,g.title_layout=null,g.revive_immediate_layout=null,g.beyond_friend_layout=null,g.rank123OrNewRecord=null,g.avatarSprite=null,g.nickName=null,g.rightLabel=null,g.rankNum123Str=["\u7B2C\u4E00\u540D","\u7B2C\u4E8C\u540D","\u7B2C\u4E09\u540D"],g.newRecordStr="\u65B0\u7EAA\u5F55",g.endStringArray=["\u5373\u53EF\u83B7\u5F97","\u5373\u53EF\u8D62\u5F97","\u5C31\u80FD\u8D85\u8D8A","\u5373\u53EF\u521B\u4E0B"],g.mReviveController=null,g}return __extends(f,h),f.prototype.initData=function(g,_){this.mReviveController=g,this.mReliveScoreDataCallback=_,n.default.l("[RankRevivePageQQ] initData mReviveController: "+this.mReviveController+" mReliveScoreDataCallback: "+this.mReliveScoreDataCallback)},f.prototype.onLoad=function(){var g=this;t.default.getInstance().isEnglish()&&(this.rankNum123Str=["champion","runner-up","second-runner-up"],this.newRecordStr="New Best",this.endStringArray=["more for","to win","to beat","to creat"]),n.default.l("[RankRevivePageQQ] onLoad");var _=r.G.Ap.state.attainScore,y=r.G.Ap.state.mission.levelId,S=o.LevelMgr.Ins().getLevel(y).music.mid,I=e.MusicLevelDataLoader.getItemInfoByMid(S),v=(I&&I.level,this.mReviveController.getBestScore(),this.mReliveScoreDataCallback());n.default.l("[RankRevivePageQQ] reliveScoreData type = "+v.crownType+",score = "+v.score),i.default.getReviveData(S,_,v.crownType,v.score,function(C,T,E,A,M,k,D){n.default.l("[RankRevivePageQQ] getReviveData reviveType: "+C+" diffScore: "+T+" crownNum: "+E+" startNum: "+A+" nickName: "+D+" avatarUrl: "+k),g.initReviveData(C,T,E,A,M,k,D)})},f.prototype.start=function(){},f.prototype.initReviveData=function(g,_,y,S,I,v,C){switch(this.title_layout.node.active=g<s.default.TYPE_IMMEDIATE_REVIVE,this.crown_layout.node.active=g==s.default.TYPE_CROWN_OR_STAR,this.star_layout.node.active=g==s.default.TYPE_CROWN_OR_STAR,this.rank123OrNewRecord.node.active=g==s.default.TYPE_RANK||g==s.default.TYPE_NEWRECORD,this.beyond_friend_layout.node.active=g==s.default.TYPE_BEYOND_FRD,this.revive_immediate_layout.node.active=g==s.default.TYPE_IMMEDIATE_REVIVE,this.needScore.string=_.toString(),g-1<this.endStringArray.length&&(this.rightLabel.string=this.endStringArray[g-1]),g){case s.default.TYPE_CROWN_OR_STAR:this.initCrownOrStarLayout(y,S);break;case s.default.TYPE_RANK:this.rank123OrNewRecord.string=this.rankNum123Str[I-1];break;case s.default.TYPE_BEYOND_FRD:this.nickName.string=C,d.default.load(v,this.avatarSprite);break;case s.default.TYPE_NEWRECORD:this.rank123OrNewRecord.string=this.newRecordStr;break;case s.default.TYPE_IMMEDIATE_REVIVE:}},f.prototype.initCrownOrStarLayout=function(g,_){if(g&&0<g)for(var y=function(T){var E=new cc.Node("crownSprite");E.width=82,E.height=75,E.addComponent(cc.Sprite);var A=E.getComponent(cc.Sprite);cc.loader.loadRes("/gameImage/home_crown_get",cc.SpriteFrame,function(M,k){k&&(A.spriteFrame=k)}),S.crown_layout.node.addChild(E)},S=this,I=0;I<g;I++)y();else if(_&&0<_){var v=function(T){var E=new cc.Node("starSprite");E.width=88,E.height=108,E.addComponent(cc.Sprite);var A=E.getComponent(cc.Sprite);cc.loader.loadRes("/gameImage/home_star_get",cc.SpriteFrame,function(M,k){k&&(A.spriteFrame=k)}),C.star_layout.node.addChild(E)},C=this;for(I=0;I<_;I++)v()}},__decorate([c(cc.Label)],f.prototype,"needScore",void 0),__decorate([c(cc.Layout)],f.prototype,"crown_layout",void 0),__decorate([c(cc.Layout)],f.prototype,"star_layout",void 0),__decorate([c(cc.Layout)],f.prototype,"title_layout",void 0),__decorate([c(cc.Layout)],f.prototype,"revive_immediate_layout",void 0),__decorate([c(cc.Layout)],f.prototype,"beyond_friend_layout",void 0),__decorate([c(cc.Label)],f.prototype,"rank123OrNewRecord",void 0),__decorate([c(cc.Sprite)],f.prototype,"avatarSprite",void 0),__decorate([c(cc.Label)],f.prototype,"nickName",void 0),__decorate([c(cc.Label)],f.prototype,"rightLabel",void 0),f=__decorate([u],f)}(cc.Component);m.default=p,cc._RF.pop()},{"../../../LogicPlatform/SpriteCacheLoader":"SpriteCacheLoader","../../../base/G":"G","../../../base/Log":"Log","../../Logic/I18nManager":"I18nManager","../../Logic/LevelMgr":"LevelMgr","../../RankAdapter":"RankAdapter","../../gameover/ReviveController":"ReviveController","../MusicLevelDataLoader":"MusicLevelDataLoader"}],RankSetData:[function(l,P,m){"use strict";cc._RF.push(P,"388a2bQyN5MC6XM4oo1b81h","RankSetData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.RankSetData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.getRankName=function(){return this.getString("rankName")},e.prototype.getNextNeedStar=function(){return this.getInt("nextNeedStar")},e.prototype.getLoseStar=function(){return this.getInt("loseStar")},e.prototype.getDailyReward=function(){return this.getString("dailyReward")},e.prototype.getSeasonReward=function(){return this.getString("seasonReward")},e.prototype.getFinishRank=function(){return this.getInt("finishRank")},e.prototype.getRoundWinReward=function(){return this.getString("win")},e.prototype.getRoundDogfallReward=function(){return this.getString("draw")},e}(d.default);m.RankSetDataRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],RcmdGameDataAdapter:[function(l,P,m){"use strict";cc._RF.push(P,"d2dbaq0HhFI85im8AS88l2Z","RcmdGameDataAdapter"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../MGBSdkInit"),s=l("../../../Logic/MoneySystem"),r=l("./RcmdGameData"),o=function(){function e(){this.mRcmdDest=null,d.default.initMGBSdk(null)}return e.prototype.getRcmdGameData=function(n,t){this.fetchData(n,!0,t)},e.prototype.fetchData=function(n,t,i){var a=this;new MGB.MGBRcmd4ScoreWall(n,{onReady:function(u){a.mRcmdDest=u,i&&i(a.getAllGameInfo())},onFailed:function(){t&&(MGB.MGBRcmd4ScoreWall.fillCache(a.prepareScoreWallData()),a.fetchData(n,!1,i))}})},e.prototype.getAllGameInfo=function(){if(!this.mRcmdDest)return null;var n=this.mRcmdDest.getSize();if(n<=0)return null;for(var t=new Array,i=0;i<n;++i){var a=this.mRcmdDest.getGameInfo(i);if(a){var u=new r.default(a);t.push(u)}}return t},e.prototype.jumpTo=function(n,t){if(n&&this.mRcmdDest){var i=this.mRcmdDest.getSize();if(!(i<=0))for(var a=0;a<i;++a){var u=this.mRcmdDest.getGameInfo(a);if(u){var c=u.getGameId();if(c&&c==n.getGameId()){if(t)for(var p in u.mapRewards)this.addReward(p,u.mapRewards[p]),n.recordTrialInfo();this.mRcmdDest.jump(a)}}}}},e.prototype.addReward=function(n,t){switch(n){case"gold":s.MoneySystem.increaseGold(t);break;case"diamond":s.MoneySystem.increaseDiamond(t)}},e.prototype.prepareScoreWallData=function(){return'{            "games": [                {                    "name": "zkxxx",                    "gameid_wx": "wx3ab3658aab34d7db",                    "gameid_qq": "3511",                    "icon": "https://piano-weixin-game.cmcm.com/pianotiles2/cfg/game_rcmd/1001/brickes.png",                    "big_img": "",                    "title": "\u7816\u5757\u6D88\u6D88\u6D88",                    "describe": "\u8D85\u9B54\u6027\u5F39\u7403\u6253\u7816\u5757\u6E38\u620F",                    "describe2": "\u5956\u52B15\u94BB\u77F3",                    "rewards": {                        "diamond":5                    }                },                {                    "name": "twdx",                    "gameid_wx": "wxf976a9e8c25dedf2",                    "gameid_qq": "3091",                    "icon": "https://piano-weixin-game.cmcm.com/pianotiles2/cfg/game_rcmd/1001/dancinglineA.png",                    "big_img": "https://piano-weixin-game.cmcm.com/pianotiles2/cfg/game_rcmd/1001/twdx_big_img.png",                    "title": "\u8DF3\u821E\u7684\u7EBF",                    "describe": "\u9B54\u6027\u53C8\u8650\u624B\u7684\u97F3\u4E50\u6E38\u620F",                    "describe2": "\u5956\u52B15\u94BB\u77F3",                    "rewards": {                        "diamond":5                    }                }            ],            "posconfig": [                {                    "posid": 1001131,                    "start_pos": 0                }            ]        }'},e}();m.default=o,cc._RF.pop()},{"../../../Logic/MoneySystem":"MoneySystem","../../MGBSdkInit":"MGBSdkInit","./RcmdGameData":"RcmdGameData"}],RcmdGameData:[function(l,P,m){"use strict";cc._RF.push(P,"ae322h8fsVGc52l1sr1N508","RcmdGameData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../Network/Protocol/StorageUtil"),s=l("../../../../util/TimeUtil"),r=function(){function o(e){this.mRawData=null,this.mKeyBase="trial_key_",this.mRawData=e}return o.prototype.getGameId=function(){return this.mRawData?this.mRawData.getGameId():null},o.prototype.getRewardText=function(){if(!this.mRawData||!this.mRawData.mapRewards)return null;var e=null,n=null;for(var t in this.mRawData.mapRewards){e=t,n=this.mRawData.mapRewards[t];break}return e=="gold"?"\u606D\u559C\u83B7\u5F97\u91D1\u5E01*"+n:e=="diamond"?"\u606D\u559C\u83B7\u5F97\u94BB\u77F3*"+n:null},o.prototype.getKey=function(){var e=this.getGameId();return e?this.mKeyBase+e:null},o.prototype.isToadyFristTrial=function(){var e=this.getKey();if(!e)return!0;var n=parseInt(d.default.read(e));return s.default.formatDate(n)!=s.default.getTodayFormatDate()},o.prototype.recordTrialInfo=function(){var e=this.getKey();if(e){var n=new Date().getTime();d.default.save(e,n+"")}},o}();m.default=r,cc._RF.pop()},{"../../../../util/TimeUtil":"TimeUtil","../../../Network/Protocol/StorageUtil":"StorageUtil"}],Recod:[function(l,P,m){"use strict";cc._RF.push(P,"816e97a1EVPFJaK+rEuz33/","Recod"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){};m.default=d,cc._RF.pop()},{}],ReliveFreeDialogTipDialog:[function(l,P,m){"use strict";cc._RF.push(P,"25747oHLAdBEJXe4/WbnX8u","ReliveFreeDialogTipDialog"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../UI/GameEntraScene/BasicTouchEvent"),o=l("../Logic/I18nManager"),e=l("../keypad/KeypadNavigator"),n=cc._decorator,t=n.ccclass,i=n.property;(s=d=m.DIALOG_TYPE||(m.DIALOG_TYPE={}))[s.RELIVE=0]="RELIVE",s[s.CONTRA=1]="CONTRA";var a=function(u){function c(){return u!==null&&u.apply(this,arguments)||this}return __extends(c,u),c.prototype.onLoad=function(){var p=this;this.mBtnClickCallback=new r.default(function(){p.mBtnCallback&&p.mBtnCallback(),e.default.getInstance().popDialog(p.node,"FirstFailTipDialog")}),this.mBtn.node.on(cc.Node.EventType.TOUCH_END,this.mBtnClickCallback.click,this.mBtnClickCallback),this.node.on(cc.Node.EventType.TOUCH_START,function(h){h.stopPropagation()},this),e.default.getInstance().pushDialog(this.node,"FirstFailTipDialog")},c.prototype.start=function(){this.mContentPanel.getComponent(cc.Animation).play("avator_pop_out")},c.prototype.setType=function(p){(this.type=p)==d.RELIVE?(this.mContraContentLabel.node.active=!1,this.mReliveContentLabel.node.active=!0,this.mTopPeopleIcon.node.active=!1,o.default.getInstance().isEnglish()?this.mBtnLabel.string="Revive":this.mBtnLabel.string="\u590D\u6D3B"):p==d.CONTRA&&(this.mContraContentLabel.node.active=!0,this.mReliveContentLabel.node.active=!1,this.mTopPeopleIcon.node.active=!0,o.default.getInstance().isEnglish()?this.mBtnLabel.string="Ok":this.mBtnLabel.string="\u6211\u77E5\u9053\u4E86")},c.prototype.setBtnClickCallback=function(p){this.mBtnCallback=p},__decorate([i(cc.Node)],c.prototype,"mContentPanel",void 0),__decorate([i(cc.Sprite)],c.prototype,"mTopPeopleIcon",void 0),__decorate([i(cc.Label)],c.prototype,"mReliveContentLabel",void 0),__decorate([i(cc.Label)],c.prototype,"mContraContentLabel",void 0),__decorate([i(cc.Button)],c.prototype,"mBtn",void 0),__decorate([i(cc.Label)],c.prototype,"mBtnLabel",void 0),c=__decorate([t],c)}(cc.Component);m.default=a,cc._RF.pop()},{"../Logic/I18nManager":"I18nManager","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../keypad/KeypadNavigator":"KeypadNavigator"}],ReliveInterface:[function(l,P,m){"use strict";cc._RF.push(P,"7e499vgFGlGhofp8biiYpsK","ReliveInterface"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],ReliveNoShare:[function(l,P,m){"use strict";cc._RF.push(P,"b59baKn2YFLOoSOI6rxPuh4","ReliveNoShare"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/G"),s=l("./ReviveController"),r=l("../UI/GameEntraScene/BasicTouchEvent"),o=l("../reward/RewardManager"),e=l("../../base/Log"),n=l("../Logic/MoneySystem"),t=l("../../infoc/m_p2_PData_Dia"),i=l("./QQRedPacketRelive"),a=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),u=l("../../../modules/MGAppShare/scripts/MGShareUtil"),c=l("../../util/PU"),p=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),h=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),f=l("../UI/GameEntraScene/ToastPrefab"),g=cc.isValid,_=l("../../upgrade/BannerDelayShowToggle"),y=l("../../upgrade/ToggleBean"),S=l("../../util/SUtil"),I=cc._decorator,v=I.ccclass,C=I.property,T=function(E){function A(){var M=E!==null&&E.apply(this,arguments)||this;return M.mLayout=null,M.noShareLayout=null,M.bgNode=null,M.relive_share_count_label=null,M.share_dianmod_num_icon=null,M.challengeRelivePrefab=null,M.qqRedPacketRelivePrefab=null,M.relive_content_layout=null,M.toast_layout=null,M.toastPrefab=null,M.wait_fd_label=null,M.fd_tips_layout=null,M.skip_layout=null,M.share_relive_btn=null,M.continueLabel=null,M.mShareTime=-1,M.firstShareTime=0,M.mCloseBtnClickCallback=null,M.mDiamondReliveBtnClickCallback=null,M.mCanGainDiamondNumIcon=["/gameImage/dianmond_triangle_icon6","/gameImage/dianmond_triangle_icon12","/gameImage/dianmond_triangle_icon18","/gameImage/dianmond_triangle_icon24","/gameImage/dianmond_triangle_icon30"],M.mReviveController=null,M.mShareLooper=null,M}return __extends(A,E),A.prototype.setReviveController=function(M){this.mReviveController=M},A.prototype.setReliveMode=function(M){switch(M){case s.ReliveMode.NORMAL:this.updateNormalMode();break;case s.ReliveMode.QQ_RED_PACK:this.updateQQRedPacketMode()}},A.prototype.updateNormalMode=function(){this.mQQRelive=null},A.prototype.updateQQRedPacketMode=function(){var M=cc.instantiate(this.qqRedPacketRelivePrefab);M&&(this.mQQRelive=M.getComponent(i.default),this.mQQRelive.attatchToRootLayout(this.relive_content_layout))},A.prototype.setReliveCallback=function(M){this.mReliveCallBack=M},A.prototype.setCancelGameCallback=function(M){this.mCancelGameCallBack=M},A.prototype.setReliveScoreDataCallback=function(M){this.mReliveScoreDataCallback=M},A.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(M){M.stopPropagation()}),this.initEvent(),this.mReviveController.saveTodayRecordInfo(),this.setInviteBtnLabelQQ(),this.showBannerAd()},A.prototype.showBannerAd=function(){var M=this;if(g(this,!0)&&!c.default.isWeb()){var k=void 0,D=void 0,L=void 0;if(c.default.isQQ())L=D=k=0;else if(c.default.isWeiXin()){var b=wx.getSystemInfoSync();k=b.screenWidth,D=b.screenHeight/2+(20-S.SUtil.ins().getChlidViewPositionInScreen(this.skip_layout.node,this.node).y-this.getPopupUpByShowbanner())*b.screenHeight/S.SUtil.ins().mScreenHeight,L=0}p.MGAdv.loadBanner(k,L,D,function(N,H){if(g(M,!0)){if(N==h.ADStat.LOAD_SUCCESS){var R=_.default.getBannerDelayTime(y.ToggleKey.BANNER_DELAY_RELIVE_PAGE);M.scheduleOnce(function(){cc.isValid(M,!0)&&p.MGAdv.showBanner(h.ADScene.RELIVE_POPUP,function(F,x,U){M.adapterUIShowBanner()})},R.normalDelayTime/1e3)}}else p.MGAdv.hideBanner(h.ADScene.RELIVE_POPUP),p.MGAdv.destroyBanner(h.ADScene.RELIVE_POPUP)},h.ADScene.RELIVE_POPUP)}},A.prototype.destoryBannerAd=function(){p.MGAdv.hideBanner(h.ADScene.RELIVE_POPUP),p.MGAdv.destroyBanner(h.ADScene.RELIVE_POPUP)},A.prototype.setInviteBtnLabelQQ=function(){c.default.isQQ()?(this.mInviteBtnLabel.string="\u5206\u4EAB\u5230\u7FA4\uFF0C\u7ACB\u5373\u590D\u6D3B",this.relive_share_count_label.node.active=!1):this.mInviteBtnLabel.string=this.mReviveController.getReliveBtnText()},A.prototype.initEvent=function(){var M=this;this.mCloseBtnClickCallback=new r.default(function(){M.closeBtnClick()}),this.skip_layout.node.on(cc.Node.EventType.TOUCH_END,this.mCloseBtnClickCallback.click,this.mCloseBtnClickCallback),this.mDiamondReliveBtnClickCallback=new r.default(function(){M.shareReliveClick()}),this.share_relive_btn.node.on(cc.Node.EventType.TOUCH_END,this.mDiamondReliveBtnClickCallback.click,this.mDiamondReliveBtnClickCallback),this.continueLabel.node.on(cc.Node.EventType.TOUCH_END,this.mDiamondReliveBtnClickCallback.click,this.mDiamondReliveBtnClickCallback)},A.prototype.start=function(){this.mLayout.getComponent(cc.Animation).play("relive_no_share_pop_up"),this.initView()},A.prototype.shareLooperCallback=function(M){if(M){for(var k=[],D=0,L=0;L<M.length;L++){var b=M[L];b.isConsume||(D+=b.diamondNum,k.push(b))}0<D&&(this.consumeInviteList(k,D),this.onFdInviteSuccess(D))}},A.prototype.consumeInviteList=function(M,k){if(M&&0<M.length){for(var D=0;D<M.length;D++){var L=M[D];L&&o.RewardMgr.Ins().cosumeInviteRewardInfo(L)}n.MoneySystem.increaseDiamond(k),t.default.report(k,t.default.SOURCE_INVITER_GET_REWARD,t.default.ACTION_GET_DIAMOND)}},A.prototype.update=function(M){},A.prototype.onDestroy=function(){this.destoryBannerAd(),this.mShareLooper&&this.mShareLooper.release(),this.pauseSchedule()},A.prototype.initView=function(){this.wait_fd_label.node.active=!1;var M=o.RewardMgr.Ins().getCanAlsoInviteNumToday();this.relive_share_count_label.string=cc.js.formatStr(this.mReviveController.getReliveTipsText(),M),this.fd_tips_layout.node.active=!1,this.share_dianmod_num_icon.node.active=!1},A.prototype.onFdInviteSuccess=function(M){e.default.e("[ShareInvite]1 onFdInviteSuccess diaCount= "+M),e.default.e("[ShareInvite]2 onFdInviteSuccess diaCount= "+M),this.pauseSchedule(),this.reliveByShare(M)},A.prototype.reliveByShare=function(M){var k=this;this.hideReliveLayout();var D=this.mReviveController.getReviveDiamondCost();this.showToastTips(cc.js.formatStr("\u597D\u53CB\u5DF2\u70B9\u5165\uFF0C\u5956\u52B1%s\u94BB\u77F3\n\r\u672C\u6B21\u590D\u6D3B\u6D88\u8017%s\u94BB\u77F3",M,D),function(){k.reliveGame(),k.mReviveController.reviveByDiamond(D)})},A.prototype.hideReliveLayout=function(){this.noShareLayout.active=!1,this.skip_layout.node.active=!1,this.bgNode.active=!1},A.prototype.showToastTips=function(M,k){var D=cc.instantiate(this.toastPrefab);D.getComponent(f.default).showTips(M,function(){D.destroy(),k&&k()}),this.toast_layout.node.addChild(D)},A.prototype.initCallback=function(){var M=this;this.callback=function(){var k=M.wait_fd_label.string;M.wait_fd_label.string=k=="\u5DF2\u53D1\u9001\uFF0C\u597D\u53CB\u70B9\u5165\u5373\u53EF\u52A9\u529B..."?"\u5DF2\u53D1\u9001\uFF0C\u597D\u53CB\u70B9\u5165\u5373\u53EF\u52A9\u529B.":k+"."}},A.prototype.pauseSchedule=function(){this.callback&&this.unschedule(this.callback)},A.prototype.startSchedule=function(){this.callback||this.initCallback(),this.schedule(this.callback,1)},A.prototype.closeBtnClick=function(){this.pauseSchedule(),this.toGameOverScene(),console.log("closeBtnClick")},A.prototype.shareReliveClick=function(){var M=this;this.mShareTime==-1&&(this.mShareTime=new Date().getTime()),a.MGUser.getUserLoginInfo({complete:function(k){console.log("[ReliveNoShare] shareForReliveFdHelp getPlayerInfo (playerInfo == null) = "+(k==null)),k&&(u.MGShareUtils.shareForReliveFdHelp(k.playerId,function(D){}),M.wait_fd_label.node.active=!0,M.startSchedule())}})},A.prototype.toGameOverScene=function(){console.log("toGameOverScene"),this.mCancelGameCallBack&&this.mCancelGameCallBack(),d.G.Ap.state.gameOver(),d.G.Ap.presenter.enterScene(d.G.GAME_OVER_SCENE_NAME,d.G.Ap.state.mission.musicId)},A.prototype.reliveGame=function(){this.mReliveCallBack&&(this.destoryBannerAd(),this.mReliveCallBack())},A.prototype.getPopupUpByShowbanner=function(){return 100},A.prototype.adapterUIShowBanner=function(){c.default.isWeiXin()&&(this.noShareLayout.y=this.noShareLayout.y+this.getPopupUpByShowbanner(),this.skip_layout.node.y=this.skip_layout.node.y+this.getPopupUpByShowbanner())},__decorate([C(cc.Node)],A.prototype,"mLayout",void 0),__decorate([C(cc.Node)],A.prototype,"noShareLayout",void 0),__decorate([C(cc.Node)],A.prototype,"bgNode",void 0),__decorate([C(cc.Label)],A.prototype,"mInviteBtnLabel",void 0),__decorate([C(cc.Label)],A.prototype,"relive_share_count_label",void 0),__decorate([C(cc.Sprite)],A.prototype,"share_dianmod_num_icon",void 0),__decorate([C(cc.Prefab)],A.prototype,"challengeRelivePrefab",void 0),__decorate([C(cc.Prefab)],A.prototype,"qqRedPacketRelivePrefab",void 0),__decorate([C(cc.Node)],A.prototype,"relive_content_layout",void 0),__decorate([C(cc.Layout)],A.prototype,"toast_layout",void 0),__decorate([C(cc.Prefab)],A.prototype,"toastPrefab",void 0),__decorate([C(cc.Label)],A.prototype,"wait_fd_label",void 0),__decorate([C(cc.Layout)],A.prototype,"fd_tips_layout",void 0),__decorate([C(cc.Layout)],A.prototype,"skip_layout",void 0),__decorate([C(cc.Button)],A.prototype,"share_relive_btn",void 0),__decorate([C(cc.Label)],A.prototype,"continueLabel",void 0),A=__decorate([v],A)}(cc.Component);m.default=T,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/G":"G","../../base/Log":"Log","../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../upgrade/BannerDelayShowToggle":"BannerDelayShowToggle","../../upgrade/ToggleBean":"ToggleBean","../../util/PU":"PU","../../util/SUtil":"SUtil","../Logic/MoneySystem":"MoneySystem","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../reward/RewardManager":"RewardManager","./QQRedPacketRelive":"QQRedPacketRelive","./ReviveController":"ReviveController"}],ReliveScoreData:[function(l,P,m){"use strict";cc._RF.push(P,"c1d40agNMxCSZeNAvv4yzgf","ReliveScoreData"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=function(){this.crownType=d.CrownType_NONE};m.default=r,(s=d=m.CrownType||(m.CrownType={}))[s.CrownType_NONE=0]="CrownType_NONE",s[s.CrownType_ONE_STAR=1]="CrownType_ONE_STAR",s[s.CrownType_TWO_STAR=2]="CrownType_TWO_STAR",s[s.CrownType_THREE_STAR=3]="CrownType_THREE_STAR",s[s.CrownType_ONE_CROWN=4]="CrownType_ONE_CROWN",s[s.CrownType_TWO_CROWN=5]="CrownType_TWO_CROWN",s[s.CrownType_THREE_CROWN=6]="CrownType_THREE_CROWN",cc._RF.pop()},{}],ReliveTotal:[function(l,P,m){"use strict";cc._RF.push(P,"a7aceJslH5C0KAHPD1stTvM","ReliveTotal"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/G"),s=l("./ReviveController"),r=l("../UI/GameEntraScene/BasicTouchEvent"),o=l("../reward/RewardManager"),e=l("../UI/GameEntraScene/ToastPrefab"),n=l("../Logic/MoneySystem"),t=l("../../infoc/m_p2_PData_Dia"),i=l("./QQRedPacketRelive"),a=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),u=l("../../../modules/MGAppShare/scripts/MGShareUtil"),c=l("../UI/rank/RankRevivePageContainer"),p=l("../../base/Log"),h=l("../../util/PU"),f=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),g=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),_=l("../Network/Protocol/StorageUtil"),y=l("../../config/LSKey"),S=l("../../util/StringUtil"),I=l("../../util/SUtil"),v=l("../UI/GameEntraScene/PrefabMgr"),C=l("../../property/PropertyDefines"),T=l("../UI/GameEntraScene/ImgCache"),E=l("../../upgrade/BannerDelayShowToggle"),A=l("../../upgrade/ToggleBean"),M=l("../Logic/I18nManager"),k=l("../keypad/KeypadNavigator"),D=cc._decorator,L=D.ccclass,b=D.property,N=function(H){function R(){var F=H!==null&&H.apply(this,arguments)||this;return F.mLayout=null,F.bgNode=null,F.relive_layout=null,F.relive_content_layout=null,F.challengeRelivePrefab=null,F.qqRedPacketRelivePrefab=null,F.relive_diamond_count_label=null,F.relive_share_count_label=null,F.mHelpReliveBtnLabel=null,F.share_dianmod_num_icon=null,F.toast_layout=null,F.toastPrefab=null,F.wait_fd_label=null,F.fd_tips_layout=null,F.skip_layout=null,F.relive_diamond_btn=null,F.relive_share_btn=null,F.relive_video_btn=null,F.relive_video_props_btn=null,F.relive_video_props_tip=null,F.mCanGainDiamondNumIcon=["/gameImage/dianmond_triangle_icon6","/gameImage/dianmond_triangle_icon12","/gameImage/dianmond_triangle_icon18","/gameImage/dianmond_triangle_icon24","/gameImage/dianmond_triangle_icon30"],F.mCloseBtnClickCallback=null,F.mDiamondReliveBtnClickCallback=null,F.mShareReliveBtnClickCallback=null,F.mVideoReliveBtnClickCallback=null,F.mVideoPropsReliveBtnClickCallback=null,F.mReviveController=null,F.mReliveType=s.default.RESULT_REVIVE_SHARE_AND_DIAMOND,F.mReliveWithPropType=C.PROPERTYTYPE.GAME_DASH,F.firstShareTime=0,F.destoryBanner=!1,F.showByFdInvite=!1,F.mShareTime=-1,F.mFirstFDIntoTime=-1,F.mShareLooper=null,F}return __extends(R,H),R.prototype.setReliveWithPropType=function(F){this.mReliveWithPropType=F},R.prototype.setReliveType=function(F){this.mReliveType=F},R.prototype.setReliveMode=function(F){switch(F){case s.ReliveMode.NORMAL:this.updateNormalMode();break;case s.ReliveMode.QQ_RED_PACK:this.updateQQRedPacketMode()}},R.prototype.updateNormalMode=function(){this.mQQRelive=void 0},R.prototype.updateQQRedPacketMode=function(){var F=cc.instantiate(this.qqRedPacketRelivePrefab);F&&(this.mQQRelive=F.getComponent(i.default),this.mQQRelive.attatchToRootLayout(this.relive_content_layout))},R.prototype.setReviveController=function(F){this.mReviveController=F},R.prototype.setReliveCallback=function(F){this.mReliveCallBack=F},R.prototype.setCancelGameCallback=function(F){this.mCancelGameCallBack=F},R.prototype.setReliveScoreDataCallback=function(F){this.mReliveScoreDataCallback=F},R.prototype.setShowByFdInvite=function(F,x){this.showByFdInvite=F,this.showByFdInviteDiaCount=x},R.prototype.onLoad=function(){console.error("[ShareInvite] shareTotal  onLoad  "),this.node.on(cc.Node.EventType.TOUCH_START,function(F){F.stopPropagation()}),this.mQQRelive||(p.default.l("[ReliveTotal] onLoad"),this.relive_content_layout.addComponent(c.default).initData(this.mReviveController,this.mReliveScoreDataCallback)),this.initWidgt(),this.initEvent(),this.mReviveController.saveTodayRecordInfo(this.mReliveType),this.setHelpReliveBtnLabelForQQ(),this.reportVideoBtn(),k.default.getInstance().pushDialog(this.node),f.MGAdv.gameplayStop(),f.MGAdv.displayAD(!0)},R.prototype.showBannerAd=function(){var F=this;this.scheduleOnce(function(){if(f.MGAdv.isBannerCached(g.ADScene.RELIVE_POPUP))if(F.destoryBanner)F.destoryBannerAd();else{var x=E.default.getBannerDelayTime(A.ToggleKey.BANNER_DELAY_RELIVE_PAGE);F.scheduleOnce(function(){cc.isValid(F,!0)&&f.MGAdv.showBanner(g.ADScene.RELIVE_POPUP,function(){F.adapterUIShowBanner()})},x.normalDelayTime/1e3)}else if(!h.default.isWeb()){var U=void 0,B=void 0,Q=void 0;if(h.default.isQQ())Q=B=U=0;else if(h.default.isWeiXin()){var Z=wx.getSystemInfoSync();U=Z.screenWidth,B=0,Q=Z.screenHeight/2+(20-I.SUtil.ins().getChlidViewPositionInScreen(F.skip_layout.node,F.node).y-F.getPopupUpByShowbanner())*Z.screenHeight/I.SUtil.ins().mScreenHeight}f.MGAdv.loadBanner(U,B,Q,function(z,W){if(z==g.ADStat.LOAD_SUCCESS)if(F.destoryBanner)F.destoryBannerAd();else{var V=E.default.getBannerDelayTime(A.ToggleKey.BANNER_DELAY_RELIVE_PAGE);F.scheduleOnce(function(){cc.isValid(F,!0)&&f.MGAdv.showBanner(g.ADScene.RELIVE_POPUP,function(Y,q,J){F.adapterUIShowBanner()})},V.normalDelayTime/1e3)}},g.ADScene.RELIVE_POPUP)}},.2)},R.prototype.destoryBannerAd=function(){this.destoryBanner=!0,f.MGAdv.hideBanner(g.ADScene.RELIVE_POPUP),f.MGAdv.destroyBanner(g.ADScene.RELIVE_POPUP),f.MGAdv.displayAD(!1)},R.prototype.setHelpReliveBtnLabelForQQ=function(){h.default.isQQ()?(this.mHelpReliveBtnLabel.string="\u5206\u4EAB\u5230\u7FA4\uFF0C\u7ACB\u5373\u590D\u6D3B",this.relive_share_count_label.node.active=!1):this.mHelpReliveBtnLabel.string=this.mReviveController.getReliveBtnText()},R.prototype.initWidgt=function(){var F=this.relive_diamond_btn.getComponent(cc.Widget);F.isAlignBottom=!0;var x=this.relive_share_btn.getComponent(cc.Widget);x.isAlignBottom=!0;var U=this.relive_video_btn.getComponent(cc.Widget);U.isAlignBottom=!0;var B=this.relive_video_props_btn.getComponent(cc.Widget);B.isAlignBottom=!0;var Q=this.relive_video_props_tip.getComponent(cc.Widget);switch(Q.isAlignBottom=!0,this.mReliveType){case s.default.RESULT_REVIVE_ONLY_SHARE:break;case s.default.RESULT_REVIVE_SHARE_AND_DIAMOND:this.relive_diamond_btn.node.active=!0,this.relive_share_btn.node.active=!0,this.relive_video_btn.node.active=!1,this.relive_video_props_btn.node.active=!1,this.relive_video_props_tip.node.active=!1,x.bottom=176,F.bottom=56;break;case s.default.RESULI_RELIVE_CM:case s.default.RESULT_REVIVE_VIDEO_AND_DIAMOND:this.relive_diamond_btn.node.active=!0,this.relive_share_btn.node.active=!1,this.relive_video_btn.node.active=!0,this.relive_video_props_btn.node.active=!1,this.relive_video_props_tip.node.active=!1,U.bottom=176,F.bottom=56;break;case s.default.RESULT_REVIVE_VIDEO_AND_PROPS_AND_DIAMOND:this.relive_diamond_btn.node.active=!0,this.relive_share_btn.node.active=!1,this.relive_video_btn.node.active=!1,this.relive_video_props_btn.node.active=!0,this.relive_video_props_tip.node.active=!0,Q.bottom=250,B.bottom=176,F.bottom=56;var Z=this.relive_video_props_btn.node.getChildByName("relive_props_label").getComponent(cc.Label);this.mReliveWithPropType==C.PROPERTYTYPE.GAME_DASH?M.default.getInstance().isEnglish()?(Z.string="Auto tap props",T.default.get2("static_res/gameover/relive_by_video_with_dash_en",this.relive_video_props_tip)):(Z.string="\u9001\u51B2\u523A\u9053\u5177",T.default.get2("static_res/gameover/relive_by_video_with_dash",this.relive_video_props_tip)):this.mReliveWithPropType==C.PROPERTYTYPE.GAME_SHIELD?M.default.getInstance().isEnglish()?(Z.string="Shield props",T.default.get2("static_res/gameover/relive_by_video_with_sheild_en",this.relive_video_props_tip)):(Z.string="\u9001\u62A4\u76FE\u9053\u5177",T.default.get2("static_res/gameover/relive_by_video_with_sheild",this.relive_video_props_tip)):Z.string="";break;case s.default.RESULT_REVIVE_SHARE_AND_VIDEO:this.relive_diamond_btn.node.active=!1,this.relive_share_btn.node.active=!0,this.relive_video_btn.node.active=!0,this.relive_video_props_btn.node.active=!1,this.relive_video_props_tip.node.active=!1,x.bottom=176,U.bottom=56}},R.prototype.getVideoScene=function(){var F=this.mReviveController.getReliveMode(),x=g.ADScene.RELIVE_POPUP;return this.mReliveType==s.default.RESULT_REVIVE_VIDEO_AND_PROPS_AND_DIAMOND&&(F==s.ReliveMode.NORMAL?this.mReliveWithPropType==C.PROPERTYTYPE.GAME_DASH?x=g.ADScene.SOURCE_RELIVE_WITH_DASH_NORMAL:this.mReliveWithPropType==C.PROPERTYTYPE.GAME_SHIELD&&(x=g.ADScene.SOURCE_RELIVE_WITH_SHEILD_NORMAL):F==s.ReliveMode.CHALLENGE&&(this.mReliveWithPropType==C.PROPERTYTYPE.GAME_DASH?x=g.ADScene.SOURCE_RELIVE_WITH_DASH_CHALLENG:this.mReliveWithPropType==C.PROPERTYTYPE.GAME_SHIELD&&(x=g.ADScene.SOURCE_RELIVE_WITH_SHEILD_CHALLENG))),x},R.prototype.reportVideoBtn=function(){var F=this.mReviveController.getReliveMode(),x=this.getVideoScene();p.default.i("YSY_DEBUG","action; mode = "+F,"action; type = "+this.mReliveType,"action; scene = "+x)},R.prototype.initEvent=function(){var F=this;this.mCloseBtnClickCallback=new r.default(function(){F.closeBtnClick()}),this.skip_layout.node.on(cc.Node.EventType.TOUCH_END,this.mCloseBtnClickCallback.click,this.mCloseBtnClickCallback),this.mDiamondReliveBtnClickCallback=new r.default(function(){F.diamondReliveClick()}),this.relive_diamond_btn.node.on(cc.Node.EventType.TOUCH_END,this.mDiamondReliveBtnClickCallback.click,this.mDiamondReliveBtnClickCallback),this.mShareReliveBtnClickCallback=new r.default(function(){F.shareReliveClick()}),this.relive_share_btn.node.on(cc.Node.EventType.TOUCH_END,this.mShareReliveBtnClickCallback.click,this.mShareReliveBtnClickCallback),this.mVideoReliveBtnClickCallback=new r.default(function(){F.videoReliveClick()}),this.relive_video_btn.node.on(cc.Node.EventType.TOUCH_END,this.mVideoReliveBtnClickCallback.click,this.mVideoReliveBtnClickCallback),this.mVideoPropsReliveBtnClickCallback=new r.default(function(){F.videoReliveClick(!0)}),this.relive_video_props_btn.node.on(cc.Node.EventType.TOUCH_END,this.mVideoPropsReliveBtnClickCallback.click,this.mVideoPropsReliveBtnClickCallback)},R.prototype.start=function(){var F=this;if(console.error("[ShareInvite] shareTotal  start  "),this.showByFdInvite)this.relive_layout.node.x=0,this.relive_layout.node.y=0,this.skip_layout.node.x=0,this.skip_layout.node.y=-415,this.showToastAward(this.showByFdInviteDiaCount);else{var x=this.mLayout.getComponent(cc.Animation);x.once("finished",function(){F.showBannerAd()}),I.SUtil.ins().isPuTong()?x.play("relive_total_popup_with_ad"):x.play("relive_total_popup")}this.initView()},R.prototype.shareLooperCallback=function(F){if(F){for(var x=[],U=0,B=0;B<F.length;B++){var Q=F[B];Q.isConsume||(U+=Q.diamondNum,x.push(Q))}0<U&&(this.consumeInviteList(x,U),this.mFirstFDIntoTime==-1&&(this.mFirstFDIntoTime=(new Date().getTime()-this.mShareTime)/1e3),this.onFdInviteSuccess(U))}},R.prototype.consumeInviteList=function(F,x){if(F&&0<F.length){for(var U=0;U<F.length;U++){var B=F[U];B&&o.RewardMgr.Ins().cosumeInviteRewardInfo(B)}n.MoneySystem.increaseDiamond(x),t.default.report(x,t.default.SOURCE_INVITER_GET_REWARD,t.default.ACTION_GET_DIAMOND)}},R.prototype.update=function(F){},R.prototype.onFdInviteSuccess=function(F){p.default.e("[ShareInvite]1 onFdInviteSuccess diaCount= "+F),p.default.e("[ShareInvite]2 onFdInviteSuccess diaCount= "+F),this.pauseSchedule(),this.reliveByShare(F)},R.prototype.reliveByShare=function(F){var x=this;this.hideReliveLayout();var U=this.mReviveController.getReviveDiamondCost();this.showToastTips(cc.js.formatStr("\u597D\u53CB\u5DF2\u70B9\u5165\uFF0C\u5956\u52B1%s\u94BB\u77F3\n\r\u672C\u6B21\u590D\u6D3B\u6D88\u8017%s\u94BB\u77F3",F,U),function(){x.reliveGame(),x.mReviveController.reviveByDiamond(U)})},R.prototype.hideReliveLayout=function(){this.relive_layout.node.active=!1,this.skip_layout.node.active=!1,this.bgNode.active=!1},R.prototype.onDestroy=function(){h.default.isWeiXin()||f.MGAdv.load(this.getVideoScene(),g.QQ_ADV_TYPE.VIDEO_TYPE_GAME_RELIVE),this.destoryBannerAd(),this.mShareLooper!=null&&this.mShareLooper.release(),this.pauseSchedule(),k.default.getInstance().popDialog(this.node)},R.prototype.initView=function(){this.updateReliveDiaCount(),this.updateShareCount()},R.prototype.updateReliveDiaCount=function(){this.relive_diamond_count_label.string="x "+this.mReviveController.getReviveDiamondCost()},R.prototype.updateShareCount=function(){this.wait_fd_label.node.active=!1,this.pauseSchedule();var F=o.RewardMgr.Ins().getCanAlsoInviteNumToday();this.relive_share_count_label.string=cc.js.formatStr(this.mReviveController.getReliveTipsText(),F),this.fd_tips_layout.node.active=!1,this.share_dianmod_num_icon.node.active=!1},R.prototype.closeBtnClick=function(){this.destoryBannerAd(),this.pauseSchedule(),this.toGameOverScene(),console.log("closeBtnClick")},R.prototype.initCallback=function(){var F=this;this.callback=function(){var x=F.wait_fd_label.string;F.wait_fd_label.string=x=="\u5DF2\u53D1\u9001\uFF0C\u597D\u53CB\u70B9\u5165\u5373\u53EF\u52A9\u529B..."?"\u5DF2\u53D1\u9001\uFF0C\u597D\u53CB\u70B9\u5165\u5373\u53EF\u52A9\u529B.":x+"."}},R.prototype.pauseSchedule=function(){this.callback&&this.unschedule(this.callback)},R.prototype.startSchedule=function(){this.callback||this.initCallback(),this.schedule(this.callback,1)},R.prototype.shareReliveClick=function(){var F=this;console.log("shareReliveClick"),h.default.isWeiXin()?0<o.RewardMgr.Ins().getCanAlsoInviteNumToday()?(this.mShareTime==-1&&(this.mShareTime=new Date().getTime()),a.MGUser.getUserLoginInfo({complete:function(x){console.log("[ReliveTotal] shareForReliveFdHelp getPlayerInfo (playerInfo == null) = "+(x==null)),x&&(u.MGShareUtils.shareForReliveFdHelp(x.playerId,function(U){}),F.wait_fd_label.node.active=!0,F.startSchedule())}})):this.showToastTips("\u4ECA\u5929\u9080\u8BF7\u673A\u4F1A\u5DF2\u7528\u5B8C,\u660E\u5929\u518D\u6765\u5427"):h.default.isQQ()&&a.MGUser.getUserLoginInfo({complete:function(x){console.log("[ReliveTotal] shareForReliveFdHelp getPlayerInfo (playerInfo == null) = "+(x==null)),x&&u.MGShareUtils.shareForReliveFdHelp(x.playerId,function(U,B){if(U&&B){F.showToastTips("\u590D\u6D3B\u6210\u529F\uFF01\n\u795D\u4F60\u62FF\u7B2C\u4E00\uFF01"),F.relive_layout.node.active=!1,F.skip_layout.node.active=!1,setTimeout(function(){F.pauseSchedule(),F.reliveGame(),F.mReviveController.reviveByShare()},2e3);var Q=_.default.read(y.default.QQ_SHARE_RELIVE_SUCC_TIMES);if(S.StringUtil.isEmpty(Q))_.default.save(y.default.QQ_SHARE_RELIVE_SUCC_TIMES,"1");else{var Z=parseInt(Q)+1;_.default.save(y.default.QQ_SHARE_RELIVE_SUCC_TIMES,Z+"")}}else U?F.showToastTips("\u9700\u8981\u5206\u4EAB\u5230\u7FA4\u624D\u80FD\u590D\u6D3B"):h.default.isQQ()&&F.showToastTips("\u5206\u4EAB\u5931\u8D25!")})}})},R.prototype.diamondReliveClick=function(){if(this.mReviveController.isDiamondEnough()){if(this.pauseSchedule(),this.reliveGame(),!d.G.Ap.config.debugFreeRelive){var F=this.mReviveController.getReviveDiamondCost();this.mReviveController.reviveByDiamond(F)}}else h.default.isCM()?this.reliveByDiamondWhenNotEnoughIOS():h.default.isIOS()?this.reliveByDiamondWhenNotEnoughIOS():this.reliveByDiamondWhenNotEnoughAndroid()},R.prototype.reliveByDiamondWhenNotEnoughIOS=function(){var F=M.default.getInstance().getLanguageByKey("label_text.no_diamond_tips");this.showToastTips(F)},R.prototype.reliveByDiamondWhenNotEnoughAndroid=function(){var F=this;v.default.load("prefab/ReliveBuyDiamondDialog",function(x,U){F.node.addChild(U)})},R.prototype.showVideoAd=function(F){var x=this;F===void 0&&(F=!1);var U=this;f.MGAdv.show(U.getVideoScene(),g.QQ_ADV_TYPE.VIDEO_TYPE_GAME_RELIVE,function(B){switch(B){case g.ADStat.NOT_NETWORK:var Q=M.default.getInstance().getLanguageByKey("label_text.wwn");U.showToastTips(Q);break;case g.ADStat.SHOW_SUCCESS_CLOSE:F&&U.addDashProps(1),U.reliveGame(),U.mReviveController.reviveByVideo(F);break;case g.ADStat.SHOW_NOT_ENED_CLOSE:break;case g.ADStat.SHOW_GET_AD_FAILED:U.relive_layout.node.active=!1,U.skip_layout.node.active=!1,U.showToastTips("No video ads available",function(){cc.isValid(x,!0)&&(U.reliveGame(),U.mReviveController.reviveByVideo(),U.relive_layout.node.active=!0,U.skip_layout.node.active=!0)})}})},R.prototype.videoReliveClick=function(F){var x=this;F===void 0&&(F=!1),this.destoryBannerAd(),h.default.isWeiXin()?(MGB.Log.i("MGB_DEBUG","videoReliveClick"),this.showVideoAd(F)):this.scheduleOnce(function(){x.showVideoAd(F)},.3)},R.prototype.addDashProps=function(F){if(this.mReliveWithPropType){var x=new C.Property(this.mReliveWithPropType);d.G.Ap.state.addCarryProperty(x,1)}},R.prototype.showToastTips=function(F,x){var U=cc.instantiate(this.toastPrefab);U.getComponent(e.default).showTips(F,function(){U.destroy(),x&&x()}),this.toast_layout.node.addChild(U)},R.prototype.showToastAward=function(F,x){var U=cc.instantiate(this.toastPrefab);U.getComponent(e.default).showReliveAward(F,function(){U.destroy(),x&&x()}),this.toast_layout.node.addChild(U)},R.prototype.toGameOverScene=function(){console.log("toGameOverScene"),this.mCancelGameCallBack&&this.mCancelGameCallBack(),d.G.Ap.state.gameOver(),d.G.Ap.presenter.enterScene(d.G.GAME_OVER_SCENE_NAME,d.G.Ap.state.mission.musicId)},R.prototype.reliveGame=function(){console.log("reliveGame"),this.destoryBannerAd(),this.mReliveCallBack&&this.mReliveCallBack(this.mReliveWithPropType),f.MGAdv.gameplayStart()},R.prototype.getPopupUpByShowbanner=function(){return 100},R.prototype.adapterUIShowBanner=function(){h.default.isWeiXin()&&(this.relive_layout.node.y=this.relive_layout.node.y+this.getPopupUpByShowbanner(),this.skip_layout.node.y=this.skip_layout.node.y+this.getPopupUpByShowbanner())},__decorate([b(cc.Node)],R.prototype,"mLayout",void 0),__decorate([b(cc.Node)],R.prototype,"bgNode",void 0),__decorate([b(cc.Layout)],R.prototype,"relive_layout",void 0),__decorate([b(cc.Node)],R.prototype,"relive_content_layout",void 0),__decorate([b(cc.Prefab)],R.prototype,"challengeRelivePrefab",void 0),__decorate([b(cc.Prefab)],R.prototype,"qqRedPacketRelivePrefab",void 0),__decorate([b(cc.Label)],R.prototype,"relive_diamond_count_label",void 0),__decorate([b(cc.Label)],R.prototype,"relive_share_count_label",void 0),__decorate([b(cc.Label)],R.prototype,"mHelpReliveBtnLabel",void 0),__decorate([b(cc.Sprite)],R.prototype,"share_dianmod_num_icon",void 0),__decorate([b(cc.Layout)],R.prototype,"toast_layout",void 0),__decorate([b(cc.Prefab)],R.prototype,"toastPrefab",void 0),__decorate([b(cc.Label)],R.prototype,"wait_fd_label",void 0),__decorate([b(cc.Layout)],R.prototype,"fd_tips_layout",void 0),__decorate([b(cc.Layout)],R.prototype,"skip_layout",void 0),__decorate([b(cc.Button)],R.prototype,"relive_diamond_btn",void 0),__decorate([b(cc.Button)],R.prototype,"relive_share_btn",void 0),__decorate([b(cc.Button)],R.prototype,"relive_video_btn",void 0),__decorate([b(cc.Button)],R.prototype,"relive_video_props_btn",void 0),__decorate([b(cc.Sprite)],R.prototype,"relive_video_props_tip",void 0),R=__decorate([L],R)}(cc.Component);m.default=N,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/G":"G","../../base/Log":"Log","../../config/LSKey":"LSKey","../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../property/PropertyDefines":"PropertyDefines","../../upgrade/BannerDelayShowToggle":"BannerDelayShowToggle","../../upgrade/ToggleBean":"ToggleBean","../../util/PU":"PU","../../util/SUtil":"SUtil","../../util/StringUtil":"StringUtil","../Logic/I18nManager":"I18nManager","../Logic/MoneySystem":"MoneySystem","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../UI/rank/RankRevivePageContainer":"RankRevivePageContainer","../keypad/KeypadNavigator":"KeypadNavigator","../reward/RewardManager":"RewardManager","./QQRedPacketRelive":"QQRedPacketRelive","./ReviveController":"ReviveController"}],Relive:[function(l,P,m){"use strict";cc._RF.push(P,"55abffZB9lL5bK9fH4t109T","Relive"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../../base/G"),o=l("./ReviveController"),e=l("./ReliveTotal"),n=l("./ReliveNoShare"),t=l("./ReliveFreeDialogTipDialog"),i=l("../Network/Protocol/StorageUtil"),a=l("../../config/LSKey"),u=l("../UI/GameEntraScene/PrefabMgr"),c=cc._decorator,p=c.ccclass,h=c.property;(s=d=m.GAMESCENEZORDER||(m.GAMESCENEZORDER={}))[s.RELIVE=100]="RELIVE",s[s.RELIVE_NO_SHARE=101]="RELIVE_NO_SHARE";var f=function(g){function _(){var y=g!==null&&g.apply(this,arguments)||this;return y.reliveDialogPrefabTotal=null,y.reliveDialogPrefabNodeTotal=null,y.reliveDialogPrefabNoShare=null,y.reliveDialogPrefabNodeNoShare=null,y.mReviveController=null,y}return __extends(_,g),_.prototype.setReliveCallback=function(y){this.mReliveCallBack=y},_.prototype.setCancelGameCallback=function(y){this.mCancelGameCallBack=y},_.prototype.setReliveScoreDataCallback=function(y){this.mReliveScoreDataCallback=y},_.prototype.setReviveController=function(y){this.mReviveController=y,console.log("relive setReviveController : mReviveController = "+this.mReviveController)},_.prototype.onLoad=function(){},_.prototype.start=function(){console.log("relive : start = "+this.mReviveController),this.toReliveLayout()},_.prototype.toReliveLayout=function(){var y=this.mReviveController.getReliveMode(),S=this.mReviveController.getReliveType(r.G.Ap.state.attainScore,y);if(S!=o.default.RESULT_CAN_NOT_REVIVE)switch(S){case o.default.RESULI_RELIVE_CM:this.reliveDialogPrefabNodeTotal=cc.instantiate(this.reliveDialogPrefabTotal),this.reliveDialogPrefabNodeTotal&&(v=this.reliveDialogPrefabNodeTotal.getComponent(e.default))&&(v.setReviveController(this.mReviveController),v.setReliveScoreDataCallback(this.mReliveScoreDataCallback),v.setReliveType(S),v.setReliveCallback(this.mReliveCallBack),v.setCancelGameCallback(this.mCancelGameCallBack),this.node.getChildByName("UILayer").addChild(this.reliveDialogPrefabNodeTotal,d.RELIVE));break;case o.default.RESULT_REVIVE_FREE:this.showFirstFreeReliveDialog();break;case o.default.RESULT_REVIVE_VIDEO_AND_PROPS_AND_DIAMOND:var I=this.mReviveController.whichPropForRevive();case o.default.RESULT_REVIVE_SHARE_AND_DIAMOND:case o.default.RESULT_REVIVE_VIDEO_AND_DIAMOND:case o.default.RESULT_REVIVE_SHARE_AND_VIDEO:var v;this.reliveDialogPrefabNodeTotal=cc.instantiate(this.reliveDialogPrefabTotal),this.reliveDialogPrefabNodeTotal&&(v=this.reliveDialogPrefabNodeTotal.getComponent(e.default))&&(v.setReviveController(this.mReviveController),v.setReliveScoreDataCallback(this.mReliveScoreDataCallback),v.setReliveWithPropType(I),v.setReliveType(S),v.setReliveMode(y),v.setReliveCallback(this.mReliveCallBack),v.setCancelGameCallback(this.mCancelGameCallBack),this.node.getChildByName("UILayer").addChild(this.reliveDialogPrefabNodeTotal,d.RELIVE));break;case o.default.RESULT_REVIVE_ONLY_SHARE:if(this.reliveDialogPrefabNodeNoShare=cc.instantiate(this.reliveDialogPrefabNoShare),this.reliveDialogPrefabNodeNoShare){var C=this.reliveDialogPrefabNodeNoShare.getComponent(n.default);C&&(C.setReviveController(this.mReviveController),C.setReliveScoreDataCallback(this.mReliveScoreDataCallback),C.setReliveMode(y),C.setReliveCallback(this.mReliveCallBack),C.setCancelGameCallback(this.mCancelGameCallBack)),this.node.getChildByName("UILayer").addChild(this.reliveDialogPrefabNodeNoShare,d.RELIVE_NO_SHARE)}}else this.mCancelGameCallBack&&this.mCancelGameCallBack(),r.G.Ap.state.gameOver(),y==o.ReliveMode.CHALLENGE?r.G.Ap.presenter.enterScene("ChallengeCompetitionResult"):r.G.Ap.presenter.enterScene(r.G.GAME_OVER_SCENE_NAME,r.G.Ap.state.mission.musicId)},_.prototype.showFirstFreeReliveDialog=function(){var y=this;u.default.load("prefab/newtarget/FirstFailTipDialog",function(S,I){if(I){i.default.save(a.default.HAS_RELIVE_FREE,"true");var v=I.getComponent(t.default);v.setType(t.DIALOG_TYPE.RELIVE),v.setBtnClickCallback(y.mReliveCallBack),y.node.getChildByName("UILayer").addChild(I)}})},_.prototype.toTotalReliveLayout=function(y){try{this.reliveDialogPrefabNodeTotal=cc.instantiate(this.reliveDialogPrefabTotal)}catch(v){console.error("[ShareInvite]4  toTotalReliveLayout e= "+v)}if(console.error("[ShareInvite]2  toTotalReliveLayout diaCount= "+y+", this.reliveDialogPrefabNodeTotal ="+this.reliveDialogPrefabNodeTotal),this.reliveDialogPrefabNodeTotal){console.error("[ShareInvite]3  toTotalReliveLayout diaCount= "+y);var S=this.reliveDialogPrefabNodeTotal.getComponent(e.default);if(S){S.setReliveScoreDataCallback(this.mReliveScoreDataCallback),S.setReliveCallback(this.mReliveCallBack),S.setCancelGameCallback(this.mCancelGameCallBack),S.setReviveController(this.mReviveController),S.setShowByFdInvite(!0,y);var I=this.node.getChildByName("UILayer");this.reliveDialogPrefabNodeNoShare&&this.reliveDialogPrefabNodeNoShare.destroy(),I.addChild(this.reliveDialogPrefabNodeTotal,d.RELIVE)}}},__decorate([h(cc.Prefab)],_.prototype,"reliveDialogPrefabTotal",void 0),__decorate([h(cc.Prefab)],_.prototype,"reliveDialogPrefabNoShare",void 0),_=__decorate([p],_)}(cc.Component);m.default=f,cc._RF.pop()},{"../../base/G":"G","../../config/LSKey":"LSKey","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","./ReliveFreeDialogTipDialog":"ReliveFreeDialogTipDialog","./ReliveNoShare":"ReliveNoShare","./ReliveTotal":"ReliveTotal","./ReviveController":"ReviveController"}],RemoteCfgMgr:[function(l,P,m){"use strict";cc._RF.push(P,"60d29zo5cRBQbAIUr7/EtbW","RemoteCfgMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../upgrade/ToggleChecker"),s=l("../upgrade/ToggleBean"),r=l("../base/Log"),o=function(){function e(){this.TAG="RemoteCfgMgr",this.hasQQBannerHiddenInit=!1,this.mSSShowOffQQBannerHidden=!1,this.hasResultQQBannerDynamicInit=!1,this.mSSResultQQBannerDynamic=!1,this.preloadWXRewardedVideo=!1,this.resultBannerDelay=500,this.resultBannerDelayPopup=200}return e.getIns=function(){return this.singleIns||(this.singleIns=new e),this.singleIns},e.prototype.init=function(){var n=d.default.ins().getToggleStatus(s.ToggleKey.SINGLE_SONG_SHOWOFF_QQ_BANNER,0,1);this.mSSShowOffQQBannerHidden=n!=1,this.hasQQBannerHiddenInit=!0,r.default.i(this.TAG,"init hidden qq banner status: "+this.mSSShowOffQQBannerHidden);var t=d.default.ins().getToggleStatus(s.ToggleKey.SINGLE_SONG_RESULT_DYNAMIC_BANNER,0,0);this.mSSResultQQBannerDynamic=t==1,this.hasResultQQBannerDynamicInit=!0,r.default.i(this.TAG,"init dynamic qq banner status: "+this.mSSResultQQBannerDynamic);var i=d.default.ins().getToggleStatus(s.ToggleKey.WX_REWARDED_VIDEO_PRELOAD,0,0);this.preloadWXRewardedVideo=i==1,r.default.i(this.TAG,"init wechat awarded video preload status: "+this.preloadWXRewardedVideo),this.initBannerDelay()},e.prototype.initBannerDelay=function(){if(d.default.ins().getToggleStatus(s.ToggleKey.SINGLE_SONG_RESULT_BANNER_DELAY,0,0)==1){var n=d.default.ins().getToggle(s.ToggleKey.SINGLE_SONG_RESULT_BANNER_DELAY);if(n&&n.extra)try{var t=JSON.parse(JSON.stringify(n.extra));t&&(t.hasOwnProperty("normal")&&(this.resultBannerDelay=t.normal),t.hasOwnProperty("popup")&&(this.resultBannerDelayPopup=t.popup))}catch(i){r.default.e(this.TAG,"single song result banner delay data parse failed")}else r.default.e(this.TAG,"single song result banner delay data invalid")}},e.prototype.isQQBannerHiddenInit=function(){return this.hasQQBannerHiddenInit},e.prototype.isQQBannerHidden=function(){return r.default.i(this.TAG,"isQQBannerHidden:"+this.mSSShowOffQQBannerHidden),this.mSSShowOffQQBannerHidden},e.prototype.isQQDynamicBannerInit=function(){return this.hasResultQQBannerDynamicInit},e.prototype.isQQDynamicBanner=function(){return r.default.i(this.TAG,"isQQDynamicBanner:"+this.mSSResultQQBannerDynamic),this.mSSResultQQBannerDynamic},e.prototype.preloadWechatRewardedVideo=function(){return r.default.i(this.TAG,"preloadWXRewardedVideo:"+this.preloadWXRewardedVideo),this.preloadWXRewardedVideo},e.prototype.getBannerDelay=function(){return r.default.i(this.TAG,"single song result banner delay: "+this.resultBannerDelay+"(ms)"),Number((this.resultBannerDelay/1e3).toFixed(2))},e.prototype.getBannerDelayPopup=function(){return r.default.i(this.TAG,"single song result banner delay popup: "+this.resultBannerDelayPopup+"(ms)"),Number((this.resultBannerDelayPopup/1e3).toFixed(2))},e.singleIns=null,e}();m.default=o,cc._RF.pop()},{"../base/Log":"Log","../upgrade/ToggleBean":"ToggleBean","../upgrade/ToggleChecker":"ToggleChecker"}],RenderSwitch:[function(l,P,m){"use strict";cc._RF.push(P,"a1901dDyNJGja/jDTh51gaB","RenderSwitch"),Object.defineProperty(m,"__esModule",{value:!0}),cc._RF.pop()},{}],ResBean:[function(l,P,m){"use strict";cc._RF.push(P,"504a42/dN9EZZeY9JvJLRq2","ResBean"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(r){function o(){var e=r.call(this)||this;return e.skinItem=null,e}return __extends(o,r),o.TYPE_SKIN="skin",o.TYPE_REPLOAD="preload",o.TYPE_MODULE="module",o}(l("./VersionBean").default);m.ResBean=d;var s=function(){function r(){this.skinType=r.SKIN_TYPE_CERTIFICATION,this.piecesTotal=0,this.goldCount=0,this.watchAdsTimes=0}return r.SKIN_TYPE_DEFAULT="1",r.SKIN_TYPE_DAILYATTENDANCE="2",r.SKIN_TYPE_CERTIFICATION="3",r.SKIN_TYPE_INVITE="4",r.SKIN_TYPE_FIRST_PAY="5",r.DIS_ENABLE="1",r.DIS_DISABLE="0",r}();m.SkinBean=s,cc._RF.pop()},{"./VersionBean":"VersionBean"}],ResLoader:[function(l,P,m){"use strict";cc._RF.push(P,"ee5aeU7m2pC6JUikmhWdMGO","ResLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../modules/MGUtils/WeappHelper"),s=function(){function r(){}return r.loadJson=function(o,e){r.loadString(o,function(n,t){e(n,n?null:JSON.parse(t))})},r.loadString=function(o,e){cc.sys.platform===cc.sys.WECHAT_GAME?r.wxLoadRes(o,function(n,t){e(n,t)}):r.xmlLoadRes(o,function(n,t){e(n,t)})},r.wxLoadRes=function(o,e){d.WXAPI.wxFileSystemManager.readFile({filePath:o,encoding:"utf-8",success:function(n){e(null,n.data)},fail:function(n){e("wx loader::send error "+n,null)},complete:function(){}})},r.fetchLoadRes=function(o,e){fetch(o).then(function(n){return n}).then(function(n){e(null,n)}).catch(function(n){e("skin fetch::send error "+n,null)})},r.xmlLoadRes=function(o,e){var n=new XMLHttpRequest;n.open("GET",o,!0),n.responseType="text",n.onload=function(){var t=(n.status+"")[0];t!=="0"&&t!=="2"&&t!=="3"?e("error code "+t,null):e(null,n.response)};try{n.send()}catch(t){e("XMLHttpRequest::send error "+t,null)}},r}();m.default=s,cc._RF.pop()},{"../../modules/MGUtils/WeappHelper":"WeappHelper"}],ResMgr:[function(l,P,m){"use strict";cc._RF.push(P,"43ccfrkjf1HcZBhYRJUmGoM","ResMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/Log"),s=l("./ResBean"),r=l("../config/LSKey"),o=l("../base/GameInfoMgr"),e=l("./Downloader"),n=l("../infoc/m_p2_load_f"),t=l("../business/Logic/EventBus"),i=l("../business/Logic/NotifyEvent"),a=l("../util/NumberUtil"),u=l("./IChecker"),c=l("../util/StringUtil"),p=l("../business/Network/Protocol/StorageUtil"),h=l("../infoc/m_p2_DL"),f=l("../util/PU"),g=function(){function y(){this.mResChecker=null,this.mSkinChecker=null,this.initSuccess=!1,this.mIniting=!1,this.mPatchStatus=new Object}return y.Ins=function(){return y._instance==null&&(y._instance=new y),y._instance},y.prototype.init=function(S){var I=this;if(this.initSuccess)S(!0);else if(this.mIniting)S(!1);else{this.mIniting=!0;var v=o.GameInfoMgr.Ins().getInfo();v?(this.mResChecker==null&&(this.mResChecker=new _(s.ResBean.TYPE_REPLOAD,r.default.RES_PRELOAD_INFO,v.resCDN+v.resPath,"resources/res.json")),this.mSkinChecker==null&&(this.mSkinChecker=new _(s.ResBean.TYPE_SKIN,r.default.RES_SKIN_INFO,v.skinPath,"resources/skin.json")),this.mResChecker.check(function(){if(I.mResChecker.getData()){var C=!1;I.mResChecker.getData().forEach(function(T){c.StringUtil.isEmpty(T.url)||T.url.startsWith(v.resCDN)||(T.url=v.resCDN+T.url,C=!0)}),C&&I.mResChecker.saveLocalData()}I.mSkinChecker.check(function(){if(I.mSkinChecker.getData()){var T=!1;I.mSkinChecker.getData().forEach(function(E){c.StringUtil.isEmpty(E.url)||E.url.startsWith(v.skinCDN)||(E.url=v.skinCDN+E.url,T=!0)}),T&&I.mResChecker.saveLocalData()}I.initSuccess=!0,I.mIniting=!1,S(!0)},function(){n.default.report("Res_Skin","[3]net error."),d.default.e(y.TAG+"SkinChecker check [Skin] failed."),I.initSuccess=!1,I.mIniting=!1,S(!1)})},function(){n.default.report("Res_preload","[3]net error."),d.default.e(y.TAG+"ResChecker check [Res] failed."),I.initSuccess=!1,I.mIniting=!1,S(!1)})):(n.default.report("Res_GameInfo","GameInfo is null."),console.error(y.TAG+"\u52A0\u8F7D\u914D\u7F6E\u6587\u4EF6\u5931\u8D25\u3010game_info\u3011"),this.initSuccess=!1,this.mIniting=!1,S(!1))}},y.prototype.notifyUINeedUpdate=function(S){t.default.fire(i.default.LOADING_UI_NOTIFY,"download",S)},y.prototype.notifyUINotNeedUpdate=function(){t.default.fire(i.default.LOADING_UI_NOTIFY,"no-download",0)},y.prototype.getBasicInfoBeans=function(){var S=p.default.read(r.default.BASIC_DATA_VER);d.default.i("LocalStorageKey.BASIC_DATA_VER="+S),h.default.setLocalVersion(S),h.default.setResType(s.ResBean.TYPE_REPLOAD);var I=this.filterResBean(function(v){return v&&v.type=="patch-"+S});return I&&0<I.length?(h.default.setDownloadType(!1),I):(h.default.setDownloadType(!0),this.filterResBean(function(v){return v&&v.type==s.ResBean.TYPE_REPLOAD}))},y.prototype.filterResBean=function(S){return this.mResChecker&&this.mResChecker.getData()?this.mResChecker.getData().filter(function(I){return S(I)}):null},y.prototype.clearLocalResInfo=function(){this.mResChecker&&this.mResChecker.getData()&&(d.default.l("clear local baisc data version."),p.default.save(r.default.BASIC_DATA_VER,""),this.mResChecker.getData().forEach(function(S){S&&S.clearLocalInfo()}),this.mResChecker.saveLocalData())},y.prototype.downloadBasicRes=function(S){var I=this;return new Promise(function(v,C){I.download(S).then(function(T){I.upgradeAllInfo(),T&&p.default.save(r.default.IS_NEED_REDOWNLOAD,"true"),v(T)},function(){C()})})},y.prototype.download=function(S){var I=this;return d.default.w("\u4E0B\u8F7D\u8D44\u6E90\u5305",S),new Promise(function(v,C){S==null||S.length==0?C():I.downloadVol(S,function(T){v(T)},function(){C()})})},y.prototype.upgradeAllInfo=function(){if(this.mResChecker&&this.mResChecker.getData()){var S=null;this.mResChecker.getData().forEach(function(I){I.isNeedUpdate()&&(I.localMd5=I.md5,I.localVer=I.serverVer),I.type!="preload"||S!=null&&S!=null||(S=I.serverVer)}),d.default.l("save local baisc data version(LocalStorageKey.BASIC_DATA_VER)."+S),p.default.save(r.default.BASIC_DATA_VER,S),this.mResChecker.saveLocalData()}},y.prototype.downloadSliceVol=function(S,I,v,C,T){for(var E=this,A=Object.keys(this.mPatchStatus),M=0;M<A.length;M++){var k=A[M];k&&delete this.mPatchStatus[k]}for(var D=!1,L=function(H){var R=S[H];R&&R.isNeedUpdate()&&(D=!0,b.mPatchStatus[R.getUniqueKey()]="downloading",d.default.w("=====> start downloading: "+R.getUniqueKey(),R),e.default.Ins().download(R).then(function(){delete E.mPatchStatus[R.getUniqueKey()],d.default.w("=====> downloadSliceVol\uFF08\u6210\u529F\uFF09: "+R.getUniqueKey(),R),R.localMd5=R.md5,R.localVer=R.serverVer;var F=Object.keys(E.mPatchStatus);if(F.length==0)E.mResChecker.saveLocalData(),C();else{for(var x=!0,U=0;U<F.length;U++)E.mPatchStatus[F[U]]=="downloading"&&(x=!1);x&&(d.default.w("=====> all finished: ",E.mPatchStatus),E.mResChecker.saveLocalData(),T())}},function(){E.mPatchStatus[R.getUniqueKey()]="failed";var F=Object.keys(E.mPatchStatus),x=!0;if(1<F.length)for(var U=0;U<F.length;U++)E.mPatchStatus[F[U]]=="downloading"&&(x=!1);x&&T()}))},b=this,N=I;N<v;N++)L(N);D||C()},y.prototype.downloadVol=function(S,I,v){var C=0,T=0,E=0;if(S.forEach(function(A){A&&A.isNeedUpdate()&&(C++,E+=A.size),T+=A.size}),h.default.setDownloadTotalSize(T),h.default.setDownloadSize(E),C==0)return this.notifyUINotNeedUpdate(),void I(!1);this.notifyUINeedUpdate(C),this.loopDownload(S,0,function(){h.default.setDownloadStatus(!0),h.default.report(),I(!0)},function(){h.default.setDownloadStatus(!1),h.default.report(),n.default.report("Res_PreLoad_DownloadVol","volume download."),v()})},y.prototype.loopDownload=function(S,I,v,C){var T=this;if(I!=S.length){var E=I+5;E>=S.length&&(E=S.length),this.downloadSliceVol(S,I,E,function(){T.loopDownload(S,E,v,C)},function(){d.default.w("downloadSliceVol \u5931\u8D25"+I+"/"+E),C()})}else v()},y.prototype.getSkinBean=function(S){if(this.mSkinChecker&&this.mSkinChecker.getData()&&0<this.mSkinChecker.getData().length){var I=void 0,v=this.mSkinChecker.getData().filter(function(C){return C.key==S});return(v==null||0<v.length)&&(I=v[0]),I}return null},y.prototype.downloadSkin=function(S,I,v){var C=this;S?S.isNeedUpdate()?e.default.Ins().download(S).then(function(){S.localMd5=S.md5,S.localVer=S.serverVer,C.mSkinChecker.saveLocalData(),I()},function(){v()}):I():v()},y.prototype.cancelDownloadSkin=function(S){var I=this.getSkinBean(S);I&&e.default.Ins().cancelDownload(I)},y.prototype.getSkins=function(){return this.mSkinChecker?this.mSkinChecker.getData():[]},y.TAG="ResMgr => ",y}();m.default=g;var _=function(y){function S(){return y!==null&&y.apply(this,arguments)||this}return __extends(S,y),S.prototype.onMergeServerToLocal=function(I,v){},S.prototype.validateData=function(I){return!0},S.prototype.parseData=function(I,v){this.getType()==s.ResBean.TYPE_REPLOAD?I(configuration.Value.ResList):this.getType()==s.ResBean.TYPE_SKIN?I(configuration.Value.SkinList):y.prototype.parseData.call(this,I,v)},S.prototype.mergeToLocalData=function(I){if(I&&0<I.length){for(var v=[],C=0;C<I.length;C++){var T=this.populateServerObj(I[C]);if(T){v.push(T);for(var E=null,A=0;A<this.mLocalBeans.length;A++){var M=this.mLocalBeans[A];if(M.key==T.key){E=M;break}}E&&(T.localMd5=E.md5,T.localVer=E.localVer,T.downloadTime=E.downloadTime)}}0<v.length&&(this.mLocalBeans=v)}return!0},S.prototype.populateServerObj=function(I){if(!I)return null;var v=new s.ResBean;if(v.serverVer=u.default.populateStr(I.ver),v.key=u.default.populateStr(I.key),v.url=u.default.populateStr(I.url),v.md5=u.default.populateStr(I.md5),v.type=u.default.populateStr(I.type),v.size=a.default.parseNum(I.size),v.type==s.ResBean.TYPE_SKIN){var C=I.skin;if(C){var T=new s.SkinBean;T.name=u.default.populateStr(C.name),T.displayName=u.default.populateStr(C.displayName),T.previewImage=u.default.populateStr(C.image),T.url=u.default.populateStr(C.url),T.skinType=u.default.populateStr(C.skinType),T.certificationCount=a.default.parseNum(C.cost),T.goodId=u.default.populateStr(C.goodId),T.disCountEnable=u.default.populateStr(C.disCountEnable),T.dis=u.default.populateStr(C.dis),T.ticket=u.default.populateStr(C.ticket),T.disTicket=u.default.populateStr(C.disTicket),T.rmb=u.default.populateStr(C.rmb),T.disRmb=u.default.populateStr(C.disRmb),f.default.isCM()?(T.goldCount=a.default.parseNum(C.goldCount),T.watchAdsTimes=a.default.parseNum(C.watchAdsTimes)):(T.piecesId=u.default.populateStr(C.pieceId),T.piecesTotal=a.default.parseNum(C.pieceCount)),T.skinType==s.SkinBean.SKIN_TYPE_CERTIFICATION&&T.certificationCount<=0&&(T.certificationCount=1),v.skinItem=T}}return v},S.prototype.populateLocalObj=function(I){if(!I)return null;var v=new s.ResBean;if(v.localVer=u.default.populateStr(I.localVer),v.serverVer=u.default.populateStr(I.serverVer),v.downloadTime=a.default.parseNum(I.downloadTime),v.localMd5=u.default.populateStr(I.localMd5),v.key=u.default.populateStr(I.key),v.url=u.default.populateStr(I.url),v.md5=u.default.populateStr(I.md5),v.type=u.default.populateStr(I.type),I.skinItem){var C=new s.SkinBean;C.certificationCount=a.default.parseNum(I.skinItem.certificationCount),C.displayName=u.default.populateStr(I.skinItem.displayName),C.name=u.default.populateStr(I.skinItem.name),C.previewImage=u.default.populateStr(I.skinItem.previewImage),C.skinType=u.default.populateStr(I.skinItem.skinType),C.url=u.default.populateStr(I.skinItem.url),C.goodId=u.default.populateStr(I.skinItem.goodId),C.disCountEnable=u.default.populateStr(I.skinItem.disCountEnable),C.dis=u.default.populateStr(I.skinItem.dis),C.ticket=u.default.populateStr(I.skinItem.ticket),C.disTicket=u.default.populateStr(I.skinItem.disTicket),C.rmb=u.default.populateStr(I.skinItem.rmb),C.disRmb=u.default.populateStr(I.skinItem.disRmb),C.piecesId=u.default.populateStr(I.skinItem.pieceId),C.piecesTotal=a.default.parseNum(I.skinItem.pieceCount),v.skinItem=C}return v},S}(u.default);cc._RF.pop()},{"../base/GameInfoMgr":"GameInfoMgr","../base/Log":"Log","../business/Logic/EventBus":"EventBus","../business/Logic/NotifyEvent":"NotifyEvent","../business/Network/Protocol/StorageUtil":"StorageUtil","../config/LSKey":"LSKey","../infoc/m_p2_DL":"m_p2_DL","../infoc/m_p2_load_f":"m_p2_load_f","../util/NumberUtil":"NumberUtil","../util/PU":"PU","../util/StringUtil":"StringUtil","./Downloader":"Downloader","./IChecker":"IChecker","./ResBean":"ResBean"}],ReuseNodePool:[function(l,P,m){"use strict";cc._RF.push(P,"52aaavZqw1AsaAdxYcJW4nc","ReuseNodePool"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.mReuseNodeCache=null,this.resetCache()}return s.prototype.resetCache=function(){this.mReuseNodeCache=[]},s.prototype.get=function(r){var o=this.mReuseNodeCache.pop();return o!=null&&o!=null?(o.reuse(r),o):null},s.prototype.put=function(r){return r!=null&&r!=null&&(r.unuse(),this.mReuseNodeCache.push(r),!0)},s.prototype.clear=function(){for(var r=0,o=this.mReuseNodeCache;r<o.length;r++)o[r];this.resetCache()},s.prototype.size=function(){return this.mReuseNodeCache.length},s}();m.default=d,cc._RF.pop()},{}],ReuseNode:[function(l,P,m){"use strict";cc._RF.push(P,"48721fMEvNLlJCO9csutGdE","ReuseNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.unuse=function(){this.visible=!1},r.prototype.reuse=function(o){this.opacity=1,this.visible=!0,this.setFrame(0)},r}(l("../../MUI/MUISprite").default);m.default=d,cc._RF.pop()},{"../../MUI/MUISprite":"MUISprite"}],ReviveController:[function(l,P,m){"use strict";cc._RF.push(P,"40c0f8U/r5M3LbdvUueH6fu","ReviveController"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../../base/G"),o=l("../Network/Protocol/StorageUtil"),e=l("../../config/LSKey"),n=l("../../util/TimeUtil"),t=l("../Logic/PlayerMgr"),i=l("../Logic/Plugin/PluginMgr"),a=l("../Logic/Plugin/IPlugin"),u=l("../../infoc/m_p2_PData_Dia"),c=l("../reward/RewardManager"),p=l("../../base/Log"),h=l("../../gamescene/GameSceneSetting"),f=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),g=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),_=l("../../util/PU"),y=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),S=l("../../../scripts/util/Utility"),I=l("../../property/PropertyDefines"),v=l("../Logic/I18nManager"),C=cc._decorator,T=C.ccclass;C.property,(s=d=m.ReliveMode||(m.ReliveMode={}))[s.NORMAL=0]="NORMAL",s[s.CHALLENGE=1]="CHALLENGE",s[s.QQ_RED_PACK=2]="QQ_RED_PACK";var E=function(){function A(){this.mCurReviveCount=0,this.mLevelId=-1,this.mBestScore=0,this.mReliveMode=d.NORMAL,this.mScore=0,this.mStarCount=0}var M;return(M=A).prototype.getBestScore=function(){return this.mBestScore},A.prototype.initLevelInfo=function(k){this.mLevelId=k;var D=t.default.Ins().getLevelRecord(k);this.mBestScore=D?D.mBestScore:0},A.prototype.initReliveData=function(k,D,L){L===void 0&&(L=0),this.mReliveMode=k,this.mScore=D,this.mStarCount=L},A.prototype.getReliveMode=function(){return this.mReliveMode},A.prototype.getMaxReviveCount=function(){var k=r.G.propAddition.getAdditionReviveTimes(r.G.Ap.state.mission.getType().toString());return M.MAX_REVIVE_COUNT+k},A.prototype.getReliveType=function(k,D){var L=this.getCurReviveCount(),b=c.RewardMgr.Ins().getCanAlsoInviteNumToday();cc.sys.isBrowser&&(b=0);var N=this.isDiamondEnough(),H=this.isToadyFristRelive(),R=this.hasToadyFristClickedVideoWithProp(),F=f.MGAdv.isADFeatureEnable(),x=f.MGAdv.isADCached(g.QQ_ADV_TYPE.VIDEO_TYPE_GAME_RELIVE);_.default.isWeiXin()||f.MGAdv.load(g.ADScene.RELIVE_POPUP,g.QQ_ADV_TYPE.VIDEO_TYPE_GAME_RELIVE);var U=f.MGAdv.lastFailIs30Minutes(),B=r.G.Ap.state.attainStars,Q=this.getMaxReviveCount(),Z=h.default.getInstance().isUserGuideFinish();return console.log("==========================\u590D\u6D3B\u5F39\u7A97"),console.log("\u5F53\u5C40\u590D\u6D3B\u8FC7\u7684\u6B21\u6570\uFF1A"+L),console.log("\u4ECA\u5929\u53EF\u9080\u8BF7\u4EBA\u6570\uFF1A"+b),console.log("\u672C\u6B21\u94BB\u77F3\u662F\u5426\u8DB3\u591F\uFF1A"+N),console.log("\u5F53\u5929\u662F\u5426\u9996\u6B21\u5F39\u590D\u6D3B\uFF1A"+H),console.log("\u5FAE\u4FE1\u662F\u5426\u652F\u6301\u89C6\u9891\u5E7F\u544A\uFF1A"+F),console.log("\u662F\u5426\u6709\u5E7F\u544A\u7F13\u5B58\uFF1A"+x),console.log("\u4E0A\u6B21\u89C6\u9891\u5931\u8D25\u5DF2\u8FC730\u5206\u949F\uFF1A"+U),console.log("\u5F53\u524D\u83B7\u53D6\u7684\u661F\u661F\u6570\uFF1A"+B),console.log("\u5F53\u524D\u6700\u5927\u590D\u6D3B\u6B21\u6570\uFF1A"+Q),console.log("\u5F53\u5929\u662F\u5426\u5DF2\u70B9\u51FB\u8FC7\u770B\u89C6\u9891\u9001\u9053\u5177\u590D\u6D3B\uFF1A"+R),console.log("\u5F53\u524D\u6700\u5927\u590D\u6D3B\u6B21\u6570\uFF1A"+Q),console.log("isUserGuideFinish: ",Z),B<3&&!h.default.getInstance().isUserGuideFinish()&&!o.default.read(e.default.HAS_RELIVE_FREE)?(p.default.i("return \u7B2C\u4E00\u6B21\u514D\u8D39\u590D\u6D3B\uFF0C\u4E0D\u8BA1\u5165\u590D\u6D3B\u6B21\u6570\uFF0C\u76F4\u63A5\u590D\u6D3B"),M.RESULT_REVIVE_FREE):D!=d.QQ_RED_PACK&&k<20||Q<=L?(console.log("return \u4E0D\u5F39"),M.RESULT_CAN_NOT_REVIVE):_.default.isCM()?M.RESULI_RELIVE_CM:F?0<b?N?H||_.default.isQQ()&&!x?H&&_.default.isQQ()?(p.default.l("return qq \u9996\u6B21 \u201C\u52A9\u529B\u201D"),M.RESULT_REVIVE_ONLY_SHARE):(p.default.l("return 2 \u201C\u52A9\u529B + \u94BB\u77F3\u201D"),M.RESULT_REVIVE_SHARE_AND_DIAMOND):(p.default.l("return 3 \u201C\u89C6\u9891 + \u94BB\u77F3\u201D"),M.RESULT_REVIVE_VIDEO_AND_DIAMOND):H?(p.default.l("return 4 \u201C\u5355\u5206\u4EAB\u52A9\u529B\u201D"),M.RESULT_REVIVE_ONLY_SHARE):x||_.default.isWeiXin()?(p.default.l("return 5 \u201C\u52A9\u529B + \u89C6\u9891\u201D"),M.RESULT_REVIVE_SHARE_AND_VIDEO):(p.default.l("return 6 \u201C\u52A9\u529B + \u94BB\u77F3\u201D"),M.RESULT_REVIVE_SHARE_AND_DIAMOND):(p.default.l("return 7 \u201C\u89C6\u9891 + \u94BB\u77F3\u201D"),M.RESULT_REVIVE_VIDEO_AND_DIAMOND):0<b&&!N?(console.log("return 0 \u201C\u5355\u5206\u4EAB\u52A9\u529B\u201D"),M.RESULT_REVIVE_ONLY_SHARE):(console.log("return 1 \u201C\u52A9\u529B + \u94BB\u77F3\u201D"),M.RESULT_REVIVE_SHARE_AND_DIAMOND)},A.prototype.isToadyFristRelive=function(){var k=parseInt(o.default.read(e.default.LAST_SHARE_RELIVE_TIME));return n.default.formatDate(k)!=n.default.getTodayFormatDate()},A.prototype.hasToadyFristClickedVideoWithProp=function(){var k=parseInt(o.default.read(e.default.LAST_WATCH_VIDEO_WITH_PROP_RELIVE_TIME));return n.default.formatDate(k)==n.default.getTodayFormatDate()},A.prototype.whichPropForRevive=function(){var k=S.Utility.getRandom(1,100);return k<=50?(p.default.i("random value:"+k+", dash prop"),I.PROPERTYTYPE.GAME_DASH):(p.default.i("random value:"+k+", shield prop"),I.PROPERTYTYPE.GAME_SHIELD)},A.prototype.getCurReviveCount=function(){return this.mCurReviveCount},A.prototype.updateCurReviveCount=function(){this.mCurReviveCount++},A.prototype.isDiamondEnough=function(){if(r.G.Ap.config.debugFreeRelive)return!0;var k=this.getReviveDiamondCost();return t.default.Ins().getUserDiamond()>=k},A.prototype.getReviveDiamondCost=function(){var k=0;switch(this.getCurReviveCount()+1){case 1:k=2;break;case 2:k=4;break;case 3:case 4:k=6;break;default:k=2}return p.default.w("revive count="+this.getCurReviveCount()+"  diamond cost="+k),k},A.prototype.reviveByDiamond=function(k){this.updateCurReviveCount(),i.default.Ins().getPluginEx(a.default.Plugin_Economy).costDiamond(k),u.default.report(k,u.default.SOURCE_RELIVE_USE,u.default.ACTION_CONSUME_DIAMOND)},A.prototype.reviveByShare=function(){this.mCurReviveCount++},A.prototype.reviveByVideo=function(k){this.updateCurReviveCount(),k&&this.saveTodayReviveWithPropInfo()},A.prototype.saveTodayReviveWithPropInfo=function(){var k=new Date().getTime();o.default.save(e.default.LAST_WATCH_VIDEO_WITH_PROP_RELIVE_TIME,k+"")},A.prototype.saveTodayRecordInfo=function(k){k===void 0&&(k=M.RESULT_CAN_NOT_REVIVE);var D=parseInt(o.default.read(e.default.LAST_SHARE_RELIVE_TIME)),L=n.default.formatDate(D),b=new Date().getTime();if(L!=n.default.formatDate(b))o.default.save(e.default.TODAY_SHARE_RELIVE_COUNT,"1");else{var N=parseInt(o.default.read(e.default.TODAY_SHARE_RELIVE_COUNT))+1;o.default.save(e.default.TODAY_SHARE_RELIVE_COUNT,N+"")}o.default.save(e.default.LAST_SHARE_RELIVE_TIME,b+"")},A.prototype.isFirstShareRelive=function(){var k=!1;return o.default.read(e.default.RELIVE_SHARE_FIRST_TIME)||(k=!0),k},A.prototype.reliveFirstShare=function(){o.default.save(e.default.RELIVE_SHARE_FIRST_TIME,"true")},A.prototype.getReliveBtnText=function(){var k=y.MGUser.getCurrentServerTime();return n.default.formatDate(k),v.default.getInstance().isEnglish()?"invite friends ":"\u53D1\u8D77\u52A9\u529B"},A.prototype.getReliveTipsText=function(){var k=y.MGUser.getCurrentServerTime();return n.default.formatDate(k),v.default.getInstance().isEnglish()?"can invite %s friends ":"\u4ECA\u5929\u8FD8\u53EF\u52A9\u529B%s\u6B21"},A.MAX_SHARE_COUNT=3,A.MAX_REVIVE_COUNT=3,A.MAX_SHARE_GAIN_GOLD_COUNT=3,A.RESULT_CAN_NOT_REVIVE=0,A.RESULT_REVIVE_ONLY_SHARE=1,A.RESULT_REVIVE_SHARE_AND_DIAMOND=2,A.RESULT_REVIVE_VIDEO_AND_DIAMOND=3,A.RESULT_REVIVE_SHARE_AND_VIDEO=4,A.RESULT_REVIVE_FREE=5,A.RESULT_REVIVE_VIDEO_AND_PROPS_AND_DIAMOND=6,A.RESULI_RELIVE_CM=7,A.CHALLENGE_DEFAULT=0,A.CHALLENGE_NO_FULL_CORWN=1,A.CHALLENGE_GOT_FULL_CORWN=2,A.CHALLENGE_FIRST_PLACE=3,A.CHALLENGE_NO_FULL_STAR=4,A.CHALLENGE_FULL_STAR_NO_FULL_CORWN=5,A.TYPE_CROWN_OR_STAR=1,A.TYPE_RANK=2,A.TYPE_BEYOND_FRD=3,A.TYPE_NEWRECORD=4,A.TYPE_IMMEDIATE_REVIVE=5,A=M=__decorate([T],A)}();m.default=E,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../scripts/util/Utility":"Utility","../../base/G":"G","../../base/Log":"Log","../../config/LSKey":"LSKey","../../gamescene/GameSceneSetting":"GameSceneSetting","../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../property/PropertyDefines":"PropertyDefines","../../util/PU":"PU","../../util/TimeUtil":"TimeUtil","../Logic/I18nManager":"I18nManager","../Logic/PlayerMgr":"PlayerMgr","../Logic/Plugin/IPlugin":"IPlugin","../Logic/Plugin/PluginMgr":"PluginMgr","../Network/Protocol/StorageUtil":"StorageUtil","../reward/RewardManager":"RewardManager"}],RewardBeans:[function(l,P,m){"use strict";cc._RF.push(P,"6fb42m9t2ZC0ItCSbNZP+uL","RewardBeans"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function e(){}return e.HELP_REWARD_DIAMOND=2,e.SURPRISE_GIFT_STAMINA=8,e.SURPRISE_GIFT_DIAMOND=8,e.SURPRISE_GIFT_GOLD=188,e.INVITE_PEOPLE_MAX_NUM=5,e.INVITE_PEOPLE_MAX_NUM_QQ=2,e.BE_INVITE_PEOPLE_MAX_NUM=5,e.STATE_INVITE_SUCCESS=1,e.STATE_NOT_INVITE=0,e.inviteInfoInviterMax="inviter max",e.inviteInfoInviteeMax="invitee max",e.inviteInfoRepeat="repeat",e}();m.ConstantConfig=d;var s=function(){function e(){this.staminaNum=d.SURPRISE_GIFT_STAMINA,this.diamondNum=d.SURPRISE_GIFT_DIAMOND,this.goldNum=d.SURPRISE_GIFT_GOLD,this.isEnable=!0,this.hasConsume=!1,this.skinID=null}return e.prototype.toString=function(){return this.isEnable?"true":"false"},e.prototype.parseFrom=function(n){this.isEnable=n==="true"},e}();m.SurpriseGiftBox=s;var r=function(){function e(){this.beInvitedOpenId="",this.isConsume=!1,this.state=d.STATE_INVITE_SUCCESS,this.isNewUser=!1,this.userAvatarUrl="",this.userNickName=""}return e.prototype.toString=function(){return this.beInvitedOpenId+"+"+this.isConsume+"+"+this.state+"+"+this.isNewUser+"+"+this.diamondNum+"+"+this.userAvatarUrl+"+"+this.userNickName},e.prototype.parseFrom=function(n){if(n!=null){var t=n.split("+");if(t!=null&&t!=null&&t.length!=0)if(t.length<7)console.error("InviteRewardInfo parseFrom \u89E3\u6790\u9519\u8BEF => values`s lenght is incorrect, length should be 7 current length = "+t.length);else try{this.beInvitedOpenId=t[0],this.isConsume=t[1]==="true",this.state=parseInt(t[2]),this.isNewUser=t[3]==="true",this.diamondNum=parseInt(t[4]),this.userAvatarUrl=t[5],this.userNickName=t[6]}catch(i){console.error("InviteRewardInfo parseFrom \u89E3\u6790\u9519\u8BEF!"),console.error(i)}else console.error("InviteRewardInfo parseFrom \u89E3\u6790\u9519\u8BEF => values is null or lenght is 0")}},e}();m.InviteRewardInfo=r;var o=function(){this.userNickName="",this.diamondNum=d.HELP_REWARD_DIAMOND,this.remainingHelpNum=0,this.alsoHelpNum=0};m.HelpRewardInfo=o,cc._RF.pop()},{}],RewardManager:[function(l,P,m){"use strict";cc._RF.push(P,"deaaaCUaoRBT6mwnl+ca1rd","RewardManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./RewardBeans"),s=l("../Network/Protocol/StorageUtil"),r=l("../../config/LSKey"),o=l("./RewardRequester"),e=l("../Logic/InviteAwardManager"),n=l("../../util/StringUtil"),t=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),i=l("../../base/Log"),a=function(){function u(){this.mInviteDate="",this.mInviteRewardInfoList=[],this.mSurpriseGiftBoxArray=new Array,this.mHelpRewardInfo=new d.HelpRewardInfo,this.initFromCache()}return u.Ins=function(){return this.sInstance==null&&(this.sInstance=new u),this.sInstance},u.prototype.initFromCache=function(){var c=this;this.mInviteDate=s.default.read(r.default.INVITE_DATE);var p=s.default.read(r.default.SURPRISE_GIFT_BOX);if(n.StringUtil.isEmpty(p))for(f=0;f<5;f++)this.mSurpriseGiftBoxArray.push(new d.SurpriseGiftBox);else{var h=this.parseToObject(p);if(h!=null&&h!=null)this.mSurpriseGiftBoxArray=h;else for(var f=0;f<5;f++)this.mSurpriseGiftBoxArray.push(new d.SurpriseGiftBox)}var g=s.default.read(r.default.INVITE_REWARD_INFO_LIST);if(g){var _=g.split(u.SEPERATE_STR);_&&(_.forEach(function(y){var S=new d.InviteRewardInfo;S.parseFrom(y),c.mInviteRewardInfoList.push(S)}),i.default.l("[RewardManager] \u7F13\u5B58\u8BFB\u53D6\u51FA\u6765\u9080\u8BF7\u8FC7\u7684\u6570\u636E => ",this.mInviteRewardInfoList))}},u.prototype.updateInviteListFileCache=function(){for(var c="",p=0;p<this.mInviteRewardInfoList.length;p++)c+=this.mInviteRewardInfoList[p].toString(),p!=this.mInviteRewardInfoList.length-1&&(c+=u.SEPERATE_STR);s.default.save(r.default.INVITE_REWARD_INFO_LIST,c),i.default.l("[RewardManager] \u66F4\u65B0\u9080\u8BF7\u5217\u8868\u6570\u636E\u5230\u672C\u5730\u7F13\u5B58 => "+c)},u.prototype.updateInviteDateFileCache=function(){s.default.save(r.default.INVITE_DATE,this.mInviteDate),i.default.l("[RewardManager] \u66F4\u65B0\u9080\u8BF7\u65E5\u671F\u5230\u672C\u5730\u7F13\u5B58 => "+this.mInviteDate)},u.prototype.updateGiftBoxFileCache=function(){var c=this.parseToString(this.mSurpriseGiftBoxArray);s.default.save(r.default.SURPRISE_GIFT_BOX,c),i.default.l("[RewardManager] \u66F4\u65B0\u793C\u76D2\u4FE1\u606F\u5230\u672C\u5730\u7F13\u5B58 => "+c)},u.prototype.clearAllData=function(){this.mInviteDate="",this.mInviteRewardInfoList=[],this.mSurpriseGiftBoxArray.forEach(function(c){c.isEnable=!0})},u.prototype.getCacheInviteRewardList=function(){return this.mInviteRewardInfoList},u.prototype.getInviteRewardList=function(c){var p=this;c&&this.getInviteSuccessListComplete(function(h){if(!h)return console.error("[RewardManager] getInviteRewardList \u670D\u52A1\u5668\u8FD4\u56DE\u5217\u8868\u4E3A\u7A7A"),void c(p.mInviteRewardInfoList);var f=p.mInviteRewardInfoList.slice(0);p.mInviteRewardInfoList.splice(0,p.mInviteRewardInfoList.length),i.default.l("[RewardManager] getInviteRewardList \u9080\u8BF7\u4EBA => ",h);for(var g=0;g<h.length;g++){var _=h[g];_.isConsume=p.isComsume(f,_),p.mInviteRewardInfoList.push(_)}c(p.mInviteRewardInfoList)})},u.prototype.isComsume=function(c,p){for(var h=!1,f=0;f<c.length;f++)if(p.beInvitedOpenId==c[f].beInvitedOpenId){c[f].isConsume==1&&(h=!0);break}return h},u.prototype.cosumeInviteRewardInfo=function(c){if(this.mInviteRewardInfoList){for(var p=0;p<this.mInviteRewardInfoList.length;p++){var h=this.mInviteRewardInfoList[p];h.beInvitedOpenId===c.beInvitedOpenId&&(h.isConsume=!0,i.default.l("[RewardManager] cosumeInviteRewardInfo \u6D88\u8D39\u6389\u5956\u52B1 => ",h))}this.updateInviteListFileCache()}else console.error("[RewardManager] \u5F53\u524D\u9080\u8BF7\u5217\u8868\u6570\u636E\u4E3A\u7A7A\uFF0C\u7406\u8BBA\u4E0A\u4E0D\u5E94\u8BE5\u51FA\u73B0\uFF0C\u9664\u975E\u6709\u5730\u65B9\u7F6E\u7A7A")},u.prototype.getSurpriseGiftInfo=function(c){return this.getReward(c,this.mSurpriseGiftBoxArray[c]),this.mSurpriseGiftBoxArray[c]},u.prototype.getReward=function(c,p){var h,f=e.InviteAwardManager.getInstance().getInviteAwardVM();switch(c){case 0:h=4;break;case 1:h=8;break;case 2:h=16;break;case 3:h=32}for(var g=0;g<f.length;g++)if(f[g].type==h){p.diamondNum=f[g].diamonds,p.staminaNum=f[g].power,p.goldNum=f[g].coins;break}},u.prototype.cosumeSurpriseGiftInfo=function(c,p){this.mSurpriseGiftBoxArray[c].isEnable=!1,this.mSurpriseGiftBoxArray[c].hasConsume=!0,i.default.l("[RewardManager] cosumeSurpriseGiftInfo \u6D88\u8D39\u6389\u793C\u76D2\u5956\u52B1\uFF0C\u793C\u76D2\u5C06\u53D8\u4E3A\u4E0D\u53EF\u7528"),this.updateGiftBoxFileCache()},u.prototype.getCanAlsoInviteNumToday=function(){return d.ConstantConfig.INVITE_PEOPLE_MAX_NUM-this.getInviteSuccessNumToday()},u.prototype.getCalAlsoInviteNumTodayForQQRelive=function(){return d.ConstantConfig.INVITE_PEOPLE_MAX_NUM_QQ-this.getInviteSuccessNumToday()},u.prototype.getInviteSuccessNumToday=function(){return this.getInviteSuccessNumTodayWX()},u.prototype.getInviteSuccessNumTodayQQ=function(){var c=s.default.read(r.default.QQ_SHARE_RELIVE_CHECK_TIME);if(i.default.l("[reliveManger] inviteCheckTime :"+c),n.StringUtil.isEmpty(c))return s.default.save(r.default.QQ_SHARE_RELIVE_CHECK_TIME,t.MGUser.getCurrentServerTime().toString()),s.default.save(r.default.QQ_SHARE_RELIVE_SUCC_TIMES,"0"),i.default.l("[reliveManger] getInviteSuccessNumTodayQQ return : 0"),0;var p=new Date(c),h=new Date(t.MGUser.getCurrentServerTime());if(h.getFullYear()>p.getFullYear()||h.getFullYear()>=p.getFullYear()&&h.getMonth()>p.getMonth()||h.getFullYear()>=p.getFullYear()&&h.getMonth()>=p.getMonth()&&h.getDay()>p.getDay())return s.default.save(r.default.QQ_SHARE_RELIVE_CHECK_TIME,t.MGUser.getCurrentServerTime().toString()),s.default.save(r.default.QQ_SHARE_RELIVE_SUCC_TIMES,"0"),i.default.l("[reliveManger] getInviteSuccessNumTodayQQ return : 0"),0;var f=s.default.read(r.default.QQ_SHARE_RELIVE_SUCC_TIMES);return n.StringUtil.isEmpty(f)?(s.default.save(r.default.QQ_SHARE_RELIVE_SUCC_TIMES,"0"),i.default.l("[reliveManger] getInviteSuccessNumTodayQQ return : 0"),0):(i.default.l("[reliveManger] getInviteSuccessNumTodayQQ return : "+parseInt(f)),parseInt(f))},u.prototype.getInviteSuccessNumTodayWX=function(){return this.mInviteRewardInfoList.length},u.prototype.getCanAlsoHelpNumToday=function(){return this.mHelpRewardInfo.remainingHelpNum},u.prototype.getHelpSuccessNumToday=function(){return this.mHelpRewardInfo.alsoHelpNum},u.prototype.acceptInvite=function(c,p){var h=this;p&&(console.log("[RewardManager] acceptInvite \u88AB\u9080\u8BF7\u8005\u70B9\u51FB\u5206\u4EAB\u7684\u5361\u7247\u63A5\u53D7\u9080\u8BF7"),c||console.error("[RewardManager] acceptInvite \u4F20\u5165\u9080\u8BF7\u8005\u7684openid\u4E3A\u7A7A"),o.RewardRequester.reportShare(c,function(f,g){f?(g.remainingHelpNum=d.ConstantConfig.BE_INVITE_PEOPLE_MAX_NUM-g.alsoHelpNum,h.mHelpRewardInfo=g,i.default.l("[RewardManager] acceptInvite \u5E2E\u52A9\u4FE1\u606F => ",h.mHelpRewardInfo),p(g.isValid,h.mHelpRewardInfo)):(console.error("[RewardManager] acceptInvite \u7F51\u7EDC\u8BF7\u6C42\u9519\u8BEF\u4E86"),p(!1,null))},d.ConstantConfig.INVITE_PEOPLE_MAX_NUM,d.ConstantConfig.BE_INVITE_PEOPLE_MAX_NUM))},u.prototype.getInviteSuccessListComplete=function(c){var p=this;c&&(i.default.l("[RewardManager] \u4ECE\u670D\u52A1\u5668\u83B7\u53D6\u5168\u91CF\u9080\u8BF7\u6210\u529F\u5217\u8868"),o.RewardRequester.queryShare(function(h,f,g){h?(p.mInviteDate!=f&&(i.default.l("[RewardManager] \u672C\u5730\u65E5\u671F\u4E0E\u670D\u52A1\u5668\u65E5\u671F\u4E0D\u76F8\u7B49\uFF0C\u6E05\u7A7A\u672C\u5730\u7F13\u5B58\u6570\u636E => \u672C\u5730\u65E5\u671F: "+p.mInviteDate+" \u670D\u52A1\u7AEF\u8FD4\u56DE\u65E5\u671F: "+f),p.clearAllData(),p.mInviteDate=f,p.updateInviteDateFileCache(),p.updateGiftBoxFileCache(),p.updateInviteListFileCache()),c(g)):(console.error("[RewardManager] acceptInvite \u7F51\u7EDC\u8BF7\u6C42\u9519\u8BEF\u4E86"),c(null))}))},u.prototype.showRedSpot=function(){var c=0<d.ConstantConfig.INVITE_PEOPLE_MAX_NUM-this.getInviteSuccessNumToday(),p=!1;return this.mSurpriseGiftBoxArray.forEach(function(h){h.isEnable&&h.hasConsume==0&&(p=!0)}),c||p},u.prototype.getInviteeCount=function(c){var p=this;this.getInviteSuccessListComplete(function(h){h?20<=h.length?c(0):c(d.ConstantConfig.INVITE_PEOPLE_MAX_NUM-h.length):c(d.ConstantConfig.INVITE_PEOPLE_MAX_NUM-p.getInviteSuccessNumToday())})},u.prototype.parseToObject=function(c){var p=JSON.parse(c);if(p instanceof Array)return p},u.prototype.parseToString=function(c){if(c)return JSON.stringify(c)},u.SEPERATE_STR="&#&",u.sInstance=null,u}();m.RewardMgr=a,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../config/LSKey":"LSKey","../../util/StringUtil":"StringUtil","../Logic/InviteAwardManager":"InviteAwardManager","../Network/Protocol/StorageUtil":"StorageUtil","./RewardBeans":"RewardBeans","./RewardRequester":"RewardRequester"}],RewardRequester:[function(l,P,m){"use strict";cc._RF.push(P,"edad8YK/91PrJBvn3E2xOHH","RewardRequester"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./RewardBeans"),s=l("../Logic/InviteAwardManager"),r=function(){function o(){}return o.reportShare=function(e,n,t,i){cmg.platform.reportShare(e,function(a,u,c,p,h,f){if(console.log("[cmg] reportShare isValid: "+u+",msg: "+c+",count: "+p+", inviter_nickname\uFF1A"+h),a){var g=new d.HelpRewardInfo;g.alsoHelpNum=p,g.userNickName=h,g.isValid=u,g.msg=c,n(a,g)}else n(a,null)},t,i)},o.queryShare=function(e){var n=this;cmg.platform.queryShare(function(t,i,a){var u=new Array;if(console.log("[cmg] result: "+t+", invitee_date: "+i),console.log(a),t){for(var c=0;c<a.length;c++){var p=new d.InviteRewardInfo;p.userNickName=a[c].nickname,p.userAvatarUrl=a[c].avatar_url,p.beInvitedOpenId=a[c].invitee_playerid,p.isNewUser=a[c].is_new_player,p.diamondNum=n.getConfigReward(p.isNewUser),u.push(p)}e(t,i,u)}else e(t,i,null)})},o.getConfigReward=function(e){for(var n=s.InviteAwardManager.getInstance().getInviteAwardVM(),t=e?2:1,i=0;i<n.length;i++)if(n[i].type==t)return console.log("\u5956\u52B1\u94BB\u77F3\u6570\u91CF\uFF1A"+n[i].diamonds),n[i].diamonds},o}();m.RewardRequester=r,cc._RF.pop()},{"../Logic/InviteAwardManager":"InviteAwardManager","./RewardBeans":"RewardBeans"}],RobotBattleGameSceneViewImpl:[function(l,P,m){"use strict";cc._RF.push(P,"e5d2bHuXrFFrJyY3MGD+b6r","RobotBattleGameSceneViewImpl"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.prototype.showOpponentSkinTips=function(r){},s.prototype.showEnemyOfflineTips=function(r){},s.prototype.create=function(r){},s.prototype.destroy=function(){},s.prototype.updatePropertyIconPanel=function(r,o){},s.prototype.updatePropertyIconPanelSingle=function(r,o,e){},s.prototype.propertyStart=function(r,o){},s.prototype.propertyEnd=function(r,o){},s.prototype.showFog=function(r){},s.prototype.showWaittingLabel=function(r){},s.prototype.updateWaitingLabel=function(r){},s.prototype.updateHeadNodeEnergy=function(r,o){},s.prototype.updateHeadNodeFever=function(r,o,e,n){},s.prototype.showBeginningCountDownLabel=function(r){},s.prototype.updateBeginningCountDownLabel=function(r){},s.prototype.showBeginningReady=function(r,o){},s.prototype.showBeginningGo=function(r,o){},s.prototype.showPlayingCountDownLabel=function(r){},s.prototype.updatePlayingCountDownLabel=function(r){},s.prototype.showPlayingTimeup=function(r,o){},s.prototype.updateHeadNodeScoreText=function(r,o){},s.prototype.updateHeadNodeStateText=function(r,o,e){},s.prototype.showMissBackground=function(r,o){},s.prototype.updateHeadNodeComboText=function(r,o){},s.prototype.displayReleasePropertyAction=function(r,o,e,n){},s.prototype.displaySufferPropertyAction=function(r,o,e){},s.prototype.displayProtectPropertyAction=function(r,o,e){},s.prototype.displayMissingEffect=function(r,o){},s}();m.default=d,cc._RF.pop()},{}],RobotFightData:[function(l,P,m){"use strict";cc._RF.push(P,"ff391xiBUNPB4TlSUlLeGu7","RobotFightData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=l("./BaseCsvFile"),r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.findId=function(a){return this.find("id",a)},i.prototype.getRow=function(){return new e},i}(s.default);m.RobotFightData=r;var o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.findId=function(a){return this.find("id",a)},i.prototype.getRow=function(){return new n},i}(s.default);m.HardRobotData=o;var e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getID=function(){return this.getInt("id")},i.prototype.getState=function(){return this.getInt("rank_lv")},i.prototype.getRandRate=function(){return this.getFloat("percent")},i.prototype.getSpeedRange=function(){return this.getString("song_speed")},i.prototype.getSongSpeed=function(){return this.getString("miss")},i.prototype.getMissCount=function(){return this.getInt("miss_num")},i.prototype.getItemMissRate=function(){return this.getString("tools_miss")},i.prototype.getLongUnfinishRate=function(){return this.getString("long_finish")},i}(d.default);m.RobotFightRow=e;var n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getID=function(){return this.getInt("id")},i.prototype.getStateArea=function(){return this.getString("rankArea")},i.prototype.getWinNum=function(){return this.getFloat("winNum")},i.prototype.getMissRate=function(){return this.getFloat("missNro")},i.prototype.getMissLimitRate=function(){return this.getFloat("missLim")},i.prototype.getMissLongfinishRate=function(){return this.getFloat("missLong")},i.prototype.getMissItemRate=function(){return this.getFloat("missItem")},i}(d.default);m.HardRobotRow=n,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],RowNode:[function(l,P,m){"use strict";var d;cc._RF.push(P,"7c77e7BCBpNJ4Ln0ViAX4Th","RowNode"),Object.defineProperty(m,"__esModule",{value:!0}),(d=m.RowType||(m.RowType={}))[d.UNKNOW=0]="UNKNOW",d[d.INSTRUTION=1]="INSTRUTION",d[d.NORMAL=2]="NORMAL",d[d.BOMB=3]="BOMB",d[d.MIST=4]="MIST",d[d.LONGROW=5]="LONGROW",d[d.BIGBLOCK=6]="BIGBLOCK",d[d.DOUBLEBLACK=7]="DOUBLEBLACK",d[d.HEAVYTUNE=8]="HEAVYTUNE",d[d.ACCOMPNY=9]="ACCOMPNY",d[d.TILTACCOMPNY=10]="TILTACCOMPNY",d[d.FIXEDTILTACCOMPNY=11]="FIXEDTILTACCOMPNY",d[d.BOUNUS_ROW_GOLD=12]="BOUNUS_ROW_GOLD",d[d.BOUNUS_ROW_HEART=13]="BOUNUS_ROW_HEART",d[d.BOUNUS_ROW_DIAMOND=14]="BOUNUS_ROW_DIAMOND",d[d.BOUNUS_ROW_EGGS=15]="BOUNUS_ROW_EGGS",d[d.BOUNUS_ROW_NORMAL_CHEST=16]="BOUNUS_ROW_NORMAL_CHEST",d[d.BOUNUS_ROW_MUSIC_CHEST=17]="BOUNUS_ROW_MUSIC_CHEST",cc._RF.pop()},{}],SUtil:[function(l,P,m){"use strict";cc._RF.push(P,"78f48N+VT9J+oNFVqUezlna","SUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){var r=cc.director.getWinSize();this.mScreenHeight=r.height,this.mScreenWidth=r.width,this.mScreenRatio=r.height/r.width}return s.ins=function(){return this.mInstance||(this.mInstance=new s),this.mInstance},s.prototype.isQuanMian=function(){return 1.789<this.mScreenRatio&&this.mScreenRatio<19/9},s.prototype.isEqual19_9=function(){return this.mScreenRatio==19/9},s.prototype.isLiuHai=function(){return this.mScreenRatio>=19/9},s.prototype.isLiuHai4QQ=function(){return console.log("[MGB_DEBUG] mScreenRatio:"+s.ins().mScreenRatio),this.mScreenRatio>=39/19},s.prototype.isPuTong=function(){return this.mScreenRatio<=1.789},s.prototype.isShortScreen=function(){return this.mScreenRatio<=1.55},s.prototype.toRightByPx=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignRight=!0,e.right=o},s.prototype.toLeft=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignLeft=!0,e.left=o*this.mScreenWidth/100},s.prototype.toLeftByPx=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignLeft=!0,e.left=o},s.prototype.toTop=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignTop=!0,e.top=o*this.mScreenHeight/100},s.prototype.setNodeWidgetToTop=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignTop=!0,e.top=o*this.mScreenHeight/100},s.prototype.updateWidget=function(r){r.getComponent(cc.Widget).updateAlignment()},s.prototype.toTopByPx=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignTop=!0,e.top=o},s.prototype.toBottomByPx=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignBottom=!0,e.bottom=o},s.prototype.toBottomByPercent=function(r,o){var e=r.getComponent(cc.Widget);e.isAlignBottom=!0,e.bottom=o*this.mScreenHeight/100},s.prototype.toTopByPixel=function(r,o){o===void 0&&(o=0);var e=r.getComponent(cc.Widget);e.isAlignTop=!0,e.top=o},s.prototype.toTopWithOffset=function(r,o,e){e===void 0&&(e=0);var n=cc.director.getWinSize().height,t=r.getComponent(cc.Widget);t.isAlignTop=!0,t.top=o*n/100+e},s.prototype.getChlidViewPositionInScreen=function(r,o){if(!r.parent)return new cc.Vec2(0,0);var e=r.parent.convertToWorldSpaceAR(r.position);return o.convertToNodeSpaceAR(e)},s.mInstance=null,s}();m.SUtil=d,cc._RF.pop()},{}],SaveSuccessPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"ac6e00OHPFMYJUoxAAXhxo7","SaveSuccessPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.close_btn=null,i.saveTips=null,i.mCloseBtnClickCallback=null,i}return __extends(t,n),t.prototype.setCloseCallback=function(i){this.mCloseCallback=i},t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(i){i.stopPropagation()}),this.initEvent()},t.prototype.initEvent=function(){var i=this;this.mCloseBtnClickCallback=new d.default(function(){i.closeBtnClick()}),this.close_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseBtnClickCallback.click,this.mCloseBtnClickCallback)},t.prototype.start=function(){this.node.getComponent(cc.Animation).play("save_success"),this.tips&&this.tips!=""&&(this.saveTips.string=this.tips)},t.prototype.closeBtnClick=function(){this.node.destroy(),this.mCloseCallback&&this.mCloseCallback()},t.prototype.setTips=function(i){this.saveTips&&(this.saveTips.string=i),this.tips=i},__decorate([o(cc.Button)],t.prototype,"close_btn",void 0),__decorate([o(cc.Label)],t.prototype,"saveTips",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],SceneMusicMgr:[function(l,P,m){"use strict";cc._RF.push(P,"dc3c1ZIo/pAWomTo9/q9pKz","SceneMusicMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./SceneMusicUtil"),s=function(){function r(){}return r.playStarOrCrownMusic=function(o,e){var n=this,t="",i="";if(e==0)switch(o){case 0:t=n.NAME_FAIL_PAGE,i=n.PATH_FAIL_PAGE;break;case 1:t=n.NAME_PASSPAGE_ONE,i=n.PATH_PASSPAGE_ONE;break;case 2:t=n.NAME_PASSPAGE_TWO,i=n.PATH_PASSPAGE_TWO;break;case 3:t=n.NAME_PASSPAGE_THREE,i=n.PATH_PASSPAGE_THREE}else switch(e){case 1:t=n.NAME_ONE_CROWN,i=n.PATH_ONE_CROWN;break;case 2:t=n.NAME_TWO_CROWN,i=n.PATH_TWO_CROWN;break;case 3:t=n.NAME_THREE_CROWN,i=n.PATH_THREE_CROWN}t!=""&&d.default.play(t,i,1,!1,!0)},r.stopStarOrCrownMusic=function(o,e){var n="";if(e==0)switch(o){case 0:n=this.NAME_FAIL_PAGE;break;case 1:n=this.NAME_PASSPAGE_ONE;break;case 2:n=this.NAME_PASSPAGE_TWO;break;case 3:n=this.NAME_PASSPAGE_THREE}else switch(e){case 1:n=this.NAME_ONE_CROWN;break;case 2:n=this.NAME_TWO_CROWN;break;case 3:n=this.NAME_THREE_CROWN}n!=""&&this.stop(n)},r.play=function(o,e,n){d.default.play(o,e,1,n,!0)},r.stop=function(o){d.default.stop(o)},r.NAME_MOVIE_CYCLE="Movie_cycle",r.PATH_MOVIE_CYCLE="resources/music/sceneMusic/Movie_cycle.mp3",r.NAME_FAIL_PAGE="FailPage",r.PATH_FAIL_PAGE="resources/music/sceneMusic/FailPage.mp3",r.NAME_PASS_BACKGRIUND="PassBackground",r.PATH_PASS_BACKGRIUND="resources/music/sceneMusic/Pass1.mp3",r.NAME_PASSPAGE_ONE="PassPageOne",r.PATH_PASSPAGE_ONE="resources/music/sceneMusic/PassPageOne.mp3",r.NAME_PASSPAGE_TWO="PassPageTwo",r.PATH_PASSPAGE_TWO="resources/music/sceneMusic/PassPageTwo.mp3",r.NAME_PASSPAGE_THREE="PassPageThree",r.PATH_PASSPAGE_THREE="resources/music/sceneMusic/PassPageThree.mp3",r.NAME_ONE_CROWN="OneCrown",r.PATH_ONE_CROWN="resources/music/sceneMusic/OneCrown.mp3",r.NAME_TWO_CROWN="TwoCrown",r.PATH_TWO_CROWN="resources/music/sceneMusic/TwoCrown.mp3",r.NAME_THREE_CROWN="ThreeCrown",r.PATH_THREE_CROWN="resources/music/sceneMusic/ThreeCrown.mp3",r.NAME_NEW_BEST="NewBest",r.PATH_NEW_BEST="resources/music/sceneMusic/NewBest.mp3",r.NAME_SHORT="short",r.PATH_SHORT="resources/music/sceneMusic/short.mp3",r.NAME_UPGRADE_PAGE="UpgradePage",r.PATH_UPGRADE_PAGE="resources/music/sceneMusic/UpgradePage.mp3",r.NAME_BUY_DIAMOND="buyDiamond",r.PATH_BUY_DIAMOND="resources/music/sceneMusic/buyDiamond.mp3",r.NAME_BUY_LIFE="buyLife",r.PATH_BUY_LIFE="resources/music/sceneMusic/buyLife.mp3",r.NAME_BUY_GOLD="buyMoney",r.PATH_BUY_GOLD="resources/music/sceneMusic/buyMoney.mp3",r.NAME_CONSUME_LIFE="Life",r.PATH_CONSUME_LIFE="resources/music/sceneMusic/Life.mp3",r.NAME_MUSIC_LIST="Musiclist",r.PATH_MUSIC_LIST="resources/music/sceneMusic/Musiclist.mp3",r.NAME_LOTTERY_ROLLING_MOVE="RollingMove",r.PATH_LOTTERY_ROLLING_MOVE="resources/music/sceneMusic/lottery/rolling_move.mp3",r.NAME_MATCHING="MATCHING",r.PATH_MATCHING="resources/music/sceneMusic/matching.mp3",r.NAME_CUR_MUSIC="CUR_MUSIC",r.PATH_CUR_MUSIC="resources/music/sceneMusic/cur_music.mp3",r.NAME_ADD_STAR="ADD_STAR",r.PATH_ADD_STAR="resources/music/sceneMusic/add_star.mp3",r.NAME_MINS_STAR="MINS_STAR",r.PATH_MINS_STAR="resources/music/sceneMusic/mins_star.mp3",r.NAME_FIGHT_WIN="FIGHT_WIN",r.PATH_FIGHT_WIN="resources/music/sceneMusic/fight_win.mp3",r.NAME_FIGHT_LOSE="FIGHT_LOSE",r.PATH_FIGHT_LOSE="resources/music/sceneMusic/fight_lose.mp3",r.NAME_START_GO_NUMBER="start_go_1",r.PATH_START_GO_NUMBER="resources/music/sceneMusic/start_go_1.mp3",r.NAME_START_GO="start_go",r.PATH_START_GO="resources/music/sceneMusic/start_go.mp3",r.NAME_END_GO_NUMBER="end_go",r.PATH_END_GO_NUMBER="resources/music/sceneMusic/end_go.mp3",r.NAME_PROP_DROP="prop_drop",r.PATH_PROP_DROP="resources/music/sceneMusic/prop_drop.mp3",r.NAME_PROP_IN="prop_in",r.PATH_PROP_IN="resources/music/sceneMusic/prop_in.mp3",r.NAME_TIME_UP="TimeUp",r.PATH_TIME_UP="resources/music/sceneMusic/TimeUp.mp3",r.NAME_COUNT_DOWN="CountDown",r.PATH_COUNT_DOWN="resources/music/sceneMusic/CountDown.mp3",r.NAME_FANASTICAL="Fanastical",r.PATH_FANASTICAL="resources/music/sceneMusic/Fanastical.mp3",r.NAME_READY="Ready",r.PATH_READY="resources/music/sceneMusic/Ready.mp3",r}();m.default=s,cc._RF.pop()},{"./SceneMusicUtil":"SceneMusicUtil"}],SceneMusicUtil:[function(l,P,m){"use strict";cc._RF.push(P,"8a603uwR/ZJMKtr8+68rKb2","SceneMusicUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Dictionary"),s=l("../base/G"),r=l("../music/MusicPlayer"),o=l("./PU"),e=l("../music/Adapter/QQBKAudioManager"),n=function(){function i(){this.mBbtnBeats=["c2","c2","g2","g2","a2","a2","g2","f2","f2","e2","e2","d2","d2","c2"],this.mBtnBeatsIndex=0,this.mContextMap=new d.Dictionary}return i.prototype.playBtnBeats=function(){var a=s.G.Ap.sound.getInstrumentFactory().get("piano").getBeat(this.mBbtnBeats[this.mBtnBeatsIndex]);a&&(r.default.playMusicBeat(a,1,1,0),this.mBtnBeatsIndex++,this.mBtnBeatsIndex>=this.mBbtnBeats.length&&(this.mBtnBeatsIndex=0))},i.prototype.play=function(a,u,c,p,h){if(h===void 0&&(h=!1),o.default.isQQ()){var f=o.default.getResourcePath(u),g=e.default.getBKIns(h?0:1,f,p===!0?-1:0);this.mContextMap.put(a,g),g.startMusic()}else{var _=cc.url.raw(u),y=cc.audioEngine.play(_,p,c);p&&cc.audioEngine.setFinishCallback(y,function(){}),this.mContextMap.put(a,y)}},i.prototype.stop=function(a){if(cc.sys.platform===cc.sys.QQ_PLAY){var u=this.mContextMap.get(a);u&&(u.stopMusic(),this.mContextMap.remove(a))}else{var c=this.mContextMap.get(a);try{c!=null&&(cc.audioEngine.stop(c),this.mContextMap.remove(a))}catch(p){console.log("--- SceneMusicUtil stop error:---",p)}}},i}(),t=function(){function i(){}return i.playBtnBeats=function(){this.ins.playBtnBeats()},i.play=function(a,u,c,p,h){h===void 0&&(h=!1),this.ins.play(a,u,c,p,h)},i.stop=function(a){this.ins.stop(a)},i.ins=new n,i}();m.default=t,cc._RF.pop()},{"../base/G":"G","../music/Adapter/QQBKAudioManager":"QQBKAudioManager","../music/MusicPlayer":"MusicPlayer","./Dictionary":"Dictionary","./PU":"PU"}],ScoreAnimation:[function(l,P,m){"use strict";cc._RF.push(P,"7782fd5JipFb63iCUNe+AWf","ScoreAnimation"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../component/MUINumber"),s=l("../../animation/action/MScaleTo"),r=l("../../animation/action/MSequence"),o=l("../../GameBus"),e=l("../loader/NumberFrameLoader"),n=function(){function t(i,a){this.mScoreNormalScale=-1,this.mScoreMaxScale=-1,this.mNotShowScore=!1,this.mLabelAnim=null,this.mScoreDataNode=new d.default(e.default.getInstance().getAtlas(),4),this.mScoreDataNode.setCenterNumber(!0),this.mScoreDataNode.setNumberColor(d.NumberColor.RED),this.mScoreDataNode.setPositionX(i.width/2),this.mScoreDataNode.setContentSize(0,109),this.setPositionY(i.height-81),this.setScale(.78),a.addChild(this.mScoreDataNode),this.updateScale()}return t.prototype.setPositionY=function(i){this.mScoreDataNode.setPositionY(i-109)},t.prototype.setScale=function(i){this.mScoreDataNode.setScale(i),this.updateScale()},t.prototype.updateScale=function(){this.mScoreNormalScale=this.mScoreDataNode.getScale(),this.mScoreMaxScale=1.08*this.mScoreNormalScale},t.prototype.setScoreAnimationShow=function(i){this.mScoreDataNode.setVisible(i),this.mNotShowScore=!i},t.prototype.showAttainScoreAnimation=function(i){if(!this.mNotShowScore){if(this.mScoreDataNode.setVisible(!0),this.mScoreDataNode.setNumberValue(i),!this.mLabelAnim){var a=new s.default(this.mScoreMaxScale,this.mScoreMaxScale,.1),u=new s.default(this.mScoreNormalScale,this.mScoreNormalScale,.1),c=new r.default(a,u);this.mLabelAnim=c}this.mLabelAnim.getTarget()==this.mScoreDataNode||o.default.getInstance().animationMgr.runAction(this.mScoreDataNode,this.mLabelAnim)}},t}();m.default=n,cc._RF.pop()},{"../../GameBus":"GameBus","../../animation/action/MScaleTo":"MScaleTo","../../animation/action/MSequence":"MSequence","../component/MUINumber":"MUINumber","../loader/NumberFrameLoader":"NumberFrameLoader"}],ScoreManagerProxy:[function(l,P,m){"use strict";cc._RF.push(P,"190cbfhvxNPkJK2ZOMreAtr","ScoreManagerProxy"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../PlatformProxy"),s=l("../../base/Log"),r=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),o=l("../../../modules/MGUtils/TypeDefinition"),e=l("../../../modules/MGUtils/NetworkUtils"),n=l("../../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance"),t=l("../../business/keypad/KeypadUtil"),i=function(){function a(u,c,p,h){this.mPlayerId=u,this.mToken=c,this.mGameId=p,this.mIsDebug=h}return a.prototype.getLaunchOption=function(){return d.default.Ins().getLaunchParameter()},a.prototype.getPlayInfo=function(u){s.default.l("[ScoreManagerProxy]::getPlayInfo start"),r.MGUser.getUserLoginInfo({success:function(c){s.default.l("[ScoreManagerProxy].getPlayerInfo: "+c.toString()),u&&u(c.playerId,c.token,c.sid)},fail:function(){console.error("[ScoreManagerProxy] getPlayInfo error"),u&&u(null,null,0)}})},a.prototype.getUserInfo=function(u){s.default.l("[ScoreManagerProxy]::getUserInfo start"),r.MGUser.getUserBasicInfo({success:function(c){s.default.l("[ScoreManagerProxy].getUserInfo success:"+c.toString()),u&&u(!0,{language:c.language,nickName:c.nickName,avatarUrl:c.avatarUrl,gender:c.gender,country:c.country,province:c.province,city:c.city})},fail:function(){console.error("[ScoreManagerProxy] getUserInfo error"),u&&u(!1,null)}})},a.prototype.getPlayerId=function(u){s.default.l("[ScoreManagerProxy]::getPlayerId start"),r.MGUser.getUserLoginInfo({success:function(c){s.default.l("[ScoreManagerProxy].getPlayerInfo:"+c.toString()+" GameStatusInfo.openId: "+GameStatusInfo.openId),u&&u(c.sid.toString(),GameStatusInfo.openId)},fail:function(){console.error("[ScoreManagerProxy] getPlayerId error"),u&&u(null,null)}})},a.prototype.getCloudData=function(u,c,p){s.default.l("[ScoreManagerProxy]::getCloudData start"),this.getFriendCloudStorage(u,c,p)},a.prototype.reportToCM=function(u,c){n.MGCloudStorage.setStorage({kvDatas:u,complete:c})},a.prototype.getFriendCloudStorage=function(u,c,p){var h={playerid:this.mPlayerId,timestamp:new Date().getTime(),gameid:this.mGameId,id_type:"qqid",qqids:u,data:c},f=e.default.createAuthorization(h,this.mToken);s.default.isDebug()&&s.default.l("[ScoreManagerProxy] getFriendCloudStorage body: ",h),s.default.l("[ScoreManagerProxy] getFriendCloudStorage token: "+this.mToken),e.default.request({platform:o.PlatformType.PLATFORM_QQPLAY,url:this.getCloudApi(a.GET_STORAGE_BATCH_QQ),data:h,header:{Authorization:f},method:e.default.METHOD_POST,dataType:"json",success:function(g){if(g){s.default.isDebug()&&s.default.l("[ScoreManagerProxy] getFriendCloudStorage data: "+s.default.toJsonString(g));var _=g.status==0&&g.result;p&&p(!!_,_?g.result.result_items:null)}else p&&p(!1,null)},fail:function(g,_){s.default.e("[ScoreManagerProxy] getFriendCloudStorage error"),p&&p(!1,null)}})},a.prototype.getCloudApi=function(u){return t.default.isOversea()?a.SERVER_ADDRESS_URL_OVERSEA+u:this.mIsDebug?a.TEST_SERVER_ADDRESS_QQ+u:a.SERVER_ADDRESS_QQ+u},a.SERVER_ADDRESS_QQ="https://minigame.cmcm.com/",a.SERVER_ADDRESS_URL_OVERSEA="https://h5game_oversea.cmcm.com/",a.TEST_SERVER_ADDRESS_QQ="https://pianotiles-minigame.cmcm.com/",a.GET_STORAGE_BATCH_QQ="warty/storage/batch_get",a}();m.default=i,cc._RF.pop()},{"../../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance":"MGCloudStorageEntrance","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../modules/MGUtils/NetworkUtils":"NetworkUtils","../../../modules/MGUtils/TypeDefinition":"TypeDefinition","../../base/Log":"Log","../../business/keypad/KeypadUtil":"KeypadUtil","../PlatformProxy":"PlatformProxy"}],ServiceEntry:[function(l,P,m){"use strict";cc._RF.push(P,"99c2bAYJiNPaJ6naYUA2ygZ","ServiceEntry"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/runtime/ClassType"),s=l("../../util/reflection/Activator"),r=function(){function o(){this._name=null,this._service=null,this._serviceType=null,this._contractTypes=null,this._serviceBuilder=null;var e=arguments;switch(e.length){case 1:case 2:d.Type.isFunction(e[0])?this._serviceType=e[0]:(this._service=e[0],this._serviceType=d.Type.getClassType(e[0])),this._contractTypes=e[1]||null;break;case 3:this._name=e[0],d.Type.isFunction(e[1])?this._serviceType=e[1]:(this._service=e[1],this._serviceType=d.Type.getClassType(e[1])),this._contractTypes=e[2]||null}}return Object.defineProperty(o.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"serviceType",{get:function(){if(!this._serviceType){var e=this._service;e&&(this._serviceType=d.Type.getClassType(e))}return this._serviceType},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"service",{get:function(){return this._service||(this._service=this.createService()),this._service},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hasService",{get:function(){return!!this._service},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hasContracts",{get:function(){return this._contractTypes&&0<this._contractTypes.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"contractTypes",{get:function(){return this._contractTypes},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"serviceBuilder",{get:function(){return this._serviceBuilder},set:function(e){this._serviceBuilder=e},enumerable:!0,configurable:!0}),o.prototype.toString=function(){var e=d.Type.getQualifiedClassName(this.serviceType);return d.Type.isEmptyString(this.name)?e:this.name+" ("+e+")"},o.prototype.createService=function(){var e=this._serviceBuilder;if(e){var n=e.build(this);return n&&(this._serviceType=d.Type.getClassType(n)),n}var t=this._serviceType;return t?s.Activator.createInstance(t):null},o}();m.ServiceEntry=r,cc._RF.pop()},{"../../util/reflection/Activator":"Activator","../../util/runtime/ClassType":"ClassType"}],ServiceProviderFactory:[function(l,P,m){"use strict";cc._RF.push(P,"0a336CFxC9GAIhcriOHUO9U","ServiceProviderFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ServiceProvider"),s=l("../../util/runtime/ClassType"),r=l("../../util/collections/EMap"),o=function(){function e(n){n===void 0&&(n=""),this._defaultName=n,this._providers=new r.Map}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"default",{get:function(){var n=this.getProvider(this._defaultName);return n||(n=new d.ServiceProvider,this.register(this._defaultName,n)),n},set:function(n){n||console.log("Please check the arguments."),this.register(this._defaultName,n)},enumerable:!0,configurable:!0}),e.prototype.register=function(n,t){s.Type.isEmptyObject(n)&&console.log("Please check the arguments."),this._providers.set(n.trim(),t)},e.prototype.unregister=function(n){s.Type.isEmptyObject(n)&&console.log("Please check the arguments."),this._providers.delete(n.trim())},e.prototype.getProvider=function(n){return s.Type.isEmptyObject(n)&&console.log("Please check the arguments."),n=n.trim(),this._providers.has(n)?this._providers.get(n):null},e.prototype.getEnumerator=function(){return this._providers.getEnumerator()},e.prototype.forEach=function(n,t){this._providers.forEach(n,t)},e}();m.ServiceProviderFactory=o,cc._RF.pop()},{"../../util/collections/EMap":"EMap","../../util/runtime/ClassType":"ClassType","./ServiceProvider":"ServiceProvider"}],ServiceProvider:[function(l,P,m){"use strict";cc._RF.push(P,"e64d0+/p09H16waHCx6Mvgq","ServiceProvider"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ServiceStorage"),s=l("./ServiceEntry"),r=l("../../util/runtime/ClassType"),o=l("../../util/reflection/Activator"),e=l("../../util/collections/Set"),n=function(){function t(i,a){i=i||new d.ServiceStorage(this),this._storage=i,this._builder=a}return Object.defineProperty(t.prototype,"storage",{get:function(){return this._storage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"builder",{get:function(){return this._builder},enumerable:!0,configurable:!0}),t.prototype.register=function(){var i,a=arguments;switch(a.length){case 1:case 2:i=r.Type.isString(a[0])?new s.ServiceEntry(a[0],a[1],null):new s.ServiceEntry(a[0],a[1]);break;case 3:i=new s.ServiceEntry(a[0],a[1],a[2])}i||console.log("Can not register service, please check the arguments."),this._storage.add(i)},t.prototype.unregister=function(i){this._storage.remove(i)},t.prototype.resolve=function(){var i=this._storage.get(arguments[0]);return r.Type.isEmptyObject(i)?null:this.getService(i)},t.prototype.resolveAll=function(i){var a=this,u=new e.Set;return this._storage.getAll(i).forEach(function(c){u.add(a.getService(c))}),u},t.prototype.getService=function(i){if(!i)return null;var a=i.service;if(r.Type.isEmptyObject(a)){var u=this._builder;u&&(a=u.build(i))}return a||o.Activator.createInstance(i.serviceType)},t}();m.ServiceProvider=n,cc._RF.pop()},{"../../util/collections/Set":"Set","../../util/reflection/Activator":"Activator","../../util/runtime/ClassType":"ClassType","./ServiceEntry":"ServiceEntry","./ServiceStorage":"ServiceStorage"}],ServiceStorageBase:[function(l,P,m){"use strict";cc._RF.push(P,"8f379I+v81DjbWy+iLj+0zj","ServiceStorageBase"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ServiceEntry"),s=l("./ServiceProviderFactory"),r=l("../../util/runtime/ClassType"),o=l("./ServiceProvider"),e=l("../../util/collections/Set"),n=function(){function t(i){i||console.log("--- Service Storage Base no arguments---"),this._provider=i}return Object.defineProperty(t.prototype,"provider",{get:function(){return this._provider},enumerable:!0,configurable:!0}),t.prototype.add=function(){var i,a=arguments;switch(a.length){case 1:i=a[0]instanceof d.ServiceEntry?a[0]:new d.ServiceEntry(a[0],null);break;case 2:i=r.Type.isString(a[0])?new d.ServiceEntry(a[0],a[1],null):new d.ServiceEntry(a[0],a[1]);break;case 3:i=new d.ServiceEntry(a[0],a[1],a[2])}return i||console.log("Can not add service, please check the arguments."),this.insert(i),i},t.prototype.get=function(){var i=arguments,a=null;if(r.Type.isString(i[0])){a=this.findByName(i[0],new e.Set(this));var u=s.ServiceProviderFactory.instance.default;!a&&u&&u.storage!==this&&(a=this.findByName(i[0],new e.Set(u.storage))),a||(a=this.findByType(i[0],!1))}else a=this.findByType(i[0],!1);return a},t.prototype.getAll=function(i){return this.findByType(i,!0)},t.prototype.findByName=function(i,a){if(!i||!a)return null;for(var u=0;u<a.size;u++)for(var c=a.get(u).getEnumerator();c.next();){var p=c.current;if(p){if(p.name===i)return p;if(p.serviceType&&r.Type.isAssignableFrom(o.ServiceProvider,p.serviceType)){var h=p.service;h&&!a.has(h.storage)&&a.add(h.storage)}}}return null},t.prototype.findByType=function(i,a){var u=this.searchService(i,a,new e.Set(this)),c=!r.Type.isEmptyObject(u);c&&u instanceof e.Set&&u.size===0&&(c=!1);var p=s.ServiceProviderFactory.instance.default;return!c&&p&&p.storage!==this&&(u=this.searchService(i,a,new e.Set(p.storage))),u},t.prototype.searchService=function(i,a,u){if(!i||!u)return null;for(var c=new e.Set,p=new e.Set,h=0;h<u.size;h++){for(var f=u.get(h).getEnumerator();f.next();){var g=f.current;if(g&&g.serviceType){if(g.hasContracts)if(r.Type.isFunction(i)&&g.contractTypes.indexOf(i)!==-1){if(!a)return g;p.add(g)}else for(var _=0,y=g.contractTypes;_<y.length;_++){var S=y[_];r.Type.isAssignableFrom(i,S)&&c.add(g)}else if(r.Type.isFunction(i)&&g.serviceType===i){if(!a)return g;p.add(g)}else r.Type.isAssignableFrom(i,g.serviceType)&&c.add(g);if(!a){if(0<c.size)break;if(g.serviceType&&r.Type.isAssignableFrom(o.ServiceProvider,g.serviceType)){var I=g.service;I&&!u.has(I.storage)&&u.add(I.storage)}}}}if(a)return p.union(c);if(0<c.size)return c.get(0)}return null},t}();m.ServiceStorageBase=n,cc._RF.pop()},{"../../util/collections/Set":"Set","../../util/runtime/ClassType":"ClassType","./ServiceEntry":"ServiceEntry","./ServiceProvider":"ServiceProvider","./ServiceProviderFactory":"ServiceProviderFactory"}],ServiceStorage:[function(l,P,m){"use strict";cc._RF.push(P,"2691aB5UC5Hwb2d3CaOl+Da","ServiceStorage"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ServiceStorageBase"),s=l("../../util/runtime/ClassType"),r=l("../../util/collections/Set"),o=l("../../util/collections/EMap"),e=function(n){function t(i){var a=n.call(this,i)||this;return a._entries=new r.Set,a._namedEntries=new o.Map,a}return __extends(t,n),Object.defineProperty(t.prototype,"size",{get:function(){return this._entries.size},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._entries.clear(),this._namedEntries.clear()},t.prototype.remove=function(i){if(!i)return null;var a=null;return this._namedEntries.has(i)&&(a=this._namedEntries.get(i),this._entries.delete(a),this._namedEntries.delete(i)),a},t.prototype.get=function(){var i=arguments;return s.Type.isString(i[0])&&this._namedEntries.has(i[0])?this._namedEntries.get(i[0]):n.prototype.get.call(this,i[0])},t.prototype.getEnumerator=function(){return this._entries.getEnumerator()},t.prototype.forEach=function(i,a){this._entries.forEach(i,a)},t.prototype.insert=function(i){i||console.log("Please check the arguments."),i.name&&this._namedEntries.set(i.name,i),this._entries.add(i)},t}(d.ServiceStorageBase);m.ServiceStorage=e,cc._RF.pop()},{"../../util/collections/EMap":"EMap","../../util/collections/Set":"Set","../../util/runtime/ClassType":"ClassType","./ServiceStorageBase":"ServiceStorageBase"}],Set:[function(l,P,m){"use strict";cc._RF.push(P,"de6c5ydsf1IkKi8c12aLtkk","Set"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Enumerator"),s=function(){function r(){for(var o,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._values=[],(o=this._values).push.apply(o,e)}return Object.defineProperty(r.prototype,"size",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),r.prototype.add=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];for(var n=0,t=o;n<t.length;n++){var i=t[n];this.has(i)||this._values.push(i)}return this},r.prototype.get=function(o){return this._values[o]},r.prototype.set=function(o,e){var n=this._values;0<=o&&o<n.length&&(this.has(e)||(n[o]=e))},r.prototype.delete=function(o){var e=this._values,n=e.indexOf(o);return n!==-1&&(e.splice(n,1),!0)},r.prototype.deleteAt=function(o){var e=this._values;0<=o&&o<e.length&&e.splice(o,1)},r.prototype.clear=function(){this._values.length=0},r.prototype.indexOf=function(o,e){return this._values.indexOf(o,e)},r.prototype.has=function(o){return this._values.indexOf(o)!==-1},r.prototype.getEnumerator=function(){return new d.Enumerator(this._values)},r.prototype.forEach=function(){for(var o=this._values,e=arguments[0],n=arguments[1],t=e.length===2,i=0,a=o.length;i<a;i++)t?e.call(n,o[i],this):e.call(n,o[i],i,this)},r.prototype.find=function(o,e){for(var n=this._values,t=0,i=n.length;t<i;t++)if(o.call(e,n[t],t,this))return n[t]},r.prototype.sort=function(o){var e=this._values;this._values=e.sort(o)},r.prototype.union=function(o){var e=o.values();return 0<e.length&&this.add.apply(this,e),this},r.prototype.values=function(){return this._values.concat()},r.prototype.toString=function(){return Array.prototype.toString.call(this._values)},r}();m.Set=s,cc._RF.pop()},{"./Enumerator":"Enumerator"}],ShareHelper:[function(l,P,m){"use strict";cc._RF.push(P,"d1348t6v4JO9YBF7whfSVX6","ShareHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ShareImageUtils"),s=l("../../../scripts/util/StringUtil"),r=l("../../MGUser/scripts/Logic/MGUserEntrance"),o=function(){function e(){}return e.getDefaultShareType=function(){var n=Math.ceil(3*Math.random());return n==0?1:n},e.getDefaultShareData=function(n){var t=e.getDefaultShareType();new d.default().getShareImage(t,function(i,a){var u;i&&(t==1?r.MGUser.getUserBasicInfo({complete:function(c){u=c&&!s.StringUtil.isNullOrUndefined(c.nickName)?s.StringUtil.getFixedlengthStr(c.nickName,12)+":"+e.SHARE_TITLE_WX_DEFAULT_ONE:e.SHARE_TITLE_WX_DEFAULT_ONE,n(t,u,a)}}):t==2?r.MGUser.getUserBasicInfo({complete:function(c){u=c&&!s.StringUtil.isNullOrUndefined(c.nickName)?"\u3010"+s.StringUtil.getFixedlengthStr(c.nickName,12)+e.SHARE_TITLE_WX_DEFAULT_TWO:"\u3010\u6709\u4EBA"+e.SHARE_TITLE_WX_DEFAULT_TWO,n(t,u,a)}}):t==3&&r.MGUser.getUserBasicInfo({complete:function(c){u=c&&!s.StringUtil.isNullOrUndefined(c.nickName)?s.StringUtil.getFixedlengthStr(c.nickName,12)+"\uFF1A"+e.SHARE_TITLE_WX_DEFAULT_THREE:e.SHARE_TITLE_WX_DEFAULT_THREE,n(t,u,a)}}))})},e.SHARE_TITLE_HOT_SONG="\u300A%s\u300B\u94A2\u7434\u66F2\u7ADF\u8FD9\u4E48\u597D\u542C\uFF0C\u6C42\u5927\u5BB6\u5E2E\u6211\u89E3\u9501\uFF01",e.SHARE_TITLE_CHALLENGE_TIMES=" \u548C\u6211\u4E00\u8D77\u53C2\u52A0\u300AmusicName\u300B\u64C2\u53F0\u8D5B\uFF0C\u6BD4\u6BD4\u8C01\u66F4\u5389\u5BB3\uFF01",e.SHARE_TITLE_CHALLENGE_TIMES_B=" \u90013\u5F20\u64C2\u53F0\u8D5B\u95E8\u7968\uFF0C\u5148\u70B9\u5148\u5F97\uFF0C\u62A2\u5B8C\u4E3A\u6B62\uFF01",e.SHARE_TITLE_SKIN="\u8FD9\u6B3E\u76AE\u80A4\u6211\u771F\u7684\u597D\u60F3\u8981\uFF0C\u6C42\u5927\u5BB6\u5E2E\u5FD9\u70B9\u4E00\u4E0B",e.SHARE_TITLE_SINGLE_SEE_ALL="\u73A9\u5230\u8EAB\u4F53\u88AB\u638F\u7A7A\uFF0C\u770B\u770B\u300A%s\u300B\u4F60\u80FD\u5F97\u7B2C\u51E0\uFF1F",e.SHARE_TITLE_TOTAL_SEE_ALL="\u672C\u7FA4\u6210\u5C31\u699C\u5728\u6B64\uFF0C\u770B\u770B\u4F60\u80FD\u6392\u7B2C\u51E0",e.SHARE_TITLE_FIGHT_INVITE_FRIEND="\u623F\u95F4\u5F00\u597D\u4E86\uFF0C\u5FEB\u6765\u548C\u6211\u5B9E\u65F6\u5BF9\u6218\u5427\uFF01",e.SHARE_TITLE_FRIEND_FIGHT_SHOW_OFF="\u8F7B\u677E\u6218\u80DC %s\uFF0C\u4F60\u4E0D\u670D\uFF1F\u4F60\u4E0A\u554A",e.SHATR_TITLE_SKIN_PIECE="\u65B0\u76AE\u80A4\u597D\u597D\u770B\uFF0C\u5E2E\u6211\u70B9\u4E0B\u6211\u5C31\u80FD\u83B7\u5F97\u5B83\u5566",e.SHARE_TITLE_ADD_FRIEND="%s\u8BF7\u6C42\u6DFB\u52A0\u60A8\u4E3A\u597D\u53CB\uFF0C\u4E00\u8D77\u6765\u5F39\u7434\u5427",e.SHARE_TITLE_FOR_TONE="\u9650\u65F6\u9886\u53D6\u5168\u65B0\u94A2\u7434\u97F3\u8272\uFF0C\u903E\u65F6\u4E0D\u5019\u54E6",e.SHARE_TITLE_WX_DEFAULT_ONE="\u53EA\u89811\u5206\u949F\uFF0C\u4F60\u5C31\u4F1A\u8DDF\u6211\u4E00\u6837\uFF0C\u7231\u4E0A\u4ECB\u6B3E\u6E38\u620F\uFF01",e.SHARE_TITLE_WX_DEFAULT_TWO="@\u4F60\u3011\u5168\u74039\u4EBF\u4EBA\u90FD\u5728\u73A9\u7684\u94A2\u7434\u6E38\u620F\uFF0C\u70B9\u5F00\u5373\u73A9\uFF01",e.SHARE_TITLE_WX_DEFAULT_THREE="\u6709\u672C\u4E8B\u5C31\u6765\u300A\u94A2\u7434\u57572\u300B\u8DDF\u6211\u4E00\u51B3\u9AD8\u4E0B",e.SHARE_TITLE_WX_RANK_TOTAL_SHOW_OFF="\u6E23\u6E23\u9000\u4E0B\uFF0C\u8BA9\u4F60\u4EEC\u89C1\u8BC6\u4E00\u4E0B\u9006\u5929\u624B\u901F\uFF0C\u4E0D\u670D\u6765\u6218",e.SHARE_TITLE_WX_RESULT_SPEC_POPUP="\u60F3\u8D85\u8FC7\u6211\u662F\u4E0D\u53EF\u80FD\u7684\uFF0C\u8FD9\u8F88\u5B50\u90FD\u4E0D\u53EF\u80FD\u7684",e.SHARE_TITLE_WX_RELIVE="\u7D27\u6025\u6C42\u52A9\uFF01\u518D\u4E0D\u5E2E\u6211\u70B9\u5361\u7247\u6211\u5C31\u6CA1\u673A\u4F1A\u590D\u6D3B\u5566\uFF01",e.SHARE_TITLEB_WX_SHARE_FOR_GIFT="\u7EA2\u5305\uFF01\u7EA2\u5305\uFF01\u9001\u4F60\u94BB\u77F3\u5927\u7EA2\u5305\uFF0C\u5148\u70B9\u5148\u5F97\uFF0C\u62A2\u5B8C\u4E3A\u6B62\uFF01",e.SHARE_TITLE_WX_FIGHT_WIN1="\u7EC8\u65E5\u6C89\u8FF7\u6392\u4F4D\u8D5B\uFF0C\u5982\u4ECA\u624B\u901F\u5FEB\u8FC7\u674E\u5C0F\u9F99",e.SHARE_TITLE_WX_FIGHT_WIN2="\u4E0D\u5439\u4E0D\u9ED1\uFF0C\u8FD9\u6E38\u620F\u7684\u7EDD\u4E16\u5F3A\u8005,\u5C31\u662F\u6211",e.SHARE_TITLE_WX_FIGHT_WIN0="\u7EC8\u7ED3\u5BF9\u624B%s\u8FDE\u80DC!\u6392\u4F4D\u8D5B\u9047\u5230\u6211\u4F60\u8F93\u5B9A\u4E86",e.SHARE_TITLE_QQ_RELIVE="\u8FD9\u6E38\u620F\u592A\u96BE\u4E86\uFF01\u4F60\u884C\u4F60\u4E0A\u554A\uFF01",e.SHARE_TITLE_QQ_SHARE_FOR_GIFT="\u7EA2\u5305\uFF01\u7EA2\u5305\uFF01\u9001\u4F60\u94BB\u77F3\u5927\u7EA2\u5305\uFF01\u6570\u91CF\u6709\u9650\uFF0C\u624B\u6162\u65E0~",e.SHARE_TITLE_QQ_RESULT_SHOW_OFF="\u8F7B\u677E\u8D85\u8FC7\u4F60\uFF0C\u4E0D\u670D\u6765\u6311\u6218\u6211\u5440\uFF01",e.SHARE_TITLE_QQ_RESULT_SINGLE_CHAMP_AND_NEW_RECORD="\u7ED9\u4F60\u4E2A\u8D85\u8FC7\u6211\u7684\u673A\u4F1A\uFF0C\u6709\u79CD\u8FDB\u6765\u5355\u6311\uFF01",e.SHARE_TITLE_QQ_RANK_SINGLE_SHOW_OFF="\u6211\u5C31\u95EE\u4E00\u53E5\uFF0C\u8FD8\u6709\u8C01\uFF1F\uFF1F\uFF1F",e.SHARE_TITLE_QQ_RANK_TOTAL_SHOW_OFF="\u60F3\u8D85\u8FC7\u6211\u662F\u4E0D\u53EF\u80FD\u7684\uFF0C\u8FD9\u8F88\u5B50\u90FD\u4E0D\u53EF\u80FD\u7684",e.SHARE_TITLE_QQ_BATTLE_FRIEND="\u65E0\u654C\u662F\u591A\u4E48\u5BC2\u5BDE\uFF01\u6C42\u6311\u6218\u6C42\u8D85\u8D8A\uFF01",e.SHARE_SOURCE_SHOW_OFF=1,e.SHARE_SOURCE_BATTLE_FRIEND=2,e.SHARE_SOURCE_ACHIEVEMENT_SHOW_SELF=3,e.SHARE_SOURCE_ACHIEVEMENT_SHOW_GROUP=4,e.SHARE_SOURCE_SINGLE_SHOW_GROUP=5,e.SHARE_SOURCE_RELIVE=6,e.SHARE_SOURCE_INVITE_FRIEND=7,e.SHARE_SOURCE_GAIN_ENERGY=8,e.SHARE_SOURCE_GAIN_DIAMOND=9,e.SHARE_SOURCE_INIT=10,e.SHARE_SOURCE_INVITE_SKIN=15,e.SHARE_SOURCE_INVITE_SONG=16,e.SHARE_SOURCE_SING_SHOW_OFF=17,e.SHARE_SOURCE_INVITE_CHALLENGE_TIMES=18,e.SHARE_SOURCE_CHALLENGE_SHOW_OFF=19,e.SHARE_SOURCE_FIGHT_WIN=20,e.SHARE_SOURCE_FIGHT_INVITE_FRIEND=21,e.SHARE_SOURCE_FRIEND_FIGHT_SHOW_OFF=22,e.SHARE_SOURCE_SKIN_PIECE=23,e.SHARE_SOURCE_ADD_FRIEND=24,e.SHARE_SOURCE_TONE=25,e}();m.ShareHelper=o,cc._RF.pop()},{"../../../scripts/util/StringUtil":"StringUtil","../../MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","./ShareImageUtils":"ShareImageUtils"}],ShareImageUtils:[function(l,P,m){"use strict";cc._RF.push(P,"92500ub2BxB0b5FCqbRbHuM","ShareImageUtils"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../scripts/util/PU"),s=l("../../../scripts/LogicPlatform/PlatformProxy"),r=l("../../MGUser/scripts/Logic/MGUserEntrance"),o=l("./ShareImage"),e=l("../../../scripts/base/Log"),n=l("../../../scripts/business/keypad/KeypadUtil"),t=function(){function i(){}return i.prototype.getDefaultShare=function(){return{image1:{src:d.default.getResourcePath("resources/share/share_default1.jpg")},image2:{src:d.default.getResourcePath("resources/share/share_default2.jpg")},image3:{src:d.default.getResourcePath("resources/share/share_default3.jpg")}}},i.prototype.getToGroupSeeAllAchievement=function(){return{image:{src:d.default.getResourcePath("resources/share/share_banner1.png")}}},i.prototype.getQiuChaoYue=function(){return{image:{src:d.default.getResourcePath("resources/share/qiu_chao_yue.png"),srcB:d.default.getResourcePath("resources/share/qiu_chao_yue_B.png"),width:404,height:322},title:{font:"24px Arial",fillStyle:"rgb(255,255,255)",top:142,str:"",textAlign:"center",textBaseline:"top"},scoreNum:{font:"46px Arial",fillStyle:"rgb(255,255,255)",top:195,str:"",spaceH:4,textAlign:"left",textBaseline:"top"},scoreStr:{font:"26px Arial",fillStyle:"rgb(255,255,255)",top:210,str:"\u5206",textAlign:"left",textBaseline:"top"}}},i.prototype.getJimo=function(){return{image:{src:d.default.getResourcePath("resources/share/jimo.png"),width:404,height:322},title:{font:"18px Arial",fillStyle:"rgb(255,255,255)",top:190,str:"",textAlign:"center",textBaseline:"top"},crownCount:{font:"36px Arial",fillStyle:"rgb(255,255,255)",top:251,left:140,str:"",textAlign:"center",textBaseline:"top"},starCount:{font:"36px Arial",fillStyle:"rgb(255,255,255)",top:251,left:299,str:"",textAlign:"center",textBaseline:"top"},circleAvatar:{src:"",width:70,height:70,top:110},circleAvatarMask:{src:d.default.getResourcePath("resources/share/head.png"),width:78,height:78,top:106}}},i.prototype.getQunPaiHang=function(){return{image:{src:d.default.getResourcePath("resources/share/share_banner2.png")}}},i.prototype.getReliveFdHelp=function(){return{image:{srcB:d.default.getResourcePath("resources/share/share_fd_help_B.png")}}},i.prototype.getShareForReward=function(){return{image:{srcB:d.default.getResourcePath("resources/share/share_for_reward_B.png")}}},i.prototype.getShareForNewRecordFds=function(){return{image:{src:d.default.getResourcePath("resources/share/new_record_share.png"),width:720,height:1280},musicName:{font:"32px Arial",fillStyle:"rgb(255,255,255)",top:350,str:"",textAlign:"center",textBaseline:"top"},scoreNum:{src:"resources/share/score_",score:100,width:50,height:118,top:462,spaceH:10},scoreImage:{src:d.default.getResourcePath("resources/share/score.png"),width:58,height:58,top:522},circleAvatar:{src:"",width:176,height:176,top:132,left:273},circleAvatarMask:{src:d.default.getResourcePath("resources/share/head_gold.png"),width:270,height:270,top:70,left:210}}},i.prototype.getShareGiftFds=function(){return{image:{src:d.default.getResourcePath("resources/share/share_gift_fds.png"),width:720,height:1280},codeImage:{src:"",width:210,height:210,top:735,left:255}}},i.prototype.getShareForHotSong=function(){return{image:{src:d.default.getResourcePath("resources/share/share_for_hot_song.png")}}},i.prototype.getShareForSkin=function(){return{image:{src:d.default.getResourcePath("resources/share/share_for_skin.png")}}},i.prototype.getShareForChallenge=function(){return{image:{src:d.default.getResourcePath("resources/share/share_for_challenge_invite.png"),srcB:d.default.getResourcePath("resources/share/share_for_challenge_invite_B.png")}}},i.prototype.getChallengeShowOff=function(){return{image:{src:d.default.getResourcePath("resources/share/share_challenge_show_off.png"),width:404,height:322},title:{font:"18px Arial",fillStyle:"rgb(255,255,255)",top:118,str:"",textAlign:"center",textBaseline:"top"},scoreNum:{font:"46px Arial",fillStyle:"rgb(255,255,255)",top:154,str:"",spaceH:4,textAlign:"left",textBaseline:"top"},scoreStr:{font:"26px Arial",fillStyle:"rgb(255,255,255)",top:171,str:"\u5206",textAlign:"left",textBaseline:"top"},rank:{font:"20px Arial",fillStyle:"rgb(255,255,48)",top:49,startX:52,str:"",textAlign:"center",textBaseline:"top"}}},i.prototype.getFightWin=function(){return{image:{src1:d.default.getResourcePath("resources/share/fight_win_1.png"),src2:d.default.getResourcePath("resources/share/fight_win_2.png"),width:404,height:322},winStr1:{src:d.default.getResourcePath("resources/share/fight_win_str_1.png"),width:99,height:36,top:20},winStr2:{src:d.default.getResourcePath("resources/share/fight_win_str_2.png"),width:78,height:36,top:20},winNum:{src:"resources/share/num_",win:6,width:33,height:44,top:14,spaceH:2},badgeBig:{top:65},badge:{width:143,height:37,top:204,left:130}}},i.prototype.getShareForFriendFightInvite=function(){return{image:{src:d.default.getResourcePath("resources/share/friend_fight_invite.png")}}},i.prototype.getShareForFriendFightShowOff=function(){return{image:{src:d.default.getResourcePath("resources/share/friend_fight_show_off.png"),width:404,height:322},selfAvator:{src:"",top:89,left:60,width:117,height:117},fighterAvator:{src:"",top:106,left:282,width:90,height:90},selfScore:{font:"40px Adobe Heiti Std R",fillStyle:"rgb(255,252,1)",top:230,startX:119,str:"",textAlign:"center",textBaseline:"top"},fighterScore:{font:"30px Adobe Heiti Std R",fillStyle:"rgb(220,207,243)",top:216,startX:327,str:"",textAlign:"center",textBaseline:"top"}}},i.prototype.getShareForQQGame=function(){return{image:{src:"https://piano-weixin-game.cmcm.com/pianotiles2/res/qq_game_image.jpg"}}},i.prototype.getShareForQQRedPacket=function(){return{image:{src:"https://gamecdn.cmcm.com/cn/piano_tiles2/wx/imgs/redpacket_qqgame.png"}}},i.prototype.getShareForFightInvite=function(){return{image:{src:d.default.getResourcePath("resources/share/share_for_challenge_invite.png")}}},i.prototype.getShareForSKinPiece=function(){return{image:{src:d.default.getResourcePath("resources/share/share_piece_unlock_skin_%s.png")}}},i.prototype.getShareForAddFriend=function(){return{image:{src:d.default.getResourcePath("resources/share/share_for_add_friend.png")}}},i.prototype.getShareForTone=function(){return{image:{src:d.default.getResourcePath("resources/share/share_for_charistmas.png")}}},i.prototype.setQiuChaoYueData=function(a,u){this.qiuChaoYue=this.getQiuChaoYue(),this.qiuChaoYue.title.str=u,this.qiuChaoYue.scoreNum.str=a+""},i.prototype.setJiMoData=function(a,u,c,p){this.jiMo=this.getJimo(),this.jiMo.circleAvatar.src=a,this.jiMo.title.str=u,this.jiMo.crownCount.str=c+"",this.jiMo.starCount.str=p+""},i.prototype.setNewRecordShareFds=function(a,u,c){this.shareForNewRecordFds=this.getShareForNewRecordFds(),this.shareForNewRecordFds.circleAvatar.src=a,this.shareForNewRecordFds.musicName.str=u,this.shareForNewRecordFds.scoreNum.score=c},i.prototype.setChallengeShowOff=function(a,u,c){this.challengeShowOff=this.getChallengeShowOff(),this.challengeShowOff.title.str=a,this.challengeShowOff.scoreNum.str=u+"";var p="";c<=99999?p=c+"":p=10*Math.floor(c/1e5)+"\u4E07+",this.challengeShowOff.rank.str=p},i.prototype.setShareImageFds=function(a){this.shareGiftFds=this.getShareGiftFds(),this.shareGiftFds.codeImage.src=a},i.prototype.getShareImage=function(a,u,c){var p=s.default.Ins().createCanvas();switch(console.log("getSahreImage info type = "+a),a){case o.ShareImage.TYPE_WX_DEFAULT_ONE:this.defaultShare||(this.defaultShare=this.getDefaultShare()),u(!0,this.defaultShare.image1.src);break;case o.ShareImage.TYPE_WX_DEFAULT_TWO:this.defaultShare||(this.defaultShare=this.getDefaultShare()),u(!0,this.defaultShare.image2.src);break;case o.ShareImage.TYPE_WX_DEFAULT_THREE:this.defaultShare||(this.defaultShare=this.getDefaultShare()),u(!0,this.defaultShare.image3.src);break;case o.ShareImage.TYPE_QIU_CHAO_YUE:case o.ShareImage.TYPE_QIU_CHAO_YUE_B:this.qiuChaoYue||(this.qiuChaoYue=this.getQiuChaoYue()),this.getQiuChaoYueImage(a,p,u);break;case o.ShareImage.TYPE_JI_MO:this.jiMo||(this.jiMo=this.getJimo()),this.getJiMoImage(p,u);break;case o.ShareImage.TYPE_QUN_PAI_HANG:this.qunPaiHang||(this.qunPaiHang=this.getQunPaiHang()),u(!0,this.qunPaiHang.image.src);break;case o.ShareImage.TYPE_TO_GROUP_ACHIEVEMENT:this.toGroupSeeAllAchievement||(this.toGroupSeeAllAchievement=this.getToGroupSeeAllAchievement()),u(!0,this.toGroupSeeAllAchievement.image.src);break;case o.ShareImage.TYPE_RELIVE_FD_HELP_B:this.reliveFdHelp||(this.reliveFdHelp=this.getReliveFdHelp()),u(!0,this.reliveFdHelp.image.srcB);break;case o.ShareImage.TYPE_SHARE_FOR_REWARD_B:this.shareForReward||(this.shareForReward=this.getShareForReward()),u(!0,this.shareForReward.image.srcB);break;case o.ShareImage.TYPE_SHARE_NEW_RECORD_FDS:this.shareForNewRecordFds||(this.shareForNewRecordFds=this.getShareForNewRecordFds()),this.getNewRecordShareFdsImage(p,u);break;case o.ShareImage.TYPE_SHARE_GIFT_FDS:this.shareGiftFds||(this.shareGiftFds=this.getShareGiftFds()),this.getShareGiftImage(p,u);break;case o.ShareImage.TYPE_SHARE_INVITE_SKIN:this.shareForSkin||(this.shareForSkin=this.getShareForSkin()),u(!0,this.shareForSkin.image.src);break;case o.ShareImage.TYPE_SHARE_INVITE_SONG:this.shareForHotSong||(this.shareForHotSong=this.getShareForHotSong()),u(!0,this.shareForHotSong.image.src);break;case o.ShareImage.TYPE_SHARE_INVITE_CHALLENGE_TIMES:this.shareForChallenge||(this.shareForChallenge=this.getShareForChallenge()),u(!0,this.shareForChallenge.image.src);break;case o.ShareImage.TYPE_SHARE_INVITE_CHALLENGE_TIMES_B:this.shareForChallenge||(this.shareForChallenge=this.getShareForChallenge()),u(!0,this.shareForChallenge.image.srcB);break;case o.ShareImage.TYPE_SHARE_CHALLENGE_SHOW_OFF:this.challengeShowOff||(this.challengeShowOff=this.getChallengeShowOff()),this.getChallengeShowOffImage(p,u);break;case o.ShareImage.TYPE_SHARE_QQ_GAME:this.shareForQQGame||(this.shareForQQGame=this.getShareForQQGame()),u(!0,this.shareForQQGame.image.src);break;case o.ShareImage.TYPE_SHARE_QQ_RED_PACKET_ACTIVITY:this.shareForQQRedPacket||(this.shareForQQRedPacket=this.getShareForQQRedPacket()),u(!0,this.shareForQQRedPacket.image.src);break;case o.ShareImage.TYPE_SHARE_FIGHT_INVITE_FRIEND:this.shareForFriendFightInvite||(this.shareForFriendFightInvite=this.getShareForFriendFightInvite()),u(!0,this.shareForFriendFightInvite.image.src);break;case o.ShareImage.TYPE_SHARE_SKIN_PIECE:this.shareForSkinPiece||(this.shareForSkinPiece=this.getShareForSKinPiece()),this.getSKinPieceImage(p,c,u);break;case o.ShareImage.TYPE_SHARE_ADD_FRIEND:this.shareForAddFriend||(this.shareForAddFriend=this.getShareForAddFriend()),u(!0,this.shareForAddFriend.image.src);break;case o.ShareImage.TYPE_SHARE_TONE:this.shareForTone||(this.shareForTone=this.getShareForTone()),u(!0,this.shareForTone.image.src)}},i.prototype.getSKinPieceImage=function(a,u,c){if(u){var p=u?u.skinName:"";c(!0,cc.js.formatStr(this.shareForSkinPiece.image.src,p))}else c(!1,"")},i.prototype.getQiuChaoYueImage=function(a,u,c){var p=this;u.width=this.qiuChaoYue.image.width,u.height=this.qiuChaoYue.image.height;var h=u.getContext("2d",null);h.clearRect(0,0,u.width,u.height),h.imageSmoothingEnabled=!0,h.mozImageSmoothingEnabled=!0;var f=s.default.Ins().createImage();a==o.ShareImage.TYPE_QIU_CHAO_YUE?f.src=this.qiuChaoYue.image.src:f.src=this.qiuChaoYue.image.srcB,f.onload=function(){h.drawImage(s.default.Ins().getImageSrc(f),0,0,p.qiuChaoYue.image.width,p.qiuChaoYue.image.height),h.font=p.qiuChaoYue.title.font,h.fillStyle=p.qiuChaoYue.title.fillStyle;var g=u.width/2;h.textAlign=p.qiuChaoYue.title.textAlign,h.textBaseline=p.qiuChaoYue.title.textBaseline,h.fillText(p.qiuChaoYue.title.str,g,p.qiuChaoYue.title.top),h.font=p.qiuChaoYue.scoreNum.font,h.fillStyle=p.qiuChaoYue.scoreNum.fillStyle,h.textAlign=p.qiuChaoYue.scoreNum.textAlign,h.textBaseline=p.qiuChaoYue.scoreNum.textBaseline;var _=h.measureText(p.qiuChaoYue.scoreNum.str).width;h.font=p.qiuChaoYue.scoreStr.font,h.fillStyle=p.qiuChaoYue.scoreStr.fillStyle,h.textAlign=p.qiuChaoYue.scoreStr.textAlign,h.textBaseline=p.qiuChaoYue.scoreStr.textBaseline;var y=h.measureText(p.qiuChaoYue.scoreStr.str).width,S=(u.width-_-y-p.qiuChaoYue.scoreNum.spaceH)/2;h.font=p.qiuChaoYue.scoreNum.font,h.fillStyle=p.qiuChaoYue.scoreNum.fillStyle,h.textAlign=p.qiuChaoYue.scoreNum.textAlign,h.textBaseline=p.qiuChaoYue.scoreNum.textBaseline,h.fillText(p.qiuChaoYue.scoreNum.str,S,p.qiuChaoYue.scoreNum.top);var I=S+_+p.qiuChaoYue.scoreNum.spaceH;h.font=p.qiuChaoYue.scoreStr.font,h.fillStyle=p.qiuChaoYue.scoreStr.fillStyle,h.textAlign=p.qiuChaoYue.scoreStr.textAlign,h.textBaseline=p.qiuChaoYue.scoreStr.textBaseline,h.fillText(p.qiuChaoYue.scoreStr.str,I,p.qiuChaoYue.scoreStr.top);var v=p.saveImageFileSync(u);c(!0,v)},s.default.Ins().loadImage(f)},i.prototype.getJiMoImage=function(a,u){var c=this;a.width=this.jiMo.image.width,a.height=this.jiMo.image.height;var p=a.getContext("2d",null);p.clearRect(0,0,a.width,a.height),p.imageSmoothingEnabled=!0,p.mozImageSmoothingEnabled=!0;var h=s.default.Ins().createImage();h.src=this.jiMo.image.src,h.onload=function(){p.drawImage(s.default.Ins().getImageSrc(h),0,0,c.jiMo.image.width,c.jiMo.image.height),p.font=c.jiMo.title.font,p.fillStyle=c.jiMo.title.fillStyle;var f=a.width/2;p.textAlign=c.jiMo.title.textAlign,p.textBaseline=c.jiMo.title.textBaseline,p.fillText(c.jiMo.title.str,f,c.jiMo.title.top),p.font=c.jiMo.crownCount.font,p.fillStyle=c.jiMo.crownCount.fillStyle,p.textAlign=c.jiMo.crownCount.textAlign,p.textBaseline=c.jiMo.crownCount.textBaseline,p.fillText(c.jiMo.crownCount.str,c.jiMo.crownCount.left,c.jiMo.crownCount.top),p.font=c.jiMo.starCount.font,p.fillStyle=c.jiMo.starCount.fillStyle,p.textAlign=c.jiMo.starCount.textAlign,p.textBaseline=c.jiMo.starCount.textBaseline,p.fillText(c.jiMo.starCount.str,c.jiMo.starCount.left,c.jiMo.starCount.top);var g=s.default.Ins().createImage();g.src=c.jiMo.circleAvatar.src,g.onload=function(){var _=a.width/2,y=c.jiMo.circleAvatar.top+c.jiMo.circleAvatar.width/2;p.beginPath(),p.arc(_,y,c.jiMo.circleAvatar.width/2,0,2*Math.PI),p.closePath(),p.save(),p.clip(),p.drawImage(s.default.Ins().getImageSrc(g),_-c.jiMo.circleAvatar.width/2,c.jiMo.circleAvatar.top,c.jiMo.circleAvatar.width,c.jiMo.circleAvatar.width),p.restore();var S=s.default.Ins().createImage();S.src=c.jiMo.circleAvatarMask.src,S.onload=function(){p.drawImage(s.default.Ins().getImageSrc(S),_-c.jiMo.circleAvatarMask.width/2,c.jiMo.circleAvatarMask.top,c.jiMo.circleAvatarMask.width,c.jiMo.circleAvatarMask.height);var I=c.saveImageFileSync(a);u(!0,I)},s.default.Ins().loadImage(S)},s.default.Ins().loadImage(g)},s.default.Ins().loadImage(h)},i.prototype.getNewRecordShareFdsImage=function(a,u){var c=this;a.width=this.shareForNewRecordFds.image.width,a.height=this.shareForNewRecordFds.image.height;var p=a.getContext("2d",null);p.clearRect(0,0,a.width,a.height),p.imageSmoothingEnabled=!0,p.mozImageSmoothingEnabled=!0;var h=s.default.Ins().createImage();h.src=this.shareForNewRecordFds.image.src,h.onload=function(){p.drawImage(s.default.Ins().getImageSrc(h),0,0,c.shareForNewRecordFds.image.width,c.shareForNewRecordFds.image.height),p.font=c.shareForNewRecordFds.musicName.font,p.fillStyle=c.shareForNewRecordFds.musicName.fillStyle;var f=a.width/2;p.textAlign=c.shareForNewRecordFds.musicName.textAlign,p.textBaseline=c.shareForNewRecordFds.musicName.textBaseline,p.fillText(c.shareForNewRecordFds.musicName.str,f,c.shareForNewRecordFds.musicName.top);for(var g=c.shareForNewRecordFds.scoreImage.width,_=c.shareForNewRecordFds.scoreNum.score+"",y=_.length,S=g+(c.shareForNewRecordFds.scoreNum.width+c.shareForNewRecordFds.scoreNum.spaceH)*y,I=(a.width-S)/2,v=0,C=function(k){var D=s.default.Ins().createImage();D.src=d.default.getResourcePath(c.shareForNewRecordFds.scoreNum.src+parseInt(_.charAt(k))+".png");var L=I+(c.shareForNewRecordFds.scoreNum.width+c.shareForNewRecordFds.scoreNum.spaceH)*k;D.onload=function(){if(p.drawImage(s.default.Ins().getImageSrc(D),L,c.shareForNewRecordFds.scoreNum.top,c.shareForNewRecordFds.scoreNum.width,c.shareForNewRecordFds.scoreNum.height),++v==y+2){var b=c.saveImageFileSync(a,c.shareForNewRecordFds.image.width,c.shareForNewRecordFds.image.height);u(!0,b)}}},T=0;T<y;T++)C(T);var E=s.default.Ins().createImage();E.src=c.shareForNewRecordFds.scoreImage.src;var A=I+(c.shareForNewRecordFds.scoreNum.width+c.shareForNewRecordFds.scoreNum.spaceH)*y;E.onload=function(){if(p.drawImage(s.default.Ins().getImageSrc(E),A,c.shareForNewRecordFds.scoreImage.top,c.shareForNewRecordFds.scoreImage.width,c.shareForNewRecordFds.scoreImage.height),++v==y+2){var k=c.saveImageFileSync(a,c.shareForNewRecordFds.image.width,c.shareForNewRecordFds.image.height);u(!0,k)}};var M=s.default.Ins().createImage();M.src=c.getAvatar(c.shareForNewRecordFds.circleAvatar.src,0),M.onload=function(){var k=a.width/2,D=c.shareForNewRecordFds.circleAvatar.top+c.shareForNewRecordFds.circleAvatar.width/2;p.beginPath(),p.arc(k,D,c.shareForNewRecordFds.circleAvatar.width/2,0,2*Math.PI),p.closePath(),p.save(),p.clip(),p.drawImage(s.default.Ins().getImageSrc(M),c.shareForNewRecordFds.circleAvatar.left,c.shareForNewRecordFds.circleAvatar.top,c.shareForNewRecordFds.circleAvatar.width,c.shareForNewRecordFds.circleAvatar.width),p.restore();var L=s.default.Ins().createImage();L.src=c.shareForNewRecordFds.circleAvatarMask.src,L.onload=function(){if(p.drawImage(s.default.Ins().getImageSrc(L),c.shareForNewRecordFds.circleAvatarMask.left,c.shareForNewRecordFds.circleAvatarMask.top,c.shareForNewRecordFds.circleAvatarMask.width,c.shareForNewRecordFds.circleAvatarMask.height),++v==y+2){var b=c.saveImageFileSync(a,c.shareForNewRecordFds.image.width,c.shareForNewRecordFds.image.height);u(!0,b)}},s.default.Ins().loadImage(L)},s.default.Ins().loadImage(M)},s.default.Ins().loadImage(h)},i.prototype.getShareGiftImage=function(a,u){var c=this;a.width=this.shareGiftFds.image.width,a.height=this.shareGiftFds.image.height;var p=a.getContext("2d",null);p.clearRect(0,0,a.width,a.height),p.imageSmoothingEnabled=!0,p.mozImageSmoothingEnabled=!0;var h=s.default.Ins().createImage();h.src=this.shareGiftFds.image.src,h.onload=function(){p.drawImage(s.default.Ins().getImageSrc(h),0,0,c.shareGiftFds.image.width,c.shareGiftFds.image.height),c.shareGiftFds.codeImage.src&&p.drawImage(c.shareGiftFds.codeImage.src,c.shareGiftFds.codeImage.left,c.shareGiftFds.codeImage.top,c.shareGiftFds.codeImage.width,c.shareGiftFds.codeImage.height);var f=c.saveImageFileSync(a,c.shareGiftFds.image.width,c.shareGiftFds.image.height);u(!0,f)},s.default.Ins().loadImage(h)},i.prototype.getChallengeShowOffImage=function(a,u){var c=this;a.width=this.challengeShowOff.image.width,a.height=this.challengeShowOff.image.height;var p=a.getContext("2d",null);p.clearRect(0,0,a.width,a.height),p.imageSmoothingEnabled=!0,p.mozImageSmoothingEnabled=!0;var h=s.default.Ins().createImage();h.src=this.challengeShowOff.image.src,h.onload=function(){p.drawImage(s.default.Ins().getImageSrc(h),0,0,c.challengeShowOff.image.width,c.challengeShowOff.image.height),p.font=c.challengeShowOff.title.font,p.fillStyle=c.challengeShowOff.title.fillStyle;var f=a.width/2;p.textAlign=c.challengeShowOff.title.textAlign,p.textBaseline=c.challengeShowOff.title.textBaseline,p.fillText(c.challengeShowOff.title.str,f,c.challengeShowOff.title.top),p.font=c.challengeShowOff.scoreNum.font,p.fillStyle=c.challengeShowOff.scoreNum.fillStyle,p.textAlign=c.challengeShowOff.scoreNum.textAlign,p.textBaseline=c.challengeShowOff.scoreNum.textBaseline;var g=p.measureText(c.challengeShowOff.scoreNum.str).width;p.font=c.challengeShowOff.scoreStr.font,p.fillStyle=c.challengeShowOff.scoreStr.fillStyle,p.textAlign=c.challengeShowOff.scoreStr.textAlign,p.textBaseline=c.challengeShowOff.scoreStr.textBaseline;var _=p.measureText(c.challengeShowOff.scoreStr.str).width,y=(a.width-g-_-c.challengeShowOff.scoreNum.spaceH)/2;p.font=c.challengeShowOff.scoreNum.font,p.fillStyle=c.challengeShowOff.scoreNum.fillStyle,p.textAlign=c.challengeShowOff.scoreNum.textAlign,p.textBaseline=c.challengeShowOff.scoreNum.textBaseline,p.fillText(c.challengeShowOff.scoreNum.str,y,c.challengeShowOff.scoreNum.top);var S=y+g+c.challengeShowOff.scoreNum.spaceH;p.font=c.challengeShowOff.scoreStr.font,p.fillStyle=c.challengeShowOff.scoreStr.fillStyle,p.textAlign=c.challengeShowOff.scoreStr.textAlign,p.textBaseline=c.challengeShowOff.scoreStr.textBaseline,p.fillText(c.challengeShowOff.scoreStr.str,S,c.challengeShowOff.scoreStr.top),p.font=c.challengeShowOff.rank.font,p.fillStyle=c.challengeShowOff.rank.fillStyle,p.textAlign=c.challengeShowOff.rank.textAlign,p.textBaseline=c.challengeShowOff.rank.textBaseline,p.fillText(c.challengeShowOff.rank.str,c.challengeShowOff.rank.startX,c.challengeShowOff.rank.top);var I=c.saveImageFileSync(a);u(!0,I)},s.default.Ins().loadImage(h)},i.prototype.drawCircleAvator=function(a,u,c){var p=u.left+u.width/2,h=u.top+u.height/2;a.beginPath(),a.arc(p,h,u.width/2,0,2*Math.PI),a.closePath(),a.save(),a.clip(),a.drawImage(s.default.Ins().getImageSrc(c),u.left,u.top,u.width,u.height),a.restore()},i.prototype.getAvatar=function(a,u){if(a==null)return a;try{return a.substr(0,a.lastIndexOf("/"))+"/"+u}catch(c){return a}},i.prototype.saveImageFileSync=function(a,u,c){var p=404,h=322;return u&&0<u&&(p=u),c&&0<c&&(h=c),s.default.Ins().saveShareTmpFile(a,{x:0,y:0,width:p,height:h,destWidth:p,destHeight:h})},i.prototype.getShraeQRCode=function(a,u,c,p){var h=this;p===void 0&&(p=""),r.MGUser.getUserLoginInfo({complete:function(f){f?h.createShareQRCode(f.playerId,p,u,c,a):h.createShareQRCode("0",p,u,c,a)}})},i.prototype.createShareQRCode=function(a,u,c,p,h){var f=document.createElement("canvas");f.width=c,f.height=p;var g=f.getContext("2d"),_="https://minigame.cmcm.com/pt2?id="+a;n.default.isOversea()&&(_="https://h5game_oversea.cmcm.com/pt2?id="+a),u!==""&&(_+="&act="+u);var y=new WeAppQRCode.QRCodeOption;y.ctx=g,y.width=c,y.height=p,y.text=_,WeAppQRCode.drawQRCode(y);var S=s.default.Ins().createImage();S.onload=function(){var I=Math.round(.285*c),v=Math.round(.285*p);g.drawImage(s.default.Ins().getImageSrc(S),Math.round((c-I)/2),Math.round((p-v)/2),I,v),h&&h(f)},S.src=d.default.getResourcePath("resources/share/qrcode_center.png")},i.prototype.getImagePositionInPlist=function(a,u,c){cc.loader.loadRes(a,cc.SpriteAtlas,function(p,h){if(p)e.default.l("[ShareImageUtils]-----------------err = ",p),c(null);else{e.default.l("[ShareImageUtils]-----------------atlas = ",h);var f=h.getSpriteFrame(u),g=f.getOriginalSize(),_=f.getRect();e.default.l("[ShareImageUtils]-----------------rect/size = ",_,g),c([_.x,_.y,_.width,_.height])}})},i}();m.default=t,cc._RF.pop()},{"../../../scripts/LogicPlatform/PlatformProxy":"PlatformProxy","../../../scripts/base/Log":"Log","../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../../../scripts/util/PU":"PU","../../MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","./ShareImage":"ShareImage"}],ShareImageUtil:[function(l,P,m){"use strict";cc._RF.push(P,"91e7bYLhjVJcbga41QK0CeQ","ShareImageUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){},s=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.createCanvas=function(){return document.createElement("canvas")},n.prototype.getShareImage=function(t,i){var a=this.createCanvas();a.width=t.width,a.height=t.height;var u=a.getContext("2d",null);u.clearRect(0,0,a.width,a.height),u.imageSmoothingEnabled=!0,u.mozImageSmoothingEnabled=!0,a.drawImage(t.background,0,0),this.drawImages(a,t.imgs,function(){}),this.drawText(a,t.text),i(!0,this.saveToFile(a))},n.prototype.save=function(t,i){var a="GameSandBox://share_tmp.png";i.path&&(a=i.path);var u=new cc.Texture2D;return u.releaseTexture(),u.initWithElement(t),u.handleLoadedTexture(),t.saveTo(a),a},n.prototype.saveToFile=function(t,i,a,u){return this.save(t,{path:i||""})},n.prototype.drawImages=function(t,i,a){for(var u=i.length,c=0;c<u;c++){var p=i[c];t.drawImage(p.background,p.left,p.top)}},n.prototype.drawText=function(t,i){for(var a=i.length,u=0;u<a;u++){var c=i[u];t.font=c.font,t.fillStyle=c.fillStyle,t.textAlign=c.textAlign,t.textBaseline=c.textBaseline,t.fillText(c.text,c.left,c.top)}},n}(m.IShareImage=d);m.QQPlayShareImgAdapter=s;var r=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.createCanvas=function(){return wx.createCanvas()},n.prototype.getShareImage=function(t,i){var a=this,u=this.createCanvas();u.width=t.width,u.height=t.height;var c=u.getContext("2d",null);if(c.clearRect(0,0,u.width,u.height),c.imageSmoothingEnabled=!0,c.mozImageSmoothingEnabled=!0,cc.sys.platform==cc.sys.WECHAT_GAME){var p=wx.createImage();p.src=t.background,p.onload=function(){c.drawImage(p.src,0,0,t.width,t.height),a.drawImages(u,t.imgs,function(){a.drawText(c,t.text)});var h=a.saveToFile(u,"",t.width,t.height);i(!0,h)}}},n.prototype.saveToFile=function(t,i,a,u){var c=404,p=322;return a&&0<a&&(c=a),u&&0<u&&(p=u),t.toTempFilePathSync(t,{x:0,y:0,width:c,height:p,destWidth:c,destHeight:p})},n.prototype.drawImages=function(t,i,a){for(var u=i.length,c=0,p=function(f){var g=wx.createImage(),_=i[f];g.src=_.background,g.onload=function(){t.drawImage(g,_.left,_.top,_.width,_.height),++c==u&&a()}},h=0;h<u;h++)p(h)},n.prototype.drawText=function(t,i){for(var a=i.length,u=0;u<a;u++){var c=i[u];t.font=c.font,t.fillStyle=c.fillStyle,t.textAlign=c.textAlign,t.textBaseline=c.textBaseline,t.fillText(c.text,c.left,c.top)}},n}(d);m.WXShareImgAdapter=r;var o=function(){function e(){}return e.getShareImage=function(n,t){if(!this.mAdapter)if(cc.sys.platform==cc.sys.WECHAT_GAME)this.mAdapter=new r;else{if(cc.sys.platform!=cc.sys.QQ_PLAY)return void t(!1,"");this.mAdapter=new s}this.mAdapter.getShareImage(n,t)},e}();m.ShareImageUtil=o,cc._RF.pop()},{}],ShareImage:[function(l,P,m){"use strict";cc._RF.push(P,"39906GCiwdMmrgR+zKswK/0","ShareImage"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.TYPE_QIU_CHAO_YUE=4,s.TYPE_QIU_CHAO_YUE_B=41,s.TYPE_JI_MO=5,s.TYPE_QUN_PAI_HANG=7,s.TYPE_TO_GROUP_ACHIEVEMENT=8,s.TYPE_RELIVE_FD_HELP_B=91,s.TYPE_SHARE_FOR_REWARD_B=101,s.TYPE_SHARE_NEW_RECORD_FDS=14,s.TYPE_SHARE_GIFT_FDS=15,s.TYPE_SHARE_INVITE_SKIN=16,s.TYPE_SHARE_INVITE_SONG=17,s.TYPE_SHARE_INVITE_CHALLENGE_TIMES=18,s.TYPE_SHARE_INVITE_CHALLENGE_TIMES_B=181,s.TYPE_SHARE_CHALLENGE_SHOW_OFF=19,s.TYPE_SHARE_QQ_GAME=20,s.TYPE_SHARE_QQ_RED_PACKET_ACTIVITY=21,s.TYPE_SHARE_FIGHT_WIN=22,s.TYPE_SHARE_FIGHT_INVITE_FRIEND=23,s.TYPE_SHARE_FRIEND_FIGHT_SHOW_OFF=24,s.TYPE_SHARE_SKIN_PIECE=25,s.TYPE_SHARE_ADD_FRIEND=26,s.TYPE_SHARE_TONE=27,s.QRCODE_IMAGE_WIDHT=210,s.QRCODE_IMAGE_HEIGHT=210,s.TYPE_WX_DEFAULT_ONE=1,s.TYPE_WX_DEFAULT_TWO=2,s.TYPE_WX_DEFAULT_THREE=3,s.TYPE_QQ_SING_RANK_SHOW_OFF=1001,s.TYPE_QQ_RESULT_SING_CHAMP=1002,s.TYPE_QQ_RESULT_SHOW_OFF=1003,s.TYPE_QQ_RESULT_NEW_RECORD=1004,s}();m.ShareImage=d,cc._RF.pop()},{}],ShareLooper:[function(l,P,m){"use strict";cc._RF.push(P,"b43a6wj/B5E+Yo3Fx4TIIqd","ShareLooper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Looper"),s=l("../reward/RewardManager"),r=function(){function o(){var e=this;this.mLooper=null,this.mLooper=new d.default,this.func=function(){s.RewardMgr.Ins().getInviteRewardList(function(n){e.recieveCallback(n)})},this.mLooper.setWork(this.func)}return o.prototype.recieveCallback=function(e){this.mCallback&&this.mCallback(e)},o.prototype.start=function(e){this.mCallback=e,this.mLooper&&this.mLooper.start()},o.prototype.stop=function(){this.mLooper&&this.mLooper.stop()},o.prototype.release=function(){this.mLooper&&(this.mLooper.stop(),this.mLooper.destroy(),this.mLooper=null)},o}();m.default=r,cc._RF.pop()},{"../reward/RewardManager":"RewardManager","./Looper":"Looper"}],ShareRewardController:[function(l,P,m){"use strict";cc._RF.push(P,"fb588LK2jlMw5zRV2IYgB0c","ShareRewardController"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../reward/RewardManager"),s=l("../UI/GameEntraScene/InviteTipsPrefab"),r=l("../../base/Log"),o=l("../UI/GameEntraScene/ToastPrefab"),e=l("../../util/StringUtil"),n=l("../UI/GameEntraScene/PrefabMgr"),t=function(){function i(){}return i.checkInviterReward=function(a,u,c){d.RewardMgr.Ins().getInviteRewardList(function(p){if(p){for(var h=0,f=0,g="",_=p.length,y=[],S=0;S<_;S++){var I=p[S];I.isConsume||(h+=I.diamondNum,f++,g&&g.length!=0||(g=I.userNickName),y.push(I))}0<h?n.default.load("prefab/InviteTipsPrefab",function(v,C){r.default.e("[ShareRewardController.checkInviterReward.loadRes] result:",C);var T=C.getComponent(s.default);T.setConfirmBtnContent("\u7EE7\u7EED\u9080\u8BF7");var E="\u4F60\u5DF2\u6210\u529F\u9080\u8BF7";g&&g.length!=0||(g="\u597D\u53CB- -"),E+=1<f?'"'+e.StringUtil.getFixedlengthStr(g,12)+'"\u7B49'+f+"\u4EBA\u8FDB\u5165\u6E38\u620F\uFF0C\u5956\u52B1\u4F60"+h+"\u4E2A\u94BB\u77F3":'"'+e.StringUtil.getFixedlengthStr(g,12)+'"\u8FDB\u5165\u6E38\u620F\uFF0C\u5956\u52B1\u4F60'+h+"\u4E2A\u94BB\u77F3",T.setContent(E);var A="\u4ECA\u65E5\u8FD8\u53EF\u9080\u8BF7\u4EBA\u6570: "+d.RewardMgr.Ins().getCanAlsoInviteNumToday()+"\u4EBA";T.setBottomTips(A),T.setConfirmCallback(function(){u&&u(C,h)}),T.setCloseCallback(function(){c&&c(C)}),a&&a(C,h,y)}):a(null,0,null)}else a(null,0,null)})},i.checkInviteeReward=function(a,u,c,p){d.RewardMgr.Ins().acceptInvite(a,function(h,f){f?h&&n.default.load("prefab/InviteTipsPrefab",function(g,_){var y=_.getComponent(s.default);y.setConfirmBtnContent("\u83B7\u53D6\u66F4\u591A\u94BB\u77F3");var S="\u4F60\u5DF2\u6210\u529F\u5E2E\u52A9";f.userNickName&&0<f.userNickName.length?S+='"'+e.StringUtil.getFixedlengthStr(f.userNickName,12)+'"\u83B7\u5F97\u94BB\u77F3\u5956\u52B1\uFF0C\u5956\u52B1\u4F60'+f.diamondNum+"\u4E2A\u94BB\u77F3":S+='"\u597D\u53CB- -"\u83B7\u5F97\u94BB\u77F3\u5956\u52B1\uFF0C\u5956\u52B1\u4F60'+f.diamondNum+"\u4E2A\u94BB\u77F3",y.setContent(S);var I="\u4ECA\u65E5\u5269\u4F59\u5E2E\u52A9\u6B21\u6570: "+f.remainingHelpNum+"\u6B21";y.setBottomTips(I),y.setConfirmCallback(function(){c&&c(_,f)}),y.setCloseCallback(function(){p&&p(_)}),u&&u(_,f)}):u&&u(null,null)})},i.checkLittleStarInviteeReward=function(a,u,c){d.RewardMgr.Ins().acceptInvite(a,function(p,h){p&&h?n.default.load("prefab/ToastPrefab",function(f,g){g.getComponent(o.default).showLittleStarAward(h.diamondNum,function(){g.destroy()}),u&&u(g),c&&c(h.diamondNum)}):u&&u(null)})},i}();m.default=t,cc._RF.pop()},{"../../base/Log":"Log","../../util/StringUtil":"StringUtil","../UI/GameEntraScene/InviteTipsPrefab":"InviteTipsPrefab","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../reward/RewardManager":"RewardManager"}],ShareSkinController:[function(l,P,m){"use strict";cc._RF.push(P,"35834/5HBhMyoQIxsGWToVa","ShareSkinController"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../PrefabMgr"),s=l("../../../skin/CMInviteSkinPrefab"),r=l("../../../Logic/SkinDataManager"),o=function(){function e(){}return e.Ins=function(){return e.s||(e.s=new e),e.s},e.prototype.getBgUrlAndReportPage=function(n){var t={layoutBgUrl:"/mainpage/cm_ice_skin_bg.png",page:window.Infoc_Page_Skin_Ice};switch(n){case r.SkinDataMgr.ICE_SKIN_NAME:t.layoutBgUrl="/mainpage/cm_ice_skin_bg.png",t.page=window.Infoc_Page_Skin_Ice;break;case r.SkinDataMgr.GIRL_SKIN_NAME:t.layoutBgUrl="/mainpage/cm_girl_skin_bg.png",t.page=window.Infoc_Page_Skin_Girl;break;case r.SkinDataMgr.AFTERRAIN_SKIN_NAME:t.layoutBgUrl="/mainpage/cm_afterrain_skin_bg.png",t.page=window.Infoc_Page_Skin_AfterRain;break;case r.SkinDataMgr.CANDY_SKIN_NAME:t.layoutBgUrl="/mainpage/cm_candy_skin_bg.png",t.page=window.Infoc_Page_Skin_Candy}return t},e.prototype.show=function(n,t,i){var a=this;d.default.load("prefab/mainpage/CMInviteSkinPrefab",function(u,c){var p=c.getComponent(s.default);p.setSkinName(n),p.setInviteCountLimit(r.SkinDataMgr.Ins().getSkinInviteLimitBySkiniId(n.name)),p.setLayoutBgUrl(a.getBgUrlAndReportPage(n.name).layoutBgUrl),p.setReportPage(a.getBgUrlAndReportPage(n.name).page),t&&t(c)},!0,!0)},e}();m.default=o,cc._RF.pop()},{"../../../Logic/SkinDataManager":"SkinDataManager","../../../skin/CMInviteSkinPrefab":"CMInviteSkinPrefab","../PrefabMgr":"PrefabMgr"}],ShieldWorker:[function(l,P,m){"use strict";cc._RF.push(P,"024f1E7jXxJ2rkOdl64kGpV","ShieldWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../workers/WorkerBase"),s=l("../../workers/WorkerState"),r=l("../../../property/PropertyDefines"),o=l("../../../base/G"),e=l("../../../util/runtime/Tween"),n=l("../../../util/runtime/ClassType"),t=l("./../../../base/Log"),i=function(a){function u(){var c=a.call(this,"ShieldWorker")||this;return c.duration=0,c.recoveryTime=0,c.obtained=!1,c.ShieldProperty=null,c.endCallback=null,c.willendCallback=null,c.preSpeed=0,c}return __extends(u,a),u.prototype.init=function(c,p,h,f){var g=c.getSpeed(),_=p.permanentTime||0,y=p.temporyTime||0;o.G.Ap.config.mBaseBlockHeight,this.duration=p.permanentTime||p.temporyTime||0,this.updateAdditionTime(),this.recoveryTime=2,this.stage=c,this.setPreSpeed(g),this.setEndCallback(h),this.setWillCallback(f),this.stage.propertyWorked=!0,this.ShieldProperty=new r.Property(r.PROPERTYTYPE.GAME_SHIELD),console.log("--- ShieldWorker onStart life:---",_,"     tempLife:"+y,"   duration:",this.duration)},u.prototype.updateAdditionTime=function(){var c=this.duration;this.duration=o.G.propAddition.getAdditionDashTime(this.duration,o.G.Ap.state.mission.getType().toString()),t.default.e("\u62A4\u76FE \u65F6\u95F4\u52A0\u6210\uFF1A"+c+"  => "+this.duration)},u.prototype.onStart=function(){for(var c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];try{if(c&&c.length<=0)return;var h=c[0],f=c[1],g=c[2],_=c[3];this.init(h,f,g,_),o.G.Ap.state.startPropertyWork(this.ShieldProperty),console.log("--- ShieldWorker onStart args:---",c)}catch(y){console.log("--- ShieldWorker onStart err:---",y)}},u.prototype.onStop=function(){for(var c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];try{return console.log("--- ShieldWorker onStop args:---",c),this.stage.propertyWorked=!1,o.G.Ap.state.stopPropertyWork(this.ShieldProperty),void this.slowDownAndRecovery()}catch(h){console.log("--- ShieldWorker onStop err:---",h)}},u.prototype.onStateChanged=function(c){if(console.log("--- ShieldWorker onStateChanged args:---",c),c.state===s.WorkerState.running){var p=this.getEndCallback(),h=this.getWillCallback();this.recovery(p,h)}},u.prototype.reset=function(){this.duration=0,this.recoveryTime=0,this.obtained=!1,this.ShieldProperty=null},u.prototype.recovery=function(c,p){try{cc.sys.platform==cc.sys.QQ_PLAY?this.workForQQ(c,p):this.workForWechat(c,p,requestAnimationFrame,cancelAnimationFrame)}catch(h){this.stage.setSpeed(this.preSpeed)}},u.prototype.slowDownAndRecovery=function(){try{cc.sys.platform==cc.sys.QQ_PLAY?this.slowDownWorkForQQ():this.slowDownWorkForWechat(requestAnimationFrame,cancelAnimationFrame)}catch(c){this.stage.setSpeed(this.preSpeed)}},u.prototype.workForWechat=function(c,p,h,f){var g=this,_=59*this.duration,y=0,S=0,I=function(){var v=g.state;v!==s.WorkerState.pausing&&v!==s.WorkerState.paused&&(++y==_-177&&p(177),y<=_?S=h(I):(f(S),c(1),g.reset()))};I()},u.prototype.workForQQ=function(c,p){this.workForWechat(c,p,n.Type.getRaf(),n.Type.getCaf())},u.prototype.slowDownWorkForWechat=function(c,p){var h=this,f=59*this.recoveryTime,g=this.stage.getSpeed(),_=0,y=0;this.stage.setSpeed(10);var S=function(){var I=e.mTween.quadEaseIn(y++,10,g,f);I=Math.min(I,g),y<=f?(h.stage.setSpeed(I),_&&p(_),_=c(S)):(h.stage.setSpeed(g),_&&p(_))};S()},u.prototype.slowDownWorkForQQ=function(){this.slowDownWorkForWechat(n.Type.getRaf(),n.Type.getCaf())},u.prototype.getDuration=function(){return this.duration},u.prototype.setEndCallback=function(c){c&&(this.endCallback=c)},u.prototype.getEndCallback=function(){return this.endCallback},u.prototype.setWillCallback=function(c){c&&(this.willendCallback=c)},u.prototype.getWillCallback=function(){return this.willendCallback},u.prototype.setPreSpeed=function(c){c===void 0&&(c=0),this.preSpeed=c},u}(d.WorkerBase);m.default=i,cc._RF.pop()},{"../../../base/G":"G","../../../property/PropertyDefines":"PropertyDefines","../../../util/runtime/ClassType":"ClassType","../../../util/runtime/Tween":"Tween","../../workers/WorkerBase":"WorkerBase","../../workers/WorkerState":"WorkerState","./../../../base/Log":"Log"}],ShopData:[function(l,P,m){"use strict";cc._RF.push(P,"2932a/ajWxE8a1qAlMwDjwL","ShopData"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("./CsvRowData"),r=l("./BaseCsvFile");(d=m.SHOP_ITEM_PLATFORM||(m.SHOP_ITEM_PLATFORM={}))[d.COMMON=0]="COMMON",d[d.WEIXIN=1]="WEIXIN",d[d.QQ=2]="QQ";var o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.findId=function(i){return this.find("id",i)},t.prototype.getRow=function(){return new e},t}(r.default);m.ShopData=o;var e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getID=function(){return this.getInt("id")},t.prototype.getGoodsID=function(){return this.getInt("goods_id")},t.prototype.getTab=function(){return this.getInt("tab")},t.prototype.getIconPath=function(){return this.getString("icon_pic")},t.prototype.getScriptPicPath=function(){return this.getString("script_pic")},t.prototype.getGoodsListStr=function(){return this.getString("goods")},t.prototype.getGoodsName=function(){return this.getString("goods_name")},t.prototype.getPrice=function(){return this.getFloat("price")},t.prototype.getDiscount=function(){return this.getFloat("discount")},t.prototype.getDiscountedPrice=function(){return this.getFloat("discounted_price")},t.prototype.getBuyTimes=function(){return this.getInt("buy_times")},t.prototype.getPayId=function(){return this.getString("payid")},t.prototype.getShowScene=function(){return this.getInt("show_scene")},t.prototype.getFreeGiveCnt=function(){return this.getInt("free_give_cnt")},t.prototype.getPlatform=function(){return this.getInt("platform")},t}(s.default);m.ShopRow=e,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],ShortBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"34d8dLaH+5Jn4N96wC/KFAo","ShortBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/BlockSkinFrameLoader"),s=l("./BlockNode"),r=l("../../MUI/MUISprite"),o=l("../../animation/action/MFrameSequence"),e=l("../../GameBus"),n=l("../../../base/G"),t=function(i){function a(){var u=i!==null&&i.apply(this,arguments)||this;return u.frameAnimation=null,u}return __extends(a,i),a.prototype.unuse=function(){i.prototype.unuse.call(this),this.frameAnimation.stopForce()},a.prototype.reuse=function(u){i.prototype.reuse.call(this,u),this.updatePauseState(!1)},a.prototype.createLayers=function(){i.prototype.createLayers.call(this);var u=d.default.getInstance().getShortBlockBackground();this.imageItem=u,this.imageData=d.default.getInstance().getAtlas(),this.frameSequence=d.default.getInstance().getShortBlockTouchedAnimFrames();var c=8*n.G.Ap.config.gameFrameInterval;this.frameAnimation=new o.default(this.frameSequence.frames.length,c)},a.prototype.updateTouchState=function(u){0<this.mBlock.touchCount&&u&&this.showBackgroundAnimation()},a.prototype.modifyOpacity=function(u){},a.prototype.updatePauseState=function(u){var c=this.getChildByTag(a.TAG_NODE_LABEL);if(u&&!c){var p=d.default.getInstance().getStartLabel(),h=this.mBlock.rect.width/p.rect.width,f=this.mBlock.rect.width,g=p.rect.height*h,_=new r.default;_.imageData=d.default.getInstance().getAtlas(),_.imageItem=p,_.move(0,(this.mBlock.rect.height-g)/2,f,g),this.addChild(_,a.TAG_NODE_LABEL)}c&&c.setVisible(u)},a.prototype.showBackgroundAnimation=function(){e.default.getInstance().animationMgr.runAction(this,this.frameAnimation)},a.TAG_NODE_BG=256,a.TAG_NODE_LABEL=128,a.BKG_ANIM_NAME="frame_anim",a}(s.default);m.default=t,cc._RF.pop()},{"../../../base/G":"G","../../GameBus":"GameBus","../../MUI/MUISprite":"MUISprite","../../animation/action/MFrameSequence":"MFrameSequence","../loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./BlockNode":"BlockNode"}],SimpleAtlas:[function(l,P,m){"use strict";cc._RF.push(P,"0ab27sfUtZK8I6InQ8Vx819","SimpleAtlas"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=l("./SimpleImage"),r=l("../../util/ResLoader"),o=l("../MUI/MUIDefines"),e=l("../../util/PU"),n=function(t){function i(a){a===void 0&&(a=null);var u=t.call(this,a)||this;return u.items=new Object,u}return __extends(i,t),i.prototype.loadCanvas=function(a){this.onDestroy(),this.image=a,this.onLoad()},i.prototype.load=function(a,u){return u===void 0&&(u="png"),__awaiter(this,void 0,void 0,function(){var c,p,h,f,g=this;return __generator(this,function(_){switch(_.label){case 0:return this.onDestroy(),c="resources/",p=e.default.getResourcePath(c+a+"."+u),this.loadImage(p),h=a+"_plist",f=e.default.getResourcePath(c+h+".json"),[4,new Promise(function(y,S){g.loadAtlasAsync(h,f,y,S)})];case 1:return _.sent(),[2]}})})},i.prototype.loadAtlasAsync=function(a,u,c,p){var h=this;r.default.loadJson(u,function(f,g){f===null?(h.parseAtlas(g),c(g)):cc.loader.loadRes(a,function(_,y){_!==null?(console.error("load atlas error ["+_.name+"]"+_.message),p(_)):(h.parseAtlas(y),c(y))})})},i.prototype.parseAtlas=function(a){for(var u=0,c=a;u<c.length;u++){var p=c[u];if(p.rect){var h=p.name;this.addItem(h,new d.Utility.Rect(p.rect.x,p.rect.y,p.rect.width,p.rect.height),p.rotated)}}},i.prototype.getItem=function(a){return this.items[a]},i.prototype.addItem=function(a,u,c,p){var h=new s.SimpleImageItem;return h.rect.copy(u),h.rotated=c,p!=null&&(h.scale9Grid.copy(p),h.isScale9Grid=!0),this.items[a]=h,!0},i.prototype.createFrameSequence=function(a){for(var u=new s.SimpleImageFrameSequence,c=0,p=a.length;c<p;++c){var h=this.getItem(a[c]);h&&u.frames.push(h)}return u},i.prototype.onLoad=function(){if(t.prototype.onLoad.call(this),o.MUI.global.renderType===o.MUI.RenderType.WEBGL&&!this.texture){var a=o.MUI.global.ctx;this.texture=a.createTexture(),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.texture),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.image),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null),console.log("this.image width = "+this.image.width+" height = "+this.image.height),console.warn("\u7EB9\u7406\uFF1A"+this.image.currentSrc)}},i.prototype.onDestroy=function(){this.texture&&(o.MUI.global.ctx.deleteTexture(this.texture),this.texture=null)},i}(s.default);m.default=n,cc._RF.pop()},{"../../util/PU":"PU","../../util/ResLoader":"ResLoader","../../util/Utility":"Utility","../MUI/MUIDefines":"MUIDefines","./SimpleImage":"SimpleImage"}],SimpleImage:[function(l,P,m){"use strict";cc._RF.push(P,"73cc2gm0SxIOKmUPfyo+LvT","SimpleImage"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../util/Utility"),s=function(){this.rect=new d.Utility.Rect(0,0,0,0),this.rotated=!1,this.scale9Grid=new d.Utility.Rect(0,0,0,0),this.isScale9Grid=!1};m.SimpleImageItem=s;var r=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.frames=[];for(var t=0,i=e.length;t<i;++t)this.frames.push(e[t])};m.SimpleImageFrameSequence=r;var o=function(){function e(n){n===void 0&&(n=null),this.image=null,this.texture=null,this.finish=!1,this.image=n||new Image}return e.prototype.onLoad=function(){this.finish=!0},e.prototype.isLoadFinish=function(){return this.finish},e.prototype.loadImage=function(n){var t=this;this.image.src=n,cc.sys.platform===cc.sys.QQ_PLAY||(this.image.onload=function(){t.onLoad()})},e.prototype.stepLoad=function(){return!!this.isLoadFinish()||(cc.sys.platform===cc.sys.QQ_PLAY&&0<this.image.width&&this.onLoad(),this.finish)},e}();m.default=o,cc._RF.pop()},{"../../util/Utility":"Utility"}],SingleWorker:[function(l,P,m){"use strict";cc._RF.push(P,"0e728ST4tNFSJzefviulfuS","SingleWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.doWork=function(r,o,e){var n=this;r!=null&&r!=null||(r=Date.now()+"");var t=this.mListeners.get(r);t||(t=[],this.mListeners.set(r,t)),e&&t.push(e),this.mObj[r]||(this.mObj[r]="working",o().then(function(i){n.invokeListeners(r,!0,i)},function(){n.invokeListeners(r,!1,null)}).catch(function(){n.invokeListeners(r,!1,null)}))},s.invokeListeners=function(r,o,e){delete this.mObj[r];for(var n=this.mListeners.get(r);n&&0<n.length;){var t=n.pop();t&&t(o,e)}},s.mListeners=new Map,s.mObj=new Object,s}();m.default=d,cc._RF.pop()},{}],SkinAdditionData:[function(l,P,m){"use strict";cc._RF.push(P,"d8803EvOihGlZBqpaPNFlZV","SkinAdditionData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.SkinAdditionData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("Id")},e.prototype.getSkinId=function(){return this.getString("skinId")},e.prototype.getSceneId=function(){return this.getString("sceneId")},e.prototype.getEffectId=function(){return this.getString("effectId")},e}(d.default);m.SkinAdditionRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],SkinDataManager:[function(l,P,m){"use strict";cc._RF.push(P,"f0cf0efUdtFvp8DiAd9cRJn","SkinDataManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../upgrade/ResBean"),s=l("../Network/Protocol/StorageUtil"),r=l("../../config/LSKey"),o=l("./MoneySystem"),e=l("../../base/G"),n=l("../../upgrade/ResMgr"),t=l("./EventBus"),i=l("./NotifyEvent"),a=l("../../util/PU"),u=l("../../util/StringUtil"),c=l("../../base/Log"),p=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),h=l("../../LogicPlatform/PlatformProxy"),f=l("../propAddition/Define"),g=l("../../util/NumberUtil"),_=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),y=function(){function T(){this.mInit=!1,this.mSkinList=null,this.mOwnedSkinList=null,this.mInviteSkinInfo=null,this.reset()}return T.Ins=function(){return T._instance||(T._instance=new T),T._instance},T.prototype.reset=function(){var E=this;if(E.initCurSkin(),E.mOwnedSkinList=E.readOwnedSkinList(),E.mSkinList=E.getAllSkinItems(),E.mInviteSkinInfo=E.getAllInviteSkinInfo(),E.refreshOwnedSkin(!1),E.mCurSkin!=T.SKIN_DEFAULT){for(var A=null,M=0;M<E.mSkinList.length;M++){var k=E.mSkinList[M];if(k.name==E.mCurSkin){A=k;break}}A&&!A.isDownload&&(E.saveCurSkin(T.SKIN_DEFAULT,T.SKIN_DEFAULT_DISPLAYNAME),E.mSkinList=E.getAllSkinItems(),E.refreshOwnedSkin(!1))}},T.prototype.refreshOwnedSkin=function(E){if(E===void 0&&(E=!0),E&&(this.mOwnedSkinList=this.readOwnedSkinList()),this.mSkinList)for(var A=0;A<this.mSkinList.length;A++){var M=this.mSkinList[A];this.refreshOwnedSkinAttributes(M)}},T.prototype.refreshOwnedSkinAttributes=function(E){var A=this.getOwnedSkin(E.name);E.isLock=A==null,A!=null&&(E.expireTime=A.expireTime)},T.prototype.isDefaultSkin=function(){return this.getCurSkin()==T.SKIN_DEFAULT},T.prototype.getCurSkinItemInfo=function(){for(var E=0;E<this.mSkinList.length;E++){var A=this.mSkinList[E];if(A&&A.name==this.mCurSkin)return A}return null},T.prototype.getCurSkin=function(){return this.mCurSkin},T.prototype.getCurSkinDisplayName=function(){return this.mCurSkinDisplayName},T.prototype.getOwnedSkinList=function(){return this.mOwnedSkinList},T.prototype.getSkinList=function(){return this.mSkinList},T.prototype.getSkinListExceptDefault=function(){return this.mSkinList.filter(function(E){return E.name!=T.SKIN_DEFAULT})},T.prototype.getSkinByPieceId=function(E){if(u.StringUtil.isEmpty(E))return null;for(var A=0;A<this.mSkinList.length;A++){var M=this.mSkinList[A];if(M&&M.piecesId==E)return M}return null},T.prototype.getOwnedSkin=function(E){for(var A=0;A<this.mOwnedSkinList.length;A++)if(this.mOwnedSkinList[A].id==E)return this.mOwnedSkinList[A];return null},T.prototype.alterDefaultSkin=function(){this.saveCurSkin(T.SKIN_DEFAULT,T.SKIN_DEFAULT_DISPLAYNAME),this.refreshListStatus()},T.prototype.getCurrentUseSkinInfo=function(){return this.getOwnedSkin(this.mCurSkin)},T.prototype.isSkinLocked=function(E){return this.getOwnedSkin(E)==null},T.prototype.updateOwnedSkin=function(E,A){if(this.isOwnedPermanent(E))return!1;var M=this.getOwnedSkin(E),k=!0;return M==null?(M=new I(E,A),this.mOwnedSkinList.push(M)):M.expireTime!=A?M.expireTime=A:k=!1,k&&A==0&&t.default.fire(i.default.UNLOCK_SKIN_PERMANENT,E),k},T.prototype.addSkinExpireTime=function(E,A){var M=this.getOwnedSkin(E);if(M!=null&&M.isOwnedPermanent())return!1;if(M!=null&&M.isOwnedPermanent()==0)M.expireTime=M.expireTime+A;else{var k=p.MGUser.getCurrentServerTime()+A;this.updateOwnedSkin(E,k)}return this.flushOwnedSkin(),this.refreshOwnedSkin(),!0},T.prototype.removeSkinList=function(E){for(var A=!1,M=0;M<E.length;M++){var k=E[M],D=this.mOwnedSkinList.indexOf(k);-1<D&&(this.mOwnedSkinList.splice(D,1),A=!0)}A&&(this.flushOwnedSkin(),this.refreshOwnedSkin())},T.prototype.getSkinItemInfo=function(E){for(var A=0;A<this.mSkinList.length;A++){var M=this.mSkinList[A];if(M.name==E)return M}return null},T.prototype.getSkinItemInfoBySkinId=function(E){for(var A=0;A<this.mSkinList.length;A++){var M=this.mSkinList[A];if(M.skinId==E)return M}return null},T.prototype.getSkinInviteLimitBySkiniId=function(E){for(var A=0;A<this.mInviteSkinInfo.length;A++){var M=this.mInviteSkinInfo[A];if(M.skinName==E)return M.getInviteCountLimit()}return 3},T.prototype.changeSkin=function(E,A,M){var k=this;if(this.mSkinList&&E!=null&&E!=null){var D=this.mSkinList.filter(function(b){return b.name==E.name});if(D&&0<D.length){var L='{"displayName":"'+E.displayName+'"}';e.G.Ap.skinMgr.switchSkin(E.name,L,function(b){c.default.i("call skinMgr.switchSkin result(0-success):"+b,E),b==0?(k.saveCurSkin(E.name,E.displayName),e.G.propAddition.setSkinAdditions(f.default.getAdditions(E.skinId)),k.refreshListStatus(),A(b)):M()})}else c.default.i("\u76EE\u6807\u76AE\u80A4\u4E0D\u5B58\u5728\uFF0C\u6362\u80A4\u5931\u8D25\u3002",E),M()}else M()},T.prototype.refreshListStatus=function(){if(this.mSkinList&&0<this.mSkinList.length)for(var E=0;E<this.mSkinList.length;E++){var A=this.mSkinList[E];A.isUsing=this.mCurSkin==A.name}},T.prototype.switchTrialSkin=function(E,A,M){if(this.mSkinList&&E!=null&&E!=null){var k=this.mSkinList.filter(function(L){return L.name==E.name});if(k&&0<k.length){var D='{"displayName":"'+E.displayName+'"}';e.G.Ap.skinMgr.switchTrialSkin(E.name,D,function(L){L==0?A():M()})}else M()}else M()},T.prototype.getDefaultSkinItem=function(){if(this.mSkinList&&0<this.mSkinList.length){var E=this.mSkinList.filter(function(M){return M.name==T.SKIN_DEFAULT});if(E&&0<E.length)return E[0]}var A=new C;return A.name=T.SKIN_DEFAULT,A.displayName=T.SKIN_DEFAULT_DISPLAYNAME,A.type=C.SKIN_TYPE_DEFAULT,A.isDownload=!0,A.isNeedUpdate=!1,A.isUsing=this.mCurSkin==T.SKIN_DEFAULT,A.isLock=!1,A.skinId="5-1-0",A},T.prototype.getAllSkinItems=function(){var E=this,A=[],M=n.default.Ins().getSkins(),k=this.readCMSkinAdsInfo();if(M){var D=M.filter(function(L){return L.type==d.ResBean.TYPE_SKIN&&L.key==T.SKIN_DEFAULT});D!=null&&D.length!=0||A.push(this.getDefaultSkinItem()),a.default.isQQ(),M.forEach(function(L){if(L.skinItem){var b=new C;if(b.name=L.skinItem.name,b.skinId=L.skinItem.goodId,b.isNeedUpdate=L.isNeedUpdate(),b.isDownload=L.isDownload(),b.type=L.skinItem.skinType,b.isUsing=E.mCurSkin==L.skinItem.name,b.isUsing?b.isLock=!1:b.isLock=E.isSkinLocked(b.name),b.displayName=L.skinItem.displayName,b.resId=L.skinItem.previewImage,b.resId!=null&&b.resId!=null&&b.resId.length!=0||(b.resId="skin/preview/"+b.name),b.ticketCount=L.skinItem.certificationCount,b.disCountEnable=L.skinItem.disCountEnable===d.SkinBean.DIS_ENABLE,b.disCountEnable&&(b.dis=parseInt(L.skinItem.dis),b.ticket=parseInt(L.skinItem.ticket),b.disTicket=parseInt(L.skinItem.disTicket),b.rmb=parseInt(L.skinItem.rmb),b.disRmb=parseInt(L.skinItem.disRmb)),a.default.isCM()){b.goldCount=L.skinItem.goldCount,b.totalWatchAdsTimes=L.skinItem.watchAdsTimes;for(var N=0,H=k;N<H.length;N++){var R=H[N];if(R.name==b.name){b.watchAdsTimes=R.adsTimes,b.lastWatchAdsTime=R.lastTime;break}}}else b.piecesId=L.skinItem.piecesId,b.piecesTotal=L.skinItem.piecesTotal;A.push(b)}})}else A.push(this.getDefaultSkinItem());return A},T.prototype.getAllInviteSkinInfo=function(){var E=[],A=this.getCubeConfig();return A&&A.inviteCountLimit&&A.inviteCountLimit.forEach(function(M){var k=new v(M.scene,M.countLimit);E.push(k)}),E},T.prototype.getCubeConfig=function(){return JSON.parse('{"switch":0,"inviteCountLimit":[{"scene":"ice","countLimit":3},{"scene":"girl","countLimit":2},{"scene":"afterrain","countLimit":2},{"scene":"candy","countLimit":2}]}')},T.isSkinExist=function(E,A){if(u.StringUtil.isNullOrUndefined(E))A&&A(!1);else if(E!=T.SKIN_DEFAULT)if(h.default.Ins().needDownloadRes()){var M=a.default.getResourcePath("resources/skin/"+E+"/"+E+".json"),k=n.default.Ins().getSkinBean(E);k?h.default.Ins().getFileSystemManager().access({path:M,success:function(D){A&&A(!!D)},fail:function(D){c.default.i("SkinDataManager. isSkinExist : false"),k.clearLocalInfo(),A&&A(!1)}}):A&&A(!1)}else A&&A(!0);else A&&A(!0)},T.downloadSkin=function(E,A,M){return __awaiter(this,void 0,void 0,function(){var k;return __generator(this,function(D){return u.StringUtil.isNullOrUndefined(E)||(k=n.default.Ins().getSkinBean(E))==null?M():n.default.Ins().downloadSkin(k,A,M),[2]})})},T.cancelDownloadSkin=function(E){E!=null&&E!=null&&E.name!=null&&E.name!=null&&E.name.length!=0&&n.default.Ins().cancelDownloadSkin(E.name)},T.prototype.unLockByFirstPay=function(){return this.unlockSkinByType(d.SkinBean.SKIN_TYPE_FIRST_PAY)},T.prototype.unlockDailyAttendanceSkin=function(){return this.unlockSkinByType(d.SkinBean.SKIN_TYPE_DAILYATTENDANCE)},T.prototype.unlockFirstPaySkin=function(){return this.unlockSkinByType(d.SkinBean.SKIN_TYPE_FIRST_PAY)},T.prototype.unlockSkinByType=function(E){var A=n.default.Ins().getSkins().filter(function(b){return b.skinItem&&b.skinItem.skinType==E});if(A&&0<A.length){for(var M=T.Ins(),k=!1,D=0;D<A.length;D++){var L=A[D];L&&L.skinItem&&L.skinItem.name&&(k=M.updateOwnedSkin(L.skinItem.name,0))}return k&&(M.flushOwnedSkin(),M.refreshOwnedSkin()),!0}return!1},T.prototype.unlockSkin=function(E){return!!this.updateOwnedSkin(E,0)&&(this.flushOwnedSkin(),this.refreshOwnedSkin(),t.default.fire(i.default.UNLOCK_NORMAL_SKIN_EVENT,E),s.default.pushAsync(),_.MGAdv.customEvent("Unlock","forever","{name:'"+E+"'}"),!0)},T.prototype.isOwnedPermanent=function(E){var A=this.getOwnedSkin(E);return A!=null&&A.isOwnedPermanent()},T.prototype.unlockInviteSkin=function(){var E=n.default.Ins().getSkins().filter(function(D){return!!D.skinItem&&D.skinItem.skinType==d.SkinBean.SKIN_TYPE_INVITE});if(E&&0<E.length){for(var A=!1,M=0;M<E.length;M++){var k=E[M];k&&k.skinItem&&k.skinItem.name&&this.updateOwnedSkin(k.skinItem.name,0)&&(A=!0,t.default.fire(i.default.UPDATE_SKIN_STORE_UI))}return A&&(this.flushOwnedSkin(),this.refreshOwnedSkin()),!0}return!1},T.prototype.unlockInviteSkinByName=function(E){var A=n.default.Ins().getSkinBean(E),M=!1;return this.updateOwnedSkin(A.skinItem.name,0)&&(M=!0,t.default.fire(i.default.UPDATE_SKIN_STORE_UI)),M&&(this.flushOwnedSkin(),this.refreshOwnedSkin()),!0},T.prototype.getInviteSkin=function(){for(var E=T.Ins().getSkinList(),A=0;A<E.length;A++){var M=E[A];if(M.type==C.SKIN_TYPE_INVITE)return M}return null},T.prototype.unlockByDiamond=function(E){var A=!1;return this.isCanUnlockByCertification(E)&&(A=o.MoneySystem.consumeDiamond(E.ticketCount))&&this.updateOwnedSkin(E.name,0)&&(this.flushOwnedSkin(),this.refreshOwnedSkin()),A},T.prototype.isCanUnlockByCertification=function(E){return E&&!this.isOwnedPermanent(E.name)&&0<E.ticketCount},T.prototype.updateInviteSkinCount=function(E){if(c.default.l("call updateInviteSkinCount. count = "+E),this.mSkinList){for(var A=!1,M=0;M<this.mSkinList.length;M++){var k=this.mSkinList[M];k.type==C.SKIN_TYPE_INVITE&&k.inviteCount!=E&&(A=!0,k.inviteCount=E)}A&&t.default.fire(i.default.UPDATE_SKIN_STORE_UI)}},T.prototype.isUnLockAllInviteSkin=function(){var E=n.default.Ins().getSkins().filter(function(L){return!!L.skinItem&&L.skinItem.skinType==d.SkinBean.SKIN_TYPE_INVITE}),A=E.length,M=0;if(E&&0<A){for(var k=0;k<A;k++){var D=E[k];D&&D.skinItem&&D.skinItem.name&&T.Ins().isOwnedPermanent(D.skinItem.name)&&M++}return M==A}return!1},T.prototype.readOwnedSkinList=function(){var E=[],A=s.default.read(r.default.SKIN_OWNED);c.default.l("readOwnedSkinList:",A),A!=null&&A!=null||(A=""),A.indexOf(T.SKIN_DEFAULT)<0&&E.push(T.SKIN_DEFAULT);var M=A.split("@");if(M!=null)for(var k=0;k<M.length;k++){var D=M[k];D!=null&&D!=null&&0<D.length&&E.indexOf(D)<0&&E.push(D)}return this.parseSkinList(E)},T.prototype.readCMSkinAdsInfo=function(){var E=[],A=s.default.read(r.default.Cm_SKIN_ADS_INFO);return c.default.l("readCMSkinAdsInfo:"+A),A&&A.split("@").forEach(function(M){if(M){var k=M.split(":"),D=g.default.parseIntFromString(k[1]);if(0<D){var L=new S;L.name=k[0],L.adsTimes=D,L.lastTime=g.default.parseIntFromString(k[2]),E.push(L)}}}),c.default.l("readCMSkinAdsInfo:",E),E},T.prototype.doFlushAdsSkin=function(){for(var E="",A=0;A<this.mSkinList.length;A++){var M=this.mSkinList[A],k=this.getOwnedSkin(M.name);(k==null||!k.isOwnedPermanent())&&0<M.watchAdsTimes&&(E+=M.name+":"+M.watchAdsTimes+":"+M.lastWatchAdsTime+"@")}0<E.length&&(E=E.substr(0,E.length-1)),c.default.l("doFlushAdsSkin:"+E),s.default.save(r.default.Cm_SKIN_ADS_INFO,E)},T.prototype.parseSkinList=function(E){for(var A=[],M=0;M<E.length;M++)A.push(I.parse(E[M]));return A},T.prototype.flushOwnedSkin=function(){for(var E=[],A=0;A<this.mOwnedSkinList.length;A++)E.push(this.mOwnedSkinList[A].toString());this.doFlushOwnedSkin(E),this.doFlushAdsSkin()},T.prototype.doFlushOwnedSkin=function(E){if(E!=null&&E!=null&&E.length!=0){var A=E.join("@");c.default.l("saveOwnedSkin:",A),s.default.save(r.default.SKIN_OWNED,A)}},T.prototype.initCurSkin=function(){var E=s.default.read(r.default.SKIN_USING);if(E==null||E==null||E.length==0)this.mCurSkin=T.SKIN_DEFAULT,this.mCurSkinDisplayName=T.SKIN_DEFAULT_DISPLAYNAME;else{var A=E.split("@");1<A.length?(this.mCurSkin=A[0],this.mCurSkinDisplayName=A[1]):(this.mCurSkin=T.SKIN_DEFAULT,this.mCurSkinDisplayName=T.SKIN_DEFAULT_DISPLAYNAME)}},T.prototype.saveCurSkin=function(E,A){this.mCurSkin=E,this.mCurSkinDisplayName=A,s.default.save(r.default.SKIN_USING,E+"@"+A)},T.prototype.getUnLockSkinNum=function(){return this.mOwnedSkinList.length},T.prototype.getUnLockPieceSkin=function(){var E=this,A=[];return this.mSkinList.forEach(function(M){if(M.isPiecesSkin()){var k=E.getOwnedSkin(M.name);k!=null&&k.isOwnedPermanent()||A.push(M)}}),A},T.ICE_SKIN_NAME="ice",T.GIRL_SKIN_NAME="girl",T.AFTERRAIN_SKIN_NAME="afterrain",T.CANDY_SKIN_NAME="candy",T._instance=null,T.SKIN_DEFAULT="default",T.SKIN_DEFAULT_DISPLAYNAME="\u7CFB\u7EDF\u9ED8\u8BA4",T}();m.SkinDataMgr=y;var S=function(){this.name="",this.adsTimes=0,this.lastTime=0};m.CMSkinAdsInfo=S;var I=function(){function T(E,A){this.id="",this.expireTime=-1,this.id=E,this.expireTime=A}return T.prototype.isOwnedPermanent=function(){return this.expireTime==0},T.prototype.toString=function(){return this.id+T.splitMark+this.expireTime},T.parse=function(E){var A=E.split(T.splitMark),M=new T(A[0]);return A&&A.length==2?M.expireTime=parseInt(A[1]):M.expireTime=0,M},T.splitMark=":",T}();m.SkinOwnedInfo=I;var v=function(){function T(E,A){this.skinName=E,this.inviteCountLimit=A}return T.prototype.getInviteCountLimit=function(){return this.inviteCountLimit},T}();m.InviteSkinInfo=v;var C=function(){function T(){this.name="",this.displayName="\u9ED8\u8BA4\u76AE\u80A4",this.resId="",this.type=T.SKIN_TYPE_CERTIFICATION,this.isUsing=!1,this.isLock=!0,this.isDownload=!1,this.isNeedUpdate=!1,this.ticketCount=0,this.goldCount=0,this.totalWatchAdsTimes=0,this.watchAdsTimes=0,this.lastWatchAdsTime=0,this.inviteCount=0,this.expireTime=-1,this.disCountEnable=!1,this.dis=0,this.ticket=0,this.disTicket=0,this.rmb=0,this.disRmb=0,this.skinId="",this.piecesTotal=0}return T.prototype.isPiecesSkin=function(){return 0<this.piecesTotal&&!u.StringUtil.isEmpty(this.piecesId)},T.SKIN_TYPE_DEFAULT="1",T.SKIN_TYPE_DAILYATTENDANCE="2",T.SKIN_TYPE_CERTIFICATION="3",T.SKIN_TYPE_INVITE="4",T.SKIN_TYPE_FIRST_PAY_ATTENTION="5",T.SKIN_TYPE_JOIN_FIGHT="6",T.SKIN_TYPE_LOTTERY="7",T.SKIN_TYPE_SHRAE="8",T}();m.SkinItemInfo=C,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../LogicPlatform/PlatformProxy":"PlatformProxy","../../base/G":"G","../../base/Log":"Log","../../config/LSKey":"LSKey","../../upgrade/ResBean":"ResBean","../../upgrade/ResMgr":"ResMgr","../../util/NumberUtil":"NumberUtil","../../util/PU":"PU","../../util/StringUtil":"StringUtil","../Network/Protocol/StorageUtil":"StorageUtil","../propAddition/Define":"Define","./EventBus":"EventBus","./MoneySystem":"MoneySystem","./NotifyEvent":"NotifyEvent"}],SkinElementPainter:[function(l,P,m){"use strict";cc._RF.push(P,"94e37qVMDRPhbuFwz3nGvIf","SkinElementPainter"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Background"),s=l("./AnimationBackground"),r=l("../gamescene/MUI/MUIFactory"),o=l("../gamescene/animation/action/MActionFactory"),e=function(){function n(t){this.skinObject=t,this.backgroundMap=new Object,this.spriteFrameCache=new Object,this.uiElementTextureMap=new Object,this.createBackground()}return n.prototype.update=function(t,i){var a=this.backgroundMap[i];a?a.update(t):this.homePageBackground&&this.homePageBackground.update(t)},n.prototype.captureBackground=function(t,i,a){var u=this.backgroundMap[t];u===void 0&&(u=this.createBackgroundByName(t),this.backgroundMap[t]=u),u!=null?u.attachSprite(i,a):this.homePageBackground.attachSprite(i,a)},n.prototype.captureElement=function(t,i,a){if(a&&t&&i){var u=this.skinObject.skinRaw.getUIElementEffectItem(t,i);u&&this.captureNode(u,a)}},n.prototype.captureNode=function(t,i){if(!(i instanceof cc.Scene)){if(this.captureButton(t,i),this.captureLabel(t,i),this.captureSprite(t,i),t.color){var a=new cc.Color;a.fromHEX(t.color),i.color=a}t.visible!=null&&(i.active=t.visible),t.rect!=null&&t.rect.length}if(t.children)for(var u=0,c=t.children.length;u<c;++u){var p=t.children[u],h=i.getChildByName(p.name);h&&this.captureNode(p,h)}},n.prototype.captureLabel=function(t,i){var a=i.getComponent(cc.Label);return!!a&&(t.string&&(a.string=t.string),t.fontSize&&(a.fontSize=t.fontSize),!0)},n.prototype.captureSprite=function(t,i){var a=i.getComponent(cc.Sprite);return!!a&&(t.imageData!=null&&t.imageItem!=null&&0<t.imageItem.length&&(a.spriteFrame=this.createUIElementsSpriteFrame(t.imageData,t.imageItem[0]),i.setContentSize(a.spriteFrame.getRect().size)),!0)},n.prototype.captureButton=function(t,i){var a=i.getComponent(cc.Button);return!!a&&(t.imageData!=null&&t.imageItem!=null&&(a.normalSprite=this.createUIElementsSpriteFrame(t.imageData,t.imageItem[0]),a.hoverSprite=this.createUIElementsSpriteFrame(t.imageData,t.imageItem[1]),a.pressedSprite=this.createUIElementsSpriteFrame(t.imageData,t.imageItem[2]),a.disabledSprite=this.createUIElementsSpriteFrame(t.imageData,t.imageItem[3])),!0)},n.prototype.createBackground=function(){var t=this.skinObject.skinRaw.createBackgroundEffects("home",this.skinObject,r.default.instance,o.default.instance);t&&t[0]&&t[0].node?(this.homePageBackground=new s.default,this.homePageBackground.load(t[0])):this.homePageBackground=new d.default},n.prototype.createBackgroundByName=function(t){var i=null,a=this.skinObject.skinRaw.createBackgroundEffects(t,this.skinObject,r.default.instance,o.default.instance);return a&&a[0]&&a[0].node?(i=new s.default).load(a[0]):i=null,i},n.prototype.createUIElementsSpriteFrame=function(t,i){var a=this.skinObject.atlasMap[t];if(a==null)return null;var u=a.getItem(i),c=new cc.Rect(0,0,0,0);if(u){var p=u.rect;c.x=p.x,c.y=p.y,c.width=p.width,c.height=p.height}var h=this.uiElementTextureMap[t];return h||(h=this.createUIElementTexture(a),this.uiElementTextureMap[t]=h),new cc.SpriteFrame(h,c)},n.prototype.createUIElementTexture=function(t){var i=new cc.Texture2D;return i.initWithElement(t.image),i.handleLoadedTexture(),i},n.prototype.destroy=function(){this.homePageBackground&&this.homePageBackground.destroy()},n}();m.default=e,cc._RF.pop()},{"../gamescene/MUI/MUIFactory":"MUIFactory","../gamescene/animation/action/MActionFactory":"MActionFactory","./AnimationBackground":"AnimationBackground","./Background":"Background"}],SkinGainPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"ef5f2/hGDxCY7bZjLETP1Da","SkinGainPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../../util/SUtil"),r=l("../Logic/SkinDataManager"),o=l("../Logic/EventBus"),e=l("../Logic/NotifyEvent"),n=l("../../util/PU"),t=l("../UI/GameEntraScene/ImgCache"),i=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),a=l("../../util/TimeUtil"),u=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),c=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),p=l("../UI/GameEntraScene/PrefabMgr"),h=l("../UI/GameEntraScene/ToastPrefab"),f=l("../../base/Log"),g=l("../Network/Protocol/StorageUtil"),_=l("../Logic/I18nManager"),y=l("../keypad/KeypadNavigator"),S=cc._decorator,I=S.ccclass,v=S.property,C=function(M){function k(){var L=M!==null&&M.apply(this,arguments)||this;return L.mRootNode=null,L.closeBtn=null,L.gainBtn1=null,L.gainBtn1Label1=null,L.gainBtn1Label2=null,L.gainBtn2=null,L.gainBtn2Label1=null,L.gainBtn2Label2=null,L.gainBtn3=null,L.gainBtn3Label1=null,L.gainBtn3Label2=null,L.rootSprite=null,L.rootSpriteText=null,L.mCloseClickCallback=null,L.mAdsLeftTime=-1,L.mSkinItenInfo=null,L.mBtn1Interactable=!0,L.mTimer=null,L.btn1ClickCb=null,L}var D;return __extends(k,M),(D=k).prototype.enResLoad=function(){var L=this;t.default.get("ui/skin_gain_bg_en",function(b,N){cc.isValid(L,!0)})},k.prototype.onLoad=function(){_.default.getInstance().isEnglish()&&this.enResLoad(),this.node.on(cc.Node.EventType.TOUCH_START,function(L){L.stopPropagation()}),this.initEvent(),this.initData(),y.default.getInstance().pushDialog(this.node)},k.prototype.onDestroy=function(){o.default.remove(e.default.UNLOCK_SKIN_PERMANENT,this.unlockSkin,this),this.clearTimer(),y.default.getInstance().popDialog(this.node)},k.prototype.initEvent=function(){var L=this;this.mCloseClickCallback=new d.default(function(){L.onClose()}),this.closeBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback),o.default.register(e.default.UNLOCK_SKIN_PERMANENT,this.unlockSkin,this)},k.prototype.onClose=function(){this.node.destroy()},k.prototype.unlockSkin=function(L,b){cc.isValid(this.node,!0)&&L==e.default.UNLOCK_SKIN_PERMANENT&&b[0]==this.mSkinItenInfo.name&&this.onClose()},k.prototype.start=function(){},k.prototype.setData=function(L){this.mGainItems=L},k.prototype.setSkinItemInfo=function(L){this.mSkinItenInfo=L},k.prototype.initData=function(){n.default.isCM()?(this.mGainItems[0]&&this.updateBtn1Ui(this.mGainItems[0]),this.mGainItems[1]&&this.updateBtn2Ui(this.mGainItems[1])):this.mGainItems&&2<=this.mGainItems.length?(this.updateBtn1Ui(this.mGainItems[0]),this.updateBtn2Ui(this.mGainItems[1]),this.mGainItems.length==3&&this.updateBtn3Ui(this.mGainItems[2])):this.mGainItems&&this.mGainItems.length==1&&(this.mGainItems[0].type==T.Other?(this.gainBtn2.node.active=!1,this.gainBtn3.node.active=!1,this.mRootNode.height=465,this.updateBtn1Ui(this.mGainItems[0])):(this.gainBtn1.node.active=!1,this.gainBtn2.node.active=!1,this.mRootNode.height=465,this.updateBtn3Ui(this.mGainItems[0])))},k.prototype.updateBtn3Ui=function(L){var b=this;L.type==T.Diamond?t.default.get("ui/skin_diamond_icon",function(H,R){cc.isValid(b.node,!0)&&(b.gainBtn3.getComponentInChildren(cc.Sprite).spriteFrame=R,_.default.getInstance().isEnglish()?b.gainBtn3Label1.string="Unlock by diamonds":b.gainBtn3Label1.string="\u94BB\u77F3\u89E3\u9501")}):L.type==T.GOLD&&t.default.get("musiclist/gold_icon",function(H,R){cc.isValid(b.node,!0)&&(b.gainBtn3.getComponentInChildren(cc.Sprite).spriteFrame=R,_.default.getInstance().isEnglish()?b.gainBtn3Label1.string="Unlock by gold coins":b.gainBtn3Label1.string="\u91D1\u5E01\u89E3\u9501")}),this.gainBtn3Label2.string=L.desc,s.SUtil.ins().toLeftByPx(this.gainBtn3Label1,71),s.SUtil.ins().toLeftByPx(this.gainBtn3Label2,476);var N=new d.default(function(){L.clickCb&&L.clickCb()});this.gainBtn3.node.on(cc.Node.EventType.TOUCH_END,N.click,N)},k.prototype.updateBtn2Ui=function(L){if(n.default.isCM())this.gainBtn2.node.active=!1,this.mRootNode.height=588,this.updateBtn3Ui(L);else if(L.type==T.Diamond)this.gainBtn2.node.active=!1,this.mRootNode.height=588,this.updateBtn3Ui(L);else{this.gainBtn2Label1.string=L.title,this.gainBtn2Label2.string=L.desc,s.SUtil.ins().toLeftByPx(this.gainBtn2Label1,71),s.SUtil.ins().toRightByPx(this.gainBtn2Label2,70);var b=new d.default(function(){L.clickCb&&L.clickCb()});this.gainBtn2.node.on(cc.Node.EventType.TOUCH_END,b.click,b)}},k.prototype.updateBtn1Ui=function(L){var b=this;if(L.type==T.ADS){var N="\u514D\u8D39\u83B7\u5F97(%s/%s)",H="\u770B%s\u6B21\u89C6\u9891\u5E7F\u544A";_.default.getInstance().isEnglish()&&(N="Free(%s/%s)",H="Watch %s Video Ad"),this.gainBtn1Label1.string=cc.js.formatStr(N,this.mSkinItenInfo.watchAdsTimes,this.mSkinItenInfo.totalWatchAdsTimes),s.SUtil.ins().toLeftByPx(this.gainBtn1Label1,71),i.MGUser.getCurrentServerRealTime({complete:function(R,F){cc.isValid(b,!0)&&(R&&F-b.mSkinItenInfo.lastWatchAdsTime<D.WATCH_ADS_TIME?b.updateBtn1InAdsInterval(L,D.WATCH_ADS_TIME-(F-b.mSkinItenInfo.lastWatchAdsTime)):(b.updateBtn1BgEnable(!0),b.gainBtn1Label2.string=cc.js.formatStr(H,b.mSkinItenInfo.totalWatchAdsTimes-b.mSkinItenInfo.watchAdsTimes),s.SUtil.ins().toRightByPx(b.gainBtn1Label2,70)))}})}else this.updateBtn1BgEnable(!0),this.gainBtn1Label1.string=L.title,this.gainBtn1Label2.string=L.desc,s.SUtil.ins().toLeftByPx(this.gainBtn1Label1,71),s.SUtil.ins().toRightByPx(this.gainBtn1Label2,70);this.btn1ClickCb==null&&(this.btn1ClickCb=new d.default(function(){b.mBtn1Interactable&&L.clickCb&&(L.clickCb(),L.type==T.ADS&&b.watchAds(L))}),this.gainBtn1.node.on(cc.Node.EventType.TOUCH_END,this.btn1ClickCb.click,this.btn1ClickCb))},k.prototype.updateBtn1BgEnable=function(L){var b=this;L?(this.mBtn1Interactable=!0,this.gainBtn1.interactable=!0,t.default.get("ui/skin_gain_blue",function(N,H){cc.isValid(b.node,!0)&&H&&(b.gainBtn1.normalSprite=H,b.gainBtn1.getComponent(cc.Sprite).spriteFrame=H)}),t.default.get("ui/skin_gain_blue_press",function(N,H){cc.isValid(b.node,!0)&&H&&(b.gainBtn1.pressedSprite=H)})):(this.mBtn1Interactable=!1,this.gainBtn1.interactable=!1,t.default.get("ui/sin_gain_enable",function(N,H){cc.isValid(b.node,!0)&&H&&(b.gainBtn1.normalSprite=H,b.gainBtn1.getComponent(cc.Sprite).spriteFrame=H)}))},k.prototype.updateBtn1InAdsInterval=function(L,b){this.updateBtn1BgEnable(!1);var N="\u514D\u8D39\u83B7\u5F97(%s/%s)";_.default.getInstance().isEnglish()&&(N="Free(%s/%s)"),this.gainBtn1Label1.string=cc.js.formatStr(N,this.mSkinItenInfo.watchAdsTimes,this.mSkinItenInfo.totalWatchAdsTimes),s.SUtil.ins().toLeftByPx(this.gainBtn1Label1,71),this.mAdsLeftTime=b,this.updateAdsLeftTime(),this.startTimer(L)},k.prototype.updateAdsLeftTime=function(){var L="\u540E\u53EF\u70B9";_.default.getInstance().isEnglish()&&(L=" Can Click"),this.gainBtn1Label2.string=a.default.convertSecondToMinutesSecond(Math.round(this.mAdsLeftTime/1e3))+L,s.SUtil.ins().toRightByPx(this.gainBtn1Label2,70)},k.prototype.startTimer=function(L){var b=this;this.mTimer==null&&(this.mTimer=setInterval(function(){cc.isValid(b,!0)&&(b.mAdsLeftTime-=1e3,b.mAdsLeftTime<=0?(b.updateBtn1Ui(L),b.clearTimer()):b.updateAdsLeftTime())},1e3))},k.prototype.clearTimer=function(){this.mTimer&&(clearInterval(this.mTimer),this.mTimer=null)},k.prototype.watchAds=function(L){var b=this,N=u.ADScene.SCENE_CM_PLAY_SKIN_WATCH_ADS;c.MGAdv.show(N,u.QQ_ADV_TYPE.VIDEO_TYPE_SKIN_UNLOCK,function(H){if(cc.isValid(b,!0))switch(H){case u.ADStat.NOT_NETWORK:b.showToastTips("No network available");break;case u.ADStat.SHOW_SUCCESS_CLOSE:f.default.i(D.TAG+" watchAds success "),b.onWatchAdsSuccess(L);break;case u.ADStat.SHOW_NOT_ENED_CLOSE:break;case u.ADStat.SHOW_GET_AD_FAILED:b.showToastTips("No video ads available")}})},k.prototype.onWatchAdsSuccess=function(L){var b=this;if(this.mSkinItenInfo.watchAdsTimes++,this.mSkinItenInfo.watchAdsTimes>=this.mSkinItenInfo.totalWatchAdsTimes)return this.onClose(),void o.default.fire(e.default.CM_SKIN_ADS_UNLOCK,this.mSkinItenInfo);i.MGUser.getCurrentServerRealTime({complete:function(N,H){cc.isValid(b,!0)&&(f.default.i(D.TAG+" onWatchAdsSuccess result = "+N+",serverTime = "+H),N?(b.mSkinItenInfo.lastWatchAdsTime=H,b.updateBtn1Ui(L),r.SkinDataMgr.Ins().doFlushAdsSkin()):b.onClose(),g.default.pushAsync())}})},k.prototype.showToastTips=function(L){var b=this;p.default.load("prefab/ToastPrefab",function(N,H){if(cc.isValid(b,!0)&&H){var R=H.getComponent(h.default);R.showTips(L,function(){H.destroy()}),R.setLong(!1),b.node.addChild(H)}})},k.TAG="SkinGainPrefab",k.WATCH_ADS_TIME=18e4,__decorate([v(cc.Node)],k.prototype,"mRootNode",void 0),__decorate([v(cc.Button)],k.prototype,"closeBtn",void 0),__decorate([v(cc.Button)],k.prototype,"gainBtn1",void 0),__decorate([v(cc.Label)],k.prototype,"gainBtn1Label1",void 0),__decorate([v(cc.Label)],k.prototype,"gainBtn1Label2",void 0),__decorate([v(cc.Button)],k.prototype,"gainBtn2",void 0),__decorate([v(cc.Label)],k.prototype,"gainBtn2Label1",void 0),__decorate([v(cc.Label)],k.prototype,"gainBtn2Label2",void 0),__decorate([v(cc.Button)],k.prototype,"gainBtn3",void 0),__decorate([v(cc.Label)],k.prototype,"gainBtn3Label1",void 0),__decorate([v(cc.Label)],k.prototype,"gainBtn3Label2",void 0),__decorate([v(cc.Sprite)],k.prototype,"rootSprite",void 0),__decorate([v(cc.Sprite)],k.prototype,"rootSpriteText",void 0),k=D=__decorate([I],k)}(cc.Component);m.default=C;var T,E,A=function(){this.type=T.Other};m.GainItem=A,(E=T=m.GainType||(m.GainType={}))[E.Other=0]="Other",E[E.Diamond=1]="Diamond",E[E.GOLD=2]="GOLD",E[E.ADS=3]="ADS",cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../util/PU":"PU","../../util/SUtil":"SUtil","../../util/TimeUtil":"TimeUtil","../Logic/EventBus":"EventBus","../Logic/I18nManager":"I18nManager","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../keypad/KeypadNavigator":"KeypadNavigator"}],SkinLoading:[function(l,P,m){"use strict";cc._RF.push(P,"9bf24Y3JCBJEr+E4x/LpU6I","SkinLoading"),Object.defineProperty(m,"__esModule",{value:!0});var d=cc._decorator,s=d.ccclass,r=(d.property,function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(n){n.stopPropagation()})},e.prototype.start=function(){this.getComponent(cc.Animation).play("skin_loading")},e=__decorate([s],e)}(cc.Component));m.default=r,cc._RF.pop()},{}],SkinManager:[function(l,P,m){"use strict";cc._RF.push(P,"4497cH4ePJADqrq8OJDZB6a","SkinManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/SkinDataManager"),s=l("../../base/Log"),r=l("../Logic/GameItemsManager"),o=l("./SkinUtils"),e=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),n=function(){function t(){}return t.Ins=function(){return this._ins||(this._ins=new t),this._ins},t.prototype.receiveSkin=function(i){var a=r.GameItemsManager.getIns().getItemById(i);return r.GameItemsManager.getIns().getItemTimeLimitDay(a.getItemId())==0?t.unlockSkin(i):this.receiveSkinReward(i)},t.prototype.receiveSkinReward=function(i){var a=r.GameItemsManager.getIns().getItemById(i),u=r.GameItemsManager.getIns().getItemTimeLimitDay(a.getItemId()),c=a.getKey(),p=this.addSkinExpireTime(c,u*t.ONE_DAY_MS);return s.default.l(t.TAG,"receiveSkinReward skinKey= "+c+", limitsDay = "+u+",result="+p),p},t.isOwnedPermanent=function(i){var a=r.GameItemsManager.getIns().getItemById(i);return d.SkinDataMgr.Ins().isOwnedPermanent(a.getKey())},t.unlockSkin=function(i){var a=r.GameItemsManager.getIns().getItemById(i);return r.GameItemsManager.getIns().getItemTypeByItemId(i)==r.GameItemType.TYPE_SKIN&&(d.SkinDataMgr.Ins().unlockSkin(a.getKey()),!0)},t.prototype.checkCurrentSkinTimeLimit=function(){if(!d.SkinDataMgr.Ins().isDefaultSkin()){var i=d.SkinDataMgr.Ins().getCurrentUseSkinInfo();if(!i.isOwnedPermanent()){var a=e.MGUser.getCurrentServerTime();i.expireTime<=a&&d.SkinDataMgr.Ins().alterDefaultSkin()}}},t.prototype.checkSkinTimeLimit=function(i,a){s.default.l(t.TAG,"checkSkinTimeLimit called");var u=this.getExpireTimeSkinList();s.default.l("checkSkinTimeLimit",u);for(var c=d.SkinDataMgr.Ins().getCurrentUseSkinInfo(),p=0;p<u.length;p++)c.id==u[p].id&&this.switchDefaultSkin(i,a);d.SkinDataMgr.Ins().removeSkinList(u)},t.prototype.switchDefaultSkin=function(i,a){var u=d.SkinDataMgr.Ins().getDefaultSkinItem();o.default.useSkin(u,i,null,null,function(){console.log("switchDefaultSkin success!"),a()},function(){console.log("switchDefaultSkin failed")})},t.prototype.getExpireTimeSkinList=function(){for(var i=e.MGUser.getCurrentServerTime(),a=d.SkinDataMgr.Ins().getOwnedSkinList(),u=[],c=0;c<a.length;c++){var p=a[c];p.expireTime!=0&&p.expireTime<=i&&u.push(p)}return u},t.prototype.addSkinExpireTime=function(i,a){return d.SkinDataMgr.Ins().addSkinExpireTime(i,a)},t.TAG="SkinManager",t.ONE_DAY_MS=864e5,t._ins=null,t}();m.SkinMgr=n,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../Logic/GameItemsManager":"GameItemsManager","../Logic/SkinDataManager":"SkinDataManager","./SkinUtils":"SkinUtils"}],SkinMgr:[function(l,P,m){"use strict";cc._RF.push(P,"933cfRp4lxCypfV5NJMW3FP","SkinMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./SkinObject"),s=l("../gamescene/atlas/SimpleAtlas"),r=l("../util/Utility"),o=l("../base/G"),e=l("./SkinRaw"),n=l("./Skin"),t=l("../util/ResLoader"),i=l("../util/PU"),a=l("../base/Log"),u=function(){this.name="",this.cancel=!1},c=function(){function p(){this.screenType="default",this.currentSkin=null,this.currentSkinTask=null,this.trialSkin=null,this.trialSkinTask=null}return p.prototype.setScreenType=function(h){this.screenType=h},p.prototype.switchSkin=function(h,f,g){var _=this;if(g===void 0&&(g=null),this.currentSkinTask)return a.default.i("SkinMgr => switchSkin => currentSkinTask exist",this.currentSkinTask),void(g&&g(r.Utility.SKINSWITCHESULT.EXISTINSTANCE));var y=new n.SkinProperty;y.fromJson(JSON.parse(f));var S=new u;S.name=h,this.currentSkinTask=S,this.loadSkin(S,h==="default",function(I,v){if(a.default.i("SkinMgr => switchSkin => loadskin result:",I,v),_.currentSkinTask=null,I){var C=_.currentSkin;_.currentSkin=I,_.currentSkin.setProperty(y),_.destroyOldSkinAtlas(C)}g&&g(v)})},p.prototype.destroyOldSkinAtlas=function(h){if(h){var f=h.getSkinObject().atlasMap;for(var g in f)f[g].onDestroy();h.getSkinElementPainter().destroy()}},p.prototype.cancelSwitchSkin=function(){this.currentSkinTask&&(this.currentSkinTask.cancel=!0)},p.prototype.getCurrentSkinItem=function(){return this.currentSkin},p.prototype.switchTrialSkin=function(h,f,g){var _=this;if(g===void 0&&(g=null),this.trialSkinTask)g&&g(r.Utility.SKINSWITCHESULT.EXISTINSTANCE);else{var y=new n.SkinProperty;y.fromJson(JSON.parse(f));var S=new u;S.name=h,this.trialSkinTask=S,this.loadSkin(S,h==="default",function(I,v){_.trialSkinTask=null,I&&(_.trialSkin=I,_.trialSkin.setProperty(y)),g&&g(v)})}},p.prototype.cancelSwitchTrialSkin=function(){this.trialSkinTask&&(this.trialSkinTask.cancel=!0)},p.prototype.getTrialSkinItem=function(){return this.trialSkin},p.prototype.destroyTrialSkin=function(){this.trialSkin=null},p.prototype.loadSkin=function(h,f,g){return __awaiter(this,void 0,void 0,function(){var _,y,S=this;return __generator(this,function(I){return _=h.name,y=this.getSkinUrl(_,_+".json",!1),t.default.loadJson(y,function(v,C){a.default.i("SKinMgr => loadSkin => loadJson",v,C),v?g(null,r.Utility.SKINSWITCHESULT.ERROR):h.cancel?g(null,r.Utility.SKINSWITCHESULT.CANCELED):S.parseSkin(h,new e.default(C),f,g)}),[2]})})},p.prototype.parseSkin=function(h,f,g,_){return _===void 0&&(_=null),__awaiter(this,void 0,void 0,function(){var y,S,I,v,C,T,E,A,M,k,D=this;return __generator(this,function(L){switch(L.label){case 0:for(y=h.name,(S=new d.default).name=y,S.skinRaw=f,this.calcInnerSize(S),I=f.getAtlasInfos(),T=0,E=I.length;T<E;++T)v=I[T],S.atlasMap[v.name]=this.createAtlas(y,v,g);if(C=f.getAnimationWorks())for(T=0,E=C.length;T<E;++T)A=C[T],S.animationWorks[A._name]=A;return M=0,[4,(k=function(){return __awaiter(D,void 0,void 0,function(){var b,N,H,R;return __generator(this,function(F){if(h.cancel)return a.default.i("SKinMgr => loadSkin => loadJson => parseSkin => checkFunction cancel.",h),_(null,r.Utility.SKINSWITCHESULT.CANCELED),[2];if(1e3<=M)return console.warn("Load skin failed."),a.default.i("SKinMgr => loadSkin => loadJson => parseSkin => checkFunction failed try time >=200.",h,M),_(null,r.Utility.SKINSWITCHESULT.TIMEOUT),[2];for(H in b=!0,N=S.atlasMap)if(!N[H].stepLoad()){b=!1;break}return b?(a.default.i("SKinMgr => loadSkin => loadJson => parseSkin => checkFunction finish success.",h),R=new n.default(S),_(R,r.Utility.SKINSWITCHESULT.SUCCESS)):(++M,setTimeout(k,10)),[2]})})})()];case 1:return L.sent(),[2]}})})},p.prototype.sleep=function(h){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(f){return[2,new Promise(function(g){return setTimeout(g,h)})]})})},p.prototype.calcInnerSize=function(h){if(h.blockSize.width=o.G.Ap.config.mBaseBlockWidth,h.blockSize.height=o.G.Ap.config.mBaseBlockHeight,h.sceneSize.width=o.G.Ap.config.presentWidth,h.sceneSize.height=o.G.Ap.config.presentHeight,h.adapterSize.width=Math.max(h.skinRaw.getDesign().width,h.sceneSize.width),h.adapterSize.height=Math.max(h.skinRaw.getDesign().height,h.sceneSize.height+2),h.adapterPos.x=0,void(h.adapterPos.y=0)!==h.skinRaw.getDesign().horizontal){var f=h.skinRaw.getDesign().horizontal;(g=f[this.screenType])||(g=f.default),g==="center"?h.adapterPos.x=(h.sceneSize.width-h.adapterSize.width)/2:g==="right"?h.adapterPos.x=h.sceneSize.width-h.adapterSize.width:typeof g=="number"&&(h.adapterPos.x=g)}if(h.skinRaw.getDesign().vertical!==void 0){var g,_=h.skinRaw.getDesign().vertical;(g=_[this.screenType])||(g=_.default),g==="center"?h.adapterPos.y=(h.sceneSize.height-h.adapterSize.height)/2:g==="top"?(h.adapterPos.y=Math.floor(h.sceneSize.height-h.adapterSize.height),h.adapterPos.y+=1):typeof g=="number"&&(g<=1&&(g=1),h.adapterPos.y=Math.min(h.sceneSize.height+g-h.adapterSize.height,0))}},p.prototype.createAtlas=function(h,f,g){var _=new s.default;_.loadImage(this.getSkinUrl(h,f.path,g));for(var y=0,S=f.items.length;y<S;++y){var I=f.items[y],v=I.scale9Grid||null,C=I.rect;_.addItem(I.name,new r.Utility.Rect(C.x,C.y,C.width,C.height),!1,v)}return _},p.prototype.getSkinUrl=function(h,f,g){var _=null;return _=0<=f.search("default/")?"resources/skin/"+f:"resources/skin/"+h+"/"+f,i.default.getResourcePath(_)},p}();m.default=c,cc._RF.pop()},{"../base/G":"G","../base/Log":"Log","../gamescene/atlas/SimpleAtlas":"SimpleAtlas","../util/PU":"PU","../util/ResLoader":"ResLoader","../util/Utility":"Utility","./Skin":"Skin","./SkinObject":"SkinObject","./SkinRaw":"SkinRaw"}],SkinObject:[function(l,P,m){"use strict";cc._RF.push(P,"a03a0qazsdKN6yZI6yb3oWZ","SkinObject"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.name="default",this.blockSize=new cc.Size(0,0),this.sceneSize=new cc.Size(0,0),this.adapterSize=new cc.Size(0,0),this.adapterPos=new cc.Vec2(0,0),this.skinRaw=null,this.atlasMap=new Object,this.animationWorks=new Object};m.default=d,cc._RF.pop()},{}],SkinPieceDataMgr:[function(l,P,m){"use strict";cc._RF.push(P,"92cac6o/xpATYiTNxWkxRTH","SkinPieceDataMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=function(){function o(){this.mPieceDataMap=new Map,this.loadConfigData(function(){})}return o.Ins=function(){return o._instance||(o._instance=new o),o._instance},o.prototype.getPieceConfig=function(e){return this.mPieceDataMap.get(e)||(console.error("the piece id is error "),null)},o.prototype.getAllPieceConfig=function(){return this.mPieceDataMap?this.mPieceDataMap:(console.error("the pieceDataMap is null"),null)},o.prototype.loadConfigData=function(e){var n=d.default.Ins().getDBRows(d.eDataBase.eDB_SkinPiece);n||(console.error("!!!!the robot data is error"),e(!1)),this.parseConfig(n)},o.prototype.parseConfig=function(e){for(var n=0,t=e;n<t.length;n++){var i=t[n],a=new r;a.ID=i.getID(),a.ItemID=i.getItemID(),a.GiftRate=i.getGiftRate(),a.VideoRate=i.getVideoRate();var u=this.mPieceDataMap.get(a.ItemID);u!=null&&u!=null?u=a:this.mPieceDataMap.set(a.ItemID,a)}},o._instance=null,o}();m.default=s;var r=function(){};m.SkinPieceConfig=r,cc._RF.pop()},{"../DB/DBMgr":"DBMgr"}],SkinPieceData:[function(l,P,m){"use strict";cc._RF.push(P,"353efXxV/ZH2b4vk4E6fG7u","SkinPieceData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.SkinPieceData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getID=function(){return this.getInt("id")},e.prototype.getItemID=function(){return this.getString("item_id")},e.prototype.getGiftRate=function(){return this.getInt("gift_rate")},e.prototype.getVideoRate=function(){return this.getInt("video_rate")},e}(d.default);m.SkinPieceRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],SkinPieceMgr:[function(l,P,m){"use strict";cc._RF.push(P,"a3721en+btNxbCsob59gX+C","SkinPieceMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("./../Logic/SkinDataManager"),o=l("../Network/Protocol/StorageUtil"),e=l("../../config/LSKey"),n=l("../Logic/SkinPieceDataMgr"),t=l("../../util/StringUtil"),i=l("../../util/Utility"),a=l("../Logic/EventBus"),u=l("../Logic/NotifyEvent"),c=l("../../base/Log"),p=l("./../../util/NumberUtil"),h=l("../Logic/GameItemsManager"),f=l("../../util/PU");(s=d=m.SkinType||(m.SkinType={}))[s.SongBox=0]="SongBox",s[s.VideoGift=1]="VideoGift";var g=function(){function y(){this.mPieceDic=new Map,this.readChipDataFromLocal()}return y.Ins=function(){return y._instance||(y._instance=new y),y._instance},y.prototype.readChipDataFromLocal=function(){var S=o.default.read(e.default.SKIN_PIECE_DATA,"error");S!="error"&&this.parseToDic(S)},y.prototype.generateSkinPieceRandomly=function(S,I,v){if(v===void 0&&(v=!0),f.default.isCM())return null;var C;switch(this.mPieceConfigDic||(this.mPieceConfigDic=n.default.Ins().getAllPieceConfig()),I){case d.SongBox:C=this.generatePieceSongBox();break;case d.VideoGift:C=this.generatePieceVideo()}var T=new _(C,S);return v&&C!=""&&this.addPiece([T]),t.StringUtil.isEmpty(C)||S<=0?null:T},y.prototype.generatePieceSongBox=function(){var S=0,I=i.Utility.getRandom(1,100),v="";return this.mPieceConfigDic.forEach(function(C,T){var E=C;S<I&&I<=S+E.GiftRate?v=E.ItemID:S+=E.GiftRate}),v},y.prototype.generatePieceVideo=function(){var S=0,I=i.Utility.getRandom(1,100),v="";return this.mPieceConfigDic.forEach(function(C,T){var E=C;S<I&&I<=S+E.VideoRate?v=E.ItemID:S+=E.VideoRate}),v},y.prototype.addPiece=function(S){var I=this;S.forEach(function(v){var C=I.mPieceDic.get(v.pieceID);C?C.count+=p.default.parseNum(v.count):(C=new _(v.pieceID,v.count),I.mPieceDic.set(C.pieceID,C)),a.default.fire(u.default.SKIN_TASK_UPDATE_PIECES_UI,v)}),this.saveChipDataToLocalStorage()},y.prototype.usePiece=function(S,I){var v=this.mPieceDic.get(S);v?(v.count-=I,v.count<0&&(c.default.e("piece use error"),v.count=0)):console.error("\u788E\u7247\u4F7F\u7528\u5F02\u5E38\uFF0C\u4E0D\u5B58\u5728"),this.saveChipDataToLocalStorage()},y.prototype.getPieceCount=function(S){if(!t.StringUtil.isEmpty(S)){var I=this.mPieceDic.get(S);return I?I.count:0}return 0},y.prototype.saveChipDataToLocalStorage=function(){var S=this.parseToString(this.mPieceDic);if(!S)throw new Error("\u788E\u7247\u6570\u636E\u51FA\u9519\uFF0CJson\u8F6C\u6362\u5F02\u5E38");o.default.save(e.default.SKIN_PIECE_DATA,S)},y.prototype.parseToString=function(S){var I=Object.create(null);return S.forEach(function(v,C){I[C]=v}),I?JSON.stringify(I):null},y.prototype.parseToDic=function(S){var I=this;if(t.StringUtil.isEmpty(S))c.default.e("\u8BFB\u53D6map\u9519\u8BEF \u4E3A\u7A7A");else{var v=JSON.parse(S);this.mPieceDic.clear(),Object.keys(v).forEach(function(C){var T=v[C];if(T){var E=p.default.parseNum(T.count),A=new _(T.pieceID,E);I.mPieceDic.set(C,A)}})}},y.prototype.isPieceFulled=function(S,I){if(S==null||S==null)return 0;var v=r.SkinDataMgr.Ins().getSkinByPieceId(S),C=Number.MAX_VALUE;if(v){if(!v.isPiecesSkin())return 0;var T=r.SkinDataMgr.Ins().getOwnedSkin(v.name);if(T!=null&&T.isOwnedPermanent())return I;C=v.piecesTotal}var E=this.getPieceCount(S)+I;return C<E?E-C:-1},y.prototype.isNeedShowPieceTipsDialog=function(S){var I=o.default.read(e.default.HAS_SHOW_SKIN_PIECE_TIPS_DIALOG);if(t.StringUtil.isEmpty(I)){for(var v=0;v<S.length;v++)if(S[v].awardType==h.GameItemType.TYPE_PIECE)return!0;return!1}return!1},y.PIECE_TO_GOLD=50,y._instance=null,y}();m.default=g;var _=function(y,S){this.pieceID=y,this.count=S};m.Piece=_,cc._RF.pop()},{"../../base/Log":"Log","../../config/LSKey":"LSKey","../../util/PU":"PU","../../util/StringUtil":"StringUtil","../../util/Utility":"Utility","../Logic/EventBus":"EventBus","../Logic/GameItemsManager":"GameItemsManager","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinPieceDataMgr":"SkinPieceDataMgr","../Network/Protocol/StorageUtil":"StorageUtil","./../../util/NumberUtil":"NumberUtil","./../Logic/SkinDataManager":"SkinDataManager"}],SkinRaw:[function(l,P,m){"use strict";cc._RF.push(P,"0c6a4+N105Lmpid1ysOn2Gz","SkinRaw"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../util/Utility"),s=l("../base/G"),r=l("../gamescene/MUI/MUIDefines"),o=function(){function n(t,i){i===void 0&&(i=null),this.node=t,this.actions=[],this.addAction(i)}return n.prototype.addAction=function(t){t&&this.actions.push(t)},n}();m.SkinEffectItem=o;var e=function(){function n(t){this.rawData=t,this.complementRawData(),this.createInnerSize()}return n.prototype.getDesign=function(){return this.rawData.design},n.prototype.getBlockEffectCount=function(){var t=this.rawData.blockEffect;return t?t.length:0},n.prototype.getBlockLongEffectCount=function(){var t=this.rawData.blockLongEffect||this.rawData.blockEffect;return t?t.length:0},n.prototype.getAtlasInfos=function(){return this.rawData.atlas},n.prototype.getAnimationWorks=function(){return this.rawData.animationWorks},n.prototype.getBlockAtlasName=function(){if(this.rawData.blockImage)return this.rawData.blockImage.imageData},n.prototype.getUIElementEffects=function(){return this.rawData.uiElementEffects},n.prototype.getUIElementEffectItem=function(t,i){var a=this.getUIElementEffects();if(!a)return null;var u=a[t];if(!u)return null;for(var c=null,p=0,h=u.length;p<h;++p){var f=u[p];if(f.name===i){c=f;break}}return c},n.prototype.createBlockEffectNode=function(t,i,a){var u=this.rawData.blockEffect;return!u||a>=u.length?null:this.createNode(t,u[a].node,i)},n.prototype.createBlockEffectAction=function(t,i,a){var u=this.rawData.blockEffect;return!u||a>=u.length?null:this.createMAction(t,u[a].action,i)},n.prototype.createBlockLongEffectNode=function(t,i,a){var u=this.rawData.blockLongEffect||this.rawData.blockEffect;return!u||a>=u.length?null:this.createNode(t,u[a].node,i)},n.prototype.createBlockLongEffectAction=function(t,i,a){var u=this.rawData.blockLongEffect||this.rawData.blockEffect;return!u||a>=u.length?null:this.createMAction(t,u[a].action,i)},n.prototype.createBackgroundNode=function(t,i){var a=this.rawData.backgroundImage;return this.createNode(t,a.node,i)},n.prototype.createBackgroundChangeActions=function(t,i){var a=this.rawData.backgroundImage;return a&&a.switch?this.createMActionGroup(t,a.switch.actions,i):null},n.prototype.createBackgroundLoopActions=function(t,i){var a=this.rawData.backgroundImage;return a&&a.loop?this.createMActionGroup(t,a.loop.actions,i):null},n.prototype.createBackgroundEffects=function(t,i,a,u){if(!this.rawData.backgroundEffects)return null;var c=this.rawData.backgroundEffects[t];if(!c)return null;for(var p=[],h=0,f=c.length;h<f;++h){var g=c[h],_=this.createNode(i,g.node,a);if(g.action){var y=this.createMAction(i,g.action,u);p.push(new o(_,y))}else if(g.actions){for(var S=new o(_),I=0,v=g.actions.length;I<v;++I)y=this.createMAction(i,g.actions[I],u),S.addAction(y);p.push(S)}}return p},n.prototype.createNode=function(t,i,a){if(i.type==null)return null;var u=null;if(i.type==="MUISprite"){var c=a.createSpriteNode(i.name);if(i.imageData){var p=t.atlasMap[i.imageData];c.imageData=p,i.imageItem&&(c.imageItem=p.getItem(i.imageItem)),i.frameSequence&&(c.frameSequence=p.createFrameSequence(i.frameSequence))}u=c}else u=a.createNode(i.name);if(i.opacity!==void 0&&u.setOpacity(i.opacity),i.rect)if(i.rect_max){var h=new d.Utility.Rect(0,0,0,0),f=new d.Utility.Rect(0,0,0,0),g=new d.Utility.Rect(0,0,0,0);this.convertRect(t,i.rect,h),this.convertRect(t,i.rect_max,f),this.randromRect(h,f,g);var _=g.width/h.width;u.getRect().set(g.x,g.y,h.width,h.height),u.setScale(_,_)}else this.convertRect(t,i.rect,u.getRect());if(i.children)for(var y=0,S=i.children.length;y<S;++y){var I=this.createNode(t,i.children[y],a);u.addChild(I)}return u},n.prototype.createMActionGroup=function(t,i,a){if(!i||!i.length||i.length<=0)return null;for(var u=[],c=0,p=i;c<p.length;c++){var h=p[c];u.push(this.createMAction(t,h,a))}return u},n.prototype.createMAction=function(t,i,a){if(i.type==null)return null;var u=i.type;switch(a.getIdByName(u)){case r.MUI.ActionId.ChildAction:if((V=i.params).child!==void 0&&V.action!==void 0){var c=this.createMAction(t,V.action,a);return a.createMChildAction(V.child,c)}break;case r.MUI.ActionId.Sequence:if((V=i.params)&&V.length){for(var p=[],h=0,f=V;h<f.length;h++){var g=f[h];(c=this.createMAction(t,g,a))&&p.push(c)}return(S=a.createMSequence()).addActions(p),S}break;case r.MUI.ActionId.Spawn:if((V=i.params)&&V.length){p=[];for(var _=0,y=V;_<y.length;_++)g=y[_],(c=this.createMAction(t,g,a))&&p.push(c);var S;return(S=a.createMSpawn()).addActions(p),S}break;case r.MUI.ActionId.PropValue:if((V=i.params).prop!==void 0&&V.value!==void 0){var I=V.value;return I==="null"?I=null:V.prop==="imageData"?I=t.atlasMap[V.value]:V.prop==="imageItem"&&V.imageData&&(I=t.atlasMap[V.imageData].getItem(V.value)),a.createMPropValue(V.prop,I)}break;case r.MUI.ActionId.ScaleTo:if((V=i.params).x!==void 0&&V.y!==void 0&&V.duration!==void 0)return a.createMScaleTo(V.x,V.y,V.duration);break;case r.MUI.ActionId.FadeTo:if((V=i.params).opacity!==void 0&&V.duration!==void 0)return a.createMFadeTo(V.opacity,V.duration);break;case r.MUI.ActionId.MoveTo:if((V=i.params).x!==void 0&&V.y!==void 0&&V.duration!==void 0)return a.createMMoveTo(V.x,V.y,V.duration);break;case r.MUI.ActionId.MoveBy:if((V=i.params).x!==void 0&&V.y!==void 0&&V.duration!==void 0)return a.createMMoveBy(V.x,V.y,V.duration);break;case r.MUI.ActionId.CircleMoveTo:if((V=i.params).centerX!==void 0&&V.centerY!==void 0&&V.angle!==void 0&&V.duration!==void 0)return a.createMCircleMoveTo(V.centerX,V.centerY,V.angle,V.duration);break;case r.MUI.ActionId.CircleMoveBy:if((V=i.params).centerX!==void 0&&V.centerY!==void 0&&V.angle!==void 0&&V.duration!==void 0)return a.createMCircleMoveBy(V.centerX,V.centerY,V.angle,V.duration);break;case r.MUI.ActionId.FrameSequence:if((V=i.params).frameCount!==void 0&&V.duration!==void 0)return a.createMFrameSequence(V.frameCount,V.duration);break;case r.MUI.ActionId.AdvanceAnimation:if((V=i.params).animation!==void 0){var v=t.animationWorks[V.animation];if(v)return a.createMAdvanceAnimation(v)}break;case r.MUI.ActionId.Delay:if((V=i.params).duration!==void 0)return a.createMDelayAction(V.duration);break;case r.MUI.ActionId.RandomMove:if((V=i.params).duration!==void 0){var C=V.cycle!==void 0?V.cycle:0,T=V.moveStep!==void 0?V.moveStep:0,E=new d.Utility.Rect(0,0,0,0);return V.moveRegion!==void 0&&this.convertRect(t,V.moveRegion,E),a.createMRandomMove(C,T,E,V.duration)}break;case r.MUI.ActionId.RandomFade:if((V=i.params).duration!==void 0&&V.cycle!==void 0)return a.createMRandomFade(V.cycle,V.duration);break;case r.MUI.ActionId.RandomChange:if((V=i.params).duration!==void 0){C=V.cycle!==void 0?V.cycle:0,T=V.moveStep!==void 0?V.moveStep:0;var A=V.moveStepX!==void 0?V.moveStepX:T,M=V.moveStepY!==void 0?V.moveStepY:T;E=new d.Utility.Rect(0,0,0,0),V.moveRegion!==void 0&&this.convertRect(t,V.moveRegion,E);var k=V.directX!==void 0?V.directX:0,D=V.directY!==void 0?V.directY:0,L=V.scaleMin!==void 0?V.scaleMin:1,b=V.scaleMax!==void 0?V.scaleMax:1,N=V.scaleOncePreCycle===void 0||V.scaleOncePreCycle,H=V.randomMoveOnHitEdge!==void 0&&V.randomMoveOnHitEdge,R=V.randomMoveOnFade!==void 0&&V.randomMoveOnFade,F=V.randomMoveOnHitEdgeMask!==void 0?V.randomMoveOnHitEdgeMask:H?15:0,x=V.opacityMin!==void 0?V.opacityMin:0,U=V.opacityMax!==void 0?V.opacityMax:1,B=V.opacityFollowScale!==void 0?V.opacityFollowScale:0,Q=V.frameCount!==void 0?V.frameCount:0,Z=V.frameSpeedMin!==void 0?V.frameSpeedMin:0,z=V.frameSpeedMax!==void 0?V.frameSpeedMax:0,W=E.clone();return V.bornRegion!==void 0&&this.convertRect(t,V.bornRegion,W),a.createMRandomChange(C,A,M,E,k,D,L,b,N,x,U,B,Q,Z,z,F,R,W,V.duration)}break;case r.MUI.ActionId.SetProperty:var V;if(V=JSON.parse(JSON.stringify(i.params))){if(V.imageData!==void 0&&(V.imageData=t.atlasMap[V.imageData]),V.imageItem!==void 0){var Y=V.imageData;Y&&V.imageItem!="null"?V.imageItem=Y.getItem(V.imageItem):V.imageItem=null}return a.createMSetProperty(V)}}return null},n.prototype.randromRect=function(t,i,a){a.x=Math.floor(t.x+(i.x-t.x)*Math.random()),a.y=Math.floor(t.y+(i.y-t.y)*Math.random()),a.width=Math.floor(t.width+(i.width-t.width)*Math.random()),a.height=Math.floor(t.height+(i.height-t.height)*Math.random())},n.prototype.convertRect=function(t,i,a){var u=i.heightAddtion!==void 0?this.getInnerValue(t,i.heightAddtion):0,c=i.widthAddtion!==void 0?this.getInnerValue(t,i.widthAddtion):0,p=i.xAddtion!==void 0?this.getInnerValue(t,i.xAddtion):0,h=i.yAddtion!==void 0?this.getInnerValue(t,i.yAddtion):0;a.width=this.getInnerValue(t,i.width)+c,a.height=this.getInnerValue(t,i.height)+u,a.x=this.getInnerValue(t,i.x)+p,a.y=this.getInnerValue(t,i.y)+h},n.prototype.getInnerValue=function(t,i){var a=0,u=this.innerSize[i];if(u)switch(u){case-1:a=t.sceneSize.width;break;case-2:a=t.sceneSize.height;break;case-3:a=t.adapterPos.x;break;case-4:a=t.adapterPos.y;break;case-5:a=t.adapterSize.width;break;case-6:a=t.adapterSize.height}else a=i;return a},n.prototype.createInnerSize=function(){this.innerSize=new Object,this.innerSize["scene.width"]=-1,this.innerSize["scene.height"]=-2,this.innerSize["adapter.x"]=-3,this.innerSize["adapter.y"]=-4,this.innerSize["adapter.width"]=-5,this.innerSize["adapter.height"]=-6},n.prototype.complementRawData=function(){s.G.Ap.config,this.rawData.design||(this.rawData.design=new Object);var t=this.rawData.design;t.width||(t.width=720),t.height||(t.height=1559),t.horizontal||(t.horizontal={default:"center"}),t.horizontal.default||(t.horizontal.default="center"),t.vertical||(t.vertical={s1:87,s2:35,s3:0,default:"center"}),t.vertical.default||(t.vertical.default="center"),t.longBlockDotAnimaion==null&&(t.longBlockDotAnimaion=!1)},n}();m.default=e,cc._RF.pop()},{"../base/G":"G","../gamescene/MUI/MUIDefines":"MUIDefines","../util/Utility":"Utility"}],SkinStoreItem:[function(l,P,m){"use strict";cc._RF.push(P,"4dea4MFoNhNiZrJzNStmfwN","SkinStoreItem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/SkinDataManager"),s=l("../UI/GameEntraScene/BasicTouchEvent"),r=l("../../base/Log"),o=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=l("../../util/PU"),n=l("./SkinPieceMgr"),t=l("../../util/StringUtil"),i=l("../Logic/EventBus"),a=l("../Logic/NotifyEvent"),u=l("../UI/GameEntraScene/ImgCache"),c=l("../propAddition/Define"),p=l("../Logic/I18nManager"),h=cc._decorator,f=h.ccclass,g=h.property,_=function(y){function S(){var v=y!==null&&y.apply(this,arguments)||this;return v.root_layout=null,v.skin_sprite=null,v.invite_tag_sprite=null,v.lock_sprite=null,v.skin_name_label=null,v.use_btn=null,v.gain_layout=null,v.try_btn=null,v.gain_btn=null,v.tips_label=null,v.time_txt=null,v.time_info=null,v.additionNode=null,v.additionRichText=null,v.pieceNode=null,v.pieceSprite=null,v.pieceCountLabel=null,v.mType=0,v.mToUseClickCallback=null,v.mTryUseClickCallback=null,v.mTryClickCallback=null,v.mGainClickCallback=null,v.hasInit=!1,v}var I;return __extends(S,y),(I=S).prototype.setTryCallback=function(v){this.tryCallback=v},S.prototype.setUseCallback=function(v){this.useCallback=v},S.prototype.setToSkinChipCallback=function(v){this.toSkinChipCallback=v},S.prototype.setConsumeCertificationCallback=function(v){this.consumeCertificationCallback=v},S.prototype.setSignGainCallback=function(v){this.signGainCallback=v},S.prototype.setPieceGainCallback=function(v){this.pieceGainCallback=v},S.prototype.onLoad=function(){this.initEvent()},S.prototype.start=function(){},S.prototype.onDestroy=function(){this.unRegistEvent()},S.prototype.initEvent=function(){i.default.register(a.default.SKIN_TASK_UPDATE_PIECES_UI,this.updatePieces,this),i.default.register(a.default.UNLOCK_NORMAL_SKIN_EVENT,this.unlockSkinRefresh,this)},S.prototype.unRegistEvent=function(){i.default.remove(a.default.SKIN_TASK_UPDATE_PIECES_UI,this.updatePieces,this),i.default.remove(a.default.UNLOCK_NORMAL_SKIN_EVENT,this.unlockSkinRefresh,this)},S.prototype.unlockSkinRefresh=function(v,C){v==a.default.UNLOCK_NORMAL_SKIN_EVENT&&this.mSkinItemInfo&&this.mSkinItemInfo.name==C[0]&&this.setData(d.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.mSkinItemInfo.skinId),this.itemID)},S.prototype.updatePieces=function(v,C){r.default.i("[SkinStoreItem]====>>> updatePieces \u66F4\u65B0 \u754C\u9762 \u788E\u7247\u6570\u91CF params = ",C);var T=C[0];this.mSkinItemInfo.piecesId==T.pieceID&&!d.SkinDataMgr.Ins().isOwnedPermanent(this.mSkinItemInfo.name)&&this.mSkinItemInfo.isPiecesSkin()&&this.pieceNode.active==1&&(this.pieceCountLabel.string=n.default.Ins().getPieceCount(this.mSkinItemInfo.piecesId)+"/"+this.mSkinItemInfo.piecesTotal)},S.prototype.setTouchCb=function(v,C){if(v&&C){var T=v instanceof cc.Component?v.node:v;T&&T.on(cc.Node.EventType.TOUCH_END,C.click,C)}},S.prototype.signGainClick=function(){this.signGainCallback&&this.mSkinItemInfo&&this.signGainCallback(this.mSkinItemInfo)},S.prototype.toUseClick=function(){this.useCallback&&this.mSkinItemInfo&&this.useCallback(this.mSkinItemInfo)},S.prototype.tryClick=function(){this.tryCallback&&this.mSkinItemInfo&&this.tryCallback(this.mSkinItemInfo)},S.prototype.ticketCountClick=function(){this.consumeCertificationCallback&&this.mSkinItemInfo&&this.consumeCertificationCallback(this.mSkinItemInfo)},S.prototype.setData=function(v,C){if(this.itemID=C,(this.mSkinItemInfo=v)!=null){if(this.root_layout.node.active=!0,this.mType=this.getShowType(v),this.skin_name_label.string=v.displayName,v.resId&&u.default.get2(v.resId,this.skin_sprite),!e.default.isCM()){var T=c.default.getAdditionDesc(v.skinId);t.StringUtil.isEmpty(T)&&(this.additionNode.active=!1)}this.updateUIByType(v),this.updateTimeInfo(v)}else this.root_layout.node.active=!1},S.prototype.updateTimeInfo=function(v){v.isLock||(v.expireTime==0?this.time_info.active=!1:(this.time_info.active=!0,this.updateTimeStr(v.expireTime)))},S.prototype.updateTimeStr=function(v){var C=v-o.MGUser.getCurrentServerTime(),T=0;(C=0<C?C:0)>=I.ONE_DAY_MS&&(T=Math.round(C/I.ONE_DAY_MS));var E=C%I.ONE_DAY_MS,A=Math.round(E/I.ONE_HOURS_MS+.5);1<=T?this.time_txt.string=T+p.default.getInstance().getLanguageByKey("label_text.day"):0<A&&(this.time_txt.string=A+p.default.getInstance().getLanguageByKey("label_text.hours"))},S.prototype.updateUIByType=function(v){this.tips_label.node.active=!1,this.pieceNode.active=!1,v.isLock?(this.lock_sprite.node.active=!0,this.use_btn.node.active=!1,this.gain_layout.node.active=!0,this.updateTryBtnStatus(this.try_btn),this.updateGainBtnUi(this.gain_btn),this.mType==I.TYPE_SIGN&&(this.tips_label.node.active=!0,this.tips_label.string=p.default.getInstance().getLanguageByKey("label_text.skin_first_charge_get"))):(this.lock_sprite.node.active=!1,this.tips_label.string=p.default.getInstance().getLanguageByKey("label_text.skin_owned"),this.isSkinUnlockPermanent(v)?(this.use_btn.node.active=!0,this.gain_layout.node.active=!1,this.updateUseBtnStatus(this.use_btn,v.isUsing)):(this.use_btn.node.active=!1,this.gain_layout.node.active=!0,this.updateUseBtnStatus(this.try_btn,v.isUsing,!1),this.updateGainBtnUi(this.gain_btn))),v.type==d.SkinItemInfo.SKIN_TYPE_INVITE&&e.default.supportCMOnshare()&&(this.invite_tag_sprite.node.active=!0)},S.prototype.updateGainBtnUi=function(v){var C=this;if(v!=null){var T=p.default.getInstance().getLanguageByKey("label_text.skin_get");v.getComponentInChildren(cc.RichText).string="<size=28>"+T+"</s>",u.default.get("/ui/skin_store_btn_use_normal",function(E,A){A&&v.isValid&&(v.getComponent(cc.Sprite).spriteFrame=A,v.normalSprite=A)}),u.default.get("/ui/skin_store_btn_use_pressed",function(E,A){A&&v.isValid&&(v.pressedSprite=A)}),this.mGainClickCallback==null&&(this.mGainClickCallback=new s.default(function(){r.default.i("SkinStoreItem mGainClickCallback this.mSkinItemInfo = ",C.mSkinItemInfo),C.signGainClick()}),this.setTouchCb(v,this.mGainClickCallback))}},S.prototype.updateTryBtnStatus=function(v){var C=this;v!=null&&(v.getComponentInChildren(cc.Label).string=p.default.getInstance().getLanguageByKey("label_text.skin_trial"),u.default.get("/ui/skin_store_btn_try_normal",function(T,E){E&&v.isValid&&(v.getComponent(cc.Sprite).spriteFrame=E,v.normalSprite=E)}),u.default.get("/ui/skin_store_btn_try_pressed",function(T,E){E&&v.isValid&&(v.pressedSprite=E)}),this.mTryUseClickCallback&&(v.node.off(cc.Node.EventType.TOUCH_END,this.mTryUseClickCallback.click,this.mTryUseClickCallback),this.mTryUseClickCallback=null),this.mTryClickCallback==null&&(this.mTryClickCallback=new s.default(function(){r.default.i("SkinStoreItem mTryClickCallback this.mSkinItemInfo = ",C.mSkinItemInfo),C.tryClick()}),this.setTouchCb(v,this.mTryClickCallback)))},S.prototype.updateUseBtnStatus=function(v,C,T){var E=this;T===void 0&&(T=!0),v!=null&&(v.interactable=!C,C?(v.getComponentInChildren(cc.Label).string=T?p.default.getInstance().getLanguageByKey("label_text.use_now"):p.default.getInstance().getLanguageByKey("label_text.litu"),u.default.get("/ui/skin_store_btn_use_disabled",function(A,M){M&&v.isValid&&(v.getComponent(cc.Sprite).spriteFrame=M,v.normalSprite=M)}),v==this.use_btn?this.mToUseClickCallback&&(v.node.off(cc.Node.EventType.TOUCH_END,this.mToUseClickCallback.click,this.mToUseClickCallback),this.mToUseClickCallback=null):v==this.try_btn&&(this.mTryClickCallback&&(v.node.off(cc.Node.EventType.TOUCH_END,this.mTryClickCallback.click,this.mTryClickCallback),this.mTryClickCallback=null),this.mTryUseClickCallback&&(v.node.off(cc.Node.EventType.TOUCH_END,this.mTryUseClickCallback.click,this.mTryUseClickCallback),this.mTryUseClickCallback=null))):(v.getComponentInChildren(cc.Label).string=p.default.getInstance().getLanguageByKey("label_text.use_now"),u.default.get("/ui/skin_store_btn_use_normal",function(A,M){M&&v.isValid&&(v.getComponent(cc.Sprite).spriteFrame=M,v.normalSprite=M)}),u.default.get("/ui/skin_store_btn_use_pressed",function(A,M){M&&v.isValid&&(v.pressedSprite=M)}),v==this.use_btn?this.mToUseClickCallback==null&&(this.mToUseClickCallback=new s.default(function(){r.default.l("SkinStoreItem mToUseClickCallback"),E.toUseClick()}),this.setTouchCb(v,this.mToUseClickCallback)):v==this.try_btn&&(this.mTryClickCallback&&(v.node.off(cc.Node.EventType.TOUCH_END,this.mTryClickCallback.click,this.mTryClickCallback),this.mTryClickCallback=null),this.mTryUseClickCallback==null&&(this.mTryUseClickCallback=new s.default(function(){r.default.l("SkinStoreItem mToUseClickCallback"),E.toUseClick()}),this.setTouchCb(v,this.mTryUseClickCallback)))))},S.prototype.setTryBtnEnable=function(v,C){var T=this;v!=null&&((v.interactable=C)?(u.default.get("/ui/skin_store_btn_try_normal",function(E,A){A&&cc.isValid(T,!0)&&(v.getComponent(cc.Sprite).spriteFrame=A,v.normalSprite=A)}),u.default.get("/ui/skin_store_btn_try_pressed",function(E,A){A&&cc.isValid(T,!0)&&(v.getComponent(cc.Sprite).spriteFrame=A,v.normalSprite=A)})):(u.default.get("/ui/skin_store_btn_use_disabled",function(E,A){A&&cc.isValid(T,!0)&&(v.getComponent(cc.Sprite).spriteFrame=A,v.normalSprite=A)}),u.default.get("/ui/skin_store_btn_use_disabled",function(E,A){A&&cc.isValid(T,!0)&&(v.getComponent(cc.Sprite).spriteFrame=A,v.normalSprite=A)})))},S.prototype.getShowType=function(v){var C=I.TYPE_TICKET;return v.type==d.SkinItemInfo.SKIN_TYPE_DAILYATTENDANCE&&(C=I.TYPE_SIGN),v.type==d.SkinItemInfo.SKIN_TYPE_CERTIFICATION&&(C=I.TYPE_TICKET),v.type==d.SkinItemInfo.SKIN_TYPE_INVITE&&(C=I.TYPE_INVITE),v.type==d.SkinItemInfo.SKIN_TYPE_FIRST_PAY_ATTENTION&&(C=e.default.isIOS()?I.TYPE_TICKET:I.TYPE_FIRST_PAY),v.type==d.SkinItemInfo.SKIN_TYPE_JOIN_FIGHT&&(C=I.TYPE_FIGHT),C},S.prototype.isSkinUnlockPermanent=function(v){var C=d.SkinDataMgr.Ins().getOwnedSkin(v.name);return!(C==null||!C.isOwnedPermanent())},S.TYPE_SIGN=3,S.TYPE_TICKET=4,S.TYPE_INVITE=5,S.TYPE_FIRST_PAY=6,S.TYPE_FIGHT=7,S.ONE_DAY_MS=864e5,S.ONE_HOURS_MS=36e5,__decorate([g(cc.Layout)],S.prototype,"root_layout",void 0),__decorate([g(cc.Sprite)],S.prototype,"skin_sprite",void 0),__decorate([g(cc.Sprite)],S.prototype,"invite_tag_sprite",void 0),__decorate([g(cc.Sprite)],S.prototype,"lock_sprite",void 0),__decorate([g(cc.Label)],S.prototype,"skin_name_label",void 0),__decorate([g(cc.Button)],S.prototype,"use_btn",void 0),__decorate([g(cc.Layout)],S.prototype,"gain_layout",void 0),__decorate([g(cc.Button)],S.prototype,"try_btn",void 0),__decorate([g(cc.Button)],S.prototype,"gain_btn",void 0),__decorate([g(cc.Label)],S.prototype,"tips_label",void 0),__decorate([g(cc.Label)],S.prototype,"time_txt",void 0),__decorate([g(cc.Node)],S.prototype,"time_info",void 0),__decorate([g(cc.Node)],S.prototype,"additionNode",void 0),__decorate([g(cc.RichText)],S.prototype,"additionRichText",void 0),__decorate([g(cc.Node)],S.prototype,"pieceNode",void 0),__decorate([g(cc.Sprite)],S.prototype,"pieceSprite",void 0),__decorate([g(cc.Label)],S.prototype,"pieceCountLabel",void 0),S=I=__decorate([f],S)}(cc.Component);m.default=_,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../util/PU":"PU","../../util/StringUtil":"StringUtil","../Logic/EventBus":"EventBus","../Logic/I18nManager":"I18nManager","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../propAddition/Define":"Define","./SkinPieceMgr":"SkinPieceMgr"}],SkinStore:[function(l,P,m){"use strict";cc._RF.push(P,"86990MHeLRNTrGlrOdOI26A","SkinStore"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/SkinDataManager"),s=l("./SkinStoreItem"),r=l("../UI/GameEntraScene/BasicTouchEvent"),o=l("../UI/GameEntraScene/ToastPrefab"),e=l("../Logic/EventBus"),n=l("../Logic/NotifyEvent"),t=l("../Network/Protocol/StorageUtil"),i=l("../../base/G"),a=l("./SkinTryData"),u=l("../../infoc/m_p2_PData_Dia"),c=l("../../util/SUtil"),p=l("./SkinUtils"),h=l("../../util/PU"),f=l("../UI/GameEntraScene/PrefabMgr"),g=l("../../util/StringUtil"),_=l("./frag/SkinTaskItem"),y=l("../../base/Log"),S=l("../awardcontroller/AwardController"),I=l("../Logic/GameItemsManager"),v=l("./SkinPieceMgr"),C=l("./BuySkinDiamondNotEnough"),T=l("./SkinTaskPageViewPrefab"),E=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),A=l("../../infoc/m_p2_skin_piece"),M=l("../UI/GameEntraScene/ImgCache"),k=l("./SkinGainPrefab"),D=l("../../../modules/MGAppShare/scripts/MGShareUtil"),L=l("../reward/ActivityBean"),b=l("../Logic/MoneySystem"),N=l("../shop/DialogOneButtonPrefab"),H=l("../UI/GameEntraScene/MusicLib/HotMusicCMShareController"),R=l("../Logic/I18nManager"),F=l("../keypad/KeypadNavigator"),x=cc._decorator,U=x.ccclass,B=x.property,Q=function(Z){function z(){var W=Z!==null&&Z.apply(this,arguments)||this;return W.root_layout=null,W.defaultBtn=null,W.back_btn=null,W.scrollView=null,W.spawnCount=0,W.totalCount=0,W.hSpacing=0,W.wSpacing=0,W.bufferZone=0,W.mItemPrefab=null,W.mToastPrefab=null,W.popup_layout=null,W.mSkinStoreSprite=null,W.mBuySkinDiamondNotEnoughPrefab=null,W.mCloseClickCallback=null,W.mShareGiftClickCallback=null,W.mSkinPuzzleClickCallback=null,W.mDefaultClickCb=null,W.mContent=null,W.itemTemplate=null,W.items=[],W.mRealIndex=[],W.itemHeight=466,W.itemWidth=316,W.lastContentPosY=0,W.mIntialPosition=-1,W.skinChangeCallback=null,W}return __extends(z,Z),z.prototype.setCloseCallback=function(W){this.closeCallback=W},z.prototype.setSkinChangeCallback=function(W){this.skinChangeCallback=W},z.prototype.setShareGiftCallback=function(W){this.shareGiftCallback=W},z.prototype.setInviteSkinCallback=function(W){this.inviteSkinCallback=W},z.prototype.setCMInviteSkinCallback=function(W){this.cmInviteSkinCallback=W},z.prototype.setJoinFightSkinCB=function(W){this.joinFightSkinCallBack=W},z.prototype.setNormalMusicPageCb=function(W){this.normalMusicPageCb=W},z.prototype.setLotteryPageCb=function(W){this.lotteryPageCb=W},z.prototype.setFightFriendInviteCb=function(W){this.fightFriendInviteCb=W},z.prototype.setGoldNotEnoughCb=function(W){this.goldNotEnoughCb=W},z.prototype.enResLoad=function(){var W=this;this.enSpriteSetNull(),M.default.get("ui/skin_store_use_default_en",function(V,Y){cc.isValid(W,!0)&&(W.defaultBtn.normalSprite=Y)}),M.default.get("ui/skin_store_use_default_press_en",function(V,Y){cc.isValid(W,!0)&&(W.defaultBtn.pressedSprite=Y)})},z.prototype.enSpriteSetNull=function(){this.defaultBtn.getComponent(cc.Sprite).spriteFrame=null},z.prototype.onLoad=function(){R.default.getInstance().isEnglish()&&this.enResLoad(),this.onSkinChange(),this.node.on(cc.Node.EventType.TOUCH_START,function(W){W.stopPropagation()}),this.mContent=this.scrollView.content,this.adapterUI(),this.initEvent(),this.updateDefaultSkinUi(),this.initializeScrollView(),this.initData(),this.initInviteSkinData(),F.default.getInstance().pushDialog(this.node,"SkinStorePrefab")},z.prototype.firstPayUnLock=function(){this.dataSetChanged()},z.prototype.start=function(){i.G.skinTryData&&i.G.skinTryData.trySkinFinish&&i.G.skinTryData.source!=a.default.SOURCE_NONE&&(i.G.skinTryData.source=a.default.SOURCE_NONE,i.G.skinTryData.trySkinFinish=!1)},z.prototype.onDestroy=function(){e.default.remove(n.default.UPDATE_SKIN_STORE_UI,this.unlockInviteSkin,this),e.default.remove(n.default.FIRST_PAY_UNLOCK_SKIN,this.firstPayUnLock,this),e.default.remove(n.default.SKIN_TASK_GOLY_BUY_NOT_ENOUGH,this.goldNotEnough,this),e.default.remove(n.default.CM_SKIN_ADS_UNLOCK,this.cmAdsUnlockSkin,this),e.default.remove(n.default.PLAY_TRIAL_FINISHED,this.onPlayTrailFinished,this),F.default.getInstance().popDialog(this.node,"SkinStorePrefab")},z.prototype.onSkinChange=function(){this.applySkin()},z.prototype.applySkin=function(){var W=i.G.Ap.skinMgr.getCurrentSkinItem();if(W){var V=this.node.getChildByName("bg"),Y=this.node.getChildByName("animation_bkg");W.getSkinElementPainter().captureBackground("SkinStore",V,Y)}},z.prototype.initData=function(){},z.prototype.initEvent=function(){var W=this;this.mCloseClickCallback=new r.default(function(){W.backClick()}),this.back_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseClickCallback.click,this.mCloseClickCallback),e.default.register(n.default.UPDATE_SKIN_STORE_UI,this.unlockInviteSkin,this),e.default.register(n.default.FIRST_PAY_UNLOCK_SKIN,this.firstPayUnLock,this),e.default.register(n.default.SKIN_TASK_GOLY_BUY_NOT_ENOUGH,this.goldNotEnough,this),e.default.register(n.default.CM_SKIN_ADS_UNLOCK,this.cmAdsUnlockSkin,this),e.default.register(n.default.PLAY_TRIAL_FINISHED,this.onPlayTrailFinished,this)},z.prototype.onPlayTrailFinished=function(){var W=this;console.warn("===== onPlayTrailFinished ====="),setTimeout(function(){F.default.getInstance().gotoPage(cc.director.getScene(),"MainPagePrefab","onPlayTrailFinished"),F.default.getInstance().pushDialog(W.node,"SkinStorePrefab")},500)},z.prototype.tryFinishShowGain=function(W,V){var Y=V[0];if(Y&&i.G.skinTryData.source==a.default.SOURCE_SKIN_STORE)if(y.default.i("SkinStore===> onstart tryfinish itemInfo = ",Y),Y&&!d.SkinDataMgr.Ins().isOwnedPermanent(d.SkinItemInfo.name)&&Y.type==d.SkinItemInfo.SKIN_TYPE_INVITE)this.itemSignGainSkinCallback(Y);else{var q=d.SkinDataMgr.Ins().getOwnedSkin(Y.name);q!=null&&q.isOwnedPermanent()||!Y.isPiecesSkin()||this.itemPieceGainSkinCallback(Y)}},z.prototype.piecesUnlockSkin=function(W,V){y.default.i("[SkinStore]===>>> piecesUnlockSkin eventName = "+W+" params = ",V);var Y=V[0];this.showAwardPage(Y),this.dataSetChanged(),this.usePieces(Y)},z.prototype.usePieces=function(W){v.default.Ins().usePiece(W.piecesId,v.default.Ins().getPieceCount(W.piecesId))},z.prototype.showAwardPage=function(W){var V="/static_res/share_gift_congratulation_title",Y="\u597D\u7684";R.default.getInstance().isEnglish()&&(V="/static_res/share_gift_congratulation_title_en",Y="ok");var q=new S.AwardResultInfo;if(q.setTitlePicPath(V).setIsNeedGiveAwardInfo(!0).setBottomSecondTip("").setOkBtn(Y,function(){S.AwardController.getIns().dismissAwardResultPage(q)}),v.default.Ins().getPieceCount(W.piecesId)>W.piecesTotal){var J=(v.default.Ins().getPieceCount(W.piecesId)-W.piecesTotal)*v.default.PIECE_TO_GOLD;R.default.getInstance().isEnglish()?q.setBottomSecondTip("Unlocking the remaining skin puzzle has been converted into "+J+" diamonds"):q.setBottomSecondTip("\u89E3\u9501\u5269\u4F59\u7684\u76AE\u80A4\u788E\u7247\u5DF2\u8F6C\u5316\u4E3A"+J+"\u94BB\u77F3"),q.addAwardContent(I.GameItemType.TYPE_GOLD,J,W.skinId)}q.addAwardContent(I.GameItemType.TYPE_SKIN,1,W.skinId),S.AwardController.getIns().showAwardResultPage(q)},z.prototype.goldNotEnough=function(){this.goldNotEnoughCb&&this.goldNotEnoughCb()},z.prototype.unlockInviteSkin=function(){this.dataSetChanged()},z.prototype.initInviteSkinData=function(){},z.prototype.backClick=function(){this.closeCallback&&this.closeCallback()},z.prototype.itemUseSkinCallback=function(W){var V=this;p.default.useSkin(W,this.popup_layout.node,function(){V.dataSetChanged()},function(){},function(){V.dataSetChanged(),V.skinChangeCallback&&V.skinChangeCallback()},function(){})},z.prototype.itemTrySkinCallback=function(W){var V=this;p.default.trySkin(W,this.popup_layout.node,function(){V.dataSetChanged()},function(){},function(){i.G.skinTryData||(i.G.skinTryData=new a.default),i.G.skinTryData.source=a.default.SOURCE_SKIN_STORE,i.G.skinTryData.itemInfo=W})},z.prototype.itemConsumeGoldCallback=function(W){d.SkinDataMgr.Ins().isOwnedPermanent(W.name)||(b.MoneySystem.getGoldCount()>=W.goldCount?(b.MoneySystem.consumeGold(W.goldCount),this.showCMUnlockSkinDialog(W)):this.goldNotEnough())},z.prototype.itemConsumeCertificationCallback=function(W){d.SkinDataMgr.Ins().isOwnedPermanent(W.name)||(W.disCountEnable===!1||h.default.isIOS())&&this.buySkinForIOS(W)},z.prototype.buySkinForIOS=function(W){d.SkinDataMgr.Ins().unlockByDiamond(W)?(W.isLock=!1,this.dataSetChanged(),this.itemUseSkinCallback(W),u.default.report(W.ticketCount,u.default.SOURCE_BUY_SKIN,u.default.ACTION_CONSUME_DIAMOND),t.default.pushAsync()):this.showDiamondNotEnoughPopup()},z.prototype.taskGoingListener=function(W){switch(y.default.i("[SkinStore]===>>> taskGoingListener  task = ",W),W.taskId){case _.SKinTaskID.TASK_FIGHT_FRIEND_TIMES:this.fightFriendInviteCb&&this.fightFriendInviteCb();break;case _.SKinTaskID.TASK_FIGHT_PLAY_COUNT:case _.SKinTaskID.TASK_FIGHT_USE_PROP_TIMES:case _.SKinTaskID.TASK_FIGHT_WIN_COUNT:this.joinFightSkinCallBack&&this.joinFightSkinCallBack();break;case _.SKinTaskID.TASK_NORMAL_GAIN_CROWN:case _.SKinTaskID.TASK_NORMAL_RELIVE_TIMES:this.normalMusicPageCb&&(this.closeCallback&&this.closeCallback(),this.normalMusicPageCb());break;case _.SKinTaskID.TASK_LOTTERY:this.lotteryPageCb&&this.lotteryPageCb();break;case _.SKinTaskID.TASK_SHARE_FOR_NEW_PLAYER:E.MGUser.getUserLoginInfo({complete:function(V){V&&E.MGUser.getUserBasicInfo({complete:function(Y){D.MGShareUtils.shareForSKinPiece(Y?Y.nickName:"--",V.playerId,L.ActivityConstantConfig.ACTIVITY_ID_SHARE_FOR_SKIN_PIECE+W.skinId,W.skinId)}})}})}},z.prototype.itemPieceGainSkinCallback=function(W){this.showSkinTaskPageView(W,A.default.SOURCE_SKIN_STORE)},z.prototype.showSkinTaskPageView=function(W,V,Y){var q=this;y.default.i("[SkinStore]===>>> showSkinTaskPageView  skin = ",W),W&&0<W.piecesTotal&&!g.StringUtil.isEmpty(W.piecesId)&&f.default.load("prefab/SkinTaskPageViewPrefab",function(J,ee){var $=ee.getComponent(T.default);$.showSkinTask(W),$.setSource(V),$.setTaskGoingListerer(q.taskGoingListener.bind(q)),$.setCloseCb(function(){Y&&Y()}),q.node.addChild(ee)})},z.prototype.itemSignGainSkinCallback=function(W){if(h.default.isCM())if(W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_DAILYATTENDANCE){var V=R.default.getInstance().getLanguageByKey("label_text.skin_sign_get");this.showToast(V)}else h.default.supportCMOnshare()&&W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_INVITE?(console.log("CMPlayShare: SkinStroe ===> gainSkin"),this.cmInviteSkinCallback&&this.cmInviteSkinCallback(W)):this.showGainPopup(W);else W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_DAILYATTENDANCE?(V=R.default.getInstance().getLanguageByKey("label_text.skin_sign_get"),this.showToast(V)):W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_INVITE?this.inviteSkinCallback&&this.inviteSkinCallback(!1,0,!1):W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_JOIN_FIGHT?this.joinFightSkinCallBack&&this.joinFightSkinCallBack({showSeasonReward:!0}):W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_FIRST_PAY_ATTENTION?this.showGainPopup(W):W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_LOTTERY?this.showGainPopup(W):W&&!d.SkinDataMgr.Ins().isOwnedPermanent(W.name)&&W.type==d.SkinItemInfo.SKIN_TYPE_SHRAE&&this.showGainPopup(W)},z.prototype.showCMUnlockSkinRewards=function(W){var V=this,Y=new S.AwardResultInfo;R.default.getInstance().isEnglish()?Y.setTitlePicPath("/static_res/share_gift_congratulation_title_en").setIsNeedGiveAwardInfo(!0).setBottomSecondTip("").setOkBtn("Ok",function(){S.AwardController.getIns().dismissAwardResultPage(Y),setTimeout(function(){F.default.getInstance().refreshPage(V.node,"SkinStorePrefab")},200)}):Y.setTitlePicPath("/static_res/share_gift_congratulation_title").setIsNeedGiveAwardInfo(!0).setBottomSecondTip("").setOkBtn("\u597D\u7684",function(){S.AwardController.getIns().dismissAwardResultPage(Y),setTimeout(function(){F.default.getInstance().refreshPage(V.node,"SkinStorePrefab")},200)}),Y.addAwardContent(I.GameItemType.TYPE_SKIN,1,W.skinId),S.AwardController.getIns().showAwardResultPage(Y)},z.prototype.showCMUnlockSkinDialog=function(W){var V=this;f.default.load("prefab/shop/DialogOneButtonPrefab",function(Y,q){var J=q.getComponent(N.default);R.default.getInstance().isEnglish()?(J.setContent("<color=3B5D72><size=30>Congratulations,"+W.displayName+" unlock!</size></color>"),J.setBtnTxt("Get")):(J.setContent("<color=3B5D72><size=30>\u606D\u559C\u60A8,"+W.displayName+"\u76AE\u80A4\u5DF2\u6C38\u4E45\u89E3\u9501!</size></color>"),J.setBtnTxt("\u9886\u53D6")),J.setBottonCallback(function(ee){ee.destroy(),V.showCMUnlockSkinRewards(W),V.dataSetChanged()}),V.node.addChild(q)})},z.prototype.cmAdsUnlockSkin=function(W,V){var Y=V[0];this.showCMUnlockSkinDialog(Y),H.default.Ins().removeSkinItemInfo(Y)},z.prototype.getGainItems=function(W){var V=this,Y=[];return function(){var q=new k.GainItem;R.default.getInstance().isEnglish()?(q.title=cc.js.formatStr("Receive for free(%s/%s)",W.watchAdsTimes,W.totalWatchAdsTimes),q.desc=cc.js.formatStr("Watch %s video ads",W.totalWatchAdsTimes-W.watchAdsTimes)):(q.title=cc.js.formatStr("\u514D\u8D39\u83B7\u5F97(%s/%s)",W.watchAdsTimes,W.totalWatchAdsTimes),q.desc=cc.js.formatStr("\u770B%s\u6B21\u89C6\u9891\u5E7F\u544A",W.totalWatchAdsTimes-W.watchAdsTimes)),q.type=k.GainType.ADS,q.clickCb=function(){}.bind(V),Y.push(q)}(),function(){var q=new k.GainItem;R.default.getInstance().isEnglish()?q.title="Purchase":q.title="\u8D2D\u4E70\u83B7\u5F97",q.desc="x"+W.goldCount,q.type=k.GainType.GOLD,q.clickCb=function(){V.itemConsumeGoldCallback(W)}.bind(V),Y.push(q)}(),Y},z.prototype.showGainPopup=function(W){var V=this,Y=this.getGainItems(W);Y&&0<Y.length&&f.default.load("/prefab/SkinGainPrefab",function(q,J){if(J){var ee=J.getComponent(k.default);ee.setData(Y),ee.setSkinItemInfo(W),V.popup_layout.node.addChild(J)}})},z.prototype.dataSetChanged=function(){this.updateDefaultSkinUi();for(var W,V,Y=this.mRealIndex.length,q=0;q<Y;q++)W=this.mRealIndex[q],(V=this.items[W].getComponent(s.default)).setData(d.SkinDataMgr.Ins().getSkinListExceptDefault()[V.itemID],V.itemID)},z.prototype.showToast=function(W){var V=cc.instantiate(this.mToastPrefab);V.getComponent(o.default).showTips(W,function(){V.destroy()}),cc.director.getScene().addChild(V)},z.prototype.showDiamondNotEnoughPopup=function(){var W=this,V=cc.instantiate(this.mBuySkinDiamondNotEnoughPrefab),Y=V.getComponent(C.default);Y.setCloseCallback(function(){V.destroy()}),Y.setShareCallback(function(){V.destroy(),W.showSharePopup()}),this.popup_layout.node.addChild(V)},z.prototype.showSharePopup=function(){this.shareGiftCallback&&this.shareGiftCallback()},z.prototype.updateDefaultSkinUi=function(){var W=this,V="/ui/skin_store_use_default_press",Y="/ui/skin_store_use_default";R.default.getInstance().isEnglish()&&(V="/ui/skin_store_use_default_press_en",Y="/ui/skin_store_use_default_en"),d.SkinDataMgr.Ins().isDefaultSkin()?(this.defaultBtn.interactable=!1,M.default.get(V,function(q,J){J&&(W.defaultBtn.getComponent(cc.Sprite).spriteFrame=J,W.defaultBtn.normalSprite=J,W.mDefaultClickCb&&(W.defaultBtn.node.off(cc.Node.EventType.TOUCH_END,W.mDefaultClickCb.click,W.mDefaultClickCb),W.mDefaultClickCb=null))})):(this.defaultBtn.interactable=!0,M.default.get(Y,function(q,J){J&&(W.defaultBtn.getComponent(cc.Sprite).spriteFrame=J,W.defaultBtn.normalSprite=J)}),M.default.get(V,function(q,J){J&&(W.defaultBtn.pressedSprite=J)}),this.mDefaultClickCb==null&&(this.mDefaultClickCb=new r.default(function(){W.switchDefaultSkin()}),this.defaultBtn.node.on(cc.Node.EventType.TOUCH_END,this.mDefaultClickCb.click,this.mDefaultClickCb)))},z.prototype.switchDefaultSkin=function(){this.itemUseSkinCallback(d.SkinDataMgr.Ins().getDefaultSkinItem())},z.prototype.initializeScrollView=function(){this.itemXLeft=(this.mContent.width-2*this.itemWidth-this.wSpacing)/2,this.itemXRight=(this.mContent.width-2*this.itemWidth-this.wSpacing)/2+this.itemWidth+this.wSpacing,this.itemTemplate=cc.instantiate(this.mItemPrefab);var W=Math.ceil(d.SkinDataMgr.Ins().getSkinListExceptDefault().length/2)*(this.itemHeight+this.hSpacing);this.mContent.height=W;for(var V=Math.min(d.SkinDataMgr.Ins().getSkinListExceptDefault().length,this.spawnCount),Y=0;Y<V;Y++){var q=cc.instantiate(this.itemTemplate),J=q.getComponent(s.default);J.setData(d.SkinDataMgr.Ins().getSkinListExceptDefault()[Y],Y),J.setUseCallback(this.itemUseSkinCallback.bind(this)),J.setTryCallback(this.itemTrySkinCallback.bind(this)),J.setSignGainCallback(this.itemSignGainSkinCallback.bind(this)),J.setPieceGainCallback(this.itemPieceGainSkinCallback.bind(this)),J.setConsumeCertificationCallback(this.itemConsumeCertificationCallback.bind(this)),Y%2==0?q.setPosition(this.itemXLeft,-(Math.floor(Y/2)*(this.itemHeight+this.hSpacing)+this.hSpacing)):q.setPosition(this.itemXRight,-(Math.floor(Y/2)*(this.itemHeight+this.hSpacing)+this.hSpacing)),this.mContent.addChild(q),this.mRealIndex.push(Y),this.items.push(q)}},z.prototype.scrollEvent=function(W,V){switch(V){case 4:d.SkinDataMgr.Ins().getSkinListExceptDefault().length>this.spawnCount&&this.updateByScroll()}},z.prototype.updateByScroll=function(){var W,V,Y,q,J,ee,$,j,ie,oe,ue,pe,de,he,me=this.items,ye=this.bufferZone;if(this.mContent.y<this.lastContentPosY)for(var ge=this.mRealIndex.length-1;0<=ge&&(de=me[this.mRealIndex[ge]],W=me[this.mRealIndex[0]],V=this.getPositionInView(de),he=me[this.mRealIndex[ge-1]],V.y<-ye&&W.y+this.hSpacing+de.height<0);ge-=2)Y=(ue=de.getComponent(s.default)).itemID-this.spawnCount,ue.setData(d.SkinDataMgr.Ins().getSkinListExceptDefault()[Y],Y),q=(pe=he.getComponent(s.default)).itemID-this.spawnCount,pe.setData(d.SkinDataMgr.Ins().getSkinListExceptDefault()[q],q),J=this.mRealIndex.pop(),this.mRealIndex.unshift(J),ee=this.mRealIndex.pop(),this.mRealIndex.unshift(ee),he.setPosition(this.itemXLeft,W.y+this.hSpacing+this.itemHeight),de.setPosition(this.itemXRight,W.y+this.hSpacing+this.itemHeight),ge+=2;else for(ge=0;ge<this.mRealIndex.length&&(he=me[this.mRealIndex[ge]],$=me[this.mRealIndex[this.mRealIndex.length-1]],V=this.getPositionInView(he),de=me[this.mRealIndex[ge+1]],j=this.itemHeight,V.y>ye&&$.y-j-this.hSpacing>-this.mContent.height);ge+=2)q=(pe=he.getComponent(s.default)).itemID+this.spawnCount,pe.setData(d.SkinDataMgr.Ins().getSkinListExceptDefault()[q],q),Y=(ue=de.getComponent(s.default)).itemID+this.spawnCount,ue.setData(d.SkinDataMgr.Ins().getSkinListExceptDefault()[Y],Y),ie=this.mRealIndex.shift(),this.mRealIndex.push(ie),oe=this.mRealIndex.shift(),this.mRealIndex.push(oe),he.setPosition(this.itemXLeft,$.y-j-this.hSpacing),de.setPosition(this.itemXRight,$.y-j-this.hSpacing),ge-=2;this.lastContentPosY=this.mContent.y},z.prototype.getPositionInView=function(W){var V=W.parent.convertToWorldSpaceAR(W.position);return this.scrollView.node.convertToNodeSpaceAR(V)},z.prototype.adapterUI=function(){c.SUtil.ins().isLiuHai()?(c.SUtil.ins().toTopByPixel(this.root_layout,170),c.SUtil.ins().toBottomByPx(this.root_layout,50),c.SUtil.ins().toTopByPixel(this.back_btn,88)):c.SUtil.ins().isQuanMian()?(c.SUtil.ins().toTopByPixel(this.root_layout,120),c.SUtil.ins().toBottomByPx(this.root_layout,30),c.SUtil.ins().toTopByPixel(this.back_btn,32)):c.SUtil.ins().isPuTong()&&(c.SUtil.ins().toTopByPixel(this.root_layout,100),c.SUtil.ins().toBottomByPx(this.root_layout,15),c.SUtil.ins().toTopByPixel(this.back_btn,20))},__decorate([B(cc.Layout)],z.prototype,"root_layout",void 0),__decorate([B(cc.Button)],z.prototype,"defaultBtn",void 0),__decorate([B(cc.Button)],z.prototype,"back_btn",void 0),__decorate([B(cc.ScrollView)],z.prototype,"scrollView",void 0),__decorate([B],z.prototype,"spawnCount",void 0),__decorate([B],z.prototype,"totalCount",void 0),__decorate([B],z.prototype,"hSpacing",void 0),__decorate([B],z.prototype,"wSpacing",void 0),__decorate([B],z.prototype,"bufferZone",void 0),__decorate([B(cc.Prefab)],z.prototype,"mItemPrefab",void 0),__decorate([B(cc.Prefab)],z.prototype,"mToastPrefab",void 0),__decorate([B(cc.Layout)],z.prototype,"popup_layout",void 0),__decorate([B(cc.Sprite)],z.prototype,"mSkinStoreSprite",void 0),__decorate([B(cc.Prefab)],z.prototype,"mBuySkinDiamondNotEnoughPrefab",void 0),z=__decorate([U],z)}(cc.Component);m.default=Q,cc._RF.pop()},{"../../../modules/MGAppShare/scripts/MGShareUtil":"MGShareUtil","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/G":"G","../../base/Log":"Log","../../infoc/m_p2_PData_Dia":"m_p2_PData_Dia","../../infoc/m_p2_skin_piece":"m_p2_skin_piece","../../util/PU":"PU","../../util/SUtil":"SUtil","../../util/StringUtil":"StringUtil","../Logic/EventBus":"EventBus","../Logic/GameItemsManager":"GameItemsManager","../Logic/I18nManager":"I18nManager","../Logic/MoneySystem":"MoneySystem","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/MusicLib/HotMusicCMShareController":"HotMusicCMShareController","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../awardcontroller/AwardController":"AwardController","../keypad/KeypadNavigator":"KeypadNavigator","../reward/ActivityBean":"ActivityBean","../shop/DialogOneButtonPrefab":"DialogOneButtonPrefab","./BuySkinDiamondNotEnough":"BuySkinDiamondNotEnough","./SkinGainPrefab":"SkinGainPrefab","./SkinPieceMgr":"SkinPieceMgr","./SkinStoreItem":"SkinStoreItem","./SkinTaskPageViewPrefab":"SkinTaskPageViewPrefab","./SkinTryData":"SkinTryData","./SkinUtils":"SkinUtils","./frag/SkinTaskItem":"SkinTaskItem"}],SkinTaskFactory:[function(l,P,m){"use strict";cc._RF.push(P,"fa3121QwMlF3rB7lrfPiCKN","SkinTaskFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../SkinTaskItem"),s=l("./FightFriendTimesTask"),r=l("./FightUsePropTimesTask"),o=l("./FightWinCountTask"),e=l("./GoldBuyTask"),n=l("./LotteryTask"),t=l("./NormalGainCrownTask"),i=l("./NormalReliveTimestask"),a=l("./WatchAdsTask"),u=function(){function c(){}return c.createTask=function(p,h){switch(p){case d.SKinTaskID.TASK_FIGHT_FRIEND_TIMES:return new s.default(p,h);case d.SKinTaskID.TASK_FIGHT_USE_PROP_TIMES:return new r.default(p,h);case d.SKinTaskID.TASK_FIGHT_WIN_COUNT:return new o.default(p,h);case d.SKinTaskID.TASK_GOLD_BUY:return new e.default(p,h);case d.SKinTaskID.TASK_LOTTERY:return new n.default(p,h);case d.SKinTaskID.TASK_NORMAL_GAIN_CROWN:return new t.default(p,h);case d.SKinTaskID.TASK_NORMAL_RELIVE_TIMES:return new i.default(p,h);case d.SKinTaskID.TASK_WATCH_ADS:return new a.default(p,h)}return null},c}();m.default=u,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem","./FightFriendTimesTask":"FightFriendTimesTask","./FightUsePropTimesTask":"FightUsePropTimesTask","./FightWinCountTask":"FightWinCountTask","./GoldBuyTask":"GoldBuyTask","./LotteryTask":"LotteryTask","./NormalGainCrownTask":"NormalGainCrownTask","./NormalReliveTimestask":"NormalReliveTimesTask","./WatchAdsTask":"WatchAdsTask"}],SkinTaskItemPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"1b4b6TvZ85CgKB1zMewYbf1","SkinTaskItemPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./frag/SkinTaskItem"),s=l("../UI/GameEntraScene/ImgCache"),r=l("../Logic/GameItemsManager"),o=l("../../util/SUtil"),e=l("../UI/GameEntraScene/BasicTouchEvent"),n=l("./SkinPieceMgr"),t=l("./frag/SkinTaskMgr"),i=l("../../base/Log"),a=l("../Logic/MoneySystem"),u=l("../Logic/EventBus"),c=l("../Logic/NotifyEvent"),p=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),h=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),f=l("../../infoc/m_p2_skin_piece"),g=l("../Logic/SkinDataManager"),_=l("../../util/PU"),y=cc._decorator,S=y.ccclass,I=y.property,v=function(C){function T(){var A=C!==null&&C.apply(this,arguments)||this;return A.pieceIconSprite=null,A.countLabel=null,A.taskNode=null,A.descText=null,A.proNode=null,A.proDescLabel=null,A.proBarNode=null,A.proLabel=null,A.proBg=null,A.pro=null,A.goldNode=null,A.goldLabel=null,A.btn=null,A.mSkinTaskItem=null,A.mDoTaskCb=null,A.mWatchAdsCb=null,A.mConvertGoldCb=null,A.mIndex=0,A.mSource=f.default.SOURCE_SKIN_STORE,A.mInitReportAction=0,A.mHasOnStart=!1,A.mHasReportInitType=!1,A.updatingBtnStatus=!1,A}var E;return __extends(T,C),(E=T).prototype.setTaskGoingListerer=function(A){this.mTaskGoingListener=A},T.prototype.setToastCb=function(A){this.mToastCb=A},T.prototype.setDoPieceFlyAnimationCb=function(A){this.doPieceFlyAnimationCb=A},T.prototype.setSource=function(A){this.mSource=A},T.prototype.onLoad=function(){this.initView(),_.default.isWeiXin()||p.MGAdv.load(h.ADScene.SCENE_SKIN_TASK,h.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),u.default.register(c.default.SKIN_UPDATE_STEP_UPDATE_UI,this.updateUiByStep,this),u.default.register(c.default.SKIN_TASK_UPDATE_PIECES_UI,this.updatePieces,this)},T.prototype.onDestroy=function(){u.default.remove(c.default.SKIN_UPDATE_STEP_UPDATE_UI,this.updateUiByStep,this),u.default.remove(c.default.SKIN_TASK_UPDATE_PIECES_UI,this.updatePieces,this)},T.prototype.updatePieces=function(A,M){i.default.i(E.TAG+"updatePieces \u66F4\u65B0 \u754C\u9762 \u788E\u7247\u6570\u91CF params = ",M);var k=M[0];this.mPieceId==k.pieceID&&this.mSkinTaskItem.taskId==d.SKinTaskID.TASK_GOLD_BUY&&this.updateGoldPieceCount()},T.prototype.updateUiByStep=function(A,M){i.default.i(E.TAG+" updateUiByStep params= ",M);var k=M[0];k.taskId==this.mSkinTaskItem.taskId&&k.skinId==this.mSkinTaskItem.skinId&&this.initView()},T.prototype.initView=function(){i.default.i(E.TAG+" initView this.mSkinTaskItem = ",this.mSkinTaskItem),this.mSkinTaskItem?(this.node.active=!0,this.mSkinTaskItem.taskId==d.SKinTaskID.TASK_WATCH_ADS?this.initWatchAds():this.mSkinTaskItem.taskId==d.SKinTaskID.TASK_GOLD_BUY?this.initGoldBuy():this.initOthertask()):this.node.active=!1},T.prototype.onStart=function(){this.mHasOnStart=!0,this.mHasReportInitType||this.mInitReportAction==0||(this.mHasReportInitType=!0,this.reportSkinPiece(this.mInitReportAction))},T.prototype.initOthertask=function(){var A=this;if(this.goldNode.active=!1,this.taskNode.active=!0,this.proBarNode.active=!0,this.proBarNode.active=!0,this.mSkinTaskItem.status[this.mSkinTaskItem.status.length-1]==d.TaskStatus.STATUS_FINISH)this.descText.string=cc.js.formatStr(cc.js.formatStr(this.mSkinTaskItem.desc,"<color=#FF732F>%s</c>"),this.mSkinTaskItem.step[this.mSkinTaskItem.step.length-1]),this.btn.interactable=!1,s.default.get(E.IMG_FINISH,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.getComponent(cc.Sprite).spriteFrame=b,A.btn.normalSprite=b)}),this.countLabel.string="x"+this.mSkinTaskItem.reward[this.mSkinTaskItem.reward.length-1],(D=new cc.Color).fromHEX("#7D7D7D"),this.countLabel.node.color=D,s.default.get(r.GameItemsManager.getIns().getSmallPicByItemId(this.mPieceId)+E.DISABLE_SUFFIX,function(L,b){b&&cc.isValid(A,!0)&&(A.pieceIconSprite.spriteFrame=b)}),s.default.get(E.IMG_PROGRESS_GRAY,function(L,b){b&&cc.isValid(A,!0)&&(A.pro.spriteFrame=b)}),s.default.get(E.IMG_PROGRESS_GRAY_BG,function(L,b){b&&cc.isValid(A,!0)&&(A.proBg.spriteFrame=b)}),this.pro.node.width=this.proBg.node.width,o.SUtil.ins().toLeftByPx(this.pro,0),this.proLabel.string=this.mSkinTaskItem.curStep+"/"+this.mSkinTaskItem.step[this.mSkinTaskItem.step.length-1],this.mDoTaskCb&&this.btn.node.off(cc.Node.EventType.TOUCH_END,this.mDoTaskCb.click,this.mDoTaskCb);else{this.btn.interactable=!0,s.default.get(r.GameItemsManager.getIns().getSmallPicByItemId(this.mPieceId),function(L,b){b&&cc.isValid(A,!0)&&(A.pieceIconSprite.spriteFrame=b)}),s.default.get(E.IMG_PROGRESS_LIGHT,function(L,b){b&&cc.isValid(A,!0)&&(A.pro.spriteFrame=b)}),s.default.get(E.IMG_PROGRESS_LIGHT_BG,function(L,b){b&&cc.isValid(A,!0)&&(A.proBg.spriteFrame=b)});for(var M=0,k=0;k<this.mSkinTaskItem.status.length;k++)if(this.mSkinTaskItem.status[k]!=d.TaskStatus.STATUS_FINISH){M=k;break}var D;this.countLabel.string="x"+this.mSkinTaskItem.reward[M],(D=new cc.Color).fromHEX("#FF711B"),this.countLabel.node.color=D,this.descText.string=cc.js.formatStr(cc.js.formatStr(this.mSkinTaskItem.desc,"<color=#FF732F>%s</c>"),this.mSkinTaskItem.step[M]),this.proLabel.string=this.mSkinTaskItem.curStep+"/"+this.mSkinTaskItem.step[M],this.mSkinTaskItem.status[M]==d.TaskStatus.STATUS_SUCCESS?(s.default.get(E.IMG_GET,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.getComponent(cc.Sprite).spriteFrame=b,A.btn.normalSprite=b)}),s.default.get(E.IMG_GET_PRESS,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.pressedSprite=b)}),this.pro.node.width=this.proBg.node.width,o.SUtil.ins().toLeftByPx(this.pro,0),this.mHasOnStart?(this.mHasReportInitType=!0,this.reportSkinPiece(f.default.ACTION_SHOW_GET)):this.mInitReportAction=f.default.ACTION_SHOW_GET):(s.default.get(E.IMG_GO,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.getComponent(cc.Sprite).spriteFrame=b,A.btn.normalSprite=b)}),s.default.get(E.IMG_GO_PRESS,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.pressedSprite=b)}),this.pro.node.width=this.proBg.node.width*(this.mSkinTaskItem.curStep/this.mSkinTaskItem.step[M]),o.SUtil.ins().toLeftByPx(this.pro,0),this.mHasOnStart?(this.mHasReportInitType=!0,this.reportSkinPiece(f.default.ACTION_SHOW_GO)):this.mInitReportAction=f.default.ACTION_SHOW_GO),this.mDoTaskCb==null&&(this.mDoTaskCb=new e.default(function(){A.updatingBtnStatus||A.doTask()}),this.btn.node.on(cc.Node.EventType.TOUCH_END,this.mDoTaskCb.click,this.mDoTaskCb))}},T.prototype.doTask=function(){for(var A=this,M=0,k=0;k<this.mSkinTaskItem.status.length;k++)if(this.mSkinTaskItem.status[k]!=d.TaskStatus.STATUS_FINISH){M=k;break}this.mSkinTaskItem.status[M]==d.TaskStatus.STATUS_SUCCESS?(this.updatingBtnStatus=!0,t.default.Ins().getTaskReward(this.mSkinTaskItem.taskId,function(D,L){cc.isValid(A,!0)&&(D?A.doPieceFlyAnimationCb&&A.doPieceFlyAnimationCb(A.pieceIconSprite,L,function(){A.initView(),A.updatingBtnStatus=!1}):(A.showToastTips("No network available",!1),A.updatingBtnStatus=!1))},this.mSkinTaskItem.skinId),this.reportSkinPiece(f.default.ACTION_CLICK_GET)):(this.mTaskGoingListener&&this.mTaskGoingListener(this.mSkinTaskItem),this.reportSkinPiece(f.default.ACTION_CLICK_GO))},T.prototype.initWatchAds=function(){var A=this;this.goldNode.active=!1,this.taskNode.active=!0,this.proBarNode.active=!0,this.proBarNode.active=!1,this.descText.string=this.mSkinTaskItem.desc;var M=this.mSkinTaskItem.step[this.mSkinTaskItem.step.length-1]-this.mSkinTaskItem.curStep;if(M<0&&(M=0),this.proDescLabel.string=cc.js.formatStr("\u4ECA\u65E5\u8FD8\u53EF\u89C2\u770B%s\u6B21",M),o.SUtil.ins().toLeftByPx(this.proDescLabel,0),this.mSkinTaskItem.status[this.mSkinTaskItem.status.length-1]==d.TaskStatus.STATUS_FINISH)this.btn.interactable=!1,s.default.get(E.IMG_FINISH,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.getComponent(cc.Sprite).spriteFrame=b,A.btn.normalSprite=b)}),this.countLabel.string="x"+this.mSkinTaskItem.reward[this.mSkinTaskItem.reward.length-1],(D=new cc.Color).fromHEX("#7D7D7D"),this.countLabel.node.color=D,s.default.get(r.GameItemsManager.getIns().getSmallPicByItemId(this.mPieceId)+E.DISABLE_SUFFIX,function(L,b){b&&cc.isValid(A,!0)&&(A.pieceIconSprite.spriteFrame=b)}),this.mWatchAdsCb&&this.btn.node.off(cc.Node.EventType.TOUCH_END,this.mWatchAdsCb.click,this.mWatchAdsCb);else{this.btn.interactable=!0,s.default.get(E.IMG_GET,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.getComponent(cc.Sprite).spriteFrame=b,A.btn.normalSprite=b)}),s.default.get(E.IMG_GET_PRESS,function(L,b){b&&cc.isValid(A,!0)&&(A.btn.pressedSprite=b)});for(var k=0;k<this.mSkinTaskItem.status.length;k++)if(this.mSkinTaskItem.status[k]!=d.TaskStatus.STATUS_FINISH){var D;this.countLabel.string="x"+this.mSkinTaskItem.reward[k],(D=new cc.Color).fromHEX("#FF711B"),this.countLabel.node.color=D;break}s.default.get(r.GameItemsManager.getIns().getSmallPicByItemId(this.mPieceId),function(L,b){b&&cc.isValid(A,!0)&&(A.pieceIconSprite.spriteFrame=b)}),this.mWatchAdsCb==null&&(this.mWatchAdsCb=new e.default(function(){A.updatingBtnStatus||(A.watchAds(),A.reportSkinPiece(f.default.ACTION_CLICK_GO))}),this.btn.node.on(cc.Node.EventType.TOUCH_END,this.mWatchAdsCb.click,this.mWatchAdsCb)),this.mHasOnStart?(this.mHasReportInitType=!0,this.reportSkinPiece(f.default.ACTION_SHOW_GO)):this.mInitReportAction=f.default.ACTION_SHOW_GO}},T.prototype.watchAds=function(){var A=this,M=h.ADScene.SCENE_SKIN_TASK;p.MGAdv.show(M,h.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK,function(k){switch(k){case h.ADStat.NOT_NETWORK:A.showToastTips("No network available",!1);break;case h.ADStat.SHOW_SUCCESS_CLOSE:A.onWatchAdsSuccess(),i.default.i(E.TAG+" watchAds success ");break;case h.ADStat.SHOW_NOT_ENED_CLOSE:break;case h.ADStat.SHOW_GET_AD_FAILED:A.showToastTips("No video ads available",!1)}})},T.prototype.onWatchAdsSuccess=function(){var A=this;this.updatingBtnStatus=!0;var M=new t.NormalEvent;M.type=t.NormalEventType.WATCH_ADS,M.extra=this.mSkinTaskItem.skinId,t.default.Ins().notifyNormalEvent(M,function(k){k?t.default.Ins().getTaskReward(A.mSkinTaskItem.taskId,function(D,L){cc.isValid(A,!0)&&(D?A.doPieceFlyAnimationCb&&A.doPieceFlyAnimationCb(A.pieceIconSprite,L,function(){A.initView(),A.updatingBtnStatus=!1}):(A.showToastTips("No network available",!1),A.updatingBtnStatus=!1))},A.mSkinTaskItem.skinId):A.updatingBtnStatus=!1})},T.prototype.showToastTips=function(A,M){this.mToastCb&&this.mToastCb(A,M)},T.prototype.initGoldBuy=function(){var A=this;this.goldNode.active=!0,this.taskNode.active=!1,this.proNode.active=!1,s.default.get(r.GameItemsManager.getIns().getSmallPicByItemId(this.mPieceId),function(k,D){D&&cc.isValid(A,!0)&&(A.pieceIconSprite.spriteFrame=D)}),this.updateGoldPieceCount();var M=new cc.Color;M.fromHEX("#FF711B"),this.countLabel.node.color=M,this.btn.interactable=!0,s.default.get(E.IMG_UNLOCK_GOLD,function(k,D){D&&cc.isValid(A,!0)&&(A.btn.getComponent(cc.Sprite).spriteFrame=D,A.btn.normalSprite=D)}),s.default.get(E.IMG_UNLOCK_GOLD_PRESS,function(k,D){D&&cc.isValid(A,!0)&&(A.btn.pressedSprite=D)}),this.mConvertGoldCb==null&&(this.mConvertGoldCb=new e.default(function(){A.updatingBtnStatus,A.convertGoldBuy(),A.reportSkinPiece(f.default.ACTION_CLICK_GOLD_BUY)}),this.btn.node.on(cc.Node.EventType.TOUCH_END,this.mConvertGoldCb.click,this.mConvertGoldCb),this.mHasOnStart?(this.mHasReportInitType=!0,this.reportSkinPiece(f.default.ACTION_SHOW_GOLD_BUY)):this.mInitReportAction=f.default.ACTION_SHOW_GOLD_BUY)},T.prototype.updateGoldPieceCount=function(){this.countLabel.string="x"+n.default.Ins().getPieceCount(this.mPieceId);var A=(g.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.mSkinTaskItem.skinId).piecesTotal-n.default.Ins().getPieceCount(this.mPieceId))/this.mSkinTaskItem.reward[0]*this.mSkinTaskItem.step[0];this.goldLabel.string="x"+A},T.prototype.convertGoldBuy=function(){var A=this,M=(g.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.mSkinTaskItem.skinId).piecesTotal-n.default.Ins().getPieceCount(this.mPieceId))/this.mSkinTaskItem.reward[0]*this.mSkinTaskItem.step[0];if(a.MoneySystem.getGoldCount()>=M){this.updatingBtnStatus=!0,a.MoneySystem.consumeGold(M);var k=new t.NormalEvent;k.type=t.NormalEventType.GOLD_BUY,k.extra=this.mSkinTaskItem.skinId,t.default.Ins().notifyNormalEvent(k,function(D){D?t.default.Ins().getTaskReward(A.mSkinTaskItem.taskId,function(L,b){cc.isValid(A,!0)&&(L?A.doPieceFlyAnimationCb&&A.doPieceFlyAnimationCb(A.pieceIconSprite,b,function(){A.updatingBtnStatus=!1}):(A.showToastTips("No network available",!1),A.updatingBtnStatus=!1))},A.mSkinTaskItem.skinId):(A.showToastTips("No network available",!1),A.updatingBtnStatus=!1)})}else u.default.fire(c.default.SKIN_TASK_GOLY_BUY_NOT_ENOUGH)},T.prototype.setData=function(A,M,k){this.mSkinTaskItem=A,this.mPieceId=M,this.mIndex=k},T.prototype.reportSkinPiece=function(A){var M=0;M=this.mSkinTaskItem.taskId==d.SKinTaskID.TASK_WATCH_ADS?f.default.PAGE_TASK_WATCH_ADS:this.mSkinTaskItem.taskId==d.SKinTaskID.TASK_GOLD_BUY?f.default.PAGE_TASK_GOLD_BUY:this.mIndex==0?f.default.PAGE_TASK_1:f.default.PAGE_TASK_2,f.default.report(M,g.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.mSkinTaskItem.skinId).name,A,this.mSource)},T.TAG="SkinTaskItemPrefab ===>>>",T.IMG_GET="/static_res/skin_chip/skin_task/skin_task_get",T.IMG_GET_PRESS="/static_res/skin_chip/skin_task/skin_task_get_press",T.IMG_GO="/static_res/skin_chip/skin_task/skin_task_go",T.IMG_GO_PRESS="/static_res/skin_chip/skin_task/skin_task_go_press",T.IMG_FINISH="/static_res/skin_chip/skin_task/skin_task_finish",T.IMG_PROGRESS_LIGHT="/static_res/skin_chip/skin_task/skin_task_doing_light",T.IMG_PROGRESS_LIGHT_BG="/static_res/skin_chip/skin_task/skin_task_doing_light_bg",T.IMG_PROGRESS_GRAY="/static_res/skin_chip/skin_task/skin_task_doing_gray",T.IMG_PROGRESS_GRAY_BG="/static_res/skin_chip/skin_task/skin_task_doing_gray_bg",T.IMG_UNLOCK_GOLD="/static_res/skin_chip/skin_task/unlock_gold",T.IMG_UNLOCK_GOLD_PRESS="/static_res/skin_chip/skin_task/unlock_gold_press",T.DISABLE_SUFFIX="_disable",__decorate([I(cc.Sprite)],T.prototype,"pieceIconSprite",void 0),__decorate([I(cc.Label)],T.prototype,"countLabel",void 0),__decorate([I(cc.Node)],T.prototype,"taskNode",void 0),__decorate([I(cc.RichText)],T.prototype,"descText",void 0),__decorate([I(cc.Node)],T.prototype,"proNode",void 0),__decorate([I(cc.Label)],T.prototype,"proDescLabel",void 0),__decorate([I(cc.Node)],T.prototype,"proBarNode",void 0),__decorate([I(cc.Label)],T.prototype,"proLabel",void 0),__decorate([I(cc.Sprite)],T.prototype,"proBg",void 0),__decorate([I(cc.Sprite)],T.prototype,"pro",void 0),__decorate([I(cc.Node)],T.prototype,"goldNode",void 0),__decorate([I(cc.Label)],T.prototype,"goldLabel",void 0),__decorate([I(cc.Button)],T.prototype,"btn",void 0),T=E=__decorate([S],T)}(cc.Component);m.default=v,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../base/Log":"Log","../../infoc/m_p2_skin_piece":"m_p2_skin_piece","../../util/PU":"PU","../../util/SUtil":"SUtil","../Logic/EventBus":"EventBus","../Logic/GameItemsManager":"GameItemsManager","../Logic/MoneySystem":"MoneySystem","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/ImgCache":"ImgCache","./SkinPieceMgr":"SkinPieceMgr","./frag/SkinTaskItem":"SkinTaskItem","./frag/SkinTaskMgr":"SkinTaskMgr"}],SkinTaskItem:[function(l,P,m){"use strict";cc._RF.push(P,"93b78SRO0tHf5sIUkO9COMr","SkinTaskItem"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r,o,e=l("../../../util/TimeUtil"),n=l("../../../util/NumberUtil"),t=l("../../../util/StringUtil"),i=l("../../Logic/EventBus"),a=l("../../Logic/NotifyEvent"),u=l("../../../base/Log"),c=l("../SkinPieceMgr"),p=l("../../Logic/SkinDataManager"),h=function(){function f(g,_){this.curStep=0,this.status=[],this.taskId=g,this.skinId=_}return f.prototype.updateStatus=function(g){if(this.isGoldConvertTask()){var _=p.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.skinId).piecesTotal-c.default.Ins().getPieceCount(p.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.skinId).piecesId);return this.addPiece(_),g(_,d.STATUS_NONE),void u.default.l("SkinTaskItem====>>, updateStatus this = ",this)}for(var y=this.status.length,S=0;S<y;S++)if(this.status[S]==d.STATUS_SUCCESS)return this.status[S]=d.STATUS_FINISH,this.addPiece(this.reward[S]),g(this.reward[S],S==y-1?d.STATUS_FINISH:this.status[S+1]),i.default.fire(a.default.UPDATE_SKIN_PIECES_TIPS,this),void u.default.l("SkinTaskItem====>>, updateStatus this = ",this);u.default.l("SkinTaskItem====>>, updateStatus this = ",this),g(0,d.STATUS_NONE)},f.prototype.addPiece=function(g){var _=new c.Piece(p.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.skinId).piecesId,g);u.default.i("SkinTaskItem====>>, addPiece piece = ",_),c.default.Ins().addPiece([_])},f.prototype.updateStep=function(g){if(!(this.isGoldConvertTask()||this.curStep>=this.step[this.step.length-1])){var _=this.curStep;this.curStep+=g;for(var y=0,S=0;S<this.step.length;S++)_<this.step[S]&&this.step[S]<=this.curStep&&(this.status[S]=d.STATUS_SUCCESS,y+=this.reward[S],i.default.fire(a.default.UPDATE_SKIN_PIECES_TIPS,this));i.default.fire(a.default.SKIN_UPDATE_STEP_UPDATE_UI,this),0<y&&i.default.fire(a.default.SKIN_TASK_ADD_FRAGS,this.skinId,this.taskId,y),u.default.l("SkinTaskItem====>>, updateStep this = ",this)}},f.prototype.initTask=function(g,_){if(!this.isGoldConvertTask()){var y=g.split("*");if(y[0]==this.taskId&&2<=y.length&&e.default.formatDate(_)==y[1]&&(3<=y.length&&(this.curStep=n.default.parseIntFromString(y[2])),4<=y.length))for(var S=y[3],I=0;I<S.length;I++)this.status[I]=n.default.parseIntFromString(S.charAt(I))}},f.prototype.getTaskStr=function(g){if(this.isGoldConvertTask())return"";var _="";_+=this.taskId+"*"+g+"*"+this.curStep;var y="";return this.status.forEach(function(S){y+=S+""}),t.StringUtil.isEmpty(y)||(_+="*"+y),u.default.i("SkinTaskItem====>>, getTaskStr timeStr = "+g+",skinId = "+this.skinId+", taskStr = "+_),_},f.prototype.isGoldConvertTask=function(){return this.taskId==r.TASK_GOLD_BUY},f}();m.default=h,(s=d=m.TaskStatus||(m.TaskStatus={}))[s.STATUS_NONE=0]="STATUS_NONE",s[s.STATUS_SUCCESS=1]="STATUS_SUCCESS",s[s.STATUS_FINISH=2]="STATUS_FINISH",(o=r=m.SKinTaskID||(m.SKinTaskID={})).TASK_FIGHT_PLAY_COUNT="fight_play_count",o.TASK_SHARE_FOR_NEW_PLAYER="share_for_new_player",o.TASK_FIGHT_WIN_COUNT="fight_win_count",o.TASK_NORMAL_GAIN_CROWN="normal_gain_crown",o.TASK_NORMAL_RELIVE_TIMES="normal_relive_times",o.TASK_FIGHT_FRIEND_TIMES="fight_friend_times",o.TASK_LOTTERY="lottery",o.TASK_FIGHT_USE_PROP_TIMES="fight_use_prop_times",o.TASK_WATCH_ADS="watch_ads",o.TASK_GOLD_BUY="gold_buy",cc._RF.pop()},{"../../../base/Log":"Log","../../../util/NumberUtil":"NumberUtil","../../../util/StringUtil":"StringUtil","../../../util/TimeUtil":"TimeUtil","../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../Logic/SkinDataManager":"SkinDataManager","../SkinPieceMgr":"SkinPieceMgr"}],SkinTaskMgr:[function(l,P,m){"use strict";cc._RF.push(P,"bb2banfexxCbYUQHvcGdcXw","SkinTaskMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./SkinTaskItem"),s=l("../../../util/PU"),r=l("../../../util/ResLoader"),o=l("./SkinTask"),e=l("../../Network/Protocol/StorageUtil"),n=l("../../../config/LSKey"),t=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),i=l("../../../util/StringUtil"),a=l("../../Logic/EventBus"),u=l("../../Logic/NotifyEvent"),c=l("../../../base/Log"),p=l("../../../util/TimeUtil"),h=l("../../Logic/SkinDataManager"),f=function(){function I(){this.mSkinTasks=null,this.mSkinTaskFinishListeners=[],this.mTodayStr=null,a.default.register(u.default.SKIN_TASK_ADD_FRAGS,this.finishTaskAddFrags,this)}return I.Ins=function(){return this.ins==null&&(this.ins=new I),this.ins},I.prototype.finishTaskAddFrags=function(v,C){var T=C[0],E=C[1],A=C[2];this.mSkinTaskFinishListeners.forEach(function(M){switch(E){case d.SKinTaskID.TASK_FIGHT_FRIEND_TIMES:M.fightFriendTaskFinish&&M.fightFriendTaskFinish(T,A);break;case d.SKinTaskID.TASK_FIGHT_USE_PROP_TIMES:M.fightUseProsTaskFinish&&M.fightUseProsTaskFinish(T,A);break;case d.SKinTaskID.TASK_FIGHT_WIN_COUNT:M.fightWinCountTaskFinish&&M.fightWinCountTaskFinish(T,A);break;case d.SKinTaskID.TASK_GOLD_BUY:M.goldBuyTaskFinish&&M.goldBuyTaskFinish(T,A);break;case d.SKinTaskID.TASK_LOTTERY:M.lotteryTaskFinish&&M.lotteryTaskFinish(T,A);break;case d.SKinTaskID.TASK_NORMAL_GAIN_CROWN:M.normalGainCrownTaskFinish&&M.normalGainCrownTaskFinish(T,A);break;case d.SKinTaskID.TASK_NORMAL_RELIVE_TIMES:M.normalReliveTimesTaskFinish&&M.normalReliveTimesTaskFinish(T,A);break;case d.SKinTaskID.TASK_WATCH_ADS:M.watchAdsTaskFinish&&M.watchAdsTaskFinish(T,A)}})},I.prototype.onDestory=function(){this.mSkinTaskFinishListeners.splice(0,this.mSkinTaskFinishListeners.length),a.default.remove(u.default.SKIN_TASK_ADD_FRAGS,this.finishTaskAddFrags,this)},I.prototype.registSkinTaskFinishListener=function(v){v&&this.mSkinTaskFinishListeners.indexOf(v)==-1&&this.mSkinTaskFinishListeners.push(v)},I.prototype.unRegistSkinTaskFinishListener=function(v){if(v){var C=this.mSkinTaskFinishListeners.indexOf(v);C!=-1&&this.mSkinTaskFinishListeners.splice(C,1)}},I.prototype.getTaskReward=function(v,C,T){var E=this;c.default.l(I.TAG+", getTaskReward taskId = ",v+", skinId = "+T),this.getCurTime(function(A,M){A?i.StringUtil.isEmpty(T)?E.getSkinTasks(M,function(k){k.forEach(function(D){D.task.forEach(function(L){L.taskId==v&&L.updateStatus(function(b,N){c.default.l(I.TAG+", 2 getTaskReward updateStatus reward = "+b+", nextStatus = ",N),E.saveSkinTasks(M),C(!0,b)})})})}):E.getSkinTaskById(T,M,function(k){k&&k.task.forEach(function(D){D.taskId==v&&D.updateStatus(function(L,b){c.default.l(I.TAG+", 1 getTaskReward updateStatus reward = "+L+", nextStatus = ",b),E.saveSkinTasks(M),C(!0,L)})})}):C(!1,0)})},I.prototype.hasTaskUnTaken=function(v){var C=this;this.getCurTime(function(T,E){T?C.getLockedSkinTasks(E,function(A){for(var M=0;M<A.length;M++)for(var k=A[M].task,D=0;D<k.length;D++)for(var L=k[D].status,b=0;b<L.length;b++)if(L[b]==d.TaskStatus.STATUS_SUCCESS)return void v(!0,k[D]);v(!1)}):v(!1)})},I.prototype.getLockedSkinTasks=function(v,C){this.getSkinTasks(v,function(T){var E=[];T.forEach(function(A){var M=h.SkinDataMgr.Ins().getOwnedSkin(h.SkinDataMgr.Ins().getSkinItemInfoBySkinId(A.skinId).name);M!=null&&M.isOwnedPermanent()||E.push(A)}),C(E)})},I.prototype.getSkinTasks=function(v,C){var T=this;if(s.default.isCM())C([]);else if(this.mSkinTasks&&!i.StringUtil.isEmpty(this.mTodayStr)&&this.mTodayStr==p.default.formatDate(v))C(this.mSkinTasks);else{var E=s.default.getResourcePath("resources/skin_task/task_config.json");r.default.loadJson(E,function(A,M){if(A)console.error(I.TAG+"loadJson error = ",A);else if(M)try{T.mSkinTasks==null?T.mSkinTasks=[]:(c.default.w(I.TAG+"getSkinTasks update cache splice arr"),T.mSkinTasks.splice(0,T.mSkinTasks.length));for(var k=function(N){var H=new o.default;H.skinId=N.skinId;var R=[];N.task.forEach(function(F){var x=new d.default(F.taskId,H.skinId);x.step=F.step,x.reward=F.reward,x.desc=F.desc;for(var U=0;U<x.step.length;U++)x.status.push(d.TaskStatus.STATUS_NONE);R.push(x)}),H.task=R,H.initData(v),T.mSkinTasks.push(H)},D=0,L=M;D<L.length;D++)k(L[D]);c.default.l(I.TAG+", getSkinTasks this.mTodayStr = "+T.mTodayStr+",TimeUtil.formatDate(timeStamp) "+p.default.formatDate(v)+", this.mSkinTasks = ",T.mSkinTasks);var b=!1;i.StringUtil.isEmpty(T.mTodayStr)||T.mTodayStr==p.default.formatDate(v)||(b=!0),T.mTodayStr=p.default.formatDate(v),C(T.mSkinTasks),b&&a.default.fire(u.default.SKIN_TASK_CACHE_UPDATE_UI)}catch(N){console.error(I.TAG+"analysis error = ",N)}})}},I.prototype.notifyShareEvent=function(v,C){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(T){switch(T.label){case 0:return c.default.l(I.TAG+", notifyShareEvent shareEvent = ",v),v==null?[2]:0<v.count?[4,this.updateShareTask(v.skinId,v.count,C)]:[3,2];case 1:return T.sent(),[3,3];case 2:C&&C(!1),T.label=3;case 3:return[2]}})})},I.prototype.notifyGradeSongEvent=function(v,C){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(T){return C&&C(!0),[2]})})},I.prototype.notifyNormalEvent=function(v,C){C&&C(!0)},I.prototype.updateFightTask=function(v){var C=this;return new Promise(function(T,E){C.updateTaskStep(d.SKinTaskID.TASK_FIGHT_PLAY_COUNT,1,function(A){v&&v(A),T(!0)})})},I.prototype.updateFightFriendTask=function(v){var C=this;return new Promise(function(T,E){C.updateTaskStep(d.SKinTaskID.TASK_FIGHT_FRIEND_TIMES,1,function(A){v&&v(A),T(!0)})})},I.prototype.updateFightUsePropTask=function(v,C){var T=this;return new Promise(function(E,A){T.updateTaskStep(d.SKinTaskID.TASK_FIGHT_USE_PROP_TIMES,v,function(M){C&&C(M),E(!0)})})},I.prototype.updateFightWin=function(v){var C=this;return new Promise(function(T,E){C.updateTaskStep(d.SKinTaskID.TASK_FIGHT_WIN_COUNT,1,function(A){v&&v(A),T(!0)})})},I.prototype.updateLotteryTask=function(v){var C=this;return new Promise(function(T,E){C.updateTaskStep(d.SKinTaskID.TASK_LOTTERY,1,function(A){v&&v(A),T(!0)})})},I.prototype.updateGainCrownTask=function(v,C){var T=this;return new Promise(function(E,A){T.updateTaskStep(d.SKinTaskID.TASK_NORMAL_GAIN_CROWN,v,function(M){C&&C(M),E(!0)})})},I.prototype.updateReliveTimesTask=function(v,C){var T=this;return new Promise(function(E,A){T.updateTaskStep(d.SKinTaskID.TASK_NORMAL_RELIVE_TIMES,v,function(M){C&&C(M),E(!0)})})},I.prototype.updateWatchAdsTask=function(v,C){var T=this;return new Promise(function(E,A){T.updateTaskStep(d.SKinTaskID.TASK_WATCH_ADS,1,function(M){C&&C(M),E(!0)},v)})},I.prototype.updateGoldBuyTask=function(v,C){var T=this;return new Promise(function(E,A){T.updateTaskStep(d.SKinTaskID.TASK_GOLD_BUY,1,function(M){C&&C(M),E(!0)},v)})},I.prototype.updateShareTask=function(v,C,T){var E=this;return new Promise(function(A,M){E.updateTaskStep(d.SKinTaskID.TASK_SHARE_FOR_NEW_PLAYER,C,function(k){T&&T(k),A(!0)},v)})},I.prototype.updateTaskStep=function(v,C,T,E){var A=this;this.getCurTime(function(M,k){M?i.StringUtil.isEmpty(E)?A.getSkinTasks(k,function(D){for(var L=0;L<D.length;L++)for(var b=0;b<D[L].task.length;b++)if(D[L].task[b].taskId==v){var N=h.SkinDataMgr.Ins().getOwnedSkin(h.SkinDataMgr.Ins().getSkinItemInfoBySkinId(D[L].task[b].skinId).name);return N!=null&&N.isOwnedPermanent()?(c.default.w(I.TAG+",updateTaskStep skin is unLocked Permanent2 skinId = "+D[L].task[b].skinId+",taskId = "+v),void(T!=null&&T!=null&&T(!1))):(D[L].task[b].updateStep(C),A.saveSkinTasks(k),void(T!=null&&T!=null&&T(!0)))}}):A.getSkinTaskById(E,k,function(D){if(D){var L=h.SkinDataMgr.Ins().getOwnedSkin(h.SkinDataMgr.Ins().getSkinItemInfoBySkinId(E).name);if(L!=null&&L.isOwnedPermanent())return c.default.w(I.TAG+",updateTaskStep skin is unLocked Permanent1 skinId = "+E+",taskId = "+v),void(T!=null&&T!=null&&T(!1));for(var b=0;b<D.task.length;b++)if(D.task[b].taskId==v)return D.task[b].updateStep(C),A.saveSkinTasks(k),void(T!=null&&T!=null&&T(!0))}}):T!=null&&T!=null&&T(!1)})},I.prototype.getSkinTaskById=function(v,C,T){this.getSkinTasks(C,function(E){for(var A=0;A<E.length;A++)if(E[A].skinId==v)return void T(E[A]);T(null)})},I.prototype.getSkinTaskItemById=function(v,C,T,E){this.getSkinTaskById(v,T,function(A){if(A){for(var M=0;M<A.task.length;M++)if(A.task[M].taskId==C)return void E(A.task[M]);E(null)}else E(null)})},I.prototype.saveSkinTasks=function(v){this.getSkinTasks(v,function(C){var T="";C.forEach(function(E){T+=E.getTaskStr(v)+"&"}),T=T.substr(0,T.length-1),c.default.i(I.TAG+" saveSkinTasks timeStamp = "+v+",saveStr = "+T),e.default.save(n.default.SKIN_TASK_STEP_STATUS,T)})},I.prototype.getCurTime=function(v){t.MGUser.getCurrentServerRealTime({complete:function(C,T){v(C,T)}})},I.TAG="SkinTaskMgr ====>>",I.ins=null,I}();m.default=f;var g=function(){};m.ShareEvent=g;var _=function(){};m.GradeSongEvent=_;var y,S=function(){};m.NormalEvent=S,(y=m.NormalEventType||(m.NormalEventType={}))[y.LOTTERY=1]="LOTTERY",y[y.WATCH_ADS=2]="WATCH_ADS",y[y.GOLD_BUY=3]="GOLD_BUY",cc._RF.pop()},{"../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../util/PU":"PU","../../../util/ResLoader":"ResLoader","../../../util/StringUtil":"StringUtil","../../../util/TimeUtil":"TimeUtil","../../Logic/EventBus":"EventBus","../../Logic/NotifyEvent":"NotifyEvent","../../Logic/SkinDataManager":"SkinDataManager","../../Network/Protocol/StorageUtil":"StorageUtil","./SkinTask":"SkinTask","./SkinTaskItem":"SkinTaskItem"}],SkinTaskPageViewPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"b1ed0kWXhpPQLH/mcewMt+O","SkinTaskPageViewPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../Logic/SkinDataManager"),r=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),o=l("../../base/Log"),e=l("./frag/SkinTaskMgr"),n=l("../UI/GameEntraScene/PrefabMgr"),t=l("./SkinTaskPrefab"),i=l("../../infoc/m_p2_skin_piece"),a=l("../shop/DialogOneButtonPrefab"),u=l("../Logic/EventBus"),c=l("../Logic/NotifyEvent"),p=l("../Logic/I18nManager"),h=cc._decorator,f=h.ccclass,g=h.property,_=function(y){function S(){var v=y!==null&&y.apply(this,arguments)||this;return v.mPageView=null,v.mContentLayout=null,v.lastSprite=null,v.nextSprite=null,v.mCloseBtn=null,v.mCloseSprite=null,v.mLockedTasks=null,v.mFirstShowSkinInfo=null,v.mSource=i.default.SOURCE_SKIN_STORE,v}var I;return __extends(S,y),(I=S).prototype.setSource=function(v){this.mSource=v},S.prototype.setTaskGoingListerer=function(v){this.mTaskGoingListener=v},S.prototype.setCloseCb=function(v){this.mCloseCb=v},S.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(v){v.stopPropagation()}),this.initEvent(),this.initTaskData()},S.prototype.update=function(){},S.prototype.initEvent=function(){var v=this,C=new d.default(function(){v.toLastSkinTask()});this.lastSprite.node.on(cc.Node.EventType.TOUCH_START,C.click,C);var T=new d.default(function(){v.toNextSkinTask()});this.nextSprite.node.on(cc.Node.EventType.TOUCH_START,T.click,T);var E=new d.default(function(){o.default.i(I.TAG+",closeBtn click "),v.onClose()});this.mCloseBtn.node.on(cc.Node.EventType.TOUCH_END,E.click,E),this.mCloseSprite&&this.mCloseSprite.node.on(cc.Node.EventType.TOUCH_END,E.click,E),this.mPageView.node.on("page-turning",this.onPageTurning,this)},S.prototype.onClose=function(){this.node.destroy(),this.mCloseCb&&this.mCloseCb()},S.prototype.onPageTurning=function(v){var C=this;setTimeout(function(){cc.isValid(C,!0)&&C.updateLastNextBtn()},0)},S.prototype.updateLastNextBtn=function(){var v=this.mPageView.getCurrentPageIndex(),C=v!=0;this.lastSprite.node.active!=C&&(this.lastSprite.node.active=C),C=v!=this.mLockedTasks.length-1,this.nextSprite.node.active!=C&&(this.nextSprite.node.active=C),this.mPageView.getPages()[v].getComponent(t.default).onStart()},S.prototype.toLastSkinTask=function(){i.default.report(0,s.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.mLockedTasks[this.mPageView.getCurrentPageIndex()].skinId).name,i.default.ACTION_CLICK_LEFT,this.mSource),this.mPageView.scrollToPage(this.mPageView.getCurrentPageIndex()-1,.3),this.hideLastNextBtnByScroll()},S.prototype.toNextSkinTask=function(){i.default.report(0,s.SkinDataMgr.Ins().getSkinItemInfoBySkinId(this.mLockedTasks[this.mPageView.getCurrentPageIndex()].skinId).name,i.default.ACTION_CLICK_RIGHT,this.mSource),this.mPageView.scrollToPage(this.mPageView.getCurrentPageIndex()+1,.3),this.hideLastNextBtnByScroll()},S.prototype.hideLastNextBtnByScroll=function(){var v=this;this.nextSprite.node.active=!1,this.lastSprite.node.active=!1,this.scheduleOnce(function(){v.updateLastNextBtn()},.35)},S.prototype.initTaskData=function(){var v=this;r.MGUser.getCurrentServerRealTime({complete:function(C,T){o.default.i(I.TAG+"onLoad  getCurrentServerRealTime result = "+C),C&&e.default.Ins().getLockedSkinTasks(T,function(E){v.mLockedTasks=E,v.initPageView()})}})},S.prototype.initPageView=function(){var v=this;o.default.i(I.TAG+"initPageView tasks = ",this.mLockedTasks),this.mPageView.node.height=I.PAGE_HEIGHT_NO_BUY,n.default.load("/prefab/SkinTaskPrefab",function(C,T){if(cc.isValid(v,!0)){for(var E=0;E<v.mLockedTasks.length;E++){var A=cc.instantiate(T),M=A.getComponent(t.default);M.setSkinItemInfo(s.SkinDataMgr.Ins().getSkinItemInfoBySkinId(v.mLockedTasks[E].skinId)),M.setPieceEnoughListerer(function(k){v.showPieceToSkinDialog(k)}),M.setSource(v.mSource),v.mTaskGoingListener&&M.setTaskGoingListerer(v.mTaskGoingListener.bind(v)),v.mPageView.addPage(A)}v.scheduleOnce(function(){v.initPageViewPosition()},.05)}})},S.prototype.initPageViewPosition=function(){if(this.mFirstShowSkinInfo!=null)for(var v=0;v<this.mLockedTasks.length;v++)this.mLockedTasks[v].skinId==this.mFirstShowSkinInfo.skinId&&this.mPageView.scrollToPage(v,0);this.updateLastNextBtn()},S.prototype.showSkinTask=function(v){this.mFirstShowSkinInfo=v},S.prototype.showPieceToSkinDialog=function(v){var C=this;n.default.load("prefab/shop/DialogOneButtonPrefab",function(T,E){var A=E.getComponent(a.default);p.default.getInstance().isEnglish()?(A.setContent("<color=3B5D72><size=30>Congratulations, collection of all skin puzzle\n\r"+v.displayName+" unlock!</size></color>"),A.setBtnTxt("Get")):(A.setContent("<color=3B5D72><size=30>\u606D\u559C\u60A8\u5DF2\u96C6\u9F50\u6240\u6709\u76AE\u80A4\u788E\u7247,\n\r"+v.displayName+"\u76AE\u80A4\u5DF2\u6C38\u4E45\u89E3\u9501!</size></color>"),A.setBtnTxt("\u9886\u53D6")),A.setBottonCallback(function(M){M.destroy(),C.onTipsConfirm(v)}),C.node.addChild(E)})},S.prototype.onTipsConfirm=function(v){u.default.fire(c.default.SKIN_PIECES_UNLOCK,v),this.onClose()},S.prototype.onDestroy=function(){},S.TAG="[SkinTaskPageViewPrefab]=====>>>",S.PAGE_WIDTH=677,S.PAGE_HEIGHT=1058,S.PAGE_HEIGHT_NO_BUY=923,__decorate([g(cc.PageView)],S.prototype,"mPageView",void 0),__decorate([g(cc.Layout)],S.prototype,"mContentLayout",void 0),__decorate([g(cc.Sprite)],S.prototype,"lastSprite",void 0),__decorate([g(cc.Sprite)],S.prototype,"nextSprite",void 0),__decorate([g(cc.Button)],S.prototype,"mCloseBtn",void 0),__decorate([g(cc.Sprite)],S.prototype,"mCloseSprite",void 0),S=I=__decorate([f],S)}(cc.Component);m.default=_,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../infoc/m_p2_skin_piece":"m_p2_skin_piece","../Logic/EventBus":"EventBus","../Logic/I18nManager":"I18nManager","../Logic/NotifyEvent":"NotifyEvent","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../shop/DialogOneButtonPrefab":"DialogOneButtonPrefab","./SkinTaskPrefab":"SkinTaskPrefab","./frag/SkinTaskMgr":"SkinTaskMgr"}],SkinTaskPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"a8e66KTHphOY6Q0d9Vqhd9Y","SkinTaskPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./frag/SkinTaskMgr"),s=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),r=l("./SkinTaskItemPrefab"),o=l("../UI/GameEntraScene/ImgCache"),e=l("../Logic/GameItemsManager"),n=l("./SkinPieceMgr"),t=l("../Logic/EventBus"),i=l("../Logic/NotifyEvent"),a=l("../UI/GameEntraScene/ToastPrefab"),u=l("../UI/GameEntraScene/PrefabMgr"),c=l("../../base/Log"),p=l("../propAddition/Define"),h=l("../../util/StringUtil"),f=l("../../infoc/m_p2_skin_piece"),g=cc._decorator,_=g.ccclass,y=g.property,S=function(I){function v(){var T=I!==null&&I.apply(this,arguments)||this;return T.rootNode=null,T.skinIconSprite=null,T.skinTitleSprite=null,T.skinPiecesSprite=null,T.piecesOwnLabel=null,T.task1Node=null,T.task2Node=null,T.task3Node=null,T.task4Node=null,T.pieceAnimLabel1=null,T.pieceAnimLabel2=null,T.effectNode=null,T.effectRichText=null,T.mSkinItemInfo=null,T.mSource=f.default.SOURCE_SKIN_STORE,T.hasOnStart=!1,T.hasInitItem=!1,T}var C;return __extends(v,I),(C=v).prototype.setTaskGoingListerer=function(T){this.mTaskGoingListener=T},v.prototype.setPieceEnoughListerer=function(T){this.mPieceEnoughListener=T},v.prototype.setSkinItemInfo=function(T){this.mSkinItemInfo=T},v.prototype.setSource=function(T){this.mSource=T},v.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,function(T){T.stopPropagation()}),this.initEvent(),this.initTaskData(),this.initView()},v.prototype.onStart=function(){this.hasOnStart=!0,this.hasInitItem&&this.onItemStart()},v.prototype.onItemStart=function(){for(var T=[this.task1Node,this.task2Node,this.task3Node,this.task4Node],E=0;E<4;E++){var A=T[E].children[0];A&&A.getComponent(r.default).onStart()}},v.prototype.initTaskData=function(){var T=this;s.MGUser.getCurrentServerRealTime({complete:function(E,A){c.default.i("[SkinTaskPrefab]===>>>onLoad  getCurrentServerRealTime result = "+E),E&&d.default.Ins().getLockedSkinTasks(A,function(M){M.forEach(function(k){k.skinId==T.mSkinItemInfo.skinId&&T.initTasks(k)})})}})},v.prototype.initTasks=function(T){var E=this;c.default.i("[SkinTaskPrefab]===>>>initTasks task = ",T);var A=[this.task1Node,this.task2Node,this.task3Node,this.task4Node];T&&T.task&&0<T.task.length&&u.default.load("/prefab/SkinTaskItemPrefab",function(M,k){if(k){for(var D=cc.instantiate(k),L=0;L<4;L++)if(T.task[L]){var b=cc.instantiate(D),N=b.getComponent(r.default);N.setTaskGoingListerer(E.mTaskGoingListener),N.setToastCb(E.showToastTips.bind(E)),N.setData(T.task[L],E.mSkinItemInfo.piecesId,L),N.setSource(E.mSource),N.setDoPieceFlyAnimationCb(E.doPieceFly.bind(E)),A[L].removeAllChildren(),A[L].addChild(b)}E.hasInitItem=!0,E.hasOnStart&&E.onItemStart()}})},v.prototype.initView=function(){var T=p.default.getAdditionDesc(this.mSkinItemInfo.skinId);if(h.StringUtil.isEmpty(T))this.effectNode.active=!1;else{this.effectNode.active=!0;var E=T.indexOf("color=#");E!=-1&&(T=T.replace(T.substr(E+7,6),"FFF838")),this.effectRichText.string=T}o.default.get2(e.GameItemsManager.getIns().getSmallPicByItemId(this.mSkinItemInfo.skinId),this.skinIconSprite),o.default.get2(e.GameItemsManager.getIns().getSmallPicByItemId(this.mSkinItemInfo.piecesId),this.skinPiecesSprite),o.default.get2(this.getSkinTitle(this.mSkinItemInfo.skinId),this.skinTitleSprite),this.piecesOwnLabel.string=n.default.Ins().getPieceCount(this.mSkinItemInfo.piecesId)+"/"+this.mSkinItemInfo.piecesTotal,this.invokePieceEnough()},v.prototype.invokePieceEnough=function(){n.default.Ins().getPieceCount(this.mSkinItemInfo.piecesId)>=this.mSkinItemInfo.piecesTotal&&this.mPieceEnoughListener&&this.mPieceEnoughListener(this.mSkinItemInfo)},v.prototype.initEvent=function(){t.default.register(i.default.SKIN_TASK_UPDATE_PIECES_UI,this.updatePieces,this),t.default.register(i.default.SKIN_TASK_CACHE_UPDATE_UI,this.initTaskData,this)},v.prototype.showToastTips=function(T,E){var A=this;u.default.load("prefab/ToastPrefab",function(M,k){if(k){var D=k.getComponent(a.default);D.showTips(T,function(){k.destroy()}),D.setLong(E),A.node.addChild(k)}})},v.prototype.buySkin=function(){},v.prototype.getSkinTitle=function(T){return"/static_res/skin_chip/skin_title/skin_title_"+T},v.prototype.onDestroy=function(){this.unRegistEvent()},v.prototype.updatePieces=function(T,E){c.default.i("[SKinTaskPrefab]====>>> updatePieces \u66F4\u65B0 \u754C\u9762 \u788E\u7247\u6570\u91CF params = ",E);var A=E[0];this.playPieceAddAnim(A)},v.prototype.playPieceAddAnim=function(T){return __awaiter(this,void 0,void 0,function(){var E,A,M,k,D,L,b;return __generator(this,function(N){switch(N.label){case 0:if(this.mSkinItemInfo.piecesId!=T.pieceID)return[3,2];for((E=n.default.Ins().getPieceCount(this.mSkinItemInfo.piecesId)-T.count)<0&&(E=0),A=n.default.Ins().getPieceCount(this.mSkinItemInfo.piecesId),M=2*(A+"").length,k="",b=0;b<M;b++)k+=" ";for(D=2*(this.mSkinItemInfo.piecesTotal+"").length+1,L="",b=0;b<D;b++)L+=" ";return this.piecesOwnLabel.string=k+"/"+this.mSkinItemInfo.piecesTotal,[4,this.doOneAddAnim(E,L,A)];case 1:N.sent(),this.pieceAnimLabel1.node.active=!1,this.pieceAnimLabel2.node.active=!1,this.piecesOwnLabel.string=n.default.Ins().getPieceCount(this.mSkinItemInfo.piecesId)+"/"+this.mSkinItemInfo.piecesTotal,this.invokePieceEnough(),N.label=2;case 2:return[2]}})})},v.prototype.doOneAddAnim=function(T,E,A){var M=this;return new Promise(function(k,D){var L=M.rootNode.getComponent(cc.Animation);M.pieceAnimLabel1.node.active=!0,M.pieceAnimLabel2.node.active=!0,M.pieceAnimLabel1.string=A+E,M.pieceAnimLabel2.string=T+E,L.once("finished",function(){c.default.w("showOff => play add animation finished."),k(!0)},M),L.play(C.ADD_PIECE_AMIN)})},v.prototype.doPieceFly=function(T,E,A){var M=this;E==1?this.scheduleOnce(function(){M.playAddPieceSuccessAnim(T,function(){A&&A()})},0):E==2?(this.scheduleOnce(function(){M.playAddPieceSuccessAnim(T)},0),this.scheduleOnce(function(){M.playAddPieceSuccessAnim(T,function(){A&&A()})},.1)):(this.scheduleOnce(function(){M.playAddPieceSuccessAnim(T)},0),this.scheduleOnce(function(){M.playAddPieceSuccessAnim(T)},.1),this.scheduleOnce(function(){M.playAddPieceSuccessAnim(T,function(){A&&A()})},.2))},v.prototype.playAddPieceSuccessAnim=function(T,E){var A=new cc.Node;A.width=T.node.width,A.height=T.node.height;var M=T.node.parent.convertToWorldSpaceAR(T.node.getPosition()),k=this.node.convertToNodeSpaceAR(M);A.setPosition(k);var D=A.addComponent(cc.Sprite);D.type=cc.Sprite.Type.SIMPLE,D.sizeMode=cc.Sprite.SizeMode.CUSTOM,D.spriteFrame=T.spriteFrame;var L=this.skinPiecesSprite.node.parent.convertToWorldSpaceAR(this.skinPiecesSprite.node.getPosition()),b=this.node.convertToNodeSpaceAR(L);this.node.addChild(A);var N=b.x-A.x,H=b.y-A.y,R=[cc.p(b.x-.3*N,b.y-.8*H),cc.p(b.x-0*N,b.y-.3*H),cc.p(b.x,b.y)],F=cc.bezierTo(.35,R),x=cc.fadeTo(.02,0),U=cc.scaleTo(.35,.4,.4),B=cc.spawn(F,U),Q=cc.sequence(B,x,cc.callFunc(function(){A.destroy(),E&&E()}));A.runAction(Q)},v.prototype.unRegistEvent=function(){t.default.remove(i.default.SKIN_TASK_UPDATE_PIECES_UI,this.updatePieces,this),t.default.remove(i.default.SKIN_TASK_CACHE_UPDATE_UI,this.initTaskData,this)},v.ADD_PIECE_AMIN="skin_task_pieces_add",__decorate([y(cc.Node)],v.prototype,"rootNode",void 0),__decorate([y(cc.Sprite)],v.prototype,"skinIconSprite",void 0),__decorate([y(cc.Sprite)],v.prototype,"skinTitleSprite",void 0),__decorate([y(cc.Sprite)],v.prototype,"skinPiecesSprite",void 0),__decorate([y(cc.Label)],v.prototype,"piecesOwnLabel",void 0),__decorate([y(cc.Node)],v.prototype,"task1Node",void 0),__decorate([y(cc.Node)],v.prototype,"task2Node",void 0),__decorate([y(cc.Node)],v.prototype,"task3Node",void 0),__decorate([y(cc.Node)],v.prototype,"task4Node",void 0),__decorate([y(cc.Label)],v.prototype,"pieceAnimLabel1",void 0),__decorate([y(cc.Label)],v.prototype,"pieceAnimLabel2",void 0),__decorate([y(cc.Node)],v.prototype,"effectNode",void 0),__decorate([y(cc.RichText)],v.prototype,"effectRichText",void 0),v=C=__decorate([_],v)}(cc.Component);m.default=S,cc._RF.pop()},{"../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../base/Log":"Log","../../infoc/m_p2_skin_piece":"m_p2_skin_piece","../../util/StringUtil":"StringUtil","../Logic/EventBus":"EventBus","../Logic/GameItemsManager":"GameItemsManager","../Logic/NotifyEvent":"NotifyEvent","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","../propAddition/Define":"Define","./SkinPieceMgr":"SkinPieceMgr","./SkinTaskItemPrefab":"SkinTaskItemPrefab","./frag/SkinTaskMgr":"SkinTaskMgr"}],SkinTask:[function(l,P,m){"use strict";cc._RF.push(P,"90771Ed3uFLIoXqHH6j5QW7","SkinTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Network/Protocol/StorageUtil"),s=l("../../../config/LSKey"),r=l("../../../util/StringUtil"),o=l("../../../util/TimeUtil"),e=l("../../../base/Log"),n=function(){function t(){}return t.prototype.initData=function(i){this.initTask(i),e.default.l("SkinTask====>>, initData this = ",this)},t.prototype.getTaskStr=function(i){var a=o.default.formatDate(i),u=this.skinId+":";return this.task.forEach(function(c){var p=c.getTaskStr(a);r.StringUtil.isEmpty(p)||(u+=p+",")}),u=u.substr(0,u.length-1)},t.prototype.initTask=function(i){var a=this,u=d.default.read(s.default.SKIN_TASK_STEP_STATUS);r.StringUtil.isEmpty(u)||u.split("&").forEach(function(c){var p=c.split(":");p[0]==a.skinId&&a.initTaskReal(p[1],i)})},t.prototype.initTaskReal=function(i,a){var u=this;r.StringUtil.isEmpty(i)||i.split(",").forEach(function(c){u.task.forEach(function(p){p.initTask(c,a)})})},t}();m.default=n,cc._RF.pop()},{"../../../base/Log":"Log","../../../config/LSKey":"LSKey","../../../util/StringUtil":"StringUtil","../../../util/TimeUtil":"TimeUtil","../../Network/Protocol/StorageUtil":"StorageUtil"}],SkinTryData:[function(l,P,m){"use strict";cc._RF.push(P,"ad6f96YplFDW5oJvwrLXgC0","SkinTryData"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){this.source=s.SOURCE_NONE,this.itemInfo=null,this.trySkinFinish=!1}return s.SOURCE_NONE=0,s.SOURCE_SKIN_STORE=1,s.SOURCE_SKIN_STORE_INVITE_POPUP=2,s.SOURCE_INVITE_POPUP=3,s}();m.default=d,cc._RF.pop()},{}],SkinUtils:[function(l,P,m){"use strict";cc._RF.push(P,"cdcdawc0KxNO7yOIGiMC9IK","SkinUtils"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/SkinDataManager"),s=l("../UI/GameEntraScene/ToastPrefab"),r=l("./DownLoadingPrefab"),o=l("../../base/G"),e=l("../../base/State"),n=l("../../gamescene/GameSceneSetting"),t=l("../Logic/Plugin/PluginMgr"),i=l("../Logic/Plugin/IPlugin"),a=l("../../util/PU"),u=l("../UI/GameEntraScene/PrefabMgr"),c=l("../../business/Logic/I18nManager"),p=function(){function h(){}return h.needTryInviteSkinSpecSong=function(f){return!1},h.isNetWorkConnected=function(){return o.G.networkType!="none"&&o.G.networkIsConnected!=0},h.trySkinSpecSong=function(f,g){var _=this,y=d.SkinDataMgr.Ins().getInviteSkin();cc.sys.isBrowser?this.realTrySpecSong(f,y,g):d.SkinDataMgr.isSkinExist(y.name,function(S){S==0||y.isNeedUpdate?a.default.isWeiXin()&&!_.isNetWorkConnected()?_.realSpecSongStartGame(f):_.showTrySpecSongDownloadingPopup(f,y,g):_.realTrySpecSong(f,y,g)})},h.useSkin=function(f,g,_,y,S,I){var v=this;cc.sys.isBrowser?this.realUse(f,g,S,I):d.SkinDataMgr.isSkinExist(f.name,function(C){C==0||f.isNeedUpdate?v.showUseDownloadingPopup(f,g,_,y,S,I):v.realUse(f,g,S,I)})},h.trySkin=function(f,g,_,y,S){var I=this;console.log("[SkinStore] itemTrySkinCallback skin = "+f),cc.sys.isBrowser?this.realTry(f,g,S):d.SkinDataMgr.isSkinExist(f.name,function(v){v==0||f.isNeedUpdate?I.showTryDownloadingPopup(f,g,_,y,S):I.realTry(f,g,S)})},h.showTrySpecSongDownloadingPopup=function(f,g,_){var y=this;console.log("[SkinStore] showTrySpecSongDownloadingPopup skin = "+g),u.default.load(this.downloadPrefab,function(S,I){I.getComponent(r.default).setCancelCallback(function(){I.destroy(),d.SkinDataMgr.cancelDownloadSkin(g),y.realSpecSongStartGame(f)}),_.addChild(I),d.SkinDataMgr.downloadSkin(g.name,function(){I.destroy(),g.isDownload=!0,g.isNeedUpdate=!1,y.realTrySpecSong(f,g,_)},function(){I.destroy(),y.realSpecSongStartGame(f)})})},h.showTryDownloadingPopup=function(f,g,_,y,S){var I=this;console.log("[SkinStore] showDownloadingPopup skin = "+f),u.default.load(this.downloadPrefab,function(v,C){C.getComponent(r.default).setCancelCallback(function(){C.destroy(),d.SkinDataMgr.cancelDownloadSkin(f)}),g.addChild(C),d.SkinDataMgr.downloadSkin(f.name,function(){C.destroy(),f.isDownload=!0,f.isNeedUpdate=!1,_(),I.realTry(f,g,S)},function(){C.destroy(),c.default.getInstance().isEnglish()?I.showToast("Download failed, please check the network",g):I.showToast("\u4E0B\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC",g),y()})})},h.showUseDownloadingPopup=function(f,g,_,y,S,I){var v=this;console.log("[SkinStore] showDownloadingPopup skin = "+f),u.default.load(this.downloadPrefab,function(C,T){T.getComponent(r.default).setCancelCallback(function(){T.destroy(),d.SkinDataMgr.cancelDownloadSkin(f)}),g.addChild(T),d.SkinDataMgr.downloadSkin(f.name,function(){T.destroy(),f.isDownload=!0,f.isNeedUpdate=!1,_(),v.realUse(f,g,S,I)},function(){T.destroy(),c.default.getInstance().isEnglish()?v.showToast("Download failed, please check the network",g):v.showToast("\u4E0B\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC",g),y()})})},h.realUse=function(f,g,_,y){var S=this;console.log("[SkinStore] useSkin skin = "+f),this.showLoadingSkinScene(g,function(I){d.SkinDataMgr.Ins().changeSkin(f,function(){for(var v=d.SkinDataMgr.Ins().getSkinList().length,C=0;C<v;C++)d.SkinDataMgr.Ins().getSkinList()[C].isUsing&&(d.SkinDataMgr.Ins().getSkinList()[C].isUsing=!1);I.destroy(),f.isUsing=!0,_&&_()},function(){I.destroy(),c.default.getInstance().isEnglish()?S.showToast("Failed to load",g):S.showToast("\u52A0\u8F7D\u5931\u8D25",g),y&&y()})})},h.realSpecSongStartGame=function(f){if(f)o.G.Ap.presenter.enterScene(o.G.GAME_SCENE_NAME,o.G.Ap.state.mission.musicId);else{var g=t.default.Ins().getPlugin(i.default.Plugin_Energy);o.G.Ap.state.reset(),o.G.Ap.state.mission=new e.Mission(h.SPEC_SONG_LEVEL_ID,h.SPEC_SONG_ID,!1),o.G.Ap.config.loadMusic(o.G.Ap.state.mission.musicId,function(_){g.decreaseEnergy(1),n.default.getInstance().setFromSource(n.FromSource.SOURCE_MUSIC),o.G.Ap.presenter.enterScene(o.G.GAME_SCENE_NAME,o.G.Ap.state.mission.musicId,function(){})})}},h.realTrySpecSong=function(f,g,_){var y=this;console.log("[SkinStore] trySkin skin = "+g),this.showLoadingSkinScene(_,function(S){d.SkinDataMgr.Ins().switchTrialSkin(g,function(){if(f)o.G.Ap.state.mission=new e.ExclusiveSkinMission(h.SPEC_SONG_LEVEL_ID,h.SPEC_SONG_ID),o.G.Ap.presenter.enterScene(o.G.GAME_SCENE_NAME,o.G.Ap.state.mission.musicId);else{var I=t.default.Ins().getPlugin(i.default.Plugin_Energy);o.G.Ap.state.reset(),o.G.Ap.state.mission=new e.ExclusiveSkinMission(h.SPEC_SONG_LEVEL_ID,h.SPEC_SONG_ID),o.G.Ap.config.loadMusic(o.G.Ap.state.mission.musicId,function(v){I.decreaseEnergy(1),n.default.getInstance().setFromSource(n.FromSource.SOURCE_SKIN_TRY),o.G.Ap.presenter.enterScene(o.G.GAME_SCENE_NAME,o.G.Ap.state.mission.musicId)})}S.destroy()},function(){S.destroy(),y.realSpecSongStartGame(f)})})},h.realTry=function(f,g,_){var y=this;console.log("[SkinStore] trySkin skin = "+f),this.showLoadingSkinScene(g,function(S){d.SkinDataMgr.Ins().switchTrialSkin(f,function(){_&&_(),o.G.Ap.state.reset(),o.G.Ap.state.mission=new e.Mission(400,200004,!1),o.G.Ap.state.mission.trial=!0,o.G.Ap.config.loadMusic(o.G.Ap.state.mission.musicId,function(I){n.default.getInstance().setFromSource(n.FromSource.SOURCE_SKIN_TRY),o.G.Ap.presenter.enterScene(o.G.GAME_SCENE_NAME,o.G.Ap.state.mission.musicId)}),S.destroy()},function(){c.default.getInstance().isEnglish()?y.showToast("Failed to load",g):y.showToast("\u52A0\u8F7D\u5931\u8D25",g),S.destroy()})})},h.showToast=function(f,g){u.default.load("prefab/ToastPrefab",function(_,y){y.getComponent(s.default).showTips(f,function(){y.destroy()}),g.addChild(y)})},h.showLoadingSkinScene=function(f,g){u.default.load("prefab/SkinLoadingprefab",function(_,y){f.addChild(y),g(y)})},h.SPEC_SONG_ID=100002,h.SPEC_SONG_LEVEL_ID=2,h.downloadPrefab="prefab/DownLoadingPrefab",h}();m.default=p,cc._RF.pop()},{"../../base/G":"G","../../base/State":"State","../../business/Logic/I18nManager":"I18nManager","../../gamescene/GameSceneSetting":"GameSceneSetting","../../util/PU":"PU","../Logic/Plugin/IPlugin":"IPlugin","../Logic/Plugin/PluginMgr":"PluginMgr","../Logic/SkinDataManager":"SkinDataManager","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPrefab":"ToastPrefab","./DownLoadingPrefab":"DownLoadingPrefab"}],Skin:[function(l,P,m){"use strict";cc._RF.push(P,"74247ymYo1FMo8UITSQj++g","Skin"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./SkinElementPainter"),s=function(){function o(){this.displayName=""}return o.prototype.clone=function(){var e=new o;return e.displayName=this.displayName,e},o.prototype.fromJson=function(e){this.displayName=e.displayName},o}();m.SkinProperty=s;var r=function(){function o(e){this.skinObject=e,this.property=new s,this.skinElementPainter=new d.default(this.skinObject)}return o.prototype.getSkinObject=function(){return this.skinObject},o.prototype.getSkinElementPainter=function(){return this.skinElementPainter},o.prototype.getProperty=function(){return this.property},o.prototype.setProperty=function(e){this.property=e},o}();m.default=r,cc._RF.pop()},{"./SkinElementPainter":"SkinElementPainter"}],SocialHelper:[function(l,P,m){"use strict";cc._RF.push(P,"a6ceeJFQaBGL55RRweKr6YH","SocialHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./WXHelper"),s=l("./Bean"),r=l("../business/DB/DBMgr"),o=l("../business/UI/MusicLevelDataLoader"),e=l("../business/Logic/PlayerMgr"),n=l("../base/Log"),t=l("../LogicPlatform/PlatformProxy"),i=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),a=l("../../modules/MGAppShare/scripts/MGAppShare"),u=function(){function c(){}return c.onShowListen=function(p){t.default.Ins().onShowListen(p)},c.offShowListen=function(p){t.default.Ins().offShowListen(p)},c.onHideListen=function(p){t.default.Ins().onHideListen(p)},c.offHideListen=function(p){t.default.Ins().offHideListen(p)},c.getLaunchParameter=function(){return t.default.Ins().getLaunchParameter()},c.initShare=function(p,h,f,g,_){f&&0<f.length?f+="&src="+g:f="src="+g,console.log("initShare = "+h),a.default.initShare(p,h,f,_)},c.shareAppMessageWithDialog=function(p,h,f,g,_,y){console.log("[SocialHelper] shareAppMessageWithDialog title:"+p+" imgurl:"+h+" imglocal:"+f),g&&0<g.length?g+="&src="+_:g="src="+_;var S={summary:p,picUrl:h,extendInfo:g,localPicPath:f};console.log("[SocialHelper] shareAppMessageWithDialog QQVer="+GameStatusInfo.QQVer),BK.QQ.share(S,function(I,v,C){console.log("[SocialHelper] shareAppMessageWithDialog retCode:"+I+" shareDest:"+v+" isFirstShare:"+C),I==0?(v==0?console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3QQ"):v==1?console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3\u7A7A\u95F4"):v==2?console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3\u5FAE\u4FE1"):v==3&&console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3\u670B\u53CB\u5708"),y(!0,v)):(I==1?console.log("[SocialHelper] shareAppMessageWithDialog \u5206\u4EAB\u5931\u8D25"+I):I==2?console.log("[SocialHelper] shareAppMessageWithDialog \u5206\u4EAB\u5931\u8D25\uFF0C\u7528\u6237\u53D6\u6D88\u5206\u4EAB\uFF1A"+I):console.log("[SocialHelper] shareAppMessageWithDialog \u5206\u4EAB\u5931\u8D25\uFF0C\u672A\u77E5\u9519\u8BEF\uFF1A"+I),y(!1,v))})},c.shareAppMessageByWx=function(p,h,f,g,_){f&&0<f.length?f+="&src="+g:f="src="+g,console.log("shareImageUrl = "+h),d.WXHelper.shareAppMessage(p,h,f,_)},c.updatePlayerInfo=function(p){c.postMessage(s.Message.MSG_UPDATE_PLAYER_INFO,p)},c.updatePKRankInfo=function(p){c.postMessage(s.Message.MSG_UPDATE_PK_RANK_INFO,p)},c.updateTotalScore=function(p){c.postMessage(s.Message.MSG_UPDATE_TOTAL_SCORE,p)},c.updateSongScore=function(p){p.keyId||(p.keyId=c.getMusicKeyID(p.songId)),c.postMessage(s.Message.MSG_UPDATE_SONG_SCORE,p)},c.advanceLoadGroupRankData=function(p){c.postMessage(s.Message.MSG_ADVANCEL_LOAD_GROUP_RNAK_DATA,p)},c.refreshSelfRankData=function(){var p=Date.now(),h=e.default.Ins(),f={crown:h.getTotalCrown(),star:h.getTotalStar(),grade:h.getUserLevel(),score:h.getTotalScore()};console.warn("[SocialHelper.refreshSelfRankData] totalScoreData, timecost="+(Date.now()-p)+"ms"),p=Date.now();var g=o.MusicLevelDataLoader.getUnlockItemInfo();console.warn("[SocialHelper.refreshSelfRankData] getUnlockItemInfo, timecost="+(Date.now()-p)+"ms"),p=Date.now();for(var _=new Array,y=0;y<g.length;y++){var S=g[y],I=this.getMusicKeyID(S.musicId.toString());if(S.bestScore!=0&&I!=-1){var v=3<S.bestStar?S.bestStar-3:0,C=3<S.bestStar?0:S.bestStar;_.push({key:I,songid:S.musicId.toString(),crown:v,star:C,score:S.bestScore,locked:S.isLocked})}}console.warn("[SocialHelper.refreshSelfRankData] songDataArray, timecost="+(Date.now()-p)+"ms");var T={total:f,songs:_};c.postMessage(s.Message.MSG_REFRESH_SONG_SCORE,T)},c.updateCache=function(){c.postMessage(s.Message.MSG_UPDATE_CACHE,{cachePath:t.default.Ins().getUserDataPath()})},c.drawRanking=function(p){!p.keyId&&p.songId&&(p.keyId=c.getMusicKeyID(p.songId)),c.postMessage(s.Message.MSG_DRAW_RANKING,p)},c.exitDrawRanking=function(p){c.postMessage(s.Message.MSG_EXIT_DRAW_RANKING,p)},c.syncDrawRanking=function(p){c.postMessage(s.Message.MSG_SYNC_DRAW_RANKING,p)},c.touchRankList=function(p){c.postMessage(s.Message.MSG_TOUCH_RANK_LIST,p)},c.preLoadOpenDataContext=function(){c.postMessage(s.Message.MSG_PRE_LOAD_OPENDATACONTEXT)},c.getMusicKeyID=function(p){var h=r.default.Ins().getDBRow(r.eDataBase.eDB_MusicKey,p),f=h?h.getKid():-1;return f||-1},c.addPlayIdToShareQuery=function(p){return cc.sys.platform===cc.sys.QQ_PLAY&&c.sPlayerId!=null&&(p&&0<p.length?p+="&playerid="+c.sPlayerId:p="playerid="+c.sPlayerId),p},c.postMessage=function(p,h){cc.sys.platform==cc.sys.WECHAT_GAME?d.WXHelper.postMessageToOpenData(p,h):cc.sys.platform==cc.sys.QQ_PLAY&&c.sbInitPlatform==0&&(c.sbInitPlatform=!0,i.MGUser.getUserLoginInfo({success:function(f){f&&(c.sPlayerId=f.sid,n.default.l("set sPlayerId ===>"+c.sPlayerId))},fail:function(){console.error("set sPlayerId error")}}))},c.SHARE_TYPE_SHARE="share",c.SHARE_TYPE_RANK="rank",c.sbInitPlatform=!1,c}();m.SocialHelper=u,cc._RF.pop()},{"../../modules/MGAppShare/scripts/MGAppShare":"MGAppShare","../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../LogicPlatform/PlatformProxy":"PlatformProxy","../base/Log":"Log","../business/DB/DBMgr":"DBMgr","../business/Logic/PlayerMgr":"PlayerMgr","../business/UI/MusicLevelDataLoader":"MusicLevelDataLoader","./Bean":"Bean","./WXHelper":"WXHelper"}],SocialManager:[function(l,P,m){"use strict";cc._RF.push(P,"6ca1bwONg1P5JL6hfdCvmQz","SocialManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./SocialHelper"),s=l("../business/Logic/Plugin/PluginMgr"),r=l("../business/Logic/Plugin/IPlugin"),o=l("../business/Network/Protocol/StorageUtil"),e=l("../config/LSKey"),n=l("../../modules/MGAppShare/scripts/ShareHelper"),t=l("../base/G"),i=l("../base/State"),a=l("../gamescene/GameSceneSetting"),u=l("../business/Core/GameDefine"),c=l("../business/UI/GameEntraScene/CheckActivityRewardProcessor"),p=l("../util/PU"),h=function(){function f(){this.mUpdatedCache=!1,this.mShowedRankingListPage=!1}return f.getInstance=function(){return f.mInstance||(f.mInstance=new f),f.mInstance},f.prototype.onShow=function(g){console.log("[QQGame] ------- onShow launchOption = ",g),this.mUpdatedCache||(this.mUpdatedCache=!0,d.SocialHelper.updateCache()),f.shouldEnterGameSceneByHotSongShare(g)&&(this.enterGameForHotSong(g),o.default.save(e.default.ENTER_GAME_BY_HOT_SONG_SHARE,"true"))},f.prototype.onHide=function(){console.log("[QQGame] ------- onHide"),this.mShowedRankingListPage=!1,this.mUpdatedCache=!1},f.prototype.isNeedShowRankingListScene=function(g){return!p.default.isCM()&&(g&&g.query&&g.query.src&&g.shareTicket&&!this.mShowedRankingListPage?(_=g.query.src==d.SocialHelper.SHARE_TYPE_RANK&&(this.mShowedRankingListPage=!0),console.log("#####isNeedShowRankingListScene,\u7ED3\u679C:"+_+",src:"+g.query.src+",mShowedRankingListPage:"+this.mShowedRankingListPage),_):(console.log("#####isNeedShowRankingListScene:false"),console.log(g),!1));var _},f.shouldEnterGameSceneByHotSongShare=function(g){if(!g||!g.query)return!1;var _=g.query,y=parseInt(_.source)||0,S=parseInt(_.levelId)||0,I=o.default.read(e.default.ENTER_GAME_BY_HOT_SONG_SHARE)==="true",v=o.default.read(e.default.HAS_FIRST_PLAY_LITTLE_STAR)==="true";return y===n.ShareHelper.SHARE_SOURCE_INVITE_SONG&&S>=u.Constant.CHOICENESS_STARTID&&!I&&!v},f.prototype.enterGameForHotSong=function(g){if(g){var _=parseInt(g.query.musicId)||0,y=parseInt(g.query.levelId)||0;t.G.Ap.state.reset(),s.default.Ins().getPlugin(r.default.Plugin_Energy).decreaseEnergy(2),t.G.Ap.state.mission=new i.Mission(y,_,!1),t.G.Ap.config.loadMusic(_,function(S){a.default.getInstance().setFromSource(a.FromSource.SOURCE_RANK_OTHER),t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,_)}),new c.default(null).checkShareForSongInviteeReward()}},f}();m.default=h,cc._RF.pop()},{"../../modules/MGAppShare/scripts/ShareHelper":"ShareHelper","../base/G":"G","../base/State":"State","../business/Core/GameDefine":"GameDefine","../business/Logic/Plugin/IPlugin":"IPlugin","../business/Logic/Plugin/PluginMgr":"PluginMgr","../business/Network/Protocol/StorageUtil":"StorageUtil","../business/UI/GameEntraScene/CheckActivityRewardProcessor":"CheckActivityRewardProcessor","../config/LSKey":"LSKey","../gamescene/GameSceneSetting":"GameSceneSetting","../util/PU":"PU","./SocialHelper":"SocialHelper"}],SongBoxManager:[function(l,P,m){"use strict";cc._RF.push(P,"76c19PhJ5NIZ4tfbCKlnuXc","SongBoxManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=function(){function o(){}return o.Ins=function(){return this.mInstance||(this.mInstance=new o),this.mInstance},o.prototype.getSongBoxVM=function(){for(var e=[],n=0,t=d.default.Ins().getDBRows(d.eDataBase.eDB_SongBox);n<t.length;n++){var i=t[n],a=parseInt(i.mRowData[0]);if(a&&typeof a=="number"){var u=new r,c=i;u.id=c.getId(),u.frequenceMin=c.getFrequenceMin(),u.frequenceMax=c.getFrequenceMax(),u.chance=c.getChance(),u.coin=c.getCoin(),u.fragments=c.getFragments(),u.power=c.getPower(),u.fixedReward=c.getFixedReward(),e.push(u)}}return Object.seal(e)},o}();m.SongBoxMgr=s;var r=function(){};m.SongBoxVM=r,cc._RF.pop()},{"../DB/DBMgr":"DBMgr"}],SongBox:[function(l,P,m){"use strict";cc._RF.push(P,"d8adfWy2tBMz7U8ghZ+t+5y","SongBox"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findSongBoxById=function(n){return this.find("id",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.SongBox=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getId=function(){return this.getInt("id")},e.prototype.getFrequenceMin=function(){return this.getInt("frequenceMin")},e.prototype.getFrequenceMax=function(){return this.getInt("frequenceMax")},e.prototype.getChance=function(){return this.getInt("chance")},e.prototype.getCoin=function(){return this.getInt("coin")},e.prototype.getFragments=function(){return this.getInt("fragments")},e.prototype.getPower=function(){return this.getInt("power")},e.prototype.getFixedReward=function(){return this.getInt("fixedReward")},e}(d.default);m.SongBoxRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],SongTryData:[function(l,P,m){"use strict";cc._RF.push(P,"9afd5C4kKhPuL2gYsifwgQc","SongTryData"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.songTryListPosition=-1,this.songTryFinish=!1};m.default=d,cc._RF.pop()},{}],Sound:[function(l,P,m){"use strict";cc._RF.push(P,"e4769ydy3tO1aUx2csK7Szk","Sound"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../music/InstrumentFactory"),s=function(){function r(){this.instrumantFactory=new d.default}return r.prototype.getInstrumentFactory=function(){return this.instrumantFactory},r}();m.default=s,cc._RF.pop()},{"../music/InstrumentFactory":"InstrumentFactory"}],SplitLine:[function(l,P,m){"use strict";cc._RF.push(P,"b37c9meN9tMCIVkIvvw1Kz0","SplitLine"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/G"),s=function(r){function o(e){var n=r.call(this,e)||this;return n.updateLines(d.G.Ap.config.presentScale),n.setColor(new cc.Color(255,255,255,255)),n}return __extends(o,r),o.prototype.updateLines=function(e){var n=Math.floor(90*e),t=[Math.floor(270*e)-n,Math.floor(450*e)-n,Math.floor(630*e)-n],i=d.G.Ap.config.presentHeight*e,a=[];a.push(new cc.Vec2(t[0],0)),a.push(new cc.Vec2(t[0],i)),a.push(new cc.Vec2(t[1],0)),a.push(new cc.Vec2(t[1],i)),a.push(new cc.Vec2(t[2],0)),a.push(new cc.Vec2(t[2],i)),this.setLine(a)},o}(l("../../MUI/MUILine").default);m.default=s,cc._RF.pop()},{"../../../base/G":"G","../../MUI/MUILine":"MUILine"}],SprintWorker:[function(l,P,m){"use strict";cc._RF.push(P,"8dce5Y4ytxP4r88yM9ZlFf8","SprintWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../workers/WorkerBase"),s=l("../../workers/WorkerState"),r=l("../../../property/PropertyDefines"),o=l("../../../base/G"),e=l("../../../util/runtime/Tween"),n=l("../../GameBus"),t=l("../../../util/runtime/ClassType"),i=l("./../../../base/Log"),a=function(u){function c(){var p=u.call(this,"SprintWorker")||this;return p.speed=0,p.preSpeed=0,p.endSpeed=0,p.duration=0,p.recoveryTime=0,p.obtained=!1,p.sprintProperty=null,p.startCallback=null,p}return __extends(c,u),c.prototype.init=function(p,h,f){var g=p.getSpeed(),_=o.G.Ap.config.mBaseBlockHeight;this.speed=h.speed*_||g,this.duration=h.permanentTime||0,this.updateAdditionTime(),this.recoveryTime=3,this.endSpeed=10,this.stage=p,this.stage.propertyWorked=!0,this.setPreSpeed(g),this.setStartCallback(f),this.stage.setSpeed(this.speed),this.sprintProperty=new r.Property(r.PROPERTYTYPE.GAME_DASH),console.log("--- SprintWorker onStart preSpeed:---",g),this.startCountDown(this.duration)},c.prototype.updateAdditionTime=function(){var p=this.duration;this.duration=o.G.propAddition.getAdditionDashTime(this.duration,o.G.Ap.state.mission.getType().toString()),i.default.e("\u51B2\u523A \u65F6\u95F4\u52A0\u6210\uFF1A"+p+"  => "+this.duration)},c.prototype.onStart=function(){for(var p=[],h=0;h<arguments.length;h++)p[h]=arguments[h];try{if(p&&p.length<=0)return;var f=p[0],g=p[1],_=p[2];this.init(f,g,_),o.G.Ap.state.startPropertyWork(this.sprintProperty),console.log("--- SprintWorker onStart args:---",p)}catch(y){console.log("--- SprintWorker onStart err:---",y)}},c.prototype.onStop=function(){for(var p=[],h=0;h<arguments.length;h++)p[h]=arguments[h];try{return console.log("--- SprintWorker onStop args:---",p),this.stage.propertyWorked=!1,void o.G.Ap.state.stopPropertyWork(this.sprintProperty)}catch(f){console.log("--- SprintWorker onStop err:---",f)}},c.prototype.onPause=function(){console.log("--- SprintWorker onPause---")},c.prototype.onResume=function(){console.log("--- SprintWorker onResume---")},c.prototype.onStateChanged=function(p){console.log("--- SprintWorker onStateChanged args:---",p),p.state===s.WorkerState.stopped&&this.recovery()},c.prototype.reset=function(){this.speed=0,this.preSpeed=0,this.endSpeed=0,this.duration=0,this.recoveryTime=0,this.obtained=!1,this.sprintProperty=null},c.prototype.recovery=function(){try{cc.sys.platform==cc.sys.QQ_PLAY?this.workForQQ():this.workForWechat(requestAnimationFrame,cancelAnimationFrame)}catch(p){this.stage.setSpeed(this.preSpeed)}},c.prototype.startCountDown=function(p){var h=this;p&&n.default.getInstance().scheduler.scheduleOnce(function(){h.startCallback()},p)},c.prototype.workForWechat=function(p,h){var f=this,g=this.endSpeed,_=0,y=0,S=59*this.recoveryTime;this.stage.setSpeed(g);var I=function(){var v=f.preSpeed,C=f.state;if(C!==s.WorkerState.pausing&&C!==s.WorkerState.paused){var T=e.mTween.quadEaseIn(_++,g,v,S);T=Math.min(T,v),_<=S?(f.stage.setSpeed(T),y&&h(y),y=p(I)):(f.stage.setSpeed(v),y&&h(y),f.reset())}};I()},c.prototype.workForQQ=function(){this.workForWechat(t.Type.getRaf(),t.Type.getCaf())},c.prototype.getSpeed=function(){return this.speed},c.prototype.getDuration=function(){return this.duration},c.prototype.setPreSpeed=function(p){p===void 0&&(p=0),this.preSpeed=p},c.prototype.setStartCallback=function(p){p&&(this.startCallback=p)},c}(d.WorkerBase);m.default=a,cc._RF.pop()},{"../../../base/G":"G","../../../property/PropertyDefines":"PropertyDefines","../../../util/runtime/ClassType":"ClassType","../../../util/runtime/Tween":"Tween","../../GameBus":"GameBus","../../workers/WorkerBase":"WorkerBase","../../workers/WorkerState":"WorkerState","./../../../base/Log":"Log"}],SpriteCacheLoader:[function(l,P,m){"use strict";cc._RF.push(P,"9fd21p8nVRMc5+xTtQnzR8t","SpriteCacheLoader"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./Md5"),s=function(){function r(){}return r.load=function(o,e,n){var t=this;if(n===void 0&&(n=null),o!=null)if(cc.sys.QQ_PLAY==cc.sys.platform)if(o.startsWith("http")){var i=r.getLocalPath(o);if(BK.FileUtil.isFileExist(i))return console.error("SpriteCacheLoader::local cache "+o),void this.initSpriteFromDisk(i,e,n);this.downloadHttpFile(o,function(a,u){a&&t.initSpriteFromDisk(u,e,n)})}else this.initSpriteFromDisk(o,e,n);else this.initSpriteFromDisk(o,e,n)},r.loadMultiImageAsyncForQQ=function(o,e){if(o!=null&&o.length!=0)for(var n=0,t=[],i=0;i<o.length;++i)console.log("[zhangfu]SpriteCacheLoader.loadMultiImageAsyncForQQ url index= "+i+",url = "+o[i]),this.loadImageAsyncForQQ(o[i],function(a,u){n++,u!=null&&u!==""&&t.push(u),n==o.length&&e(0<t.length,t)});else e&&e(!1,null)},r.loadImageAsyncForQQ=function(o,e){if(cc.sys.QQ_PLAY==cc.sys.platform)if(o.startsWith("GameSandBox://")||o.startsWith("GameRes://"))e(!0,o);else if(o.startsWith("http")){var n=r.getLocalPath(o);BK.FileUtil.isFileExist(n)?e(!0,n):this.downloadHttpFile(o,function(t,i){e(t,i)})}else e(!1,"");else e(!1,"")},r.initSpriteFromDisk=function(o,e,n){if(n===void 0&&(n=null),n){var t=document.createElement("canvas"),i=e.node.width,a=e.node.height;t.width=i,t.height=a;var u=t.getContext("2d",null);u.clearRect(0,0,t.width,t.height),u.imageSmoothingEnabled=!0,u.mozImageSmoothingEnabled=!0,u.drawImage(o,0,0,t.width,t.height),n(t)}cc.loader.load(o,function(c,p){!c&&p?e.spriteFrame=new cc.SpriteFrame(p):console.error("SpriteCacheLoader::load fail => "+o)})},r.downloadHttpFile=function(o,e){var n=new BK.HttpUtil(o);n.setHttpMethod("get"),n.requestAsync(function(t,i){if(t&&i==200){var a=r.getLocalPath(o);console.error("SpriteCacheLoader::http done "+o+" => "+a),BK.FileUtil.writeBufferToFile(a,t),e(!0,a)}else console.error("SpriteCacheLoader::http fail "+o),e(!1,null)})},r.getLocalPath=function(o){return"GameSandBox://temp/"+d.default.hashStr(o)+".png"},r}();m.default=s,cc._RF.pop()},{"./Md5":"Md5"}],SpriteFrameSet:[function(l,P,m){"use strict";cc._RF.push(P,"97019Q80jpE2Yfz4zbuCZBq","SpriteFrameSet");var d=cc.Class({name:"SpriteFrameSet",properties:{language:"",spriteFrame:cc.SpriteFrame}});P.exports=d,cc._RF.pop()},{}],StarCountSwitch:[function(l,P,m){"use strict";cc._RF.push(P,"de4bdkbhAJJMLvmd2hV6RJj","StarCountSwitch"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MUI/MUINode"),s=l("../base/G"),r=l("./GameBus"),o=l("./animation/action/MActionFactory"),e=l("./MUI/MUIFactory"),n=l("../util/ObjectPool"),t=l("../util/Utility"),i=function(){function h(f,g){var _=this;this.mBlockTouchEffectAnimationPool=null,this.mBlockEffectNode=null,this.mEffectCount=0,this.mBlockLongTouchEffectAnimationPool=null,this.mBlockLongEffectNode=null,this.mLongEffectCount=0,this.mIndex=0,this.mSkin=null,this.mBlockEffectNode=new d.default("mBlockEffectNode"),this.mBlockLongEffectNode=new d.default("mBlockEffectNode"),g.addChild(this.mBlockEffectNode),g.addChild(this.mBlockLongEffectNode),this.mSkin=f;var y=this.mSkin.getSkinObject();y&&(this.mEffectCount=y.skinRaw.getBlockEffectCount(),this.mLongEffectCount=y.skinRaw.getBlockEffectCount()),this.mBlockTouchEffectAnimationPool=new n.default(function(){var S=_.mSkin.getSkinObject();return S?S.skinRaw.createBlockEffectAction(S,o.default.instance,_.mIndex):null}),this.mBlockLongTouchEffectAnimationPool=new n.default(function(){var S=_.mSkin.getSkinObject();return S?S.skinRaw.createBlockLongEffectAction(S,o.default.instance,_.mIndex):null}),this.switch(0)}return h.prototype.switch=function(f){f>=this.mEffectCount||(this.mIndex=f,this.mBlockEffectNode.removeAllChildren(),this.mBlockTouchEffectAnimationPool.clear(),this.mBlockLongEffectNode.removeAllChildren(),this.mBlockLongTouchEffectAnimationPool.clear())},h.prototype.putAction=function(f,g){if(this.mEffectCount===0&&g!==t.Utility.BLOCKTYPE.LONG)return null;if(g===t.Utility.BLOCKTYPE.LONG){if(this.mLongEffectCount===0)return null;this.mBlockLongTouchEffectAnimationPool.put(f)}else this.mBlockTouchEffectAnimationPool.put(f)},h.prototype.getAction=function(f){return this.mEffectCount===0&&f!==t.Utility.BLOCKTYPE.LONG?null:f===t.Utility.BLOCKTYPE.LONG?this.mLongEffectCount===0?null:this.mBlockLongTouchEffectAnimationPool.get():this.mBlockTouchEffectAnimationPool.get()},h.prototype.getNode=function(f){if(this.mEffectCount===0&&f!==t.Utility.BLOCKTYPE.LONG||f===t.Utility.BLOCKTYPE.LONG&&this.mLongEffectCount===0)return null;for(var g,_=null,y=0,S=(g=f===t.Utility.BLOCKTYPE.LONG?this.mBlockLongEffectNode.getAllChildren():this.mBlockEffectNode.getAllChildren()).length;y<S;++y)if(!g[y].getVisible()){_=g[y];break}if(!_){var I=this.mSkin.getSkinObject();if(!I)return null;f===t.Utility.BLOCKTYPE.LONG?(_=I.skinRaw.createBlockLongEffectNode(I,e.default.instance,this.mIndex))&&this.mBlockLongEffectNode.addChild(_):(_=I.skinRaw.createBlockEffectNode(I,e.default.instance,this.mIndex))&&this.mBlockEffectNode.addChild(_)}return _},h}();m.BlockEffectSwitch=i;var a=function(){function h(f,g){this.mBgEffectNode=g,this.mSkin=f;var _=this.mSkin.getSkinObject();this.mEffectItems=_.skinRaw.createBackgroundEffects("game",_,e.default.instance,o.default.instance),this.switch(0)}return h.prototype.switch=function(f){if(!(s.G.Ap.config.debugNoBackgroundAnim||!this.mEffectItems||f>=this.mEffectItems.length)){this.mLastNode&&r.default.getInstance().animationMgr.stopTargetActions(this.mLastNode),this.mBgEffectNode.removeAllChildren();var g=this.mEffectItems[f];this.mBgEffectNode.addChild(g.node);for(var _=0,y=g.actions.length;_<y;++_)r.default.getInstance().animationMgr.runActionRepeat(g.node,g.actions[_]);this.mLastNode=g.node}},h}();m.BackgroundEffectSwitch=a;var u=function(){function h(f,g){this.mBgNode=g,this.mSkin=f;var _=this.mSkin.getSkinObject();this.mActions=_.skinRaw.createBackgroundLoopActions(_,o.default.instance),this.switch(0)}return h.prototype.switch=function(f){if(!s.G.Ap.config.debugNoBackgroundAnim&&this.mActions&&!(f>=this.mActions.length)){r.default.getInstance().animationMgr.stopTargetActions(this.mBgNode);var g=this.mActions[f];r.default.getInstance().animationMgr.runActionRepeat(this.mBgNode,g)}},h}();m.BackgroundLoopSwitch=u;var c=function(){function h(f,g){this.mBgNode=g,this.mSkin=f;var _=this.mSkin.getSkinObject();this.mActions=_.skinRaw.createBackgroundChangeActions(_,o.default.instance)}return h.prototype.switch=function(f){if(!s.G.Ap.config.debugNoBackgroundSwitch)switch(f){case 1:this.animationToNewBackground(0);break;case 2:this.animationToNewBackground(1)}},h.prototype.animationToNewBackground=function(f){if(this.mActions&&!(f>=this.mActions.length)){var g=this.mActions[f];r.default.getInstance().animationMgr.runAction(this.mBgNode,g)}},h}();m.BackgroundSwitch=c;var p=function(){function h(f,g,_,y){this.mSwitchList=[],this.mSwitchList.push(new c(f,g)),this.mSwitchList.push(new u(f,g)),this.mSwitchList.push(new a(f,_)),this.mBlockEffectSwitch=new i(f,y),this.mSwitchList.push(this.mBlockEffectSwitch)}return h.prototype.changeStarCount=function(f){for(var g=0,_=this.mSwitchList;g<_.length;g++)_[g].switch(f)},h.prototype.getCurrentBlockEffect=function(){return this.mBlockEffectSwitch},h}();m.default=p,cc._RF.pop()},{"../base/G":"G","../util/ObjectPool":"ObjectPool","../util/Utility":"Utility","./GameBus":"GameBus","./MUI/MUIFactory":"MUIFactory","./MUI/MUINode":"MUINode","./animation/action/MActionFactory":"MActionFactory"}],StartBlockNode:[function(l,P,m){"use strict";cc._RF.push(P,"51011TBH1pNTZrwFmq2YYtM","StartBlockNode"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../loader/BlockSkinFrameLoader"),s=l("./BlockNode"),r=l("../../MUI/MUISprite"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.createLayers=function(){this.setPosition(this.mBlock.rect.x,this.mBlock.rect.y),this.setContentSize(this.mBlock.rect.width,this.mBlock.rect.height);var t=d.default.getInstance().getStartBlockBackground();this.imageItem=t,this.imageData=d.default.getInstance().getAtlas();var i=d.default.getInstance().getStartLabel(),a=this.mBlock.rect.width/i.rect.width,u=this.mBlock.rect.width,c=i.rect.height*a,p=new r.default;p.imageData=d.default.getInstance().getAtlas(),p.imageItem=i,p.move(0,(this.mBlock.rect.height-c)/2,u,c),this.addChild(p)},n.prototype.updateTouchState=function(t){this.opacity=t?.2:1},n}(s.default);m.default=o,cc._RF.pop()},{"../../MUI/MUISprite":"MUISprite","../loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./BlockNode":"BlockNode"}],Startup:[function(l,P,m){"use strict";cc._RF.push(P,"11cc89hIIlCGIZvuisyW/IS","Startup"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.isColdStart=!0,s.enterTimeStamp=0,s.hasReportTimecost=!1,s}();m.default=d,cc._RF.pop()},{}],State:[function(l,P,m){"use strict";cc._RF.push(P,"62e23QbdBxGQK8gg9C+nS1j","State"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("../util/Utility"),o=l("../business/Logic/BattleSettlement"),e=l("../business/Logic/ChestManager"),n=l("./G"),t=l("../anticheat/AntiCheatProbe"),i=l("../util/Dictionary"),a=l("../property/PropertyDefines");(s=d=m.MISSIONTYPE||(m.MISSIONTYPE={}))[s.None=0]="None",s[s.Normal=1]="Normal",s[s.TrySkin=2]="TrySkin",s[s.TrySong=3]="TrySong",s[s.Rank=4]="Rank",s[s.ExclusiveSkin=5]="ExclusiveSkin",s[s.Battle=6]="Battle",s[s.BattleFriend=7]="BattleFriend",s[s.BattleWorldChat=8]="BattleWorldChat",s[s.TryPiano=9]="TryPiano";var u=function(){this.originCount=0,this.count=0};m.State_PropertyItem=u;var c=function(){this.tempory=!1,this.accumulation=!1};m.State_PropertyWork=c;var p=function(){function E(A,M,k){this.levelId=0,this.musicId=0,this.pass=!1,this.trial=!1,this.trialSong=!1,this.tryPiano=!1,this.levelId=A,this.musicId=M,this.pass=k}return E.prototype.reset=function(){this.musicId=0,this.pass=!1,this.trial=!1,this.trialSong=!1,this.tryPiano=!1},E.prototype.getType=function(){return d.Normal},E.prototype.isBattle=function(){return!0},E}(),h=function(E){function A(M,k,D){return E.call(this,M,k,D)||this}return __extends(A,E),A.prototype.getType=function(){return d.Normal},A}(m.Mission=p);m.NormalMission=h;var f=function(E){function A(M,k,D){var L=E.call(this,M,k,D)||this;return L.trial=!0,L}return __extends(A,E),A.prototype.getType=function(){return d.TrySkin},A.prototype.isBattle=function(){return!1},A}(p);m.TrySkinMission=f;var g=function(E){function A(M,k,D){var L=E.call(this,M,k,D)||this;return L.trialSong=!0,L}return __extends(A,E),A.prototype.getType=function(){return d.TrySong},A.prototype.isBattle=function(){return!1},A}(p);m.TrySongMission=g;var _=function(E){function A(M,k,D){var L=E.call(this,M,k,D)||this;return L.tryPiano=!0,L}return __extends(A,E),A.prototype.getType=function(){return d.TryPiano},A.prototype.isBattle=function(){return!1},A}(p);m.TryPianoMission=_;var y=function(E){function A(M,k,D){var L=E.call(this,0,0,!1)||this;return L.reset(),L.musicId=M,L.musicName=k,L.musicDisplayName=D,L}return __extends(A,E),A.prototype.getType=function(){return d.Rank},A.prototype.reset=function(){E.prototype.reset.call(this),this.musicId=0,this.musicName="",this.musicDisplayName="",this.todayScore=0,this.honors=[]},A.prototype.isBattle=function(){return!1},A}(p);m.RankMission=y;var S=function(E){function A(M,k){return E.call(this,M,k,!1)||this}return __extends(A,E),A.prototype.getType=function(){return d.ExclusiveSkin},A}(p);m.ExclusiveSkinMission=S;var I=function(E){function A(M){var k=E.call(this,0,M,!1)||this;return k.startSpeed=0,k.endSpeed=0,k.baseBeats=0,k.increasePecentage=0,k.deductPercentage=0,k.beginningCountDown=3,k.playingCountDown=180,k}return __extends(A,E),A.prototype.getType=function(){return d.Battle},A.prototype.isBattle=function(){return!1},A.prototype.reset=function(){E.prototype.reset.call(this)},A}(p),v=function(E){function A(){return E!==null&&E.apply(this,arguments)||this}return __extends(A,E),A.prototype.getType=function(){return d.BattleFriend},A}(m.BattleMission=I);m.BattleFriendMission=v;var C=function(E){function A(){return E!==null&&E.apply(this,arguments)||this}return __extends(A,E),A.prototype.getType=function(){return d.BattleWorldChat},A}(I);m.WorldChatBattleMission=C;var T=function(){function E(){this.running=!1,this.attainScore=0,this.attainCrowns=0,this.attainStars=0,this.attainMoney=0,this.attainGifts=[],this.perfectScore=0,this.dropScore=0,this.reliveTime=0,this.gameTime=0,this.gameStage=r.Utility.GAMESTAGE.NONE,this.mBattleSettlement=new o.default,this.carryProperties=new i.Dictionary2(a.Property.compare),this.temporyProperties=new i.Dictionary2(a.Property.compare),this.workingProperties=new i.Dictionary2(a.Property.compare)}return E.prototype.reset=function(A){A===void 0&&(A=!0),A&&this.mission&&this.mission.reset(),this.running=!1,this.attainScore=0,this.attainCrowns=0,this.attainStars=0,this.attainMoney=0,this.attainGifts=[],this.perfectScore=0,this.dropScore=0,this.reliveTime=0,this.gameTime=0,this.gameStage=r.Utility.GAMESTAGE.NONE,this.carryProperties.clear(),this.temporyProperties.clear(),this.workingProperties.clear()},E.prototype.pause=function(){this.running=!1},E.prototype.resume=function(){this.running=!0},E.prototype.isPaused=function(){return!this.running},E.prototype.gameStart=function(){var A=this.getMission(),M=n.G.Ap.antiCheat;if(A){var k=A.getType();A.isBattle()?(this.mBattleSettlement.giveBattle(this.mission.levelId,0,0),e.default.getInstance().preLoad(this.mission.levelId,this.perfectScore),M.begin()):k===d.Rank&&M.begin(),CMPlay.GameState.onGameStart()}},E.prototype.gameOver=function(){var A=this.getMission(),M=n.G.Ap.antiCheat,k=M.getStatus(),D=n.G.Ap.performanceCounter;if(A){var L=A.getType();A.isBattle()?this.mBattleSettlement.battleOver():L===d.Rank&&M.setSkipReset(!0),k===t.STATUS.Begin&&M.end(),this.disposeProperty(),D.reset(),CMPlay.GameState.onGameStop()}},E.prototype.addScore=function(A){this.attainScore+=A,this.mBattleSettlement.setScore(this.attainScore)},E.prototype.addStar=function(){this.attainStars++,this.mBattleSettlement.setStar(this.attainStars),this.attainStars==3&&this.mission&&0<=this.mission.levelId&&CMPlay.GameState.onGameLevelPass(this.mission.levelId)},E.prototype.addCrown=function(){this.attainCrowns++,this.mBattleSettlement.setCrown(this.attainCrowns)},E.prototype.addMoney=function(){return this.attainMoney++,this.mBattleSettlement.setGainedGold(this.attainMoney),this.attainMoney},E.prototype.addGift=function(A){return this.attainGifts.push(A),this.attainGifts.length},E.prototype.getMoney=function(){return this.attainMoney},E.prototype.enterGameStage=function(A){this.gameStage=A},E.prototype.getGameStage=function(){return this.gameStage},E.prototype.addReliveTimes=function(){this.reliveTime++,this.mBattleSettlement.addReliveTimes(this.reliveTime)},E.prototype.getReliveTimes=function(){return this.reliveTime},E.prototype.addGameTime=function(A){this.gameTime=A,this.mBattleSettlement.addGameTime(this.gameTime)},E.prototype.getGameTime=function(){return this.gameTime},E.prototype.getMission=function(){return this.mission},E.prototype.addCarryProperty=function(A,M){M===void 0&&(M=0);var k=this.carryProperties.get(A);k===null&&((k=new u).count=0,k.originCount=0,this.carryProperties.put(A.clone(),k)),k.count+=M,k.originCount+=M},E.prototype.getCarryPropertyCount=function(A){var M=this.carryProperties.get(A);return M===null?0:M.count},E.prototype.removeCarryProperty=function(A){this.carryProperties.remove(A)},E.prototype.removeAllCarryProperty=function(){this.carryProperties.clear()},E.prototype.resumeCarryProperty=function(A){var M=this.carryProperties.get(A);return!(M===null||M.count<=0)&&(M.count--,!0)},E.prototype.getCarryProperties=function(){for(var A=[],M=this.carryProperties.getPairs(),k=0,D=M.length;k<D;++k){var L=M[k].key;A.push(L.clone())}return A},E.prototype.addTemporyProperty=function(A,M){M===void 0&&(M=0);var k=this.temporyProperties.get(A);k===null&&((k=new u).count=0,this.temporyProperties.put(A.clone(),k)),k.count+=M},E.prototype.resumeTemporyProperty=function(A){var M=this.temporyProperties.get(A);return!(M===null||M.count<=0)&&(M.count--,!0)},E.prototype.isPropertyWorking=function(A){return this.temporyProperties.get(A)!==null},E.prototype.startPropertyWork=function(A,M){M===void 0&&(M=!1);var k=this.workingProperties.get(a.Property);k==null?((k=new c).tempory=M,this.workingProperties.put(A.clone(),k)):console.warn("property working, type is "+A.type)},E.prototype.accumulatePropertyWork=function(A){var M=this.workingProperties.get(a.Property);M!==null?M.accumulation=!0:console.warn("property is not working, type is "+A.type)},E.prototype.stopPropertyWork=function(A){this.workingProperties.remove(A)},E.prototype.disposeProperty=function(){if(this.carryProperties.size()!==0){for(var A=!1,M=this.carryProperties.getPairs(),k=0,D=M.length;k<D;++k){var L=M[k].value,b=M[k].key,N=Math.max(L.originCount-L.count,0);0<N&&(n.G.Ap.propertyPack.getPlayProperty().decreaseProperty(b,N),A=!0)}A&&n.G.Ap.propertyPack.save()}},E.HONORS=[1,2,3,4,6,9],E}();m.default=T,cc._RF.pop()},{"../anticheat/AntiCheatProbe":"AntiCheatProbe","../business/Logic/BattleSettlement":"BattleSettlement","../business/Logic/ChestManager":"ChestManager","../property/PropertyDefines":"PropertyDefines","../util/Dictionary":"Dictionary","../util/Utility":"Utility","./G":"G"}],StorageUtil:[function(l,P,m){"use strict";cc._RF.push(P,"878c1XhHhtMjZeV4VMLYUDl","StorageUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Log"),s=l("../../../config/LSKey"),r=l("../../../util/StringUtil"),o=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=l("../../../base/PullDataStatus"),n=l("./MemCache"),t=l("../../../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance"),i=function(){function a(){}return a.save=function(u,c){try{c+="",0<=s.default.KEYS_NEED_SYNC.indexOf(u)&&(a._isDataChanged=!0,this.sObj[u]=c),n.MemCache.Ins().save(u,c)}catch(p){d.default.e("save",p)}},a.read=function(u,c){c===void 0&&(c=null);try{var p=n.MemCache.Ins().read(u,c);return r.StringUtil.isNullOrUndefined(p)?c:p}catch(h){return d.default.e("read",h),c}},a.remove=function(u){try{n.MemCache.Ins().remove(u),a.sObj&&u in a.sObj&&delete a.sObj[u]}catch(c){d.default.e("removeFromCache error",u,c)}},a.isNeedPush=function(){return a.read(s.default.NEED_REPUSH)=="repush"},a.pushAsync=function(u,c){if(e.PullDataStatus.isPullDataSuccess){var p=a.isNeedPush();if(d.default.l("\u63A8\u9001\u6570\u636E\u5230\u4E91\u7AEF _isPushing="+a._isPushing+"  isNeedPush="+p+" _isDataChanged="+a._isDataChanged),a._isPushing||!a._isDataChanged&&!p)c&&c();else{a._isPushing=!0,a._isDataChanged=!1;var h=a.read(s.default.STORAGE_VERSION);r.StringUtil.isEmpty(h)&&(h="0");var f=parseInt(h);f++,a.save(s.default.STORAGE_VERSION,f+"");for(var g=new Object,_=0;_<s.default.KEYS_NEED_SYNC.length;_++){var y=s.default.KEYS_NEED_SYNC[_],S=a.read(y);g[y]=S,a.sObj&&y in a.sObj&&(g[y]=a.sObj[y],delete a.sObj[y])}o.MGUser.getUserBasicInfo({complete:function(I){var v="";I&&(v=I.nickName),r.StringUtil.isEmpty(v)||(v=v.replace('"',"&quot;").replace("'","&apos;")),g.nickname=v;var C=g;t.MGCloudStorage.setStorage({kvDatas:C,complete:function(T){d.default.l("push to net, success="+T,g),a._isPushing=!1,a._isDataChanged||!T?a.save(s.default.NEED_REPUSH,"repush"):a.remove(s.default.NEED_REPUSH),T?u&&u():c&&c()}})}})}}else d.default.w("\u4E0B\u62C9\u6570\u636E\u5931\u8D25\uFF0C\u4E0D\u5141\u8BB8\u63A8\u9001\u3002")},a.readFromNet=function(u,c,p){u&&u.length!=0?t.MGCloudStorage.getStorage({keys:u,success:function(h){c&&c(h)},fail:function(){p&&p()}}):p&&p()},a.sObj=new Object,a._isPushing=!1,a._isDataChanged=!0,a}();m.default=i,cc._RF.pop()},{"../../../../modules/MGCloudStorage/scripts/Logic/MGCloudStorageEntrance":"MGCloudStorageEntrance","../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../base/Log":"Log","../../../base/PullDataStatus":"PullDataStatus","../../../config/LSKey":"LSKey","../../../util/StringUtil":"StringUtil","./MemCache":"MemCache"}],StringUtil:[function(l,P,m){"use strict";var d;cc._RF.push(P,"6ae34c1j4JEtYXfaiwoTaDW","StringUtil"),Object.defineProperty(m,"__esModule",{value:!0}),(d=m.StringUtil||(m.StringUtil={})).isNullOrUndefined=function(s){return s==null||s==null},d.isEmpty=function(s){return s==null||s==null||s.length==0},d.replaceAll=function(s,r,o){return d.isNullOrUndefined(s)||d.isEmpty(r)?s:s.replace(new RegExp(r,"g"),o)},d.replaceEmoji=function(s,r){return r===void 0&&(r=""),d.isNullOrUndefined(s)?s:s.replace(new RegExp("(?:[\u2700-\u27BF]|(?:\uD83C[\uDDE6-\uDDFF]){2}|[\uD800-\uDBFF][\uDC00-\uDFFF]|[#-9]\uFE0F?\u20E3|\u3299|\u3297|\u303D|\u3030|\u24C2|\uD83C[\uDD70-\uDD71]|\uD83C[\uDD7E-\uDD7F]|\uD83C\uDD8E|\uD83C[\uDD91-\uDD9A]|\uD83C[\uDDE6-\uDDFF]|[\uD83C\uDE01-\uDE02]|\uD83C\uDE1A|\uD83C\uDE2F|[\uD83C\uDE32-\uDE3A]|[\uD83C\uDE50-\uDE51]|\u203C|\u2049|[\u25AA-\u25AB]|\u25B6|\u25C0|[\u25FB-\u25FE]|\xA9|\xAE|\u2122|\u2139|\uD83C\uDC04|[\u2600-\u26FF]|\u2B05|\u2B06|\u2B07|\u2B1B|\u2B1C|\u2B50|\u2B55|\u231A|\u231B|\u2328|\u23CF|[\u23E9-\u23F3]|[\u23F8-\u23FA]|\uD83C\uDCCF|\u2934|\u2935|[\u2190-\u21FF])*","g"),r)},d.getFixedlengthStr=function(s,r){if(s==null||s==null)return s;for(var o=0,e=s.length,n=0,t=0,i=0;i<e;i++){n++;var a=s.charCodeAt(i);if(0<=a&&a<=127?(o++,t=0):(o+=2,t=1),r<o)break}return r<o?t==1?s.substring(0,n-2)+"...":s.substring(0,n-3)+"...":s},d.getQueryString=function(s,r){var o=s.indexOf("?");o<0&&(o=0);var e=s.substr(o+1).split("&"),n="";if(!e)return n;for(var t=0,i=e;t<i.length;t++){var a=i[t].split("=");if(a&&a.length==2&&unescape(a[0])===r){n=unescape(a[1]);break}}return n},d.format=function(s){for(var r,o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];return(r=cc.js).formatStr.apply(r,[s].concat(o))},cc._RF.pop()},{}],SubscriptionUtils:[function(l,P,m){"use strict";cc._RF.push(P,"cfdf3FeKHtAgK4VfsrJDbJ7","SubscriptionUtils"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./util/PU"),s=function(){function r(){}return r.followSubscription=function(){if(d.default.isQQ())BK.QQ.enterPubAccountCard(r.QQ_PUIN);else if(d.default.isWeiXin()&&wx.openCustomerServiceConversation){var o={sessionFrom:"follow_icon",showMessageCard:!1,complete:function(){console.log(" customerParam is opened ")}};wx.openCustomerServiceConversation(o)}r.isOpenFromDialog=!0},r.checkPubState=function(o){d.default.isQQ()&&BK.QQ.checkPubAccountState(r.QQ_PUIN,function(e,n,t){console.log(" callback errCode = "+e+" cmd = "+n+" data = "+JSON.stringify(t)),t.is_follow==1?(r.isOpenFromDialog=!1,o&&o(!0)):o&&o(!1)}),o&&o(!1)},r.QQ_PUIN="1751365861",r.isOpenFromDialog=!1,r.REWARD_DIAMOND=10,r.REWARD_COIN=100,r.REWARD_SKIN="\u661F\u7A7A\u73AF\u6E38",r.REWARD_DIAMOND_SGIN=5,r}();m.SubscriptionUtils=s,cc._RF.pop()},{"./util/PU":"PU"}],SwitchWorker:[function(l,P,m){"use strict";cc._RF.push(P,"4c7416JcCJK1rWxJRVrHO2H","SwitchWorker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../gamescene/workers/WorkerBase"),s=l("../LotteryRoll"),r=l("../LotteryVM"),o=l("../LotteryEnum"),e=l("../../Logic/GameItemsManager"),n=l("../../../util/SceneMusicMgr"),t=l("../../looper/Looper"),i=function(a){function u(){var c=a.call(this,"SwitchWorker")||this;return c.lotteryHandler=null,c.itemNodes=[],c.roll=null,c.prizeData=null,c.adBackStatus=null,c.looper=null,c.audioId=null,c.MIN_ROLLING_SPEED=70,c}return __extends(u,a),u.prototype.init=function(c,p,h){this.lotteryHandler=c,this.roll=new s.LotteryRoll,this.itemNodes=p,this.adBackStatus=h,this.adBackStatus===o.AD_STATUS.SKIP_AD?this.prizeData=this.getPrizeVMForAd():this.prizeData=this.getPrizeVM()},u.prototype.onStart=function(){for(var c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];try{if(c&&c.length<=0)return;var h=c[0],f=c[1],g=c[2];this.init(h,f,g),this.removeActiveItem(),this.startRool()}catch(_){console.log("--- SwitchWorker onStart err:---",_)}},u.prototype.onStop=function(){for(var c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];try{return this.stopLooper(),void this.reset()}catch(h){console.log("--- SwitchWorker onStop err:---",h)}},u.prototype.onStateChanged=function(c){},u.prototype.getPrizeVM=function(){var c=this.lotteryHandler.getLotteryVMList();if(c){var p=-1,h=new r.LotteryVM,f=Math.ceil(1e4*Math.random())||0;console.log("--- getPrizeVM random ---",f);for(var g=0,_=c;g<_.length;g++){var y=_[g];p++;var S=y.getChanceMin()||0,I=y.getChanceMax()||99;if(S<=f&&f<=I){(h=y).setIndex(p);break}}return h}},u.prototype.getPrizeVMForAd=function(){var c=Math.ceil(1e4*Math.random())||0,p=new r.LotteryVM,h=this.lotteryHandler.getLotteryVMList(),f=[],g=0,_=[],y=[];if(h){for(var S=0,I=h;S<I.length;S++){var v=k=I[S],C=v.getId(),T=e.GameItemsManager.getIns().isDiamondsType(C),E=e.GameItemsManager.getIns().isGoldType(C);T?(v.setIndex(g),v.setChanceMin(0),v.setChanceMax(5e3),_.push(v)):E&&(v.setIndex(g),v.setChanceMin(5001),v.setChanceMax(1e4),y.push(v)),g++}_.sort(function(b,N){return b.getCount()-N.getCount()}),y.sort(function(b,N){return b.getCount()-N.getCount()}),f.push(_[0]),f.push(y[0]);for(var A=0,M=f;A<M.length;A++){var k,D=(k=M[A]).getChanceMin()||0,L=k.getChanceMax()||99;if(D<=c&&c<=L){p=k;break}}return p}},u.prototype.startRool=function(){try{this.looper=new t.default,this.looper.setWork(this.doRoll.bind(this)),this.looper.start(0)}catch(c){console.log("--- startRool err---",c)}},u.prototype.doRoll=function(){try{var c=this.roll;if(!c)return;if(c.times++,c.times>c.cycle+10&&c.prize===c.index)return c.prize=-1,c.times=0,void this.stopRoll();if(c.times<c.cycle)c.speed-=10;else if(c.times===c.cycle){var p=this.prizeData&&this.prizeData.getIndex()?this.prizeData.getIndex():0;c.prize=p}else c.times>c.cycle+10&&(c.prize===0&&c.index===7||c.prize===c.index+1)?c.speed+=110:c.speed+=20;c.speed=c.speed<this.MIN_ROLLING_SPEED?this.MIN_ROLLING_SPEED:c.speed,c.speed&&this.looper.setInterval(c.speed/1e3),c.start(this.itemNodes),this.playAudio()}catch(h){console.log("--- doRoll err ---",h)}},u.prototype.stopRoll=function(){console.log("--- stopRoll ---");try{this.looper.stop(),this.lotteryHandler.rollingEndCallback(this.prizeData),this.lotteryHandler.stopSwitchWorker()}catch(c){console.log("--- stopRoll err:---",c)}},u.prototype.stopLooper=function(){this.looper&&this.looper.stop()},u.prototype.removeActiveItem=function(){if(this.itemNodes)for(var c=0,p=this.itemNodes;c<p.length;c++){var h=p[c].getChildByName("active");h.active&&(h.active=!h.active)}},u.prototype.playAudio=function(){this.audioId=cc.audioEngine.play(cc.url.raw(n.default.PATH_LOTTERY_ROLLING_MOVE),!1,1)},u.prototype.stopAudio=function(){this.audioId&&cc.audioEngine.stop(this.audioId)},u.prototype.reset=function(){this.itemNodes=null,this.roll=null,this.prizeData=null,this.adBackStatus=null,this.looper=null},u.prototype.onPause=function(){console.log("--- SwitchWorker onPause---")},u.prototype.onResume=function(){console.log("--- SwitchWorker onResume---")},u}(d.WorkerBase);m.default=i,cc._RF.pop()},{"../../../gamescene/workers/WorkerBase":"WorkerBase","../../../util/SceneMusicMgr":"SceneMusicMgr","../../Logic/GameItemsManager":"GameItemsManager","../../looper/Looper":"Looper","../LotteryEnum":"LotteryEnum","../LotteryRoll":"LotteryRoll","../LotteryVM":"LotteryVM"}],SystemInfo:[function(l,P,m){"use strict";cc._RF.push(P,"9c4f6n8dM9Is5nRiSYkMhRU","SystemInfo"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){};m.SystemInfo=d,cc._RF.pop()},{}],TaskFactory:[function(l,P,m){"use strict";cc._RF.push(P,"0dc2dUZEkhIAa94rgqIZVIP","TaskFactory"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../TaskItem"),s=l("./FirstSongTask"),r=l("./LevelThreeTask"),o=l("./AttendChallengeTask"),e=l("./GameShareTask"),n=l("./UnlockHotSongTask"),t=function(){function i(){}return i.createTask=function(a){switch(a){case d.TaskID.TASK_ID_LITTLE_STAR:return new s.default(a);case d.TaskID.TASK_ID_LEVEL_THREE:return new r.default(a);case d.TaskID.TASK_ID_ATTEND_CHALLENGE:return new o.default(a);case d.TaskID.TASK_ID_GAME_SHARE:return new e.default(a);case d.TaskID.TASK_ID_UNLOCK_HOT_SONG:return new n.default(a)}return null},i}();m.default=t,cc._RF.pop()},{"../TaskItem":"TaskItem","./AttendChallengeTask":"AttendChallengeTask","./FirstSongTask":"FirstSongTask","./GameShareTask":"GameShareTask","./LevelThreeTask":"LevelThreeTask","./UnlockHotSongTask":"UnlockHotSongTask"}],TaskItemImpl:[function(l,P,m){"use strict";cc._RF.push(P,"3715aTLrqtBsZay8WJcBNBh","TaskItemImpl"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o){var e=s.call(this)||this;return e.id=o,e}return __extends(r,s),r.prototype.update=function(){},r}(l("../TaskItem").TaskItem);m.default=d,cc._RF.pop()},{"../TaskItem":"TaskItem"}],TaskItem:[function(l,P,m){"use strict";var d,s,r;cc._RF.push(P,"6ceb5c1Iw1MvZnz4ptadJW+","TaskItem"),Object.defineProperty(m,"__esModule",{value:!0}),(d=m.TaskID||(m.TaskID={}))[d.TASK_ID_LITTLE_STAR=1]="TASK_ID_LITTLE_STAR",d[d.TASK_ID_LEVEL_THREE=2]="TASK_ID_LEVEL_THREE",d[d.TASK_ID_ATTEND_CHALLENGE=3]="TASK_ID_ATTEND_CHALLENGE",d[d.TASK_ID_GAME_SHARE=4]="TASK_ID_GAME_SHARE",d[d.TASK_ID_UNLOCK_HOT_SONG=5]="TASK_ID_UNLOCK_HOT_SONG",(s=m.TaskStatus||(m.TaskStatus={}))[s.TASK_STATUS_NONE=0]="TASK_STATUS_NONE",s[s.TASK_STATUS_DOING=1]="TASK_STATUS_DOING",s[s.TASK_STATUS_SUCCESS=2]="TASK_STATUS_SUCCESS",s[s.TASK_STATUS_FAILED=3]="TASK_STATUS_FAILED",(r=m.TaskRewardType||(m.TaskRewardType={}))[r.TASK_REWARD_NONE=0]="TASK_REWARD_NONE",r[r.TASK_REWARD_ENERGY=3]="TASK_REWARD_ENERGY",r[r.TASK_REWARD_GOLD=4]="TASK_REWARD_GOLD",r[r.TASK_REWARD_DIAMOND=5]="TASK_REWARD_DIAMOND";var o=function(){};m.TaskItem=o,cc._RF.pop()},{}],TaskListManager:[function(l,P,m){"use strict";cc._RF.push(P,"3771fDW4XdBp5m9cRzqYQXH","TaskListManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TaskItem"),s=l("../DB/DBMgr"),r=l("./taskimpl/TaskFactory"),o=l("./TaskRewardStorage"),e=function(){function n(){this.mTaskRewardStorage=new o.default,this.mTaskList=[]}return n.prototype.loadConfigData=function(t){var i=this;this.mTaskList.length===0?s.default.Ins().loadDb(s.eDataBase.eDB_PlayerTask).then(function(){var a=s.default.Ins().getDBRows(s.eDataBase.eDB_PlayerTask);a?(i.parseConfig(a),i.mTaskRewardStorage.load(),i.updateTaskData(),t(!0)):t&&t(!1)}):(this.updateTaskData(),t(!0))},n.prototype.parseConfig=function(t){for(var i=0,a=t;i<a.length;i++){var u=a[i],c=r.default.createTask(u.getID());if(c){switch(c.name=u.getName(),c.currentStep=0,c.totalStep=u.getStep(),c.rewardType=u.getRewardType(),c.rewardType){case d.TaskRewardType.TASK_REWARD_ENERGY:c.rewardValue=u.getRewardEnergy();break;case d.TaskRewardType.TASK_REWARD_GOLD:c.rewardValue=u.getRewardGold();break;case d.TaskRewardType.TASK_REWARD_DIAMOND:c.rewardValue=u.getRewardDiamond()}c.rewardTaken=!1,c.status=d.TaskStatus.TASK_STATUS_NONE,this.mTaskList.push(c)}else console.error("task config item error, id="+u.getID())}},n.prototype.updateTaskData=function(){for(var t=0,i=this.mTaskList;t<i.length;t++){var a=i[t];this.mTaskRewardStorage.isTaskRewardTaken(a.id)?(a.rewardTaken=!0,a.currentStep=a.totalStep,a.status=d.TaskStatus.TASK_STATUS_SUCCESS):a.update()}},n.prototype.getTaskList=function(){return this.mTaskList},n.prototype.getTaskItem=function(t){for(var i=0,a=this.mTaskList;i<a.length;i++){var u=a[i];if(u.id===t)return u}return null},n.prototype.updateTaskStatus=function(t){for(var i=0,a=this.mTaskList;i<a.length;i++){var u=a[i];if(u.id===t)return u.update(),!0}return!1},n.prototype.setTaskRewardTaken=function(t,i){for(var a=0,u=this.mTaskList;a<u.length;a++){var c=u[a];if(c.id===t)return(!i||c.status===d.TaskStatus.TASK_STATUS_SUCCESS&&!c.rewardTaken)&&(c.rewardTaken=i,this.mTaskRewardStorage.setTaskRewardTaken(t,i),!0)}return!1},n}();m.default=e,cc._RF.pop()},{"../DB/DBMgr":"DBMgr","./TaskItem":"TaskItem","./TaskRewardStorage":"TaskRewardStorage","./taskimpl/TaskFactory":"TaskFactory"}],TaskRewardStorage:[function(l,P,m){"use strict";cc._RF.push(P,"5c5d2xA3nZIQJaw3XWSPTJe","TaskRewardStorage"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Network/Protocol/StorageUtil"),s=l("../../config/LSKey"),r=function(){function o(){this.mRewardIdSet=new Set}return o.prototype.load=function(){var e=d.default.read(s.default.PLAYER_TASK_REWARD_TAKEN,"");if(e){var n=e.split("@");if(n&&0<n.length)for(var t=0,i=n;t<i.length;t++){var a=i[t],u=parseInt(a);u&&!Number.isNaN(u)&&this.mRewardIdSet.add(u)}}},o.prototype.save=function(){var e="";this.mRewardIdSet.forEach(function(n){var t=n.toString();e+=t,e+="@"}),0<e.length&&(e=e.substring(0,e.length-1)),d.default.save(s.default.PLAYER_TASK_REWARD_TAKEN,e)},o.prototype.setTaskRewardTaken=function(e,n){n?this.mRewardIdSet.add(e):this.mRewardIdSet.delete(e),this.save(),d.default.pushAsync()},o.prototype.isTaskRewardTaken=function(e){return this.mRewardIdSet.has(e)},o}();m.default=r,cc._RF.pop()},{"../../config/LSKey":"LSKey","../Network/Protocol/StorageUtil":"StorageUtil"}],TaskSystem:[function(l,P,m){"use strict";cc._RF.push(P,"45d3dpcS7dGsp1Aue9FYB79","TaskSystem"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TaskListManager"),s=l("../Network/Protocol/StorageUtil"),r=l("../../config/LSKey"),o=l("../Logic/PlayerMgr"),e=function(){function n(){this.mNeedShowEntry=void 0,this.mTaskListManager=new d.default}return n.Ins=function(){return n.sInstance||(n.sInstance=new n),n.sInstance},n.prototype.isNeedShowTaskSystemEntry=function(){return!1},n.prototype.checkTaskEntryCondition=function(){if(this.mNeedShowEntry===void 0){var t=this.isNewUser();t?this.setNeedShowTaskEntry(t):this.isNeedShowTaskEntry()&&(this.mNeedShowEntry=!0)}},n.prototype.isNewUser=function(){var t=o.default.Ins();return t.getUserLevel()===1&&t.getUserCurrentExp()===0},n.prototype.isNeedShowTaskEntry=function(){return s.default.read(r.default.SHOW_PLAYER_TASK_ENTRY,"false")==="true"},n.prototype.setNeedShowTaskEntry=function(t){t&&!this.mNeedShowEntry?(s.default.save(r.default.SHOW_PLAYER_TASK_ENTRY,"true"),this.mNeedShowEntry=!0):!t&&this.mNeedShowEntry&&(s.default.save(r.default.SHOW_PLAYER_TASK_ENTRY,"false"),this.mNeedShowEntry=!1)},n.prototype.loadData=function(t){this.mTaskListManager.loadConfigData(t)},n.prototype.updateData=function(){this.mTaskListManager.updateTaskData()},n.prototype.getTaskList=function(){return Object.freeze(this.mTaskListManager.getTaskList())},n.prototype.getTaskItem=function(t){return this.mTaskListManager.getTaskItem(t)},n.prototype.getTaskDetail=function(t){return Object.seal(this.getTaskItem(t))},n.prototype.updateTaskStatus=function(t){return this.mTaskListManager.updateTaskStatus(t)},n.prototype.setRewardTaken=function(t,i){i===void 0&&(i=!0);var a=this.mTaskListManager.setTaskRewardTaken(t,i);return a&&this.isAllTaskRewardTaken()&&this.setNeedShowTaskEntry(!1),a},n.prototype.isAllTaskRewardTaken=function(){for(var t=0,i=this.mTaskListManager.getTaskList();t<i.length;t++)if(!i[t].rewardTaken)return!1;return!0},n.sInstance=null,n}();m.default=e,cc._RF.pop()},{"../../config/LSKey":"LSKey","../Logic/PlayerMgr":"PlayerMgr","../Network/Protocol/StorageUtil":"StorageUtil","./TaskListManager":"TaskListManager"}],TimeUtil:[function(l,P,m){"use strict";cc._RF.push(P,"8baf3Mse0dPnLjGO8b5U7ng","TimeUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../base/Log"),s=function(){function r(){}return r.getDate=function(o){return new Date(o).getDate()},r.getHours=function(o){return new Date(o).getHours()},r.getChatTime=function(o,e){e===void 0&&(e=!0);var n=new Date(o);if(e)return((t=n.getHours())<10?"0"+t:t+"")+":"+((i=n.getMinutes())<10?"0"+i:i+"");var t,i,a=n.getMonth()+1,u=a<10?"0"+a:a+"",c=n.getDate();return u+"\u6708"+(c<10?"0"+c:c+"")+"\u65E5 "+((t=n.getHours())<10?"0"+t:t+"")+":"+((i=n.getMinutes())<10?"0"+i:i+"")},r.formatDate=function(o){var e=new Date(o),n=e.getFullYear(),t=e.getMonth()+1,i=t<10?"0"+t:t+"",a=e.getDate();return n+"-"+i+"-"+(a<10?"0"+a:a+"")},r.formatDateTime=function(o){var e=o.getFullYear(),n=o.getMonth()+1,t=n<10?"0"+n:n+"",i=o.getDate();return e+"-"+t+"-"+(i<10?"0"+i:i+"")+" "+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds()+","+o.getMilliseconds()},r.getTodayFormatDate=function(){var o=new Date,e=o.getFullYear(),n=o.getMonth()+1,t=n<10?"0"+n:n+"",i=o.getDate();return e+"-"+t+"-"+(i<10?"0"+i:i+"")},r.getPastTime=function(o,e){e===void 0&&(e="");var n=new Date(o),t=new Date().getTime()-n.getTime();if(Number.isNaN(t)||o<0)return e;if(o==0)return d.default.w("the past time is 0 "),"\u521A\u521A";if(t<0)return d.default.w("the diff time is less than 0 "),"\u521A\u521A";var i=Math.floor(t/2592e6);return 0<i?"\u4E00\u6708\u524D":0<(i=Math.floor(t/864e5))?i+"\u5929\u524D":0<(i=Math.floor(t/36e5))?i+"\u5C0F\u65F6\u524D":(i=Math.ceil(t/6e4))+"\u5206\u949F\u524D"},r.convertSecondToMinutesSecond=function(o,e){e===void 0&&(e=!0);var n=Math.floor(o/60),t=o%60;return(n<10&&e?"0"+n:""+n)+":"+(t<10&&e?"0"+t:t+"")},r.isSameDay=function(o,e){return!(!o||!e)&&o.getUTCFullYear()===e.getUTCFullYear()&&o.getUTCMonth()===e.getUTCMonth()&&o.getUTCDate()===e.getUTCDate()},r.convertTimeToZero=function(o){console.log("[convertTimeToZero] mms:"+o);var e=new Date(o);return e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),console.log("[convertTimeToZero] zero:"+e.getTime()),e.getTime()},r.isBeyondOneDay=function(o,e){var n=o.getFullYear(),t=o.getMonth(),i=o.getDate();console.log("czx "+n+" "+t+" "+i);var a=e.getFullYear(),u=e.getMonth(),c=e.getDate();return console.log("czx "+a+" "+u+" "+c),n<a||!(a<n)&&(t<u||!(u<t)&&i<c)},r}();m.default=s,cc._RF.pop()},{"../base/Log":"Log"}],TipsDialog:[function(l,P,m){"use strict";cc._RF.push(P,"8b73aVZq0hIMYXG5PeYOUeI","TipsDialog"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.onLoad=function(){var i=this;this.mBottomBtTouchCb=new d.default(function(){i.mBottomBtnCb&&i.mBottomBtnCb()}),this.mBottomBtn.node.on(cc.Node.EventType.TOUCH_END,this.mBottomBtTouchCb.click,this.mBottomBtTouchCb),this.mShowCloseBtn?(this.mCloseBtn.node.active=!0,this.mCloseTouchCb=new d.default(function(){i.mCloseBtnCb&&i.mCloseBtnCb(),i.node.destroy()}),this.mCloseBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCloseTouchCb.click,this.mCloseTouchCb)):this.mCloseBtn.node.active=!1},t.prototype.start=function(){this.mBottomBtnLabel.string=this.mBottomBtnContent,this.mContentLabel.string=this.mMainContent,this.mContentPanel.getComponent(cc.Animation).play("avator_pop_out")},t.prototype.setShowCloseBtn=function(i){this.mShowCloseBtn=i,this.mShowCloseBtn?this.mCloseBtn.node.active=!0:this.mCloseBtn.node.active=!1},t.prototype.setCloseBtnCallback=function(i){this.mCloseBtnCb=i},t.prototype.setBottomBtnCallback=function(i){this.mBottomBtnCb=i},t.prototype.setBottomBtnLabel=function(i){this.mBottomBtnContent=i},t.prototype.setContent=function(i){this.mMainContent=i},__decorate([o(cc.Label)],t.prototype,"mContentLabel",void 0),__decorate([o(cc.Button)],t.prototype,"mBottomBtn",void 0),__decorate([o(cc.Label)],t.prototype,"mBottomBtnLabel",void 0),__decorate([o(cc.Button)],t.prototype,"mCloseBtn",void 0),__decorate([o(cc.Sprite)],t.prototype,"mContentPanel",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent"}],TitleRedspotPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"4a94eaPB/9Gvo8BOBt+Wuqy","TitleRedspotPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../ImgCache"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.iconSprite=null,i.redSpotSprite=null,i}return __extends(t,n),t.prototype.setIconUrl=function(i){d.default.get2(i,this.iconSprite,function(a,u){})},t.prototype.setHasRedspot=function(i){cc.isValid(this,!0)&&this.redSpotSprite&&(this.redSpotSprite.node.active=i)},__decorate([o(cc.Sprite)],t.prototype,"iconSprite",void 0),__decorate([o(cc.Sprite)],t.prototype,"redSpotSprite",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../ImgCache":"ImgCache"}],ToastMgr:[function(l,P,m){"use strict";cc._RF.push(P,"5b01er+1+5O3Y6j/tIYGNId","ToastMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./PrefabMgr"),s=l("./ToastPrefab"),r=function(){function o(){}return o.showToast=function(e,n,t){t===void 0&&(t=!0);var i=cc.director.getScene();i&&d.default.load("prefab/ToastPrefab",function(a,u){if(u){var c=u.getComponent(s.default);c.setLong(t),c.showTips(e,function(){u.destroy(),n&&n()}),i.addChild(u)}})},o}();m.ToastMgr=r,cc._RF.pop()},{"./PrefabMgr":"PrefabMgr","./ToastPrefab":"ToastPrefab"}],ToastPopManager:[function(l,P,m){"use strict";cc._RF.push(P,"64b5br5ZcBGa6HSJr2bk5k7","ToastPopManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../base/Log"),s=function(){function r(){this.mParentNode=null,this.mShowCount=0}return r.getIns=function(){return this.sInstance==null&&(this.sInstance=new r),this.sInstance},r.prototype.init=function(o){o&&(this.mParentNode=o)},r.prototype.showDynamic=function(o,e,n){this.mParentNode||console.error("ToastPopManager show error: parentLayout is null"),d.default.l("ToastPopManager showPopupDlgDynamic:  "+o);var t=this;cc.loader.loadRes(o,cc.Prefab,function(i,a){t.show(a,e,n)})},r.prototype.showWithNode=function(o,e,n){this.mParentNode?(e&&e(o),this.mParentNode.addChild(o),n&&n(o),this.addShowCount()):console.error("ToastPopManager show error: parentLayout is null")},r.prototype.show=function(o,e,n){var t=cc.instantiate(o);this.showWithNode(t,e,n)},r.prototype.dismiss=function(o,e){o.destroy(),e&&e(),this.removeShowCount()},r.prototype.destroy=function(){this.mParentNode=null,r.sInstance=null},r.prototype.addShowCount=function(){this.mShowCount++},r.prototype.removeShowCount=function(){this.mShowCount--},r.prototype.isHasShowingToastPop=function(){return!(this.mShowCount<=0)},r.sInstance=null,r}();m.ToastPopManager=s,cc._RF.pop()},{"../../../base/Log":"Log"}],ToastPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"bb917lQDB9MWbVR7chKF+5f","ToastPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../Network/Protocol/UserUtil"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.contenxt=null,i.diamondCountLabel=null,i.diamondLayout=null,i.labelPre=null,i.labelSuffix=null,i.diamondSprite=null,i.littleStarDiamondLayout=null,i.littleStarDianmondLabel=null,i.mPadding=8,i.loadLayout=null,i.loadLabel=null,i.loadFailLayout=null,i.loadFailLabel=null,i.mAutoClickHide=!0,i.isLong=!0,i.mResolve=null,i.isShowing=!1,i.scheduleCallback=null,i}return __extends(t,n),t.prototype.setLong=function(i){this.isLong=i},t.prototype.onLoad=function(){var i=this;this.node.on(cc.Node.EventType.TOUCH_START,function(a){a.stopPropagation()}),this.node.on(cc.Node.EventType.TOUCH_END,function(a){i.mAutoClickHide&&i.autoHide()})},t.prototype.setTips=function(i){this.contenxt&&(this.contenxt.string=i)},t.prototype.setAwardCount=function(i){if(this.diamondCountLabel){this.diamondCountLabel.string=""+i;var a=(this.diamondLayout.node.width-(this.labelPre.node.width+this.labelSuffix.node.width+this.diamondSprite.node.width+2*this.mPadding))/2,u=a+this.labelPre.node.width+this.mPadding,c=u+this.diamondSprite.node.width+this.mPadding;this.labelPre.getComponent(cc.Widget).left=a,this.diamondSprite.getComponent(cc.Widget).left=u,this.labelSuffix.getComponent(cc.Widget).left=c}},t.prototype.setLittleStarAwardCount=function(i){this.littleStarDianmondLabel&&(this.littleStarDianmondLabel.string="x "+i)},t.prototype.setLoadTips=function(i){i&&(this.loadLabel.string=i)},t.prototype.showReliveAward=function(i,a){this.autoHide(),this.mAutoClickHide=!0,this.mResolve=a,this.showAwardUI(),this.setAwardCount(i),this.show()},t.prototype.showTips=function(i,a){this.autoHide(),this.mAutoClickHide=!0,this.mResolve=a,this.showInviteUI(),this.setTips(i),this.show()},t.prototype.showLittleStarAward=function(i,a){this.autoHide(),this.mAutoClickHide=!0,this.mResolve=a,this.showLittleStarAwardUI(),this.setLittleStarAwardCount(i),this.show()},t.prototype.showLoading=function(i){this.autoHide(),this.mAutoClickHide=!1,this.showLoadLayout(),i&&this.setLoadTips(i),this.isShowing=!0},t.prototype.showLoadFail=function(i){this.autoHide(),this.mAutoClickHide=!0,this.mResolve=i,this.showLoadFaillayout(),this.show()},t.prototype.show=function(){var i=this;if(!this.isShowing){this.isShowing=!0;var a=d.default.getCurSysTime(),u=this.isLong?3:1.5;this.scheduleCallback==null&&(this.scheduleCallback=function(){var c=d.default.getCurSysTime();u<c-a&&i.autoHide()}),this.scheduler=cc.director.getScheduler(),this.scheduler.scheduleUpdate(this,cc.Scheduler.PRIORITY_NON_SYSTEM,!1,this.scheduleCallback)}},t.prototype.autoHide=function(){this.isShowing=!1,this.scheduler&&this.scheduler.unscheduleUpdate(this),this.mResolve&&this.mResolve()},t.prototype.showAwardUI=function(){this.contenxt&&(this.contenxt.node.active=!1),this.diamondLayout&&(this.diamondLayout.node.active=!0),this.littleStarDiamondLayout&&(this.littleStarDiamondLayout.node.active=!1),this.loadLayout&&(this.loadLayout.node.active=!1),this.loadFailLayout&&(this.loadFailLayout.node.active=!1)},t.prototype.showInviteUI=function(){this.contenxt&&(this.contenxt.node.active=!0),this.diamondLayout&&(this.diamondLayout.node.active=!1),this.littleStarDiamondLayout&&(this.littleStarDiamondLayout.node.active=!1),this.loadLayout&&(this.loadLayout.node.active=!1),this.loadFailLayout&&(this.loadFailLayout.node.active=!1)},t.prototype.showLittleStarAwardUI=function(){this.contenxt&&(this.contenxt.node.active=!1),this.diamondLayout&&(this.diamondLayout.node.active=!1),this.littleStarDiamondLayout&&(this.littleStarDiamondLayout.node.active=!0),this.loadLayout&&(this.loadLayout.node.active=!1),this.loadFailLayout&&(this.loadFailLayout.node.active=!1)},t.prototype.showLoadLayout=function(){this.contenxt&&(this.contenxt.node.active=!1),this.diamondLayout&&(this.diamondLayout.node.active=!1),this.littleStarDiamondLayout&&(this.littleStarDiamondLayout.node.active=!1),this.loadLayout&&(this.loadLayout.node.active=!0,this.loadLayout.getComponent(cc.Animation).play("save_image_loading")),this.loadFailLayout&&(this.loadFailLayout.node.active=!1)},t.prototype.showLoadFaillayout=function(){this.contenxt&&(this.contenxt.node.active=!1),this.diamondLayout&&(this.diamondLayout.node.active=!1),this.littleStarDiamondLayout&&(this.littleStarDiamondLayout.node.active=!1),this.loadLayout&&(this.loadLayout.node.active=!1),this.loadFailLayout&&(this.loadFailLayout.node.active=!0)},__decorate([o(cc.Label)],t.prototype,"contenxt",void 0),__decorate([o(cc.Label)],t.prototype,"diamondCountLabel",void 0),__decorate([o(cc.Layout)],t.prototype,"diamondLayout",void 0),__decorate([o(cc.Label)],t.prototype,"labelPre",void 0),__decorate([o(cc.Label)],t.prototype,"labelSuffix",void 0),__decorate([o(cc.Sprite)],t.prototype,"diamondSprite",void 0),__decorate([o(cc.Layout)],t.prototype,"littleStarDiamondLayout",void 0),__decorate([o(cc.Label)],t.prototype,"littleStarDianmondLabel",void 0),__decorate([o(cc.Layout)],t.prototype,"loadLayout",void 0),__decorate([o(cc.Label)],t.prototype,"loadLabel",void 0),__decorate([o(cc.Layout)],t.prototype,"loadFailLayout",void 0),__decorate([o(cc.Label)],t.prototype,"loadFailLabel",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../../Network/Protocol/UserUtil":"UserUtil"}],ToggleBean:[function(l,P,m){"use strict";cc._RF.push(P,"77185dLwQJFa5gynXIsexhs","ToggleBean"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function o(){this.toggle=null}return o.parseFromJson=function(e){if(!e)return null;for(var n=new o,t=new Array,i=0,a=e;i<a.length;i++){var u=a[i],c=new r;c.toggleKey=u.toggleKey,c.curStatus=u.curStatus,c.otherStatus=u.otherStatus,c.startTime=u.startTime,c.endTime=u.endTime,c.platform=u.platform,c.extra=u.extra,t.push(c)}return n.toggle=t,n},o}();m.default=d;var s,r=function(){};m.Toggle=r,(s=m.ToggleKey||(m.ToggleKey={})).RESULT_SKIN="result_skin",s.RESULT_SONG="result_song",s.RESULT_SHARE_GIFT="result_share_gift",s.TMALL_PROMOTION_ENTRANCE="tmall_1111_entrance",s.SINGLE_SONG_SHOWOFF_QQ_BANNER="ss_showoff_qqbanner",s.SINGLE_SONG_RESULT_DYNAMIC_BANNER="ss_result_qqbanner_dynamic",s.WX_REWARDED_VIDEO_PRELOAD="wx_rewarded_video_preload",s.SUBSCRIPTION_ICON="subscription_icon",s.CHRITMAS_ELEC_PIANO="christmas_elec_piano",s.SINGLE_SONG_RESULT_BANNER_DELAY="ss_result_banner_delay",s.BANNER_DELAY_REWARD_PAGE="banner_delay_reward_page",s.BANNER_DELAY_DAILY_ATTENDANCE="banner_delay_daily_attendance",s.BANNER_DELAY_FIGHT_RESULT="banner_delay_fight_result",s.BANNER_DELAY_FIGHT_SHOW_OFF="banner_delay_fight_show_off",s.BANNER_DELAY_NORMAL_RESULT_SHOW_OFF="banner_delay_normal_result_show_off",s.BANNER_DELAY_LOTTERY_PAGE="banner_delay_lottery_page",s.BANNER_DELAY_RELIVE_PAGE="banner_delay_relive_page",s.BANNER_DELAY_CHALLENGE_SHOW_OFF="banner_delay_challenge_show_off",cc._RF.pop()},{}],ToggleChecker:[function(l,P,m){"use strict";cc._RF.push(P,"501f4CJozBL+5cbjJnR0IVF","ToggleChecker"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./ToggleBean"),s=l("../LogicPlatform/PlatformProxy"),r=l("../../modules/MGBasic/scripts/Logic/MGBasicEntrance"),o=l("../base/Log"),e=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),n=l("../util/PU"),t=function(){function i(){this.mToggleUrl="https://piano-weixin-game.cmcm.com/pianotiles2/cfg/toggle_cfg.json",this.mToggleBean=null,this.isInited=!1}return i.ins=function(){return this.mChecker||(this.mChecker=new i),this.mChecker},i.prototype.init=function(a){this.downLoad(a,a)},i.prototype.getToggleBean=function(){return this.mToggleBean},i.prototype.getToggle=function(a){if(this.mToggleBean&&this.mToggleBean.toggle){o.default.i(i.TAG+" getToggle. toggleKey = "+a+",this.mToggleBean.toggle = ",this.mToggleBean.toggle);for(var u=0,c=this.mToggleBean.toggle;u<c.length;u++){var p=c[u];if(p.toggleKey==a)return p}}return null},i.prototype.getToggleStatus=function(a,u,c){var p=i.ins().getToggle(a);if(p){if(p.platform.includes("all"))return this.handleStatus(p);if(p.platform.includes("qq"))return n.default.isQQ()?this.handleStatus(p):c;if(p.platform.includes("wx"))return n.default.isWeiXin()?this.handleStatus(p):c}return u},i.prototype.handleStatus=function(a){var u=e.MGUser.getCurrentServerTime();return u>=a.startTime&&u<=a.endTime?a.curStatus:a.otherStatus},i.prototype.downLoad=function(a,u){var c=this;this.isInited?a&&a():s.default.Ins().downloadFile(this.mToggleUrl,function(p){r.MGBasic.readFile({filePath:p,encoding:"utf8",success:function(h){o.default.i(i.TAG+" readFile success data = ",h),c.mToggleBean=d.default.parseFromJson(h),c.isInited=!0,a()},fail:function(){u(),o.default.e(i.TAG+" readFile failed."+c.mToggleUrl)}})},function(){o.default.e(i.TAG+" download failed."+c.mToggleUrl),u()},0,!1)},i.TAG="ToggleChecker ====>",i.mChecker=null,i}();m.default=t,cc._RF.pop()},{"../../modules/MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../LogicPlatform/PlatformProxy":"PlatformProxy","../base/Log":"Log","../util/PU":"PU","./ToggleBean":"ToggleBean"}],TouchHandler:[function(l,P,m){"use strict";cc._RF.push(P,"76be2wjCUdCi4gBqJsQidt7","TouchHandler"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../util/Utility"),s=l("../base/G"),r=l("../LogicPlatform/PlatformProxy"),o=l("../base/Log"),e=function(){function n(t,i){this.canvas=null,this.pos=null,this.ratio=0,this.listener=null,this._mousePressed=!1,this._latestTouchs=null,this.bindStart=null,this.bindMove=null,this.bindEnd=null,this.enabled=!0,this.rootNode=null,this.platform=0,this.platform=cc.sys.platform,this.rootNode=t,this.canvas=cc.game.canvas,this.pos=this.getCanvasPosition(this.canvas),this.ratio=cc.view.getDevicePixelRatio(),this.listener=i,cc.sys.isMobile?this.platform==cc.sys.QQ_PLAY?(this.bindStart=this.onCCTouchStart.bind(this),this.bindMove=this.onCCTouchMove.bind(this),this.bindEnd=this.onCCTouchEnd.bind(this)):(this.bindStart=this.onTouchStart.bind(this),this.bindMove=this.onTouchMove.bind(this),this.bindEnd=this.onTouchEnd.bind(this)):(this.bindStart=this.onCCMouseDown.bind(this),this.bindMove=this.onCCMouseMove.bind(this),this.bindEnd=this.onCCMouseEUp.bind(this))}return n.prototype.enable=function(t){cc.sys.isMobile?this.enabled=t:this.enabled=!0},n.prototype.isEnabled=function(){return this.enabled},n.prototype.updateRatio=function(){this.ratio=cc.view.getDevicePixelRatio()},n.prototype.registerListener=function(){cc.sys.isMobile?this.platform==cc.sys.QQ_PLAY?(this.rootNode.on(cc.Node.EventType.TOUCH_START,this.bindStart),this.rootNode.on(cc.Node.EventType.TOUCH_MOVE,this.bindMove),this.rootNode.on(cc.Node.EventType.TOUCH_END,this.bindEnd)):(this.canvas.addEventListener("touchstart",this.bindStart),this.canvas.addEventListener("touchmove",this.bindMove),this.canvas.addEventListener("touchend",this.bindEnd)):(this.rootNode.on(cc.Node.EventType.MOUSE_DOWN,this.bindStart),this.rootNode.on(cc.Node.EventType.MOUSE_MOVE,this.bindMove),this.rootNode.on(cc.Node.EventType.MOUSE_UP,this.bindEnd)),this.rootNode.on("cm_touchstart",this.onCMTouchStart,this),this.rootNode.on("cm_touchend",this.onCMTouchEnd,this)},n.prototype.unregisterListener=function(){cc.sys.isMobile?this.platform==cc.sys.QQ_PLAY?(this.rootNode.off(cc.Node.EventType.TOUCH_START,this.bindStart),this.rootNode.off(cc.Node.EventType.TOUCH_MOVE,this.bindMove),this.rootNode.off(cc.Node.EventType.TOUCH_END,this.bindEnd)):(this.canvas.removeEventListener("touchstart",this.bindStart),this.canvas.removeEventListener("touchmove",this.bindMove),this.canvas.removeEventListener("touchend",this.bindEnd)):(this.rootNode.off(cc.Node.EventType.MOUSE_DOWN,this.bindStart),this.rootNode.off(cc.Node.EventType.MOUSE_MOVE,this.bindMove),this.rootNode.off(cc.Node.EventType.MOUSE_UP,this.bindEnd)),this.rootNode.off("cm_touchstart",this.onCMTouchStart,this),this.rootNode.off("cm_touchend",this.onCMTouchEnd,this)},n.prototype.onCMTouchStart=function(t){var i=this.getCMTouchesByCMTouchEvent(t.detail);this.listener&&this.listener.onTouchStart(i)},n.prototype.onCMTouchEnd=function(t){var i=this.getCMTouchesByCMTouchEvent(t.detail);this.listener&&this.listener.onTouchEnd(i)},n.prototype.onCCTouchStart=function(t){if(this.enabled){o.default.l("onCCTouchStart enable");var i=this.getCCTouchesByTouchEvent(t);this.listener&&this.listener.onTouchStart(i),this._latestTouchs=i,t.stopPropagation()}else o.default.l("onCCTouchStart disable")},n.prototype.onCCTouchMove=function(t){if(this.enabled){var i=this.getCCTouchesByTouchEvent(t);this.listener&&this.listener.onTouchMove(i),t.stopPropagation()}},n.prototype.onCCTouchEnd=function(t){if(this.enabled){var i=this.getCCTouchesByTouchEvent(t);this.listener&&this.listener.onTouchEnd(i),this._latestTouchs=null,t.stopPropagation()}},n.prototype.onCCMouseDown=function(t){if(this.enabled){this._mousePressed=!0;var i=this.getCCTouchesByMouseEvent(t);this.listener&&this.listener.onTouchStart(i),this._latestTouchs=i,t.stopPropagation()}},n.prototype.onCCMouseMove=function(t){if(this.enabled&&this._mousePressed){var i=this.getCCTouchesByMouseEvent(t);this.listener&&this.listener.onTouchMove(i),t.stopPropagation()}},n.prototype.onCCMouseEUp=function(t){if(this.enabled){this._mousePressed=!1;var i=this.getCCTouchesByMouseEvent(t);this.listener&&this.listener.onTouchEnd(i),this._latestTouchs=null,t.stopPropagation()}},n.prototype.onTouchStart=function(t){if(this.enabled){var i=this.getTouchesByTouchEvent(t);this.listener&&this.listener.onTouchStart(i),this._latestTouchs=i,t.preventDefault(),t.stopPropagation()}},n.prototype.onTouchMove=function(t){if(this.enabled){var i=this.getTouchesByTouchEvent(t);this.listener&&this.listener.onTouchMove(i),t.preventDefault(),t.stopPropagation()}},n.prototype.onTouchEnd=function(t){if(this.enabled){var i=this.getTouchesByTouchEvent(t);this.listener&&this.listener.onTouchEnd(i),this._latestTouchs=null,t.preventDefault(),t.stopPropagation()}},n.prototype.render=function(t){var i=this._latestTouchs;if(i!==null){t.fillStyle="red";for(var a=0;a<i.length;a++){var u=i[a].clientX*s.G.Ap.config.presentScale,c=r.default.Ins().getCanvasHeightByContext(t)-i[a].clientY*s.G.Ap.config.presentScale;t.beginPath(),t.arc(u,c,10*this.ratio,0,2*Math.PI,!1),t.closePath(),t.fill()}}},n.prototype.getCMTouchesByCMTouchEvent=function(t){for(var i,a,u=[],c=t.length,p=0;p<c;p++){var h=t[p];if(h){var f=h.id;i=h.x,a=h.y,u.push(new d.Utility.TouchItem(f,i,a))}}return u},n.prototype.getCCTouchesByTouchEvent=function(t){for(var i,a,u=[],c=t.getTouches(),p=c.length,h=0;h<p;h++){var f=c[h];if(f){var g=f._id;i=f._point.x,a=f._point.y,u.push(new d.Utility.TouchItem(g,i,a))}}return u},n.prototype.getCCTouchesByMouseEvent=function(t){var i=[],a=t.getLocation();return a&&i.push(new d.Utility.TouchItem(1,a.x,a.y)),i},n.prototype.getTouchesByTouchEvent=function(t){for(var i,a,u=this.ratio,c=[],p=t.changedTouches.length,h=0;h<p;h++){var f=t.changedTouches[h];if(f){var g=f.identifier!=null?f.identifier:1;cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?(i=u*f.pageX,a=u*(window.innerHeight-f.pageY)):(i=u*f.clientX,a=u*(window.innerHeight-f.clientY)),c.push(new d.Utility.TouchItem(g,i/s.G.Ap.config.presentScale,a/s.G.Ap.config.presentScale))}}return c},n.prototype.getCanvasPosition=function(t){if(cc.sys.platform===cc.sys.WECHAT_GAME||cc.sys.platform===cc.sys.QQ_PLAY)return{left:0,top:0,width:window.innerWidth,height:window.innerHeight};var i=document.documentElement,a=window.pageXOffset-i.clientLeft,u=window.pageYOffset-i.clientTop;if(typeof t.getBoundingClientRect=="function"){var c=t.getBoundingClientRect();return{left:c.left+a,top:c.top+u,width:c.width,height:c.height}}return t instanceof HTMLCanvasElement?{left:a,top:u,width:t.width,height:t.height}:{left:a,top:u,width:parseInt(t.style.width),height:parseInt(t.style.height)}},n}();m.default=e,cc._RF.pop()},{"../LogicPlatform/PlatformProxy":"PlatformProxy","../base/G":"G","../base/Log":"Log","../util/Utility":"Utility"}],TrialGameScene:[function(l,P,m){"use strict";cc._RF.push(P,"c7365+AD45NLb6BYjAioli0","TrialGameScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameScene"),s=l("../base/G"),r=l("./element/loader/GameSceneFrameLoader"),o=l("./element/loader/BlockSkinFrameLoader"),e=l("../util/Utility"),n=l("./ctrl/GameStageTrial"),t=l("./view/GameStageNodeView"),i=l("../business/Logic/I18nManager"),a=l("../business/Logic/NotifyEvent"),u=l("../business/Logic/EventBus"),c=function(p){function h(f,g){return p.call(this,f,g)||this}return __extends(h,p),h.prototype.initilize=function(){if(this.effectiveSkin=s.G.Ap.skinMgr.getTrialSkinItem(),this.effectiveSkin||(this.effectiveSkin=s.G.Ap.skinMgr.getCurrentSkinItem()),this.atlasGameObject=r.default.getInstance().getAtlas(),this.effectiveSkin){var f=this.effectiveSkin.getSkinObject(),g=f.skinRaw.getBlockAtlasName();o.default.getInstance().setAtlas(f.atlasMap[g]),s.G.Ap.config.longBlockDotAnimEnable=f.skinRaw.getDesign().longBlockDotAnimaion}},h.prototype.getEnableModuleList=function(){return null},h.prototype.updateUI=function(){if(this.effectiveSkin){var f="\u7247\u6BB5\u8BD5\u73A9",g="\u76AE\u80A4";i.default.getInstance().isEnglish()&&(f="Section trial",g=" Skin"),this.banner.show(this.effectiveSkin.getProperty().displayName+g,f)}},h.prototype.createAnimCtrl=function(){},h.prototype.initGame=function(){if(this.music){this.getGameRegion();var f=this.getGameNode(),g=new t.default(f.getChildByTag(e.Utility.GAMESTAGE.MUSIC));this.firstStage=new n.default(this,g),this.firstStage.init(152),this.firstStage.activeNode(!0),this.currentStage=this.firstStage,this.startGameStageSwitch(e.Utility.GAMESTAGE.MUSIC)}},h.prototype.finishGameStage=function(f){var g=this;s.G.Ap.state.pause(),this.setSheduleOnce(function(){g.returnToHomeScene()},1)},h.prototype.attainCrown=function(){},h.prototype.attainMoney=function(f){},h.prototype.attainGift=function(f){},h.prototype.gameOver=function(){var f=this;s.G.Ap.state.pause(),this.setSheduleOnce(function(){f.returnToHomeScene()},1)},h.prototype.returnToHomeScene=function(){s.G.skinTryData&&(s.G.skinTryData.trySkinFinish=!0),s.G.Ap.presenter.enterScene("MainScene"),u.default.fire(a.default.PLAY_TRIAL_FINISHED)},h}(d.default);m.default=c,cc._RF.pop()},{"../base/G":"G","../business/Logic/EventBus":"EventBus","../business/Logic/I18nManager":"I18nManager","../business/Logic/NotifyEvent":"NotifyEvent","../util/Utility":"Utility","./GameScene":"GameScene","./ctrl/GameStageTrial":"GameStageTrial","./element/loader/BlockSkinFrameLoader":"BlockSkinFrameLoader","./element/loader/GameSceneFrameLoader":"GameSceneFrameLoader","./view/GameStageNodeView":"GameStageNodeView"}],TrialItemPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"53478cxMgVNmItPfbJVtjIE","TrialItemPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../BasicTouchEvent"),s=cc._decorator,r=s.ccclass,o=s.property,e=function(n){function t(){var i=n!==null&&n.apply(this,arguments)||this;return i.mTitleTxt=null,i.mDescTxt=null,i.mRewardTxt=null,i.mIconSprite=null,i.mBtnTrialPlay=null,i.mRewardLayout=null,i}return __extends(t,n),t.prototype.start=function(){},t.prototype.initItem=function(i,a){if(i&&i.mRawData){this.mTitleTxt&&i.mRawData.title&&(this.mTitleTxt.string=i.mRawData.title),this.mDescTxt&&i.mRawData.describe&&(this.mDescTxt.string=i.mRawData.describe),this.mRewardTxt&&i.mRawData.describe2&&(this.mRewardTxt.string=i.mRawData.describe2);var u=this,c=new d.default(function(){a&&a(i,u.isNeedAddReward()),u.initUI(i)});this.mBtnTrialPlay&&this.mBtnTrialPlay.node&&this.mBtnTrialPlay.node.on(cc.Node.EventType.TOUCH_END,c.click,c),this.mIconSprite&&i.mRawData.iconUrl&&cc.loader.load(i.mRawData.iconUrl,function(p,h){!p&&h&&cc.isValid(u.mIconSprite,!0)&&(u.mIconSprite.spriteFrame=new cc.SpriteFrame(h))}),this.initUI(i)}},t.prototype.isNeedAddReward=function(){var i=this.mBtnTrialPlay.node.getChildByName("Label");if(!i)return!1;var a=i.getComponent(cc.Label);return!(!a||a.string!=="\u8BD5\u73A9")},t.prototype.initUI=function(i){if(i&&(this.mRewardLayout&&this.mRewardLayout.node&&(this.mRewardLayout.node.active=i.isToadyFristTrial()),this.mBtnTrialPlay&&this.mBtnTrialPlay.node)){var a=this.mBtnTrialPlay.node.getChildByName("Label");if(!a)return;var u=a.getComponent(cc.Label);u&&(u.string=i.isToadyFristTrial()?"\u8BD5\u73A9":"\u53BB\u73A9"),this.mBtnTrialPlay.node.y+=i.isToadyFristTrial()?0:10}},__decorate([o(cc.Label)],t.prototype,"mTitleTxt",void 0),__decorate([o(cc.Label)],t.prototype,"mDescTxt",void 0),__decorate([o(cc.Label)],t.prototype,"mRewardTxt",void 0),__decorate([o(cc.Sprite)],t.prototype,"mIconSprite",void 0),__decorate([o(cc.Button)],t.prototype,"mBtnTrialPlay",void 0),__decorate([o(cc.Layout)],t.prototype,"mRewardLayout",void 0),t=__decorate([r],t)}(cc.Component);m.default=e,cc._RF.pop()},{"../BasicTouchEvent":"BasicTouchEvent"}],TrialPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"4a6e9ENzutPRpr80JbxSrCJ","TrialPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./MainpageBaseComponent"),s=l("./TrialItemPrefab"),r=l("./RcmdGameDataAdapter"),o=l("./../PrefabMgr"),e=l("./../ToastPrefab"),n=cc._decorator,t=n.ccclass,i=n.property,a=function(u){function c(){var p=u!==null&&u.apply(this,arguments)||this;return p.mBkSprite=null,p.mScrollView=null,p.mTitleSprite=null,p.mAdapter=null,p.mPosId="1001131",p}return __extends(c,u),c.prototype.onLoad=function(){this.init()},c.prototype.init=function(){this.mAdapter||(this.mAdapter=new r.default),this.mAdapter.getRcmdGameData(this.mPosId,this.initScrollView.bind(this)),this.mTitleSprite&&this.mTitleSprite.node&&(this.mTitleSprite.node.active=!1)},c.prototype.initScrollView=function(p){var h=this;if(p&&!(p.length<=0)){var f=p.length;if(this.mScrollView&&this.mScrollView.content)for(var g=function(y){o.default.load("prefab/mainpage/TrialItemPrefab",function(S,I){if(I&&cc.isValid(h,!0)){h.mScrollView.content.height=(I.height+5)*f-5;var v=I.getComponent(s.default),C=-y*(I.height+5);I.setPosition(0,C);var T=p[y];v&&v.initItem(T,h.onItemClick.bind(h)),h.mScrollView.content.addChild(I)}})},_=0;_<f;_++)g(_)}},c.prototype.onItemClick=function(p,h){this.mAdapter&&p&&(this.mAdapter.jumpTo(p,h),h&&this.showToastTips(p.getRewardText()))},c.prototype.showToastTips=function(p){var h=this;o.default.load("prefab/ToastPrefab",function(f,g){if(g){var _=g.getComponent(e.default);_.showTips(p,function(){g.destroy()}),_.setLong(!1),h.node.addChild(g)}})},__decorate([i(cc.Sprite)],c.prototype,"mBkSprite",void 0),__decorate([i(cc.ScrollView)],c.prototype,"mScrollView",void 0),__decorate([i(cc.Sprite)],c.prototype,"mTitleSprite",void 0),c=__decorate([t],c)}(d.default);m.default=a,cc._RF.pop()},{"./../PrefabMgr":"PrefabMgr","./../ToastPrefab":"ToastPrefab","./MainpageBaseComponent":"MainpageBaseComponent","./RcmdGameDataAdapter":"RcmdGameDataAdapter","./TrialItemPrefab":"TrialItemPrefab"}],TrialSongGameScene:[function(l,P,m){"use strict";cc._RF.push(P,"d8ac7NwpPZEvZgUvbHMgO4/","TrialSongGameScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameScene"),s=l("../base/G"),r=l("../util/Utility"),o=l("../business/Logic/LangMgr"),e=l("./ctrl/GameStageTrialSong"),n=l("./view/GameStageNodeView"),t=l("../business/Logic/I18nManager"),i=function(a){function u(c,p){return a.call(this,c,p)||this}return __extends(u,a),u.prototype.getEnableModuleList=function(){return null},u.prototype.updateUI=function(){if(this.effectiveSkin){var c="\u7247\u6BB5\u8BD5\u73A9";t.default.getInstance().isEnglish()&&(c="Section trial");var p=o.default.gIns().getLanguageByKey(this.music.getName());this.banner.show(p,c)}},u.prototype.createAnimCtrl=function(){},u.prototype.initGame=function(){if(this.music){this.getGameRegion();var c=this.getGameNode(),p=new n.default(c.getChildByTag(r.Utility.GAMESTAGE.MUSIC));this.firstStage=new e.default(this,p),this.firstStage.init(152),this.firstStage.activeNode(!0),this.currentStage=this.firstStage,this.startGameStageSwitch(r.Utility.GAMESTAGE.MUSIC)}},u.prototype.finishGameStage=function(c){var p=this;s.G.Ap.state.pause(),this.setSheduleOnce(function(){p.returnToHomeScene()},1)},u.prototype.attainCrown=function(){},u.prototype.attainMoney=function(c){},u.prototype.attainGift=function(c){},u.prototype.gameOver=function(){var c=this;s.G.Ap.state.pause(),this.setSheduleOnce(function(){c.returnToHomeScene()},1)},u.prototype.returnToHomeScene=function(){s.G.songTryData&&(s.G.songTryData.songTryFinish=!0),s.G.Ap.presenter.enterScene("MainScene")},u}(d.default);m.default=i,cc._RF.pop()},{"../base/G":"G","../business/Logic/I18nManager":"I18nManager","../business/Logic/LangMgr":"LangMgr","../util/Utility":"Utility","./GameScene":"GameScene","./ctrl/GameStageTrialSong":"GameStageTrialSong","./view/GameStageNodeView":"GameStageNodeView"}],TryPianoGameScene:[function(l,P,m){"use strict";cc._RF.push(P,"95e0dOjKLxNg5+QWMnpgFO1","TryPianoGameScene"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./GameScene"),s=l("../base/G"),r=l("../util/Utility"),o=l("./ctrl/GameStageTrial"),e=l("./view/GameStageNodeView"),n=l("../business/Logic/I18nManager"),t=function(i){function a(u,c){return i.call(this,u,c)||this}return __extends(a,i),a.prototype.getEnableModuleList=function(){return null},a.prototype.updateUI=function(){this.effectiveSkin&&n.default.getInstance().isEnglish()},a.prototype.createAnimCtrl=function(){},a.prototype.initGame=function(){if(this.music){this.getGameRegion();var u=this.getGameNode(),c=new e.default(u.getChildByTag(r.Utility.GAMESTAGE.MUSIC));this.firstStage=new o.default(this,c),this.firstStage.init(152),this.firstStage.activeNode(!0),this.currentStage=this.firstStage,this.startGameStageSwitch(r.Utility.GAMESTAGE.MUSIC)}},a.prototype.finishGameStage=function(u){var c=this;s.G.Ap.state.pause(),this.setSheduleOnce(function(){c.returnToHomeScene()},1)},a.prototype.attainCrown=function(){},a.prototype.attainMoney=function(u){},a.prototype.attainGift=function(u){},a.prototype.gameOver=function(){var u=this;s.G.Ap.state.pause(),this.setSheduleOnce(function(){u.returnToHomeScene()},1)},a.prototype.returnToHomeScene=function(){s.G.tryData&&(s.G.tryData.tryFinish=!0),s.G.Ap.presenter.enterScene("MainScene")},a}(d.default);m.default=t,cc._RF.pop()},{"../base/G":"G","../business/Logic/I18nManager":"I18nManager","../util/Utility":"Utility","./GameScene":"GameScene","./ctrl/GameStageTrial":"GameStageTrial","./view/GameStageNodeView":"GameStageNodeView"}],Tween:[function(l,P,m){"use strict";cc._RF.push(P,"a2d528T8ZlJeb2JtHLQfGA+","Tween"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.quadEaseIn=function(r,o,e,n){return e*(r/=n)*r+o},s.quadLinear=function(r,o,e,n){return e*r/n+o},s}();m.mTween=d,cc._RF.pop()},{}],TwoBtnDIalogPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"70dd7cgAJ5IGaK98xPTJiQ+","TwoBtnDIalogPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BasicTouchEvent"),s=l("../../../util/StringUtil"),r=cc._decorator,o=r.ccclass,e=r.property,n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.onLoad=function(){var a=this;this.mCancelBtnCallback=new d.default(function(){a.mCancelCallback&&a.mCancelCallback(),a.node.destroy()}),this.mCancelBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCancelBtnCallback.click,this.mCancelBtnCallback),this.mConfirmBtnCallback=new d.default(function(){a.mConfirmCallback&&a.mConfirmCallback(),a.node.destroy()}),this.mConfirmBtn.node.on(cc.Node.EventType.TOUCH_END,this.mConfirmBtnCallback.click,this.mConfirmBtnCallback),this.node.on(cc.Node.EventType.TOUCH_END,function(u){u.stopPropagation()},this)},i.prototype.setCancelCallback=function(a,u){return this.mCancelCallback=a,s.StringUtil.isEmpty(u)||(this.mCancelBtn.getComponentInChildren(cc.Label).string=u),this},i.prototype.start=function(){this.mContentNode.getComponent(cc.Animation).play("gold_pop_out")},i.prototype.setContent=function(a){return this.mContentLabel.string=a,this},i.prototype.setConfirmCallback=function(a,u){return this.mConfirmCallback=a,s.StringUtil.isEmpty(u)||(this.mConfirmBtn.getComponentInChildren(cc.Label).string=u),this},i.prototype.setTitle=function(a){return this.mTileLabel.string=a,this},__decorate([e(cc.Label)],i.prototype,"mTileLabel",void 0),__decorate([e(cc.Label)],i.prototype,"mContentLabel",void 0),__decorate([e(cc.Button)],i.prototype,"mCancelBtn",void 0),__decorate([e(cc.Button)],i.prototype,"mConfirmBtn",void 0),__decorate([e(cc.Node)],i.prototype,"mContentNode",void 0),i=__decorate([o],i)}(cc.Component);m.default=n,cc._RF.pop()},{"../../../util/StringUtil":"StringUtil","./BasicTouchEvent":"BasicTouchEvent"}],TypeDefinition:[function(l,P,m){"use strict";cc._RF.push(P,"a1c122P5FdKWZEZhPfYtCcx","TypeDefinition"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function n(){}return n.PLATFORM_UNKNOWN=-1,n.PLATFORM_WEB=0,n.PLATFORM_WECHAT=1,n.PLATFORM_FACEBOOK=2,n.PLATFORM_H5SDK=3,n.PLATFORM_QQPLAY=4,n.PLATFORM_GAMEHALL=5,n.PLATFORM_CMPLAY=7,n}();m.PlatformType=d;var s=function(){function n(){}return n.prototype.toString=function(){return this.userBasicInfo.toString()+","+this.userLoginInfo.toString()},n}();m.UserInfo=s;var r=function(){function n(){}return n.prototype.toString=function(){return"nickName:"+this.nickName+", avatarUrl:"+this.avatarUrl},n}();m.UserBasicInfo=r;var o=function(){function n(){}return n.prototype.toString=function(){return"playerId:"+this.playerId+", token:"+this.token+",sid:"+this.sid+",isFirstLogin:"+this.isNewUser},n}();m.UserLoginInfo=o;var e=function(){};m.LaunchOption=e,cc._RF.pop()},{}],UICache:[function(l,P,m){"use strict";cc._RF.push(P,"a60abg765VCPKqUkplfp67w","UICache"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("./GameEntranceScene");(d=m.UICache||(m.UICache={})).musicListView=null,d.hideMusicView=function(){if(d.musicListView){d.musicListView.active&&(d.musicListView.active=!1),d.musicListView.x=-1e4;var r=d.musicListView.getChildByName("MainPagePrefab").getComponent(s.default);r.onHide(),r.onStop()}},d.showMusicView=function(){if(d.musicListView){d.musicListView.active||(d.musicListView.active=!0),d.musicListView.x=360;var r=d.musicListView.getChildByName("MainPagePrefab").getComponent(s.default);r.onStart(),r.onShow()}},cc._RF.pop()},{"./GameEntranceScene":"GameEntranceScene"}],UiPropertyIconPanel:[function(l,P,m){"use strict";cc._RF.push(P,"ae1abShewFHRaGOMmaFqKKn","UiPropertyIconPanel"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../MUI/MUINode"),s=l("../MUI/MUISprite"),r=l("../element/loader/GameSceneFrameLoader"),o=l("../../property/PropertyDefines"),e=function(){function i(){this.avoid=new n,this.conversion=new n,this.fanatical=new n,this.allPropertes={}}return i.prototype.create=function(){this.root=new d.default("PropertyIcons"),this.avoid.create("propertyicon29","propertyicon29_active"),this.root.addChild(this.avoid.root),this.allPropertes[o.PROPERTYTYPE.GAME_AVOID]=this.avoid,this.conversion.create("propertyicon30","propertyicon30_active"),this.root.addChild(this.conversion.root),this.allPropertes[o.PROPERTYTYPE.GAME_CONVERSION]=this.conversion,this.fanatical.create("propertyicon31","propertyicon31_active"),this.root.addChild(this.fanatical.root),this.allPropertes[o.PROPERTYTYPE.GAME_FANATICAL]=this.fanatical,this.rearrange()},i.prototype.rearrange=function(){var a=0,u=function(c){c.setPosition(0,0+78*a*-1),c.getVisible()==1&&++a};u(this.avoid.root),u(this.conversion.root),u(this.fanatical.root)},i.prototype.getProperty=function(a){return this.allPropertes[a]},i}();m.UiPropertyIconPanel=e;var n=function(){function i(){}return i.prototype.create=function(a,u){this.root=new d.default,this.root.setVisible(!1);var c=r.default.getInstance().getAtlas(),p=null,h=new cc.Vec2(62,62),f=new cc.Vec2(80,80);(p=new s.default("icon")).setVisible(!0),p.setOpacity(255),p.imageData=c,p.imageItem=c.getItem(a),p.setContentSize(h.x,h.y),p.setPosition(0,0),t.resetPositionByAnchor(p,h),this.root.addChild(p),this.icon=p,(p=new s.default("active")).setVisible(!1),p.setOpacity(255),p.imageData=c,p.imageItem=c.getItem(u),p.setContentSize(f.x,f.y),p.setPosition(0,0),t.resetPositionByAnchor(p,f),this.root.addChild(p),this.active=p},i.prototype.showActive=function(){this.icon.setVisible(!0),this.active.setVisible(!0)},i.prototype.showNormal=function(){this.icon.setVisible(!0),this.active.setVisible(!1)},i}(),t=function(){function i(){}return i.resetPositionByAnchor=function(a,u){var c=a.getPosition();c.x+=-.5*u.x,c.y+=-.5*u.y,a.setPosition(c.x,c.y)},i}();cc._RF.pop()},{"../../property/PropertyDefines":"PropertyDefines","../MUI/MUINode":"MUINode","../MUI/MUISprite":"MUISprite","../element/loader/GameSceneFrameLoader":"GameSceneFrameLoader"}],UnlockConfirmDialogPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"c3f72Yf7ZVMCaNvJwd1hvcn","UnlockConfirmDialogPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../BasicTouchEvent"),s=l("../../../keypad/KeypadNavigator"),r=cc._decorator,o=r.ccclass,e=r.property,n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.onLoad=function(){var a=this;this.mCancelBtnCallback=new d.default(function(){a.mCloseCallback&&a.mCloseCallback(),a.node.destroy()}),this.mCancelBtn.node.on(cc.Node.EventType.TOUCH_END,this.mCancelBtnCallback.click,this.mCancelBtnCallback),this.mConfirmBtnCallback=new d.default(function(){a.mConfirmCallback&&a.mConfirmCallback(),a.node.destroy()}),this.mConfirmBtn.node.on(cc.Node.EventType.TOUCH_END,this.mConfirmBtnCallback.click,this.mConfirmBtnCallback),this.node.on(cc.Node.EventType.TOUCH_END,function(u){u.stopPropagation()},this),s.default.getInstance().pushDialog(this.node)},i.prototype.onDestroy=function(){s.default.getInstance().popDialog(this.node)},i.prototype.setCloseCallback=function(a){this.mCloseCallback=a},i.prototype.start=function(){this.mContentNode.getComponent(cc.Animation).play("gold_pop_out")},i.prototype.setContent=function(a){this.mContentLabel.string=a},i.prototype.setConfirmCallback=function(a){this.mConfirmCallback=a},__decorate([e(cc.Label)],i.prototype,"mContentLabel",void 0),__decorate([e(cc.Button)],i.prototype,"mCancelBtn",void 0),__decorate([e(cc.Button)],i.prototype,"mConfirmBtn",void 0),__decorate([e(cc.Node)],i.prototype,"mContentNode",void 0),i=__decorate([o],i)}(cc.Component);m.default=n,cc._RF.pop()},{"../../../keypad/KeypadNavigator":"KeypadNavigator","../BasicTouchEvent":"BasicTouchEvent"}],UnlockHotSongTask:[function(l,P,m){"use strict";cc._RF.push(P,"8c7aemydqRPZLkNwlChaUJt","UnlockHotSongTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./TaskItemImpl"),s=l("../TaskItem"),r=l("../../Network/Protocol/StorageUtil"),o=l("../../../config/LSKey"),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.update=function(){r.default.read(o.default.HOT_SONG_UNLOCKED)==="true"?(this.currentStep=this.totalStep,this.status=s.TaskStatus.TASK_STATUS_SUCCESS):(this.currentStep=0,this.status=s.TaskStatus.TASK_STATUS_DOING)},t}(d.default);m.default=e,cc._RF.pop()},{"../../../config/LSKey":"LSKey","../../Network/Protocol/StorageUtil":"StorageUtil","../TaskItem":"TaskItem","./TaskItemImpl":"TaskItemImpl"}],UnlockPlugin:[function(l,P,m){"use strict";cc._RF.push(P,"173039RLsRAmZ0NRhbMCOp9","UnlockPlugin"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./IPlugin"),s=l("../PlayerMgr"),r=l("../../Core/GameDefine"),o=l("../Level"),e=l("../../../util/Dictionary"),n=l("../../DB/DBMgr"),t=l("../../UI/MusicLevelDataLoader"),i=function(a){function u(){return a!==null&&a.apply(this,arguments)||this}return __extends(u,a),u.prototype.update=function(c){},u.prototype.onLevelChanged=function(c){for(var p=1;p<=c;p++)t.MusicLevelDataLoader.getMusicLevelsByLv(p).forEach(function(h){if(h.levelUnlock.unlockType==o.eUnlockType.UNLOCK_TYPE_LV){var f=s.default.Ins().getLevelRecord(h.id);f==null&&(f=s.default.Ins().addNewRecord(h.id,h.music.mid,h.levelUnlock.unlockType)),f.mUnlockFlag==r.eUnlockFlag.FLAG_LOCKED_LV&&(f.mUnlockFlag=r.eUnlockFlag.FLAG_UNLOCK_LV,f.clearData())}});s.default.Ins().saveRecord()},u.prototype.getKind=function(){return d.default.Plugin_Unlock},u.prototype.getGoldLevel=function(){var c=n.default.Ins().getData(n.eDataBase.eDB_Level).csvGetRows("Lock","2"),p=new e.Dictionary;return p&&c.forEach(function(h){var f=h[0],g=parseInt(f);p.put(f,g)}),p},u.prototype.getDiamondLevel=function(){var c=n.default.Ins().getData(n.eDataBase.eDB_Level).csvGetRows("Lock","13"),p=new e.Dictionary;return p&&c.forEach(function(h){var f=h[0],g=parseInt(f);p.put(f,g)}),p},u.prototype.getPayLevel=function(){var c=n.default.Ins().getData(n.eDataBase.eDB_Level),p=c.csvGetRows("Lock","13"),h=new e.Dictionary;return p.forEach(function(f){var g=f[0],_=parseInt(g);h.put(g,_)}),(p=c.csvGetRows("Lock","2")).forEach(function(f){var g=f[0],_=parseInt(g);h.put(g,_)}),h},u}(d.default);m.default=i,cc._RF.pop()},{"../../../util/Dictionary":"Dictionary","../../Core/GameDefine":"GameDefine","../../DB/DBMgr":"DBMgr","../../UI/MusicLevelDataLoader":"MusicLevelDataLoader","../Level":"Level","../PlayerMgr":"PlayerMgr","./IPlugin":"IPlugin"}],UnlockProcessor:[function(l,P,m){"use strict";cc._RF.push(P,"41834arjttDr6obKJBbHmac","UnlockProcessor"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../PlayerMgr"),s=l("../../Core/GameDefine"),r=l("../../UI/MusicLevelDataLoader"),o=l("../../../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=l("../Level"),n=l("../EventBus"),t=l("../NotifyEvent"),i=function(){function a(){}return a.unlockByVideo=function(u,c){var p=r.MusicLevelDataLoader.getChoicenessAllItemInfo(),h=d.default.Ins();if(p&&0<p.length)for(var f=0;f<p.length;f++){var g=p[f];if(g&&g.musicId==c&&g.mGameComsume&&g.mGameComsume.isActive(o.MGUser.getCurrentServerTime())){var _=h.getLevelRecordByMid(c);return _==null&&(_=h.addNewRecord(u,c,e.eUnlockType.UNLOCK_TYPE_VIDEO)),_.mUnlockFlag=s.eUnlockFlag.FLAG_UNLOCKED,_.clearData(),h.saveRecord(),n.default.fire(t.default.NOTIFY_MUSIC_LIBRARY_UPDATE,g.musicId),n.default.fire(t.default.UPDATE_MUSIC_LIST_HEIGHT,1),!0}}return!1},a.unlockByShare=function(u,c){var p=r.MusicLevelDataLoader.getChoicenessAllItemInfo(),h=d.default.Ins();if(p&&0<p.length)for(var f=0;f<p.length;f++){var g=p[f];if(g&&g.musicId==c&&g.mGameComsume&&g.mGameComsume.isActive(o.MGUser.getCurrentServerTime())){var _=h.getLevelRecordByMid(c);return _==null&&(_=h.addNewRecord(u,c,e.eUnlockType.UNLOCK_TYPE_DIAMOND)),_.mUnlockFlag=s.eUnlockFlag.FLAG_UNLOCK_SHARE,_.clearData(),h.saveRecord(),!0}}return!1},a.unlockByDiamond=function(u,c){var p=d.default.Ins(),h=p.getLevelRecordByMid(c);return h==null&&(h=p.addNewRecord(u,c,e.eUnlockType.UNLOCK_TYPE_DIAMOND)),h.mUnlockFlag==s.eUnlockFlag.FLAG_LOCKED_DIAMOND&&(h.mUnlockFlag=s.eUnlockFlag.FLAG_UNLOCK_DIAMOND,h.clearData(),p.saveRecord(),!0)},a.unlockByGold=function(u,c){var p=d.default.Ins(),h=p.getLevelRecordByMid(c);return h==null&&(h=p.addNewRecord(u,c,e.eUnlockType.UNLOCK_TYPE_GOLD)),h.mUnlockFlag==s.eUnlockFlag.FLAG_LOCKED_GOLD&&(h.mUnlockFlag=s.eUnlockFlag.FLAG_UNLOCK_GOLD,h.clearData(),p.saveRecord(),!0)},a.unlockByVIP=function(){var u=d.default.Ins();u.updateLvUnlockRecord();var c=u.getLevelRecords();if(c){for(var p=0,h=c.getPairs();p<h.length;p++){var f=h[p].value;f.mId<s.Constant.DIAMONDSONG_STARTID&&f.mId!=s.Constant.TRIAL_SONG_ID&&(f.mUnlockFlag=s.eUnlockFlag.FLAG_UNLOCK_BY_VIP)}return u.saveRecord(),!0}return!1},a.TAG="UnlockProcessor => ",a}();m.default=i,cc._RF.pop()},{"../../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../Core/GameDefine":"GameDefine","../../UI/MusicLevelDataLoader":"MusicLevelDataLoader","../EventBus":"EventBus","../Level":"Level","../NotifyEvent":"NotifyEvent","../PlayerMgr":"PlayerMgr"}],UpdateContent:[function(l,P,m){"use strict";cc._RF.push(P,"1ae9282sS1BoZ+Tn4VDtE11","UpdateContent"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/MusicLevelDataLoader"),s=l("../../util/SceneMusicUtil"),r=l("../../util/PU"),o=l("../../util/SUtil"),e=l("../UI/GameEntraScene/MusicLib/NormalMusicCardItemPrefb"),n=l("../../util/QQReport"),t=l("../keypad/KeypadNavigator"),i=cc._decorator,a=i.ccclass,u=i.property,c=function(p){function h(){var f=p!==null&&p.apply(this,arguments)||this;return f.mRootNode=null,f.backBtn=null,f.musicItemPrefab=null,f.musicItemContainer=null,f.mTitleSprite=null,f}return __extends(h,p),h.prototype.onLoad=function(){var f=this;this.mRootNode.on(cc.Node.EventType.TOUCH_START,function(_){_.stopPropagation()}),this.backBtn.node.on(cc.Node.EventType.TOUCH_END,function(){s.default.playBtnBeats(),f.mCompleteListener()});var g=d.MusicLevelDataLoader.getItemInfoByNeedLv(this.mUserLevel);console.error("[gwj.onLoad] itemInfos.length="+g.length),this.mItemSize=g.length,n.QQReport.reportUnLockSong(this.mItemSize),g.forEach(function(_){var y=cc.instantiate(f.musicItemPrefab),S=y.getComponent(e.default);S.setData(_,void 0,!0),S.setSource(e.default.SOURCE_UPDATE_CONTENT),f.musicItemContainer.node.addChild(y)}),this.node.on(cc.Node.EventType.TOUCH_START,function(_){_.stopPropagation()},this),this.initParticleSystem(),this.resetCloseBtnPosition(),t.default.getInstance().pushDialog(this.node,"UpdateContent")},h.prototype.onDestroy=function(){t.default.getInstance().popDialog(this.node,"UpdateContent")},h.prototype.resetCloseBtnPosition=function(){this.mItemSize==4&&(o.SUtil.ins().isPuTong()?o.SUtil.ins().toBottomByPercent(this.backBtn,5.5):o.SUtil.ins().isLiuHai()?o.SUtil.ins().toBottomByPercent(this.backBtn,14.2):o.SUtil.ins().isQuanMian()&&o.SUtil.ins().toBottomByPercent(this.backBtn,11.9))},h.prototype.initParticleSystem=function(){if(r.default.particalSystemCompat){var f=this.node.getChildByName("particles"),g=f.getChildByName("particle_red").addComponent(cc.ParticleSystem);g.playOnLoad=!0,g.file=r.default.getResourcePath("resources/particle/particle_unlock_red.plist");var _=f.getChildByName("particle_green").addComponent(cc.ParticleSystem);_.playOnLoad=!0,_.file=r.default.getResourcePath("resources/particle/particle_unlock_green.plist");var y=f.getChildByName("particle_blue").addComponent(cc.ParticleSystem);y.playOnLoad=!0,y.file=r.default.getResourcePath("resources/particle/particle_unlock_blue.plist")}},h.prototype.start=function(){var f=this.node.getComponent(cc.Animation);this.mItemSize==3?f.play("update_content_open"):this.mItemSize==4&&f.play("update_content_open_2")},h.prototype.setData=function(f){this.mUserLevel=f},h.prototype.setListener=function(f){this.mCompleteListener=f},__decorate([u(cc.Node)],h.prototype,"mRootNode",void 0),__decorate([u(cc.Button)],h.prototype,"backBtn",void 0),__decorate([u(cc.Prefab)],h.prototype,"musicItemPrefab",void 0),__decorate([u(cc.Layout)],h.prototype,"musicItemContainer",void 0),__decorate([u(cc.Sprite)],h.prototype,"mTitleSprite",void 0),h=__decorate([a],h)}(cc.Component);m.default=c,cc._RF.pop()},{"../../util/PU":"PU","../../util/QQReport":"QQReport","../../util/SUtil":"SUtil","../../util/SceneMusicUtil":"SceneMusicUtil","../UI/GameEntraScene/MusicLib/NormalMusicCardItemPrefb":"NormalMusicCardItemPrefb","../UI/MusicLevelDataLoader":"MusicLevelDataLoader","../keypad/KeypadNavigator":"KeypadNavigator"}],UpdateDialog:[function(l,P,m){"use strict";cc._RF.push(P,"84b7dYzcH5CUbpDAGeaJLxk","UpdateDialog"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=l("../../util/SceneMusicUtil"),r=l("../../util/SceneMusicMgr"),o=l("../UI/GameEntraScene/BasicTouchEvent"),e=l("../../util/PU"),n=l("../../util/QQReport"),t=l("../keypad/KeypadNavigator"),i=cc._decorator,a=i.ccclass,u=i.property,c=function(p){function h(){var f=p!==null&&p.apply(this,arguments)||this;return f.mRootNode=null,f.levelLabel=null,f.updateContentBtn=null,f.goldLabel=null,f.mUpdateContentBtnClick=null,f}return __extends(h,p),h.prototype.onLoad=function(){var f=this;this.levelLabel.string=this.mUserLevelId+"",this.mUpdateContentBtnClick=new o.default(function(){f.updateContentBtnClick()}),this.updateContentBtn.node.on(cc.Node.EventType.TOUCH_END,this.mUpdateContentBtnClick.click,this.mUpdateContentBtnClick);var g=d.default.Ins().getDBRow(d.eDataBase.eDB_Lv,this.mUserLevelId+"").getRewarGold();this.goldLabel.string="x "+g,this.node.on(cc.Node.EventType.TOUCH_START,function(_){_.stopPropagation()},this),n.QQReport.reportGradeUpdate(),t.default.getInstance().pushDialog(this.node,"UpdateDialog")},h.prototype.onDestroy=function(){t.default.getInstance().popDialog(this.node,"UpdateDialog")},h.prototype.updateContentBtnClick=function(){var f=this;this.mRootNode.on(cc.Node.EventType.TOUCH_START,function(_){_.stopPropagation()}),r.default.stop(r.default.NAME_UPGRADE_PAGE),s.default.playBtnBeats(),r.default.play(r.default.NAME_MUSIC_LIST,r.default.PATH_MUSIC_LIST,!1);var g=this.updateContentBtn.getComponent(cc.Animation);g.on("finished",function(){f.mCompleteListener()},this),g.play("reward_click")},h.prototype.start=function(){this.playAnim()},h.prototype.playAnim=function(){var f=this,g=this.node.getComponent(cc.Animation);g.play("level_up"),g.on("finished",function(){r.default.play(r.default.NAME_UPGRADE_PAGE,r.default.PATH_UPGRADE_PAGE,!1),f.playParticleSystem()},this)},h.prototype.playParticleSystem=function(){if(e.default.particalSystemCompat){var f=this.node.getChildByName("left_particle"),g=f.getChildByName("p_green").addComponent(cc.ParticleSystem);g.playOnLoad=!0,g.file=e.default.getResourcePath("resources/particle/particle_levelupgreen_l.plist");var _=f.getChildByName("p_yellow").addComponent(cc.ParticleSystem);_.playOnLoad=!0,_.file=e.default.getResourcePath("resources/particle/particle_levelupyellow_l.plist");var y=this.node.getChildByName("right_particle"),S=y.getChildByName("p_blue").addComponent(cc.ParticleSystem);S.playOnLoad=!0,S.file=e.default.getResourcePath("resources/particle/particle_levelupblue_r.plist");var I=y.getChildByName("p_red").addComponent(cc.ParticleSystem);I.playOnLoad=!0,I.file=e.default.getResourcePath("resources/particle/particle_levelupred_r.plist")}},h.prototype.setData=function(f,g,_,y){this.mUserLevelId=f,this.mMusicId=g,this.mMusicName=_,this.mScore=y},h.prototype.setListener=function(f){this.mCompleteListener=f},__decorate([u(cc.Node)],h.prototype,"mRootNode",void 0),__decorate([u(cc.Label)],h.prototype,"levelLabel",void 0),__decorate([u(cc.Button)],h.prototype,"updateContentBtn",void 0),__decorate([u(cc.Label)],h.prototype,"goldLabel",void 0),h=__decorate([a],h)}(cc.Component);m.default=c,cc._RF.pop()},{"../../util/PU":"PU","../../util/QQReport":"QQReport","../../util/SceneMusicMgr":"SceneMusicMgr","../../util/SceneMusicUtil":"SceneMusicUtil","../DB/DBMgr":"DBMgr","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../keypad/KeypadNavigator":"KeypadNavigator"}],UserAuthorizePopupPrefab:[function(l,P,m){"use strict";cc._RF.push(P,"2f588E9VlxANIDBlVYr0IPJ","UserAuthorizePopupPrefab"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../social/WXHelper"),s=l("./BasicTouchEvent"),r=l("../../../infoc/m_p2_Uaction"),o=l("../UserInfoBtnManager"),e=cc._decorator,n=e.ccclass,t=e.property,i=function(a){function u(){var c=a!==null&&a.apply(this,arguments)||this;return c.mLayout=null,c.cancel_btn=null,c.open_btn=null,c.mCancelBtnClickCallback=null,c.mOpenBtnClickCallback=null,c}return __extends(u,a),u.prototype.setCloseCallback=function(c){this.closeCallback=c},u.prototype.setAuthorizeCallback=function(c){this.authorizeCallback=c},u.prototype.onLoad=function(){var c=this;this.node.on(cc.Node.EventType.TOUCH_START,function(p){p.stopPropagation()}),this.initEvent(),this.mUserInfoBtn=o.UserInfoBtnManager.getInstance().createOnAvator(function(){c.authorizeCallback&&c.authorizeCallback()})},u.prototype.initEvent=function(){var c=this;this.mOpenBtnClickCallback=new s.default(function(){c.openBtnClick()}),this.open_btn.node.on(cc.Node.EventType.TOUCH_END,this.mOpenBtnClickCallback.click,this.mOpenBtnClickCallback),this.mCancelBtnClickCallback=new s.default(function(){c.cancelBtnClick()}),this.cancel_btn.node.on(cc.Node.EventType.TOUCH_END,this.mCancelBtnClickCallback.click,this.mCancelBtnClickCallback)},u.prototype.start=function(){this.mLayout.getComponent(cc.Animation).play("user_authorize_popup")},u.prototype.openBtnClick=function(){var c=this;r.default.report(0,r.default.ACTION_CLICK_PERMISSION_DIALOG_AVATOR_AGREE),d.WXHelper.openAuthorize(function(p){c.authorizeCallback&&(p==d.WXHelper.AUTHORIZE_OPEN&&r.default.report(0,r.default.ACTION_OPEN_PERMISSION_SUCC_AVATOR),c.authorizeCallback())})},u.prototype.cancelBtnClick=function(){this.mUserInfoBtn&&(this.mUserInfoBtn.destroy(),this.mUserInfoBtn=null),this.closeCallback&&this.closeCallback()},__decorate([t(cc.Node)],u.prototype,"mLayout",void 0),__decorate([t(cc.Button)],u.prototype,"cancel_btn",void 0),__decorate([t(cc.Button)],u.prototype,"open_btn",void 0),u=__decorate([n],u)}(cc.Component);m.default=i,cc._RF.pop()},{"../../../infoc/m_p2_Uaction":"m_p2_Uaction","../../../social/WXHelper":"WXHelper","../UserInfoBtnManager":"UserInfoBtnManager","./BasicTouchEvent":"BasicTouchEvent"}],UserHelperCM:[function(l,P,m){"use strict";cc._RF.push(P,"9a2d1OZMrBAjqqb0DJZD8+u","UserHelperCM"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGUserHelper"),s=l("../../../MGUtils/TypeDefinition"),r=l("../../../../scripts/business/keypad/KeypadUtil"),o=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.getServiceUrl=function(){return r.default.isOversea()?n.SERVER_ADDRESS_URL_OVERSEA:e.prototype.isDebug.call(this)?n.SERVER_ADDRESS_URL_TEST:n.SERVER_ADDRESS_URL},n.prototype.getUrlToRegister=function(){return this.getServiceUrl()+n.REGISTER_URL},n.prototype.getUrlToUploadUserInfo=function(){return this.getServiceUrl()+n.UPLOAD_USERR_INFO_URL},n.prototype.getUrlToUploadUserLevel=function(){return this.getServiceUrl()+n.UPLOAD_USERR_LEVEL_URL},n.prototype.getUrlToGetCurrentServerRealTime=function(){return this.getServiceUrl()+n.GET_SERVER_REAL_TIMES},n.prototype.getUserBaseInfoInner=function(t){var i=new s.UserBasicInfo;i.nickName="CMPlay",i.avatarUrl="",d.default.baseInfoCallback(!0,i,t)},n.prototype.getUserLoginInfoInner=function(t){var i=this;CMPlay.login(function(a,u,c,p,h){if(a){console.log("\u767B\u5F55\u6210\u529F "+h);var f=new s.UserLoginInfo;f.playerId=u,f.token=c,f.isNewUser=p==1,e.prototype.setTimeDifference.call(i,new Date().getTime()-1e3*h),d.default.loginInfoCallback(!0,f,t)}else console.log("\u767B\u5F55\u5931\u8D25"),d.default.loginInfoCallback(!1,null,t)})},n.prototype.createUserBaseInfoButton=function(t){return null},n.prototype.getIsUserBaseAuth=function(t){t.complete&&t.complete(!0),t.success&&t.success()},n.SERVER_ADDRESS_URL_TEST="https://pianotiles-minigame.cmcm.com/",n.SERVER_ADDRESS_URL="https://minigame.cmcm.com/",n.SERVER_ADDRESS_URL_OVERSEA="https://h5game_oversea.cmcm.com/",n.REGISTER_URL="warty/auth/register/cm",n.UPLOAD_USERR_INFO_URL="warty/auth/userinfo/cm",n.UPLOAD_USERR_LEVEL_URL="warty/userinfo/save_level",n.GET_SERVER_REAL_TIMES="common/time",n}(d.default);m.default=o,cc._RF.pop()},{"../../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../../../MGUtils/TypeDefinition":"TypeDefinition","../Logic/MGUserHelper":"MGUserHelper"}],UserHelperFB:[function(l,P,m){"use strict";cc._RF.push(P,"fba07N1uTxFuqzotZOe74m/","UserHelperFB"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGUserHelper"),s=l("../../../MGUtils/TypeDefinition"),r=l("../../../MGUtils/FBHelper"),o=l("../../../MGUtils/NetworkUtils"),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getServiceUrl=function(){return n.prototype.isDebug.call(this)?t.SERVER_ADDRESS_URL_TEST:t.SERVER_ADDRESS_URL},t.prototype.getUrlToRegister=function(){return this.getServiceUrl()+t.REGISTER_URL},t.prototype.getUrlToUploadUserInfo=function(){return""},t.prototype.getUrlToUploadUserLevel=function(){return this.getServiceUrl()+t.UPLOAD_USERR_LEVEL_URL},t.prototype.getUrlToGetCurrentServerRealTime=function(){return this.getServiceUrl()+t.GET_SERVER_REAL_TIMES},t.prototype.getUserBaseInfoInner=function(i){var a=new s.UserBasicInfo;a.nickName=r.FBHelper.getNickName(),a.avatarUrl=r.FBHelper.getPhoto(),d.default.baseInfoCallback(!0,a,i)},t.prototype.getUserLoginInfoInner=function(i){var a=this;this.getUserBaseInfoInner({success:function(u){var c={photo:u.avatarUrl,name:u.nickName,country:"china"};o.default.request({platform:n.prototype.getPlatformType.call(a),url:a.getUrlToRegister(),data:{user_info:c,playerid:r.FBHelper.getID(),gameid:n.prototype.getGameId,timestamp:new Date().getTime()},header:{"content-type":"text/plain;charset=UTF-8"},method:o.default.METHOD_POST,dataType:"json",checkAuthorization:!1,success:function(p){if(p&&p.status==0&&p.result){var h=new s.UserLoginInfo;h.playerId=p.result.playerid,h.token=p.result.token,n.prototype.setTimeDifference.call(a,new Date().getTime()-1e3*p.timestamp),d.default.loginInfoCallback(!0,h,i)}else d.default.loginInfoCallback(!1,null,i)},fail:function(p,h){d.default.loginInfoCallback(!1,null,i)}})}})},t.SERVER_ADDRESS_URL_TEST="https://instantgame.cmcm.com/",t.SERVER_ADDRESS_URL="https://instantgame.cmcm.com/",t.REGISTER_URL="auth/register/fb",t.UPLOAD_USERR_LEVEL_URL="warty/userinfo/save_level",t.GET_SERVER_REAL_TIMES="common/time",t}(d.default);m.default=e,cc._RF.pop()},{"../../../MGUtils/FBHelper":"FBHelper","../../../MGUtils/NetworkUtils":"NetworkUtils","../../../MGUtils/TypeDefinition":"TypeDefinition","../Logic/MGUserHelper":"MGUserHelper"}],UserHelperGameHall:[function(l,P,m){"use strict";cc._RF.push(P,"77299LSDqZKnp6aWszwT5oj","UserHelperGameHall"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(o,e,n,t,i){return s.call(this,o,e,n,t,i)||this}return __extends(r,s),r.prototype.getUrlToRegister=function(){return this.getServiceUrl()+r.REGISTER_URL},r.REGISTER_URL="warty/auth/register/gamehall",r}(l("./UserHelperH5SDK").default);m.default=d,cc._RF.pop()},{"./UserHelperH5SDK":"UserHelperH5SDK"}],UserHelperH5SDK:[function(l,P,m){"use strict";cc._RF.push(P,"79881fbHXRIR6WaZzUQKygD","UserHelperH5SDK"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./UserHelperWX"),s=l("../../../MGUtils/TypeDefinition"),r=l("../../../MGUtils/NetworkUtils"),o=l("../Logic/MGUserHelper"),e=l("../../../MGUtils/MGLog"),n=function(t){function i(a,u,c,p,h){var f=t.call(this,a,u,c,p,h)||this;return window.H5SDK.init({wxappid:c,gameVersion:p}),f}return __extends(i,t),i.prototype.getUrlToRegister=function(){return this.getServiceUrl()+i.REGISTER_URL},i.prototype.getUserLoginInfoInner=function(a){var u=this;window.H5SDK.checkLogin({success:function(c){if(e.default.l("[UserHelperH5SDK] checkLogin success"),c){var p=c.userInfo;p&&p.h5game_openid&&p.h5sdk_sessionid?r.default.request({platform:t.prototype.getPlatformType.call(u),url:u.getUrlToRegister(),data:{gameid:t.prototype.getGameId.call(u),h5game_openid:p.h5game_openid,h5sdk_sessionid:p.h5sdk_sessionid,encrypted_data:c.encryptedData,iv:c.iv},header:{"content-type":"application/json"},method:r.default.METHOD_POST,dataType:"json",checkAuthorization:!1,success:function(h){if(h&&h.status==0&&h.result){var f=new s.UserLoginInfo;f.playerId=h.result.playerid,f.token=h.result.token;var g=h.result.new_user,_=0;g!=null&&g!=null&&0<(""+g).length&&(isNaN(+(""+g))||(_=+(""+g))),f.isNewUser=_==1,t.prototype.setTimeDifference.call(u,new Date().getTime()-1e3*h.timestamp),o.default.loginInfoCallback(!0,f,a)}else o.default.loginInfoCallback(!1,null,a)},fail:function(h,f){o.default.loginInfoCallback(!1,null,a)}}):o.default.loginInfoCallback(!1,null,a)}else o.default.loginInfoCallback(!1,null,a)},fail:function(){e.default.e("[UserHelperH5SDK] checkLogin failed"),o.default.loginInfoCallback(!1,null,a)}})},i.REGISTER_URL="warty/auth/register/h5sdk",i}(d.default);m.default=n,cc._RF.pop()},{"../../../MGUtils/MGLog":"MGLog","../../../MGUtils/NetworkUtils":"NetworkUtils","../../../MGUtils/TypeDefinition":"TypeDefinition","../Logic/MGUserHelper":"MGUserHelper","./UserHelperWX":"UserHelperWX"}],UserHelperQQ:[function(l,P,m){"use strict";cc._RF.push(P,"4081aQhnMxLy4Fzeghqgo4I","UserHelperQQ"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGUserHelper"),s=l("../../../MGUtils/TypeDefinition"),r=l("../../../MGUtils/QQHelper"),o=l("../../../MGUtils/NetworkUtils"),e=l("../../../../scripts/business/keypad/KeypadUtil"),n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getServiceUrl=function(){return e.default.isOversea()?i.SERVER_ADDRESS_URL_OVERSEA:t.prototype.isDebug.call(this)?i.SERVER_ADDRESS_URL_TEST:i.SERVER_ADDRESS_URL},i.prototype.getUrlToRegister=function(){return this.getServiceUrl()+i.REGISTER_URL},i.prototype.getUrlToUploadUserInfo=function(){return this.getServiceUrl()+i.UPLOAD_USERR_INFO_URL},i.prototype.getUrlToGetCurrentServerRealTime=function(){return this.getServiceUrl()+i.GET_SERVER_REAL_TIMES},i.prototype.getUrlToUploadUserLevel=function(){return this.getServiceUrl()+i.UPLOAD_USERR_LEVEL_URL},i.prototype.getUserBaseInfoInner=function(a){r.QQHelper.getHeadEx(function(u){r.QQHelper.getNick(function(c){var p=new s.UserBasicInfo;p.nickName=c,p.avatarUrl=u,d.default.baseInfoCallback(!0,p,a)})})},i.prototype.getUserLoginInfoInner=function(a){var u=this;r.QQHelper.fetchOpenKey({success:function(c){o.default.request({platform:t.prototype.getPlatformType.call(u),url:u.getUrlToRegister(),data:{appid:t.prototype.getAppId.call(u),gameid:t.prototype.getGameId.call(u),openid:GameStatusInfo.openId,openkey:c,timestamp:new Date().getTime()},header:{"content-type":"application/json"},method:o.default.METHOD_POST,dataType:"json",checkAuthorization:!1,success:function(p){if(p&&p.status==0&&p.result){var h=new s.UserLoginInfo;h.playerId=p.result.playerid,h.token=p.result.token,h.sid=p.result.qqid,t.prototype.setTimeDifference.call(u,new Date().getTime()-1e3*p.timestamp),d.default.loginInfoCallback(!0,h,a)}else d.default.loginInfoCallback(!1,null,a)},fail:function(p,h){d.default.loginInfoCallback(!1,null,a)}})},fail:function(){d.default.loginInfoCallback(!1,null,a)}})},i.SERVER_ADDRESS_URL_TEST="https://pianotiles-minigame.cmcm.com/",i.SERVER_ADDRESS_URL="https://minigame.cmcm.com/",i.SERVER_ADDRESS_URL_OVERSEA="https://h5game_oversea.cmcm.com/",i.REGISTER_URL="warty/auth/register/mqq",i.UPLOAD_USERR_INFO_URL="warty/auth/userinfo/mqq",i.UPLOAD_USERR_LEVEL_URL="warty/userinfo/save_level",i.GET_SERVER_REAL_TIMES="common/time",i}(d.default);m.default=n,cc._RF.pop()},{"../../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../../../MGUtils/NetworkUtils":"NetworkUtils","../../../MGUtils/QQHelper":"QQHelper","../../../MGUtils/TypeDefinition":"TypeDefinition","../Logic/MGUserHelper":"MGUserHelper"}],UserHelperWX:[function(l,P,m){"use strict";cc._RF.push(P,"9829b3K5ONLKqtJ/dKw6Wha","UserHelperWX"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/MGUserHelper"),s=l("../../../MGUtils/TypeDefinition"),r=l("../../../MGUtils/WeappHelper"),o=l("../../../MGUtils/NetworkUtils"),e=l("../../../../scripts/business/keypad/KeypadUtil"),n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getServiceUrl=function(){return e.default.isOversea()?i.SERVER_ADDRESS_URL_OVERSEA:t.prototype.isDebug.call(this)?i.SERVER_ADDRESS_URL_TEST:i.SERVER_ADDRESS_URL},i.prototype.getUrlToRegister=function(){return this.getServiceUrl()+i.REGISTER_URL},i.prototype.getUrlToUploadUserInfo=function(){return this.getServiceUrl()+i.UPLOAD_USERR_INFO_URL},i.prototype.getUrlToGetCurrentServerRealTime=function(){return this.getServiceUrl()+i.GET_SERVER_REAL_TIMES},i.prototype.getUrlToUploadUserLevel=function(){return this.getServiceUrl()+i.UPLOAD_USERR_LEVEL_URL},i.prototype.getUserBaseInfoInner=function(a){r.WeappHelper.getUserBasicInfo({success:function(u){d.default.baseInfoCallback(!0,u,a)},fail:function(){d.default.baseInfoCallback(!1,null,a)}})},i.prototype.getUserLoginInfoInner=function(a){var u=this;r.WeappHelper.login({success:function(c){o.default.request({platform:t.prototype.getPlatformType.call(u),url:u.getUrlToRegister(),data:{jscode:c,gameid:t.prototype.getGameId.call(u)},header:{"content-type":"application/json"},method:o.default.METHOD_POST,dataType:"json",checkAuthorization:!1,success:function(p){if(p&&p.status==0&&p.result){var h=new s.UserLoginInfo;h.playerId=p.result.playerid,h.token=p.result.token,t.prototype.setTimeDifference.call(u,new Date().getTime()-1e3*p.timestamp),d.default.loginInfoCallback(!0,h,a)}else d.default.loginInfoCallback(!1,null,a)},fail:function(p,h){d.default.loginInfoCallback(!1,null,a)}})},fail:function(){d.default.loginInfoCallback(!1,null,a)}})},i.SERVER_ADDRESS_URL_TEST="https://pianotiles-minigame.cmcm.com/",i.SERVER_ADDRESS_URL="https://minigame.cmcm.com/",i.SERVER_ADDRESS_URL_OVERSEA="https://h5game_oversea.cmcm.com/",i.REGISTER_URL="warty/auth/register/wx",i.UPLOAD_USERR_INFO_URL="warty/auth/userinfo/wx",i.UPLOAD_USERR_LEVEL_URL="warty/userinfo/save_level",i.GET_SERVER_REAL_TIMES="common/time",i}(d.default);m.default=n,cc._RF.pop()},{"../../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../../../MGUtils/NetworkUtils":"NetworkUtils","../../../MGUtils/TypeDefinition":"TypeDefinition","../../../MGUtils/WeappHelper":"WeappHelper","../Logic/MGUserHelper":"MGUserHelper"}],UserHelperWeb:[function(l,P,m){"use strict";cc._RF.push(P,"512a4wDhklM478vIjTPIvE7","UserHelperWeb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../MGUtils/TypeDefinition"),s=l("../Logic/MGUserHelper"),r=l("../../../MGBasic/scripts/Logic/MGBasicEntrance"),o=l("./UserLoginHelperWeb"),e=l("../../../../scripts/business/keypad/KeypadUtil"),n=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getUrlToUploadUserLevel=function(){return""},i.prototype.getServiceUrl=function(){return e.default.isOversea()?i.SERVER_ADDRESS_URL_OVERSEA:t.prototype.isDebug.call(this)?i.SERVER_ADDRESS_URL_TEST:i.SERVER_ADDRESS_URL},i.prototype.getUrlToRegister=function(){return this.getServiceUrl()+"warty/auth/h5_auth"},i.prototype.getUrlToUploadUserInfo=function(){return""},i.prototype.getUrlToGetCurrentServerRealTime=function(){return""},i.prototype.getUserBaseInfoInner=function(a){var u=new d.UserBasicInfo;u.nickName="superman",s.default.baseInfoCallback(!0,u,a)},i.prototype.getUserLoginInfoInner=function(a){var u=this,c=new d.UserLoginInfo;c.playerId="",c.token="";var p=r.MGBasic.getStorage("web_playid");p&&0<p.length?c.playerId=p:o.UserLoginHelperWeb.login({gameId:t.prototype.getGameId.call(this),success:function(h){var f=new d.UserLoginInfo;f.playerId=h.playerId,f.token=h.token,f.isNewUser=h.isNewUser,t.prototype.setTimeDifference.call(u,new Date().getTime()-1e3*h.timestamp),s.default.loginInfoCallback(!0,f,a)},fail:function(){s.default.loginInfoCallback(!1,null,a)}})},i.SERVER_ADDRESS_URL_TEST="https://pianotiles-minigame.cmcm.com/",i.SERVER_ADDRESS_URL="https://minigame.cmcm.com/",i.SERVER_ADDRESS_URL_OVERSEA="https://h5game_oversea.cmcm.com/",i}(s.default);m.default=n,cc._RF.pop()},{"../../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../../../MGBasic/scripts/Logic/MGBasicEntrance":"MGBasicEntrance","../../../MGUtils/TypeDefinition":"TypeDefinition","../Logic/MGUserHelper":"MGUserHelper","./UserLoginHelperWeb":"UserLoginHelperWeb"}],UserInfoBtnManager:[function(l,P,m){"use strict";cc._RF.push(P,"d2357yQ4flK3KlloolePEGO","UserInfoBtnManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../modules/MGUtils/WeappHelper"),s=l("../../util/Utility"),r=l("../../util/PU"),o=function(){function e(){this.mIsUserBaseAuth=!0}return e.getInstance=function(){return e.mInstance||(e.mInstance=new e),e.mInstance},e.prototype.init=function(){var n=this;r.default.isWeiXin()&&0<=s.Utility.compareVersion(r.default.SDKVersion,"2.0.1")&&d.WeappHelper.getIsUserBaseAuth({complete:function(t){t||(n.mIsUserBaseAuth=!1)}})},e.prototype.createOnGameScene=function(n){var t=this;if(!this.mIsUserBaseAuth&&r.default.isWeiXin()&&0<=s.Utility.compareVersion(r.default.SDKVersion,"2.0.1")){var i=r.default.windowWidth/720,a=d.WeappHelper.createUserInfoButton({type:"text",text:"",withCredentials:!1,style:{left:209*i,top:r.default.windowHeight/2+91*i,width:302*i,height:74*i,backgroundColor:"#00000000"}});a.onTap(function(u){u&&u.userInfo&&(t.mIsUserBaseAuth=!0),a.destroy(),n()}),a.show()}},e.prototype.createOnAvator=function(n){var t=this;if(this.mIsUserBaseAuth)return null;var i=null;if(r.default.isWeiXin()&&0<=s.Utility.compareVersion(r.default.SDKVersion,"2.0.1")){var a=r.default.windowWidth/720;(i=d.WeappHelper.createUserInfoButton({type:"text",text:"",withCredentials:!1,style:{left:371*a,top:r.default.windowHeight/2+93*a,width:204*a,height:74*a,backgroundColor:"#00000000"}})).onTap(function(u){u&&u.userInfo&&(t.mIsUserBaseAuth=!0),i.destroy(),n()}),i.show()}return i},e.prototype.createOnFightInvite=function(n){var t=this;if(this.mIsUserBaseAuth)return null;var i=null;if(r.default.isWeiXin()&&0<=s.Utility.compareVersion(r.default.SDKVersion,"2.0.1")){var a=r.default.windowWidth/720;(i=d.WeappHelper.createUserInfoButton({type:"text",text:"",withCredentials:!1,style:{left:183*a,top:r.default.windowHeight/2+134*a,width:354*a,height:116*a,backgroundColor:"#00000000"}})).onTap(function(u){u&&u.userInfo&&(t.mIsUserBaseAuth=!0),i.destroy(),n()}),i.show()}return i},e}();m.UserInfoBtnManager=o,cc._RF.pop()},{"../../../modules/MGUtils/WeappHelper":"WeappHelper","../../util/PU":"PU","../../util/Utility":"Utility"}],UserInfoLevelMgr:[function(l,P,m){"use strict";cc._RF.push(P,"a73fdtE/ytN+oE07xKsX/bh","UserInfoLevelMgr"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../base/Log"),s=function(){function o(){}return o.queryUserInfoLevel=function(e,n){var t=this;d.default.i(o.TAG+" queryUserInfoLevel playerId = "+e),cmg.platform.queryUserInfoLevel(e,function(i,a){d.default.i(o.TAG+" queryUserInfoLevel result = "+i+", data = ",a),i&&a.data?n(!0,t.convertServerUserInfoLevel(a.data)):n&&n(!1,null)})},o.convertServerUserInfoLevel=function(e){var n=new r;return e&&(n.nickname=e.nickname,n.avatarUrl=e.avatar_url,n.gender=e.gender,n.city=e.city,n.province=e.province,n.country=e.country,n.level=e.user_level,n.hornors=e.honors),n},o.TAG="[UserInfoMgr]=====>>>",o}();m.default=s;var r=function(){};m.UserInfoLevel=r,cc._RF.pop()},{"../../base/Log":"Log"}],UserInfoManager:[function(l,P,m){"use strict";cc._RF.push(P,"7e7bdOTDNtPi7wDZsONVQRl","UserInfoManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../Logic/Plugin/PluginMgr"),s=l("../Logic/Plugin/IPlugin"),r=l("../Logic/PlayerMgr"),o=l("../Logic/EventBus"),e=l("../Logic/NotifyEvent"),n=l("../Logic/MoneySystem");(function(t){var i=function(){function u(){}return u.getUserInfo=function(){var c=new a,p=r.default.Ins();return c.level=p.getUserLevel(),c.hp=p.getHP(),c.diamond=p.getUserDiamond(),c.coin=p.getUserCoin(),c.experience=r.default.Ins().getUserCurrentExp(),c},u.buyCoinByDiamond=function(c){return n.MoneySystem.costDiamondToCoin(c)},u.buyHpByCoin=function(c){return n.MoneySystem.costCoinToHp(c)},u.shareGetHp=function(c){return Number.isNaN(c)&&(c=2),n.MoneySystem.increaseHp(c)},u.shareGetDiamond=function(c){return Number.isNaN(c)&&(c=6),n.MoneySystem.increaseDiamond(c)},u.isAutoReviveHp=function(){return d.default.Ins().getPluginEx(s.default.Plugin_Energy).mRecovery},u.registerHpReviveListener=function(c,p){o.default.register(e.default.HP_REVIVE,c,p)},u.unRegisterHpReviveListener=function(c,p){o.default.remove(e.default.HP_REVIVE,c,p)},u}();t.UserInfoManager=i;var a=function(){this.diamond=0,this.coin=0,this.level=1,this.experience=0,this.hp=-1};t.Data=a})(m.User||(m.User={})),cc._RF.pop()},{"../Logic/EventBus":"EventBus","../Logic/MoneySystem":"MoneySystem","../Logic/NotifyEvent":"NotifyEvent","../Logic/PlayerMgr":"PlayerMgr","../Logic/Plugin/IPlugin":"IPlugin","../Logic/Plugin/PluginMgr":"PluginMgr"}],UserLoginHelperWeb:[function(l,P,m){"use strict";cc._RF.push(P,"434c80LGapMcI22eIDYFiqp","UserLoginHelperWeb"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../MGUtils/MGSha1"),s=l("../../../MGBasic/scripts/LocalStorageHelplerWeb"),r=l("../../../../scripts/business/keypad/KeypadUtil"),o=function(){function n(){}return n.getLoginURL=function(){return r.default.isOversea()?n.URL_LOGIN_OVERSEA:n.IS_DEBUG?n.URL_LOGIN_TEST:n.URL_LOGIN},n.getBindURL=function(){return r.default.isOversea()?n.URL_BIND_OVERSEA:n.IS_DEBUG?n.URL_BIND_TEST:n.URL_BIND},n.login=function(t){var i=this,a=n.getStorage(n.KEY_WEB_PLAYID),u=n.getGameToken(),c=n.getIsAnonymous();console.log("cmToken: "+u+" isAnonymous: "+c);var p=function(){n.doLogin({gameId:t.gameId,cmToken:u,isAnonymous:c,success:function(h){t.success(h)},fail:function(){t.fail&&t.fail()}})};a&&0<a.length?n.doBind({gameId:t.gameId,cmToken:u,playid:a,isAnonymous:1,success:function(){i.setStorage(n.KEY_WEB_PLAYID,""),i.setStorage(n.KEY_WEB_TOKEN,""),p()},fail:function(){t.fail&&t.fail()}}):p()},n.doBind=function(t){n.request({url:n.getBindURL(),data:{gameid:t.gameId,playerid:t.playid,cm_token:t.cmToken,is_anonymous:t.isAnonymous,timestamp:Date.now()},header:{"content-type":"application/json"},method:"POST",dataType:"json",checkAuthorization:!1,success:function(i){i&&i.status==0?t.success():t.fail()},fail:function(i,a){t.fail()}})},n.doLogin=function(t){n.request({url:n.getLoginURL(),data:{gameid:t.gameId,cm_token:t.cmToken,is_anonymous:t.isAnonymous,timestamp:Date.now()},header:{"content-type":"application/json"},method:"POST",dataType:"json",checkAuthorization:!1,success:function(i){if(i&&i.status==0&&i.result){var a=new e;a.playerId=i.result.playerid,a.token=i.result.token;var u=i.result.is_new_user,c=0;u!=null&&u!=null&&0<(""+u).length&&(isNaN(+(""+u))||(c=+(""+u))),a.isNewUser=c==1,a.timestamp=i.timestamp,t.success(a)}else t.fail()},fail:function(i,a){t.fail()}})},n.setStorage=function(t,i){return s.LocalStorageHelperWeb.setItem(t,i),!0},n.getStorage=function(t){return s.LocalStorageHelperWeb.getItem(t)},n.request=function(t){console.log("[UserLoginHelperWeb] request, parameter:",t);var i=new XMLHttpRequest;for(var a in i.open(t.method,t.url),t.header)i.setRequestHeader(a,t.header[a]);i.onreadystatechange=function(){if(i.readyState==4)if(i.status==200){if(console.log("[UserLoginHelperWeb] request, success:",i.responseText),t.token&&t.checkAuthorization&&!n.checkAuthorization(i.getAllResponseHeaders(),i.responseText,t.token))return void t.fail(i.status,i.responseText);if(t.success)if(t.dataType=="json")try{t.success(JSON.parse(i.responseText))}catch(c){t.success(i.responseText)}else t.success(i.responseText)}else console.log("[UserLoginHelperWeb] request, fail:",i.responseText),t.fail&&t.fail(i.status,i.responseText)};var u=t.data?JSON.stringify(t.data):"";i.send(u)},n.checkAuthorization=function(t,i,a){return t&&(t.Authorization||t.authorization)?"CMCM "+d.hex_hmac_sha1(a,i)===(t.Authorization?t.Authorization:t.authorization)||(console.error("[UserLoginHelperWeb] checkAuthorization, fail: Invalid authorization."),!1):(console.error("[UserLoginHelperWeb] checkAuthorization, fail: Authorization is empty."),!1)},n.getGameToken=function(){return cc.sys.platform==cc.sys.DESKTOP_BROWSER?"debug_234f2a66-106d-45e9-9595-3b8c35f7fd24":window.getGameToken?window.getGameToken():""},n.getIsAnonymous=function(){return window.isAnonymous?window.isAnonymous()?1:0:1},n.setIsDebug=function(t){n.IS_DEBUG=t},n.KEY_WEB_PLAYID="web_playid",n.KEY_WEB_TOKEN="web_token",n.URL_LOGIN="https://minigame.cmcm.com/warty/auth/h5_login",n.URL_LOGIN_TEST="https://pianotiles-minigame.cmcm.com/warty/auth/h5_login",n.URL_LOGIN_DEV="http://10.12.198.70/warty/auth/h5_login",n.URL_LOGIN_OVERSEA="https://h5game_oversea.cmcm.com/warty/auth/h5_login",n.URL_BIND="https://minigame.cmcm.com/warty/auth/h5_bind",n.URL_BIND_TEST="https://pianotiles-minigame.cmcm.com/warty/auth/h5_bind",n.URL_BIND_OVERSEA="https://h5game_oversea.cmcm.com/warty/auth/h5_bind",n.IS_DEBUG=!1,n}();m.UserLoginHelperWeb=o;var e=function(){this.playerId="",this.token="",this.isNewUser=!1,this.timestamp=0};m.LoginData=e,cc._RF.pop()},{"../../../../scripts/business/keypad/KeypadUtil":"KeypadUtil","../../../MGBasic/scripts/LocalStorageHelplerWeb":"LocalStorageHelplerWeb","../../../MGUtils/MGSha1":"MGSha1"}],UserLvManager:[function(l,P,m){"use strict";cc._RF.push(P,"61f305OXEtIUaemypw+YY41","UserLvManager"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../DB/DBMgr"),s=function(){function o(){}return o.getUserLv=function(e){var n=new r,t=d.default.Ins().getDBRow(d.eDataBase.eDB_Lv,e+"");return n.lv=t.getLv(),n.exp=t.getExp(),n.rewarGold=t.getRewarGold(),n.rewarLift=t.getRewarLife(),n},o}();m.UserLvManager=s;var r=function(){};m.UserLv=r,cc._RF.pop()},{"../DB/DBMgr":"DBMgr"}],UserUtil:[function(l,P,m){"use strict";cc._RF.push(P,"3f220IEuL5IYLV4BFAE2fHJ","UserUtil"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.parseUserToString=function(r){return r==null?"":cc.js.formatStr("%s_%s_%s_%s_%s_%s_%s",r.hp,r.coin,r.diamond,r.curUserExp,r.level,r.lastRecovery,r.lastLevelMid)},s.parseToUser=function(r,o){if(o!=null&&r!=null&&0<r.length){var e=r.split("_");e==null&&e.length!=6||(o.hp=parseInt(e[0]),o.coin=parseInt(e[1]),o.diamond=parseInt(e[2]),o.curUserExp=parseInt(e[3]),o.level=parseInt(e[4]),o.lastRecovery=parseInt(e[5]),o.lastLevelMid=parseInt(e[6]))}},s.getCurSysTime=function(){return Date.now()/1e3},s.parseLevelRecordToStr=function(r){if(r){var o="";return r.forEach(function(e){o+=e.mId+"@",o+=e.mMid+"@",o+=e.mBestScore+"@",o+=e.mBestStar+"@",o+=e.mBestSpeed+"@",o+=e.mUnlockFlag+"@",o+="*"}),o}return""},s}();m.default=d,cc._RF.pop()},{}],User:[function(l,P,m){"use strict";cc._RF.push(P,"af25bhxod9NF5ZQ/lIP3xUU","User"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){this.diamond=0,this.coin=0,this.level=1,this.hp=-1,this.lastRecovery=0,this.curUserExp=0,this.lastLevelMid=-1};m.default=d,cc._RF.pop()},{}],Utility:[function(l,P,m){"use strict";cc._RF.push(P,"9cbf2s3pyNM7YcR2f/pkQY0","Utility"),Object.defineProperty(m,"__esModule",{value:!0}),function(d){var s;d.compareVersion=function(u,c){for(var p=u.split("."),h=c.split("."),f=Math.max(p.length,h.length),g=0;g<f;g++){var _=g<p.length?parseInt(p[g]):0,y=g<h.length?parseInt(h[g]):0;if(_!==y)return y<_?1:-1}return 0},d.evil=function(u,c){return new Function(u+"return "+c)()},d.getRandom=function(u,c){var p=1/(c-u+1),h=Math.random();return 1<=h&&(h=.9999),u+Math.floor(h/p)},d.getRandomValue=function(){return Math.random()},d.getRandomFromArray=function(u,c){var p=u,h=c;h=h>p.length?p.length:h;for(var f=[].concat(p),g=[],_=0;_<h;_++){var y=Math.floor(Math.random()*f.length);g.push(f[y]),f.splice(y,1)}return g},d.getRandoms=function(u,c,p){for(var h=[],f=u;f<=c;++f)h.push(f);var g=[];for(f=Math.min(h.length,p)-1;0<=f;--f){var _=this.getRandom(0,h.length-1);g.push(h[_]),h.splice(_,1)}return g},(s=d.BLOCKTYPE||(d.BLOCKTYPE={}))[s.SHORT=0]="SHORT",s[s.LONG=1]="LONG",s[s.MONEY=2]="MONEY",s[s.GIFT=3]="GIFT",s[s.BEGIN=4]="BEGIN",s[s.MISTAKE=5]="MISTAKE",s[s.TWINS=6]="TWINS",s[s.BLANKPAUSE=7]="BLANKPAUSE",s[s.OBSTACLE=8]="OBSTACLE",s[s.PROPERTY=9]="PROPERTY";var r,o,e,n,t=function(){function u(c,p){this.music=!1,this.accurate=!1,this.music=c,this.accurate=p}return u.c=[new u(!0,!1),new u(!0,!1),new u(!1,!0),new u(!1,!0),new u(!0,!1),new u(!1,!1),new u(!0,!1),new u(!1,!0),new u(!1,!0),new u(!1,!0)],u}();d.BLOCKTYPECHARACTER=t,(r=d.SEGMENTTYPE||(d.SEGMENTTYPE={}))[r.NONE=0]="NONE",r[r.BEGIN=1]="BEGIN",r[r.MEDIUM=2]="MEDIUM",r[r.DESTINATION=3]="DESTINATION",(o=d.GAMESTAGE||(d.GAMESTAGE={}))[o.NONE=0]="NONE",o[o.GUIDE=1]="GUIDE",o[o.MUSIC=2]="MUSIC",o[o.MONEY=3]="MONEY",o[o.INFINITE=4]="INFINITE",(e=d.SKINSWITCHESULT||(d.SKINSWITCHESULT={}))[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.CANCELED=2]="CANCELED",e[e.TIMEOUT=3]="TIMEOUT",e[e.EXISTINSTANCE=4]="EXISTINSTANCE",(n=d.AbnormalReason||(d.AbnormalReason={}))[n.NONE=0]="NONE",n[n.BACKGROUND=1]="BACKGROUND",n[n.DISMISSGAME=2]="DISMISSGAME",n[n.WAITENDTIMEOUT=3]="WAITENDTIMEOUT",n[n.WAITSTARTTIMEOUT=4]="WAITSTARTTIMEOUT",n[n.OFFLINE=5]="OFFLINE",n[n.ENEMYOFFLINE=6]="ENEMYOFFLINE";var i=function(u,c,p){this.identifier=u,this.clientX=c,this.clientY=p};d.TouchItem=i;var a=function(){function u(c,p,h,f){this.xMax=0,this.yMax=0,this.xCenter=0,this.yCenter=0,this._x=0,this._y=0,this._width=0,this._height=0,this.set(c,p,h,f)}return Object.defineProperty(u.prototype,"x",{get:function(){return this._x},set:function(c){this._x=c,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"y",{get:function(){return this._y},set:function(c){this._y=c,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"width",{get:function(){return this._width},set:function(c){this._width=c,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"height",{get:function(){return this._height},set:function(c){this._height=c,this.update()},enumerable:!0,configurable:!0}),u.prototype.center=function(){return new cc.Vec2(this.xCenter,this.yCenter)},u.prototype.clone=function(){return new u(this.x,this.y,this.width,this.height)},u.prototype.copy=function(c){this.set(c.x,c.y,c.width,c.height)},u.prototype.set=function(c,p,h,f){this._x=c,this._y=p,this._width=h,this._height=f,this.update()},u.prototype.contains=function(c,p){return c>=this._x&&c<=this._x+this._width&&p>=this._y&&p<=this._y+this._height},u.prototype.update=function(){this.xMax=this._x+this._width,this.xCenter=this._x+this._width/2,this.yMax=this._y+this._height,this.yCenter=this._y+this._height/2},u}();d.Rect=a}(m.Utility||(m.Utility={})),cc._RF.pop()},{}],Utils:[function(l,P,m){"use strict";cc._RF.push(P,"925bcJQHz5MSbxrNN0T2Zof","Utils"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../scripts/base/Log"),s=function(){function r(){}return r.shareAppMessageWX=function(o,e,n,t){cc.sys.platform==cc.sys.WECHAT_GAME&&wx.shareAppMessage({title:o,imageUrl:e,query:n,success:function(i){t&&t({result:!0,shareTickets:i.shareTickets,groupMsgInfos:i.groupMsgInfos})},fail:function(){t&&t({result:!1})}})},r.shareAppMessageH5sdk=function(o,e,n,t){cc.sys.platform==cc.sys.WECHAT_GAME&&window.H5SDK.shareMessage({shareInfo:{title:o,imageUrl:e,query:n},success:function(i){console.warn("AdapterH5SDK::shareAppMessage => success"),t&&t({result:!0,shareTickets:i.shareTickets,groupMsgInfos:i.groupMsgInfos})},fail:function(i){console.warn("AdapterH5SDK::shareAppMessage => fail"),t&&t({result:!1})}})},r.shareAppMessageCM=function(o,e,n,t){var i=isNaN(Number(e))?0:Number(e);window.onShare(o,i,n,t)},r.addPlayIdToShareQuery=function(o){return cc.sys.platform===cc.sys.QQ_PLAY&&this.sPlayerId!=null&&(o&&0<o.length?o+="&playerid="+this.sPlayerId:o="playerid="+this.sPlayerId),o},r.shareAppMessageQQ=function(o,e,n,t,i){var a=this;n&&0<n.length?n+="&src="+t:n="src="+t,n=this.addPlayIdToShareQuery(n),e.startsWith("GameSandBox")||e.startsWith("GameRes")?(console.log("[SocialHelper] shareAppMessage shareImageUrl = "+e+", shareTitle: "+o+", shareQuery: "+n),cmg.platform.uploadFile(e,function(u,c){console.log("[SocialHelper] shareAppMessage  = , upload result : "+u+", path : "+c),u==0?a.oldShareToArkQQ(o,c,n,function(p,h){i({result:p,shareTickets:h?["qq_shareTickets"]:null})}):i({result:!1})})):(console.log("[SocialHelper] shareToArk = , shareImageUrl = "+e+", shareTitle: "+o+", shareQuery: "+n),this.oldShareToArkQQ(o,e,n,function(u,c){i({result:u,shareTickets:c?["qq_shareTickets"]:null})}))},r.shareAppMessageWithDialog=function(o,e,n,t,i,a){console.log("[SocialHelper] shareAppMessageWithDialog title:"+o+" imgurl:"+e+" imglocal:"+n),t&&0<t.length?t+="&src="+i:t="src="+i;var u={summary:o,picUrl:e,extendInfo:t,localPicPath:n};console.log("[SocialHelper] shareAppMessageWithDialog QQVer="+GameStatusInfo.QQVer),BK.QQ.share(u,function(c,p,h){console.log("[SocialHelper] shareAppMessageWithDialog retCode:"+c+" shareDest:"+p+" isFirstShare:"+h),c==0?(p==0?console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3QQ"):p==1?console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3\u7A7A\u95F4"):p==2?console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3\u5FAE\u4FE1"):p==3&&console.log("[SocialHelper] shareAppMessageWithDialog \u6210\u529F\u5206\u4EAB\u81F3\u670B\u53CB\u5708"),a({result:!0,dest:p})):(c==1?console.log("[SocialHelper] shareAppMessageWithDialog \u5206\u4EAB\u5931\u8D25"+c):c==2?console.log("[SocialHelper] shareAppMessageWithDialog \u5206\u4EAB\u5931\u8D25\uFF0C\u7528\u6237\u53D6\u6D88\u5206\u4EAB\uFF1A"+c):console.log("[SocialHelper] shareAppMessageWithDialog \u5206\u4EAB\u5931\u8D25\uFF0C\u672A\u77E5\u9519\u8BEF\uFF1A"+c),a({result:!1,dest:p}))})},r.oldShareToArkApiQQ=function(o,e,n,t,i,a){BK.Misc.compQQVersion(GameStatusInfo.QQVer,"7.5.8")?(BK.QQ._oldShareToArk(o,e,n,t,i),a(!0,!0)):BK.QQ._oldShareToArk(o,e,n,t,i,function(u,c,p){console.log("[SocialHelper] oldShareToArk errCode: "+d.default.toJsonString(u)+" cmd: "+d.default.toJsonString(c)+" data: "+d.default.toJsonString(p)),p.ret===0?p.aioType===4||p.aioType===5?(a(!0,!0),console.log("[SocialHelper] \u5206\u4EAB\u5230\u7FA4 ")):(a(!0,!1),console.log("[SocialHelper] \u5206\u4EAB\u7ED9\u4E2A\u4EBA ")):(a(!1,!1),console.log("[SocialHelper] \u5206\u4EAB\u5931\u8D25 "))}.bind(this))},r.oldShareToArkQQ=function(o,e,n,t){this.oldShareToArkApiQQ(0,o,e,!0,n,t)},r}();m.Utils=s,cc._RF.pop()},{"../../../scripts/base/Log":"Log"}],VersionBean:[function(l,P,m){"use strict";cc._RF.push(P,"a8d6aos3kFFHIbdvNy87OP5","VersionBean"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../util/StringUtil"),s=l("../util/NumberUtil"),r=l("./IChecker"),o=l("../../modules/MGUser/scripts/Logic/MGUserEntrance"),e=l("../LogicPlatform/PlatformProxy"),n=function(){function t(){this.localVer="",this.localMd5="",this.downloadTime=0,this.enableTime=0,this.endTime=0,this.platform="",this.serverVer="",this.key="",this.url="",this.md5="",this.type="",this.size=0,this.downloadTime=0,this.localVer="",this.key="",this.md5="",this.url="",this.size=0}return t.prototype.isNeedUpdate=function(){return!!e.default.Ins().needDownloadRes()&&(this.serverVer!=this.localVer||this.md5!=this.localMd5)},t.prototype.isInTime=function(){var i=this.enableTime==0||this.enableTime<=o.MGUser.getCurrentServerTime(),a=this.endTime==0||this.endTime>=o.MGUser.getCurrentServerTime();return i&&a},t.prototype.isDownload=function(){return!e.default.Ins().needDownloadRes()||!d.StringUtil.isEmpty(this.localVer)&&!d.StringUtil.isEmpty(this.localMd5)},t.prototype.getUniqueKey=function(){return this.type+"-"+this.key},t.prototype.clearLocalInfo=function(){this.localMd5="",this.localVer=""},t.prototype.isPlatformValid=function(i){return!!d.StringUtil.isEmpty(this.platform)||-1<this.platform.split("|").indexOf(i)},t.parseFormStr=function(i){if(d.StringUtil.isEmpty(i))return null;var a=null;try{a=JSON.parse(i)}catch(u){}return t.parseFromJson(a)},t.parseFromJson=function(i){if(!i)return null;var a=new t;return a.localVer=r.default.populateStr(i.localVer),a.serverVer=r.default.populateStr(i.serverVer),a.downloadTime=s.default.parseNum(i.downloadTime),a.localMd5=r.default.populateStr(i.localMd5),a.key=r.default.populateStr(i.key),a.url=r.default.populateStr(i.url),a.md5=r.default.populateStr(i.md5),a.type=r.default.populateStr(i.type),a.enableTime=s.default.parseNum(i.enableTime),a.platform=r.default.populateStr(i.platform),a.endTime=s.default.parseNum(i.endTime),a},t}();m.default=n,cc._RF.pop()},{"../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../LogicPlatform/PlatformProxy":"PlatformProxy","../util/NumberUtil":"NumberUtil","../util/StringUtil":"StringUtil","./IChecker":"IChecker"}],VipData:[function(l,P,m){"use strict";cc._RF.push(P,"27eaaEnJexKAYWUlWckwaUs","VipData"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./CsvRowData"),s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.findId=function(n){return this.find("Level",n)},e.prototype.getRow=function(){return new r},e}(l("./BaseCsvFile").default);m.VipData=s;var r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getLevel=function(){return this.getInt("Level")},e.prototype.getName=function(){return this.getString("Name")},e.prototype.getPrice=function(){return this.getInt("Price")},e.prototype.getUnlockLevelSong=function(){return this.getInt("UnlockLevelSong")},e.prototype.getUnlockHotSong=function(){return this.getInt("UnlockHotSong")},e.prototype.getHotSongDiscount=function(){return this.getInt("HotSongDiscount")},e.prototype.getSkinDiscount=function(){return this.getInt("SkinDiscount")},e.prototype.getEnergyTimeScale=function(){return this.getInt("EnergyTimeScale")},e.prototype.getMaxEnergy=function(){return this.getInt("MaxEnergy")},e.prototype.getAvatarDecorate=function(){return this.getInt("AvatarDecorate")},e.prototype.getOnetimeReward=function(){return this.getString("OnetimeReward")},e.prototype.getDailyReward=function(){return this.getString("DailyReward")},e}(d.default);m.VipRow=r,cc._RF.pop()},{"./BaseCsvFile":"BaseCsvFile","./CsvRowData":"CsvRowData"}],WXHelper:[function(l,P,m){"use strict";cc._RF.push(P,"13f663S5VlPRoZiZyCkdo1Z","WXHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.postMessageToOpenData=function(r,o){cc.sys.platform==cc.sys.WECHAT_GAME&&(this.sWXOpenDataContext==null&&(this.sWXOpenDataContext=wx.getOpenDataContext()),this.sWXOpenDataContext.postMessage({message:r,parameter:o}))},s.shareAppMessage=function(r,o,e,n){cc.sys.platform==cc.sys.WECHAT_GAME&&wx.shareAppMessage({title:r,imageUrl:o,query:e,success:function(t){n&&n(!0,t.shareTickets,t.groupMsgInfos)},fail:function(){n&&n(!1,null,null)}})},s.getAuthorize=function(r){cc.sys.platform==cc.sys.WECHAT_GAME?wx.getSetting({success:function(o){var e=o.authSetting;e["scope.userInfo"]===!0?r(s.AUTHORIZE_OPEN):e["scope.userInfo"]===!1?r(s.AUTHORIZE_REFUSE):r(s.AUTHORIZE_NOT_ASK)},fail:function(){r(s.AUTHORIZE_FAIL)}}):r(s.AUTHORIZE_FAIL)},s.openAuthorize=function(r){cc.sys.platform==cc.sys.WECHAT_GAME?wx.openSetting({success:function(o){var e=o.authSetting;e["scope.userInfo"]===!0?r(s.AUTHORIZE_OPEN):e["scope.userInfo"]===!1?r(s.AUTHORIZE_REFUSE):r(s.AUTHORIZE_NOT_ASK)},fail:function(){r(s.AUTHORIZE_FAIL)}}):r(s.AUTHORIZE_FAIL)},s.setUserCloudStorage=function(r,o){r&&r.length!==0?wx.setUserCloudStorage({KVDataList:r,success:function(){o&&o(!0)},fail:function(){o&&o(!1)}}):o&&o(!1)},s.removeUserCloudStorage=function(r,o){r&&r.length!==0?wx.removeUserCloudStorage({keyList:r,success:function(){o&&o(!0)},fail:function(){o&&o(!1)}}):o&&o(null)},s.saveTmpImgToAlbum=function(r,o,e,n){wx.saveImageToPhotosAlbum({filePath:r,success:function(){o&&o()},fail:function(){e&&e()},complete:function(){n&&n()}})},s.AUTHORIZE_OPEN=2,s.AUTHORIZE_NOT_ASK=1,s.AUTHORIZE_REFUSE=0,s.AUTHORIZE_FAIL=-1,s}();m.WXHelper=d,cc._RF.pop()},{}],WXMusicContext:[function(l,P,m){"use strict";cc._RF.push(P,"73ec4lnIIFBFbbkjzBvmpI0","WXMusicContext"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(r){this.index=0,this.ended=!0,this.timestamp=0,this.index=r,this.context=wx.createInnerAudioContext(),this.context.volume=1,this.context.onError(this._onError.bind(this)),this.context.onEnded(this._onEnd.bind(this)),this.context.onStop(this._onStop.bind(this))}return s.prototype.getIndex=function(){return this.index},s.prototype.getPath=function(){return""},s.prototype.play=function(){},s.prototype.playA=function(r,o){this.ended=!1,this.context.src=r,this.context.play(),this.context.volume=o,this.timestamp=Date.now()},s.prototype.playB=function(r,o){this.ended=!1,this.context.pause(),this.context.src=r,this.context.play(),this.context.volume=o,this.timestamp=Date.now()},s.prototype.stop=function(){this.context.stop()},s.prototype.pause=function(){this.context.pause()},s.prototype.seek=function(r){this.context.seek(r)},s.prototype.getTimeStamp=function(){return this.timestamp},s.prototype.isEnded=function(){return this.ended},s.prototype._onError=function(){this.ended=!0,this.timestamp=0},s.prototype._onEnd=function(){this.ended=!0,this.timestamp=0},s.prototype._onStop=function(){this.ended=!0,this.timestamp=0},s}();m.default=d,cc._RF.pop()},{}],WatchAdsTask:[function(l,P,m){"use strict";cc._RF.push(P,"72a16HOTjdPW48YQR6LgLxA","WatchAdsTask"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.initTask=function(o){},r}(l("../SkinTaskItem").default);m.default=d,cc._RF.pop()},{"../SkinTaskItem":"SkinTaskItem"}],WeappHelper:[function(l,P,m){"use strict";cc._RF.push(P,"d43ca52mt5FrLo1ZIRXHC83","WeappHelper"),Object.defineProperty(m,"__esModule",{value:!0});var d,s=l("./MGLog"),r=l("./TypeDefinition"),o=function(){function e(){}return e.postMessageToOpenData=function(n,t){this.sWXOpenDataContext==null&&(this.sWXOpenDataContext=wx.getOpenDataContext()),this.sWXOpenDataContext.postMessage({message:n,parameter:t})},e.onShow=function(n){n&&wx.onShow(n)},e.offShow=function(n){n&&wx.offShow(n)},e.onHide=function(n){n&&wx.onHide(n)},e.offHide=function(n){n&&wx.offHide(n)},e.getLaunchOptionsSync=function(){return wx.getLaunchOptionsSync()},e.createCanvas=function(){return wx.createCanvas()},e.networkRequest=function(n){n&&(s.default.l("WeappHelper networkRequest:"+n.url,n),wx.request({url:n.url,data:n.data,header:n.header,method:n.method,dataType:n.dataType,success:function(t){s.default.l("WeappHelper networkRequest, complete:",n,t),t?t.statusCode!=200?(s.default.e("WeappHelper networkRequest, fail: Code:"+t.statusCode),n.fail&&n.fail(t.statusCode,t)):t.data?n.success&&n.success(t.statusCode,t.data,t.header):n.fail&&n.fail(t.statusCode,t):n&&n.fail(-1,null)},fail:function(){s.default.e("WeappHelper networkRequest, fail",n),n.fail&&n.fail(-1,null)}}))},e.login=function(n){wx.login({success:function(t){n.success&&n.success(t.code)},fail:n.fail})},e.getUserBasicInfo=function(n){if(n){var t=new r.UserBasicInfo;wx.getUserInfo({success:function(i){i&&i.userInfo&&n.success?(t.nickName=i.userInfo.nickName,t.avatarUrl=i.userInfo.avatarUrl,t.language=i.userInfo.language,t.gender=i.userInfo.gender,t.country=i.userInfo.country,t.province=i.userInfo.province,t.city=i.userInfo.city,n.success(t)):n.fail&&n.fail()},fail:function(){n.fail&&n.fail()}})}},e.showShareMenu=function(n){wx.showShareMenu(n)},e.onShareAppMessage=function(n){wx.onShareAppMessage(function(t,i){return{title:n.title,imageUrl:n.imageUrl,query:n.query,success:n.success,fail:n.fail}})},e.shareAppMessage=function(n){wx.shareAppMessage(n)},e.setStorage=function(n){d.setStorage(n)},e.setStorageSync=function(n,t){d.setStorageSync(n,t)},e.getStorage=function(n){d.getStorage(n)},e.getStorageSync=function(n){return d.getStorageSync(n)},e.removeStorage=function(n){d.removeStorage(n)},e.removeStorageSync=function(n){d.removeStorageSync(n)},e.getSystemInfo=function(n){wx.getSystemInfo(n)},e.createUserInfoButton=function(n){return wx.createUserInfoButton(n)},e.getIsUserBaseAuth=function(n){wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]===!0?(n.complete&&n.complete(!0),n.success&&n.success()):(n.complete&&n.complete(!1),n.fail&&n.fail())},fail:function(){n.complete&&n.complete(!1),n.fail&&n.fail()}})},e.getFileSystemManager=function(){return wx.getFileSystemManager()},e.navigateToMiniProgram=function(n){if(n&&wx.navigateToMiniProgram)return wx.navigateToMiniProgram(n)},e}();m.WeappHelper=o,function(e){function n(){return cc.sys.platform==cc.sys.WECHAT_GAME}var t=n()?wx.getFileSystemManager():null;t||(t={});var i=[0,0,10];function a(c,p){return function(h){var f=0,g=h.fail;h.fail=function(S){if(f<i.length){var I=i[f];f++;var v=h.filePath||h.dirPath||h.path||h.oldPath||h.srcPath||h.url||"",C=h.newPath||h.destPath||h.tempFilePath||"";if(1<f&&s.default.e(p+" \u7B2C "+f+" \u6B21\u5C1D\u8BD5:"+v+" : "+C),I<=0)return c(h);setTimeout(function(){return c(h)},I)}else g&&g(S)};var _=0,y=h.complete;return y&&(h.complete=function(S){(S.errMsg.indexOf("fail")===-1||i.length<=_)&&y(S),_++}),c(h)}}function u(c,p){return function(h,f,g){for(var _=p+" error ! "+h,y=0;y<i.length;y++)try{return c(h,f,g)}catch(S){_=S,s.default.e(p+" \u7B2C "+(y+1)+" \u6B21\u5C1D\u8BD5: arg0="+h+"; arg1="+f+"; arg2="+g)}throw _}}e.getFileInfo=a(t.getFileInfo,"fs.getFileInfo"),e.getSavedFileList=a(t.getSavedFileList,"fs.getSavedFileList"),e.mkdir=a(t.mkdir,"fs.mkdir"),e.saveFile=a(t.saveFile,"fs.saveFile"),e.readFile=a(t.readFile,"fs.readFile"),e.writeFile=a(t.writeFile,"fs.writeFile"),e.mkdir=a(t.mkdir,"fs.mkdir"),e.readdir=a(t.readdir,"fs.readdir"),e.rmdir=a(t.rmdir,"fs.rmdir"),e.access=a(t.access,"fs.access"),e.unlink=a(t.unlink,"fs.unlink"),e.stat=a(t.stat,"fs.stat"),e.rename=a(t.rename,"fs.rename"),e.copyFile=a(t.copyFile,"fs.copyFile"),e.unzip=a(t.unzip,"fs.unzip"),e.getStorage=a(n()?wx.getStorage:null,"wx.getStorage"),e.setStorage=a(n()?wx.setStorage:null,"wx.setStorage"),e.removeStorage=a(n()?wx.removeStorage:null,"wx.removeStorage"),e.readFileSync=u(t.readFileSync,"fs.readFileSync"),e.saveFileSync=u(t.saveFileSync,"fs.saveFileSync"),e.writeFileSync=u(t.writeFileSync,"fs.writeFileSync"),e.mkdirSync=u(t.mkdirSync,"fs.mkdirSync"),e.readdirSync=u(t.readdirSync,"fs.readdirSync"),e.rmdirSync=u(t.rmdirSync,"fs.rmdirSync"),e.accessSync=u(t.accessSync,"fs.accessSync"),e.unlinkSync=u(t.unlinkSync,"fs.unlinkSync"),e.statSync=u(t.statSync,"fs.statSync"),e.renameSync=u(t.renameSync,"fs.renameSync"),e.copyFileSync=u(t.copyFileSync,"fs.copyFileSync"),e.getStorageSync=u(n()?wx.getStorageSync:null,"wx.getStorageSync"),e.setStorageSync=u(n()?wx.setStorageSync:null,"wx.setStorageSync"),e.removeStorageSync=u(n()?wx.removeStorageSync:null,"wx.removeStorageSync"),e.wxFileSystemManager=t}(d=m.WXAPI||(m.WXAPI={})),cc._RF.pop()},{"./MGLog":"MGLog","./TypeDefinition":"TypeDefinition"}],WechatGameAdapter:[function(l,P,m){"use strict";cc._RF.push(P,"49cde+pPuhLnYLdxzsxsdhW","WechatGameAdapter"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./DefaultAdapter"),s=l("../../../modules/MGUtils/WeappHelper"),r=l("../../business/Logic/EventBus"),o=l("../../business/Logic/NotifyEvent"),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.needDownloadRes=function(){return!0},t.prototype.isSupportDownloadRes=function(){return!0},t.prototype.createCanvas=function(){return wx.createCanvas()},t.prototype.createImage=function(){return wx.createImage()},t.prototype.onShowListen=function(i){s.WeappHelper.onShow(i)},t.prototype.offShowListen=function(i){s.WeappHelper.offShow(i)},t.prototype.onHideListen=function(i){s.WeappHelper.onHide(i)},t.prototype.offHideListen=function(i){s.WeappHelper.offHide(i)},t.prototype.getLaunchParameter=function(){return s.WeappHelper.getLaunchOptionsSync()},t.prototype.getShareCanvas=function(){return wx.getOpenDataContext().canvas},t.prototype.getUserDataPath=function(){return wx.env.USER_DATA_PATH},t.prototype.unZip=function(i,a,u,c){a!=null&&a!=null&&a.length!=0||(a=wx.env.USER_DATA_PATH),s.WXAPI.wxFileSystemManager.unzip({zipFilePath:i,targetPath:a,success:function(){u&&u()},fail:function(p){c&&c()}})},t.prototype.downloadFile=function(i,a,u,c,p){c===void 0&&(c=0),p===void 0&&(p=!0);var h=wx.downloadFile({url:i,header:"",success:function(f){f.statusCode===404?u&&u():f.tempFilePath?a&&a(f.tempFilePath):u()},fail:function(f){u&&u()},complete:function(){}});return p&&h.onProgressUpdate(function(f){r.default.fire(o.default.LOADING_DOWNLOAD,i,f.progress/100)}),h},t.prototype.getFileSystemManager=function(){return s.WXAPI.wxFileSystemManager},t.prototype.getImageSrc=function(i){return i},t.prototype.loadImage=function(i){},t.prototype.getSharePath=function(i){return i},t.prototype.saveShareTmpFile=function(i,a){return i.toTempFilePathSync(a)},t}(d.default);m.default=e,cc._RF.pop()},{"../../../modules/MGUtils/WeappHelper":"WeappHelper","../../business/Logic/EventBus":"EventBus","../../business/Logic/NotifyEvent":"NotifyEvent","./DefaultAdapter":"DefaultAdapter"}],WelfareController:[function(l,P,m){"use strict";cc._RF.push(P,"a3f68ZAx+lI44CafdhcLNEp","WelfareController"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../../../../upgrade/VersionBean"),s=l("../../../../upgrade/IChecker"),r=l("../../../../util/NumberUtil"),o=l("../../../../config/LSKey"),e=l("../../../../upgrade/CloudMgr"),n=l("../../../../base/Log"),t=l("../../../../util/SingleWorker"),i=function(){function p(){this.mSource=p.SRC_HOME_PAGE_CLICK,this.up=new a}return p.Ins=function(){return p.s||(p.s=new p),p.s},p.prototype.init=function(h){this.up.upgradeInfo(h)},p.SRC_HOME_PAGE_CLICK=1,p.SRC_SKIN_INVITE_SHOW=2,p.SRC_HOME_INVITE_SHOW=3,p.SRC_SHOP_FIRST_PAY_AUTO_SHOW=4,p.SRC_SKIN_FIRST_PAY_SHOW=5,p.SRC_ENTER_FROM_ATTENTION=6,p.SRC_SKIN_INVITE_AUTO_SHOW=7,p.SRC_COLD_BOOT_POP=8,p.SRC_SKIN_ATTENTION_SHOW=9,p}();m.default=i;var a=function(){function p(){}return p.prototype.getOrders=function(h,f){var g=this;this.cfgMgr?f&&f(this.filterOrders(h)):this.upgradeInfo(function(){f&&f(g.filterOrders(h))})},p.prototype.filterOrders=function(h){var f=this.cfgMgr.filterData(function(g){return g&&g.order[h]&&g.type==="control"&&g.key==="welfare"&&g.isPlatformValid("cmplay")});return f&&0<f.length?f[0].order[h]:null},p.prototype.upgradeInfo=function(h){var f=this;this.cfgMgr||(this.cfgMgr=new e.default(new c("welfare-cfg",o.default.KEY_CLOUD_CFG,"https://piano-weixin-game.cmcm.com/pianotiles2/cfg/welfare.json"))),t.default.doWork("welfareController-upgradeInfo",function(){return new Promise(function(g){f.cfgMgr.request(function(){n.default.l("WELFARE",f.cfgMgr.getData()),g(!0)},function(){g(!1)})})},function(g,_){h&&h(g&&_)})},p}(),u=function(p){function h(){var f=p.call(this)||this;return f.order={},f}return __extends(h,p),h}(d.default),c=function(p){function h(){return p!==null&&p.apply(this,arguments)||this}return __extends(h,p),h.prototype.onMergeServerToLocal=function(f,g){},h.prototype.validateData=function(f){return f!=null&&f!=null},h.prototype.populateServerObj=function(f){if(!f)return null;var g=new u;if(g.serverVer=s.default.populateStr(f.ver),g.key=s.default.populateStr(f.key),g.url=s.default.populateStr(f.url),g.md5=s.default.populateStr(f.md5),g.type=s.default.populateStr(f.type),g.size=r.default.parseNum(f.size),g.enableTime=r.default.parseNum(f.enableTime),g.endTime=r.default.parseNum(f.endTime),g.platform=s.default.populateStr(f.platform),f.order)for(var _ in f.order)g.order[_]=f.order[_];return g},h.prototype.populateLocalObj=function(f){var g=new u;if(g.localVer=s.default.populateStr(f.localVer),g.serverVer=s.default.populateStr(f.serverVer),g.downloadTime=r.default.parseNum(f.downloadTime),g.localMd5=s.default.populateStr(f.localMd5),g.key=s.default.populateStr(f.key),g.url=s.default.populateStr(f.url),g.md5=s.default.populateStr(f.md5),g.type=s.default.populateStr(f.type),g.enableTime=r.default.parseNum(f.enableTime),g.endTime=r.default.parseNum(f.endTime),g.platform=s.default.populateStr(f.platform),f.order)for(var _ in f.order)g.order[_]=f.order[_];return g},h}(s.default);cc._RF.pop()},{"../../../../base/Log":"Log","../../../../config/LSKey":"LSKey","../../../../upgrade/CloudMgr":"CloudMgr","../../../../upgrade/IChecker":"IChecker","../../../../upgrade/VersionBean":"VersionBean","../../../../util/NumberUtil":"NumberUtil","../../../../util/SingleWorker":"SingleWorker"}],WorkerBase:[function(l,P,m){"use strict";cc._RF.push(P,"55084MApd1GdLUhPqxYMf46","WorkerBase"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./WorkerState"),s=l("./WorkerStateChangedEventArgs"),r=function(){function o(e){this.STATE_CHANGED="StateChanged",this._name=e,this._disabled=!1,this._canPauseAndContinue=!1,this._state=d.WorkerState.stopped}return Object.defineProperty(o.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled!==e&&(this._disabled=e)&&this.stop()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"canPauseAndContinue",{get:function(){return this._canPauseAndContinue},set:function(e){this._state,d.WorkerState.stopped,this._canPauseAndContinue=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"stage",{get:function(){return this._stage},set:function(e){this._stage=e},enumerable:!0,configurable:!0}),o.prototype.start=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return __awaiter(this,void 0,Promise,function(){var t;return __generator(this,function(i){switch(i.label){case 0:if(this._disabled||this._state!==d.WorkerState.stopped)return[2];this._state=d.WorkerState.starting,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.onStart.apply(this,e)];case 2:return i.sent(),this._state=d.WorkerState.running,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"start",d.WorkerState.running)),[3,4];case 3:return t=i.sent(),this._state=d.WorkerState.stopped,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"start",d.WorkerState.stopped,t)),console.log("--- start ex:---",t),[3,4];case 4:return[2]}})})},o.prototype.stop=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return __awaiter(this,void 0,Promise,function(){var t,i;return __generator(this,function(a){switch(a.label){case 0:if(t=this._state,this._disabled||t===d.WorkerState.stopping||t===d.WorkerState.stopped)return[2];this._state=d.WorkerState.stopping,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.onStop.apply(this,e)];case 2:return a.sent(),this._state=d.WorkerState.stopped,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"stop",d.WorkerState.stopped)),[3,4];case 3:return i=a.sent(),this._state=t,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"stop",t,i)),console.log("--- stop ex:---",i),[3,4];case 4:return[2]}})})},o.prototype.pause=function(){return __awaiter(this,void 0,Promise,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:if(e=this._state,this._disabled||!this._canPauseAndContinue)return[2];if(e!==d.WorkerState.running)return[2];this._state=d.WorkerState.pausing,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.onPause()];case 2:return t.sent(),this._state=d.WorkerState.paused,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"pause",d.WorkerState.paused)),[3,4];case 3:return n=t.sent(),this._state=e,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"pause",e,n)),console.log("--- stop pause:---",n),[3,4];case 4:return[2]}})})},o.prototype.resume=function(){return __awaiter(this,void 0,Promise,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:if(e=this._state,this._disabled||!this._canPauseAndContinue)return[2];if(e!==d.WorkerState.paused)return[2];this._state=d.WorkerState.resuming,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.onResume()];case 2:return t.sent(),this._state=d.WorkerState.running,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"resume",d.WorkerState.running)),[3,4];case 3:return n=t.sent(),this._state=e,this.onStateChanged(new s.WorkerStateChangedEventArgs(this.STATE_CHANGED,"resume",e,n)),console.log("--- stop resume:---",n),[3,4];case 4:return[2]}})})},o.prototype.onPause=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){return[2]})})},o.prototype.onResume=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){return[2]})})},o.prototype.onStateChanged=function(e){},o.prototype.setPreSpeed=function(e){},o.prototype.reset=function(){},o}();m.WorkerBase=r,cc._RF.pop()},{"./WorkerState":"WorkerState","./WorkerStateChangedEventArgs":"WorkerStateChangedEventArgs"}],WorkerStateChangedEventArgs:[function(l,P,m){"use strict";cc._RF.push(P,"5f4c4LnKNtDR4f/HzkrB9Op","WorkerStateChangedEventArgs"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s,r,o,e){this.type=s,this.actionName=r,this.state=o,this.error=e};m.WorkerStateChangedEventArgs=d,cc._RF.pop()},{}],WorkerState:[function(l,P,m){"use strict";var d;cc._RF.push(P,"5d91d09vhxDR59a3lrpMPzJ","WorkerState"),Object.defineProperty(m,"__esModule",{value:!0}),(d=m.WorkerState||(m.WorkerState={}))[d.stopped=0]="stopped",d[d.starting=1]="starting",d[d.running=2]="running",d[d.pausing=3]="pausing",d[d.paused=4]="paused",d[d.resuming=5]="resuming",d[d.stopping=6]="stopping",cc._RF.pop()},{}],base64:[function(l,P,m){"use strict";cc._RF.push(P,"720b934jBFL4pwnnvr4ST1F","base64"),m.default=function(){this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(d){var s,r,o,e,n,t,i,a="",u=0;for(d=this._utf8_encode(d);u<d.length;)e=(s=d.charCodeAt(u++))>>2,n=(3&s)<<4|(r=d.charCodeAt(u++))>>4,t=(15&r)<<2|(o=d.charCodeAt(u++))>>6,i=63&o,Number.isNaN(r)?t=i=64:Number.isNaN(o)&&(i=64),a=a+this._keyStr.charAt(e)+this._keyStr.charAt(n)+this._keyStr.charAt(t)+this._keyStr.charAt(i);return a},this.decode=function(d){var s,r,o,e,n,t,i="",a=0;for(d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");a<d.length;)s=this._keyStr.indexOf(d.charAt(a++))<<2|(e=this._keyStr.indexOf(d.charAt(a++)))>>4,r=(15&e)<<4|(n=this._keyStr.indexOf(d.charAt(a++)))>>2,o=(3&n)<<6|(t=this._keyStr.indexOf(d.charAt(a++))),i+=String.fromCharCode(s),n!=64&&(i+=String.fromCharCode(r)),t!=64&&(i+=String.fromCharCode(o));return i=this._utf8_decode(i)},this._utf8_encode=function(d){d=d.replace(/\r\n/g,"\n");for(var s="",r=0;r<d.length;r++){var o=d.charCodeAt(r);o<128?s+=String.fromCharCode(o):(127<o&&o<2048?s+=String.fromCharCode(o>>6|192):(s+=String.fromCharCode(o>>12|224),s+=String.fromCharCode(o>>6&63|128)),s+=String.fromCharCode(63&o|128))}return s},this._utf8_decode=function(d){for(var s="",r=0,o=0,e=0;r<d.length;)(o=d.charCodeAt(r))<128?(s+=String.fromCharCode(o),r++):191<o&&o<224?(e=d.charCodeAt(r+1),s+=String.fromCharCode((31&o)<<6|63&e),r+=2):(e=d.charCodeAt(r+1),c3=d.charCodeAt(r+2),s+=String.fromCharCode((15&o)<<12|(63&e)<<6|63&c3),r+=3);return s}},cc._RF.pop()},{}],"cmg_pay_client.d":[function(l,P,m){"use strict";cc._RF.push(P,"2cc6er/b+RFTL1FUz6NffVG","cmg_pay_client.d"),cc._RF.pop()},{}],"cmg_platform.d":[function(l,P,m){"use strict";cc._RF.push(P,"1f8ffGS/nJB6Y+fKq3uGKCe","cmg_platform.d"),cc._RF.pop()},{}],"cmplay.2e834.d":[function(l,P,m){"use strict";cc._RF.push(P,"7eed3ZPTapIDJdsZoD5e59L","cmplay.2e834.d"),cc._RF.pop()},{}],"configuration.d":[function(l,P,m){"use strict";cc._RF.push(P,"36ff2oc2WVMZ7hTOdv1m16d","configuration.d"),cc._RF.pop()},{}],en:[function(l,P,m){"use strict";cc._RF.push(P,"68a70EegqBHj5r4Z5wEL2XR","en"),window.i18n||(window.i18n={}),window.i18n.languages||(window.i18n.languages={}),window.i18n.languages.en={label_text:{dialog_tips:"Tips",loading_music:"Loading music resources ",headphones:"Best With Headphones ",new_song_star:"Start with your first song!",little_star:"Little Star",little_star_play:"Play",view_more:"View More",invite:"Invite",home:"Home",music_lib:"Music",achievement:"Rank",level:"Level",unlock:"required",rank:"Rank",rank_share:"Share",rank_show_group:"Challenge Friends",rank_challenge:"Challenge",friend_best_score:"Best Score",not_ranked:"Not Ranked",game_bonus_time:"Bonus Time",game_endless_tiles:"Endless tiles",game_history_top:"Best Score\uFF1A",game_select_boosters:"Select boosters",need:"Need ",to_exceed:"to beat",to_win1:"to be",champion:"Champion",runner_up:"Runner-up",second_runner_up:"Second-runner-up",get_star:" more for",get_new_best:"to creat",new_best:"New Best",revive_now:"Revive now",give_up:"Don't give up!\nLet's find your limit!",revive_free:"Revive for free",revive_diamond:"Revive now",spfuh:"Revive for free",djtg:"Skip",jthk:"can invite %s friends ",hyzl:"Revive by Inviting friends",whether_to_continue:"Keep playing with a friend's help?",wait_for_friends:"has send\uFF0Cfriend enter can help",no_share_times_tips:"Today's invitation has been used up. Come back tomorrow",no_diamond_tips:"Not enough diamonds for revive",nnnn:" ",single_champion:"You won the championship\uFF01",beat_frineds1:"You beat ",beat_frineds2:" friends",no_thanks:"No thanks",challenge_friends:"Challenge Friends",god_hand:"Champion",play_again:"Play Again",next:"Next",invite_tips:"Invitation has been sent.It will unlock when newusers click in",grade_unlock:"LV %s unlock",level_up:"Level Up",upgrade_rewards:"Upgrade Rewards",new_music_unlocked:"New Music Unlocked",receive_awards:"Receive Rewards",new_music_wnlocked:"New Music Unlocked",back:"Back",Energy:"Get Energy",time:"time to next life: ",free_energy:"Free",three_times:"no times left",Coins:"Get Coins",get_diamond:"Get Diamonds",free_diamond:"Free",share_fail:"Sharing Failed",group_get_diamond:"Share to get diamonds",share_success:"Sharing Successed",get_jiangli:"Get",zuanshijiangli:"diamonds,go to challenge your limit",ok:"OK",coupon_buy:"discount",watch_video_invite_tips:"Watch video to get free diamonds",invite_diamond_tips:"invite friends to get free diamonds",dia_video:"no times left ",diamonddouble:"Double diamonds have been received",doublefaila:"Drop out the viedo,reward failed",doublefailb:"No video available, reward failed",no_internet:"leaderboards  currently unavailable currently, please check your network",loading_failed:"Loading failed.Please check the network and try again",retry:"retry",nickname_avatar:"Can't get your nickname and avatar.Please turn on the authorization and try again",cancel:"cancel",continue:"Continue",nothing:"no",unit1:"",unit2:"",more_songs:"More songs to be expected...",error:"error message:",jsjd:"Progress:",cyss:"Players:",bingxue_tangguo:"Snow Candy",yh:"Obtained",sx:"New",jlpmq:"need xx more for top 50%",jkhd:" more for",ssbd:"Rank",qbbd:"view more",ljtz:"Challenge",sycs:"Times Left: ",hzzj:"invite friends to get more times ",match_inv:"No times left.You can get more chance by inviting friends to the competition.",match_inv2:"Challenge Friends",chanllenge_rules:"you need level %s to join the chanllenge game",chanllenge_time_out:"No challenge times left, you can play it tomorrow",wfsm:"Rules",wfgz:"Rule",wfgz1:"Refresh daily at 10:00 pm [San Francisco,United States]",wfgz2:"Players with the highest score of the challenge are ranked first.",wfgz3:"At the end of the ranking will be checked, the final ranking is based on actual accounting.",wfgz4:"Ranking awards are sent by email and are distributed within half an hour of completion",wfgz5:"Strict use of cheating tools in the game, found after verification to cancel the results and prohibit participation in the platform race",pmjl:"Reward",pmjl1:"The top 50% can get skin",mc1:"Champion",mc2:"Top 10",mc3:"Top 100",mc4:"Top 1000",mc5:"Top 5000",mc6:"Top 20%",mc7:"Top 50%",hgjl:"Crown Award",star:"star",crown:"crown",gift1:"Primary gift",gift2:"Intermediate gift",gift3:"Senior gift",gift4:"Luxury gift ",gift5:"Epic gift",brph:"Today",hc:"need %s point to be top %s ",wcy:"Uncommitted",zrph:"Yesterday",wdzj:"My record",zjcj:"Best result: ",wlyc_djcs:"Network error, click try again! ",nodata_today:"Today rank list has no score record,go to challenge! ",nodata_yesterday:"Yesterday rank list has no score record! ",no_challenge:"You have no records yet",rank_group:"challenge friends",rank_group_click:"challenge friends",fhsy:"Home",cxtz:"Play Again",new_rank:"latest ranking   ",rank_into:"ranking has into   ",ranking:"%sth",top:"Top %s%",out90:"out 90%",times:"times",top_percent:"top %s%",to_rank_need:"<color=#000000> need <color=#CC562D> %s more </color>to be %s </color>",score:"score",can_get:"can win ",reward:"reward ",chanllenge_rank1:"Perfect! Ranking 1th in the match!",chanllenge:"chanllenge",chanllenge_times:"you can also chanllenge %s times today",zwyj:"No messmessage yet.",yjbl:"Messages are kept for 7 days.",jcyj:"Checking the mailing list...",wlyc:"Network error, please try again later",mail1:"receive",mail2:"open",mail3:"received",mail4:"opened",mailGet:"Successfully received",mtlc:"refresh at 6:00 am every day",gzsm:"Rule Details",gzsm1:"Inviting friends successfully requires that friends should enter piano tiles 2 through your invitation message.",gzsm2:"You can get rewards upon each successful invitation.Inviting starter doubles the rewards.",gzsm3:"If you invite your friends successfully, they will also receive 2 diamonds as rewards ",gzsm4:"If you have invited friends successfully 5 times a day,you can't receive rewards any more.",share_reward_tips:"need 5 persons ",chongci:"Trigger time: at the start of the game",chongcixg:"Prop effect: automatic sprint for 12 seconds",bingdong:"Trigger time: choose to use after Resurrection",bingdongxg:"Prop effect: the speed of the piano piece falling and falling speed in 15 seconds 50%",hudun:"Trigger time: when the operation is wrong",hudunxg:"Prop effect: offset error and invincible 8 seconds",cc:"Start with sprinting for 12s",js:" After the resurrection, slow down in 15s",hd:"Get through missed tiles for 1 time",bj:"The game uses deceleration props",ljsy:"use now",sprint:"sprint",slow:"slow down",shield:"shield",day1:"Day 1",day2:"Day 2",day3:"Day 3",day4:"Day 4",day5:"Day 5",day6:"Day 6",day7:"Day 7",dia_gift:"Diamond gift",sign_more_gift:"to get more reward in game",sign:"Sign",signed:"Signed",diamond:"Diamond",piece:"Piece",own_dia:"Obtained:",skin_share:"sharing gift",sys_def:"default",use_now:"current",skin_unuse:"set",skin_trial:"trial",trial_end:"Trial end",skin_load:"Loading skin files",skin_tip:"Tips",skin_dia_less:"More diamonds required, you can \nget diamonds in following ways",skin_get:"get",skin_owned:"acquired",invite_get:"obtain by inviting \uFF08%s/3\uFF09new players",skin_ice:"Snow Skin",skin_cherry:"Romantic Cherry",skin_candy:"Sweet Candy ",skin_soccer:"World Cup",skin_field:"Green Field",skin_girl:"Vivacious Girl",skin_space:"Space Journey",skin_default:"Default",skin_sign_get:"Sign 3 Days for free",skin_first_charge_get:"Sign 3 Days for free",day:"d",hours:"h",freeGet:"FreeGet",pieceGet:"PiecesGet",music_tab1:"Level",music_tab2:"Hot",music_start:"Play",music_start1:"1 Play",music_trial:"Trial",music_unlock:"Unlock",music_unlock_text1:"50 Unlock",music_unlock_text2:"2 Trial",music_invite_unlock:"Invite",music_invite_rule:"Unlock by inviting 1 new player",music_unlock_msg1:"Need to get %s stars in level %s",music_unlock_msg2:"Level %s required",music_unlock_msg3:"Need to get %s crowns in level %s",music_unlock_msg4:"End point: %sd %sh %sm %ss",lottery_prize1:"Permanent skin",lottery_prize2:"Limit Skin",lottery_rule:"Watch 15s' ad for a free wheel",lottery_video:"Watch the video completely to get rewards",lottery_video_pick:"close  continue",lottery_reward_sprint:"Get sprint props \uFF0Cto use it in game",lottery_waiting:"Remaining waiting time\uFF1A00\uFF1A00\uFF1A%s",lottery_chance:"No chance left today",lottery_chance2:"obtain draw opportunities without AD",new_guide_theme:"Game Description",new_guide_text1:"Progress\uFF1A",new_guide_text2:"Complete all the goals, you are the piano master!",new_guide_dialog_text:"Congratulations! You have learned the skills of playing Piano Tiles2\uFF0Cclick OK to start your first song",new_guide_btn_text:"Revive",new_guide_revive_text:"You missed the black tiles\uFF0Cthis will lead to the failure of the game.",new_guide_revive_text2:"Tips",ljdh:"Exchange Now",award_page_setting:"use it>>",award_page_morePieces:" view>>",award_page_SetSkinAtShop:"You can use it at skin stroe",award_page_getLowSpeedItem:"Recieve slowDown props\uFF0Cto use it in game",award_page_getShieldItem:"Recieve shield props\uFF0Cto use it in game",award_page_piecesTip:"Collect pieces to get diamonds ",award_page_giftTip:" ",award_page_transform_diamond:"the skin have transformed into %s diamond",award_page_award_get:"reward have received, please check it",award_page_video_diamond:"video get more",award_page_get_video_diamond:"2 diamonds receive",award_page_close_video_diamond:"close video early,reward failed",award_page_no_video_diamond:"no video available, reward failed",unlocked:"unlocked",unlock_by_invite:"unlock",more_hot_song:"more",on_sale_1_day:"50% off today",unlock_by_invite_1_new_palyer:"need to invite 1 starter",worth_diamond:"worth %s diamonds",Pieces_piano:"Piano Pieces",Pieces_reward:"Collect pieces to get diamonds and skin",Pieces_time:"Refresh time: %sd%sh%sm%ss",Pieces_get:"obtain more pieces ",Pieces_get_count:"invite friends %s/5",Pieces_rule:"Rule",Pieces_rule_det:"Rule details",Pieces_rule_one:"Collecting piano pieces has opportunities to obtain best reward including 500 diamonds and 3,000 coins",Pieces_rule_two:"You can get piano pieces by daily checking in and opening the gift box in game.",Pieces_rule_thr:"You can get piano pieces by inviting 5 friends at most to enter the game every day.",Pieces_rule_for:"Refresh every 15 days .You can get 15 times rewards at most in 15 days. The pieces unused will be cleared. Please be sure to receive the reward before refreshing.",Pieces_bonus:"Collecting pieces to get numerous diamonds , to get more pieces",Pieces_count_limit:"You have received the max times,please wait next period",Confirm:"confirm",Notification:"TIPS",pieces_obtain:"Wow,pieces obtained!",Pieces_obtain2:"Collecting piano pieces can get diamonds package!",pieces_obtain3:"go\uFF01",friend_help_reward:"help success, reward one more challenge time",friend_help_success_tip:"help your friend success",friend_help_success_tip2:"reward",friend_help_create_image:"image generating ",friend_help_save_failed:"save failed",unit_10k:"10k+",get_pieces_tips:"Wow,pieces obtained!",left_help_times:"%s times left",invitation_left_times:"%s  times left",continue_invite:"Invite more",invite_success:"Your friend",more_diamond:"More Diamond",help_success:"You assisted",help_award_tip:"%successfully\uFF0Cand you obtained ",invite_award_tip:"%shas accepted your invitation.You received %s diamonds! ",same_friend_tip:"your have used out the help chance today",help_friend_timeout:"You have used out the chance today",start_game:"start game",unlock_tip:"You haven't unlocked this song\uFF0Cgo unlock it!",shop_tip:"Tips",shop_tip2:"Store will come soon",free:"free",prop_tip1:"More coins required",prop_tip2:"More diamonds required",mail_obtain:"receive",mail_read:"open",mail_have_read:"read",mail_have_obtain:"received",noadrevive:"Exiting halfway, please try again",noadrevivefree:"No ADs available\uFF0Cplease try again",unlock_energy:"Energy",unlock_gold:"Gold",unlock_diamond:"Diamonds",unlock_unlockTips:"Unlock",unlock_play:"play",unlock_trial:"trial",unlock_str_plus:"Not enough %s to %s",update_piano:"Updating piano resources...",unlock_song:" %s players unlock",later:"later",challenge_Times_add:" Your friend has sign in\uFF0Creward you with one more chance of the competition",Today_best:"Best Score ",limit_skin_title:"Limit Skin",limit_skin_content:"The limit skin %s has expired, you can select a new skin at the skin store",gkspsrdjlfb:"gkspsrdjlfb",amount:"amount",props_introduction:"props introduction",fech:"friend enter can help",atp:"Auto tap props",reff:"Receive for free",unbd:"Unlock by gold coins",litu:"Limited time use",wtvfdr:"Watch the video for double rewards",wwn:"There is something wrong with network,please check it.",evpm:"Exiting video playback midway, reviving failed,please try again",nvaa:"No video ads available,reviving for free",play_game_tips_close_video:"close video early",play_game_tips_no_ad:"No video ads available, play now"}},cc._RF.pop()},{}],example_table:[function(l,P,m){"use strict";cc._RF.push(P,"6c859c74wFCWJUy2oHCco5L","example_table"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 999999},r.prototype.setPage=function(o){return o&&s.prototype.set.call(this,"page",o),this},r.prototype.setAction=function(o){return o&&s.prototype.set.call(this,"action",o),this},r.report=function(o,e){new r().setPage(o).setAction(e).reportData()},r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],layout_utils:[function(l,P,m){"use strict";cc._RF.push(P,"49ecbPM7I9Dp5BDqcSyRVdF","layout_utils"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function s(){}return s.vertical_layout=function(r,o,e,n,t,i){return n===void 0&&(n=1),t===void 0&&(t=0),i===void 0&&(i=0),[r%n*(o+t),-Math.floor(r/n)*(e+i)]},s.horizontal_layout=function(r,o,e,n,t,i){return n===void 0&&(n=1),t===void 0&&(t=0),i===void 0&&(i=0),[Math.floor(r/n)*(o+t),-r%n*(e+i)]},s}();m.LayoutUtil=d,cc._RF.pop()},{}],listview:[function(l,P,m){"use strict";cc._RF.push(P,"6e7e5pnHedAs7EqtnlA4mxo","listview"),Object.defineProperty(m,"__esModule",{value:!0});var d,s,r=l("./layout_utils"),o=function(){function e(n){if(this._selected_index=-1,this.scrollview=n.scrollview,this.mask=n.mask,this.content=n.content,this.item_tpl=n.item_tpl,this.item_tpl.active=!1,this.item_width=this.item_tpl.width,this.item_height=this.item_tpl.height,this.dir=n.direction||d.Vertical,this.width=n.width||this.mask.width,this.height=n.height||this.mask.height,this.gap_x=n.gap_x||0,this.gap_y=n.gap_y||0,this.row=n.row||1,this.col=n.column||1,this.cb_host=n.cb_host,this.item_setter=n.item_setter,this.recycle_cb=n.recycle_cb,this.select_cb=n.select_cb,this.select_setter=n.select_setter,this.scroll_to_end_cb=n.scroll_to_end_cb,this.auto_scrolling=n.auto_scrolling||!1,this.node_pool=[],this.dir==d.Vertical){var t=(this.item_width+this.gap_x)*this.col-this.gap_x;t>this.width&&(cc.info("real width > width, resize scrollview to realwidth,",this.width,"->",t),this.width=t),this.content.width=this.width}else{var i=(this.item_height+this.gap_y)*this.row-this.gap_y;i>this.height&&(cc.info("real height > height, resize scrollview to realheight,",this.height,"->",i),this.height=i),this.content.height=this.height}this.mask.setContentSize(this.width,this.height),this.mask.addComponent(cc.Mask),this.scrollview.node.setContentSize(this.width,this.height),this.scrollview.vertical=this.dir==d.Vertical,this.scrollview.horizontal=this.dir==d.Horizontal,this.scrollview.inertia=!0,this.scrollview.node.on("scrolling",this.on_scrolling,this),this.scrollview.node.on("scroll-to-bottom",this.on_scroll_to_end,this),this.scrollview.node.on("scroll-to-right",this.on_scroll_to_end,this)}return e.prototype.on_scroll_to_end=function(){this.scroll_to_end_cb&&this.scroll_to_end_cb.call(this.cb_host)},e.prototype.on_scrolling=function(){if(this.items&&this.items.length)if(this.dir==d.Vertical){var n=this.content.y;n<0&&(n=0),n>this.content.height-this.height&&(n=this.content.height-this.height);for(var t=0,i=this.items.length-1,a=(c=-n)-this.height;this.items[t].y-this.item_height>c;)t++;for(;this.items[i].y<a;)i--;t!=this.start_index&&i!=this.stop_index&&(this.start_index=t,this.stop_index=i,this.render_items())}else{var u=this.content.x;0<u&&(u=0),u<this.width-this.content.width&&(u=this.width-this.content.width);var c;for(t=0,i=this.items.length-1,a=(c=-u)+this.width;this.items[t].x+this.item_width<c;)t++;for(;this.items[i].x>a;)i--;t!=this.start_index&&i!=this.stop_index&&(this.start_index=t,this.stop_index=i,this.render_items())}},e.prototype.select_item=function(n){n!=this._selected_index&&(this._selected_index!=-1&&this.inner_select_item(this._selected_index,!1),this.inner_select_item(n,!0))},e.prototype.inner_select_item=function(n,t){var i=this.items[n];i?(i.is_select=t,i.node&&this.select_setter&&this.select_setter.call(this.cb_host,i.node,t,n),t&&(this._selected_index=n,this.select_cb&&this.select_cb.call(this.cb_host,i.data,n))):cc.warn("inner_select_item index is out of range{",0,this.items.length-1,"}",n)},e.prototype.spawn_node=function(n){var t=this.node_pool.pop();return t||((t=cc.instantiate(this.item_tpl)).active=!0),t.parent=this.content,t},e.prototype.recycle_item=function(n,t){t===void 0&&(t=!1),n.node&&cc.isValid(n.node)&&(this.recycle_cb&&this.recycle_cb.call(this.cb_host,n.node),n.node.removeFromParent(t),this.node_pool.push(n.node),n.node=null)},e.prototype.clear_items=function(n){var t=this;n===void 0&&(n=!1),this.items&&this.items.forEach(function(i){t.recycle_item(i,n)})},e.prototype.render_items=function(){for(var n,t=0;t<this.start_index;t++)(n=this.items[t]).node&&this.recycle_item(n);for(t=this.items.length-1;t>this.stop_index;t--)(n=this.items[t]).node&&this.recycle_item(n);for(t=this.start_index;t<=this.stop_index;t++)(n=this.items[t]).node||(n.node=this.spawn_node(t),this.item_setter.call(this.cb_host,n.node,n.data,t),this.select_setter&&this.select_setter.call(this.cb_host,n.node,n.is_select,t)),n.node.setPosition(n.x,n.y)},e.prototype.pack_item=function(n){return{x:0,y:0,data:n,node:null,is_select:!1}},e.prototype.layout_items=function(n){for(var t,i,a=n,u=this.items.length;a<u;a++){var c=this.items[a];this.dir==d.Vertical?(t=r.LayoutUtil.vertical_layout(a,this.item_width,this.item_height,this.col,this.gap_x,this.gap_y),c.x=t[0],c.y=t[1]):(i=r.LayoutUtil.horizontal_layout(a,this.item_width,this.item_height,this.row,this.gap_x,this.gap_y),c.x=i[0],c.y=i[1])}},e.prototype.resize_content=function(){if(this.items.length<=0)return this.content.width=0,void(this.content.height=0);var n=this.items[this.items.length-1];this.dir==d.Vertical?this.content.height=Math.max(this.height,this.item_height-n.y):this.content.width=Math.max(this.width,n.x+this.item_width)},e.prototype.get_data=function(){return this.items},e.prototype.refresh_all=function(){this._datas&&this.set_data(this._datas,!1)},e.prototype.set_data=function(n,t){var i=this;t===void 0&&(t=!1),this.clear_items(t),this.items=[],(this._datas=n).forEach(function(a){var u=i.pack_item(a);i.items.push(u)}),this.layout_items(0),this.resize_content(),this.start_index=-1,this.stop_index=-1,this.dir==d.Vertical?this.content.y=0:this.content.x=0,0<this.items.length&&this.on_scrolling()},e.prototype.insert_data=function(n){for(var t,i,a=this,u=[],c=1;c<arguments.length;c++)u[c-1]=arguments[c];if(u.length!=0)if(this.items||(this.items=[]),this._datas||(this._datas=[]),n<0||n>this.items.length)cc.warn("invalid index",n);else{var p=n==this.items.length,h=[];u.forEach(function(f){var g=a.pack_item(f);h.push(g)}),(t=this._datas).splice.apply(t,[n,0].concat(u)),(i=this.items).splice.apply(i,[n,0].concat(h)),this.layout_items(n),this.resize_content(),this.start_index=-1,this.stop_index=-1,this.auto_scrolling&&p&&this.scroll_to_end(),this.on_scrolling()}else cc.info("nothing to insert")},e.prototype.remove_data=function(n,t){var i=this;if(t===void 0&&(t=1),this.items)if(n<0||n>=this.items.length)cc.warn("invalid index",n);else if(t<1)cc.info("nothing to remove");else{var a=this.items.length,u=this.items.splice(n,t);this._datas.splice(n,t),u.forEach(function(c){i.recycle_item(c)}),n+t<a&&this.layout_items(n),this.resize_content(),0<this.items.length&&(this.start_index=-1,this.stop_index=-1,this.on_scrolling())}else cc.info("call set_data before call this method")},e.prototype.append_data=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.items||(this.items=[]),this.insert_data.apply(this,[this.items.length].concat(n))},e.prototype.scroll_to=function(n){if(this.dir==d.Vertical){var t=this.height-this.content.height;if(0<=t)return void cc.info("no need to scroll");var i=r.LayoutUtil.vertical_layout(n,this.item_width,this.item_height,this.col,this.gap_x,this.gap_y),a=(i[0],i[1]);a<t&&(a=t,cc.info("content reach bottom")),0<a&&(a=0,cc.info("content reach top")),this.scrollview.setContentPosition(cc.v2(this.content.getPositionX(),-a)),this.on_scrolling()}else{var u=this.content.width-this.width;if(u<=0)return void cc.info("no need to scroll");var c=r.LayoutUtil.horizontal_layout(n,this.item_width,this.item_height,this.row,this.gap_x,this.gap_y),p=c[0];c[1],u<p&&(p=u,cc.info("content reach right")),p<0&&(p=0,cc.info("content reach left")),this.scrollview.setContentPosition(cc.v2(-p,this.content.getPositionY())),this.on_scrolling()}},e.prototype.scroll_to_end=function(){this.dir==d.Vertical?this.scrollview.scrollToBottom():this.scrollview.scrollToRight()},e.prototype.refresh_item=function(n,t){if(this.items)if(n<0||n>=this.items.length)cc.warn("invalid index",n);else{var i=this.items[n];i.data=t,this._datas[n]=t,i.node&&(this.recycle_cb&&this.recycle_cb.call(this.cb_host,i.node),this.item_setter.call(this.cb_host,i.node,i.data,n))}else cc.info("call set_data before call this method")},e.prototype.destroy=function(){this.clear_items(),this.node_pool.forEach(function(n){n.destroy()}),this.node_pool=null,this.items=null,this._datas=null,cc.isValid(this.scrollview.node)&&(this.scrollview.node.off("scrolling",this.on_scrolling,this),this.scrollview.node.off("scroll-to-bottom",this.on_scroll_to_end,this),this.scrollview.node.off("scroll-to-right",this.on_scroll_to_end,this))},Object.defineProperty(e.prototype,"datas",{get:function(){return this._datas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected_index",{get:function(){return this._selected_index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectd_data",{get:function(){var n=this.items[this._selected_index];return n?n.data:null},enumerable:!0,configurable:!0}),e}();m.ListView=o,(s=d=m.ListViewDir||(m.ListViewDir={}))[s.Vertical=1]="Vertical",s[s.Horizontal=2]="Horizontal",cc._RF.pop()},{"./layout_utils":"layout_utils"}],m_p2_DL:[function(l,P,m){"use strict";cc._RF.push(P,"773cbx0QxdAuotbAGIB1tX3","m_p2_DL"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BIReportI"),s=l("../util/StringUtil"),r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.reset=function(){this.downloadType="",this.downloadSize=0,this.downloadTotalSize=0,this.downloadStatus="",this.localVersion="",this.resType="",this.mShowTime=Date.now()},e.prototype.getTableID=function(){return 201},e.setDownloadType=function(n){this.downloadType=n?"1":"2"},e.setDownloadTotalSize=function(n){this.downloadTotalSize=n},e.setDownloadSize=function(n){this.downloadSize=n},e.setDownloadStatus=function(n){this.downloadStatus=n?"1":"2"},e.setLocalVersion=function(n){s.StringUtil.isNullOrUndefined(n)?this.localVersion="":this.localVersion=n},e.setResType=function(n){this.resType=n},e.start=function(){cc.sys.platform==cc.sys.WECHAT_GAME&&e.reset()},e.report=function(){if(cc.sys.platform==cc.sys.WECHAT_GAME){var n=new e,t=Date.now()-this.mShowTime;n.set("download_type",this.downloadType),n.set("download_size",this.downloadSize),n.set("download_allsize",this.downloadTotalSize),n.set("download_time",t),n.set("download_status",this.downloadStatus),n.set("res_version",this.localVersion),n.set("download_res_type",this.resType),n.reportData()}},e}(d.default);m.default=r,cc._RF.pop()},{"../util/StringUtil":"StringUtil","./BIReportI":"BIReportI"}],m_p2_HMusic_laxin:[function(l,P,m){"use strict";cc._RF.push(P,"abe410MNWFNO6+U1dWRMpWU","m_p2_HMusic_laxin"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 181},r.prototype.setAction=function(o){return this.set("action",o),this},r.prototype.setSource=function(o){return this.set("source",o),this},r.prototype.setMusicId=function(o){return this.set("music_id",o),this},r.report=function(o,e,n){new r().setSource(o).setAction(e).setMusicId(n).reportData()},r.ACTION_SHOW=1,r.ACTION_CLICK_INVITE_FRIEND=2,r.ACTION_CLICK_CLOSE=3,r.ACTION_CLICK_DIAMOND_FRIEND=4,r.ACTION_CLICK_TO_HOT_SONG=5,r.SOURCE_GAMEOVER=1,r.SOURCE_CHALLENGE_RESULT=2,r.SOURCE_HOT_MUSIC_RESULT=3,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_PData_Dia:[function(l,P,m){"use strict";cc._RF.push(P,"f67e1iwC+xEWZvxgsYqtZkk","m_p2_PData_Dia"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 146},r.prototype.setDiamondCount=function(o){return s.prototype.set.call(this,"dia_num",o),this},r.prototype.setSource=function(o){return s.prototype.set.call(this,"source",o),this},r.prototype.setAction=function(o){return s.prototype.set.call(this,"action",o),this},r.report=function(o,e,n){new r().setAction(n).setSource(e).setDiamondCount(o).reportData(),console.log("minigame_piano2_playerdata_diamond dimondCount : "+o+" source : "+e+" action : "+n)},r.ACTION_GET_DIAMOND=1,r.ACTION_CONSUME_DIAMOND=2,r.SOURCE_HOMEPAGE_TOP_SHARE_GET=101,r.SOURCE_GAME_GIFT_BOX_GET=102,r.SOURCE_RELIVE_SHARE_GET=103,r.SOURCE_HOME_RANK_INVITE_FRIENT_GET=104,r.SOURCE_RANK_SHARE_GROUP_GET=105,r.SOURCE_GAME_OVER_CHALLENGE_GET=106,r.SOURCE_INVITER_GET_REWARD=107,r.SOURCE_INVITEE_GET_REWARD=108,r.SOURCE_GIFT_BOX_GET_REWARD=109,r.SOURCE_GET_ALL_JIGSAW=110,r.SOURCE_DAILY_ATTENDANCE=111,r.SOURCE_HOME_WATCH_VIDEO_GET_DIAMOND=112,r.SOURCE_GET_LOTTERY=113,r.SOURCE_HOME_INVITATIONCODE_GET_DIAMOND=115,r.SOURCE_BUY_VIP_GET_DIAMOND=116,r.SOURCE_VIP_DAILY_GET_DIAMOND=117,r.SOURCE_BUY_GOLD_USE=201,r.SOURCE_RELIVE_USE=202,r.SOURCE_BUY_SKIN=203,r.SOURCE_BUG_HOTO_MUSIC=204,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_PData:[function(l,P,m){"use strict";cc._RF.push(P,"f7d11KK/RZGt4tHq0xONwGl","m_p2_PData"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 144},r.prototype.setSurvivalTime=function(o){this.set("survival_time",o)},r.prototype.setPlayerLevel=function(o){this.set("player_level",o)},r.prototype.setExpNum=function(o){this.set("exp_num",o)},r.prototype.setCoinNum=function(o){this.set("coin_num",o)},r.prototype.setLifeNum=function(o){this.set("life_num",o)},r.prototype.setDiamondtNum=function(o){this.set("dia_num",o)},r.prototype.setCrownNumLeaderboard=function(o){this.set("crown_num_leadboard",o)},r.prototype.setStarNumLeaderboard=function(o){this.set("star_num_leadboard",o)},r.prototype.setState=function(o){this.set("state",o)},r.prototype.setSkin=function(o){this.set("skin",o)},r.prototype.setSkinNum=function(o){this.set("skin_num",o)},r.prototype.setHotSongNum=function(o){this.set("hotsong_num",o)},r.report=function(o,e,n,t,i,a,u,c,p,h,f,g){var _=new r;_.setSurvivalTime(e),_.setPlayerLevel(n),_.setExpNum(t),_.setCoinNum(i),_.setLifeNum(a),_.setDiamondtNum(u),_.setCrownNumLeaderboard(c),_.setStarNumLeaderboard(p),_.setState(h),_.setSkin(f),_.setSkinNum(g),_.setHotSongNum(0),_.reportData()},r.COLD_AWAKE=1,r.HOT_AWAKE=2,r.QUIT=3,r.ENTER_GAME=1,r.EXIT_GAME=2,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_Uaction:[function(l,P,m){"use strict";cc._RF.push(P,"06c15HPqLhOSJn2lLYK7DW6","m_p2_Uaction"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 149},r.prototype.setMusicId=function(o){return s.prototype.set.call(this,"music_id",o),this},r.prototype.setAction=function(o){return s.prototype.set.call(this,"action",o),this},r.report=function(o,e){new r().setAction(e).setMusicId(o).reportData()},r.ACTION_CLICK_PERMISSION_AGREE=101,r.ACTION_CLICK_PERMISSION_REJECT=102,r.ACTION_SHOW_FIRST_LITTLE_STAR=104,r.ACTION_CLICK_FIRST_LITTLE_START_START=105,r.ACTION_CLICK_HOME_AVATOR=201,r.ACTION_CLICK_ENERGY=202,r.ACTION_CLICK_GOLD=203,r.ACTION_CLICK_DIAMOND=204,r.ACTION_SHOW_HOME_TAB=301,r.ACTION_CLICK_HOME_START=302,r.ACTION_CLICK_HOME_RANK_SEE_ALL=303,r.ACTION_CLICK_HOME_RANK_INVITE=304,r.ACTION_SHOW_PERMISSION_DIALOG_AVATOR=306,r.ACTION_CLICK_PERMISSION_DIALOG_AVATOR_AGREE=307,r.ACTION_OPEN_PERMISSION_SUCC_AVATOR=308,r.ACTION_SHARE_FOR_GIFT=309,r.ACTION_CLICK_PLAYER_CYCLE=310,r.ACTION_CLICK_JIGSAW_PUZZLE=311,r.ACTION_CLICK_SKIN_STORE=312,r.ACTION_CLICK_DAILY_ATTENDANCE=313,r.ACTION_CLICK_GIFT_EXCHANGE=328,r.ACTION_CLICK_MGPLUGIN_GAME=314,r.ACTION_CLICK_HOT_MUSIC=315,r.ACTION_CLICK_SHOP=316,r.ACTION_SHOW_FIRST_PAY=320,r.ACTION_CLICK_FIRST_PAY=321,r.ACTION_SHOW_QQ_RED_PACKET=322,r.ACTION_CLICK_QQ_RED_PACKET=323,r.ACION_CLICK_FULI_BTN=325,r.ACTION_CLICK_QQ_GAME=318,r.ACTION_CLICK_NEW_TARGET=319,r.ACTION_CLICK_CHAT=345,r.ACTION_SHOW_LOTTERY_ICON=329,r.ACTION_CLICK_LOTTERY_ICON=330,r.ACTION_SHOW_WELFARE_LOTTERY_ICON=331,r.ACTION_CLICK_WELFARE_LOTTERY_ICON=332,r.ACTION_SHOW_LOTTERY_FRAME=333,r.ACTION_CLICK_LOTTERY_START=334,r.ACTION_SHOW_VIP_ICON=335,r.ACTION_CLICK_VIP_ICON=336,r.ACTION_SHOW_NORMAL_MUSIC_UNLOCK_ALL=337,r.ACTION_CLICK_NORMAL_MUSIC_UNLOCK_ALL=338,r.ACTION_SHOW_HOT_MUSIC_SALE_ALL=339,r.ACTION_CLICK_HOT_MUSIC_SALE_ALL=340,r.ACTION_SHOW_SKIN_PIECE_WITHOUT_GET=341,r.ACTION_SHOW_SKIN_PIECE_WITH_GET=342,r.ACTION_CLICK_SKIN_PIECE=343,r.ACTION_SHOW_MUSICLIB_TAB=401,r.ACTION_CLICK_MUSICLIB_START=402,r.ACTION_CLICK_MUSICLIB_RANK=403,r.ACTION_SHOW_RANK=501,r.ACTION_CLICK_SEE_GROUP_RANK=502,r.ACTION_CLICK_XUANYAO=503,r.ACTION_SHOW_SKIN_SPLASH=601,r.ACTION_CLICK_SKIN_SPLASH=602,r.ACTION_SHOW_INVITEE_DIALOG=603,r.ACTION_INVITEE_DIALOG_CLICK=604,r.ACTION_SHOW_INVITER_DIALOG=605,r.ACTION_INVITER_DIALOG_CLICK=606,r.ACTION_SHOW_MAIL_ICON=701,r.ACTION_CLICK_MAIL_ICON=702,r.ACTION_SHOW_MAIL_ITEM_RECEIVE=703,r.ACTION_CLICK_MAIL_ITEM_RECEIVE=704,r.ACTION_CLICK_MAIL_INFO_RECEIVE=705,r.ACTION_SHOW_MAIL_ITEM_CHECK=706,r.ACTION_CLICK_MAIL_ITEM_CHECK=707,r.ACTION_HOMEPAGE_RECOMMEND_GAME_SHOW_A=1001,r.ACTION_HOMEPAGE_RECOMMEND_GAME_CLICK_A=1002,r.ACTION_HOMEPAGE_RECOMMEND_GAME_SHOW_B=1003,r.ACTION_HOMEPAGE_RECOMMEND_GAME_CLICK_B=1004,r.ACTION_SHOW_CHALLENGE_COMPETITION=801,r.ACTION_CLICK_CHALLENGE_COMPETITION=802,r.ACTION_SHOW_HOT_SONG_SPLASH=901,r.ACTION_HOT_SONG_SPLASH_PLAY=902,r.ACTION_CLICK_FIGHT=1101,r.ACTION_CLICK_FRIEND_FIGHT=1102,r.ACTION_1111_BUTTON_SHOWN=1103,r.ACTION_1111_BUTTON_CLICKED=1104,r.ACTION_1111_DIALOG_SHOWN=1105,r.ACTION_1111_COPY_BUTTON_CLICKED=1106,r.ACTION_1111_COPY_SUCCESSFUL=1107,r.ACTION_FOLLOW_ICON_SHOW=1110,r.ACTION_FOLLOW_ICON_CLICK=1111,r.ACTION_FOLLOW_DIALOG_SHOW=1112,r.ACTION_FOLLOW_DIALOG_CLICK=1113,r.ACTION_FOLLOW_DIALOG_CLOSE=1114,r.ACTION_GAMEBOX_BUTTON_SHOW=1115,r.ACTION_GAMEBOX_BUTTON_CLICK=1116,r.ACTION_CLICK_2_UNCHECK=1117,r.ACTION_CLICK_2_CHECK=1118,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_daily_activity:[function(l,P,m){"use strict";cc._RF.push(P,"379f85/EYpKi7ON3zABdCPT","m_p2_daily_activity"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 237},r.prototype.setAction=function(o){return this.set("action",o),this},r.prototype.setSource=function(o){return this.set("source",o),this},r.report=function(o,e){new r().setSource(o).setAction(e).reportData()},r.ACTION_SHOW=1,r.ACTION_CLICK_ATTENTION_TAB=2,r.ACTION_CLICK_SKIN_TAB=3,r.ACTION_CLICK_FIRST_PAY_TAB=4,r.ACTION_CLICK_TRIAL_TAB=5,r.ACTION_CLICK_TIME_GIFT=6,r.ACTION_SHOW_ATTENTION=101,r.ACTION_CLICK_GET=102,r.ACTION_SHOW_SKIN=201,r.ACTION_CLICK_TRY=202,r.ACTION_CLICK_SHARE=203,r.ACTION_CLICK_SAVE=204,r.ACTION_SHOW_FIRST_PAY=301,r.ACTION_CLICK_SHOP=302,r.ACTION_SHOW_TRIAL=401,r.ACTION_SHOW_TIME_GIFT=501,r.ACTION_TIME_GIFT_CLICK_TRY=502,r.ACTION_TIME_GIFT_CLICK_UNLOCK=503,r.ACTION_TAP_SHOW_COVER=504,r.ACTION_TIME_GIFT_TASK1_GAIN=511,r.ACTION_TIME_GIFT_TASK2_GO=521,r.ACTION_TIME_GIFT_TASK2_GAIN=522,r.ACTION_TIME_GIFT_TASK3_GO=531,r.ACTION_TIME_GIFT_TASK3_GAIN=532,r.SOURCE_HOME_PAGE_CLICK=1,r.SOURCE_SKIN_INVITE_SHOW=2,r.SOURCE_HOME_INVITE_SHOW=3,r.SOURCE_SHOP_FIRST_PAY_AUTO_SHOW=4,r.SOURCE_SKIN_FIRST_PAY_SHOW=5,r.SOURCE_ENTER_FROM_ATTENTION=6,r.SOURCE_SKIN_INVITE_AUTO_SHOW=7,r.SOURCE_COLD_BOOT_POP=8,r.SOURCE_SKIN_ATTENTION_SHOW=9,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_load_f:[function(l,P,m){"use strict";cc._RF.push(P,"0a6d6N9G2hKyZ2jBYZ4tFxl","m_p2_load_f"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 134},r.prototype.setSource=function(o){return s.prototype.set.call(this,"source",o),this},r.prototype.setMessage=function(o){return s.prototype.set.call(this,"message",o),this},r.report=function(o,e){new r().setSource(o).setMessage(e).reportData()},r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_pk_action:[function(l,P,m){"use strict";cc._RF.push(P,"4f53bBDE3FHkZJ0pMrIysVN","m_p2_pk_action"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 209},r.prototype.setAction=function(o){return s.prototype.set.call(this,"action",o),this},r.report=function(o){new r().setAction(o).reportData()},r.ACTION_SHOW_FIGHT_MAIN=1,r.ACTION_CLICK_MATCHING=2,r.ACTION_GO_TO_GAME=3,r.ACTION_MATCHING_TIME_OUT=4,r.ACTION_CLICK_RANK=11,r.ACTION_CLICK_SEASON_REWARD=12,r.ACTION_CLICK_RULE=13,r.ACTION_CLICK_LEFT_PROP=21,r.ACTION_CLICK_MIDDLE_PROP=22,r.ACTION_CLICK_RIGHT_PROP=23,r.ACTION_SHOW_FRIEND_FIGHT_MATCHING=31,r.ACTION_CLICK_INVITE_AGAIN=32,r.ACTION_SHOW_GET_DAILY_REWARD=41,r.ACTION_CLICK_GET_DAILY_REWARD=42,r.ACTION_GET_DAILY_REWARD_SUCCESS=43,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_pop_coin:[function(l,P,m){"use strict";cc._RF.push(P,"0ea9fNYzilDXoCtDD96qjmM","m_p2_pop_coin"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.setAction=function(o){return s.prototype.set.call(this,"action",o),this},r.prototype.setScene=function(o){return s.prototype.set.call(this,"sence",o),this},r.prototype.setSource=function(o){return s.prototype.set.call(this,"source",o),this},r.prototype.getTableID=function(){return 155},r.report=function(o,e,n){new r().setAction(n).setScene(o).setSource(e).reportData(),console.log("minigame_pianotile2_popwindow_coin "+o+" "+e+" "+n)},r.ACTION_DIALOG_SHOW=1,r.ACTION_CLICK_DIALOG_CLOSE_BTN=2,r.ACTION_CLICK_GET_ENERGY_100_GOLD=101,r.ACTION_CLICK_GET_ENERGY_220_GOLD=102,r.ACTION_CLICK_GET_ENERGY_430_GOLD=103,r.ACTION_CLICK_GET_ENERGY_850_GOLD=104,r.ACTION_CLICK_GET_ENERGY_VIDEO_GOLD=105,r.ACTION_CLICK_1_DIAMOND=201,r.ACTION_CLICK_10_DIAMOND=202,r.ACTION_CLICK_100_DIAMOND=203,r.ACTION_CLICK_SHARE_FREE_DIAMOND=301,r.ACTION_CLICK_WATCH_VIDEO=302,r.ACTION_CLICK_COUNT_FULL_BTN=303,r.ACTION_CLICK_LOADING_BTN=304,r.ACTION_CLICK_SHOP_BTN=305,r.SCENE_GET_ENERGY_DIALOG=1,r.SCENE_GET_GOLD_DIALOG=2,r.SCENE_GET_DIAMOND_DIALOG=3,r.SOURCE_HOME_ENERGY=1,r.SOURCE_HOME_GOLD=2,r.SOURCE_HOME_DIAMOND=3,r.SOURCE_ENERGY_NOT_CLICK_START=4,r.SOURCE_GOLD_NOT_CLICK_GOLD=5,r.SOURCE_DIAMOND_NOT_CLICK_DIAMOND=6,r.SOURCE_FIGHT_BUY_PROPERTY=7,r.SOURCE_SKIN_PIECE_GOLD_NOT_ENOUGH=8,r.SOURCE_BUY_TRUMPET_DIAMOND_NOT_ENOUGH=9,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_share:[function(l,P,m){"use strict";cc._RF.push(P,"70c0aoq1JxBSZBevPHtuReQ","m_p2_share"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 156},r.prototype.setSource=function(o){return s.prototype.set.call(this,"source",o),this},r.prototype.setAction=function(o){return s.prototype.set.call(this,"action",o),this},r.prototype.setCardType=function(o){return s.prototype.set.call(this,"card_type",o),this},r.convertCardType=function(o){if(o==0)return r.CARD_TYPE_NONE;switch(o){case 1:return r.CARD_TYPE_THREE;case 2:return r.CARD_TYPE_TWO;case 3:return r.CARD_TYPE_ONE;case 4:return r.CARD_TYPE_FOUR;case 5:return r.CARD_TYPE_FIVE;default:return o!=0?o:r.CARD_TYPE_NONE}},r.convertCardTypeForQQ=function(o){var e=this.CARD_TYPE_QQ_UNKNOWN;switch(o){case 0:e=this.CARD_TYPE_QQ_CHAT;break;case 1:e=this.CARD_TYPE_QQ_QZONE;break;case 2:e=this.CARD_TYPE_QQ_WECHAT;break;case 3:e=this.CARD_TYPE_QQ_FRIEND_TIME_LINE}return e},r.report=function(o,e,n){var t=r.convertCardType(n);new r().setAction(o).setSource(e).setCardType(t).reportData()},r.reportForMultiPlatform=function(o,e,n){if(cc.sys.platform==cc.sys.WECHAT_GAME)this.report(o,e,n);else if(cc.sys.platform==cc.sys.QQ_PLAY){var t=this.convertCardTypeForQQ(n);new r().setAction(o).setSource(e).setCardType(t).reportData()}},r.ACTION_LAUNCH_SHARE=1,r.ACTION_SHARE_SUCCESS=2,r.ACTION_SHARE_FAIL=3,r.SOURCE_SHOW_OFF=1,r.SOURCE_BATTLE_FRIEND=2,r.SOURCE_ACHIEVEMENT_SHOW_SELF=3,r.SOURCE_ACHIEVEMENT_SHOW_GROUP=4,r.SOURCE_SINGLE_SHOW_GROUP=5,r.SOURCE_SINGLE_FLAUNT_FRIEND=51,r.SOURCE_RELIVE=6,r.SOURCE_INVITE_FRIEND=7,r.SOURCE_GAIN_ENERGY=8,r.SOURCE_GAIN_DIAMOND=9,r.SOURCE_INIT=10,r.SOURCE_QQ_SHARE_APP=100,r.SOURCE_QQ_RELIVE=101,r.SOURCE_QQ_RANK_SINGLE=102,r.SOURCE_QQ_RANK_ACHIEVEMENT=103,r.SOURCE_QQ_BATTLE_FRIEND=104,r.SOURCE_QQ_JIGSAW=105,r.SOURCE_QQ_RESULT_NEW_RECORD=106,r.SOURCE_QQ_RESULT_SINGLE_CHAMP=107,r.SOURCE_QQ_RESULT_SHOW_OFF=108,r.SOURCE_QQ_SHARE_FOR_GIFT=109,r.SOURCE_QQ_RANK_SINGLE_SHOWOFF=110,r.SOURCE_QQ_RANK_ACHIEVEMENT_SHOWOFF=111,r.SOURCE_QQ_RESULT_BARCODE=201,r.SOURCE_QQ_SHARE_FOR_GIFT_BARCODE=202,r.CARD_TYPE_QQ_UNKNOWN=100,r.CARD_TYPE_QQ_CHAT=101,r.CARD_TYPE_QQ_QZONE=102,r.CARD_TYPE_QQ_WECHAT=103,r.CARD_TYPE_QQ_FRIEND_TIME_LINE=104,r.SOURCE_JIGSAW_PUZZLE_INVITE=11,r.SOURCE_JIGSAW_POPUP_INVITE=12,r.SOURCE_SHARE_GIFT_POPUP_INVITE=13,r.SOURCE_RESULT_PAGE_SAVE_IMAGE=14,r.SOURCE_SHARE_GIFT_SAVE_IMAGE=15,r.SOURCE_SHARE_INVITE_SKIN_SHARE=16,r.SOURCE_SHARE_INVITE_SKIN_SAVE_IMAGE=17,r.SOURCE_SHARE_INVITE_SONG_SHARE=18,r.SOURCE_SHARE_CHALLENGE_INVITE_GAIN_TIMES=19,r.SOURCE_SHARE_CHALLENGE_RESULT_SHOW_OFF=20,r.SOURCE_SHARE_FIGHT_WIN=21,r.SOURCE_SHARE_FIGHT_INVITE_FRIEND=22,r.SOURCE_SHARE_FRIEND__FIGHT_SHOW_OFF=23,r.SOURCE_SHARE_SKIN_PIECE=24,r.SOURCE_SHARE_ADD_FRIEND=25,r.SOURCE_SHARE_TONE=26,r.CARD_TYPE_NONE=0,r.CARD_TYPE_ONE=1,r.CARD_TYPE_TWO=2,r.CARD_TYPE_THREE=3,r.CARD_TYPE_FOUR=4,r.CARD_TYPE_FIVE=5,r.CARD_TYPE_FIVE_ONE=51,r.CARD_TYPE_SIX=6,r.CARD_TYPE_SIX_ONE=61,r.CARD_TYPE_SEVEN=7,r.CARD_TYPE_SEVEN_ONE=71,r.CARD_TYPE_EIGHT=8,r.CARD_TYPE_EIGHT_ONE=81,r.CARD_TYPE_NINE=9,r.CARD_TYPE_NINE_ONE=91,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],m_p2_skin_piece:[function(l,P,m){"use strict";cc._RF.push(P,"1746ayssFxEb5GdlM9Ragbw","m_p2_skin_piece"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BIReportI"),s=l("../base/Log"),r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getTableID=function(){return 234},e.prototype.setPage=function(n){return o.prototype.set.call(this,"page",n),this},e.prototype.setAction=function(n){return o.prototype.set.call(this,"action",n),this},e.prototype.setSkin=function(n){return o.prototype.set.call(this,"skin",n),this},e.prototype.setSource=function(n){return o.prototype.set.call(this,"source",n),this},e.report=function(n,t,i,a){new e().setPage(n).setSkin(t).setAction(i).setSource(a).reportData(),s.default.i("m_p2_skin_piece report page : "+n+" skin : "+t+",action: "+i+",source= "+a)},e.PAGE_TASK_1=1,e.PAGE_TASK_2=2,e.PAGE_TASK_WATCH_ADS=3,e.PAGE_TASK_GOLD_BUY=4,e.ACTION_SHOW_GO=1,e.ACTION_CLICK_GO=2,e.ACTION_SHOW_GET=3,e.ACTION_CLICK_GET=4,e.ACTION_SHOW_GOLD_BUY=5,e.ACTION_CLICK_GOLD_BUY=6,e.ACTION_CLICK_LEFT=7,e.ACTION_CLICK_RIGHT=8,e.SOURCE_SKIN_STORE=1,e.SOURCE_HOME_PAGE_PIECE=2,e}(d.default);m.default=r,cc._RF.pop()},{"../base/Log":"Log","./BIReportI":"BIReportI"}],mainpage:[function(l,P,m){"use strict";cc._RF.push(P,"b6d607wDTpAX5HuhgybW6eV","mainpage"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("../UI/GameEntraScene/BasicTouchEvent"),s=l("../Logic/PlayerMgr"),r=l("../UI/UserInfoManager"),o=l("../../util/TimeUtil"),e=l("../Logic/EventBus"),n=l("../Logic/NotifyEvent"),t=l("../../base/G"),i=l("../Logic/LangMgr"),a=l("../UI/GameEntraScene/ImgCache"),u=l("../../util/SceneMusicMgr"),c=l("../Core/GameDefine"),p=l("./GiftBoxDialog"),h=l("./UpdateDialog"),f=l("./UpdateContent"),g=l("../DB/DBMgr"),_=l("../Logic/Plugin/PluginMgr"),y=l("../Logic/Plugin/IPlugin"),S=l("../UI/MusicLevelDataLoader"),I=l("../../base/State"),v=l("../../util/SceneMusicUtil"),C=l("../UI/GameEntraScene/GameEntranceScene"),T=l("../Logic/LevelMgr"),E=l("../Network/Protocol/StorageUtil"),A=l("../../util/SUtil"),M=l("../Logic/MoneySystem"),k=l("../Logic/ChestManager"),D=l("../UI/GameEntraScene/PopupDlg"),L=l("../UI/GameEntraScene/CheckRewardProcessor"),b=l("../../base/Log"),N=l("../../util/PageHeap"),H=l("../UI/GameEntraScene/ToastPopManager"),R=l("../../config/LSKey"),F=l("../task/TaskSystem"),x=l("../task/TaskItem"),U=l("./GameOverPopupUtil"),B=l("./GameOverInviteSKin"),Q=l("./GameOverHotSong"),Z=l("../shop/DialogOneButtonPrefab"),z=l("../../../modules/MGAdv/scripts/Logic/MGAdvEntrance"),W=l("../../../modules/MGAdv/scripts/Logic/MGAdvDefine"),V=l("../skin/SkinUtils"),Y=l("../../../modules/MGUser/scripts/Logic/MGUserEntrance"),q=l("../UI/GameEntraScene/gameover/GameOverHotSongShare"),J=l("../../../modules/MGAppShare/scripts/ShareHelper"),ee=l("../UI/GameEntraScene/PrefabMgr"),$=l("../../util/QQReport"),j=l("../../util/StringUtil"),ie=l("../Logic/SkinDataManager"),oe=l("../UI/GameEntraScene/mainpage/AttentionPrefab"),ue=l("../../util/PU"),pe=l("../../config/RemoteCfgMgr"),de=l("../../infoc/m_p2_Uaction"),he=l("../../../modules/MGUtils/MGPlatform"),me=l("../Logic/I18nManager"),ye=l("../challengeCompetition/TipsDialog"),ge=l("../UI/playerInfoPopup/PlayerInfoPopupProfab"),Te=l("../keypad/KeypadNavigator"),Se=l("../Logic/I18nManager"),Be=l("./LevelVideoGetSkinPrefab"),be=cc._decorator,Ue=be.ccclass,se=be.property,He=function(re){function O(){var w=re!==null&&re.apply(this,arguments)||this;return w.mTopIconPanel=null,w.mTopEnergyIconPanel=null,w.mTimeCountdownLabel=null,w.mTimeCountdownPanel=null,w.mTopEnergyIcon=null,w.mTopEnergyCountLabel=null,w.mTopGoldPanel=null,w.mTopGoldCountLabel=null,w.mTopDiamondPanel=null,w.mTopDiamondLabel=null,w.mMusicNameLabel=null,w.mScoreLabel=null,w.mScoreLabelShadow=null,w.mRewardStarLayout=null,w.mRewardCrownLayout=null,w.mRewardStarIcon1=null,w.mRewardStarIcon2=null,w.mRewardStarIcon3=null,w.mRewardCrownIcon1=null,w.mRewardCrownIcon2=null,w.mRewardCrownIcon3=null,w.mRewardGoldLabel=null,w.mRewardExpLabel=null,w.mGoHomeButton=null,w.mGoNextButton=null,w.mGoNextLabel=null,w.mTryAgainButton=null,w.mGoNextConditionLable=null,w.mChallengeFriendButton=null,w.mEnergyAnimPanel=null,w.mTipsLayout=null,w.mGlobalRankLayout=null,w.mRankDialogLayout=null,w.mToastPopLayout=null,w.mNextBtnBgSprite=null,w.mNewRecordIcon=null,w.mLockNextSprite=null,w.mRewardPanel=null,w.mBg=null,w.mSeeAllBtn=null,w.mSeeAllLabel=null,w.mStopEventNode=null,w.mShareForGiftBg=null,w.mLoadingIcon=null,w.mInviteIcon=null,w.mInviteLayout=null,w.mHotMusicBattleTips=null,w.mToHomeBtnRedSpot=null,w.mAddFavIcon=null,w.mAddFavIconQQ=null,w.mDlIcon=null,w.mGameBoxLayout=null,w.mGameBoxIcon1=null,w.mGameBoxIcon2=null,w.mGameBoxIcon3=null,w.mGameBoxIcon4=null,w.mNextLabelButton=null,w.mEnergyClickCallback=null,w.mGoldClickCallback=null,w.mDiamondClickCallback=null,w.mGoNextBtnClickCallback=null,w.mGoHomeBtnClickCallback=null,w.mTryAgainBtnClickCallback=null,w.mSeeALlBtnClickCallback=null,w.mShareForGiftCallback=null,w.mInviteCallback=null,w.mLeftTime=0,w.mIsNewRecord=!1,w.mIsQQRedPacket=!1,w.mCheckRewardProcessor=null,w.mInviteType=U.InviteType.InviteType_NONE,w.mbDestroyed=!1,w.isCurHotMusic=!1,w.mIsBannerShow=!1,w.isShareForGiftShow=!1,w.isNewRecordShow=!1,w.isGiftBoxShow=!1,w.isRewardShow=!1,w.isInviteSongShow=!1,w.isInviteSkinShow=!1,w.isFirstPayShow=!1,w.MUSIC_ID_1=100001,w.MUSIC_ID_2=100002,w.mSSShowOffQQBannerHiddenInit=!1,w.mSSShowOffQQBannerHidden=!0,w.mSSResultQQBannerDynamic=!1,w.mSSResultBannerDelay=0,w.mSSResultBannerDelayPopup=0,w.isBannerHideForPopup=!1,w}return __extends(O,re),O.prototype.enResLoad=function(){},O.prototype.enSpriteSetNull=function(){this.mGoHomeButton.getComponent(cc.Sprite).spriteFrame=null,this.mTryAgainButton.getComponent(cc.Sprite).spriteFrame=null,this.mNextLabelButton.getComponent(cc.Sprite).spriteFrame=null},O.prototype.onLoad=function(){me.default.getInstance().isEnglish()&&this.enResLoad(),this.applySkin(),this.adaptorUI(),this.mTimeCountdownPanel.node&&(this.mTimeCountdownPanel.node.active=!1),s.default.Ins().addUserListener(this),r.User.UserInfoManager.registerHpReviveListener(this.hpCallback,this),this.mDialogManager=new D.PopupDlg,this.mDialogManager.setParentLayout(this.mTipsLayout.node),this.mRankDialogManager=new D.PopupDlg,this.mRankDialogManager.setParentLayout(this.mRankDialogLayout.node),H.ToastPopManager.getIns().init(this.mToastPopLayout.node),this.mCheckRewardProcessor=new L.default(this.mDialogManager),this.registerShowRankPageEvent(),ue.default.isWeiXin()||(z.MGAdv.load(W.ADScene.NORMAL_RESULT_REWARD,W.QQ_ADV_TYPE.VIDEO_TYPE_GAME_TASK),this.scheduleOnce(function(){z.MGAdv.load(W.ADScene.RELIVE_POPUP,W.QQ_ADV_TYPE.VIDEO_TYPE_GAME_RELIVE)},2)),this.mSSShowOffQQBannerHiddenInit=pe.default.getIns().isQQBannerHiddenInit(),this.mSSShowOffQQBannerHidden=pe.default.getIns().isQQBannerHidden(),this.mSSResultQQBannerDynamic=pe.default.getIns().isQQDynamicBanner(),this.mSSResultBannerDelay=pe.default.getIns().getBannerDelay(),this.mSSResultBannerDelayPopup=pe.default.getIns().getBannerDelayPopup(),this.initGameBox(),Te.default.getInstance().gotoPage(this.node,"GameOverPrefab")},O.prototype.initGameBox=function(){this.mGameBoxLayout&&(ue.default.isWeiXin()||ue.default.isCM()?this.mGameBoxLayout.node.active=!1:(this.playGameBoxAnim(),de.default.report(0,de.default.ACTION_GAMEBOX_BUTTON_SHOW)))},O.prototype.playGameBoxAnim=function(){if(this.mGameBoxLayout&&this.mGameBoxLayout.node){var w=this.mGameBoxLayout.getComponent(cc.Animation);w&&w.play("game_rcmd_enter")}},O.prototype.stopGameBoxAnim=function(){if(this.mGameBoxLayout&&this.mGameBoxLayout.node){var w=this.mGameBoxLayout.getComponent(cc.Animation);w&&w.stop("game_rcmd_enter")}},O.prototype.getBottomNodeBottomByShowBanner=function(){return A.SUtil.ins().isLiuHai()?223:A.SUtil.ins().isQuanMian()||A.SUtil.ins().isPuTong()?253:void 0},O.prototype.adaptorRankPanelForWX=function(w){w?A.SUtil.ins().isLiuHai()?(A.SUtil.ins().toBottomByPx(this.mSeeAllBtn,409),A.SUtil.ins().toBottomByPx(this.mGoHomeButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mTryAgainButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mGoNextButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mGoNextConditionLable,this.getBottomNodeBottomByShowBanner()-34)):A.SUtil.ins().isQuanMian()?(A.SUtil.ins().toBottomByPx(this.mSeeAllBtn,410),A.SUtil.ins().toBottomByPx(this.mGoHomeButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mTryAgainButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mGoNextButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mGoNextConditionLable,this.getBottomNodeBottomByShowBanner()-34)):A.SUtil.ins().isPuTong()&&(A.SUtil.ins().toBottomByPx(this.mSeeAllBtn,390),A.SUtil.ins().toBottomByPx(this.mGoHomeButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mTryAgainButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mGoNextButton,this.getBottomNodeBottomByShowBanner()),A.SUtil.ins().toBottomByPx(this.mGoNextConditionLable,this.getBottomNodeBottomByShowBanner()-34)):A.SUtil.ins().isLiuHai()?(A.SUtil.ins().toBottomByPx(this.mSeeAllBtn,359),A.SUtil.ins().toBottomByPx(this.mGoHomeButton,81),A.SUtil.ins().toBottomByPx(this.mTryAgainButton,81),A.SUtil.ins().toBottomByPx(this.mGoNextButton,81),A.SUtil.ins().toBottomByPx(this.mGoNextConditionLable,47)):A.SUtil.ins().isQuanMian()?(A.SUtil.ins().toBottomByPx(this.mSeeAllBtn,310),A.SUtil.ins().toBottomByPx(this.mGoHomeButton,62),A.SUtil.ins().toBottomByPx(this.mTryAgainButton,62),A.SUtil.ins().toBottomByPx(this.mGoNextButton,62),A.SUtil.ins().toBottomByPx(this.mGoNextConditionLable,28)):A.SUtil.ins().isPuTong()&&(A.SUtil.ins().toBottomByPx(this.mSeeAllBtn,280),A.SUtil.ins().toBottomByPx(this.mGoHomeButton,48),A.SUtil.ins().toBottomByPx(this.mTryAgainButton,48),A.SUtil.ins().toBottomByPx(this.mGoNextButton,48),A.SUtil.ins().toBottomByPx(this.mGoNextConditionLable,14)),this.mSeeAllBtn.getComponent(cc.Widget).updateAlignment(),this.mGoHomeButton.getComponent(cc.Widget).updateAlignment(),this.mTryAgainButton.getComponent(cc.Widget).updateAlignment(),this.mGoNextButton.getComponent(cc.Widget).updateAlignment(),this.mGoNextConditionLable.getComponent(cc.Widget).updateAlignment()},O.prototype.hideBanner=function(w,G){this.isBannerHideForPopup=G,console.log("MGADV hide from : "+w),z.MGAdv.hideBanner(W.ADScene.GAME_RESULT_BANNER),this.adaptorRankPanelForWX(!1)},O.prototype.showBanner=function(w){var G=this;if(this.mbDestroyed)console.log("in showBanner, this.mbDestroyed is true. return.");else if(console.warn("MGADV show from : "+w),ue.default.isQQ()){var K=this.mSSResultQQBannerDynamic?W.ADScene.SOURCE_NORMAL_RESULT_BANNER_DYNAMIC:W.ADScene.GAME_RESULT_BANNER,X=this.mSSResultQQBannerDynamic?W.QQ_BANNER_TYPE.DYNAMIC_BANNER:void 0;z.MGAdv.loadBanner(0,0,0,function(ae,le){if(ae==W.ADStat.LOAD_SUCCESS){var ce=!0;(G.isShareForGiftShow||G.isNewRecordShow||G.isGiftBoxShow||G.isInviteSongShow||G.isInviteSkinShow||G.isFirstPayShow)&&(G.hideBanner("\u5404\u79CD\u5F39\u51FA"),ce=!1),G.mbDestroyed?(z.MGAdv.hideBanner(W.ADScene.GAME_RESULT_BANNER),z.MGAdv.destroyBanner(W.ADScene.GAME_RESULT_BANNER)):z.MGAdv.showBanner(K,function(fe,_e){G.mIsBannerShow=fe==W.ADStat.SHOWING_PAGE,G.adaptorRankPanelForWX(fe==W.ADStat.SHOWING_PAGE),ce||G.hideBanner("not showbanner ")})}else G.adaptorRankPanelForWX(!1)},K,X)}else if(ue.default.isWeiXin())if(this.mbDestroyed)z.MGAdv.hideBanner(W.ADScene.GAME_RESULT_BANNER),z.MGAdv.destroyBanner(W.ADScene.GAME_RESULT_BANNER);else{var te=he.MGPlatform.getSystemInfoSync(),ne=(A.SUtil.ins().mScreenHeight-this.getBottomNodeBottomByShowBanner()+10)*te.screenHeight/A.SUtil.ins().mScreenHeight;z.MGAdv.loadBanner(0,0,ne,function(ae,le){if(ae==W.ADStat.LOAD_SUCCESS&&!G.mbDestroyed){var ce=G.isBannerHideForPopup?G.mSSResultBannerDelayPopup:G.mSSResultBannerDelay;b.default.i("RemoteCfgMgr","prepare to scheduleOnce delay: "+ce),G.scheduleOnce(function(){b.default.i("RemoteCfgMgr","showBanner scheduleOnce callback"),G.mbDestroyed||z.MGAdv.showBanner(W.ADScene.GAME_RESULT_BANNER,function(fe,_e){G.adaptorRankPanelForWX(fe==W.ADStat.SHOWING_PAGE)})},ce)}},W.ADScene.GAME_RESULT_BANNER)}},O.prototype.start=function(){var w=t.G.Ap.state.mBattleSettlement;this.mIsNewRecord=w.mScore>w.mHistoryBestScore,$.QQReport.reportSongScore(w.mScore),this.startShareGiftAnimation(),ue.default.isCM()?(this.mInviteIcon.node.active=!1,this.showInviteSongPopup()):this.initInviteLayout(),this.initView(),this.initDLIcon(),this.initEvents()},O.prototype.initDLIcon=function(){this.mDlIcon.node.active=!1},O.prototype.startShareGiftAnimation=function(){},O.prototype.update=function(w){if(!t.G.Ap.config.debugNoBackgroundAnim){var G=t.G.Ap.skinMgr.getCurrentSkinItem();G&&G.getSkinElementPainter().update(w,"GameoverUpdate")}},O.prototype.applySkin=function(){var w=t.G.Ap.skinMgr.getCurrentSkinItem();if(w){var G=this.node.getChildByName("Bg"),K=this.node.getChildByName("animation_bkg");w.getSkinElementPainter().captureBackground("GameoverUpdate",G,K)}},O.prototype.initInviteLayout=function(){var w=this,G=this.shouldShowHotSongShare();this.mInviteType=G?U.InviteType.InviteType_HOT_SONG:U.default.getDefaultShowType();var K=Y.MGUser.getCurrentServerTime();switch(this.mInviteType){case U.InviteType.InviteType_NONE:this.mInviteIcon.node.active=!1,this.mInviteLayout.active=!1;break;case U.InviteType.InviteType_SKIN:this.mInviteIcon.node.active=!0,this.mInviteLayout.active=!0;var X="/static_res/gameover/invite_skin_icon";me.default.getInstance().isEnglish()&&(X="/static_res/gameover/invite_skin_icon_en"),a.default.get2(X,this.mInviteIcon),U.default.needActiveShowPopup(t.G.Ap.state.mBattleSettlement.mStar,this.mInviteType)&&U.default.needShowActivePopupByToggle(this.mInviteType,1,function(ne){ne&&(E.default.save(R.default.GAME_OVER_INVIE_SKIN_LAST_SHOW_TIME,K+""),w.showInviteSkinPopup())}),E.default.save(R.default.GAME_OVER_LAST_SHOW_TIME,K+"");break;case U.InviteType.InviteType_HOT_SONG:this.mInviteIcon.node.active=!0,this.mInviteLayout.active=!0;var te="/static_res/gameover/hot_song_icon";me.default.getInstance().isEnglish()&&(te="/static_res/gameover/hot_song_icon_en"),a.default.get2(te,this.mInviteIcon),(U.default.needActiveShowPopup(t.G.Ap.state.mBattleSettlement.mStar,this.mInviteType)||G)&&U.default.needShowActivePopupByToggle(this.mInviteType,1,function(ne){ne&&(E.default.save(R.default.GAME_OVER_INVITE_SONG_LAST_SHOW_TIME,K+""),w.showInviteSongPopup())}),E.default.save(R.default.GAME_OVER_LAST_SHOW_TIME,K+"")}me.default.getInstance().isEnglish()&&(this.mInviteIcon.node.active=!1,this.mInviteLayout.active=!1)},O.prototype.initNormalUi=function(){var w=this,G="/static_res/gameover_challenge1",K="/static_res/gameover_challenge1_pressed",X="/static_res/gameover_gohome_btn1",te="/static_res/gameover_gohome_btn1_pressed";me.default.getInstance().isEnglish()&&(G="/static_res/gameover_challenge1_en",K="/static_res/gameover_challenge1_pressed_en",X="/static_res/gameover_gohome_btn_en",te="/static_res/gameover_gohome_btn1_pressed_en"),a.default.get(G,function(ne,ae){ae&&cc.isValid(w,!0)&&(w.mChallengeFriendButton.getComponent(cc.Sprite).spriteFrame=ae,w.mChallengeFriendButton.normalSprite=ae)}),a.default.get(K,function(ne,ae){ae&&cc.isValid(w,!0)&&(w.mChallengeFriendButton.pressedSprite=ae)}),a.default.get(X,function(ne,ae){ae&&cc.isValid(w,!0)&&(w.mGoHomeButton.getComponent(cc.Sprite).spriteFrame=ae,w.mGoHomeButton.normalSprite=ae)}),a.default.get(te,function(ne,ae){ae&&cc.isValid(w,!0)&&(w.mGoHomeButton.pressedSprite=ae)})},O.prototype.initHotMusicUi=function(){var w=this;if(this.isCurHotMusic=!0,ue.default.isCM())this.mGoNextButton.node.active=!1;else{var G="/static_res/gameover_to_hot_music",K="/static_res/gameover_to_hot_music_pressed",X="/static_res/gameover_invite_fds",te="/static_res/gameover_invite_fds_pressed",ne="/static_res/gameover_hotsong_play_again",ae="/static_res/gameover_hotsong_play_again_pressed";me.default.getInstance().isEnglish()&&(G="/static_res/gameover_to_hot_music_en",K="/static_res/gameover_to_hot_music_pressed_en",X="/static_res/gameover_invite_fds_en",te="/static_res/gameover_invite_fds_pressed_en",ne="/static_res/gameover_hotsong_play_again_en",ae="/static_res/gameover_hotsong_play_again_pressed_en"),a.default.get(G,function(le,ce){ce&&cc.isValid(w,!0)&&(w.mChallengeFriendButton.getComponent(cc.Sprite).spriteFrame=ce,w.mChallengeFriendButton.normalSprite=ce)}),a.default.get(K,function(le,ce){ce&&cc.isValid(w,!0)&&(w.mChallengeFriendButton.pressedSprite=ce)}),a.default.get(X,function(le,ce){ce&&cc.isValid(w,!0)&&(w.mTryAgainButton.getComponent(cc.Sprite).spriteFrame=ce,w.mTryAgainButton.normalSprite=ce)}),a.default.get(te,function(le,ce){ce&&cc.isValid(w,!0)&&(w.mTryAgainButton.pressedSprite=ce)}),a.default.get(ne,function(le,ce){ce&&cc.isValid(w,!0)&&(w.mGoNextButton.getComponent(cc.Sprite).spriteFrame=ce,w.mGoNextButton.normalSprite=ce)}),a.default.get(ae,function(le,ce){ce&&cc.isValid(w,!0)&&(w.mGoNextButton.pressedSprite=ce)}),this.mGoNextBtnClickCallback=new d.default(function(){var le=W.ADScene.PLAY_AGAIN;z.MGAdv.commercialBreak(le,W.QQ_ADV_TYPE.VIDEO_TYPE_PLAY_AGAIN,function(ce){w.playAgain()})}),this.mGoNextButton.node.on(cc.Node.EventType.TOUCH_END,this.mGoNextBtnClickCallback.click,this.mGoNextBtnClickCallback),this.mGoNextButton.node.getChildByName("NextLabel").active=!1,this.shouldShowHotMusicBattleTips()&&(this.mHotMusicBattleTips.node.active=!0)}},O.prototype.initView=function(){var w=this;this.mLoadingIcon.node.active=!1;var G=s.default.Ins();this.mTopEnergyCountLabel.string=G.getHP()+"",this.mTopGoldCountLabel.string=G.getUserCoin()+"",this.mTopDiamondLabel.string=G.getUserDiamond()+"";var K=t.G.Ap.state.mBattleSettlement,X=i.default.gIns().getLanguageByKey(K.mMusicName),te=S.MusicLevelDataLoader.getIndex(K.mLevel);this.mMusicNameLabel.string=te+"."+X,K.mCrown==0?this.showStar(K.mStar):this.showCrow(K.mCrown),u.default.playStarOrCrownMusic(K.mStar,K.mCrown),this.mScoreLabel.string=K.mScore+"",this.mScoreLabelShadow.string=K.mScore+"";var ne=G.getLevelRecordByMid(K.mMid);if(ne==null){var ae=T.LevelMgr.Ins().getLevel(K.mLevel);ne=G.addNewRecord(ae.id,ae.music.mid,ae.levelUnlock.unlockType)}if(K.mScore>=K.mHistoryBestScore&&1<=K.mStar,9e3<=ne.mId)this.initHotMusicUi();else{var le="/static_res/gameover_next_bg";me.default.getInstance().isEnglish()&&(le="/static_res/gameover_next_bg_en"),(K.mCrown==0&&2<K.mStar||0<K.mCrown)&&a.default.get(le,function(_e,Ae){cc.isValid(w,!0)&&Ae&&(w.mNextBtnBgSprite.spriteFrame=Ae,w.mNextBtnBgSprite.getComponent(cc.Animation).play("gameover_next_rotate"))}),this.initNormalUi();var ce,fe=S.MusicLevelDataLoader.getNextLevel(K.mLevel);fe&&((ce=G.getLevelRecord(fe.id))==null||ce.isRecordLocked()&&ce.mUnlockFlag==c.eUnlockFlag.FLAG_LOCKED_LV_TRY)&&(fe=S.MusicLevelDataLoader.getNextLevel(fe.id)),fe?(ce=G.getLevelRecord(fe.id))==null||ce.isRecordLocked()?(this.mLockNextSprite.node.active=!0,this.mGoNextConditionLable.node.active=!0,this.mGoNextConditionLable.string=cc.js.formatStr(me.default.getInstance().getLanguageByKey("label_text.grade_unlock"),fe.needLv+""),this.mGoNextButton.interactable=!1):(this.mGoNextButton.interactable=!0,this.mLockNextSprite.node.active=!1,this.mGoNextBtnClickCallback=new d.default(function(){var _e=W.ADScene.PLAY_AGAIN;z.MGAdv.commercialBreak(_e,W.QQ_ADV_TYPE.VIDEO_TYPE_PLAY_AGAIN,function(Ae){_.default.Ins().getPlugin(y.default.Plugin_Energy).isCurEnergyEnough()?w.playNextMusic(fe):w.toEnergyDialog()})}),this.mGoNextButton.node.on(cc.Node.EventType.TOUCH_END,this.mGoNextBtnClickCallback.click,this.mGoNextBtnClickCallback),this.mGoNextLabel.node.on(cc.Node.EventType.TOUCH_END,this.mGoNextBtnClickCallback.click,this.mGoNextBtnClickCallback)):(this.mGoNextButton.interactable=!1,this.mLockNextSprite.node.active=!1),this.addNormalMusicTimes()}this.showHotSongShare(K,function(_e){w.showResultPopup(K,ne,!_e)}),this.mRewardCoin=ne.mCoin,this.mRewardExp=ne.mExp,this.showGoldAndExp(),this.hideEventStopNode(),ue.default.isCM()||this.showGuide(),this.debugEnableFlentPage(K,ne)},O.prototype.debugEnableFlentPage=function(w,G){var K=this;E.default.read(R.default.DEBUG_ENABLE_FLAUNT_PAGE)=="true"&&this.mMusicNameLabel.node.on(cc.Node.EventType.TOUCH_END,function(){w.mStar=3,w.mScore=832,w.mHistoryBestScore=500,K.showResultPopup(w,G,!0)})},O.prototype.showResultPopup=function(w,G,K){K===void 0&&(K=!0),w.mScore>=w.mHistoryBestScore&&((1<=w.mStar||1<=w.mCrown)&&this.scheduleOnce(function(){u.default.play(u.default.NAME_NEW_BEST,u.default.PATH_NEW_BEST,!1)},1),0<w.mScore&&w.mScore>w.mHistoryBestScore&&this.showNewRecordIcon(),K&&1<=w.mStar&&(N.default.Ins().pop("NewRecordPage"),this.isNewRecordShow=!1)),this.showGiftBoxOrUpdateDialog(G)},O.prototype.showGuide=function(){E.default.read(R.default.HAS_SHOW_HOME_PAGE)!=="true"?F.default.Ins().isNeedShowTaskSystemEntry()&&F.default.Ins().loadData(function(w){for(var G=F.default.Ins().getTaskList(),K=0;K<G.length;K++)if(G[K].id=x.TaskID.TASK_ID_LITTLE_STAR){G[K].status===x.TaskStatus.TASK_STATUS_SUCCESS&&G[K].rewardTaken;break}}):this.mToHomeBtnRedSpot.node.active=!1},O.prototype.showLoading=function(){this.mLoadingIcon.node.active=!0,this.mLoadingIcon.getComponent(cc.Animation).play("hot_song_loading")},O.prototype.hideLoading=function(){this.mLoadingIcon.getComponent(cc.Animation).stop("hot_song_loading"),this.mLoadingIcon.node.active=!1},O.prototype.showReportScoreFailDialog=function(w,G){var K=this;ee.default.load("prefab/challengecompetition/TipsDialogPrefab",function(X,te){if(cc.isValid(K,!0)&&te){var ne=te.getComponent(ye.default);ne.setContent("\u7F51\u7EDC\u72B6\u51B5\u4E0D\u592A\u597D\u5594\uFF0C\u8BF7\u68C0\u67E5\u540E\u518D\u91CD\u65B0\u4E0A\u4F20\u5206\u6570\uFF01"),ne.setBottomBtnLabel("\u91CD\u8BD5"),ne.setShowCloseBtn(!0),ne.setBottomBtnCallback(function(){te.destroy()}),K.mTipsLayout.node.addChild(te)}})},O.prototype.showNewRecordIcon=function(){this.mNewRecordIcon.node.active=!0;var w=this.mScoreLabel.node.getPosition(),G=new cc.Vec2;G.y=w.y,G.x=w.x+this.mScoreLabel.node.width/2+12,this.mNewRecordIcon.node.setPosition(G),A.SUtil.ins().isLiuHai()?A.SUtil.ins().toTop(this.mNewRecordIcon,28.5):A.SUtil.ins().isQuanMian()&&A.SUtil.ins().toTop(this.mNewRecordIcon,28.1)},O.prototype.toEnergyDialog=function(){var w=this;ee.default.load("prefab/PlayerInfoPopupProfab",function(G,K){if(K){if(w.hideBanner("\u4F53\u529B\u51FA\u73B0"),!cc.isValid(w,!0))return;var X=K.getComponent(ge.default);X.setCloseSelfCallback(function(){w.mInviteLayout.childrenCount==0&&w.showBanner("\u4F53\u529B\u5173\u95ED"),K.destroy()}),w.mTipsLayout.node.addChild(K),X.playerEnergyBtnClick(0)}else b.default.e("[GameOver] load PlayerInfoPopupProfab error = "+G)})},O.prototype.showStar=function(w){this.mRewardStarLayout.node.active=!0,this.mRewardCrownLayout.node.active=!1,this.loadStarIcon(this.mRewardStarIcon1,0<w),this.loadStarIcon(this.mRewardStarIcon2,1<w),this.loadStarIcon(this.mRewardStarIcon3,2<w)},O.prototype.showCrow=function(w){this.mRewardStarLayout.node.active=!1,this.mRewardCrownLayout.node.active=!0,this.loadCrownIcon(this.mRewardCrownIcon1,0<w),this.loadCrownIcon(this.mRewardCrownIcon2,1<w),this.loadCrownIcon(this.mRewardCrownIcon3,2<w)},O.prototype.loadStarIcon=function(w,G){var K=G?"/gameImage/gameover_star_light":"/gameImage/gameover_star_gray";a.default.get2(K,w)},O.prototype.loadCrownIcon=function(w,G){var K=G?"/gameImage/gameover_crown_light":"/gameImage/gameover_crown_gray";a.default.get2(K,w)},O.prototype.initEvents=function(){var w=this;this.mEnergyClickCallback=new d.default(function(){w.energyClickCallback()}),this.mTopEnergyIconPanel.node.on(cc.Node.EventType.TOUCH_END,this.mEnergyClickCallback.click,this.mEnergyClickCallback),this.mGoldClickCallback=new d.default(function(){w.goldClickCallback()}),this.mTopGoldPanel.node.on(cc.Node.EventType.TOUCH_END,this.mGoldClickCallback.click,this.mGoldClickCallback),this.mDiamondClickCallback=new d.default(function(){w.diamondClickCallback()}),this.mTopDiamondPanel.node.on(cc.Node.EventType.TOUCH_END,this.mDiamondClickCallback.click,this.mDiamondClickCallback),this.mGoHomeBtnClickCallback=new d.default(function(){w.goHomeBtnClickCallback()}),this.mGoHomeButton.node.on(cc.Node.EventType.TOUCH_END,this.mGoHomeBtnClickCallback.click,this.mGoHomeBtnClickCallback),this.mTryAgainBtnClickCallback=new d.default(function(){if(w.isCurHotMusic){var G=W.ADScene.PLAY_AGAIN;z.MGAdv.commercialBreak(G,W.QQ_ADV_TYPE.VIDEO_TYPE_PLAY_AGAIN,function(K){w.playAgain(void 0,!1)})}else w.hideBanner("\u91CD\u8BD5"),G=W.ADScene.PLAY_AGAIN,z.MGAdv.commercialBreak(G,W.QQ_ADV_TYPE.VIDEO_TYPE_PLAY_AGAIN,function(K){w.tryAgainBtnClickCallback(!0)})}),this.mTryAgainButton.node.on(cc.Node.EventType.TOUCH_END,this.mTryAgainBtnClickCallback.click,this.mTryAgainBtnClickCallback),this.mSeeALlBtnClickCallback=new d.default(function(){w.seeAllBtnClickCallback()}),this.mSeeAllLabel.node.on(cc.Node.EventType.TOUCH_START,this.mSeeALlBtnClickCallback.click,this.mSeeALlBtnClickCallback),this.mInviteCallback=new d.default(function(){w.showInvitePopup()}),this.mInviteIcon.node.on(cc.Node.EventType.TOUCH_END,this.mInviteCallback.click,this.mInviteCallback),e.default.register(n.default.SHARE_RESULT_SHOW_INVITE_TIPS,this.showInviteTipsPopup,this),e.default.register(n.default.SPEC_SONG_TRY_SKIN_RESULT,this.specSongTrySkin,this)},O.prototype.specSongTrySkin=function(){V.default.trySkinSpecSong(!1,this.mTipsLayout.node)},O.prototype.showInviteTipsPopup=function(){var w=this;this.mDialogManager.showPopupDlgDynamic("prefab/shop/DialogOneButtonPrefab",function(G){if(cc.isValid(w,!0)&&G){var K=G.getComponent(Z.default);K.setContent("<color=3B5D72><size=30>"+me.default.getInstance().getLanguageByKey("label_text.invite_tips")+"</size></color>"),K.setBtnTxt(me.default.getInstance().getLanguageByKey("label_text.ok")),K.setShowClose(!1),K.setBottonCallback(function(X){w.mDialogManager.dismissDialog(X)})}})},O.prototype.showInvitePopup=function(){this.mInviteLayout.childrenCount==0&&(this.mInviteType==U.InviteType.InviteType_SKIN?this.showInviteSkinPopup():this.mInviteType==U.InviteType.InviteType_HOT_SONG&&this.showInviteSongPopup())},O.prototype.showInviteSkinPopup=function(){var w=this;me.default.getInstance().isEnglish()?(this.mInviteIcon.node.active=!1,this.mInviteLayout.active=!1):(this.isInviteSkinShow=!0,this.mInviteLayout.active=!0),this.hideBanner("\u9080\u8BF7\u5F97\u76AE\u80A4\u51FA\u73B0",!0),b.default.i("[zhangfu]GameoverUpdate.showInviteSkinPopup  = "),ee.default.load("prefab/gameover/GameOverInviteSkin",function(G,K){cc.isValid(w,!0)&&K&&(K.getComponent(B.default).setCloseCallback(function(){w.showBanner("\u9080\u8BF7\u76AE\u80A4\u5173\u95ED"),w.isInviteSkinShow=!1,K.destroy(),w.mInviteLayout.active=!1}),w.mInviteLayout.addChild(K))})},O.prototype.showInviteSongPopup=function(){var w=this;b.default.i("[zhangfu]GameoverUpdate.showInviteSongPopup  = "),me.default.getInstance().isEnglish()?(this.mInviteIcon.node.active=!1,this.mInviteLayout.active=!1):(this.isInviteSkinShow=!0,this.mInviteLayout.active=!0),this.hideBanner("\u770B\u89C6\u9891\u5F97\u6B4C\u66F2\u51FA\u73B0",!0),ee.default.load("prefab/gameover/GameOverHotSong",function(G,K){if(cc.isValid(w,!0)&&K){var X=K.getComponent(Q.default);X.setCloseCallback(function(){K.destroy(),w.showBanner("\u89C6\u9891\u5F97\u6B4C\u66F2\u5173\u95ED"),w.isInviteSongShow=!1,w.mInviteLayout.active=!1}),X.setStartGameCallback(function(te){w.playAgain(te)}),w.mInviteLayout.addChild(K)}})},O.prototype.showShareForGiftPrefb=function(){},O.prototype.seeAllBtnClickCallback=function(){this.hideBanner("\u67E5\u770B\u5168\u90E8")},O.prototype.tryAgainBtnClickCallback=function(w){if(w===void 0&&(w=!0),v.default.playBtnBeats(),w==0)return t.G.Ap.state.reset(!1),void t.G.Ap.config.loadMusic(t.G.Ap.state.mission.musicId,function(te){t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,t.G.Ap.state.mission.musicId)});var G=S.MusicLevelDataLoader.getItemInfoByMid(t.G.Ap.state.mBattleSettlement.mMid);if(G.mGameComsume)if(M.MoneySystem.getHpCount()>=G.mGameComsume.spendEnergy){var K=this.getPlayAgainBtnPos();this.playEnergyAnim(K,function(){M.MoneySystem.consumeHp(G.mGameComsume.spendEnergy),u.default.play(u.default.NAME_CONSUME_LIFE,u.default.PATH_CONSUME_LIFE,!1),t.G.Ap.state.reset(!1),t.G.Ap.config.loadMusic(t.G.Ap.state.mission.musicId,function(te){t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,t.G.Ap.state.mission.musicId)})})}else this.toEnergyDialog();else{var X=_.default.Ins().getPlugin(y.default.Plugin_Energy);X.isCurEnergyEnough()?(K=this.getPlayAgainBtnPos(),this.playEnergyAnim(K,function(){u.default.play(u.default.NAME_CONSUME_LIFE,u.default.PATH_CONSUME_LIFE,!1),V.default.needTryInviteSkinSpecSong(G.musicId)?e.default.fire(n.default.SPEC_SONG_TRY_SKIN_RESULT):(X.decreaseEnergy(1),t.G.Ap.state.reset(!1),t.G.Ap.config.loadMusic(t.G.Ap.state.mission.musicId,function(te){t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,t.G.Ap.state.mission.musicId)}))})):this.toEnergyDialog()}},O.prototype.playAgain=function(w,G){G===void 0&&(G=!0);var K=null;if(K=w==null||w==null?S.MusicLevelDataLoader.getItemInfoByMid(t.G.Ap.state.mBattleSettlement.mMid):w,console.warn("playAgain => spendEnergy:"+G),G==0)w==null||w==null?t.G.Ap.state.reset(!1):(t.G.Ap.state.reset(),t.G.Ap.state.mission=new I.Mission(K.id,K.musicId,!1)),t.G.Ap.config.loadMusic(t.G.Ap.state.mission.musicId,function(te){t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,t.G.Ap.state.mission.musicId)});else if(K.mGameComsume)M.MoneySystem.getHpCount()>=K.mGameComsume.spendEnergy?(M.MoneySystem.consumeHp(K.mGameComsume.spendEnergy),u.default.play(u.default.NAME_CONSUME_LIFE,u.default.PATH_CONSUME_LIFE,!1),w==null||w==null?t.G.Ap.state.reset(!1):(t.G.Ap.state.reset(),t.G.Ap.state.mission=new I.Mission(K.id,K.musicId,!1)),t.G.Ap.config.loadMusic(t.G.Ap.state.mission.musicId,function(te){t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,t.G.Ap.state.mission.musicId)})):this.toEnergyDialog();else{var X=_.default.Ins().getPlugin(y.default.Plugin_Energy);if(X.isCurEnergyEnough()){if(u.default.play(u.default.NAME_CONSUME_LIFE,u.default.PATH_CONSUME_LIFE,!1),V.default.needTryInviteSkinSpecSong(K.musicId))return void e.default.fire(n.default.SPEC_SONG_TRY_SKIN_RESULT);X.decreaseEnergy(1),w==null||w==null?t.G.Ap.state.reset(!1):(t.G.Ap.state.reset(),t.G.Ap.state.mission=new I.Mission(K.id,K.musicId,!1)),t.G.Ap.config.loadMusic(t.G.Ap.state.mission.musicId,function(te){t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,t.G.Ap.state.mission.musicId)})}else this.toEnergyDialog()}},O.prototype.goHomeBtnClickCallback=function(){this.hideBanner("\u53BB\u4E3B\u9875");var w=E.default.read(R.default.OPEN_GAMEOVER_FROM);C.default.DefaultPageIndex=w=="1"?C.default.GAME_ENTRA_SCENE_INDEX.MUSIC_LIB_INDEX:w=="2"?C.default.GAME_ENTRA_SCENE_INDEX.TO_HOT_INDEX:C.default.GAME_ENTRA_SCENE_INDEX.HOMEPAGE_INDEX,t.G.Ap.presenter.enterScene("MainScene"),E.default.pushAsync()},O.prototype.energyClickCallback=function(){this.toEnergyDialog()},O.prototype.goldClickCallback=function(){var w=this;ee.default.load("prefab/PlayerInfoPopupProfab",function(G,K){if(K&&cc.isValid(w,!0)){w.hideBanner("\u91D1\u5E01\u51FA\u73B0");var X=K.getComponent(ge.default);X.setCloseSelfCallback(function(){K.destroy(),w.mInviteLayout.childrenCount==0&&w.showBanner("\u91D1\u5E01\u5173\u95ED")}),w.mTipsLayout.node.addChild(K),X.playerGoldBtnClick(0)}else b.default.e("[GameOver] load PlayerInfoPopupProfab error = "+G)})},O.prototype.diamondClickCallback=function(){var w=this;ee.default.load("prefab/PlayerInfoPopupProfab",function(G,K){if(K&&cc.isValid(w,!0)){w.hideBanner("\u94BB\u77F3\u51FA\u73B0");var X=K.getComponent(ge.default);X.setCloseSelfCallback(function(){K.destroy(),w.mInviteLayout.childrenCount==0&&w.showBanner("\u94BB\u77F3\u5173\u95ED")}),w.mTipsLayout.node.addChild(K),X.playerDiamondBtnClick(0)}else b.default.e("[GameOver] load PlayerInfoPopupProfab error = "+G)})},O.prototype.hpCallback=function(w,G){G<=0?this.mTimeCountdownPanel.node.active=!1:(this.mTimeCountdownLabel.string=o.default.convertSecondToMinutesSecond(G),this.mTimeCountdownPanel.node.active=!0)},O.prototype.onChange=function(w,G,K,X,te){this.mTopGoldCountLabel.string=G+"",this.mTopEnergyCountLabel.string=w+"",this.mTopDiamondLabel.string=K+""},O.prototype.registerShowRankPageEvent=function(){e.default.register(n.default.ON_RESULT_RANK_BACK_CLICK,this.showBanner,this)},O.prototype.unRegisterShowRankPageEvent=function(){e.default.remove(n.default.ON_RESULT_RANK_BACK_CLICK,this.showBanner,this)},O.prototype.showGiftBoxOrUpdateDialog=function(w){var G=this;this.isGiftBox()?this.showGiftBox(w):Se.default.getInstance().isEnglish()&&100001<w.mMid?this.levelVideoSkin(w,0):w.mIsUpLevel?this.showUpdateDialog(w):cc.sys.platform==cc.sys.QQ_PLAY?this.onTipsFinish(w):this.showDiamondGiftPopup(w,function(K){K?U.default.needShowShareGiftByToggle(1,function(X){X&&G.showShareForGiftPrefb()}):(G.mInviteLayout.childrenCount==0&&(G.isShareForGiftShow||G.isNewRecordShow||G.isGiftBoxShow||G.isInviteSongShow||G.isInviteSkinShow||G.isFirstPayShow||G.showBanner(" showGiftBoxOrUpdateDialog \u6700\u540E\u4E00\u4E2Aelse")),G.scheduleOnce(function(){Te.default.getInstance().gotoPage(G.node,"GameOverPrefab")},.1))})},O.prototype.isGiftBox=function(){return 0<k.default.getInstance().getGainChestTotal()},O.prototype.levelVideoSkin=function(w,G){var K=this,X=ie.SkinDataMgr.Ins().getSkinListExceptDefault()[5],te=t.G.Ap.state.mBattleSettlement;X.isLock&&(0<te.mStar||0<te.mCrown)?ee.default.load("prefab/LevelVideoGetSkinPrefab",function(ne,ae){if(ae){K.mTipsLayout.node.addChild(ae);var le=ae.getComponent(Be.default);le&&(le.closeCallback=function(){K.showOtherPopup.bind(K,w,G),Te.default.getInstance().gotoPage(K.node,"GameOverPrefab")})}}):this.isShareForGiftShow||this.isNewRecordShow||this.isGiftBoxShow||this.isInviteSongShow||this.isInviteSkinShow||this.isFirstPayShow||Te.default.getInstance().gotoPage(this.node,"GameOverPrefab")},O.prototype.showGiftBox=function(w){var G=this;this.isGiftBoxShow=!0,ee.default.load("prefab/GiftMaskLayoutPrefb",function(K,X){if(X){G.hideBanner("\u793C\u5305\u52A8\u753B\u51FA\u73B0",!0),X.name="giftBox";var te=X.getComponent(p.default);te.setOnAwardTipsClickCallback(function(ne){N.default.Ins().pop("GiftBoxPage"),X.destroy(),G.toSkinPage(),G.scheduleOnce(function(){Te.default.getInstance().gotoPage(G.node,"GameOverPrefab")},.1)}),te.setOkayListener(function(ne,ae){N.default.Ins().pop("GiftBoxPage"),X.destroy(),Te.default.getInstance().gotoPage(G.node,"GameOverPrefab"),ae||G.onGiftBoxClose(ne,w)}),G.mTipsLayout.node.addChild(X),N.default.Ins().push("GiftBoxPage")}else b.default.e("[GameOver] load GiftMaskLayoutPrefb error = "+K),G.showLevelVideoPopup(w,0)})},O.prototype.toSkinPage=function(){this.isGiftBoxShow=!1,C.default.DefaultPageIndex=C.default.GAME_ENTRA_SCENE_INDEX.TO_SKIN_PAGE,t.G.Ap.presenter.enterScene("MainScene")},O.prototype.onGiftBoxClose=function(w,G){if(this.isGiftBoxShow=!1,console.log("[GameOver Gift] destroy GiftBoxDialog onGiftBoxClose.... reward ="+w),w&&w.skinPieces&&0<w.skinPieces.length)this.showLevelVideoPopup(G,w.gold);else{console.log("[GameOver Gift] destroy GiftBoxDialog by okay no jigswa");var K=w?w.gold:0;this.showLevelVideoPopup(G,K)}},O.prototype.showLevelVideoPopup=function(w,G){console.log("[zhangfu] game over show other popup ... gold = "+G+", levelRecord = "+w),Se.default.getInstance().isEnglish()&&100001<w.mMid?this.levelVideoSkin(w,G):w.mIsUpLevel?this.showUpdateDialog(w):cc.sys.platform==cc.sys.QQ_PLAY?this.onTipsFinish(w):this.isShareForGiftShow||this.isNewRecordShow||this.isGiftBoxShow||this.isInviteSongShow||this.isInviteSkinShow||this.isFirstPayShow||this.showBanner("show other popup \u6700\u540E\u4E00\u4E2Aelse"),this.mRewardCoin+=G,this.showGoldAndExp()},O.prototype.showOtherPopup=function(w,G){console.log("[zhangfu] game over show other popup ... gold = "+G+", levelRecord = "+w),w.mIsUpLevel?this.showUpdateDialog(w):cc.sys.platform==cc.sys.QQ_PLAY?this.onTipsFinish(w):this.isShareForGiftShow||this.isNewRecordShow||this.isGiftBoxShow||this.isInviteSongShow||this.isInviteSkinShow||this.isFirstPayShow||this.showBanner("show other popup \u6700\u540E\u4E00\u4E2Aelse"),this.mRewardCoin+=G,this.showGoldAndExp()},O.prototype.showUpdateDialog=function(w){var G=this;ee.default.load("prefab/UpdateDialog",function(K,X){if(X){G.hideBanner("\u5347\u7EA7\u51FA\u73B0");var te=X.getComponent(h.default),ne=s.default.Ins();te.setData(ne.getUserLevel(),t.G.Ap.state.mBattleSettlement.mMusicId,t.G.Ap.state.mBattleSettlement.mMusicName,t.G.Ap.state.mBattleSettlement.mScore),te.setListener(function(){N.default.Ins().pop("UpdatePage"),X.destroy(),ee.default.load("prefab/UpdateContent",function(le,ce){if(ce){var fe=ce.getComponent(f.default);fe.setData(ne.getUserLevel()),fe.setListener(function(){N.default.Ins().pop("UpdateContentPage"),ce.destroy(),G.onTipsFinish(w),G.scheduleOnce(function(){Te.default.getInstance().gotoPage(G.node,"GameOverPrefab")},.1)}),G.mTipsLayout.node.addChild(ce),N.default.Ins().push("UpdateContentPage")}else b.default.e("[GameOver] load UpdateContent error = "+le)});var ae=g.default.Ins().getDBRow(g.eDataBase.eDB_Lv,ne.getUserLevel()+"").getRewarGold();_.default.Ins().getPlugin(y.default.Plugin_Economy).gainGold(ae),G.mRewardCoin+=ae,G.showGoldAndExp()}),G.mTipsLayout.node.addChild(X),N.default.Ins().push("UpdatePage")}else b.default.e("[GameOver] load UpdateDialog error = "+K)})},O.prototype.showGoldAndExp=function(){this.mRewardGoldLabel.string="+ "+this.mRewardCoin,this.mRewardExpLabel.string="+ "+this.mRewardExp},O.prototype.getPlayAgainBtnPos=function(){var w=this.mTryAgainButton.node.parent.convertToWorldSpaceAR(this.mTryAgainButton.node.getPosition());return this.node.convertToNodeSpaceAR(w)},O.prototype.playNextMusic=function(w){var G=this.getNextMusicBtnPos();this.playEnergyAnim(G,function(){V.default.needTryInviteSkinSpecSong(w.music.mid)?e.default.fire(n.default.SPEC_SONG_TRY_SKIN_RESULT):(_.default.Ins().getPlugin(y.default.Plugin_Energy).decreaseEnergy(1),t.G.Ap.state.reset(),t.G.Ap.state.mission=new I.Mission(w.id,w.music.mid,!1),t.G.Ap.config.loadMusic(w.music.mid,function(K){t.G.Ap.presenter.enterScene(t.G.GAME_SCENE_NAME,w.music.mid)}))})},O.prototype.getNextMusicBtnPos=function(){var w=this.mGoNextButton.node.parent.convertToWorldSpaceAR(this.mGoNextButton.node.getPosition());return this.node.convertToNodeSpaceAR(w)},O.prototype.playEnergyAnim=function(w,G){var K=this;this.showEventStopNode(),this.mEnergyAnimPanel.active=!0,this.scheduleOnce(function(){var X=cc.moveTo(.5,w),te=cc.sequence(X,cc.callFunc(function(){var ne=K.mEnergyAnimPanel.getComponent(cc.Animation);ne.on("finished",function(){G(),K.hideEventStopNode(),K.mEnergyAnimPanel.stopAllActions()},K),ne.play("heart_anim")}));K.mEnergyAnimPanel.runAction(te)},.02)},O.prototype.onDestroy=function(){this.mbDestroyed=!0,z.MGAdv.hideBanner(W.ADScene.GAME_RESULT_BANNER),z.MGAdv.destroyBanner(W.ADScene.GAME_RESULT_BANNER),H.ToastPopManager.getIns().destroy(),s.default.Ins().removeUserListener(this),r.User.UserInfoManager.unRegisterHpReviveListener(this.hpCallback,this),this.unRegisterShowRankPageEvent(),e.default.remove(n.default.SHARE_RESULT_SHOW_INVITE_TIPS,this.showInviteTipsPopup,this),e.default.remove(n.default.SPEC_SONG_TRY_SKIN_RESULT,this.specSongTrySkin,this),cc.sys.garbageCollect(),this.stopGameBoxAnim(),this.unscheduleAllCallbacks()},O.prototype.adaptorUI=function(){A.SUtil.ins().isLiuHai()?(A.SUtil.ins().toTop(this.mTopIconPanel,5.6),A.SUtil.ins().toTop(this.mEnergyAnimPanel,5.2),A.SUtil.ins().toTop(this.mMusicNameLabel,15.2),A.SUtil.ins().toTop(this.mRewardStarLayout,19.8),A.SUtil.ins().toTop(this.mRewardCrownLayout,20.8),A.SUtil.ins().toTop(this.mScoreLabel,23.5),A.SUtil.ins().toTop(this.mScoreLabelShadow,23.8),A.SUtil.ins().toTop(this.mRewardPanel,35.4),A.SUtil.ins().toTop(this.mChallengeFriendButton,40),A.SUtil.ins().toTop(this.mBg,0),A.SUtil.ins().toTop(this.mInviteIcon,34.6),A.SUtil.ins().toBottomByPercent(this.mInviteLayout,16.2),A.SUtil.ins().toTop(this.mDlIcon,17.5)):A.SUtil.ins().isQuanMian()&&(A.SUtil.ins().toTop(this.mTopIconPanel,2.5),A.SUtil.ins().toTop(this.mEnergyAnimPanel,2.3),A.SUtil.ins().toTop(this.mMusicNameLabel,14.2),A.SUtil.ins().toTop(this.mRewardStarLayout,19.8),A.SUtil.ins().toTop(this.mRewardCrownLayout,19.7),A.SUtil.ins().toTop(this.mScoreLabel,23.3),A.SUtil.ins().toTop(this.mScoreLabelShadow,23.5),A.SUtil.ins().toTop(this.mRewardPanel,34.9),A.SUtil.ins().toTop(this.mChallengeFriendButton,40.4),A.SUtil.ins().toTop(this.mBg,-2.8),A.SUtil.ins().toTop(this.mInviteIcon,34.6),A.SUtil.ins().toBottomByPercent(this.mInviteLayout,14.8),A.SUtil.ins().toTop(this.mDlIcon,17.5)),this.mTryAgainButton.getComponent(cc.Widget).updateAlignment(),this.mGoNextButton.getComponent(cc.Widget).updateAlignment()},O.prototype.showEventStopNode=function(){this.mStopEventNode.active=!0,this.mStopEventNode.on(cc.Node.EventType.TOUCH_START,function(w){w.stopPropagationImmediate()},this)},O.prototype.hideEventStopNode=function(){this.mStopEventNode.active=!1},O.prototype.showInviteSkinDialog=function(w){this.mInviteLayout.childrenCount==0&&this.showBanner("onTipsFinish ")},O.prototype.onTipsFinish=function(w){var G=this;this.showInviteSkinDialog(w),this.mCheckRewardProcessor&&this.mCheckRewardProcessor.checkInviterReward(),this.showDiamondGiftPopup(w,function(K){K&&U.default.needShowShareGiftByToggle(1,function(X){X&&G.showShareForGiftPrefb()})})},O.prototype.showDiamondGiftPopup=function(w,G){var K=this;if(w){var X=w.mMid,te=w.mId;this.getServerTime(function(ne,ae){var le=null;ne&&(le=new Date(ae));var ce=le?o.default.formatDate(le.valueOf()):"",fe=E.default.read(R.default.SHARE_FOR_GIFT_DAILY_SHOWED_DATE)||"",_e=K.getNormalMusicTimes(),Ae=ce!==fe&&1<_e&&X!==K.MUSIC_ID_1&&X!==K.MUSIC_ID_2&&te<9e3;G(Ae)})}},O.prototype.addNormalMusicTimes=function(){var w=E.default.read(R.default.RESULT_PAGE_TIME_WITH_NORMAL_MUSIC)||"0",G=parseInt(w)+1;E.default.save(R.default.RESULT_PAGE_TIME_WITH_NORMAL_MUSIC,G+"")},O.prototype.getNormalMusicTimes=function(){var w=E.default.read(R.default.RESULT_PAGE_TIME_WITH_NORMAL_MUSIC)||"0";return parseInt(w)},O.prototype.getServerTime=function(w){Y.MGUser.getCurrentServerRealTime({complete:function(G,K){w(G,K)}})},O.prototype.showHotSongShare=function(w,G){var K=this;try{if(!this.shouldShowHotSongShare())return void G(!1);ue.default.isCM()||ee.default.load("prefab/gameover/GameOverHotSongShare",function(X,te){if(te){var ne=te.getComponent(q.default),ae=S.MusicLevelDataLoader.getItemInfoByMid(w.mMid),le=T.LevelMgr.Ins().getLevelInfo(w.mLevel);ne.setData(w.mMid,w.mLevel,i.default.gIns().getLanguageByKey(w.mMusicName),w.mScore,w.mHistoryBestScore,ae?ae.level:0,le?le.mUnlockDiamond:0),ne.setCompleteFunc(function(){N.default.Ins().pop("GameOverHotSongSharePage"),te.destroy(),G(!0)}),K.mTipsLayout.node.addChild(te),N.default.Ins().push("GameOverHotSongSharePage")}else G(!1)})}catch(X){console.log("--- showHotSongShare err: ---"+X),G(!1)}},O.prototype.shouldShowHotSongShare=function(){var w=t.G.Ap.state.mBattleSettlement,G=s.default.Ins().getLevelRecordByMid(w.mMid),K=t.G.getLaunchOption(),X=w.mLevel,te=G.isRecordLocked(),ne=K!==null&&K.query!==null&&te&&X>=c.Constant.CHOICENESS_STARTID&&(parseInt(K.query.source)===J.ShareHelper.SHARE_SOURCE_INVITE_SONG||parseInt(K.query.source)===J.ShareHelper.SHARE_SOURCE_BATTLE_FRIEND);return console.log("--- shouldShowHotSongShare valid: --- "+ne),console.log("--- shouldShowHotSongShare levelId: --- "+X),console.log("--- shouldShowHotSongShare locked: --- "+te),console.log("--- shouldShowHotSongShare params: --- ",K),ne},O.prototype.shouldShowHotMusicBattleTips=function(){return U.default.needShowHotMusicbattleTips()&&!this.shouldShowHotSongShare()},O.prototype.initGuideToAddFav=function(){var w=E.default.read(R.default.HAS_ENTER_FROM_ATTENTION),G=ie.SkinDataMgr.Ins().getOwnedSkin(oe.default.skinName);!j.StringUtil.isEmpty(w)||G&&G.isOwnedPermanent()||this.showFavGuide()},O.prototype.showFavGuide=function(){if(ue.default.isWeiXin()){this.mAddFavIcon.node.active=!0;var w=this.mAddFavIcon.getComponent(cc.Animation);w&&this.scheduleOnce(function(){w.play("guide_to_add_fav")},.1)}else{this.mAddFavIconQQ.node.active=!0;var G=this.mAddFavIconQQ.getComponent(cc.Animation);G&&this.scheduleOnce(function(){G.play("guide_to_add_fav_qq")},.1)}this.adaptorFav()},O.prototype.adaptorFav=function(){var w=A.SUtil.ins();b.default.e("ScreenRatio:"+w.mScreenRatio),ue.default.isWeiXin()?w.isLiuHai()?w.toTopByPx(this.mAddFavIcon,40):w.isQuanMian()?w.toTopByPx(this.mAddFavIcon,30):w.isPuTong()&&w.toTopByPx(this.mAddFavIcon,10):ue.default.isQQ()},__decorate([se(cc.Layout)],O.prototype,"mTopIconPanel",void 0),__decorate([se(cc.Button)],O.prototype,"mTopEnergyIconPanel",void 0),__decorate([se(cc.Label)],O.prototype,"mTimeCountdownLabel",void 0),__decorate([se(cc.Layout)],O.prototype,"mTimeCountdownPanel",void 0),__decorate([se(cc.Sprite)],O.prototype,"mTopEnergyIcon",void 0),__decorate([se(cc.Label)],O.prototype,"mTopEnergyCountLabel",void 0),__decorate([se(cc.Button)],O.prototype,"mTopGoldPanel",void 0),__decorate([se(cc.Label)],O.prototype,"mTopGoldCountLabel",void 0),__decorate([se(cc.Button)],O.prototype,"mTopDiamondPanel",void 0),__decorate([se(cc.Label)],O.prototype,"mTopDiamondLabel",void 0),__decorate([se(cc.Label)],O.prototype,"mMusicNameLabel",void 0),__decorate([se(cc.Label)],O.prototype,"mScoreLabel",void 0),__decorate([se(cc.Label)],O.prototype,"mScoreLabelShadow",void 0),__decorate([se(cc.Layout)],O.prototype,"mRewardStarLayout",void 0),__decorate([se(cc.Layout)],O.prototype,"mRewardCrownLayout",void 0),__decorate([se(cc.Sprite)],O.prototype,"mRewardStarIcon1",void 0),__decorate([se(cc.Sprite)],O.prototype,"mRewardStarIcon2",void 0),__decorate([se(cc.Sprite)],O.prototype,"mRewardStarIcon3",void 0),__decorate([se(cc.Sprite)],O.prototype,"mRewardCrownIcon1",void 0),__decorate([se(cc.Sprite)],O.prototype,"mRewardCrownIcon2",void 0),__decorate([se(cc.Sprite)],O.prototype,"mRewardCrownIcon3",void 0),__decorate([se(cc.Label)],O.prototype,"mRewardGoldLabel",void 0),__decorate([se(cc.Label)],O.prototype,"mRewardExpLabel",void 0),__decorate([se(cc.Button)],O.prototype,"mGoHomeButton",void 0),__decorate([se(cc.Button)],O.prototype,"mGoNextButton",void 0),__decorate([se(cc.Button)],O.prototype,"mGoNextLabel",void 0),__decorate([se(cc.Button)],O.prototype,"mTryAgainButton",void 0),__decorate([se(cc.Label)],O.prototype,"mGoNextConditionLable",void 0),__decorate([se(cc.Button)],O.prototype,"mChallengeFriendButton",void 0),__decorate([se(cc.Node)],O.prototype,"mEnergyAnimPanel",void 0),__decorate([se(cc.Layout)],O.prototype,"mTipsLayout",void 0),__decorate([se(cc.Node)],O.prototype,"mGlobalRankLayout",void 0),__decorate([se(cc.Layout)],O.prototype,"mRankDialogLayout",void 0),__decorate([se(cc.Layout)],O.prototype,"mToastPopLayout",void 0),__decorate([se(cc.Sprite)],O.prototype,"mNextBtnBgSprite",void 0),__decorate([se(cc.Sprite)],O.prototype,"mNewRecordIcon",void 0),__decorate([se(cc.Sprite)],O.prototype,"mLockNextSprite",void 0),__decorate([se(cc.Node)],O.prototype,"mRewardPanel",void 0),__decorate([se(cc.Sprite)],O.prototype,"mBg",void 0),__decorate([se(cc.Sprite)],O.prototype,"mSeeAllBtn",void 0),__decorate([se(cc.Label)],O.prototype,"mSeeAllLabel",void 0),__decorate([se(cc.Node)],O.prototype,"mStopEventNode",void 0),__decorate([se(cc.Sprite)],O.prototype,"mShareForGiftBg",void 0),__decorate([se(cc.Sprite)],O.prototype,"mLoadingIcon",void 0),__decorate([se(cc.Node)],O.prototype,"mGuideLayout",void 0),__decorate([se(cc.Sprite)],O.prototype,"mInviteIcon",void 0),__decorate([se(cc.Node)],O.prototype,"mInviteLayout",void 0),__decorate([se(cc.Sprite)],O.prototype,"mHotMusicBattleTips",void 0),__decorate([se(cc.Sprite)],O.prototype,"mToHomeBtnRedSpot",void 0),__decorate([se(cc.Sprite)],O.prototype,"mAddFavIcon",void 0),__decorate([se(cc.Sprite)],O.prototype,"mAddFavIconQQ",void 0),__decorate([se(cc.Sprite)],O.prototype,"mDlIcon",void 0),__decorate([se(cc.Layout)],O.prototype,"mGameBoxLayout",void 0),__decorate([se(cc.Sprite)],O.prototype,"mGameBoxIcon1",void 0),__decorate([se(cc.Sprite)],O.prototype,"mGameBoxIcon2",void 0),__decorate([se(cc.Sprite)],O.prototype,"mGameBoxIcon3",void 0),__decorate([se(cc.Sprite)],O.prototype,"mGameBoxIcon4",void 0),__decorate([se(cc.Button)],O.prototype,"mNextLabelButton",void 0),O=__decorate([Ue],O)}(cc.Component);m.default=He,cc._RF.pop()},{"../../../modules/MGAdv/scripts/Logic/MGAdvDefine":"MGAdvDefine","../../../modules/MGAdv/scripts/Logic/MGAdvEntrance":"MGAdvEntrance","../../../modules/MGAppShare/scripts/ShareHelper":"ShareHelper","../../../modules/MGUser/scripts/Logic/MGUserEntrance":"MGUserEntrance","../../../modules/MGUtils/MGPlatform":"MGPlatform","../../base/G":"G","../../base/Log":"Log","../../base/State":"State","../../config/LSKey":"LSKey","../../config/RemoteCfgMgr":"RemoteCfgMgr","../../infoc/m_p2_Uaction":"m_p2_Uaction","../../util/PU":"PU","../../util/PageHeap":"PageHeap","../../util/QQReport":"QQReport","../../util/SUtil":"SUtil","../../util/SceneMusicMgr":"SceneMusicMgr","../../util/SceneMusicUtil":"SceneMusicUtil","../../util/StringUtil":"StringUtil","../../util/TimeUtil":"TimeUtil","../Core/GameDefine":"GameDefine","../DB/DBMgr":"DBMgr","../Logic/ChestManager":"ChestManager","../Logic/EventBus":"EventBus","../Logic/I18nManager":"I18nManager","../Logic/LangMgr":"LangMgr","../Logic/LevelMgr":"LevelMgr","../Logic/MoneySystem":"MoneySystem","../Logic/NotifyEvent":"NotifyEvent","../Logic/PlayerMgr":"PlayerMgr","../Logic/Plugin/IPlugin":"IPlugin","../Logic/Plugin/PluginMgr":"PluginMgr","../Logic/SkinDataManager":"SkinDataManager","../Network/Protocol/StorageUtil":"StorageUtil","../UI/GameEntraScene/BasicTouchEvent":"BasicTouchEvent","../UI/GameEntraScene/CheckRewardProcessor":"CheckRewardProcessor","../UI/GameEntraScene/GameEntranceScene":"GameEntranceScene","../UI/GameEntraScene/ImgCache":"ImgCache","../UI/GameEntraScene/PopupDlg":"PopupDlg","../UI/GameEntraScene/PrefabMgr":"PrefabMgr","../UI/GameEntraScene/ToastPopManager":"ToastPopManager","../UI/GameEntraScene/gameover/GameOverHotSongShare":"GameOverHotSongShare","../UI/GameEntraScene/mainpage/AttentionPrefab":"AttentionPrefab","../UI/MusicLevelDataLoader":"MusicLevelDataLoader","../UI/UserInfoManager":"UserInfoManager","../UI/playerInfoPopup/PlayerInfoPopupProfab":"PlayerInfoPopupProfab","../challengeCompetition/TipsDialog":"TipsDialog","../keypad/KeypadNavigator":"KeypadNavigator","../shop/DialogOneButtonPrefab":"DialogOneButtonPrefab","../skin/SkinUtils":"SkinUtils","../task/TaskItem":"TaskItem","../task/TaskSystem":"TaskSystem","./GameOverHotSong":"GameOverHotSong","./GameOverInviteSKin":"GameOverInviteSKin","./GameOverPopupUtil":"GameOverPopupUtil","./GiftBoxDialog":"GiftBoxDialog","./LevelVideoGetSkinPrefab":"LevelVideoGetSkinPrefab","./UpdateContent":"UpdateContent","./UpdateDialog":"UpdateDialog"}],"mgb_sdk.d":[function(l,P,m){"use strict";cc._RF.push(P,"36ec20IHRRNBomJRwIMel/c","mgb_sdk.d"),cc._RF.pop()},{}],"mgrpt_sdk.d":[function(l,P,m){"use strict";cc._RF.push(P,"79b82CG1FNBLJHl1p+3Hd3n","mgrpt_sdk.d"),cc._RF.pop()},{}],minigame_piano2_arena_fail:[function(l,P,m){"use strict";cc._RF.push(P,"5686afD/r5BYolL0ZrqL/49","minigame_piano2_arena_fail"),Object.defineProperty(m,"__esModule",{value:!0});var d=l("./BIReportI"),s=l("../base/G"),r=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.getTableID=function(){return 177},e.prototype.setFailId=function(n){return this.set("fail_id",n),this},e.prototype.setNetWork=function(n){return this.set("network_type",n),this},e.report=function(n){new e().setFailId(n).setNetWork(s.G.networkType).reportData()},e}(d.default);m.default=r,cc._RF.pop()},{"../base/G":"G","./BIReportI":"BIReportI"}],minigame_piano2_crash:[function(l,P,m){"use strict";cc._RF.push(P,"f2e9f9B6nRAwZLM34IHjs5X","minigame_piano2_crash"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.report=function(o,e,n,t,i,a,u,c){var p=new r;p.set("bugid",o),p.set("gameid",e),p.set("gameversion",n),p.set("appid",t),p.set("nickname",i),p.set("dumpkey",a),p.set("message",u),p.set("stack",c),p.reportData()},r.prototype.getTableID=function(){return 161},r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],minigame_piano2_hotmusic:[function(l,P,m){"use strict";cc._RF.push(P,"42afeCqycNMKpx4ULWBfuPK","minigame_piano2_hotmusic"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.setAction=function(o){return this.set("action",o),this},r.prototype.setSource=function(o){return this.set("source",o),this},r.prototype.setID=function(o){return this.set("music_id",o+""),this},r.prototype.setName=function(o){return this.set("music_name",o),this},r.prototype.setType=function(o){return this.set("music_type",o),this},r.report=function(o,e,n,t,i){new r().setAction(o).setSource(e).setID(n).setName(t).setType(i).reportData()},r.prototype.getTableID=function(){return 139},r.ACTION_SHOW=1,r.ACTION_CLICK_SHARE=2,r.ACTION_CLICK_TRY=3,r.ACTION_CLICK_START=4,r.ACTION_CLICK_DIAMOND_UNLOCK=6,r.ACTION_CLICK_GOLD_UNLOCK=7,r.ACTION_DIAMOND_UNLOCK_SUCC=8,r.ACTION_GOLD_UNLOCK_SUCC=9,r.ACTION_INVITE_SUCC=10,r.ACTION_SHOW_UNLOCK_CONFIRM_DIALOG=11,r.ACTION_SHOW_UNLOCK_CONFIRM_DIALOG_CLICK_CANCEL=12,r.ACTION_SHOW_UNLOCK_CONFIRM_DIALOG_CLICK_OK=13,r.ACTION_SHOW_BUY_DIAMOND_DIALOG=14,r.ACTION_CLICK_UNLOCK_BY_VIDEO=15,r.SOURCE_HOME_PAGE=1,r.SOURCE_TAB=2,r.SOURCE_DIALOG=3,r.TYPE_ACTIVITY=1,r.TYPE_HOT=2,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],minigame_piano2_leave_page:[function(l,P,m){"use strict";cc._RF.push(P,"12c780uVSBIVaPuRRQFa/zt","minigame_piano2_leave_page"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.prototype.getTableID=function(){return 166},r.report=function(o){if(cc.sys.platform==cc.sys.WECHAT_GAME){var e=new r;e.set("leave_page",o),e.reportData()}},r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],minigame_piano2_pintu:[function(l,P,m){"use strict";cc._RF.push(P,"d42d6JHP49DIL4jtdPOLDOn","minigame_piano2_pintu"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(s){function r(){return s!==null&&s.apply(this,arguments)||this}return __extends(r,s),r.report=function(o,e,n,t,i){new r().setSource(o).setAction(e).setId(n).setUseCount(i).setGetCount(t).reportData()},r.prototype.setSource=function(o){return s.prototype.set.call(this,"source",o),this},r.prototype.setAction=function(o){return s.prototype.set.call(this,"action",o),this},r.prototype.setGetCount=function(o){return s.prototype.set.call(this,"pintu_get_num",o),this},r.prototype.setUseCount=function(o){return s.prototype.set.call(this,"pintu_use_num",o),this},r.prototype.setId=function(o){return s.prototype.set.call(this,"pintu_id",o),this},r.prototype.getTableID=function(){return 143},r.SOURCE_DAILY=11,r.SOURCE_GAME_GIFT_BOX=12,r.SOURCE_SHARE_GET_CHIP=13,r.SOURCE_EXCHANGE_GIFT=21,r.ACTION_GET_CHIP=1,r.ACTION_USE_CHIP=2,r.CHIP_NUMBER_1=1,r.CHIP_NUMBER_2=2,r.CHIP_NUMBER_3=3,r.CHIP_NUMBER_4=4,r.CHIP_NUMBER_5=5,r.CHIP_NUMBER_6=6,r.CHIP_NUMBER_7=7,r.CHIP_NUMBER_8=8,r.CHIP_NUMBER_9=9,r}(l("./BIReportI").default);m.default=d,cc._RF.pop()},{"./BIReportI":"BIReportI"}],"polyglot.min":[function(l,P,m){"use strict";cc._RF.push(P,"e26fd9yy65A4q3/JkpVnFYg","polyglot.min");var d,s,r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};d=void 0,s=function(o){function e(c){c=c||{},this.phrases={},this.extend(c.phrases||{}),this.currentLocale=c.locale||"en",this.allowMissing=!!c.allowMissing,this.warn=c.warn||t}function n(c,p,h){var f,g,_,y,S,I,v;return h!=null&&c?(_=(g=c.split(i))[y=p,S=h,a[I=y,v=function(C){var T,E,A,M={};for(T in C)if(C.hasOwnProperty(T))for(A in E=C[T])M[E[A]]=T;return M}(u),v[I]||v.en](S)]||g[0],f=_.replace(/^\s+|\s+$/g,"")):f=c,f}function t(c){o.console&&o.console.warn&&o.console.warn("WARNING: "+c)}e.VERSION="0.4.3",e.prototype.locale=function(c){return c&&(this.currentLocale=c),this.currentLocale},e.prototype.extend=function(c,p){var h;for(var f in c)c.hasOwnProperty(f)&&(h=c[f],p&&(f=p+"."+f),(h===void 0?"undefined":r(h))=="object"?this.extend(h,f):this.phrases[f]=h)},e.prototype.clear=function(){this.phrases={}},e.prototype.replace=function(c){this.clear(),this.extend(c)},e.prototype.t=function(c,p){var h,f;return typeof(p=p==null?{}:p)=="number"&&(p={smart_count:p}),typeof this.phrases[c]=="string"?h=this.phrases[c]:typeof p._=="string"?h=p._:this.allowMissing?h=c:(this.warn('Missing translation for key: "'+c+'"'),f=c),typeof h=="string"&&(p=function(g){var _={};for(var y in g)_[y]=g[y];return _}(p),f=function(g,_){for(var y in _)y!=="_"&&_.hasOwnProperty(y)&&(g=g.replace(new RegExp("%\\{"+y+"\\}","g"),_[y]));return g}(f=n(h,this.currentLocale,p.smart_count),p)),f},e.prototype.has=function(c){return c in this.phrases};var i="||||",a={chinese:function(c){return 0},german:function(c){return c!==1?1:0},french:function(c){return 1<c?1:0},russian:function(c){return c%10==1&&c%100!=11?0:2<=c%10&&c%10<=4&&(c%100<10||20<=c%100)?1:2},czech:function(c){return c===1?0:2<=c&&c<=4?1:2},polish:function(c){return c===1?0:2<=c%10&&c%10<=4&&(c%100<10||20<=c%100)?1:2},icelandic:function(c){return c%10!=1||c%100==11?1:0}},u={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};return e},typeof define=="function"&&define.amd?define([],function(){return s(d)}):(m===void 0?"undefined":r(m))=="object"?P.exports=s(d):d.Polyglot=s(d),cc._RF.pop()},{}],"recommender.min":[function(l,P,m){"use strict";cc._RF.push(P,"c9c939o4rhC4qFMKbsEXF8a","recommender.min");var d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s};(function(s,r){for(var o in r)s[o]=r[o]})(window,function(s){var r={};function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return s[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=s,o.c=r,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n||4&n&&(e===void 0?"undefined":d(e))=="object"&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&typeof e!="string")for(var i in e)o.d(t,i,function(a){return e[a]}.bind(null,i));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=2)}([function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0});var e=typeof Symbol=="function"&&d(Symbol.iterator)=="symbol"?function(t){return t===void 0?"undefined":d(t)}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":t===void 0?"undefined":d(t)},n="[recommender]";r.default={isAble:!1,setAble:function(t){this.isAble=t},setPlatform:function(t){this.platform=t},log:function(t){for(var i=arguments.length,a=Array(1<i?i-1:0),u=1;u<i;u++)a[u-1]=arguments[u];var c;this.isAble&&(this.platform=="qq"&&typeof BK!="undefined"&&BK.Script&&BK.Script.log?(a=a.map(function(p){return(p===void 0?"undefined":e(p))=="object"?JSON.stringify(p):p}),(t===void 0?"undefined":e(t))=="object"&&(t=JSON.stringify(t)),BK.Script.log(1,1,t+a.join(" "))):(c=console).log.apply(c,["",n,t].concat(function(p){if(Array.isArray(p)){for(var h=0,f=Array(p.length);h<p.length;h++)f[h]=p[h];return f}return Array.from(p)}(a))))},error:function(t){if(this.isAble){for(var i=arguments.length,a=Array(1<i?i-1:0),u=1;u<i;u++)a[u-1]=arguments[u];var c;this.platform=="qq"&&typeof BK!="undefined"&&BK.Script&&BK.Script.log?BK.Script.log(1,1,t+a.join(" ")):(c=console).error.apply(c,["",n,t].concat(a))}},warn:function(t){for(var i=arguments.length,a=Array(1<i?i-1:0),u=1;u<i;u++)a[u-1]=arguments[u];var c;this.platform=="qq"&&typeof BK!="undefined"&&BK.Script&&BK.Script.log?BK.Script.log(1,1,t+a.join(" ")):(c=console).warn.apply(c,["",n,t].concat(a))}}},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.platform=void 0;var e,n=function(){function a(u,c){for(var p=0;p<c.length;p++){var h=c[p];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}return function(u,c,p){return c&&a(u.prototype,c),p&&a(u,p),u}}(),t=(e=o(0))&&e.__esModule?e:{default:e},i=new(function(){function a(){(function(u,c){if(!(u instanceof a))throw new TypeError("Cannot call a class as a function")})(this)}return n(a,[{key:"request",value:function(u){var c=u.url,p=u.data,h=u.method,f=u.success,g=u.fail;if(t.default.log("\u5F00\u59CB\u8BF7\u6C42\uFF1A",c,"\u6570\u636E\uFF1A",p||""),typeof wx=="undefined"){var _=new XMLHttpRequest;_.onreadystatechange=function(){if(_.readyState==4)if(200<=_.status&&_.status<400){var y=_.responseText;try{y=JSON.parse(y),t.default.log("\u8BF7\u6C42\u6210\u529F\uFF1A",c,"\u56DE\u5305\uFF1A",y)}catch(S){t.default.warn("\u8BF7\u6C42\u5931\u8D25: ",c),g(S)}f&&f(y)}else g&&g("server error: "+_.status)},_.open(h,c,!0),_.setRequestHeader("Content-Type","application/json"),_.send(p)}else wx.request({url:c,data:p||{},header:{"Content-Type":"application/json"},method:h,success:function(y){t.default.log("\u8BF7\u6C42\u6210\u529F\uFF1A",c,"\u56DE\u5305\uFF1A",y),f(y.data)},fail:function(y){t.default.warn("\u8BF7\u6C42\u5931\u8D25: ",c),g(y)}})}},{key:"setStorage",value:function(u,c){try{wx.setStorageSync(u,c)}catch(p){t.default.warn("\u5B58\u50A8\u9519\u8BEF")}}},{key:"getStorage",value:function(u){var c="";try{c=wx.getStorageSync(u)}catch(p){t.default.warn("\u7F13\u5B58\u83B7\u53D6\u9519\u8BEF")}return c}},{key:"setTimeout",value:function(u){function c(p,h){return u.apply(this,arguments)}return c.toString=function(){return u.toString()},c}(function(u,c){return setTimeout(u,c)})},{key:"clearTimeout",value:function(u){function c(p){return u.apply(this,arguments)}return c.toString=function(){return u.toString()},c}(function(u){clearTimeout(u)})}]),a}());r.platform=i},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.Recommender=void 0;var e=function(){function h(f,g){for(var _=0;_<g.length;_++){var y=g[_];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(f,y.key,y)}}return function(f,g,_){return g&&h(f.prototype,g),_&&h(f,_),f}}(),n=u(o(3)),t=u(o(0)),i=u(o(5)),a=u(o(6));function u(h){return h&&h.__esModule?h:{default:h}}var c=function(h){var f=this,g=h.appid,_=h.openid,y=h.debug,S=y!==void 0&&y,I=h.env,v=I===void 0?"prod":I,C=h.forceOpen,T=C!==void 0&&C,E=h.forceClose,A=E!==void 0&&E,M=h.onReady,k=h.platform,D=k===void 0?"wx":k;this.checkInstance(),t.default.setAble(S),t.default.setPlatform(D),g?(_||console.warn("\u8BF7\u4F20\u5165\u5F53\u524D\u73A9\u5BB6\u7684openid"),this.appid=g,this.openid=_,this.config=a.default[v],this.env=v,this.forceOpen=T,this.forceClose=A,this.platform=D,this.pause=!1,this.util=n.default.getInstance(this.platform),this.index=0,this.reporter=new i.default({appid:this.appid,openid:this.openid,svr:this.config.svr}),this.changeHandler=null,M&&typeof M=="function"&&(this.readyHandler=M),t.default.log("\u5F53\u524D\u63D2\u4EF6\u73AF\u5883\uFF1A",{dev:"\u5F00\u53D1",pre:"\u9884\u53D1\u5E03",prod:"\u6B63\u5F0F"}[v]),t.default.log("\u5F53\u524D\u63D2\u4EF6\u5E73\u53F0:",this.platform),this.games=[],this.checkPlatform()?Promise.all([this.getConfig(),this.getBlackList()]).then(function(L){var b=L[0];if(b.result===0){var N=b.data;if(!N||!N.advise_list)return t.default.warn("\u540E\u53F0\u56DE\u5305\u9519\u8BEF\uFF0C\u63D2\u4EF6\u5F00\u5173\u5173\u95ED"),void(f.readyHandler&&f.readyHandler(!1,null));var H=f.isInBlackList(L[1]);t.default.log("\u5F53\u524D\u6E20\u9053\u662F\u5426\u4E3A\u9ED1\u540D\u5355\u6E20\u9053:",H.result),H=H&&H.disableGames?H.disableGames:[],t.default.log("\u5F53\u524D\u5C4F\u853D\u6E38\u620F:",H);var R={},F=!0,x=!1,U=void 0;try{for(var B,Q=H[Symbol.iterator]();!(F=(B=Q.next()).done);F=!0)R[B.value]=!0}catch(V){x=!0,U=V}finally{try{!F&&Q.return&&Q.return()}finally{if(x)throw U}}N.IsOpen=N.is_open,f.isLoop=N.is_loop,f.loopTime=N.loop_time||8,f.hejiTime=N.heji_time||8;for(var Z=0;Z<N.advise_list.length;++Z){var z=N.advise_list[Z];z.appid&&z.icon&&!R[z.appid]&&f.games.push({appid:z.appid,icon:z.icon,path:z.path})}if(f.games.length<=0)return t.default.warn("\u6709\u6548\u63A8\u8350\u6E38\u620F\u6570\u4E3A0\uFF0C\u63D2\u4EF6\u5F00\u5173\u5173\u95ED"),void(f.readyHandler&&f.readyHandler(!1,null));if(t.default.log("\u540E\u53F0\u914D\u7F6E\u63D2\u4EF6\u5F00\u5173\uFF1A",N.IsOpen?"\u5F00\u542F":"\u5173\u95ED"),t.default.log("\u8F6E\u64AD\u5F00\u5173",f.isLoop?"\u5F00\u542F":"\u5173\u95ED"),f.isLoop&&(t.default.log("\u8F6E\u64AD\u95F4\u9694",f.loopTime,"\u79D2"),t.default.log("\u5408\u96C6\u64AD\u653E\u65F6\u95F4",f.hejiTime,"\u79D2")),f.forceOpen&&(t.default.log("\u63D2\u4EF6\u5F00\u5173\u5F3A\u5236\u5F00\u542F"),N.IsOpen=!0),f.forceClose&&(t.default.log("\u63D2\u4EF6\u5F00\u5173\u5F3A\u5236\u5173\u95ED"),N.IsOpen=!1),t.default.log("\u6700\u7EC8\u5F53\u524D\u63D2\u4EF6\u5F00\u5173\uFF1A",N.IsOpen?"\u5F00\u542F":"\u5173\u95ED"),t.default.log("\u5F53\u524D\u914D\u7F6E\u63A8\u8350\u6E38\u620F\u4E2A\u6570",N.advise_list.length),t.default.log("\u5F53\u524D\u6709\u6548\u63A8\u8350\u6E38\u620F\u4E2A\u6570",f.games.length),f.initIndex(),f.readyHandler){var W=f.games[f.index];W&&W.appid&&W.icon?(N.IsOpen&&(f.report(W,0,100),f.startLoop()),f.readyHandler(N.IsOpen,W)):(t.default.warn("\u540E\u53F0\u6570\u636E\u9519\u8BEF\uFF0C\u63D2\u4EF6\u5173\u95ED"),f.readyHandler(!1,null))}}else t.default.log("\u540E\u53F0\u62D2\u7EDD\uFF0C\u63D2\u4EF6\u5F00\u5173\u5173\u95ED"),f.readyHandler&&f.readyHandler(!1,null)},function(L){t.default.log("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u63D2\u4EF6\u5F00\u5173\u5173\u95ED\uFF1A",L),f.readyHandler&&f.readyHandler(!1,null)}).catch(function(L){throw L}):(this.platform=="wx"?t.default.log("\u5F53\u524D\u5C0F\u6E38\u620F\u57FA\u7840\u5E93\u7248\u672C\u4E0D\u652F\u6301\u8DF3\u8F6C\u529F\u80FD\uFF0C\u63D2\u4EF6\u5F00\u5173\u5173\u95ED\uFF0C\u8BF7\u53C2\u7167\u6587\u6863 http://open.qqgame.qq.com/mobile/wiki/215/219/219.html \u67E5\u770B\u517C\u5BB9\u76F8\u5173\u5904\u7406"):t.default.log("\u5F53\u524D\u4E0D\u5728\u624BQ\u73AF\u5883\u6216\u662F\u624BQ\u7248\u672C\u8FC7\u4F4E\uFF0C\u4E0D\u652F\u6301\u6E38\u620F\u8DF3\u8F6C\uFF0C\u5177\u4F53\u89C1\u73A9\u4E00\u73A9\u6587\u6863 http://hudong.qq.com/docs/engine/userInfo/other.html"),setTimeout(function(){f.readyHandler&&f.readyHandler(!1,null)},100))):console.error("\u8BF7\u4F20\u5165\u5F53\u524D\u6E38\u620F\u7684appid")};c.prototype={initIndex:function(){if(!this.isLoop){var h=this.util.getStorage("mgplugin-time"),f=this.util.getStorage("mgplugin-index");h!==""&&f!==""?(t.default.log("\u4E0A\u6B21\u8DF3\u8F6C\u7684\u65F6\u95F4",h),t.default.log("\u4E0A\u6B21\u8DF3\u8F6C\u5230\u7684\u6E38\u620F\u5750\u6807",f),this.checkExpired(h)&&f<this.games.length&&(t.default.log("\u8BBE\u7F6E\u4E0A\u6B21\u8DF3\u8F6C\u7684\u6E38\u620F\u5750\u6807"),this.index=f)):t.default.log("\u5F53\u524D\u65E0\u5386\u53F2\u6E38\u620F\u5750\u6807\u8BB0\u5F55")}},setIndex:function(h){this.isLoop||(this.util.setStorage("mgplugin-time",Date.now()),this.util.setStorage("mgplugin-index",h),t.default.log("\u8BBE\u7F6E\u672C\u5730\u7F13\u5B58\u6E38\u620F\u5750\u6807",h))},isInBlackList:function(h){if(this.platform=="wx"&&typeof wx!="undefined"&&wx.getLaunchOptionsSync)if(t.default.log("\u5F53\u524D\u6E20\u9053\u9ED1\u540D\u5355",h),h){var f=wx.getLaunchOptionsSync();if(t.default.log("\u542F\u52A8\u53C2\u6570",f),f&&f.referrerInfo){var g=f.referrerInfo.appId;for(var _ in t.default.log("\u5F53\u524D\u6765\u6E90\u6E20\u9053appid",g),h){var y=h[_];if(y.app_id==g){var S=void 0;try{S=JSON.parse(y.disable_games)}catch(I){S=[]}return{result:!0,disableGames:S}}}}else t.default.log("\u65E0\u6765\u6E90\u6E20\u9053")}else t.default.log("\u9ED1\u540D\u5355\u4E3A\u7A7A");else t.default.log("\u975E\u5FAE\u4FE1\u5E73\u53F0\u6216\u5E73\u53F0\u57FA\u7840\u5E93\u7248\u672C\u8FC7\u4F4E");return{result:!1,disableGames:[]}},checkExpired:function(h){var f=new Date,g=new Date(h);return f.getMonth()==g.getMonth()&&f.getDate()==g.getDate()},checkInstance:function(){c.instance&&c.instance.stopLoop&&c.instance.stopLoop(),c.instance=this},getCurrentGame:function(){return this.games[this.index]},stopLoop:function(){this.loopInterval!==void 0&&this.loopInterval!==null?(t.default.log("\u505C\u6B62\u56FE\u7247\u8F6E\u64AD",this.loopInterval),this.pause=!0,this.clearInterval(this.loopInterval),this.loopInterval=null):t.default.log("\u56FE\u7247\u672A\u8F6E\u64AD")},resumeLoop:function(){this.pause&&(t.default.log("\u6062\u590D\u8F6E\u64AD"),this.pause=!1,this.startLoop())},checkPlatform:function(){if(this.platform=="wx")return typeof wx!="undefined"&&wx.navigateToMiniProgram;if(this.platform=="qq"){var h=!0;return typeof BK!="undefined"&&BK.QQ&&BK.QQ.skipGame||(t.default.warn("\u8BF7\u5F15\u5165\u73A9\u4E00\u73A9\u57FA\u7840\u5E93"),h=!1),GameStatusInfo&&GameStatusInfo.QQVer&&"7.7.0"<=GameStatusInfo.QQVer?h=!0:(h=!1,t.default.log("\u5F53\u524D\u624BQ\u7248\u672C\u8FC7\u4F4E",GameStatusInfo)),h}},changeToNextGame:function(){if(this.index=(this.index+1)%this.games.length,this.setIndex(this.index),1<this.games.length){if(t.default.log("\u5207\u6362\u5230\u4E0B\u4E00\u4E2A\u6E38\u620F\uFF0C\u5E8F\u53F7",this.index+1),this.report(this.games[this.index],this.index,100),this.changeHandler&&typeof this.changeHandler=="function"){var h=this.games[this.index];h&&h.appid&&h.icon?this.changeHandler(h):t.default.warn("\u6E38\u620F\u5B57\u6BB5\u7F3A\u5931")}}else t.default.log("\u5F53\u524D\u6E38\u620F\u914D\u7F6E\u6570\u4E3A\u4E0D\u5927\u4E8E1\uFF0C\u4E0D\u4F1A\u5207\u6362\u6E38\u620F")},jumpToCurrentGame:function(){if(c.clickable){c.clickable=!1;var h=this.games[this.index];h&&h.icon&&h.appid?(t.default.log("\u5F53\u524D\u8DF3\u8F6C\u6E38\u620F",h),this.jumpToGame(h),this.report(h,this.index,101)):t.default.warn("\u6E38\u620F\u4E0D\u5B58\u5728")}else t.default.log("\u60A8\u70B9\u51FB\u7684\u592A\u5FEB\u4E86")},jumpToGame:function(h){var f=this;if(this.platform=="wx"&&(wx.navigateToMiniProgram?wx.navigateToMiniProgram({appId:h.appid,path:h.path||"",extraData:h.extraData||{},success:function(){t.default.log("\u6E38\u620F\u8DF3\u8F6C\u6210\u529F\uFF0Cappid: "+h.appid)},fail:function(){t.default.warn("\u6E38\u620F\u8DF3\u8F6C\u5931\u8D25\uFF0Cappid\uFF1A",h.appid,"\u8BF7\u68C0\u67E5\u662F\u5426\u548C\u76EE\u6807\u8DF3\u8F6C\u5C0F\u6E38\u620F\u7ED1\u5B9A\u5728\u540C\u4E00\u4E2A\u516C\u4F17\u53F7\uFF0C\u6216\u8005\u662F\u5F53\u524D\u9879\u76EE\u662F\u5426\u4F7F\u7528\u4E86\u6B63\u786E\u7684\u5C0F\u6E38\u620Fappid\u3002")},complete:function(){setTimeout(function(){c.clickable=!0},1500),f.isLoop||f.changeToNextGame()}}):t.default.warn("\u5F53\u524D\u5C0F\u6E38\u620F\u57FA\u7840\u5E93\u7248\u672C\u4E0D\u652F\u6301\u8DF3\u8F6C\u529F\u80FD\uFF0C\u57FA\u7840\u5E93\u8981\u6C42\u57282.2.0\u4EE5\u4E0A\uFF0C\u8BF7\u53C2\u7167\u6587\u6863 http://open.qqgame.qq.com/mobile/wiki/215/219/219.html \u67E5\u770B\u517C\u5BB9\u76F8\u5173\u5904\u7406")),this.platform=="qq")if(typeof BK!="undefined"&&BK.QQ&&BK.QQ.skipGame){var g=parseInt(h.appid);t.default.log("\u5F53\u524D\u8DF3\u8F6Cappid "+g),g?BK.QQ.skipGame(g,""):t.default.log("appid\u4E0D\u7B26\u5408\u89C4\u8303"),setTimeout(function(){c.clickable=!0},1500),this.isLoop||this.changeToNextGame()}else t.default.warn("\u5F53\u524D\u4E0D\u5728\u624BQ\u73AF\u5883\u6216\u662F\u624BQ\u7248\u672C\u8FC7\u4F4E\uFF0C\u4E0D\u652F\u6301\u6E38\u620F\u8DF3\u8F6C\uFF0C\u5177\u4F53\u89C1\u73A9\u4E00\u73A9\u6587\u6863 http://hudong.qq.com/docs/engine/userInfo/other.html")},onChange:function(h){typeof h=="function"?this.changeHandler=h:t.default.warn("\u8BF7\u4F20\u5165\u56DE\u8C03\u51FD\u6570")},onReady:function(h){typeof h=="function"?this.readyHandler=h:t.default.warn("\u8BF7\u4F20\u5165\u56DE\u8C03\u51FD\u6570")},getConfig:function(){var h=this;return new Promise(function(f,g){var _=h.platform=="qq"?"qqplay":"mgplugin";h.util.request({url:h.config.svr+"/"+_+"/getadviselist?appid="+h.appid,method:"GET",success:function(y){f(y)},fail:function(y){g(y)}})})},getBlackList:function(){var h=this;return new Promise(function(f,g){h.util.request({url:h.config.cdn+"/mgplugin/data/blacklist.js",method:"GET",success:function(_){f(_)},fail:function(_){t.default.log("\u62C9\u53D6\u9ED1\u540D\u5355\u5931\u8D25",_),f({})}})})},report:function(h,f,g){var _="\u672A\u77E5";g==101&&(_="\u70B9\u51FB"),g==100&&(_="\u66DD\u5149"),t.default.log("\u89E6\u53D1\u4E0A\u62A5\uFF0C\u4E0A\u62A5\u7C7B\u578B\uFF1A",_,"\u6E38\u620F\u5E8F\u53F7\uFF1A",f+1),this.reporter.report({iSceneLevel1:1000001,iSceneLevel2:1,iSceneLevel3:f+1,iActionId:g,iResourceId1:h.appid})},setInterval:function(h){var f=this,g=this.intervalTime();return t.default.log(g,"\u79D2\u540E\u5207\u6362\u5230\u4E0B\u4E00\u4E2A\u6E38\u620F"),c.interval=this.loopInterval=this.util.setTimeout(function(){h(),f.pause||f.setInterval(h)},1e3*g),t.default.log("\u8BBE\u7F6E\u5B9A\u65F6",this.loopInterval),this.loopInterval},clearInterval:function(h){this.util.clearTimeout(h)},getQQGameEntry:function(h){if(this.platform=="wx")var f=new p({appid:this.appid,openid:this.openid,env:this.env,onLoad:function(){h&&h(f)},recommender:this});else t.default.log("\u975E\u5FAE\u4FE1\u5C0F\u6E38\u620F\u5E73\u53F0\uFF0C\u4E0D\u5F00\u542F\u5408\u96C6\u5165\u53E3"),h&&h({isOpen:!1})},intervalTime:function(){return this.getCurrentGame().appid=="wxc2cd6f55732dc1f2"?(t.default.log("\u5F53\u524D\u6E38\u620F\u4E3A\u5408\u96C6\uFF0C\u8F6E\u64AD\u65F6\u95F4\u4E3A",this.hejiTime,"\u79D2"),this.hejiTime):this.loopTime},startLoop:function(){var h=this;if(this.isLoop){c.loopInterval!=null&&(t.default.log("\u5B58\u5728\u591A\u4E2A\u5B9A\u65F6\u5668\uFF0C\u6E05\u9664\u65E7\u5B9A\u65F6\u5668"),this.clearInterval(c.loopInterval));var f=this.setInterval(function(){h?(t.default.log("\u5B9A\u65F6\u5207\u6362\u6E38\u620F"),h.changeToNextGame()):(t.default.log("\u5B9E\u4F8B\u9500\u6BC1\uFF0C\u5B9A\u65F6\u5668\u6E05\u9664"),h.clearInterval(f))})}else t.default.log("\u8F6E\u64AD\u672A\u6253\u5F00\uFF0C\u4E0D\u542F\u52A8\u8F6E\u64AD")}},c.clickable=!0;var p=function(){function h(f){var g=this,_=f.appid,y=_===void 0?"":_,S=f.openid,I=S===void 0?"unknown":S,v=f.env,C=v===void 0?"prod":v,T=f.onLoad,E=f.recommender;(function(A,M){if(!(A instanceof h))throw new TypeError("Cannot call a class as a function")})(this),y?(this.appid=y,this.openid=I,this.config=a.default[C],this.recommender=E,this.reporter=new i.default({appid:this.appid,openid:this.openid,svr:this.config.svr}),this.util=n.default.getInstance("wx"),this.recommender&&this.recommender.getBlackList().then(function(A){g.recommender.isInBlackList(A).result?(t.default.log("\u6E20\u9053\u4E3A\u9ED1\u540D\u5355\u6E20\u9053\uFF0C\u5408\u96C6\u5165\u53E3\u5173\u95ED"),g.isOpen=!1,T&&T()):g.getConfig().then(function(M){if(M.result==0&&M.data){var k=M.data;g.icon=k.icon,g.path=k.path,g.isOpen=k.is_open,t.default.log("\u5F53\u524D\u7684\u5408\u96C6\u56FE\u6807\u914D\u7F6E",k),t.default.log("\u5F53\u524D\u5408\u96C6\u56FE\u6807\u5F00\u5173\uFF1A",k.is_open?"\u5F00\u542F":"\u5173\u95ED"),typeof wx!="undefined"&&wx.navigateToMiniProgram||(t.default.log("\u5F53\u524D\u5C0F\u6E38\u620F\u57FA\u7840\u5E93\u7248\u672C\u4E0D\u652F\u6301\u8DF3\u8F6C\u529F\u80FD\uFF0C\u5408\u96C6\u56FE\u6807\u5F00\u5173\u5173\u95ED"),g.isOpen=!1),g.isOpen&&(c.clickable=!0,g.report(100)),T&&T()}else t.default.log("\u540E\u53F0\u6570\u636E\u9519\u8BEF, \u5408\u96C6\u56FE\u6807\u5F00\u5173\u5173\u95ED",M),g.isOpen=!1,T&&T()},function(M){t.default.log("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u5408\u96C6\u56FE\u6807\u5F00\u5173\u5173\u95ED",M),g.isOpen=!1,onload&&T()})})):console.error("\u8BF7\u4F20\u5165\u5F53\u524D\u6E38\u620F\u7684appid")}return e(h,[{key:"getConfig",value:function(){var f=this;return new Promise(function(g,_){f.util.request({url:f.config.svr+"/heji/getconfig?appid="+f.appid,method:"GET",success:function(y){g(y)},fail:function(y){_(y)}})})}},{key:"getBlackList",value:function(){this.util.request({url:this.config.svr+"/mgplugin/data/blacklist.js",method:"GET",success:function(f){resolve(f)},fail:function(f){reject(f)}})}},{key:"navigateToMiniProgram",value:function(){c.clickable?typeof wx!="undefined"&&wx.navigateToMiniProgram?(c.clickable=!1,this.report(101),wx.navigateToMiniProgram({appId:"wxc2cd6f55732dc1f2",path:this.path||"",extraData:{},success:function(){t.default.log("\u5408\u96C6\u8DF3\u8F6C\u6210\u529F")},fail:function(){t.default.warn("\u5408\u96C6\u8DF3\u8F6C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u662F\u5426\u548C\u5408\u96C6\u5C0F\u7A0B\u5E8F\u7ED1\u5B9A\u5728\u540C\u4E00\u4E2A\u516C\u4F17\u53F7\uFF0C\u6216\u8005\u662F\u5F53\u524D\u9879\u76EE\u662F\u5426\u4F7F\u7528\u4E86\u6B63\u786E\u7684\u5C0F\u6E38\u620Fappid\u3002")},complete:function(){setTimeout(function(){c.clickable=!0},1500)}})):t.default.warn("\u5F53\u524D\u5C0F\u6E38\u620F\u57FA\u7840\u5E93\u7248\u672C\u4E0D\u652F\u6301\u8DF3\u8F6C\u529F\u80FD\uFF0C\u57FA\u7840\u5E93\u8981\u6C42\u57282.2.0\u4EE5\u4E0A\uFF0C\u8BF7\u53C2\u7167\u6587\u6863 http://open.qqgame.qq.com/mobile/wiki/215/219/219.html \u67E5\u770B\u517C\u5BB9\u76F8\u5173\u5904\u7406"):t.default.log("\u60A8\u70B9\u51FB\u5F97\u592A\u5FEB\u4E86")}},{key:"report",value:function(f){var g="\u672A\u77E5";f==101&&(g="\u70B9\u51FB"),f==100&&(g="\u66DD\u5149"),t.default.log("\u89E6\u53D1\u5408\u96C6\u4E0A\u62A5\uFF0C\u7C7B\u578B\uFF1A",g),this.reporter.report({iSceneLevel1:1000001,iSceneLevel2:1,iSceneLevel3:1,iActionId:f,iResourceId1:"wxc2cd6f55732dc1f2"})}}]),h}();r.Recommender=c},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0});var e=t(o(1)),n=t(o(4));function t(i){if(i&&i.__esModule)return i;var a={};if(i!=null)for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(a[u]=i[u]);return a.default=i,a}r.default={getInstance:function(i){return i=="qq"?n.platform:i=="wx"?e.platform:void 0}}},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.platform=void 0;var e,n=function(){function p(h,f){for(var g=0;g<f.length;g++){var _=f[g];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(h,_.key,_)}}return function(h,f,g){return f&&p(h.prototype,f),g&&p(h,g),h}}(),t=(e=o(0))&&e.__esModule?e:{default:e},i="GameSandBox://resource/localStorage",a=0,u={},c=new(function(){function p(){(function(h,f){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")})(this)}return n(p,[{key:"request",value:function(h){var f=h.url,g=h.data,_=h.method,y=h.success,S=h.fail;t.default.log("\u5F00\u59CB\u8BF7\u6C42\uFF1A",f,"\u6570\u636E\uFF1A",g||"");var I=new BK.HttpUtil(f);I.setHttpMethod(_),I.setHttpHeader("Content-Type","application/json"),_!="post"&&_!="POST"||I.setHttpPostData(function(v){var C=[];for(var T in v){var E=v[T];C.push(T+"="+E)}return C.join("&")}(g)),I.requestAsync(function(v,C){if(200<=C&&C<400){v=v.readAsString(!0);try{v=JSON.parse(v)}catch(T){t.default.warn("\u8BF7\u6C42\u5931\u8D25\uFF0C\u89E3\u6790\u9519\u8BEF: ",v,T),S&&S(T)}t.default.log("\u8BF7\u6C42\u6210\u529F\uFF1A",f,"\u56DE\u5305\uFF1A",v),y&&y(v)}else t.default.warn("\u8BF7\u6C42\u5931\u8D25: ",f),S&&S(v)})}},{key:"getStorage",value:function(h){if(!BK.FileUtil.isFileExist(i))return"";var f=BK.FileUtil.readFile(i).readAsString();if(!f)return"";var g=void 0;try{g=JSON.parse(f)}catch(_){g={}}return g&&g[h]!==void 0?g[h]:""}},{key:"setStorage",value:function(h,f){var g=BK.FileUtil.readFile(i).readAsString(),_={};if(g){var y=JSON.parse(g);y&&(_=y)}_[h]=f;var S=JSON.stringify(_);return BK.FileUtil.writeFile(i,S),!0}},{key:"setTimeout",value:function(h,f){var g=a;return t.default.log("\u8BBE\u7F6E\u5B9A\u65F6",g),u[g]={listener:h,delay:f},a++,BK.Director.ticker.setTimeout(function(){t.default.log("\u6267\u884C\u5B9A\u65F6",g);var _=u[g];_&&_.listener(),delete u[g]},f),g}},{key:"clearTimeout",value:function(h){t.default.log("\u5220\u9664\u5B9A\u65F6",h),u[h]&&delete u[h]}}]),p}());r.platform=c},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0});var e,n=function(){function c(p,h){for(var f=0;f<h.length;f++){var g=h[f];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,h,f){return h&&c(p.prototype,h),f&&c(p,f),p}}(),t=o(1),i=(e=o(0))&&e.__esModule?e:{default:e},a={dtLoginTime:-1,vQimei:-1,vAppVer:-1,PlatID:-1,vOsType:-1,osversion:-1,nettype:-1,model:-1,iActionId:-1,iSceneLevel1:-1,iSceneLevel2:-1,iSceneLevel3:-1,iResourceId1:-1,iResourceId2:-1,iResourceId3:-1,iResourceId4:-1,iResourceId5:-1,iRet:-1,vV1:-1,vV2:-1,vV3:-1,vV4:-1,vV5:-1,vV6:-1,vV7:-1,vV8:-1,vV9:-1,vV10:-1},u=function(){function c(p){var h=p.appid,f=p.openid,g=p.svr;(function(_,y){if(!(_ instanceof c))throw new TypeError("Cannot call a class as a function")})(this),this.appid=h,this.openid=f,this.svr=g,this.dataTemplate=Object.assign({},a,{iResourceId2:this.appid})}return n(c,[{key:"report",value:function(p){var h=this;return new Promise(function(f,g){p=Object.assign({},h.dataTemplate,p),i.default.log("\u5F00\u59CB\u4E0A\u62A5\uFF1A",p);var _,y,S,I=(_={data:[h.genDataString(p)],type:"0",openid:h.openid,appid:h.appid},y="openid",S=h.openid,y in _?Object.defineProperty(_,y,{value:S,enumerable:!0,configurable:!0,writable:!0}):_[y]=S,_);t.platform.request({url:h.svr+"/mpreport/reportplugintlog",data:I,method:"POST",success:function(){i.default.log("\u4E0A\u62A5\u6210\u529F\uFF1A",p),f()},fail:function(v){i.default.warn("\u4E0A\u62A5\u5931\u8D25\uFF1A",p,v)}})})}},{key:"genDataString",value:function(p){var h=[];return Object.keys(p).forEach(function(f){return h.push(p[f])}),h.join("|")}}]),c}();r.default=u},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0});var e=i(o(7)),n=i(o(8)),t=i(o(9));function i(a){return a&&a.__esModule?a:{default:a}}r.default={dev:e.default,prod:n.default,pre:t.default}},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.default={svr:"https://test.ngo.minigame.qq.com",cdn:"http://mwebtest.minigame.qq.com"}},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.default={svr:"https://goplatform.minigame.qq.com",cdn:"https://platform.minigame.qq.com"}},function(s,r,o){Object.defineProperty(r,"__esModule",{value:!0}),r.default={svr:"https://pre.ngo.minigame.qq.com",cdn:"http://mwebtest.minigame.qq.com"}}])),cc._RF.pop()},{}],scrollview:[function(l,P,m){"use strict";cc._RF.push(P,"f0071ojRF1MMa2jxek7UiAY","scrollview"),Object.defineProperty(m,"__esModule",{value:!0});var d=function(){function e(n){var t=this;this.scrollview=n.scrollview,this.mask=n.mask,this.content=n.content,this.node_pools=new Map,this.item_templates=new Map,n.item_templates.forEach(function(i){i.node.active=!1,t.item_templates.set(i.key,i.node)}),this.dir=n.direction||s.Vertical,this.width=n.width||this.mask.width,this.height=n.height||this.mask.height,this.gap_x=n.gap_x||0,this.gap_y=n.gap_y||0,this.cb_host=n.cb_host,this.item_setter=n.item_setter,this.item_get_size=n.item_get_size,this.recycle_cb=n.recycle_cb,this.scroll_to_end_cb=n.scroll_to_end_cb,this.auto_scrolling=n.auto_scrolling||!1,this.dir==s.Vertical?this.content.width=this.width:this.content.height=this.height,this.mask.setContentSize(this.width,this.height),this.mask.addComponent(cc.Mask),this.scrollview.node.setContentSize(this.width,this.height),this.scrollview.vertical=this.dir==s.Vertical,this.scrollview.horizontal=this.dir==s.Horizontal,this.scrollview.inertia=!0,this.scrollview.node.on("scrolling",this.on_scrolling,this),this.scrollview.node.on("scroll-to-bottom",this.on_scroll_to_end,this),this.scrollview.node.on("scroll-to-right",this.on_scroll_to_end,this),this.scrollview.node.on("scroll-ended",this.on_scroll_ended,this)}return e.prototype.setOnScrollToTopListener=function(n){this.mOnScorllToHead=n},e.prototype.on_scroll_ended=function(n){this.start_index==0&&this.mOnScorllToHead&&this.mOnScorllToHead()},e.prototype.on_scroll_to_end=function(n){this.scroll_to_end_cb&&this.scroll_to_end_cb.call(this.cb_host)},e.prototype.on_scrolling=function(n){if(this.items&&this.items.length)if(this.dir==s.Vertical){var t=this.content.y;t<0&&(t=0),t>this.content.height-this.height&&(t=this.content.height-this.height);for(var i=0,a=this.items.length-1,u=(p=-t)-this.height;this.items[i].y-this.items[i].height>p;)i++;for(;this.items[a].y<u;)a--;i!=this.start_index&&a!=this.stop_index&&(this.start_index=i,this.stop_index=a,this.render_items(!1))}else{var c=this.content.x;0<c&&(c=0),c<this.width-this.content.width&&(c=this.width-this.content.width);var p;for(i=0,a=this.items.length-1,u=(p=-c)+this.width;this.items[i].x+this.items[i].width<p;)i++;for(;this.items[a].x>u;)a--;i!=this.start_index&&a!=this.stop_index&&(this.start_index=i,this.stop_index=a,this.render_items(!1))}},e.prototype.spawn_node=function(n){var t,i=this.node_pools.get(n);return i&&0<i.length?t=i.pop():(t=cc.instantiate(this.item_templates.get(n))).active=!0,t.parent=this.content,t},e.prototype.recycle_item=function(n,t){if(t===void 0&&(t=!1),n.node&&cc.isValid(n.node)){var i=this.node_pools.get(n.data.key);i||(i=[],this.node_pools.set(n.data.key,i)),i.push(n.node),this.recycle_cb&&this.recycle_cb.call(this.cb_host,n.node,n.data.key),n.node.removeFromParent(t),n.node=null}},e.prototype.clear_items=function(n){var t=this;n===void 0&&(n=!1),this.items&&this.items.forEach(function(i){t.recycle_item(i,n)})},e.prototype.render_items=function(n){for(var t,i=0;i<this.start_index;i++)(t=this.items[i]).node&&this.recycle_item(t,n);for(i=this.items.length-1;i>this.stop_index;i--)(t=this.items[i]).node&&this.recycle_item(t,n);for(i=this.start_index;i<=this.stop_index;i++)(t=this.items[i]).node||(t.node=this.spawn_node(t.data.key),this.item_setter.call(this.cb_host,t.node,t.data.key,t.data.data,i)),t.node.setPosition(t.x,t.y)},e.prototype.pack_item=function(n,t,i){var a,u,c=this.spawn_node(t.key),p=[0,0],h=p[0],f=p[1];this.item_get_size?(h=(a=this.item_get_size.call(this.cb_host,c,t.key,t.data,n))[0],f=a[1]):(h=(u=this.item_setter.call(this.cb_host,c,t.key,t.data,n))[0],f=u[1]);var g={x:0,y:0,width:h,height:f,data:t,node:c};return this.recycle_item(g,i),g},e.prototype.layout_items=function(n){if(!(this.items.length<=0)){var t=0;if(0<n){var i=this.items[n-1];t=this.dir==s.Vertical?i.y-i.height-this.gap_y:i.x+i.width+this.gap_x}for(var a=n,u=this.items.length;a<u;a++){var c=this.items[a];this.dir==s.Vertical?(c.x=0,c.y=t,t-=c.height+this.gap_y):(c.y=0,c.x=t,t+=c.width+this.gap_x)}}},e.prototype.resize_content=function(){if(this.items.length<=0)return this.content.width=0,void(this.content.height=0);var n=this.items[this.items.length-1];this.dir==s.Vertical?this.content.height=Math.max(this.height,n.height-n.y):this.content.width=Math.max(this.width,n.x+n.width)},e.prototype.clear_data=function(n){n===void 0&&(n=!1),this.clear_items(n),this.items=[],this.resize_content(),this.start_index=-1,this.stop_index=-1,this.dir==s.Vertical?this.content.y=0:this.content.x=0},e.prototype.set_data=function(n,t){var i=this;t===void 0&&(t=!1),this.clear_items(t),this.items=[],n.forEach(function(a,u){var c=i.pack_item(u,a,t);i.items.push(c)}),this.layout_items(0),this.resize_content(),this.start_index=-1,this.stop_index=-1,this.dir==s.Vertical?this.content.y=0:this.content.x=0,0<this.items.length&&this.on_scrolling()},e.prototype.insert_data=function(n,t){var i,a=this;if(t.length!=0)if(this.items||(this.items=[]),n<0||n>this.items.length)cc.warn("invalid index",n);else{var u=n==this.items.length,c=[];t.forEach(function(p,h){var f=a.pack_item(h,p,!1);c.push(f)}),(i=this.items).splice.apply(i,[n,0].concat(c)),this.layout_items(n),this.resize_content(),this.start_index=-1,this.stop_index=-1,this.auto_scrolling&&u&&this.scroll_to_end(),this.on_scrolling()}},e.prototype.append_data=function(n){this.items||(this.items=[]),this.insert_data(this.items.length,n)},e.prototype.scroll_to_end=function(){this.dir==s.Vertical?this.scrollview.scrollToBottom():this.scrollview.scrollToRight()},e.prototype.destroy=function(){this.clear_items(),this.node_pools.forEach(function(n,t){n.forEach(function(i){i.destroy()})}),this.node_pools=null,this.items=null,cc.isValid(this.scrollview.node)&&(this.scrollview.node.off("scrolling",this.on_scrolling,this),this.scrollview.node.off("scroll-to-bottom",this.on_scroll_to_end,this),this.scrollview.node.off("scroll-to-right",this.on_scroll_to_end,this),this.scrollview.node.off("scroll-ended",this.on_scroll_ended,this))},e}();m.ScrollView=d;var s,r,o=function(){function e(n){this.mDatas=[],this.mPageCount=15,this.mEnableScorllLoad=!1,this.mPreloadIdx=0,this.mScrollView=n,this.mScrollView.setOnScrollToTopListener(this.onLoadMore.bind(this))}return e.prototype.setOnLoadMoreListener=function(n){this.onScorllToHead=n},e.prototype.onLoadMore=function(){this.mEnableScorllLoad&&this.splitLoadData(),this.onScorllToHead&&this.onScorllToHead()},e.prototype.splitLoadData=function(){if(this.mDatas.length!=0){var n=this.mPreloadIdx-this.mPageCount,t=this.mPageCount;n<0&&(n=0),this.mPreloadIdx-=t,this.mScrollView.insert_data(0,this.mDatas.splice(n,t))}},e.prototype.setData=function(n,t,i){t===void 0&&(t=!1),i===void 0&&(i=15),0<this.mDatas.length&&this.mDatas.splice(0,this.mDatas.length),this.mDatas=n,this.mPageCount=i<0?15:i,this.mEnableScorllLoad=t,this.mEnableScorllLoad?(this.mPreloadIdx=this.mDatas.length,this.mScrollView.clear_data(!1),this.splitLoadData()):this.mScrollView.set_data(n,!1)},e.prototype.appendData=function(n){this.mScrollView.append_data(n)},e}();m.ScrollViewController=o,(r=s=m.ScrollDirection||(m.ScrollDirection={}))[r.Vertical=1]="Vertical",r[r.Horizontal=2]="Horizontal",cc._RF.pop()},{}],"weapp_qrcode.d":[function(l,P,m){"use strict";cc._RF.push(P,"500bep1+z1Gjq7dtDnyQksd","weapp_qrcode.d"),cc._RF.pop()},{}],zh:[function(l,P,m){"use strict";cc._RF.push(P,"ce4a5kV5exI17A/ek5wQemt","zh"),window.i18n||(window.i18n={}),window.i18n.languages||(window.i18n.languages={}),window.i18n.languages.zh={label_text:{fight_matching:"\u6B63\u5728\u5339\u914D...",fight_estimate_matching_times:"\u9884\u8BA1\u5339\u914D\u65F6\u957F %s s",fight_cancel_matching:"\u53D6\u6D88\u5339\u914D",fight_matching_success:"\u5339\u914D\u6210\u529F",fight_pre_badge:"\u524D\u4E00\u6BB5\u4F4D",fight_suf_badge:"\u4E0B\u4E00\u6BB5\u4F4D",fight_cur_badge:"\u5F53\u524D\u6BB5\u4F4D",fight_next_badge:"\u4E0B\u4E00\u6BB5\u4F4D",fight_select_music:"\u6B63\u5728\u62BD\u53D6\u5BF9\u6218\u6B4C\u66F2...",fight_cur_music_title:"\u672C\u5C40\u5F39\u594F\u6B4C\u66F2",fight_matching_net_work_err:"\u6682\u672A\u5339\u914D\u5230\u5728\u7EBF\u5BF9\u624B\n\r\u8BF7\u7A0D\u5019\u91CD\u8BD5",fight_rank_net_err:"\u7F51\u7EDC\u5F02\u5E38,\u70B9\u51FB\u91CD\u8BD5!",fight_rank_no_data:"\u6392\u884C\u699C\u8FD8\u6CA1\u8BB0\u5F55,\u8D76\u7D27\u53BB\u5339\u914D\u6BD4\u8D5B\u5427!",fight_season_reward:"\u8D5B\u5B63\u5956\u52B1",limit_day:"\u9650\u65F6%s\u5929",limit_infinite:"\u6C38\u4E45",fight_rule_title:"\u5BF9\u6218\u73A9\u6CD5\u89C4\u5219\u8BF4\u660E",fight_no_jion:"\u672A\u4E0A\u699C",fight_friend:{matching_invite_tips:"\u9080\u8BF7\u5DF2\u53D1\u9001",matching_await_tips:"\u7B49\u5F85\u597D\u53CB\u70B9\u5165 .",matching_invite_again:"\u91CD\u65B0\u9080\u8BF7"},dialog_tips:"\u63D0\u793A",loading_music:"\u6B63\u5728\u52A0\u8F7D\u97F3\u4E50\u8D44\u6E90 ",headphones:"\u4F7F\u7528\u8033\u673A\u6548\u679C\u4F53\u9A8C\u66F4\u4F73",new_song_star:"\u5FEB\u6765\u5F39\u594F\u60A8\u7684\u7B2C\u4E00\u9996\u6B4C\u66F2\u5427\uFF01",little_star:"\u5C0F\u661F\u661F",little_star_play:"\u5F00\u59CB",friends_rank:"\u597D\u53CB\u6392\u884C",view_more:"\u67E5\u770B\u5168\u90E8",invite:"\u9080\u8BF7\u597D\u53CB",home:"\u4E3B\u9875",music_lib:"\u66F2\u5E93",achievement:"\u6210\u5C31\u699C",level:"\u7B49\u7EA7",unlock:"\u89E3\u9501",rank:"\u6392\u540D",rank_share:"\u70AB\u8000\u4E00\u4E0B",rank_show_group:"\u67E5\u770B\u7FA4\u6392\u884C",rank_challenge:"\u7ACB\u5373\u6311\u6218",friend_best_score:"\u597D\u53CB\u5386\u53F2\u6700\u9AD8\u5206",not_ranked:"\u672A\u4E0A\u699C",best_score:"\u5386\u53F2\u6700\u9AD8\u5206",game_bonus_time:"\u6536\u91D1\u5E01",game_endless_tiles:"\u65E0\u5C3D\u6A21\u5F0F",game_history_top:"\u5386\u53F2\u6700\u9AD8\u5206 ",game_select_boosters:"\u9009\u62E9\u589E\u5F3A\u9053\u5177",need:"\u8FD8\u5DEE",to_exceed:"\u5C31\u80FD\u8D85\u8D8A\u597D\u53CB",to_win1:"\u5373\u53EF\u8D62\u5F97",champion:"\u7B2C\u4E00\u540D",runner_up:"\u7B2C\u4E8C\u540D",second_runner_up:"\u7B2C\u4E09\u540D",get_star:"\u5373\u53EF\u83B7\u5F97",get_new_best:"\u5373\u53EF\u521B\u4E0B",new_best:"\u65B0\u7EAA\u5F55",revive_now:"\u7ACB\u5373\u590D\u6D3B",give_up:"\u518D\u575A\u6301\u4E00\u4E0B\uFF01\u770B\u770B\u4F60\u7684\u6781\u9650\u5728\u54EA\u91CC",revive_free:"\u514D\u8D39\u590D\u6D3B",revive_diamond:"\u94BB\u77F3\u590D\u6D3B",spfuh:"\u770B\u89C6\u9891\u590D\u6D3B",djtg:"\u70B9\u51FB\u8DF3\u8FC7",jthk:"\u4ECA\u5929\u8FD8\u53EF\u9080\u8BF7%s\u4EBA",hyzl:"\u597D\u53CB\u52A9\u529B",whether_to_continue:"\u662F\u5426\u7EE7\u7EED?",wait_for_friends:"\u5DF2\u53D1\u9001\uFF0C\u597D\u53CB\u70B9\u5165\u5373\u53EF\u52A9\u529B",no_share_times_tips:"\u4ECA\u5929\u9080\u8BF7\u673A\u4F1A\u5DF2\u7528\u5B8C,\u660E\u5929\u518D\u6765\u5427",no_diamond_tips:"\u590D\u6D3B\u6240\u9700\u94BB\u77F3\u4E0D\u8DB3",nnnn:"\u5206",jsjd:"\u89E3\u9501\u8FDB\u5EA6:",cyss:"\u53C2\u4E0E\u4EBA\u6570:",bingxue_tangguo:"\u51B0\u96EA \u7CD6\u679C",yh:"\u5DF2\u83B7 ",sx:"\u9996\u4E0A\u65B0",single_champion:"\u606D\u559C\u4F60\u83B7\u5F97\u5355\u66F2\u51A0\u519B",beat_frineds1:"\u5355\u66F2\u6392\u540D\u8D85\u8D8A",beat_frineds2:"\u597D\u53CB",no_thanks:"\u4E0B\u6B21\u518D\u8BF4",challenge_friends:"\u6311\u6218\u597D\u53CB",god_hand:"\u795E\u4E4B\u624B",play_again:"\u518D\u6B21\u6311\u6218",next:"\u4E0B\u4E00\u9996",invite_tips:"\u9080\u8BF7\u5DF2\u53D1\u9001\uFF0C\u65B0\u73A9\u5BB6\u70B9\u5165\n\r\u5373\u53EF\u89E3\u9501\uFF01",grade_unlock:"%s\u7EA7\u89E3\u9501",level_up:"\u5347\u7EA7\u5566",upgrade_rewards:"\u5347\u7EA7\u5956\u52B1",new_music_unlocked:"\u89E3\u9501\u65B0\u6B4C\u66F2",receive_awards:"\u9886\u53D6\u5956\u52B1",new_music_wnlocked:"\u89E3\u9501\u65B0\u6B4C\u66F2",back:"\u8FD4\u56DE",Energy:"\u83B7\u53D6\u4F53\u529B",time:"\u5269\u4F59\u590D\u6D3B\u65F6\u95F4: ",free_energy:"\u514D\u8D39\u4F53\u529B",three_times:"\u6BCF\u5929\u53EA\u6709\u4E09\u6B21\u83B7\u5F97\u514D\u8D39\u4F53\u529B\u7684\u673A\u4F1A\uFF0C\u660E\u5929\u518D\u6765\u770B\u770B\u5427",Coins:"\u83B7\u53D6\u91D1\u5E01",get_diamond:"\u83B7\u53D6\u94BB\u77F3",free_diamond:"\u514D\u8D39\u94BB\u77F3",share_fail:"\u5206\u4EAB\u5931\u8D25",group_get_diamond:"\u9700\u8981\u5206\u4EAB\u5230\u7FA4\uFF0C\u624D\u80FD\u83B7\u5F97\u94BB\u77F3\u54E6",share_success:"\u5206\u4EAB\u6210\u529F",get_jiangli:"\u83B7\u5F97",zuanshijiangli:"\u4E2A\u94BB\u77F3\u5956\u52B1\uFF0C\u8D76\u5FEB\u53BB\u6311\u6218\u81EA\u5DF1\u7684\u6781\u9650\u5427",ok:"\u597D\u7684",coupon_buy:"\u70B9\u5238\u8D2D\u4E70",watch_video_invite_tips:"\u770B\u89C6\u9891\u514D\u8D39\u5F97\u94BB\u77F3\u54E6",no_internet:"\u672A\u68C0\u6D4B\u5230\u7F51\u7EDC\uFF0C\u65E0\u6CD5\u67E5\u770B\u6392\u884C\u699C",loading_failed:"\u8D44\u6E90\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u72B6\u6001\u540E\u91CD\u8BD5",retry:"\u91CD\u8BD5",nickname_avatar:"\u83B7\u53D6\u4E0D\u5230\u4F60\u7684\u6635\u79F0\u548C\u5934\u50CF\uFF0C\u8BF7\u5F00\u542F\u6388\u6743\u540E\u91CD\u8BD5",cancel:"\u53D6\u6D88",continue:"\u5F00\u542F",nothing:"\u65E0",unit1:"\u4F4D",unit2:"\u5206",more_songs:"\u66F4\u591A\u6B4C\u66F2\u656C\u8BF7\u671F\u5F85",error:"\u9519\u8BEF\u4FE1\u606F",jlpmq:"\u8DDD\u79BB\u6392\u540D\u524D50%\u8FD8\u5DEE",jkhd:"\u5373\u53EF\u83B7\u5F97",ssbd:"\u5B9E\u65F6\u699C\u5355",qbbd:"\u5168\u90E8\u699C\u5355",ljtz:"\u7ACB\u5373\u6311\u6218",sycs:"\u4ECA\u65E5\u5269\u4F59\u6311\u6218\u6B21\u6570: ",hzzj:"\u597D\u53CB\u4E92\u52A9\u589E\u52A0\u6311\u6218\u6B21\u6570 ",wfsm:"\u64C2\u53F0\u6311\u6218\u73A9\u6CD5\u8BF4\u660E",wfgz:"\u73A9\u6CD5\u89C4\u5219",wfgz1:"\u6BCF\u8F6E\u5F00\u8D5B\u65F6\u95F4\u4E3A\u6BCF\u665A22\u70B9\uFF0C\u5230\u6B21\u65E522\u70B9\u7ED3\u675F",wfgz2:"\u53D6\u672C\u8F6E\u6311\u6218\u7684\u6700\u9AD8\u6210\u7EE9\u8FDB\u884C\u6392\u540D\uFF0C\u540C\u5206\u6570\u6700\u5148\u5230\u8FBE\u7684\u73A9\u5BB6\u6392\u540D\u9760\u524D",wfgz3:"\u7ED3\u675F\u65F6\u4F1A\u5BF9\u6392\u540D\u8FDB\u884C\u6838\u5BF9\uFF0C\u6700\u7EC8\u6392\u540D\u4EE5\u5B9E\u9645\u6838\u7B97\u540E\u4E3A\u51C6",wfgz4:"\u6392\u540D\u5956\u52B1\u901A\u8FC7\u90AE\u4EF6\u53D1\u9001\uFF0C\u5728\u7ED3\u675F\u540E\u534A\u5C0F\u65F6\u5185\u53D1\u653E\u5B8C\u6BD5",wfgz5:"\u6E38\u620F\u4E2D\u4E25\u8C28\u4F7F\u7528\u4F5C\u5F0A\u5DE5\u5177\uFF0C\u7ECF\u53D1\u73B0\u6838\u5B9E\u540E\u53D6\u6D88\u6210\u7EE9\u5E76\u7981\u6B62\u53C2\u52A0\u64C2\u53F0\u8D5B",pmjl:"\u6392\u540D\u5956\u52B1",pmjl1:"\u699C\u5355\u8FDB\u5165\u524D50%\u90FD\u80FD\u83B7\u5F97\u7CBE\u7F8E\u76AE\u80A4",mc1:"\u7B2C1\u540D",mc2:"\u524D10\u540D",mc3:"\u524D100\u540D",mc4:"\u524D1000\u540D",mc5:"\u524D5000\u540D",mc6:"\u524D20%",mc7:"\u524D50%",hgjl:"\u83B7\u5F97\u7687\u51A0\u5956\u52B1",star:"\u661F\u661F",crown:"\u7687\u51A0",gift1:"\u521D\u7EA7\u5956\u52B1\u793C\u5305",gift2:"\u4E2D\u7EA7\u5956\u52B1\u793C\u5305",gift3:"\u9AD8\u7EA7\u5956\u52B1\u793C\u5305",gift4:"\u8C6A\u534E\u5956\u52B1\u793C\u5305",gift5:"\u53F2\u8BD7\u5956\u52B1\u793C\u5305",brph:"\u672C\u65E5\u6392\u884C\u699C",hc:"\u8FD8\u5DEE505\u5206\u53EF\u8FDB\u524D50%",wcy:"\u672A\u53C2\u4E0E",zrph:"\u6628\u65E5\u6392\u884C\u699C",wdzj:"\u6211\u7684\u6218\u7EE9",zjcj:"\u6700\u4F73\u6210\u7EE9: ",wlyc_djcs:"\u7F51\u7EDC\u5F02\u5E38,\u70B9\u51FB\u91CD\u8BD5!",nodata_today:"\u672C\u65E5\u6392\u884C\u699C\u8FD8\u6CA1\u5F97\u5206\u8BB0\u5F55,\u8D76\u7D27\u53BB\u6311\u6218\u5427\uFF01",nodata_yesterday:"\u6628\u65E5\u6392\u884C\u699C\u6CA1\u6709\u5F97\u5206\u8BB0\u5F55\u5594\uFF01",no_challenge:"\u8FD8\u6CA1\u53C2\u52A0\u8FC7\u64C2\u53F0\u8D5B\u5594\uFF0C\u8D76\u7D27\u53BB\u6311\u6218\u5427\uFF01",rank_group:"\u67E5\u770B\u7FA4\u6392\u884C",rank_group_click:"\u9009\u62E9\u7FA4\u67E5\u770B\u6392\u884C",fhsy:"\u8FD4\u56DE\u9996\u9875",cxtz:"\u91CD\u65B0\u6311\u6218",new_rank:"\u6700\u65B0\u6392\u540D   ",rank_into:"\u6392\u540D\u5DF2\u7ECF\u8FDB\u5165   ",ranking:"\u7B2C%s\u540D",top:"\u524D%s%",out90:"90%\u5916",times:"\u6B21",top_percent:"\u6392\u540D\u524D%s%",to_rank_need:"<color=#000000>\u8DDD\u79BB%s\u8FD8\u5DEE</color> <color=#CC562D> %s\u5206</color>",score:"\u5206",can_get:"\u5373\u53EF\u83B7\u5F97 ",reward:"\u53EF\u5F97 ",chanllenge_rank1:"\u597D\u68D2\u68D2\uFF01\u76EE\u524D\u6392\u5728\u64C2\u53F0\u8D5B\u7B2C1\u540D\u5566\uFF01",zwyj:"\u6682\u65E0\u90AE\u4EF6\u6D88\u606F",yjbl:"\u90AE\u4EF6\u53EA\u4FDD\u75597\u5929\uFF0C\u8BF7\u53CA\u65F6\u67E5\u6536",jcyj:"\u6B63\u5728\u68C0\u67E5\u90AE\u4EF6\u5217\u8868...",wlyc:"\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5",mtlc:"\u6BCF\u5929\u51CC\u666806\uFF1A00\u66F4\u65B0",gzsm:"\u89C4\u5219\u8BF4\u660E",gzsm1:"\u597D\u53CB\u70B9\u51FB\u60A8\u53D1\u51FA\u7684\u9080\u8BF7\u8FDE\u63A5\u8FDB\u5165\u6E38\u620F\u540E\uFF0C\u5373\u53EF\u5B8C\u6210\u4E00\u6B21\u597D\u53CB\u9080\u8BF7",gzsm2:"\u6BCF\u6210\u529F\u9080\u8BF7\u4E00\u4E2A\u73A9\u5BB6\uFF0C\u5956\u52B16\u94BB\u77F3\uFF0C\u9080\u8BF7\u65B0\u73A9\u5BB6\u5956\u52B1\u7FFB\u500D\u5F9712\u94BB\u77F3\uFF0C\u6EE15\u73A9\u5BB6\u989D\u5916\u53EF\u9886\u795E\u79D8\u793C\u5305",gzsm3:"\u6210\u529F\u9080\u8BF7\u540E\uFF0C\u60A8\u7684\u597D\u53CB\u4E5F\u53EF\u83B7\u5F972\u4E2A\u94BB\u77F3\u5956\u52B1",gzsm4:"\u6BCF\u5929\u53EF\u9080\u8BF7\u73A9\u5BB6\u4E0A\u96505\u4EBA\uFF0C\u53EF\u5E2E\u52A9\u73A9\u5BB6\u4E0A\u96505\u6B64\uFF0C\u8D85\u51FA\u4E0A\u9650\u4E0D\u518D\u83B7\u5F97\u94BB\u77F3\u5956\u52B1",share_reward_tips:"\u6EE15\u4EBA\u53EF\u9886",chongci:"\u89E6\u53D1\u65F6\u673A\uFF1A\u6E38\u620F\u5F00\u59CB\u65F6",chongcixg:"\u9053\u5177\u6548\u679C\uFF1A\u81EA\u52A8\u51B2\u523A12\u79D2",bingdong:"\u89E6\u53D1\u65F6\u673A\uFF1A\u590D\u6D3B\u540E\u9009\u62E9\u4F7F\u7528",bingdongxg:"\u9053\u5177\u6548\u679C\uFF1A15\u79D2\u5185\u94A2\u7434\u5757\u4E0B\u843D\u964D\u901F50%",hudun:"\u89E6\u53D1\u65F6\u673A\uFF1A\u64CD\u4F5C\u5931\u8BEF\u65F6",hudunxg:"\u9053\u5177\u6548\u679C\uFF1A\u62B5\u6D88\u5931\u8BEF\u5E76\u65E0\u654C8\u79D2",cc:"\u51B2\u523A\uFF1A\u5F00\u5C40\u81EA\u52A8\u51B2\u523A12\u79D2",js:"\u51CF\u901F\uFF1A\u590D\u6D3B\u540E\uFF0C15\u79D2\u5185\u94A2\u7434\u5757\u51CF\u901F",hd:"\u62A4\u76FE\uFF1A\u62B5\u6D881\u6B21\u6F0F\u51FB\u64CD\u4F5C",bj:"\u672C\u5C40\u6E38\u620F\u4F7F\u7528\u51CF\u901F\u9053\u5177",ljsy:"\u7ACB\u5373\u4F7F\u7528",sprint:"\u51B2\u523A",slow:"\u51CF\u901F",shield:"\u62A4\u76FE",day1:"\u7B2C\u4E00\u5929",day2:"\u7B2C\u4E8C\u5929",day3:"\u7B2C\u4E09\u5929",day4:"\u7B2C\u56DB\u5929",day5:"\u7B2C\u4E94\u5929",day6:"\u7B2C\u516D\u5929",day7:"\u7B2C\u4E03\u5929",dia_gift:"\u94BB\u77F3\u5927\u793C\u5305",sign_more_gift:"\u53BB\u6E38\u620F\u4E2D\u8D62\u53D6\u66F4\u591A\u793C\u5305\u5427",sign:"\u7B7E\u5230",signed:"\u5DF2\u7B7E\u5230",diamond:"\u94BB\u77F3",piece:"\u62FC\u56FE",own_dia:"\u62E5\u6709\u94BB\u77F3:",skin_share:"\u5206\u4EAB\u6709\u793C",sys_def:"\u7CFB\u7EDF\u9ED8\u8BA4",use_now:"\u6B63\u5728\u4F7F\u7528",skin_unuse:"\u7ACB\u5373\u4F7F\u7528",skin_trial:"\u8BD5\u73A9",trial_end:"\u8BD5\u73A9\u7ED3\u675F",skin_load:"\u6B63\u5728\u52A0\u8F7D\u76AE\u80A4\u6587\u4EF6",skin_tip:"\u63D0\u793A",skin_dia_less:"\u5F53\u524D\u94BB\u77F3\u4E0D\u8DB3\uFF0C\u4F60\u53EF\u4EE5\u901A\u8FC7\u4E0B\u5217\u65B9\u5F0F\n\u83B7\u5F97\u94BB\u77F3",skin_get:"\u83B7\u53D6",skin_owned:"\u5DF2\u62E5\u6709",invite_get:"\u9080\u8BF7\u65B0\u73A9\u5BB6\u53EF\u83B7\u5F97\uFF08%s/3\uFF09",skin_ice:"\u51B0\u96EA\u5947\u5E7B",skin_cherry:"\u6A31\u82B1\u6811\u4E0B",skin_candy:"\u7CD6\u679C\u751C\u5FC3",skin_soccer:"\u4E16\u754C\u676F",skin_field:"\u7EFF\u91CE\u4ED9\u8E2A",skin_girl:"\u5143\u6C14\u5C11\u5973",skin_space:"\u661F\u7A7A\u73AF\u6E38",skin_default:"\u7CFB\u7EDF\u9ED8\u8BA4",skin_sign_get:"\u7D2F\u8BA1\u7B7E\u52303\u5929\u53EF\u83B7\u5F97",skin_first_charge_get:"\u7D2F\u8BA1\u7B7E\u52303\u5929\u53EF\u83B7\u5F97",day:"\u5929",hours:"\u5C0F\u65F6",music_tab1:"\u7B49\u7EA7\u6B4C\u66F2",music_tab2:"\u70ED\u66F2\u6311\u6218",music_start:"\u5F00\u59CB",music_start1:"1 \u5F00\u59CB",music_trial:"\u8BD5\u73A9",music_unlock:"\u89E3\u9501",music_unlock_text1:"50 \u89E3\u9501",music_unlock_text2:"2 \u8BD5\u73A9",music_invite_unlock:"\u9080\u8BF7\u89E3\u9501",music_invite_rule:"\u9080\u8BF71\u540D\u65B0\u73A9\u5BB6\u5373\u53EF\u514D\u8D39\u89E3\u9501",music_unlock_msg1:"\u9700\u8981\u7B49\u7EA7%s\u4E2D\u83B7\u5F97%s\u661F",music_unlock_msg2:"\u7B49\u7EA7%s\u89E3\u9501",music_unlock_msg3:"\u9700\u8981\u7B49\u7EA7%s\u4E2D\u83B7\u5F97%s\u7687\u51A0",music_unlock_msg4:"\u8DDD\u7ED3\u675F:%s\u5929%s\u65F6%s\u5206%s\u79D2",lottery_prize1:"\u6C38\u4E45\u76AE\u80A4",lottery_prize2:"\u9650\u65F6\u76AE\u80A4",lottery_rule:"\u770B15s\u5E7F\u544A\u5373\u53EF\u514D\u8D39\u62BD\u5956",lottery_video:"\u89C2\u770B\u5B8C\u6574\u89C6\u9891\u53EF\u83B7\u5F97\u6E38\u620F\u5956\u52B1",lottery_video_pick:"\u5173\u95ED\u5E7F\u544A \u7EE7\u7EED\u89C2\u770B",lottery_reward_sprint:"\u83B7\u5F97\u51B2\u523A\u9053\u5177\uFF0C\u53EF\u5728\u6E38\u620F\u4E2D\u4F7F\u7528",lottery_waiting:"00:00:%s\u540E\u53EF\u518D\u6B21\u62BD\u5956",lottery_chance:"\u4ECA\u65E5\u62BD\u5956\u6B21\u6570\u5DF2\u7528\u5B8C",lottery_chance2:"\u83B7\u5F97\u514D\u5E7F\u544A\u62BD\u5956\u673A\u4F1A",new_guide_theme:"\u73A9\u6CD5\u5F15\u5BFC",new_guide_text1:"\u8FDB\u5EA6\uFF1A",new_guide_text2:"\u5B8C\u6210\u6240\u6709\u76EE\u6807\uFF0C\u4F60\u5C31\u662F\u94A2\u7434\u8FBE\u4EBA\u5566\uFF01",new_guide_dialog_text:"\u606D\u559C\u60A8\u5B66\u4F1A\u4E86\u94A2\u7434\u57572\u7684\u57FA\u7840\u64CD\u4F5C\uFF0C\u7B2C\u4E00\u9996\u6B4C\u5FEB\u6765\u6311\u6218\u9AD8\u5206\u5427\uFF01",new_guide_btn_text:"\u590D\u6D3B",new_guide_revive_text:"\u9ED1\u5757\u6CA1\u70B9\u5230\u4F1A\u5BFC\u81F4\u6E38\u620F\u5931\u8D25\u54E6\uFF01\n\u514D\u8D39\u5E2E\u60A8\u590D\u6D3B\u4E00\u6B21\uFF0C\u7EE7\u7EED\u52AA\u529B\u5427\uFF01",new_guide_revive_text2:"\u63D0\u793A",ljdh:"\u7ACB\u5373\u5151\u6362",unlocked:"\u5DF2\u89E3\u9501",unlock_by_invite:"\u9080\u8BF7\u89E3\u9501",more_hot_song:"\u66F4\u591A\u70ED\u66F2",on_sale_1_day:"5\u6298\u4F18\u60E0,\u9650\u65F61\u5929",unlock_by_invite_1_new_palyer:"\u9080\u8BF71\u540D\u65B0\u73A9\u5BB6\u89E3\u9501",worth_diamond:"\u4EF7\u503C%s\u94BB\u77F3",award_page_setting:"\u53BB\u8BBE\u7F6E",award_page_morePieces:"\u83B7\u53D6\u66F4\u591A\u62FC\u56FE>>",award_page_SetSkinAtShop:"\u60A8\u53EF\u4EE5\u5728\u76AE\u80A4\u5546\u5E97\u8BBE\u7F6E\u4F7F\u7528\u76AE\u80A4 ",award_page_getLowSpeedItem:"\u83B7\u5F97\u51CF\u901F\u9053\u5177\uFF0C\u53EF\u5728\u6E38\u620F\u4E2D\u4F7F\u7528",award_page_getShieldItem:"\u83B7\u5F97\u62A4\u76FE\u9053\u5177\uFF0C\u53EF\u5728\u6E38\u620F\u4E2D\u4F7F\u7528",award_page_piecesTip:"\u96C6\u9F50\u62FC\u56FE\u53EF\u5F97\u94BB\u77F3\u5927\u793C\u5305",award_page_giftTip:"\u53BB\u6E38\u620F\u4E2D\u8D62\u53D6\u66F4\u591A\u793C\u5305\u5427",award_page_transform_diamond:"\u5956\u52B1\u7684\u76AE\u80A4\u4E3A\u4F60\u8F6C\u4E3A%s\u4E2A\u94BB\u77F3",award_page_award_get:"\u5956\u52B1\u5DF2\u76F4\u63A5\u5165\u8D26\uFF0C\u8BF7\u6CE8\u610F\u67E5\u6536",award_page_video_diamond:"\u770B\u89C6\u9891\u5E7F\u544A\u989D\u5916",award_page_get_video_diamond:"\u83B7\u5F972\u94BB\u77F3,\u5DF2\u6210\u529F\u5165\u8D26",award_page_close_video_diamond:"\u4E2D\u9014\u9000\u51FA\u89C6\u9891\u64AD\u653E\uFF0C\u94BB\u77F3\u83B7\u53D6\u5931\u8D25",award_page_no_video_diamond:"\u6682\u65E0\u53EF\u7528\u89C6\u9891\u5E7F\u544A\uFF0C\u94BB\u77F3\u83B7\u53D6\u5931\u8D25",Pieces_piano:"\u94A2\u7434\u62FC\u56FE",Pieces_reward:"\u96C6\u9F50\u62FC\u56FE\u5B9D\u7BB1\uFF0C\u53EF\u83B7\u5F97\u94BB\u77F3\u53CA\u9650\u65F6\u76AE\u80A4",Pieces_time:"\u5269\u4F59\u5237\u65B0\u65F6\u95F4\uFF1A%s\u5929%s\u65F6%s\u5206%s\u79D2",Pieces_get:"\u9080\u597D\u53CB\u5F97\u62FC\u56FE",Pieces_get_count:"\u4ECA\u65E5\u5DF2\u9080\u8BF7%s/5",Pieces_rule:"\u89C4\u5219",Pieces_rule_det:"\u62FC\u56FE\u83B7\u53D6\u89C4\u5219",Pieces_rule_one:"\u96C6\u9F50\u94A2\u7434\u62FC\u56FE\u53EF\u4EE5\u83B7\u5F97\u6700\u591A500\u94BB\u77F3\u548C3000\u91D1\u5E01\u5956\u52B1",Pieces_rule_two:"\u6BCF\u65E5\u767B\u9646\u3001\u6253\u5F00\u6E38\u620F\u8FC7\u7A0B\u4E2D\u7684\u793C\u5305\u53EF\u4EE5\u83B7\u5F97\u62FC\u56FE",Pieces_rule_thr:"\u9080\u8BF7\u597D\u53CB\u8FDB\u5165\u6E38\u620F\u5FC5\u83B7\u5F97\u62FC\u56FE\uFF0C\u6BCF\u5929\u6700\u591A\u53EF\u9080\u8BF75\u4F4D\u597D\u53CB",Pieces_rule_for:"\u6BCF15\u5929\u5237\u65B0\u4E00\u6B21\u62FC\u56FE\uFF0C\u572815\u5929\u4E2D\u6700\u591A\u53EF\u83B7\u5F9715\u6B21\u5956\u52B1\uFF0C\u672A\u5151\u6362\u7684\u62FC\u56FE\u5C06\u88AB\u6E05\u7A7A\uFF0C\u8BF7\u52A1\u5FC5\u5728\u5237\u65B0\u4E4B\u524D\u628A\u5956\u52B1\u9886\u53D6\u54E6",Pieces_bonus:"\u96C6\u9F50\u62FC\u56FE\u53EF\u83B7\u5F97\u94BB\u77F3\u5927\u793C\u5305\uFF0C\u83B7\u53D6\u66F4\u591A\u62FC\u56FE",Pieces_count_limit:"\u672C\u8F6E\u6D3B\u52A8\u5185\uFF0C\u60A8\u5DF2\u7ECF\u8FBE\u5230\u5956\u52B1\u4E0A\u965015\u6B21\uFF0C\u4E0D\u80FD\u518D\u83B7\u5F97\u5956\u52B1\u5566\uFF01",Confirm:"\u6211\u77E5\u9053\u4E86",Notification:"\u63D0\u793A",pieces_obtain:"\u563F\uFF0C\u4F60\u53D1\u73B0\u4E86\u94A2\u7434\u62FC\u56FE\uFF01",Pieces_obtain2:"\u96C6\u9F50\u62FC\u56FE\u53EF\u5151\u6362\u94BB\u77F3\u5927\u793C\u5305",pieces_obtain3:"\u53BB\u770B\u770B\uFF01",friend_help_reward:"\u597D\u53CB\u4E92\u52A9\u6210\u529F\uFF0C\u589E\u52A01\u6B21\u6311\u6218\u673A\u4F1A",friend_help_success_tip:"\u6210\u529F\u5E2E\u52A9\u597D\u53CB",friend_help_success_tip2:"\u5956\u52B1",friend_help_create_image:"\u6B63\u5728\u751F\u6210\u56FE\u7247...",friend_help_save_faild:"\u4FDD\u5B58\u5931\u8D25",unit_10k:"\u4E07+",get_pieces_tips:"\u563F \u4F60\u53D1\u73B0\u4E86\u94A2\u7434\u62FC\u56FE",left_help_times:"\u4ECA\u65E5\u5269\u4F59\u5E2E\u52A9\u6B21\u6570\uFF1A%s",invitation_left_times:"\u4ECA\u65E5\u8FD8\u53EF\u9080\u8BF7\u4EBA\u6570%s",continue_invite:"\u7EE7\u7EED\u9080\u8BF7",invite_success:"\u4F60\u5DF2\u6210\u529F\u9080\u8BF7",more_diamond:"\u83B7\u53D6\u66F4\u591A\u94BB\u77F3",help_success:"\u4F60\u5DF2\u6210\u529F\u5E2E\u52A9",help_award_tip:"\u83B7\u5F97\u94BB\u77F3\u5956\u52B1\uFF0C\u5956\u52B1\u4F60",invite_award_tip:"\u4EBA\u8FDB\u5165\u6E38\u620F\uFF0C\u5956\u52B1\u4F60",same_friend_tip:"\u76F8\u540C\u597D\u53CB\u6BCF\u5929\u6700\u591A\u53EA\u80FD\u5E2E1\u6B21\u54E6",help_friend_timeout:"\u60A8\u4ECA\u5929\u5E2E\u52A9\u597D\u53CB\u7684\u673A\u4F1A\u5DF2\u7528\u5B8C\uFF080/5\uFF09",start_game:"\u8FDB\u5165\u6E38\u620F",unlock_tips:"\u554A\u54E6\uFF0C\u8FD9\u9996\u6B4C\u66F2\u4F60\u8FD8\u6CA1\u6709\u89E3\u9501\u54E6~\u5FEB\u53BB\u7EE7\u7EED\u5347\u7EA7\u89E3\u9501\u5B83\u5427\uFF01",shop_tip:"\u63D0\u793A",shop_tip2:"\u7CFB\u7EDF\u6682\u65F6\u4E0D\u652F\u6301\u5185\u8D2D\uFF0C\u656C\u8BF7\u8C05\u89E3",free:"\u514D\u8D39",mail_obtain:"\u9886\u53D6",mail_read:"\u67E5\u770B",mail_have_read:"\u5DF2\u67E5\u770B",mail_have_obtain:"\u5DF2\u9886\u53D6",unlock_energy:"\u4F53\u529B",unlock_gold:"\u91D1\u5E01",unlock_diamond:"\u94BB\u77F3",unlock_unlockTips:"\u89E3\u9501",unlock_play:"\u5F00\u59CB",unlock_trial:"\u8BD5\u73A9",unlock_str_plus:"%s\u4E0D\u8DB3\uFF0C\u65E0\u6CD5%s",gkspsrdjlfb:"\u89C2\u770B\u89C6\u9891\u4F7F\u4F60\u7684\u5956\u52B1\u7FFB\u500D",prop_tip2:"\u94BB\u77F3\u4E0D\u8DB3",prop_tip1:"\u91D1\u5E01\u4E0D\u8DB3",amount:"\u6570\u91CF",props_introduction:"\u9053\u5177\u8BF4\u660E",fech:"friend enter can help",atp:"\u52A0\u9001\u51B2\u523A\u9053\u5177",reff:"\u514D\u8D39\u83B7\u5F97",unbd:"\u91D1\u5E01\u89E3\u9501",litu:"\u9650\u65F6\u4F7F\u7528",wtvfdr:"\u89C2\u770B\u89C6\u9891\u4F7F\u4F60\u7684\u5956\u52B1\u7FFB\u500D",wwn:"\u7F51\u7EDC\u4E0D\u7ED9\u529B\uFF0C\u8BF7\u68C0\u67E5",evpm:"\u4E2D\u9014\u9000\u51FA\u89C6\u9891\u64AD\u653E\uFF0C\u65E0\u6CD5\u590D\u6D3B\uFF0C\u8BF7\u91CD\u8BD5",nvaa:"\u6682\u65E0\u53EF\u7528\u89C6\u9891\u5E7F\u544A\uFF0C\u672C\u6B21\u4E3A\u60A8\u514D\u8D39\u590D\u6D3B",play_game_tips_close_video:"\u4E2D\u9014\u9000\u51FA\u89C6\u9891\u64AD\u653E",play_game_tips_no_ad:"\u6682\u65E0\u53EF\u7528\u89C6\u9891\u5E7F\u544A\uFF0C\u672C\u6B21\u4E3A\u60A8\u7ACB\u9A6C\u5F00\u59CB"}},cc._RF.pop()},{}]},{},["LanguageData","LocalizedLabel","LocalizedSprite","SpriteFrameSet","polyglot.min","base64","cmg_pay_client.d","cmg_platform.d","cmplay.2e834.d","configuration.d","mgb_sdk.d","mgrpt_sdk.d","weapp_qrcode.d","MGAdUnitManager","AdvHelperCMplay","AdvHelperWeb","MGAdvDefine","MGAdvEntrance","MGAdvHelper","MGAppShare","MGShareUtil","ShareHelper","ShareImage","ShareImageUtil","ShareImageUtils","Utils","BasicHelperCM","BasicHelperFB","BasicHelperQQ","BasicHelperWX","BasicHelperWeb","LocalStorageHelplerWeb","MGBasicEntrance","MGBasicHelper","CloudStorageHelperCM","CloudStorageHelperFB","CloudStorageHelperQQ","CloudStorageHelperWX","CloudStorageHelperWeb","MGCloudStorageEntrance","MGCloudStorageHelper","UserHelperCM","UserHelperFB","UserHelperGameHall","UserHelperH5SDK","UserHelperQQ","UserHelperWX","UserHelperWeb","UserLoginHelperWeb","MGUserEntrance","MGUserHelper","FBHelper","MGLog","MGPlatform","MGSha1","NetworkUtils","QQHelper","SystemInfo","TypeDefinition","WeappHelper","en","zh","Md5","PlatformProxy","SpriteCacheLoader","CMPlayAdapter","DefaultAdapter","IAdapter","ScoreManagerProxy","WechatGameAdapter","SubscriptionUtils","AntiCheatProbe","OperatingCount","Config","CrashMonitor","Data","G","GameApp","GameInfoMgr","Lifecycle","Log","Presenter","PullDataStatus","Sound","Startup","State","ConstantsRank","GameDefine","RowNode","AdditionData","BaseCsvFile","CSV","CompetitionBasicData","CompetitionMusicData","CompetitionRewardData","CompetitionSettlementData","CopyrightData","CsvFile","CsvOption","CsvRowData","EffectData","ExpData","FightRuleData","FragmentBox","GameItemsData","GoldData","HolidayTaskData","InviteAward","LanguageSongData","LevelConsumeData","LevelData","LevelRewardData","LifeData","LoginReward","LotteryData","LvData","MusicJsonData","MusicKeyData","PlayerTaskData","RankSetData","RobotFightData","ShopData","SkinAdditionData","SkinPieceData","SongBox","VipData","DBMgr","HolidayTask","HolidayTaskItem","HolidayTaskMgr","ActivityManager","BattleSettlement","ChestManager","CopyrightManager","EventBus","FragmentBoxManager","GameItemsManager","GameTryData","I18nManager","InviteAwardManager","InviteSkinManager","LangMgr","Level","LevelMgr","LoginRewardManager","LotteryDataManager","MoneySystem","NotifyEvent","PlayerMgr","PluginScheduler","EconomyPlugin","EnergyPlugin","ExpPlugin","IPlugin","PluginMgr","UnlockPlugin","UnlockProcessor","ShareRewardController","SkinDataManager","SkinPieceDataMgr","SongBoxManager","SongTryData","UserInfoLevelMgr","UserLvManager","MemCache","Recod","StorageUtil","User","UserUtil","RankAdapter","GameClub","ActivityInviteTipsPrefab","AddShortcutPrefb","BasicTouchEvent","ChangePlayIdPrefb","CheckActivityRewardProcessor","CheckRewardProcessor","ClickEventSoundPlayer","DebugPanelPrefb","DeskIconInstrucPrefb","GameEntranceScene","GameEntranceSceneFirstEnter","HomePagePrefb","ImgCache","InviteTipsPrefab","LoadingFailedPrefab","LoadingScene","MainpageLeftBtnPanel","MainpageLeftBtnPanelOld","MainpageRecommendPanel","MainpageRightBtnPanel","HotMusicCMShareController","HotMusicCardItemPrefb","HotMusicListCtrl","HotSongSplash","HotSongSplashItem","InviteUnlockMusicCountdownUtil","LevelMusicListCtrl","MusicLibraryManager","NormalMusicCardItemPrefb","UnlockConfirmDialogPrefab","NewRecordPrefb","PopupDlg","PreLoadAssets","PrefabMgr","ToastMgr","ToastPopManager","ToastPrefab","TwoBtnDIalogPrefab","UICache","UserAuthorizePopupPrefab","GameOverHotSongShare","AttentionPrefab","EmptyPagePrefab","MainpageBaseComponent","NodesPool","RcmdGameData","RcmdGameDataAdapter","ShareSkinController","TitleRedspotPrefab","TrialItemPrefab","TrialPrefab","WelfareController","HotmusicActivityMgr","MGBGiftBoxWrapper","MGBSdkInit","MgPluginManager","MusicLevelDataLoader","UserInfoBtnManager","UserInfoManager","AdvGetPropertyDialog","AwardResultCommonPrefab","AwardResultDialogPrefabScript","AwardResultItemPrefabScript","DailyAttendanceItemPrefbScript","DailyAttendancePrefbScript","IAwardRounter","DiamondPopupProfab","EnergyBuyDialogItem","EnergyPopupProfab","GoldPopupProfab","PlayerInfoPopupProfab","RankRevivePageContainer","RankRevivePageQQ","AwardController","TipsDialog","BusinessUtil","AttentionUtil","AwardInfoFactory","DAwardMgr","DailyAwardBens","DailyAwardGenerator","Dialog","DialogManager","GameOverHotSong","GameOverHotSongItem","GameOverInviteSKin","GameOverPopupUtil","GiftBoxDialog","LevelVideoGetSkinPrefab","QQRedPacketRelive","Relive","ReliveFreeDialogTipDialog","ReliveInterface","ReliveNoShare","ReliveScoreData","ReliveTotal","ReviveController","SaveSuccessPrefab","UpdateContent","UpdateDialog","mainpage","KeypadFocusedUI","KeypadNavigator","KeypadNavigatorBase","KeypadUtil","ActivityLooper","Looper","ShareLooper","LotteryEnum","LotteryHandler","LotteryIndex","LotteryItem","LotteryProcess","LotteryRoll","LotteryVM","DataEntryWorker","SwitchWorker","MusicDownLoadPrefab","MusicDownloadHandler","MusicDownloadProcess","MusicDownloadWorker","PianoToneMgr","Define","ActivityBean","ActivityRewardManager","ActivityRewardRequest","RewardBeans","RewardManager","RewardRequester","DialogNoButtonPrefab","DialogOneButtonPrefab","DialogRechargePrefab","PropertyStorePrefab","BuySkinDiamondNotEnough","CMInviteSkinPrefab","DownLoadingPrefab","FollowGiftsPrefab","InviteSkinPrefab","SkinGainPrefab","SkinLoading","SkinManager","SkinPieceMgr","SkinStore","SkinStoreItem","SkinTaskItemPrefab","SkinTaskPageViewPrefab","SkinTaskPrefab","SkinTryData","SkinUtils","SkinTask","SkinTaskItem","SkinTaskMgr","FightFriendTimesTask","FightUsePropTimesTask","FightWinCountTask","GoldBuyTask","LotteryTask","NormalGainCrownTask","NormalReliveTimesTask","SkinTaskFactory","WatchAdsTask","TaskItem","TaskListManager","TaskRewardStorage","TaskSystem","GuidanceInfo","NewGuidanceLoader","NewGuidancePrefab","NewPlayerTargerItemPrefab","NewPlayerTargetParentPrefab","NewPlayerTargetPrefab","AttendChallengeTask","FirstSongTask","GameShareTask","LevelThreeTask","TaskFactory","TaskItemImpl","UnlockHotSongTask","InsFactory","LRUCache","Log4JS","LSKey","RemoteCfgMgr","ExclusiveSkinGameScene","FirstSongGuideGameScene","GameBus","GameScene","GameSceneDebugPanel","GameSceneEntry","GameSceneSetting","MUIBoard","MUIButton","MUIDefines","MUIDrawNode","MUIFactory","MUILabel","MUILine","MUINineScaleSprite","MUINode","MUIParticle","MUIProgressBar","MUISprite","MainScene","NormalGameScene","RenderSwitch","OvertakeFriend","StarCountSwitch","TouchHandler","TrialGameScene","TrialSongGameScene","TryPianoGameScene","MAnimationMgr","MScheduler","AnimationWork","MAction","MActionFactory","MAdvanceAnimation","MBlink","MCallFunc","MChildAction","MCircleMoveBy","MCircleMoveTo","MDelay","MFadeTo","MFrameSequence","MMoveBy","MMoveTo","MPropValue","MRandomChange","MRandomFade","MRandomMove","MRandomScale","MResizeBy","MResizeTo","MScaleBy","MScaleTo","MSelfDefine","MSequence","MSetProperty","MSpawn","CanvasFunction","SimpleAtlas","SimpleImage","GameInterface","GameMapGuide","GameStage","GameStageEventObserver","GameStageGuide","GameStageMoney","GameStageMusic","GameStageRankMusic","GameStageTrial","GameStageTrialSong","CMTouchEvent","Map","MapGenerator","BattleDataConfig","BattleDataDefines","BattleDataMain","BattleDataPlayer","BattleDataRunning","CookieAnimation","LongBlockAnimation","ScoreAnimation","BackButton","Banner","KeyNode","KeyTouchLine","MUINumber","SplitLine","BeginFrameLoader","BlockSkinFrameLoader","GameSceneFrameLoader","KeypadFrameLoader","LoaderInit","NumberFrameLoader","BlankPauseBlockNode","BlockNode","BlockNodeCache","BlockNodeFactory","CookiesNodeCache","EvilLongBlockNode","EvilShortBlockNode","GiftBlockNode","LongBlockNode","MUINodePool","MistakeBlockNode","MoneyBlockNode","NodeCreateHelper","PropertyBlockNode","ReuseNode","ReuseNodePool","ShortBlockNode","StartBlockNode","FPSProcess","GameModuleManager","IModule","OvertakeFriendModule","QQRedPacketModule","DecelerateConfirm","PropertyHandler","PropertyInterfaces","PropertyIntroduction","PropertyProcess","PropertyReport","PropertySeeing","CtrlPropertyManager","CtrlAvoid","CtrlConversion","CtrlFanatical","CtrlControl","CtrlFog","CtrlObstacle","DecelerateWorker","FogWorker","ShieldWorker","SprintWorker","IServiceBuilder","IServiceProvider","IServiceProviderFactory","IServiceStorage","ServiceEntry","ServiceProvider","ServiceProviderFactory","ServiceStorage","ServiceStorageBase","BattleGameSceneViewImpl","BottomStorePanel","GameStageNodeView","GameStageView","IBattleGameSceneView","PropertiesPanel","RobotBattleGameSceneViewImpl","UiPropertyIconPanel","IWorker","WorkerBase","WorkerState","WorkerStateChangedEventArgs","BIReportI","EasyReport","Infoc","InfocHelper","example_table","m_p2_DL","m_p2_HMusic_laxin","m_p2_PData","m_p2_PData_Dia","m_p2_Uaction","m_p2_daily_activity","m_p2_load_f","m_p2_pk_action","m_p2_pop_coin","m_p2_share","m_p2_skin_piece","minigame_piano2_arena_fail","minigame_piano2_crash","minigame_piano2_hotmusic","minigame_piano2_leave_page","minigame_piano2_pintu","recommender.min","IMusicContext","QQBKAudioManager","QQMusicContext","WXMusicContext","InstrumentFactory","Music","MusicBeat","MusicBlock","MusicCache","MusicContext","MusicDefines","MusicInstrument","MusicParser","MusicPart","MusicPlayCompat","MusicPlayer","MusicPreloader","MusicSyllable","MusicThread","PropertyBarrel","PropertyConfig","PropertyDefines","PropertyFactory","PropertyPack","AnimationBackground","Background","Skin","SkinElementPainter","SkinMgr","SkinObject","SkinRaw","AvatarUtil","Bean","SocialHelper","SocialManager","WXHelper","BannerDelayShowToggle","BaseVersionChecker","CloudMgr","CloudResMgr","Downloader","IChecker","ResBean","ResMgr","ToggleBean","ToggleChecker","VersionBean","AutomaticTest","BinaryData","DateUtil","Delay","Dictionary","Emitter","List","LoadingTimecost","NodeFacade","NumberUtil","ObjectPool","PU","PageHeap","ParticleSystemVM","Performance","QQGameConvertCode","QQReport","ResLoader","SUtil","SceneMusicMgr","SceneMusicUtil","SingleWorker","StringUtil","TimeUtil","Utility","EMap","Enumerator","IEnumerable","IEnumerator","IMap","ISet","KeyValuePair","Set","EnumEntry","EnumUtils","layout_utils","listview","scrollview","Activator","ClassType","Tween"])})()})()})()})()})();})();
