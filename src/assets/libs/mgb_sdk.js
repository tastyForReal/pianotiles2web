var d,D=exports&&exports.__extends||function(){var e=function(a,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(a,o)};return function(a,o){function t(){this.constructor=a}e(a,o),a.prototype=o===null?Object.create(o):(t.prototype=o.prototype,new t)}}();(function(e){var a=function(){function o(){}return o.VERSION="1.0.0.3",o.PLATFORM_WX="wechat",o.PLATFORM_QQ="qq",o.PLATFORM_WEB="web",o.PLATFORM_FB="facebook",o.GETYPE_CC="cocos-creator",o.GETYPE_LAYABOX="layabox",o.APTYPE_UNKNOWN=0,o.APTYPE_WX_REWARDVIDEO=1,o.APTYPE_QQ_REWARDVIDEO=1,o.APTYPE_FB_REWARDVIDEO=1,o.APTYPE_WX_BANNER=2,o.APTYPE_QQ_BANNER=2,o.APTYPE_FB_INTERSTITIAL=4,o.APTYPE_RCMD_UNKNOWN=5,o.APTYPE_RCMD_GIFTBOX=5,o.APTYPE_RCMD_SCOREWALL=5,o.ADTYPE_UNKNOWN=0,o.ADTYPE_WX_REWARDVIDEO=1,o.ADTYPE_QQ_REWARDVIDEO=1,o.ADTYPE_FB_REWARDVIDEO=1,o.ADTYPE_WX_BANNER=2,o.ADTYPE_QQ_BANNER=2,o.ADTYPE_FB_INTERSTITIAL=4,o.ADTYPE_RCMD_UNKNOWN=5,o.ADTYPE_RCMD_GIFTBOX=5,o.ADTYPE_RCMD_SCOREWALL=5,o.ADSOURCE_UNKNOWN=0,o}();e.MGBAdDefs=a})(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_AdModule",this.mPlatFormType=e.MGBAdDefs.PLATFORM_WX,this.mAdEnvCfg=null,this.mDepotPosIdCfg=null,this.mbInited=!1,this.mMapPosId2AdDepot=new Map,this.mAdInterceptor=null,this.mMapExitFlag=new Map}return o.getInstance=function(){return this.sInst!=null||(this.sInst=new o),this.sInst},o.prototype.init=function(t,r){return this.mbInited?e.MGBAdErrCode.ADERR_ADMODULE_INITED:t==null?e.MGBAdErrCode.ADERR_ADMODULE_INIT_NO_ADENVCFG:r==null?e.MGBAdErrCode.ADERR_ADMODULE_INIT_NO_LISTPOSCFG:(this.mPlatFormType=t.getPlatformType(),this.mAdInterceptor=new e.MGBAdInterceptor(this.mPlatFormType),this.mAdEnvCfg=t,this.mDepotPosIdCfg=new e.MGBAdPosIdCfgDepot(r),this.mbInited=!0,this.registerCreators(),e.MGBAdErrCode.ADERR_SUCCESS)},o.prototype.registerCreators=function(){var t=this;this.mAdInterceptor&&!this.mAdInterceptor.intercept()?(this.regASCreator(e.MGBAdSelector4Auto.ASNAME,{createNewAdSelector:function(r){return new e.MGBAdSelector4Auto(t.mPlatFormType,r)}}),this.regAPCreator(e.MGBAdProvider4WXBanner.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4WXBanner}}),this.regAPCreator(e.MGBAdProvider4WXRewardVideo.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4WXRewardVideo}}),this.regAPCreator(e.MGBAdProvider4QQBanner.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4QQBanner}}),this.regAPCreator(e.MGBAdProvider4QQRewardVideo.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4QQRewardVideo}}),this.regAPCreator(e.MGBAdProvider4FBRewardVideo.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4FBRewardVideo}}),this.regAPCreator(e.MGBAdProvider4FBInterstitial.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4FBInterstitial}})):e.Log.w(this.TAG,"can't execute action: registerCreators()")},o.prototype.getAdEnvCfg=function(){return this.mAdEnvCfg},o.prototype.getPosIdCfg=function(t){return t==null||this.mDepotPosIdCfg==null?null:this.mDepotPosIdCfg.getPosIdCfg(t)},o.prototype.fetchAd=function(t,r,n){if(!this.mAdInterceptor||this.mAdInterceptor.intercept())return e.Log.e(this.TAG,"intercept ad fetch request because of unsupported platform"),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_ADMODULE_PLATFORM_INTERCEPT);if(this.hasSceneExitFlag(t))return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE);var i=this.getAdDepot(t);return i==null?new e.ResultFetchAd(e.MGBAdErrCode.ADERR_ADMODULE_FETCH_NO_ADDEPOT):i.doFetch(r,n)},o.prototype.loadAd=function(t,r,n){if(!this.mAdInterceptor||this.mAdInterceptor.intercept())return e.Log.e(this.TAG,"intercept ad load request because of unsupported platform"),e.MGBAdErrCode.ADERR_ADMODULE_PLATFORM_INTERCEPT;var i=this.getAdDepot(t);if(i==null)return e.MGBAdErrCode.ADERR_ADMODULE_LOAD_NO_ADDEPOT;var s=i.doLoad(r,n);return s!=e.MGBAdErrCode.ADERR_SUCCESS&&MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_NOT_TO_LOAD,s,e.MGBAdDefs.ADTYPE_UNKNOWN),s},o.prototype.regAPCreator=function(t,r){this.mAdInterceptor.intercept()?e.Log.w(this.TAG,"can't execute action: regAPCreator()"):e.MGBAdCompFactory.getInstance().regAPCreator(t,r)},o.prototype.regASCreator=function(t,r){this.mAdInterceptor.intercept()?e.Log.w(this.TAG,"can't execute action: regASCreator()"):e.MGBAdCompFactory.getInstance().regASCreator(t,r)},o.prototype.getAdDepot=function(t){if(this.mAdInterceptor.intercept()||!this.mbInited||t==null||this.mMapPosId2AdDepot==null)return null;var r=null;if(this.mMapPosId2AdDepot.has(t))r=this.mMapPosId2AdDepot.get(t);else{var n=this.getPosIdCfg(t);if(n==null)return null;r=new e.MGBAdDepot(n),this.mMapPosId2AdDepot.set(t,r)}return r},o.prototype.getCacheSize=function(t){if(!this.mAdInterceptor||this.mAdInterceptor.intercept())return e.Log.w(this.TAG,"can't execute action: getCacheSize()"),0;var r=this.getAdDepot(t);return r==null?0:r.getCacheSize()},o.prototype.destroyLastAd=function(t){if(this.mAdInterceptor&&!this.mAdInterceptor.intercept()){if(t!=null){var r=this.getAdDepot(t);r!=null&&r.destoryLastAd()}}else e.Log.w(this.TAG,"can't execute action: destroyLastAd()")},o.prototype.enterScene=function(t){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?this.mMapExitFlag!=null&&t&&t.length!=0&&this.mMapExitFlag.set(t,!1):e.Log.w(this.TAG,"can't execute action: enterScene()")},o.prototype.exitScene=function(t,r){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?this.mMapExitFlag!=null&&t&&t.length!=0&&(this.mMapExitFlag.set(t,!0),r&&this.destroyLastAd(t)):e.Log.w(this.TAG,"can't execute action: exitScene()")},o.prototype.hasSceneExitFlag=function(t){if(this.mAdInterceptor&&!this.mAdInterceptor.intercept())return!(this.mMapExitFlag==null||!t||t.length==0)&&!!this.mMapExitFlag.has(t)&&this.mMapExitFlag.get(t);e.Log.w(this.TAG,"can't execute action: hasSceneExitFlag()")},o.prototype.rptCommonAd=function(t,r,n){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?t&&MGRPT.minigame_common_ad.report(t,r,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType(t),n):e.Log.w(this.TAG,"can't execute action: rptCommonAd()")},o.prototype.rptCommonActive=function(t){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?MGRPT.minigame_common_active.report(t):e.Log.w(this.TAG,"can't execute action: rptCommonActive()")},o.prototype.enable=function(t){this.mAdInterceptor&&this.mAdInterceptor.switch4Ad(t)},o.prototype.isDisable=function(){return!!this.mAdInterceptor&&this.mAdInterceptor.intercept()},o.prototype.isClickRVAdTooMuch=function(t){return e.MGBAdShowRecord.getInstance().isShowAdTooMuch(t)},o.prototype.showAd=function(t,r){if(this.mAdInterceptor&&!this.mAdInterceptor.intercept()){if(!this.isClickRVAdTooMuch(t))if(MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_SHOW_BEGIN,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType(t)),0<this.getCacheSize(t))this.fetchAndShow(t,r);else{var n=this.fetchAndShow.bind(this);this.loadAd(t,new e.ParamAdLoad,{onSuccess:function(){n&&n(t,r)},onFailed:function(i,s,c){}})}}else e.Log.w(this.TAG,"can't execute action: showAd()")},o.prototype.getAdType=function(t){var r=this.getAdDepot(t);return r||e.MGBAdDefs.ADTYPE_UNKNOWN,r.getAdType()},o.prototype.fetchAndShow=function(t,r){var n=this.fetchAd(t,new e.ParamAdFetch,null);if(n.mAdErrCode==e.MGBAdErrCode.ADERR_SUCCESS){var i=n.getAd();if(i)return i.show(r)}else r&&r.onShowFail(null,null,null)},o.sInst=null,o}();e.MGBAdModule=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_MGBAdProvider4FBInterstitial",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,r,n,i){var s,c=this;return r==null?(e.Log.e(this.TAG,"facebook interstitial ad require Placement ID"),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID):t==null?e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG:(e.Log.i(this.TAG,"facebook interstitial start doLoad, posId = "+t.getPosId()),FBInstant.getInterstitialAdAsync(r).then(function(A){return s=A,MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),s.loadAsync()}).then(function(){e.Log.i(c.TAG,"Preload FB interstitial successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var A=new e.MGBAd4FBInterstitial(s,t);c.mAdCache.pushBack(A),e.Log.i(c.TAG,"Current facebook interstitial ad cache size: "+c.mAdCache.getSize()),i&&i.onSuccess()}).catch(function(A){e.Log.e(c.TAG,"FB interstitial failed to preload, posId = "+t.getPosId()+"; errInfo = "+A.code+", "+A.message),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),i&&i.onFailed(e.MGBAdErrCode.ADERR_UNKNOWN,A.code,A.message)}),e.MGBAdErrCode.ADERR_LOADING)},o.prototype.doFetch=function(t,r,n,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(!r)return e.Log.e(this.TAG,"facebook interstitial ad require Placement ID"),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var s=this.mAdCache.popFront();return this.isNeedLoadMore()&&this.doLoad(t,r,new e.ParamAdLoad,null),s==null?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE)):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(s))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="fb_interstitial",o}();e.MGBAdProvider4FBInterstitial=a}((window.MGB=d)||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_MGBAdProvider4FBRewardVideo",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,r,n,i){var s,c=this;return r==null?(e.Log.e(this.TAG,"facebook video ad require Placement ID"),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID):t==null?e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG:(e.Log.i(this.TAG,"facebook video start doLoad, posId = "+t.getPosId()),FBInstant.getRewardedVideoAsync(r).then(function(A){return s=A,MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),s.loadAsync()}).then(function(){e.Log.i(c.TAG,"Preload FB video successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var A=new e.MGBAd4FBRewardVideo(s,t);c.mAdCache.pushBack(A),e.Log.i(c.TAG,"Current facebook video ad cache size: "+c.mAdCache.getSize()),i&&i.onSuccess()}).catch(function(A){e.Log.e(c.TAG,"FB video failed to preload, posId = "+t.getPosId()+"; errInfo = "+A.code+", "+A.message),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),i&&i.onFailed(e.MGBAdErrCode.ADERR_UNKNOWN,A.code,A.message)}),e.MGBAdErrCode.ADERR_LOADING)},o.prototype.doFetch=function(t,r,n,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(!r)return e.Log.e(this.TAG,"facebook video ad require Placement ID"),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var s=this.mAdCache.popFront();return this.isNeedLoadMore()&&this.doLoad(t,r,new e.ParamAdLoad,null),s==null?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE)):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(s))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="fb_video",o}();e.MGBAdProvider4FBRewardVideo=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_AdProvider4QQBanner",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,r,n,i){var s=this;return t==null?e.MGBAdErrCode.ADERR_AP_LOAD_ARGS_ERROR:(e.Log.i(this.TAG,"start doLoad, posId = "+t.getPosId()),r==null&&e.Log.i(this.TAG,"QQ banner doesn't require native posid"),t==null?e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG:(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),BK.Advertisement.fetchBannerAd(function(c,A,C){if(e.Log.i(s.TAG,"BK Ad fetchBannerAd callback",c),c==0){e.Log.i(s.TAG,"load QQ banner successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,s.getAdType());var p=new e.MGBAd4QQBanner(C,t);s.mAdCache.pushBack(p),i&&i.onSuccess()}else e.Log.e(s.TAG,"load QQ banner failed, posId = "+t.getPosId()+"; errInfo = "+A),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,A,s.getAdType()),i&&i.onFailed(c,A,null)}),e.MGBAdErrCode.ADERR_LOADING))},o.prototype.doFetch=function(t,r,n,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var s=this.mAdCache.popFront();return s==null?new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(s))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_QQ_BANNER},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="qq_banner",o}();e.MGBAdProvider4QQBanner=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_AdProvider4QQVideo",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,r,n,i){if(t==null)return e.MGBAdErrCode.ADERR_AP_LOAD_ARGS_ERROR;if(r==null&&e.Log.i(this.TAG,"QQ video doesn't require native posid"),t==null)return e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG;var s=t.getNum(e.MGBAdPosIdCfg.KEY_AP4QQVIDEO_TYPE,-1);return s==-1?(e.Log.e(this.TAG,"MGBAdProvider4QQRewardVideo video type is -1, posId = "+t.getPosId()),e.MGBAdErrCode.ADERR_AP_LOAD_ARGS_ERROR):(e.Log.i(this.TAG,"MGBAdProvider4QQRewardVideo start doLoad, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),BK.Advertisement.fetchVideoAd(s,function(c,A,C){if(e.Log.i(this.TAG,"BK Ad fetchVideoAd callback",c),c==0){e.Log.i(this.TAG,"load QQ video successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var p=new e.MGBAd4QQRewardVideo(C,t);this.mAdCache.pushBack(p),i&&i.onSuccess()}else e.Log.e(this.TAG,"load QQ video failed, posId = "+t.getPosId()+"; errInfo = "+A),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),i&&i.onFailed(c,A,null)}.bind(this)),e.MGBAdErrCode.ADERR_LOADING)},o.prototype.doFetch=function(t,r,n,i){if(t==null||t.getNum(e.MGBAdPosIdCfg.KEY_AP4QQVIDEO_TYPE,-1)==-1)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var s=this.mAdCache.popFront();return this.isNeedLoadMore()&&this.doLoad(t,r,new e.ParamAdLoad,null),s==null?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE)):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(s))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return this.getCacheSize()<1},o.APNAME="qq_video",o}();e.MGBAdProvider4QQRewardVideo=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_AdProvider4WXBanner",this.mAdCache=new e.MGBAdCache,e.WXBannerAdMonitor.getInstance().init()}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,r,n,i){var s=this;if(t==null)return e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG;if(e.Log.i(this.TAG,"start doLoad, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),r==null)return e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID;if(!wx.createBannerAd)return e.MGBAdErrCode.ADERR_AP4WXBANNER_LOAD_NO_API;var c=t.getNum(e.MGBAdPosIdCfg.KEY_AP4WXBANNER_LOAD_WIDTH,300),A=wx.createBannerAd({adUnitId:r,style:{left:0,width:c,height:0,top:0}});if(A==null)return e.MGBAdErrCode.ADERR_AP4WXBANNER_LOAD_NO_ADHANDLER;var C=this.getWXBAdPosAdapter(t),p=new e.MGBAd4WXBanner(t,A);return A.onResize(function(g){e.Log.i(s.TAG,"enter wxadHandler.onResize, posId = "+t.getPosId()),g!=null?C!=null?C.onReSize(g.width,g.height,p):e.Log.e(s.TAG,"wxadHandler.onResize  posAdapter != null, posId = "+t.getPosId()):e.Log.e(s.TAG,"wxadHandler.onResize  res == null, posId = "+t.getPosId())}),A.onLoad(function(){s.mAdCache.pushBack(p),e.Log.i(s.TAG,"after wxadHandler.onLoad, cache size:"+s.mAdCache.getSize()+"; posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,s.getAdType()),i!=null&&i.onSuccess()}),A.onError(function(g){i!=null&&(e.Log.e(s.TAG,"after wxadHandler.onError err"+JSON.stringify(g)+", posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,JSON.stringify(g),s.getAdType()),i.onFailed(e.MGBAdErrCode.ADERR_AP_LOAD_WXBH_ONERROR,g,null))}),e.MGBAdErrCode.ADERR_SUCCESS},o.prototype.doFetch=function(t,r,n,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(r==null)return e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var s=this.mAdCache.popFront();return s==null?new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(s))},o.prototype.getWXBAdPosAdapter=function(t){return t==null?null:t.getObject(e.MGBAdPosIdCfg.KEY_AP4WXBANNER_POS_ADAPTER,null)},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache==null?0:this.mAdCache.getSize()},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_WX_BANNER},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="wx_banner",o}();e.MGBAdProvider4WXBanner=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_AdProvider4WXRewardVideo"}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO},o.prototype.doLoad=function(t,r,n,i){var s=this;return t?r?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),e.WXRewardVideoProxy.getInstance().load(t,r,{onSuccess:function(){MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,s.getAdType()),i&&i.onSuccess()},onFailed:function(c,A,C){MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,c,s.getAdType()),i&&i.onFailed(c,A,C)}}),e.MGBAdErrCode.ADERR_SUCCESS):(e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID):e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG},o.prototype.doFetch=function(t,r,n,i){if(!t)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_POSIDCFG);if(!r)return e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var s=e.WXRewardVideoProxy.getInstance().fetch(t,r);if(!s)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP4WXVIDEO_FETCH_NO_ADHANDLER,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var c=new e.MGBAd4WXRewardVideo(t,s);return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(c)},o.prototype.getAdCache=function(){return null},o.prototype.getCacheSize=function(){return e.WXRewardVideoProxy.getInstance().hasCache()?1:0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="wx_video",o}();e.MGBAdProvider4WXRewardVideo=a}(d||(d={})),function(e){var a=function(){function o(){}return o.prototype.onReSize=function(t,r,n){if(n!=null){var i=wx.getSystemInfoSync();if(i!=null){var s=i.screenHeight-r,c=(i.screenWidth-t)/2,A=t;parseInt((100*r/t).toString())>parseInt(28.571428571428573.toString())&&(A=300),n.setAdPos(c,s,A)}}},o}();e.DefaultWXBAdPosAdapter=a}(d||(d={})),function(e){var a=function(){function o(){this.bInit=!1,this.mClickCallback=null,this.mPosIdCur="",this._init()}return o.getInstance=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype.init=function(){this._init()},o.prototype._init=function(){this.bInit||(wx.onShow(this.onShow.bind(this)),this.bInit=!0)},o.prototype.onShow=function(t){this.mClickCallback&&this.mClickCallback.onShowFinish(null,null,null)},o.prototype.regClickCallback=function(t,r){t&&r&&(this.mPosIdCur=t,this.mClickCallback=r)},o.prototype.unregClickCallback=function(t){t&&(this.mPosIdCur==t?(this.mClickCallback=null,this.mPosIdCur=""):e.Log.e(o.TAG,"[unregClickCallback] ERROR mPosIdCur:"+this.mPosIdCur+", posId:"+t))},o.TAG="MGB_WXBannerAdMonitor",o.sInst=null,o}();e.WXBannerAdMonitor=a}(d||(d={})),function(e){var a=function(){function o(){this.mWXAdHandler=null,this.mCacheStatus=0,this.mCacheStatus=o.STATUS_CACHE_NONE}return o.getInstance=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype._init=function(t){this.mWXAdHandler||wx.createRewardedVideoAd&&(this.mWXAdHandler=wx.createRewardedVideoAd({adUnitId:t}),this.mWXAdHandler&&(this.mWXAdHandler.onLoad(this.onAdLoad.bind(this)),this.mWXAdHandler.onError(this.onAdError.bind(this))))},o.prototype.load=function(t,r,n){this._init(r),this.mWXAdHandler?this.mWXAdHandler.load().then(function(){n&&n.onSuccess()}).catch(function(i){e.Log.e(o.TAG,"mWXAdHandler.load().catch(), posId = "+t.getPosId()+", "+JSON.stringify(i)),n&&n.onFailed(e.MGBAdErrCode.ADERR_AP_LOAD_WXBH_ONERROR,JSON.stringify(i),null)}):n&&n.onFailed(e.MGBAdErrCode.ADERR_AP4WXVIDEO_LOAD_NO_ADHANDLER,0,0)},o.prototype.fetch=function(t,r){return e.Log.i("MGB_ROM","WXRewardVideoProxy.fetch enter. this.mCacheStatus:"+this.mCacheStatus),this.hasCache()?(this.mCacheStatus=o.STATUS_CACHE_NONE,this.mWXAdHandler):null},o.prototype.hasCache=function(){return this.mCacheStatus==o.STATUS_CACHE_ENOUGH},o.prototype.onAdLoad=function(){this.mCacheStatus=o.STATUS_CACHE_ENOUGH,e.Log.i(o.TAG,"WX reward video load success. mCacheStatus:"+this.mCacheStatus)},o.prototype.onAdError=function(t){MGRPT.minigame_common_ad.report("",e.MGBAdAction.ACTION_WXRV_ONADERROR,JSON.stringify(t),e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.i(o.TAG,"WX reward video error:"+t)},o.TAG="MGB_WXRewardVideoProxy",o.sInst=null,o.STATUS_CACHE_NONE=1,o.STATUS_CACHE_ENOUGH=2,o}();e.WXRewardVideoProxy=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.TAG="MGB_MGBAd4FBInterstitial",this.mPosIdCfg=null,this.mInterstitialAdInstance=null,this.mPosIdCfg=r,this.mInterstitialAdInstance=t}return o.prototype.getAPName=function(){return e.MGBAdProvider4FBInterstitial.APNAME},o.prototype.isCurValid=function(){return this.mInterstitialAdInstance!==null&&typeof this.mInterstitialAdInstance!==void 0},o.prototype.show=function(t){if(this.mInterstitialAdInstance){this.doRptAdShow();var r=this;this.mInterstitialAdInstance.showAsync().then(function(){t&&t.onShowSuccess(r,null,null),e.Log.i(r.TAG,"FB interstitial ad show successfully"),r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL),t&&t.onShowFinish(r,null,null)}).catch(function(n){e.Log.e(r.TAG,"FB interstitial ad show failed, errInfo:"+n.code+", "+n.message),r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(n),e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL),t&&t.onShowFail(r,n.code,n.message)})}else e.Log.w(this.TAG,"FB interstitial ad show failed since adInstance not initialized"),t&&t.onShowFail(this,null,null)},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_LOADING,e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mInterstitialAdInstance=void 0},o}();e.MGBAd4FBInterstitial=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.TAG="MGB_MGBAd4FBRewardVideo",this.mPosIdCfg=null,this.mVideoAdInstance=null,this.mPosIdCfg=r,this.mVideoAdInstance=t}return o.prototype.getAPName=function(){return e.MGBAdProvider4FBRewardVideo.APNAME},o.prototype.isCurValid=function(){return this.mVideoAdInstance!==null&&typeof this.mVideoAdInstance!==void 0},o.prototype.show=function(t){if(this.mVideoAdInstance){this.doRptAdShow();var r=this;this.mVideoAdInstance.showAsync().then(function(){e.Log.i(r.TAG,"FB Rewarded video watched successfully"),r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO),t&&t.onShowFinish(r,null,null)}).catch(function(n){e.Log.e(r.TAG,"FB Rewarded video show failed, errInfo:"+n.code+", "+n.message),r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(n),e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO),t&&t.onShowFail(r,n.code,n.message)})}else e.Log.w(this.TAG,"FB Rewarded video show failed since adInstance not initialized"),t&&t.onShowFail(this,null,null)},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_LOADING,e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mVideoAdInstance=void 0},o}();e.MGBAd4FBRewardVideo=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.TAG="MGB_Ad4QQBanner",this.mBannerHandler=void 0,this.mPosIdCfg=null,this.mLeft=0,this.mTop=0,this.mWidth=0,this.mHeight=0,this.mBannerHandler=t,this.mPosIdCfg=r}return o.prototype.getAPName=function(){return e.MGBAdProvider4QQBanner.APNAME},o.prototype.isCurValid=function(){return typeof this.mBannerHandler!==void 0},o.prototype.show=function(t){var r=this;e.Log.i(this.TAG,"ready to show QQ banner ad, posId = "+this.mPosIdCfg.getPosId()),this.mBannerHandler&&this.mBannerHandler.show(function(n,i,s){if(n==0){if(e.Log.i(r.TAG," QQ banner show success, posId = "+r.mPosIdCfg.getPosId()),e.MGBAdModule.getInstance().hasSceneExitFlag(r.mPosIdCfg.getPosId()))return e.Log.i(r.TAG," QQ banner need destroy now, because has exit flag, posId = "+r.mPosIdCfg.getPosId()),MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_QQ_BANNER),void r.destroy();r.doRptAdShow(),t&&t.onShowSuccess(r,n,i)}else r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_QQ_BANNER),e.Log.e(r.TAG,"QQ banner show failed, posId = "+r.mPosIdCfg.getPosId()+"; errInfo = "+i),t&&t.onShowFail(r,n,i)})},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_BANNER)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mBannerHandler&&this.mBannerHandler.close()},o}();e.MGBAd4QQBanner=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.TAG="MGBAd4QQRewardVideo",this.mPosIdCfg=null,this.mVideoAdHandler=void 0,this.mVideoAdHandler=t,this.mPosIdCfg=r}return o.prototype.getAPName=function(){return e.MGBAdProvider4QQRewardVideo.APNAME},o.prototype.isCurValid=function(){return this.mVideoAdHandler!==null&&typeof this.mVideoAdHandler!==void 0},o.prototype.show=function(t){if(this.mVideoAdHandler){var r=!1;this.mVideoAdHandler.setEventCallack(function(n,i){this.mVideoAdHandler=void 0}.bind(this),function(n,i){r=!0}.bind(this),function(n,i){this.mVideoAdHandler=void 0,r?(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO),t&&t.onShowFinish(this,n,i)):(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_NOT_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO),t&&t.onShowUnFinish(this,n,i))}.bind(this),function(n,i){this.doRptAdShow(),t&&t.onShowSuccess(this,n,i)}.bind(this)),this.mVideoAdHandler.jump()}else this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO),t&&t.onShowFail(this,null,null)},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mVideoAdHandler&&(this.mVideoAdHandler=void 0)},o}();e.MGBAd4QQRewardVideo=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.TAG="MGB_Ad4WXBanner",this.mWXAdHandler=null,this.mPosAdapter=null,this.mLeft=0,this.mTop=0,this.mWidth=0,this.mHeight=0,this.mPosIdCfg=null,this.mWXAdHandler=r,this.mPosIdCfg=t}return o.prototype.getAPName=function(){return e.MGBAdProvider4WXBanner.APNAME},o.prototype.isCurValid=function(){return!0},o.prototype.getTop=function(){return this.mTop},o.prototype.getLeft=function(){return this.mLeft},o.prototype.getWidth=function(){return this.mWidth},o.prototype.getHeight=function(){return this.mHeight},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_BANNER)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.unRegClickCallback(),this.mWXAdHandler!=null&&(this.mWXAdHandler.hide(),this.mWXAdHandler.destroy())},o.prototype.setAdPos=function(t,r,n){this.mWXAdHandler!=null&&(this.mWXAdHandler.style.top=r,this.mWXAdHandler.style.left=t,this.mWXAdHandler.style.width=n,this.mTop=r,this.mLeft=t,this.mWidth=n)},o.prototype.show=function(t){var r=this;if(this.mPosIdCfg&&this.mPosIdCfg.getPosId()){if(e.MGBAdModule.getInstance().hasSceneExitFlag(this.mPosIdCfg.getPosId()))return void MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_WX_BANNER);e.WXBannerAdMonitor.getInstance().regClickCallback(this.mPosIdCfg.getPosId(),t)}e.Log.i(this.TAG,"ready to show WX banner ad, posId = "+this.mPosIdCfg.getPosId()),this.mWXAdHandler&&this.mWXAdHandler.show().then(function(){r.doRptAdShow(),t&&t.onShowSuccess(r,r.mWXAdHandler.style.realWidth,r.mWXAdHandler.style.realHeight),e.Log.i(r.TAG," WX banner show success, posId = "+r.mPosIdCfg.getPosId())}).catch(function(n){r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(n),e.MGBAdDefs.ADTYPE_WX_BANNER),t&&t.onShowFail(r,null,null),e.Log.e(r.TAG,"WX banner show failed, posId = "+r.mPosIdCfg.getPosId()+"; errInfo = "+n)})},o.prototype.hide=function(){this.unRegClickCallback(),this.mWXAdHandler&&this.mWXAdHandler.hide()},o.prototype.unRegClickCallback=function(){this.mPosIdCfg&&this.mPosIdCfg.getPosId()&&e.WXBannerAdMonitor.getInstance().unregClickCallback(this.mPosIdCfg.getPosId())},o}();e.MGBAd4WXBanner=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.TAG="MGB_Ad4WXRewardVideo",this.mWXAdHandler=null,this.mAdShowCallback=null,this.mPosIdCfg=null,this.mCloseCallback=null,this.mWXAdHandler=r,this.mPosIdCfg=t,this.init()}return o.prototype.init=function(){this.mWXAdHandler&&(this.mCloseCallback=this.onAdClose.bind(this),this.mWXAdHandler.onClose(this.mCloseCallback))},o.prototype.unInit=function(){this.mWXAdHandler&&this.mWXAdHandler.offClose(this.mCloseCallback)},o.prototype.getAPName=function(){return e.MGBAdProvider4WXRewardVideo.APNAME},o.prototype.isCurValid=function(){return!0},o.prototype.doRptAdShow=function(){},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.unInit()},o.prototype.show=function(t){var r=this;this.mPosIdCfg&&this.mPosIdCfg.getPosId()&&e.MGBAdModule.getInstance().hasSceneExitFlag(this.mPosIdCfg.getPosId())?MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO):(this.mAdShowCallback=t,this.mWXAdHandler!=null&&this.mWXAdHandler.show().then(function(){r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),r.mAdShowCallback&&r.mAdShowCallback.onShowSuccess(r,null,null)}).catch(function(n){r.mPosIdCfg&&MGRPT.minigame_common_ad.report(r.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(n),e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.e(r.TAG,"mRewardedVideoAd \u5F39\u51FA\u5E7F\u544A\u5168\u5C4F\u6846\u5931\u8D25\u4E86..., posId = "+r.mPosIdCfg.getPosId()),r.mAdShowCallback&&r.mAdShowCallback.onShowFail(r,null,null),r.tryAgain(r.mPosIdCfg.getPosId())}))},o.prototype.tryAgain=function(t){if(this.mWXAdHandler){var r=this.mWXAdHandler;r.load().then(function(){r.show().then(function(){MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_WXRV_SHOW_TRYAGAIN,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO)})})}},o.prototype.onAdClose=function(t){e.Log.i(this.TAG,"onAdClose, posId = "+this.mPosIdCfg.getPosId()),this.mAdShowCallback!=null&&(t&&t.isEnded||t===void 0?(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.i(this.TAG,"\u6B63\u5E38\u64AD\u653E\u7ED3\u675F\uFF0C\u53EF\u4EE5\u4E0B\u53D1\u6E38\u620F\u5956\u52B1, posId = "+this.mPosIdCfg.getPosId()),this.mAdShowCallback&&this.mAdShowCallback.onShowFinish(this,null,null)):(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_NOT_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.i(this.TAG,"\u64AD\u653E\u4E2D\u9014\u9000\u51FA\uFF0C\u4E0D\u4E0B\u53D1\u6E38\u620F\u5956\u52B1, posId = "+this.mPosIdCfg.getPosId()),this.mAdShowCallback&&this.mAdShowCallback.onShowUnFinish(this,null,null)),this.mAdShowCallback=null)},o}();e.MGBAd4WXRewardVideo=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.TAG="MGB_AdSelector4Auto",this.mPosIdCfg=null,this.mAdProvider=null,this.mPlatformType=null,this.mPlatformType=t,this.mPosIdCfg=r}return o.prototype.fetchAd=function(t,r){if(this.prepareAdProviders(),this.mAdProvider==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_ADPROVIDER);if(this.mPosIdCfg==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_POSIDCFG);var n=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doFetch(this.mPosIdCfg,n,t,r)},o.prototype.loadAd=function(t,r){if(this.prepareAdProviders(),this.mAdProvider==null)return e.MGBAdErrCode.ADERR_AS_LOAD_NO_ADPROVIDER;if(this.mPosIdCfg==null)return e.MGBAdErrCode.ADERR_AS_LOAD_NO_POSIDCFG;var n=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doLoad(this.mPosIdCfg,n,t,r)},o.prototype.getCurSelAdType=function(){return this.prepareAdProviders(),this.mAdProvider?this.mAdProvider.getAdType():e.MGBAdDefs.ADTYPE_UNKNOWN},o.prototype.prepareAdProviders=function(){if(this.mAdProvider==null&&this.mPosIdCfg!=null){var t=this.mPosIdCfg.getNum(e.MGBAdPosIdCfg.KEY_ADTYPE,-1);t!=-1?(this.mAdProvider=this.instanceProvider(this.mPlatformType,t),this.mAdProvider!=null||e.Log.e(this.TAG,"didn't find match adprovider for "+this.mPlatformType+" / "+t)):e.Log.e(this.TAG,"PosIdConfig must be specified adType")}},o.prototype.getCacheSize=function(){return this.prepareAdProviders(),this.mAdProvider==null?(e.Log.e(this.TAG,"MGBAdSelector4Auto this.mAdProvider == null."),0):this.mAdProvider.getCacheSize()},o.prototype.instanceProvider=function(t,r){var n=null;switch(t){case e.MGBAdDefs.PLATFORM_WX:o.ADTYPE_BANNER==r?n=e.MGBAdProvider4WXBanner.APNAME:o.ADTYPE_REWARD_VIDEO==r&&(n=e.MGBAdProvider4WXRewardVideo.APNAME);break;case e.MGBAdDefs.PLATFORM_QQ:o.ADTYPE_BANNER==r?n=e.MGBAdProvider4QQBanner.APNAME:o.ADTYPE_REWARD_VIDEO==r&&(n=e.MGBAdProvider4QQRewardVideo.APNAME);break;case e.MGBAdDefs.PLATFORM_FB:o.ADTYPE_BANNER==r?(e.Log.w(this.TAG,"facebook doesn't provide banner ad"),n=e.MGBAdProvider4FBInterstitial.APNAME):o.ADTYPE_REWARD_VIDEO==r&&(n=e.MGBAdProvider4FBRewardVideo.APNAME)}return e.MGBAdCompFactory.getInstance().createAP(n)},o.ADTYPE_BANNER=100,o.ADTYPE_REWARD_VIDEO=200,o.ASNAME="auto_selector",o}();e.MGBAdSelector4Auto=a}(d||(d={})),function(e){var a=function(){function o(t){this.mPosIdCfg=null,this.mAdProvider=null,this.mPosIdCfg=t}return o.prototype.fetchAd=function(t,r){if(this.prepareAdProviders(),this.mAdProvider==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_ADPROVIDER);if(this.mPosIdCfg==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_POSIDCFG);var n=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doFetch(this.mPosIdCfg,n,t,r)},o.prototype.loadAd=function(t,r){if(this.prepareAdProviders(),this.mAdProvider==null)return e.MGBAdErrCode.ADERR_AS_FETCH_NO_ADPROVIDER;if(this.mPosIdCfg==null)return e.MGBAdErrCode.ADERR_AS_LOAD_NO_POSIDCFG;var n=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doLoad(this.mPosIdCfg,n,t,r)},o.prototype.prepareAdProviders=function(){if(this.mAdProvider==null&&this.mPosIdCfg!=null){var t=this.mPosIdCfg.getStr(e.MGBAdPosIdCfg.KEY_ADPROVIDER_NAME,"");t!=null&&(this.mAdProvider=e.MGBAdCompFactory.getInstance().createAP(t),this.mAdProvider)}},o.prototype.getCurSelAdType=function(){return this.prepareAdProviders(),this.mAdProvider?this.mAdProvider.getAdType():e.MGBAdDefs.ADTYPE_UNKNOWN},o.prototype.getCacheSize=function(){return this.mAdProvider==null?0:this.mAdProvider.getCacheSize()},o.ASNAME="manual_selector",o}();e.MGBAdSelector4Manual=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_MGBGameDepot",this.mListRcmdDest=new Array}return o.prototype.saveGames=function(t){if(t){for(var r=0,n=t;r<n.length;r++){var i=n[r],s=new e.MGBRcmdGame(i);this.mListRcmdDest.push(s)}e.Log.i(this.TAG,"mListRcmdDest.size:"+this.mListRcmdDest.length)}},o.prototype.getItem=function(t){return this.mListRcmdDest.length==0||t<0||t>=this.mListRcmdDest.length?null:this.mListRcmdDest[t]},o.prototype.getSize=function(){return this.mListRcmdDest?this.mListRcmdDest.length:0},o}();e.MGBGameDepot=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_MGBImg4Flag",this.mapImgUrls={}}return o.prototype.saveImgUrls=function(t){if(t)for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];if(i){var s=t[i];this.mapImgUrls[i]=s,e.Log.i(this.TAG,"imgurls flag["+i+"]: "+s)}}},o.prototype.getImgUrl=function(t){return t&&this.mapImgUrls?this.mapImgUrls[t]:null},o}();e.MGBImg4Flag=a}(d||(d={})),function(e){var a=function(){function o(t,r){this.mPosId=null,this.mPosId=t;var n=e.MGBRcmdModule.inst().getGameId();this.isDataCached()?(MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_LOCAL_START,0,this.getRptAdType()),this.loadFromCache(n,r)):(MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_START,0,this.getRptAdType()),this.loadFromNet(n,r))}return o.prototype.loadFromNet=function(t,r){var n=this,i=this.prepareUrl(t),s=this;if(!i||i.length==0)return e.Log.e(o.TAG,"urlDest is empty."),void(r&&r.onFailed());e.Log.i(o.TAG,"loadFromNet urlDest:"+i),e.PlatformProxy.getInstance().request({url:i,header:{Referer:"sqimg.qq.com"},method:"GET",dataType:"json",success:function(c,A){A?(MGRPT.minigame_common_ad.report(n.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,n.getRptAdType()),n.saveData2Cache(A),r&&r.onReady(s)):(e.Log.e(o.TAG,"enter success: data == null"),MGRPT.minigame_common_ad.report(n.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_FAILED,"NO DATA",n.getRptAdType()),r&&r.onFailed())},fail:function(c,A){MGRPT.minigame_common_ad.report(n.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_FAILED,c,n.getRptAdType()),e.Log.e(o.TAG,"enter fail: code:"+c),r&&r.onFailed()}})},o.prototype.loadFromCache=function(t,r){e.Log.i(o.TAG,"loadFromLocal begin."),this.isDataCached()?r&&(MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_LOCAL_SUCCESS,0,this.getRptAdType()),r.onReady(this)):r&&(MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_LOCAL_FAILED,0,this.getRptAdType()),r.onFailed())},o.prototype.getRptAdType=function(){return e.MGBAdDefs.ADTYPE_RCMD_UNKNOWN},o.prototype.prepareUrl=function(t){var r=e.MGBRcmdModule.inst().getRcmdDataHost();return r||(r=e.MGBRcmdDefs.HOST),r+t+"/rcmdtype_"+this.getRcmdType()+".json"},o.TAG="MGB_MGBRcmd",o}();e.MGBRcmd=a}(d||(d={})),function(e){var a=function(o){function t(){return o!==null&&o.apply(this,arguments)||this}return D(t,o),t.prototype.getRcmdType=function(){return e.MGBRcmdDefs.RCMDTYPE_BIGCARD},t.prototype.isDataCached=function(){return!!t.sRcmdTypeData},t.prototype.saveData2Cache=function(r){return t._saveData2Cache(r)},t._saveData2Cache=function(r){if(!r)return!1;t.sRcmdTypeData=r,t.sGameDepot||(t.sGameDepot=new e.MGBGameDepot);var n=t.sRcmdTypeData.games;return n&&t.sGameDepot.saveGames(n),!0},t.TAG="MGB_MGBRcmd4BigCard",t.sRcmdTypeData=null,t.sGameDepot=null,t}(e.MGBRcmd);e.MGBRcmd4BigCard=a}(d||(d={})),function(e){var a=function(o){function t(){var r=o!==null&&o.apply(this,arguments)||this;return r.mCurPos=0,r.mbGetStartPos=!1,r}return D(t,o),t.prototype.isDataCached=function(){return!!t.sRawJsonData},t.prototype.getRcmdType=function(){return e.MGBRcmdDefs.RCMDTYPE_GIFTBOX},t.prototype.saveData2Cache=function(r){return t._saveData2Cache(r)},t._saveData2Cache=function(r){if(!r)return!1;t.sRawJsonData=r,t.sGameDepot||(t.sGameDepot=new e.MGBGameDepot);var n=t.sRawJsonData.games;return n&&t.sGameDepot.saveGames(n),!0},t.prototype.getIconUrlCur=function(){var r=this.getRCmdGamePosCur(),n=t.sGameDepot.getItem(r);return n?n.iconUrl:(e.Log.i(t.TAG,"!game"),null)},t.prototype.jump=function(r){var n=this;r===void 0&&(r=null);var i=this.getRCmdGamePosCur(),s=t.sGameDepot.getItem(i);s?(MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_START,s.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_GIFTBOX),e.PlatformProxy.getInstance().skipGame(this.mPosId,s,{success:function(c){r&&r.success(c),MGRPT.minigame_common_ad.report(n.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_END,s.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_GIFTBOX)},fail:function(c){r&&r.fail(c)}})):e.Log.e(t.TAG,"jump failed. no game match.")},t.prototype.getRCmdGamePosCur=function(){return this.mbGetStartPos||(this.mCurPos=this.getStartPos(),this.mbGetStartPos=!0),this.mCurPos},t.prototype.next=function(){var r=this.getGameDestCount();r!=0?this.mCurPos=(this.mCurPos+1)%r:e.Log.e(t.TAG,"nGameCount == 0, can't goto next.")},t.prototype.getStartPos=function(){if(!t.sRawJsonData)return 0;var r=t.sRawJsonData.posconfig;if(!r)return e.Log.e(t.TAG,"!posConfig"),0;for(var n=0,i=r;n<i.length;n++){var s=i[n];if(s&&s.posid&&s.posid==this.mPosId)return s.start_pos?s.start_pos:0}return 0},t.prototype.getGameDestCount=function(){if(!t.sRawJsonData)return 0;var r=t.sRawJsonData.games;return r?r.length:0},t.fillCache=function(r){try{var n=JSON.parse(r)}catch(i){return void e.Log.e(t.TAG,"JSON.parse failed. cacheData:"+r)}t._saveData2Cache(n)},t.TAG="MGB_MGBRcmd4GiftBox",t.sRawJsonData=null,t.sGameDepot=null,t}(e.MGBRcmd);e.MGBRcmd4GiftBox=a}(d||(d={})),function(e){var a=function(o){function t(){var r=o!==null&&o.apply(this,arguments)||this;return r.mGameSelected=null,r}return D(t,o),t.prototype.getRcmdType=function(){return e.MGBRcmdDefs.RCMDTYPE_SCOREWALL},t.prototype.isDataCached=function(){return!!t.sRawJsonData},t.prototype.saveData2Cache=function(r){var n;return n=t._saveData2Cache(r),this._savePosIdCfg(),n},t._saveData2Cache=function(r){if(!r||t.sRawJsonData)return!1;t.sRawJsonData=r,t.sGameDepot||(t.sGameDepot=new e.MGBGameDepot);var n=t.sRawJsonData.games;n&&t.sGameDepot.saveGames(n);var i=t.sRawJsonData.img4flag;return i&&(t.sImg4Flags||(t.sImg4Flags=new e.MGBImg4Flag),t.sImg4Flags.saveImgUrls(i)),!0},t.fillCache=function(r){try{var n=JSON.parse(r)}catch(i){return void e.Log.e(t.TAG,"JSON.parse failed. cacheData:"+r)}t._saveData2Cache(n)},t.prototype.getSize=function(){return this.isDataCached()?(this._savePosIdCfg(),this.mGameSelected?Object.keys(this.mGameSelected).length:0):0},t.prototype.getGameInfo=function(r){if(!this.isDataCached())return null;this._savePosIdCfg();var n=this.getGameIdx(r);return t.sGameDepot.getItem(n)},t.prototype.jump=function(r,n){var i=this;if(n===void 0&&(n=null),!this.isDataCached())return!1;this._savePosIdCfg();var s=this.getGameIdx(r),c=t.sGameDepot.getItem(s);if(!c)return e.Log.e(t.TAG,"No Game. jump_idxGS["+r+"]_gameIdx["+s+"]"),!1;MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_START,c.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_SCOREWALL),e.PlatformProxy.getInstance().skipGame(this.mPosId,c,{success:function(A){n&&n.success(A),MGRPT.minigame_common_ad.report(i.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_END,c.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_SCOREWALL)},fail:function(A){n&&n.fail(A)}})},t.getFlagUrl=function(r){return r&&t.sImg4Flags?t.sImg4Flags.getImgUrl(r):null},t.prototype.getGameIdx=function(r){return r<0||!this.mGameSelected||r>=this.mGameSelected.length?-1:this.mGameSelected[r]},t.prototype._savePosIdCfg=function(){if(!(this.mGameSelected&&0<this.mGameSelected.length))if(this.isDataCached())if(this.mPosId){var r=t.sRawJsonData.posconfig;if(r)for(var n=0,i=r;n<i.length;n++){var s=i[n];if(s){var c=s.posid;if(c&&c==this.mPosId){var A=s.game_sel;return void(A&&this._saveGameSel(A))}}}else e.Log.e(t.TAG,"!aryPosCfg in MGBRcmd4ScoreWall")}else e.Log.e(t.TAG,"no mPosId in MGBRcmd4ScoreWall");else e.Log.e(t.TAG,"no DataCached in MGBRcmd4ScoreWall")},t.prototype._saveGameSel=function(r){r&&(this.mGameSelected&&0<this.mGameSelected.length?e.Log.i(t.TAG,"in _saveGameSel, this.mGameSelected saved."):(this.mGameSelected=r,e.Log.i(t.TAG,"_saveGameSel size:"+this.mGameSelected.length)))},t.TAG="MGB_MGBRcmd4ScoreWall",t.sRawJsonData=null,t.sGameDepot=null,t.sImg4Flags=null,t}(e.MGBRcmd);e.MGBRcmd4ScoreWall=a}(d||(d={})),function(e){var a=function(){function o(){}return o.RCMDTYPE_GIFTBOX=1,o.RCMDTYPE_BIGCARD=2,o.RCMDTYPE_SCOREWALL=3,o.HOST="https://piano-weixin-game.cmcm.com/pianotiles2/cfg/game_rcmd/",o}();e.MGBRcmdDefs=a}(d||(d={})),function(e){var a=function(){function o(t){this.name="",this.iconUrl="",this.gameidWX="",this.gameidQQ=0,this.bigimgURL="",this.title="",this.describe="",this.describe2="",this.flag="",this.mapRewards={},t&&(this.name=t.name,t.icon&&(this.iconUrl=t.icon),this.gameidWX=t.gameid_wx,this.gameidQQ=t.gameid_qq?Number(t.gameid_qq):0,t.big_img&&(this.bigimgURL=t.big_img),t.title&&(this.title=t.title),t.describe&&(this.describe=t.describe),t.describe2&&(this.describe2=t.describe2),t.rewards&&this._saveRewards(t.rewards),t.flag&&(this.flag=t.flag))}return o.prototype.getGameId=function(){var t=e.PlatformChecker.getPlatformType();return t==e.MGBAdDefs.PLATFORM_QQ?this.gameidQQ:t==e.MGBAdDefs.PLATFORM_WX?this.gameidWX:""},o.prototype._saveRewards=function(t){if(t)for(var r in t)this.mapRewards[r]=t[r],e.Log.i("[MGB_ROM] in _saveRewards, key:"+r+", count:"+t[r])},o}();e.MGBRcmdGame=a}(d||(d={})),function(e){var a=function(){function o(){this.mGameId4RCmd=0,this.mUrlRcmdDir=null}return o.inst=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype.init=function(t){var r=e.PlatformChecker.getPlatformType();e.PlatformProxy.getInstance().init(r),this.mGameId4RCmd=t},o.prototype.getGameId=function(){return this.mGameId4RCmd},o.prototype.setRcmdDataHost=function(t){this.mUrlRcmdDir=t},o.prototype.getRcmdDataHost=function(){return this.mUrlRcmdDir},o.sInst=null,o}();e.MGBRcmdModule=a}(d||(d={})),function(e){var a=function(){function o(){}return o.prototype.getPlatformType=function(){return this.isPlatformWX()?e.MGBAdDefs.PLATFORM_WX:this.isPlatformQQ()?e.MGBAdDefs.PLATFORM_QQ:this.isPlatformFB()?e.MGBAdDefs.PLATFORM_FB:this.isPlatformWeb()?e.MGBAdDefs.PLATFORM_WEB:"unknown_platform"},o.prototype.isPlatformWX=function(){return cc.sys.platform==cc.sys.WECHAT_GAME},o.prototype.isPlatformQQ=function(){return cc.sys.platform==cc.sys.QQ_PLAY},o.prototype.isPlatformWeb=function(){return cc.sys.platform==cc.sys.DESKTOP_BROWSER||cc.sys.platform==cc.sys.MOBILE_BROWSER},o.prototype.isPlatformFB=function(){return typeof FBInstant!="undefined"},o.prototype.setLocalItem=function(t,r){cc.sys.localStorage.setItem(t,r)},o.prototype.getLocalItem=function(t){return cc.sys.localStorage.getItem(t)},o.prototype.removeLocalItem=function(t){cc.sys.localStorage.removeItem(t)},o.prototype.clear=function(){},o}();e.GameEngine4CC=a}(d||(d={})),function(e){var a=function(){function o(){}return o.prototype.getPlatformType=function(){return this.isPlatformWX()?e.MGBAdDefs.PLATFORM_WX:this.isPlatformQQ()?e.MGBAdDefs.PLATFORM_QQ:this.isPlatformFB()?e.MGBAdDefs.PLATFORM_FB:this.isPlatformWeb()?e.MGBAdDefs.PLATFORM_WEB:"unknown_platform"},o.prototype.isPlatformWX=function(){if(Laya.Browser.onMiniGame)return!0},o.prototype.isPlatformQQ=function(){return!!(Laya.Browser.userAgent&&-1<Laya.Browser.userAgent.indexOf("limixiu"))},o.prototype.isPlatformWeb=function(){return!0},o.prototype.isPlatformFB=function(){return typeof FBInstant!="undefined"},o.prototype.setLocalItem=function(t,r){Laya.LocalStorage.setItem(t,r)},o.prototype.getLocalItem=function(t){return Laya.LocalStorage.getItem(t)},o.prototype.removeLocalItem=function(t){Laya.LocalStorage.removeItem(t)},o.prototype.clear=function(){Laya.LocalStorage.clear()},o}();e.GameEngine4LayaBox=a}(d||(d={})),function(e){var a=function(){function o(){}return o.getPlatformType=function(){return o.mPlatformTypeCur?o.mPlatformTypeCur:(o.prepareGECur(),o.mGameEngineCur?o.mPlatformTypeCur=o.mGameEngineCur.getPlatformType():"")},o.isPlatformWX=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformWX()},o.isPlatformQQ=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformQQ()},o.isPlatformWeb=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformWeb()},o.isPlatformFB=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformFB()},o.setLocalItem=function(t,r){o.prepareGECur(),o.mGameEngineCur&&o.mGameEngineCur.setLocalItem(t,r)},o.getLocalItem=function(t){o.prepareGECur(),o.mGameEngineCur&&o.mGameEngineCur.getLocalItem(t)},o.removeLocalItem=function(t){o.prepareGECur(),o.mGameEngineCur&&o.mGameEngineCur.removeLocalItem(t)},o.clear=function(){o.prepareGECur(),o.mGameEngineCur&&o.clear()},o.prepareGECur=function(){if(!o.mGameEngineCur){var t=o.getCurEngineType();o.setCurGameEngine(t)}},o.setCurGameEngine=function(t){if(!this.mGameEngineCur&&t&&t.length!=0)switch(t){case e.MGBAdDefs.GETYPE_CC:this.mGameEngineCur=new e.GameEngine4CC;break;case e.MGBAdDefs.GETYPE_LAYABOX:this.mGameEngineCur=new e.GameEngine4LayaBox}},o.getCurEngineType=function(){return typeof Laya!="undefined"&&Laya.LocalStorage!==void 0?e.MGBAdDefs.GETYPE_LAYABOX:typeof cc!="undefined"&&cc.sys!==void 0?e.MGBAdDefs.GETYPE_CC:""},o.mGameEngineCur=null,o.mPlatformTypeCur=null,o}();e.GameEngineProxy=a}(d||(d={})),function(e){var a=function(){function o(){this.mMapObject=new Map}return o.prototype.setNum=function(t,r){this.mMapObject.set(t,r)},o.prototype.getNum=function(t,r){if(!this.mMapObject.has(t))return r;var n=this.mMapObject.get(t);return n==null||typeof n!="number"?r:n},o.prototype.setStr=function(t,r){this.mMapObject.set(t,r)},o.prototype.getStr=function(t,r){if(!this.mMapObject.has(t))return r;var n=this.mMapObject.get(t);return n==null||typeof n!="string"?r:n},o.prototype.setObject=function(t,r){this.mMapObject.set(t,r)},o.prototype.getObject=function(t,r){return this.mMapObject.has(t)?this.mMapObject.get(t):r},o}();e.Params=a}(d||(d={})),function(e){var a=function(){this.brand="",this.model="",this.pixelRatio=0,this.screenWidth=0,this.screenHeight=0,this.windowWidth=0,this.windowHeight=0,this.statusBarHeight=0,this.language="",this.version="",this.system="",this.platform="",this.fontSizeSetting=0,this.SDKVersion="",this.benchmarkLevel=1};e.PlatformInfo=a;var o=function(){};e.LaunchOption=o}(d||(d={})),function(e){var a=function(){function o(){}return o.ACTION_UNKNOWN=0,o.ACTION_SHOW_SUCCESS=1,o.ACTION_CLICK=2,o.ACTION_SHOW_FAILED=3,o.ACTION_SHOW_BEGIN=4,o.ACTION_SELECTOR_FETCH_START=20,o.ACTION_SELECTOR_FETCH_SUCCESS=21,o.ACTION_SELECTOR_FETCH_FAILED=22,o.ACTION_SELECTOR_LOAD_START=40,o.ACTION_SELECTOR_LOAD_SUCCESS=41,o.ACTION_SELECTOR_LOAD_FAILED=42,o.ACTION_AP_FETCH_START=100,o.ACTION_AP_FETCH_SUCCESS=101,o.ACTION_AP_FETCH_FAILED=102,o.ACTION_AP_LOAD_START=120,o.ACTION_AP_LOAD_SUCCESS=121,o.ACTION_AP_LOAD_FAILED=122,o.ACTION_NOT_TO_LOAD=123,o.ACTION_WXRV_CLOSE_CLICK_NOT_END=150,o.ACTION_WXRV_CLOSE_CLICK_END=151,o.ACTION_WXRV_SHOW_TRYAGAIN=152,o.ACTION_WXRV_ONADERROR=153,o.ACTION_RCMD_LOAD_FROM_NET_START=501,o.ACTION_RCMD_LOAD_FROM_NET_SUCCESS=502,o.ACTION_RCMD_LOAD_FROM_NET_FAILED=503,o.ACTION_RCMD_LOAD_FROM_LOCAL_START=511,o.ACTION_RCMD_LOAD_FROM_LOCAL_SUCCESS=512,o.ACTION_RCMD_LOAD_FROM_LOCAL_FAILED=513,o.ACTION_RCMD_JUMPGAME_START=10002,o.ACTION_RCMD_JUMPGAME_END=551,o.ACTION_BUTTON_SHOW=10001,o.ACTION_BUTTON_CLICK=10002,o}();e.MGBAdAction=a}(d||(d={})),function(e){var a=function(){function o(){this.mAdCache=new Array}return o.prototype.getSize=function(){return this.removeInvalidCache(),this.mAdCache==null?0:this.mAdCache.length},o.prototype.pushBack=function(t){this.mAdCache.push(t)},o.prototype.popFront=function(){return this.mAdCache.pop()},o.prototype.removeInvalidCache=function(){if(this.mAdCache!=null&&this.mAdCache.length!=0)for(var t=!1,r=0,n=(t=!1,this.mAdCache.length);r<n;t?r:r++){var i=this.mAdCache[r];i!=null&&i.isCurValid()?t=!1:(this.mAdCache.splice(r,1),t=!0)}},o}();e.MGBAdCache=a}(d||(d={})),function(e){var a=function(){function o(){this.mMapId2APCreator=new Map,this.mMapId2ASCreator=new Map,this.TAG="MGB_AdCompFactory"}return o.getInstance=function(){return o.sInst!=null?o.sInst:o.sInst=new o},o.prototype.regAPCreator=function(t,r){this.mMapId2APCreator.set(t,r)},o.prototype.createAP=function(t){if(t==null||!this.mMapId2APCreator.has(t))return e.Log.e(this.TAG,"apName is not registered to MGBAdCompFactory."),null;var r=this.mMapId2APCreator.get(t);return r==null?null:r.createNewAdProvider()},o.prototype.getAPCreator=function(t){if(!this.mMapId2APCreator.has(t))return null;this.mMapId2APCreator.get(t)},o.prototype.regASCreator=function(t,r){this.mMapId2ASCreator.set(t,r)},o.prototype.createAS=function(t,r){if(t==null||!this.mMapId2ASCreator.has(t))return null;var n=this.mMapId2ASCreator.get(t);return n==null?null:n.createNewAdSelector(r)},o.prototype.getASCreator=function(t){if(!this.mMapId2ASCreator.has(t))return null;this.mMapId2ASCreator.get(t)},o.sInst=null,o}();e.MGBAdCompFactory=a}(d||(d={})),function(e){var a=function(){function o(t){this.mPosIdCfg=null,this.mAdSelector=null,this.mAdLast=null,this.TAG="MGB_AdDepot",this.mPosIdCfg=t}return o.prototype.doLoad=function(t,r){return this.prepareAdSelector(),this.mAdSelector==null?e.MGBAdErrCode.ADERR_DEPOT_LOAD_NO_ADSELECTOR:(t==null&&(t=new e.ParamAdLoad),this.destoryLastAd(),this.mAdSelector.loadAd(t,r))},o.prototype.doFetch=function(t,r){if(this.prepareAdSelector(),this.mAdSelector==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_DEPOT_FETCH_NO_ADSELECTOR);t==null&&(t=new e.ParamAdFetch),this.destoryLastAd();var n=this.mAdSelector.fetchAd(t,r);return n!=null&&n.mAdErrCode==e.MGBAdErrCode.ADERR_SUCCESS&&(this.mAdLast=n.getAd()),n},o.prototype.prepareAdSelector=function(){if(this.mAdSelector==null&&this.mPosIdCfg!=null){var t=this.mPosIdCfg.getStr(e.MGBAdPosIdCfg.KEY_ADSELECTOR_NAME,"");t!=null&&t.length!=0||e.Log.e(this.TAG,"posId: asName == null"),this.mAdSelector=e.MGBAdCompFactory.getInstance().createAS(t,this.mPosIdCfg)}},o.prototype.getCacheSize=function(){return this.prepareAdSelector(),this.mAdSelector==null?(e.Log.e("MGB_DEBUG","MGBAdDepot.getCacheSize: this.mAdSelector == null"),0):this.mAdSelector.getCacheSize()},o.prototype.destoryLastAd=function(){this.mAdLast!=null&&(this.mAdLast.destroy(),this.mAdLast=null)},o.prototype.getAdType=function(){return this.prepareAdSelector(),this.mAdSelector?this.mAdSelector.getCurSelAdType():e.MGBAdDefs.ADTYPE_UNKNOWN},o}();e.MGBAdDepot=a}(d||(d={})),function(e){var a=function(o){function t(){var r=o.call(this)||this;return r.TAG="MGB_AdEnvCfg",r.mPlatformType=null,r.mPlatformInfo=null,r.mInitTime=Date.now(),r.mPlatformType=e.PlatformChecker.getPlatformType(),e.PlatformProxy.getInstance().init(r.mPlatformType),e.Log.i(r.TAG,"PlatformProxy.init: "+r.mPlatformType),r.mPlatformInfo=e.PlatformProxy.getInstance().getPlatformInfo(),e.Log.i(r.TAG,"[platform]: "+JSON.stringify(r.mPlatformInfo)),r}return D(t,o),t.prototype.getPlatformType=function(){return this.mPlatformType},t.prototype.getPlatformInfo=function(){return this.mPlatformInfo},t}(e.Params);e.MGBAdEnvCfg=a}(d||(d={})),function(e){var a=function(){function o(){}return o.ADERR_UNKNOWN=-1,o.ADERR_SUCCESS=0,o.ADERR_LOADING=1,o.ADERR_DEPOT_LOAD_NO_ADSELECTOR=40,o.ADERR_DEPOT_FETCH_NO_ADSELECTOR=41,o.ADERR_AS_FETCH_NO_ADPROVIDER=60,o.ADERR_AS_LOAD_NO_ADPROVIDER=61,o.ADERR_AS_FETCH_NO_POSIDCFG=62,o.ADERR_AS_LOAD_NO_POSIDCFG=63,o.ADERR_AP_LOAD_NO_NATIVEPOSID=100,o.ADERR_AP_LOAD_NO_POSIDCFG=101,o.ADERR_AP_LOAD_WXBH_ONERROR=102,o.ADERR_AP_LOAD_ARGS_ERROR=103,o.ADERR_AP_FETCH_NO_NATIVEPOSID=120,o.ADERR_AP_FETCH_NO_POSIDCFG=121,o.ADERR_AP_FETCH_NOAD_INCACHE=122,o.ADERR_AP_FETCH_ARGS_ERROR=123,o.ADERR_ADMODULE_INITED=140,o.ADERR_ADMODULE_INIT_NO_LISTPOSCFG=141,o.ADERR_ADMODULE_INIT_NO_ADENVCFG=142,o.ADERR_ADMODULE_FETCH_NO_ADDEPOT=151,o.ADERR_ADMODULE_LOAD_NO_ADDEPOT=161,o.ADERR_ADMODULE_PLATFORM_INTERCEPT=162,o.ADERR_ADM_EXIT_SCENE=163,o.ADERR_AP4WXBANNER_LOAD_NO_ADHANDLER=500,o.ADERR_AP4WXBANNER_LOAD_NO_API=501,o.ADERR_AP4WXVIDEO_LOAD_NO_ADHANDLER=550,o.ADERR_AP4WXVIDEO_NOT_SUPPORT=551,o.ADERR_AP4WXVIDEO_FETCH_NO_ADHANDLER=552,o}();e.MGBAdErrCode=a}(d||(d={})),function(e){var a=function(){function o(t){this.TAG="MGB_AdInterceptor",this.VALID_WXAD_SDKVERSION="2.0.4",this.mbEnableAdOutSide=!0,this.mPlatformType=t}return o.prototype.switch4Ad=function(t){(this.mbEnableAdOutSide=t)?e.Log.w(this.TAG,"MGBAdSDK will be enable, ^_^"):e.Log.w(this.TAG,"MGBAdSDK will be disable, =.=!!")},o.prototype.intercept=function(){if(!this.mbEnableAdOutSide)return e.Log.e(this.TAG,"MGBAd SDK is disable"),!0;switch(this.mPlatformType){case e.MGBAdDefs.PLATFORM_WX:return!this.isWXSDKVersionValid();case e.MGBAdDefs.PLATFORM_QQ:return!1;case e.MGBAdDefs.PLATFORM_FB:return!this.isFaceBookAdAPISupported()}return!0},o.prototype.isFaceBookAdAPISupported=function(){var t=this;if(!this.mFaceBookVideoAPI)return!0;var r=FBInstant.getSupportedAPIs();return r&&r.forEach(function(n){if(n==="getRewardedVideoAsync")return t.mFaceBookVideoAPI=n,!0}),!1},o.prototype.isWXSDKVersionValid=function(){return wx.getSystemInfoSync().SDKVersion>=this.VALID_WXAD_SDKVERSION},o}();e.MGBAdInterceptor=a}(d||(d={})),function(e){var a=function(o){function t(r){var n=o.call(this)||this;return n.setStr(t.KEY_POSID,r),n.setStr(e.MGBAdPosIdCfg.KEY_ADSELECTOR_NAME,e.MGBAdSelector4Auto.ASNAME),n}return D(t,o),t.prototype.getPosId=function(){return this.getStr(t.KEY_POSID,"")},t.prototype.getNativePosId=function(){var r=this.getStr(t.KEY_ADPROVIDER_NATIVE_POSID,"");return r&&0<r.length?r:e.PlatformProxy.getInstance().getNativePosId(this)},t.KEY_POSID=1,t.KEY_ADTYPE=2,t.KEY_ADPROVIDER_NATIVE_POSID=11,t.KEY_ADPROVIDER_NAME=12,t.KEY_ADSELECTOR_NAME=21,t.KEY_AP4WXBANNER_LOAD_WIDTH=101,t.KEY_AP4WXBANNER_POS_ADAPTER=102,t.KEY_AP4QQVIDEO_TYPE=103,t.KEY_NATIVE_POSID_WX=201,t.KEY_NATIVE_POSID_QQ=202,t.KEY_NATIVE_POSID_FB=203,t.KEY_NATIVE_POSID_OPPO=204,t}(e.Params);e.MGBAdPosIdCfg=a}(d||(d={})),function(e){var a=function(){function o(t){this.mMapId2Cfg=new Map,this.addAdPosIdCfgList(t)}return o.prototype.addAdPosIdCfgList=function(t){if(t!=null&&t.length!=0)for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i!=null){var s=i.getPosId();s!=null&&this.mMapId2Cfg.set(s,i)}}},o.prototype.getPosIdCfg=function(t){return t==null?null:this.mMapId2Cfg.has(t)?this.mMapId2Cfg.get(t):null},o}();e.MGBAdPosIdCfgDepot=a}(d||(d={})),function(e){var a=function(){function o(){this.mMapId2Time=new Map}return o.prototype.MGBAdShowRecord=function(){},o.getInstance=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype.isShowAdTooMuch=function(t){if(!t)return!1;var r,n=Date.now();return r=n-this.getAdPosLastShowTime(t)<2e3,this.saveAdPosLastShowTime(t,n),r&&e.Log.i("MGB_DEBUG","["+t+"], show ad too much."),r},o.prototype.getAdPosLastShowTime=function(t){return this.mMapId2Time.has(t)?this.mMapId2Time.get(t):0},o.prototype.saveAdPosLastShowTime=function(t,r){this.mMapId2Time&&this.mMapId2Time.set(t,r)},o.sInst=null,o}();e.MGBAdShowRecord=a}(d||(d={})),function(e){var a=function(o){function t(){return o!==null&&o.apply(this,arguments)||this}return D(t,o),t}(e.Params);e.ParamAdFetch=a}(d||(d={})),function(e){var a=function(o){function t(){return o!==null&&o.apply(this,arguments)||this}return D(t,o),t}(e.Params);e.ParamAdLoad=a}(d||(d={})),function(e){var a=function(){function o(t){this.mAd=null,this.mAdErrCode=e.MGBAdErrCode.ADERR_UNKNOWN,this.mAdErrCode=t}return o.prototype.fillAd=function(t){return this.mAd=t,this},o.prototype.getAd=function(){return this.mAd},o}();e.ResultFetchAd=a}(d||(d={})),function(e){var a=function(){function o(){}return o.getPlatformType=function(){return e.GameEngineProxy.getPlatformType()},o.isPlatformWX=function(){return e.GameEngineProxy.isPlatformWX()},o.isPlatformQQ=function(){return e.GameEngineProxy.isPlatformQQ()},o.isPlatformWeb=function(){return e.GameEngineProxy.isPlatformWeb()},o.isPlatformFB=function(){return e.GameEngineProxy.isPlatformFB()},o}();e.PlatformChecker=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_PlatformImpl4FB"}return o.prototype.getLaunchParameter=function(){var t=new e.LaunchOption;return FBInstant.getEntryPointData()||e.Log.w(this.TAG,"no launch options associated with current entry point"),t},o.prototype.request=function(t,r){var n=this;e.Log.i(this.TAG,"facebook reqeust params: "+JSON.stringify(t));var i=new XMLHttpRequest;for(var s in i.open(t.method,t.url),t.header)i.setRequestHeader(s,t.header[s]);i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE)if(e.Log.i(n.TAG,"facebook request, response code:",i.status),e.Log.i(n.TAG,"facebook request, response:",i.response),i.status==200){if(e.Log.i(n.TAG,"facebook request, succeed:",i.responseText),t.success){var c=i.status,A=i.getAllResponseHeaders();if(t.dataType=="json")try{t.success(c,JSON.parse(i.responseText),A)}catch(C){t.success(c,i.responseText,A)}else t.success(c,i.responseText,A)}}else e.Log.i(n.TAG,"facebook request, failed:",i.responseText),1<r?n.request(t,r-1):t.fail&&t.fail(i.status,i.responseText)},i.send(JSON.stringify(t.data))},o.prototype.getPlatformInfo=function(){var t=new e.PlatformInfo;t.language=FBInstant.getLocale(),t.platform=FBInstant.getPlatform(),t.SDKVersion=FBInstant.getSDKVersion();try{t.screenWidth=window.screen.width,t.screenHeight=window.screen.height}catch(r){e.Log.w(this.TAG,"exception occur while collecting platform info")}return t},o.prototype.setStorage=function(t,r){this.isLocalStorageAvailable()?window.localStorage.setItem(t,r):this.isSessionAvailable()?window.sessionStorage.setItem(t,r):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.getStorage=function(t){return this.isLocalStorageAvailable()?window.localStorage.getItem(t):this.isSessionAvailable()?window.sessionStorage.getItem(t):void e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.delStorage=function(t){this.isLocalStorageAvailable()?window.localStorage.removeItem(t):this.isSessionAvailable()?window.sessionStorage.removeItem(t):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.isSessionAvailable=function(){return!!window.sessionStorage},o.prototype.isLocalStorageAvailable=function(){return!!window.localStorage},o.prototype.skipGame=function(t,r){return!1},o.prototype.getNativePosId=function(t){return t?t.getStr(e.MGBAdPosIdCfg.KEY_NATIVE_POSID_FB,""):""},o}();e.PlatformImpl4FB=a}(d||(d={})),function(e){var a=function(){function o(){this.mbEnteredBackground=!1,this.init()}return o.prototype.init=function(){var t=function(){function r(n){this.TAG="MGB_PlatformImpl4QQ",this.platformImpl=null,this.platformImpl=n}return r.prototype.onLoad=function(n){},r.prototype.onMaximize=function(n){},r.prototype.onMinimize=function(n){},r.prototype.onEnterBackground=function(n){this.platformImpl.mbEnteredBackground=!0},r.prototype.onEnterForeground=function(n){this.platformImpl.mbEnteredBackground=!1},r.prototype.onClose=function(n){},r}();new BK.Game(new t(this))},o.prototype.getLaunchParameter=function(){var t=new e.LaunchOption;if(this.mbEnteredBackground)return t;var r=GameStatusInfo.gameParam;if(r){for(var n={},i=(r[0]==="?"?r.substr(1):r).split("&"),s=0;s<i.length;s++){var c=i[s].split("=");n[decodeURIComponent(c[0])]=decodeURIComponent(c[1]||"")}t.query=n}return t.shareTicket=GameStatusInfo.aioType.toString(),t},o.prototype.request=function(t,r){var n=this,i=t.method?t.method:"POST",s=new BK.HttpUtil(t.url);if(s.setHttpReferer("sqimg.qq.com"),s.setHttpMethod(i),t.header)for(var c in t.header)s.setHttpHeader(c,t.header[c]);if(t.data){var A=new BK.Buffer(0,!1);A.writeAsString(JSON.stringify(t.data),!1),s.setHttpRawBody(A)}s.requestAsync(function(C,p){var g=C.readAsString(!1);if(p==200){if(t.success)if(t.dataType=="json")try{t.success(p,JSON.parse(g),null)}catch(M){e.Log.e(o.TAG,"success 2. rsp:"+g),t.success(p,g,null)}else t.success(p,g,null)}else if(e.Log.e(o.TAG,"code("+p+") != 200"),0<r)n.request(t,r-1);else if(t.fail)if(t.dataType=="json")try{t.fail(p,JSON.parse(g))}catch(M){t.fail(p,g)}else t.fail(p,g)})},o.prototype.getPlatformInfo=function(){var t=new e.PlatformInfo;return t.version=GameStatusInfo.QQVer,t.system=GameStatusInfo.platform+" "+GameStatusInfo.osVersion,t.screenWidth=BK.Director.screenPixelSize.width,t.screenHeight=BK.Director.screenPixelSize.height,t.platform=GameStatusInfo.platform,t},o.prototype.setStorage=function(t,r){e.GameEngineProxy.setLocalItem(t,r)},o.prototype.getStorage=function(t){return e.GameEngineProxy.getLocalItem(t)},o.prototype.delStorage=function(t){e.GameEngineProxy.removeLocalItem(t)},o.prototype.skipGame=function(t,r,n){if(!BK.QQ.skipGame)return e.Log.i(o.TAG,"BK.QQ.skipGame undefined."),n&&n.fail&&n.fail(null),!1;var i=MGRPT.MGCroProTag.KEY_CROSS_PROMOTION_TAG,s=MGRPT.MGCmnRptModule.getCroProTag().fetch(),c=MGRPT.MGCmnRptModule.getInfocEnvCfg(),A={};return A[i]=s,A.cm_game_id=c.game_id,BK.QQ.skipGame(r.gameidQQ,JSON.stringify(A)),e.Log.i(o.TAG,"after call BK.QQ.skipGame. gameid_qq:"+r.gameidQQ),n&&n.success&&n.success(null),!0},o.getDataPath=function(){BK.FileUtil.isFileExist(o.DATA_DIR)||BK.FileUtil.makeDir(o.DATA_DIR);var t=o.DATA_DIR+GameStatusInfo.openId+"/";return BK.FileUtil.isFileExist(t)||BK.FileUtil.makeDir(t),t},o.prototype.getNativePosId=function(t){return t?t.getStr(e.MGBAdPosIdCfg.KEY_NATIVE_POSID_QQ,""):""},o.TAG="MGB_PlatformImpl4QQ",o.DATA_DIR="GameSandBox://data4ad/",o}();e.PlatformImpl4QQ=a}(d||(d={})),function(e){var a=function(){function o(){}return o.prototype.getLaunchParameter=function(){return wx.getLaunchOptionsSync()},o.prototype.login=function(t){wx.login({success:function(r){e.Log.i(o.TAG,"WX login success. # code:"+r.code)},fail:function(r){e.Log.i(o.TAG,"WX login failed. # code:"+r.code+", errmsg:"+r.errMsg)}})},o.prototype.getUserSetting=function(t){wx.getSetting({success:function(r){t.success&&t.success(r.authSetting)},fail:function(){t.fail&&t.fail()}})},o.prototype.request=function(t,r){var n=this;wx.request({url:t.url,data:t.data,header:t.header,method:t.method,dataType:t.dataType,success:function(i){i.statusCode!=200?t.fail&&t.fail(i.statusCode,i):i.data?t.success&&t.success(i.statusCode,i.data,i.header):t.fail&&t.fail(i.statusCode,i)},fail:function(){1<r?n.request(t,r-1):t.fail&&t.fail(-1,null)}})},o.prototype.getPlatformInfo=function(){return wx.getSystemInfoSync()},o.prototype.setStorage=function(t,r){wx.setStorageSync(t,r)},o.prototype.getStorage=function(t){return wx.getStorageSync(t)},o.prototype.delStorage=function(t){wx.removeStorageSync(t)},o.prototype.skipGame=function(t,r,n){if(!wx||!wx.navigateToMiniProgram)return e.Log.i(o.TAG,"wx.navigateToMiniProgram undefined."),!1;var i=MGRPT.MGCroProTag.KEY_CROSS_PROMOTION_TAG,s=MGRPT.MGCmnRptModule.getCroProTag().fetch(),c=MGRPT.MGCmnRptModule.getInfocEnvCfg(),A={};A[i]=s,A.cm_game_id=c.game_id;var C={appId:r.getGameId(),extraData:A,success:function(p){e.Log.i(o.TAG,"navigateToMiniProgram success(). res:"+JSON.stringify(p)),n&&n.success&&n.success(p)},fail:function(p){e.Log.i(o.TAG,"navigateToMiniProgram fail(). res:"+JSON.stringify(p)),n&&n.fail&&n.fail(p)},complete:function(p){e.Log.i(o.TAG,"navigateToMiniProgram complete(). res:"+JSON.stringify(p))}};return wx.navigateToMiniProgram(C),!0},o.prototype.getNativePosId=function(t){return t?t.getStr(e.MGBAdPosIdCfg.KEY_NATIVE_POSID_WX,""):""},o.TAG="MGB_PlatformImpl4WX",o}();e.PlatformImpl4WX=a}(d||(d={})),function(e){var a=function(){function o(){this.TAG="MGB_PlatformImpl4Web"}return o.prototype.getLaunchParameter=function(){return new e.LaunchOption},o.prototype.request=function(t,r){var n=this;e.Log.i(this.TAG,"reqeust params: "+t);var i=new XMLHttpRequest;for(var s in i.open(t.method,t.url),t.header)i.setRequestHeader(s,t.header[s]);i.onreadystatechange=function(){if(i.readyState==4)if(i.status==200){if(e.Log.i(n.TAG,"request, succeed:",i.responseText),t.success){var c=i.status,A=i.getAllResponseHeaders();if(t.dataType=="json")try{t.success(c,JSON.parse(i.responseText),A)}catch(C){t.success(c,i.responseText,A)}else t.success(c,i.responseText,A)}}else e.Log.i(n.TAG,"request, failed:",i.responseText),1<r?n.request(t,r-1):t.fail&&t.fail(i.status,i.responseText)},i.send(JSON.stringify(t.data))},o.prototype.getPlatformInfo=function(){var t=new e.PlatformInfo;t.platform="web";try{t.system=navigator.platform,t.model=navigator.appName,t.version=navigator.appVersion,t.language=navigator.language,t.screenWidth=window.screen.width,t.screenHeight=window.screen.height}catch(r){e.Log.w(this.TAG,"exception occur while collecting platform info")}return t},o.prototype.setStorage=function(t,r){this.isLocalStorageAvailable()?window.localStorage.setItem(t,r):this.isSessionAvailable()?window.sessionStorage.setItem(t,r):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.getStorage=function(t){return this.isLocalStorageAvailable()?window.localStorage.getItem(t):this.isSessionAvailable()?window.sessionStorage.getItem(t):void e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.delStorage=function(t){this.isLocalStorageAvailable()?window.localStorage.removeItem(t):this.isSessionAvailable()?window.sessionStorage.removeItem(t):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.isSessionAvailable=function(){return!!window.sessionStorage},o.prototype.isLocalStorageAvailable=function(){return!!window.localStorage},o.prototype.skipGame=function(t,r){return!1},o.prototype.getNativePosId=function(t){return""},o}();e.PlatformImpl4Web=a}(d||(d={})),function(e){var a=function(){function o(){this.mPlatformCur=null,this.mInfocEnvCfg=null}return o.getInstance=function(){return this.sInst!=null||(this.sInst=new o),this.sInst},o.prototype.init=function(t){if(!this.mPlatformCur)switch(t){case e.MGBAdDefs.PLATFORM_WX:this.mPlatformCur=new e.PlatformImpl4WX;break;case e.MGBAdDefs.PLATFORM_QQ:this.mPlatformCur=new e.PlatformImpl4QQ;break;case e.MGBAdDefs.PLATFORM_WEB:this.mPlatformCur=new e.PlatformImpl4Web;break;case e.MGBAdDefs.PLATFORM_FB:this.mPlatformCur=new e.PlatformImpl4FB}},o.prototype.request=function(t,r){r===void 0&&(r=3),this.mPlatformCur?this.mPlatformCur.request(t,r):t&&t.fail&&t.fail(0,null)},o.prototype.getPlatformInfo=function(){return this.mPlatformCur?this.mPlatformCur.getPlatformInfo():null},o.prototype.setStorage=function(t,r){if(!this.mPlatformCur)return null;this.mPlatformCur.setStorage(t,r)},o.prototype.getStorage=function(t){return this.mPlatformCur?this.mPlatformCur.getStorage(t):null},o.prototype.delStorage=function(t){if(!this.mPlatformCur)return null;this.mPlatformCur.delStorage(t)},o.prototype.skipGame=function(t,r,n){return n===void 0&&(n=null),!!this.mPlatformCur&&this.mPlatformCur.skipGame(t,r,n)},o.prototype.getNativePosId=function(t){return this.mPlatformCur?this.mPlatformCur.getNativePosId(t):""},o.sInst=null,o}();e.PlatformProxy=a}(d||(d={})),function(e){var a=function(t,r){this.key=null,this.value=null,this.key=t,this.value=r};e.Pair=a;var o=function(){function t(){this.arr=[]}return t.prototype.put=function(r,n){for(var i=0;i<this.arr.length;i++)if(this.arr[i].key===r)return void(this.arr[i].value=n);this.arr.push(new a(r,n))},t.prototype.get=function(r){for(var n=0;n<this.arr.length;n++)if(this.arr[n].key===r)return this.arr[n].value;return null},t.prototype.getPair=function(r){for(var n=0;n<this.arr.length;n++)if(this.arr[n].key===r)return this.arr[n];return null},t.prototype.remove=function(r){for(var n=0;n<this.arr.length;n++)if(this.arr[n].key===r)return void this.arr.splice(n,1)},t.prototype.clear=function(){this.arr=[]},t.prototype.size=function(){return this.arr.length},t.prototype.getPairs=function(){return this.arr},t}();e.Dictionary=o}(d||(d={})),function(e){var a=function(){function o(){}return o.i=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(r)):console.info(o.getPrefix(),t,r))},o.w=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(r)):console.warn(o.getPrefix(),t,r))},o.e=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(r)):console.error(o.getPrefix(),t,r))},o.f=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(r)):console.error(o.getPrefix(),t,r))},o.formatDateTime=function(){var t=new Date,r=t.getHours().toString(),n=t.getMinutes().toString(),i=t.getSeconds().toString(),s=t.getMilliseconds().toString();if(n.length<2&&(n="0"+n),i.length<2&&(i="0"+i),s.length<3)for(var c=0;c<3-s.length;c++)s="0"+s;return r+":"+n+":"+i+" "+s},o.getPrefix=function(){return"["+o.formatDateTime()+"] "},o.GetOptionalMsg=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n="";for(var i in t)n+=" "+t[i];return n},o.enableLog=function(t){o.sEnable=t},o.isEnableLog=function(){return o.sEnable},o.sEnable=!0,o}();e.Log=a}(d||(d={})),function(e){var a=0,o="";function t(m){return i(r(A(m)))}function r(m){return p(g(C(m),8*m.length))}function n(m,u){var l=C(m);16<l.length&&(l=g(l,8*m.length));for(var h=Array(16),f=Array(16),_=0;_<16;_++)h[_]=909522486^l[_],f[_]=1549556828^l[_];var E=g(h.concat(C(u)),512+8*u.length);return p(g(f.concat(E),672))}function i(m){for(var u,l=a?"0123456789ABCDEF":"0123456789abcdef",h="",f=0;f<m.length;f++)u=m.charCodeAt(f),h+=l.charAt(u>>>4&15)+l.charAt(15&u);return h}function s(m){for(var u="",l=m.length,h=0;h<l;h+=3)for(var f=m.charCodeAt(h)<<16|(h+1<l?m.charCodeAt(h+1)<<8:0)|(h+2<l?m.charCodeAt(h+2):0),_=0;_<4;_++)8*h+6*_>8*m.length?u+=o:u+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(f>>>6*(3-_)&63);return u}function c(m,u){var l,h,f,_,E=u.length,I=Array(),P=Array(Math.ceil(m.length/2));for(l=0;l<P.length;l++)P[l]=m.charCodeAt(2*l)<<8|m.charCodeAt(2*l+1);for(;0<P.length;){for(_=Array(),l=f=0;l<P.length;l++)f=(f<<16)+P[l],f-=(h=Math.floor(f/E))*E,(0<_.length||0<h)&&(_[_.length]=h);I[I.length]=f,P=_}var T="";for(l=I.length-1;0<=l;l--)T+=u.charAt(I[l]);var B=Math.ceil(8*m.length/(Math.log(u.length)/Math.log(2)));for(l=T.length;l<B;l++)T=u[0]+T;return T}function A(m){for(var u,l,h="",f=-1;++f<m.length;)u=m.charCodeAt(f),l=f+1<m.length?m.charCodeAt(f+1):0,55296<=u&&u<=56319&&56320<=l&&l<=57343&&(u=65536+((1023&u)<<10)+(1023&l),f++),u<=127?h+=String.fromCharCode(u):u<=2047?h+=String.fromCharCode(192|u>>>6&31,128|63&u):u<=65535?h+=String.fromCharCode(224|u>>>12&15,128|u>>>6&63,128|63&u):u<=2097151&&(h+=String.fromCharCode(240|u>>>18&7,128|u>>>12&63,128|u>>>6&63,128|63&u));return h}function C(m){for(var u=Array(m.length>>2),l=0;l<u.length;l++)u[l]=0;for(l=0;l<8*m.length;l+=8)u[l>>5]|=(255&m.charCodeAt(l/8))<<24-l%32;return u}function p(m){for(var u="",l=0;l<32*m.length;l+=8)u+=String.fromCharCode(m[l>>5]>>>24-l%32&255);return u}function g(m,u){m[u>>5]|=128<<24-u%32,m[15+(u+64>>9<<4)]=u;for(var l,h=Array(80),f=1732584193,_=-271733879,E=-1732584194,I=271733878,P=-1009589776,T=0;T<m.length;T+=16){for(var B=f,O=_,y=E,N=I,L=P,R=0;R<80;R++){h[R]=R<16?m[T+R]:S(h[R-3]^h[R-8]^h[R-14]^h[R-16],1);var v=G(G(S(f,5),M(R,_,E,I)),G(G(P,h[R]),(l=R)<20?1518500249:l<40?1859775393:l<60?-1894007588:-899497514));P=I,I=E,E=S(_,30),_=f,f=v}f=G(f,B),_=G(_,O),E=G(E,y),I=G(I,N),P=G(P,L)}return Array(f,_,E,I,P)}function M(m,u,l,h){return m<20?u&l|~u&h:m<40?u^l^h:m<60?u&l|u&h|l&h:u^l^h}function G(m,u){var l=(65535&m)+(65535&u);return(m>>16)+(u>>16)+(l>>16)<<16|65535&l}function S(m,u){return m<<u|m>>>32-u}e.hex_sha1=t,e.b64_sha1=function(m){return s(r(A(m)))},e.any_sha1=function(m,u){return c(r(A(m)),u)},e.hex_hmac_sha1=function(m,u){return i(n(A(m),A(u)))},e.b64_hmac_sha1=function(m,u){return s(n(A(m),A(u)))},e.any_hmac_sha1=function(m,u,l){return c(n(A(m),A(u)),l)}}(d||(d={})),function(e){var a=function(){function o(){}return o.formatDate=function(t){var r=t.getFullYear(),n=t.getMonth()+1,i=n<10?"0"+n:n+"",s=t.getDate();return r+"-"+i+"-"+(s<10?"0"+s:s+"")},o}();e.TimeUtil=a}(d||(d={}));
