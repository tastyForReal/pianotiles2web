(()=>{(function(){(function(){(function(){(function(){var y=function(M,a){return function(){return a||M((a={exports:{}}).exports,a),a.exports}},N=y(function(M){var a,D=M&&M.__extends||function(){var e=function(s,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(s,o)};return function(s,o){function t(){this.constructor=s}e(s,o),s.prototype=o===null?Object.create(o):(t.prototype=o.prototype,new t)}}();(function(e){var s=function(){function o(){}return o.VERSION="1.0.0.3",o.PLATFORM_WX="wechat",o.PLATFORM_QQ="qq",o.PLATFORM_WEB="web",o.PLATFORM_FB="facebook",o.GETYPE_CC="cocos-creator",o.GETYPE_LAYABOX="layabox",o.APTYPE_UNKNOWN=0,o.APTYPE_WX_REWARDVIDEO=1,o.APTYPE_QQ_REWARDVIDEO=1,o.APTYPE_FB_REWARDVIDEO=1,o.APTYPE_WX_BANNER=2,o.APTYPE_QQ_BANNER=2,o.APTYPE_FB_INTERSTITIAL=4,o.APTYPE_RCMD_UNKNOWN=5,o.APTYPE_RCMD_GIFTBOX=5,o.APTYPE_RCMD_SCOREWALL=5,o.ADTYPE_UNKNOWN=0,o.ADTYPE_WX_REWARDVIDEO=1,o.ADTYPE_QQ_REWARDVIDEO=1,o.ADTYPE_FB_REWARDVIDEO=1,o.ADTYPE_WX_BANNER=2,o.ADTYPE_QQ_BANNER=2,o.ADTYPE_FB_INTERSTITIAL=4,o.ADTYPE_RCMD_UNKNOWN=5,o.ADTYPE_RCMD_GIFTBOX=5,o.ADTYPE_RCMD_SCOREWALL=5,o.ADSOURCE_UNKNOWN=0,o}();e.MGBAdDefs=s})(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_AdModule",this.mPlatFormType=e.MGBAdDefs.PLATFORM_WX,this.mAdEnvCfg=null,this.mDepotPosIdCfg=null,this.mbInited=!1,this.mMapPosId2AdDepot=new Map,this.mAdInterceptor=null,this.mMapExitFlag=new Map}return o.getInstance=function(){return this.sInst!=null||(this.sInst=new o),this.sInst},o.prototype.init=function(t,n){return this.mbInited?e.MGBAdErrCode.ADERR_ADMODULE_INITED:t==null?e.MGBAdErrCode.ADERR_ADMODULE_INIT_NO_ADENVCFG:n==null?e.MGBAdErrCode.ADERR_ADMODULE_INIT_NO_LISTPOSCFG:(this.mPlatFormType=t.getPlatformType(),this.mAdInterceptor=new e.MGBAdInterceptor(this.mPlatFormType),this.mAdEnvCfg=t,this.mDepotPosIdCfg=new e.MGBAdPosIdCfgDepot(n),this.mbInited=!0,this.registerCreators(),e.MGBAdErrCode.ADERR_SUCCESS)},o.prototype.registerCreators=function(){var t=this;this.mAdInterceptor&&!this.mAdInterceptor.intercept()?(this.regASCreator(e.MGBAdSelector4Auto.ASNAME,{createNewAdSelector:function(n){return new e.MGBAdSelector4Auto(t.mPlatFormType,n)}}),this.regAPCreator(e.MGBAdProvider4WXBanner.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4WXBanner}}),this.regAPCreator(e.MGBAdProvider4WXRewardVideo.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4WXRewardVideo}}),this.regAPCreator(e.MGBAdProvider4QQBanner.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4QQBanner}}),this.regAPCreator(e.MGBAdProvider4QQRewardVideo.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4QQRewardVideo}}),this.regAPCreator(e.MGBAdProvider4FBRewardVideo.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4FBRewardVideo}}),this.regAPCreator(e.MGBAdProvider4FBInterstitial.APNAME,{createNewAdProvider:function(){return new e.MGBAdProvider4FBInterstitial}})):e.Log.w(this.TAG,"can't execute action: registerCreators()")},o.prototype.getAdEnvCfg=function(){return this.mAdEnvCfg},o.prototype.getPosIdCfg=function(t){return t==null||this.mDepotPosIdCfg==null?null:this.mDepotPosIdCfg.getPosIdCfg(t)},o.prototype.fetchAd=function(t,n,r){if(!this.mAdInterceptor||this.mAdInterceptor.intercept())return e.Log.e(this.TAG,"intercept ad fetch request because of unsupported platform"),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_ADMODULE_PLATFORM_INTERCEPT);if(this.hasSceneExitFlag(t))return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE);var i=this.getAdDepot(t);return i==null?new e.ResultFetchAd(e.MGBAdErrCode.ADERR_ADMODULE_FETCH_NO_ADDEPOT):i.doFetch(n,r)},o.prototype.loadAd=function(t,n,r){if(!this.mAdInterceptor||this.mAdInterceptor.intercept())return e.Log.e(this.TAG,"intercept ad load request because of unsupported platform"),e.MGBAdErrCode.ADERR_ADMODULE_PLATFORM_INTERCEPT;var i=this.getAdDepot(t);if(i==null)return e.MGBAdErrCode.ADERR_ADMODULE_LOAD_NO_ADDEPOT;var d=i.doLoad(n,r);return d!=e.MGBAdErrCode.ADERR_SUCCESS&&MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_NOT_TO_LOAD,d,e.MGBAdDefs.ADTYPE_UNKNOWN),d},o.prototype.regAPCreator=function(t,n){this.mAdInterceptor.intercept()?e.Log.w(this.TAG,"can't execute action: regAPCreator()"):e.MGBAdCompFactory.getInstance().regAPCreator(t,n)},o.prototype.regASCreator=function(t,n){this.mAdInterceptor.intercept()?e.Log.w(this.TAG,"can't execute action: regASCreator()"):e.MGBAdCompFactory.getInstance().regASCreator(t,n)},o.prototype.getAdDepot=function(t){if(this.mAdInterceptor.intercept()||!this.mbInited||t==null||this.mMapPosId2AdDepot==null)return null;var n=null;if(this.mMapPosId2AdDepot.has(t))n=this.mMapPosId2AdDepot.get(t);else{var r=this.getPosIdCfg(t);if(r==null)return null;n=new e.MGBAdDepot(r),this.mMapPosId2AdDepot.set(t,n)}return n},o.prototype.getCacheSize=function(t){if(!this.mAdInterceptor||this.mAdInterceptor.intercept())return e.Log.w(this.TAG,"can't execute action: getCacheSize()"),0;var n=this.getAdDepot(t);return n==null?0:n.getCacheSize()},o.prototype.destroyLastAd=function(t){if(this.mAdInterceptor&&!this.mAdInterceptor.intercept()){if(t!=null){var n=this.getAdDepot(t);n!=null&&n.destoryLastAd()}}else e.Log.w(this.TAG,"can't execute action: destroyLastAd()")},o.prototype.enterScene=function(t){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?this.mMapExitFlag!=null&&t&&t.length!=0&&this.mMapExitFlag.set(t,!1):e.Log.w(this.TAG,"can't execute action: enterScene()")},o.prototype.exitScene=function(t,n){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?this.mMapExitFlag!=null&&t&&t.length!=0&&(this.mMapExitFlag.set(t,!0),n&&this.destroyLastAd(t)):e.Log.w(this.TAG,"can't execute action: exitScene()")},o.prototype.hasSceneExitFlag=function(t){if(this.mAdInterceptor&&!this.mAdInterceptor.intercept())return!(this.mMapExitFlag==null||!t||t.length==0)&&!!this.mMapExitFlag.has(t)&&this.mMapExitFlag.get(t);e.Log.w(this.TAG,"can't execute action: hasSceneExitFlag()")},o.prototype.rptCommonAd=function(t,n,r){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?t&&MGRPT.minigame_common_ad.report(t,n,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType(t),r):e.Log.w(this.TAG,"can't execute action: rptCommonAd()")},o.prototype.rptCommonActive=function(t){this.mAdInterceptor&&!this.mAdInterceptor.intercept()?MGRPT.minigame_common_active.report(t):e.Log.w(this.TAG,"can't execute action: rptCommonActive()")},o.prototype.enable=function(t){this.mAdInterceptor&&this.mAdInterceptor.switch4Ad(t)},o.prototype.isDisable=function(){return!!this.mAdInterceptor&&this.mAdInterceptor.intercept()},o.prototype.isClickRVAdTooMuch=function(t){return e.MGBAdShowRecord.getInstance().isShowAdTooMuch(t)},o.prototype.showAd=function(t,n){if(this.mAdInterceptor&&!this.mAdInterceptor.intercept()){if(!this.isClickRVAdTooMuch(t))if(MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_SHOW_BEGIN,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType(t)),0<this.getCacheSize(t))this.fetchAndShow(t,n);else{var r=this.fetchAndShow.bind(this);this.loadAd(t,new e.ParamAdLoad,{onSuccess:function(){r&&r(t,n)},onFailed:function(i,d,c){}})}}else e.Log.w(this.TAG,"can't execute action: showAd()")},o.prototype.getAdType=function(t){var n=this.getAdDepot(t);return n||e.MGBAdDefs.ADTYPE_UNKNOWN,n.getAdType()},o.prototype.fetchAndShow=function(t,n){var r=this.fetchAd(t,new e.ParamAdFetch,null);if(r.mAdErrCode==e.MGBAdErrCode.ADERR_SUCCESS){var i=r.getAd();if(i)return i.show(n)}else n&&n.onShowFail(null,null,null)},o.sInst=null,o}();e.MGBAdModule=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_MGBAdProvider4FBInterstitial",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,n,r,i){var d,c=this;return n==null?(e.Log.e(this.TAG,"facebook interstitial ad require Placement ID"),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID):t==null?e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG:(e.Log.i(this.TAG,"facebook interstitial start doLoad, posId = "+t.getPosId()),FBInstant.getInterstitialAdAsync(n).then(function(A){return d=A,MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),d.loadAsync()}).then(function(){e.Log.i(c.TAG,"Preload FB interstitial successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var A=new e.MGBAd4FBInterstitial(d,t);c.mAdCache.pushBack(A),e.Log.i(c.TAG,"Current facebook interstitial ad cache size: "+c.mAdCache.getSize()),i&&i.onSuccess()}).catch(function(A){e.Log.e(c.TAG,"FB interstitial failed to preload, posId = "+t.getPosId()+"; errInfo = "+A.code+", "+A.message),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),i&&i.onFailed(e.MGBAdErrCode.ADERR_UNKNOWN,A.code,A.message)}),e.MGBAdErrCode.ADERR_LOADING)},o.prototype.doFetch=function(t,n,r,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(!n)return e.Log.e(this.TAG,"facebook interstitial ad require Placement ID"),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var d=this.mAdCache.popFront();return this.isNeedLoadMore()&&this.doLoad(t,n,new e.ParamAdLoad,null),d==null?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE)):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(d))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="fb_interstitial",o}();e.MGBAdProvider4FBInterstitial=s}((window.MGB=a)||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_MGBAdProvider4FBRewardVideo",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,n,r,i){var d,c=this;return n==null?(e.Log.e(this.TAG,"facebook video ad require Placement ID"),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID):t==null?e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG:(e.Log.i(this.TAG,"facebook video start doLoad, posId = "+t.getPosId()),FBInstant.getRewardedVideoAsync(n).then(function(A){return d=A,MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),d.loadAsync()}).then(function(){e.Log.i(c.TAG,"Preload FB video successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var A=new e.MGBAd4FBRewardVideo(d,t);c.mAdCache.pushBack(A),e.Log.i(c.TAG,"Current facebook video ad cache size: "+c.mAdCache.getSize()),i&&i.onSuccess()}).catch(function(A){e.Log.e(c.TAG,"FB video failed to preload, posId = "+t.getPosId()+"; errInfo = "+A.code+", "+A.message),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),i&&i.onFailed(e.MGBAdErrCode.ADERR_UNKNOWN,A.code,A.message)}),e.MGBAdErrCode.ADERR_LOADING)},o.prototype.doFetch=function(t,n,r,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(!n)return e.Log.e(this.TAG,"facebook video ad require Placement ID"),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var d=this.mAdCache.popFront();return this.isNeedLoadMore()&&this.doLoad(t,n,new e.ParamAdLoad,null),d==null?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE)):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(d))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="fb_video",o}();e.MGBAdProvider4FBRewardVideo=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_AdProvider4QQBanner",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,n,r,i){var d=this;return t==null?e.MGBAdErrCode.ADERR_AP_LOAD_ARGS_ERROR:(e.Log.i(this.TAG,"start doLoad, posId = "+t.getPosId()),n==null&&e.Log.i(this.TAG,"QQ banner doesn't require native posid"),t==null?e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG:(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),BK.Advertisement.fetchBannerAd(function(c,A,C){if(e.Log.i(d.TAG,"BK Ad fetchBannerAd callback",c),c==0){e.Log.i(d.TAG,"load QQ banner successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,d.getAdType());var p=new e.MGBAd4QQBanner(C,t);d.mAdCache.pushBack(p),i&&i.onSuccess()}else e.Log.e(d.TAG,"load QQ banner failed, posId = "+t.getPosId()+"; errInfo = "+A),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,A,d.getAdType()),i&&i.onFailed(c,A,null)}),e.MGBAdErrCode.ADERR_LOADING))},o.prototype.doFetch=function(t,n,r,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var d=this.mAdCache.popFront();return d==null?new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(d))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_QQ_BANNER},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="qq_banner",o}();e.MGBAdProvider4QQBanner=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_AdProvider4QQVideo",this.mAdCache=new e.MGBAdCache}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,n,r,i){if(t==null)return e.MGBAdErrCode.ADERR_AP_LOAD_ARGS_ERROR;if(n==null&&e.Log.i(this.TAG,"QQ video doesn't require native posid"),t==null)return e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG;var d=t.getNum(e.MGBAdPosIdCfg.KEY_AP4QQVIDEO_TYPE,-1);return d==-1?(e.Log.e(this.TAG,"MGBAdProvider4QQRewardVideo video type is -1, posId = "+t.getPosId()),e.MGBAdErrCode.ADERR_AP_LOAD_ARGS_ERROR):(e.Log.i(this.TAG,"MGBAdProvider4QQRewardVideo start doLoad, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),BK.Advertisement.fetchVideoAd(d,function(c,A,C){if(e.Log.i(this.TAG,"BK Ad fetchVideoAd callback",c),c==0){e.Log.i(this.TAG,"load QQ video successfully, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var p=new e.MGBAd4QQRewardVideo(C,t);this.mAdCache.pushBack(p),i&&i.onSuccess()}else e.Log.e(this.TAG,"load QQ video failed, posId = "+t.getPosId()+"; errInfo = "+A),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),i&&i.onFailed(c,A,null)}.bind(this)),e.MGBAdErrCode.ADERR_LOADING)},o.prototype.doFetch=function(t,n,r,i){if(t==null||t.getNum(e.MGBAdPosIdCfg.KEY_AP4QQVIDEO_TYPE,-1)==-1)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var d=this.mAdCache.popFront();return this.isNeedLoadMore()&&this.doLoad(t,n,new e.ParamAdLoad,null),d==null?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE)):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(d))},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache?this.mAdCache.getSize():0},o.prototype.isNeedLoadMore=function(){return this.getCacheSize()<1},o.APNAME="qq_video",o}();e.MGBAdProvider4QQRewardVideo=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_AdProvider4WXBanner",this.mAdCache=new e.MGBAdCache,e.WXBannerAdMonitor.getInstance().init()}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.doLoad=function(t,n,r,i){var d=this;if(t==null)return e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG;if(e.Log.i(this.TAG,"start doLoad, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),n==null)return e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID;if(!wx.createBannerAd)return e.MGBAdErrCode.ADERR_AP4WXBANNER_LOAD_NO_API;var c=t.getNum(e.MGBAdPosIdCfg.KEY_AP4WXBANNER_LOAD_WIDTH,300),A=wx.createBannerAd({adUnitId:n,style:{left:0,width:c,height:0,top:0}});if(A==null)return e.MGBAdErrCode.ADERR_AP4WXBANNER_LOAD_NO_ADHANDLER;var C=this.getWXBAdPosAdapter(t),p=new e.MGBAd4WXBanner(t,A);return A.onResize(function(g){e.Log.i(d.TAG,"enter wxadHandler.onResize, posId = "+t.getPosId()),g!=null?C!=null?C.onReSize(g.width,g.height,p):e.Log.e(d.TAG,"wxadHandler.onResize  posAdapter != null, posId = "+t.getPosId()):e.Log.e(d.TAG,"wxadHandler.onResize  res == null, posId = "+t.getPosId())}),A.onLoad(function(){d.mAdCache.pushBack(p),e.Log.i(d.TAG,"after wxadHandler.onLoad, cache size:"+d.mAdCache.getSize()+"; posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,d.getAdType()),i!=null&&i.onSuccess()}),A.onError(function(g){i!=null&&(e.Log.e(d.TAG,"after wxadHandler.onError err"+JSON.stringify(g)+", posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,JSON.stringify(g),d.getAdType()),i.onFailed(e.MGBAdErrCode.ADERR_AP_LOAD_WXBH_ONERROR,g,null))}),e.MGBAdErrCode.ADERR_SUCCESS},o.prototype.doFetch=function(t,n,r,i){if(t==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_ARGS_ERROR);if(n==null)return e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);if(e.Log.i(this.TAG,"start doFetch, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),this.mAdCache==null||this.mAdCache.getSize()==0)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var d=this.mAdCache.popFront();return d==null?new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE):(e.Log.i(this.TAG,"doFetch success, posId = "+t.getPosId()),MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(d))},o.prototype.getWXBAdPosAdapter=function(t){return t==null?null:t.getObject(e.MGBAdPosIdCfg.KEY_AP4WXBANNER_POS_ADAPTER,null)},o.prototype.getAdCache=function(){return this.mAdCache},o.prototype.getCacheSize=function(){return this.mAdCache==null?0:this.mAdCache.getSize()},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_WX_BANNER},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="wx_banner",o}();e.MGBAdProvider4WXBanner=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_AdProvider4WXRewardVideo"}return o.prototype.getAPName=function(){return o.APNAME},o.prototype.getAdType=function(){return e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO},o.prototype.doLoad=function(t,n,r,i){var d=this;return t?n?(MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),e.WXRewardVideoProxy.getInstance().load(t,n,{onSuccess:function(){MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,d.getAdType()),i&&i.onSuccess()},onFailed:function(c,A,C){MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_LOAD_FAILED,c,d.getAdType()),i&&i.onFailed(c,A,C)}}),e.MGBAdErrCode.ADERR_SUCCESS):(e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),e.MGBAdErrCode.ADERR_AP_LOAD_NO_NATIVEPOSID):e.MGBAdErrCode.ADERR_AP_LOAD_NO_POSIDCFG},o.prototype.doFetch=function(t,n,r,i){if(!t)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_POSIDCFG);if(!n)return e.Log.e(this.TAG,"nativePosId is null, posId = "+t.getPosId()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NO_NATIVEPOSID);MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_START,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType());var d=e.WXRewardVideoProxy.getInstance().fetch(t,n);if(!d)return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_FAILED,e.MGBAdErrCode.ADERR_AP4WXVIDEO_FETCH_NO_ADHANDLER,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AP_FETCH_NOAD_INCACHE);var c=new e.MGBAd4WXRewardVideo(t,d);return MGRPT.minigame_common_ad.report(t.getPosId(),e.MGBAdAction.ACTION_AP_FETCH_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,this.getAdType()),new e.ResultFetchAd(e.MGBAdErrCode.ADERR_SUCCESS).fillAd(c)},o.prototype.getAdCache=function(){return null},o.prototype.getCacheSize=function(){return e.WXRewardVideoProxy.getInstance().hasCache()?1:0},o.prototype.isNeedLoadMore=function(){return!1},o.APNAME="wx_video",o}();e.MGBAdProvider4WXRewardVideo=s}(a||(a={})),function(e){var s=function(){function o(){}return o.prototype.onReSize=function(t,n,r){if(r!=null){var i=wx.getSystemInfoSync();if(i!=null){var d=i.screenHeight-n,c=(i.screenWidth-t)/2,A=t;parseInt((100*n/t).toString())>parseInt(28.571428571428573.toString())&&(A=300),r.setAdPos(c,d,A)}}},o}();e.DefaultWXBAdPosAdapter=s}(a||(a={})),function(e){var s=function(){function o(){this.bInit=!1,this.mClickCallback=null,this.mPosIdCur="",this._init()}return o.getInstance=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype.init=function(){this._init()},o.prototype._init=function(){this.bInit||(wx.onShow(this.onShow.bind(this)),this.bInit=!0)},o.prototype.onShow=function(t){this.mClickCallback&&this.mClickCallback.onShowFinish(null,null,null)},o.prototype.regClickCallback=function(t,n){t&&n&&(this.mPosIdCur=t,this.mClickCallback=n)},o.prototype.unregClickCallback=function(t){t&&(this.mPosIdCur==t?(this.mClickCallback=null,this.mPosIdCur=""):e.Log.e(o.TAG,"[unregClickCallback] ERROR mPosIdCur:"+this.mPosIdCur+", posId:"+t))},o.TAG="MGB_WXBannerAdMonitor",o.sInst=null,o}();e.WXBannerAdMonitor=s}(a||(a={})),function(e){var s=function(){function o(){this.mWXAdHandler=null,this.mCacheStatus=0,this.mCacheStatus=o.STATUS_CACHE_NONE}return o.getInstance=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype._init=function(t){this.mWXAdHandler||wx.createRewardedVideoAd&&(this.mWXAdHandler=wx.createRewardedVideoAd({adUnitId:t}),this.mWXAdHandler&&(this.mWXAdHandler.onLoad(this.onAdLoad.bind(this)),this.mWXAdHandler.onError(this.onAdError.bind(this))))},o.prototype.load=function(t,n,r){this._init(n),this.mWXAdHandler?this.mWXAdHandler.load().then(function(){r&&r.onSuccess()}).catch(function(i){e.Log.e(o.TAG,"mWXAdHandler.load().catch(), posId = "+t.getPosId()+", "+JSON.stringify(i)),r&&r.onFailed(e.MGBAdErrCode.ADERR_AP_LOAD_WXBH_ONERROR,JSON.stringify(i),null)}):r&&r.onFailed(e.MGBAdErrCode.ADERR_AP4WXVIDEO_LOAD_NO_ADHANDLER,0,0)},o.prototype.fetch=function(t,n){return e.Log.i("MGB_ROM","WXRewardVideoProxy.fetch enter. this.mCacheStatus:"+this.mCacheStatus),this.hasCache()?(this.mCacheStatus=o.STATUS_CACHE_NONE,this.mWXAdHandler):null},o.prototype.hasCache=function(){return this.mCacheStatus==o.STATUS_CACHE_ENOUGH},o.prototype.onAdLoad=function(){this.mCacheStatus=o.STATUS_CACHE_ENOUGH,e.Log.i(o.TAG,"WX reward video load success. mCacheStatus:"+this.mCacheStatus)},o.prototype.onAdError=function(t){MGRPT.minigame_common_ad.report("",e.MGBAdAction.ACTION_WXRV_ONADERROR,JSON.stringify(t),e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.i(o.TAG,"WX reward video error:"+t)},o.TAG="MGB_WXRewardVideoProxy",o.sInst=null,o.STATUS_CACHE_NONE=1,o.STATUS_CACHE_ENOUGH=2,o}();e.WXRewardVideoProxy=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.TAG="MGB_MGBAd4FBInterstitial",this.mPosIdCfg=null,this.mInterstitialAdInstance=null,this.mPosIdCfg=n,this.mInterstitialAdInstance=t}return o.prototype.getAPName=function(){return e.MGBAdProvider4FBInterstitial.APNAME},o.prototype.isCurValid=function(){return this.mInterstitialAdInstance!==null&&typeof this.mInterstitialAdInstance!==void 0},o.prototype.show=function(t){if(this.mInterstitialAdInstance){this.doRptAdShow();var n=this;this.mInterstitialAdInstance.showAsync().then(function(){t&&t.onShowSuccess(n,null,null),e.Log.i(n.TAG,"FB interstitial ad show successfully"),n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL),t&&t.onShowFinish(n,null,null)}).catch(function(r){e.Log.e(n.TAG,"FB interstitial ad show failed, errInfo:"+r.code+", "+r.message),n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(r),e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL),t&&t.onShowFail(n,r.code,r.message)})}else e.Log.w(this.TAG,"FB interstitial ad show failed since adInstance not initialized"),t&&t.onShowFail(this,null,null)},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_LOADING,e.MGBAdDefs.ADTYPE_FB_INTERSTITIAL)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mInterstitialAdInstance=void 0},o}();e.MGBAd4FBInterstitial=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.TAG="MGB_MGBAd4FBRewardVideo",this.mPosIdCfg=null,this.mVideoAdInstance=null,this.mPosIdCfg=n,this.mVideoAdInstance=t}return o.prototype.getAPName=function(){return e.MGBAdProvider4FBRewardVideo.APNAME},o.prototype.isCurValid=function(){return this.mVideoAdInstance!==null&&typeof this.mVideoAdInstance!==void 0},o.prototype.show=function(t){if(this.mVideoAdInstance){this.doRptAdShow();var n=this;this.mVideoAdInstance.showAsync().then(function(){e.Log.i(n.TAG,"FB Rewarded video watched successfully"),n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO),t&&t.onShowFinish(n,null,null)}).catch(function(r){e.Log.e(n.TAG,"FB Rewarded video show failed, errInfo:"+r.code+", "+r.message),n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(r),e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO),t&&t.onShowFail(n,r.code,r.message)})}else e.Log.w(this.TAG,"FB Rewarded video show failed since adInstance not initialized"),t&&t.onShowFail(this,null,null)},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_LOADING,e.MGBAdDefs.ADTYPE_FB_REWARDVIDEO)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mVideoAdInstance=void 0},o}();e.MGBAd4FBRewardVideo=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.TAG="MGB_Ad4QQBanner",this.mBannerHandler=void 0,this.mPosIdCfg=null,this.mLeft=0,this.mTop=0,this.mWidth=0,this.mHeight=0,this.mBannerHandler=t,this.mPosIdCfg=n}return o.prototype.getAPName=function(){return e.MGBAdProvider4QQBanner.APNAME},o.prototype.isCurValid=function(){return typeof this.mBannerHandler!==void 0},o.prototype.show=function(t){var n=this;e.Log.i(this.TAG,"ready to show QQ banner ad, posId = "+this.mPosIdCfg.getPosId()),this.mBannerHandler&&this.mBannerHandler.show(function(r,i,d){if(r==0){if(e.Log.i(n.TAG," QQ banner show success, posId = "+n.mPosIdCfg.getPosId()),e.MGBAdModule.getInstance().hasSceneExitFlag(n.mPosIdCfg.getPosId()))return e.Log.i(n.TAG," QQ banner need destroy now, because has exit flag, posId = "+n.mPosIdCfg.getPosId()),MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_QQ_BANNER),void n.destroy();n.doRptAdShow(),t&&t.onShowSuccess(n,r,i)}else n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_QQ_BANNER),e.Log.e(n.TAG,"QQ banner show failed, posId = "+n.mPosIdCfg.getPosId()+"; errInfo = "+i),t&&t.onShowFail(n,r,i)})},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_BANNER)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mBannerHandler&&this.mBannerHandler.close()},o}();e.MGBAd4QQBanner=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.TAG="MGBAd4QQRewardVideo",this.mPosIdCfg=null,this.mVideoAdHandler=void 0,this.mVideoAdHandler=t,this.mPosIdCfg=n}return o.prototype.getAPName=function(){return e.MGBAdProvider4QQRewardVideo.APNAME},o.prototype.isCurValid=function(){return this.mVideoAdHandler!==null&&typeof this.mVideoAdHandler!==void 0},o.prototype.show=function(t){if(this.mVideoAdHandler){var n=!1;this.mVideoAdHandler.setEventCallack(function(r,i){this.mVideoAdHandler=void 0}.bind(this),function(r,i){n=!0}.bind(this),function(r,i){this.mVideoAdHandler=void 0,n?(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO),t&&t.onShowFinish(this,r,i)):(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_NOT_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO),t&&t.onShowUnFinish(this,r,i))}.bind(this),function(r,i){this.doRptAdShow(),t&&t.onShowSuccess(this,r,i)}.bind(this)),this.mVideoAdHandler.jump()}else this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO),t&&t.onShowFail(this,null,null)},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_QQ_REWARDVIDEO)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.mVideoAdHandler&&(this.mVideoAdHandler=void 0)},o}();e.MGBAd4QQRewardVideo=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.TAG="MGB_Ad4WXBanner",this.mWXAdHandler=null,this.mPosAdapter=null,this.mLeft=0,this.mTop=0,this.mWidth=0,this.mHeight=0,this.mPosIdCfg=null,this.mWXAdHandler=n,this.mPosIdCfg=t}return o.prototype.getAPName=function(){return e.MGBAdProvider4WXBanner.APNAME},o.prototype.isCurValid=function(){return!0},o.prototype.getTop=function(){return this.mTop},o.prototype.getLeft=function(){return this.mLeft},o.prototype.getWidth=function(){return this.mWidth},o.prototype.getHeight=function(){return this.mHeight},o.prototype.doRptAdShow=function(){this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_BANNER)},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.unRegClickCallback(),this.mWXAdHandler!=null&&(this.mWXAdHandler.hide(),this.mWXAdHandler.destroy())},o.prototype.setAdPos=function(t,n,r){this.mWXAdHandler!=null&&(this.mWXAdHandler.style.top=n,this.mWXAdHandler.style.left=t,this.mWXAdHandler.style.width=r,this.mTop=n,this.mLeft=t,this.mWidth=r)},o.prototype.show=function(t){var n=this;if(this.mPosIdCfg&&this.mPosIdCfg.getPosId()){if(e.MGBAdModule.getInstance().hasSceneExitFlag(this.mPosIdCfg.getPosId()))return void MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_WX_BANNER);e.WXBannerAdMonitor.getInstance().regClickCallback(this.mPosIdCfg.getPosId(),t)}e.Log.i(this.TAG,"ready to show WX banner ad, posId = "+this.mPosIdCfg.getPosId()),this.mWXAdHandler&&this.mWXAdHandler.show().then(function(){n.doRptAdShow(),t&&t.onShowSuccess(n,n.mWXAdHandler.style.realWidth,n.mWXAdHandler.style.realHeight),e.Log.i(n.TAG," WX banner show success, posId = "+n.mPosIdCfg.getPosId())}).catch(function(r){n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(r),e.MGBAdDefs.ADTYPE_WX_BANNER),t&&t.onShowFail(n,null,null),e.Log.e(n.TAG,"WX banner show failed, posId = "+n.mPosIdCfg.getPosId()+"; errInfo = "+r)})},o.prototype.hide=function(){this.unRegClickCallback(),this.mWXAdHandler&&this.mWXAdHandler.hide()},o.prototype.unRegClickCallback=function(){this.mPosIdCfg&&this.mPosIdCfg.getPosId()&&e.WXBannerAdMonitor.getInstance().unregClickCallback(this.mPosIdCfg.getPosId())},o}();e.MGBAd4WXBanner=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.TAG="MGB_Ad4WXRewardVideo",this.mWXAdHandler=null,this.mAdShowCallback=null,this.mPosIdCfg=null,this.mCloseCallback=null,this.mWXAdHandler=n,this.mPosIdCfg=t,this.init()}return o.prototype.init=function(){this.mWXAdHandler&&(this.mCloseCallback=this.onAdClose.bind(this),this.mWXAdHandler.onClose(this.mCloseCallback))},o.prototype.unInit=function(){this.mWXAdHandler&&this.mWXAdHandler.offClose(this.mCloseCallback)},o.prototype.getAPName=function(){return e.MGBAdProvider4WXRewardVideo.APNAME},o.prototype.isCurValid=function(){return!0},o.prototype.doRptAdShow=function(){},o.prototype.doRptClick=function(){},o.prototype.doHandleShow=function(){},o.prototype.doHandleClick=function(){},o.prototype.destroy=function(){this.unInit()},o.prototype.show=function(t){var n=this;this.mPosIdCfg&&this.mPosIdCfg.getPosId()&&e.MGBAdModule.getInstance().hasSceneExitFlag(this.mPosIdCfg.getPosId())?MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,e.MGBAdErrCode.ADERR_ADM_EXIT_SCENE,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO):(this.mAdShowCallback=t,this.mWXAdHandler!=null&&this.mWXAdHandler.show().then(function(){n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),n.mAdShowCallback&&n.mAdShowCallback.onShowSuccess(n,null,null)}).catch(function(r){n.mPosIdCfg&&MGRPT.minigame_common_ad.report(n.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_SHOW_FAILED,JSON.stringify(r),e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.e(n.TAG,"mRewardedVideoAd \u5F39\u51FA\u5E7F\u544A\u5168\u5C4F\u6846\u5931\u8D25\u4E86..., posId = "+n.mPosIdCfg.getPosId()),n.mAdShowCallback&&n.mAdShowCallback.onShowFail(n,null,null),n.tryAgain(n.mPosIdCfg.getPosId())}))},o.prototype.tryAgain=function(t){if(this.mWXAdHandler){var n=this.mWXAdHandler;n.load().then(function(){n.show().then(function(){MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_WXRV_SHOW_TRYAGAIN,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO)})})}},o.prototype.onAdClose=function(t){e.Log.i(this.TAG,"onAdClose, posId = "+this.mPosIdCfg.getPosId()),this.mAdShowCallback!=null&&(t&&t.isEnded||t===void 0?(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.i(this.TAG,"\u6B63\u5E38\u64AD\u653E\u7ED3\u675F\uFF0C\u53EF\u4EE5\u4E0B\u53D1\u6E38\u620F\u5956\u52B1, posId = "+this.mPosIdCfg.getPosId()),this.mAdShowCallback&&this.mAdShowCallback.onShowFinish(this,null,null)):(this.mPosIdCfg&&MGRPT.minigame_common_ad.report(this.mPosIdCfg.getPosId(),e.MGBAdAction.ACTION_WXRV_CLOSE_CLICK_NOT_END,e.MGBAdErrCode.ADERR_SUCCESS,e.MGBAdDefs.ADTYPE_WX_REWARDVIDEO),e.Log.i(this.TAG,"\u64AD\u653E\u4E2D\u9014\u9000\u51FA\uFF0C\u4E0D\u4E0B\u53D1\u6E38\u620F\u5956\u52B1, posId = "+this.mPosIdCfg.getPosId()),this.mAdShowCallback&&this.mAdShowCallback.onShowUnFinish(this,null,null)),this.mAdShowCallback=null)},o}();e.MGBAd4WXRewardVideo=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.TAG="MGB_AdSelector4Auto",this.mPosIdCfg=null,this.mAdProvider=null,this.mPlatformType=null,this.mPlatformType=t,this.mPosIdCfg=n}return o.prototype.fetchAd=function(t,n){if(this.prepareAdProviders(),this.mAdProvider==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_ADPROVIDER);if(this.mPosIdCfg==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_POSIDCFG);var r=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doFetch(this.mPosIdCfg,r,t,n)},o.prototype.loadAd=function(t,n){if(this.prepareAdProviders(),this.mAdProvider==null)return e.MGBAdErrCode.ADERR_AS_LOAD_NO_ADPROVIDER;if(this.mPosIdCfg==null)return e.MGBAdErrCode.ADERR_AS_LOAD_NO_POSIDCFG;var r=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doLoad(this.mPosIdCfg,r,t,n)},o.prototype.getCurSelAdType=function(){return this.prepareAdProviders(),this.mAdProvider?this.mAdProvider.getAdType():e.MGBAdDefs.ADTYPE_UNKNOWN},o.prototype.prepareAdProviders=function(){if(this.mAdProvider==null&&this.mPosIdCfg!=null){var t=this.mPosIdCfg.getNum(e.MGBAdPosIdCfg.KEY_ADTYPE,-1);t!=-1?(this.mAdProvider=this.instanceProvider(this.mPlatformType,t),this.mAdProvider!=null||e.Log.e(this.TAG,"didn't find match adprovider for "+this.mPlatformType+" / "+t)):e.Log.e(this.TAG,"PosIdConfig must be specified adType")}},o.prototype.getCacheSize=function(){return this.prepareAdProviders(),this.mAdProvider==null?(e.Log.e(this.TAG,"MGBAdSelector4Auto this.mAdProvider == null."),0):this.mAdProvider.getCacheSize()},o.prototype.instanceProvider=function(t,n){var r=null;switch(t){case e.MGBAdDefs.PLATFORM_WX:o.ADTYPE_BANNER==n?r=e.MGBAdProvider4WXBanner.APNAME:o.ADTYPE_REWARD_VIDEO==n&&(r=e.MGBAdProvider4WXRewardVideo.APNAME);break;case e.MGBAdDefs.PLATFORM_QQ:o.ADTYPE_BANNER==n?r=e.MGBAdProvider4QQBanner.APNAME:o.ADTYPE_REWARD_VIDEO==n&&(r=e.MGBAdProvider4QQRewardVideo.APNAME);break;case e.MGBAdDefs.PLATFORM_FB:o.ADTYPE_BANNER==n?(e.Log.w(this.TAG,"facebook doesn't provide banner ad"),r=e.MGBAdProvider4FBInterstitial.APNAME):o.ADTYPE_REWARD_VIDEO==n&&(r=e.MGBAdProvider4FBRewardVideo.APNAME)}return e.MGBAdCompFactory.getInstance().createAP(r)},o.ADTYPE_BANNER=100,o.ADTYPE_REWARD_VIDEO=200,o.ASNAME="auto_selector",o}();e.MGBAdSelector4Auto=s}(a||(a={})),function(e){var s=function(){function o(t){this.mPosIdCfg=null,this.mAdProvider=null,this.mPosIdCfg=t}return o.prototype.fetchAd=function(t,n){if(this.prepareAdProviders(),this.mAdProvider==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_ADPROVIDER);if(this.mPosIdCfg==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_AS_FETCH_NO_POSIDCFG);var r=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doFetch(this.mPosIdCfg,r,t,n)},o.prototype.loadAd=function(t,n){if(this.prepareAdProviders(),this.mAdProvider==null)return e.MGBAdErrCode.ADERR_AS_FETCH_NO_ADPROVIDER;if(this.mPosIdCfg==null)return e.MGBAdErrCode.ADERR_AS_LOAD_NO_POSIDCFG;var r=this.mPosIdCfg.getNativePosId();return this.mAdProvider.doLoad(this.mPosIdCfg,r,t,n)},o.prototype.prepareAdProviders=function(){if(this.mAdProvider==null&&this.mPosIdCfg!=null){var t=this.mPosIdCfg.getStr(e.MGBAdPosIdCfg.KEY_ADPROVIDER_NAME,"");t!=null&&(this.mAdProvider=e.MGBAdCompFactory.getInstance().createAP(t),this.mAdProvider)}},o.prototype.getCurSelAdType=function(){return this.prepareAdProviders(),this.mAdProvider?this.mAdProvider.getAdType():e.MGBAdDefs.ADTYPE_UNKNOWN},o.prototype.getCacheSize=function(){return this.mAdProvider==null?0:this.mAdProvider.getCacheSize()},o.ASNAME="manual_selector",o}();e.MGBAdSelector4Manual=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_MGBGameDepot",this.mListRcmdDest=new Array}return o.prototype.saveGames=function(t){if(t){for(var n=0,r=t;n<r.length;n++){var i=r[n],d=new e.MGBRcmdGame(i);this.mListRcmdDest.push(d)}e.Log.i(this.TAG,"mListRcmdDest.size:"+this.mListRcmdDest.length)}},o.prototype.getItem=function(t){return this.mListRcmdDest.length==0||t<0||t>=this.mListRcmdDest.length?null:this.mListRcmdDest[t]},o.prototype.getSize=function(){return this.mListRcmdDest?this.mListRcmdDest.length:0},o}();e.MGBGameDepot=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_MGBImg4Flag",this.mapImgUrls={}}return o.prototype.saveImgUrls=function(t){if(t)for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];if(i){var d=t[i];this.mapImgUrls[i]=d,e.Log.i(this.TAG,"imgurls flag["+i+"]: "+d)}}},o.prototype.getImgUrl=function(t){return t&&this.mapImgUrls?this.mapImgUrls[t]:null},o}();e.MGBImg4Flag=s}(a||(a={})),function(e){var s=function(){function o(t,n){this.mPosId=null,this.mPosId=t;var r=e.MGBRcmdModule.inst().getGameId();this.isDataCached()?(MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_LOCAL_START,0,this.getRptAdType()),this.loadFromCache(r,n)):(MGRPT.minigame_common_ad.report(t,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_START,0,this.getRptAdType()),this.loadFromNet(r,n))}return o.prototype.loadFromNet=function(t,n){var r=this,i=this.prepareUrl(t),d=this;if(!i||i.length==0)return e.Log.e(o.TAG,"urlDest is empty."),void(n&&n.onFailed());e.Log.i(o.TAG,"loadFromNet urlDest:"+i),e.PlatformProxy.getInstance().request({url:i,header:{Referer:"sqimg.qq.com"},method:"GET",dataType:"json",success:function(c,A){A?(MGRPT.minigame_common_ad.report(r.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_SUCCESS,e.MGBAdErrCode.ADERR_SUCCESS,r.getRptAdType()),r.saveData2Cache(A),n&&n.onReady(d)):(e.Log.e(o.TAG,"enter success: data == null"),MGRPT.minigame_common_ad.report(r.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_FAILED,"NO DATA",r.getRptAdType()),n&&n.onFailed())},fail:function(c,A){MGRPT.minigame_common_ad.report(r.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_NET_FAILED,c,r.getRptAdType()),e.Log.e(o.TAG,"enter fail: code:"+c),n&&n.onFailed()}})},o.prototype.loadFromCache=function(t,n){e.Log.i(o.TAG,"loadFromLocal begin."),this.isDataCached()?n&&(MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_LOCAL_SUCCESS,0,this.getRptAdType()),n.onReady(this)):n&&(MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_LOAD_FROM_LOCAL_FAILED,0,this.getRptAdType()),n.onFailed())},o.prototype.getRptAdType=function(){return e.MGBAdDefs.ADTYPE_RCMD_UNKNOWN},o.prototype.prepareUrl=function(t){var n=e.MGBRcmdModule.inst().getRcmdDataHost();return n||(n=e.MGBRcmdDefs.HOST),n+t+"/rcmdtype_"+this.getRcmdType()+".json"},o.TAG="MGB_MGBRcmd",o}();e.MGBRcmd=s}(a||(a={})),function(e){var s=function(o){function t(){return o!==null&&o.apply(this,arguments)||this}return D(t,o),t.prototype.getRcmdType=function(){return e.MGBRcmdDefs.RCMDTYPE_BIGCARD},t.prototype.isDataCached=function(){return!!t.sRcmdTypeData},t.prototype.saveData2Cache=function(n){return t._saveData2Cache(n)},t._saveData2Cache=function(n){if(!n)return!1;t.sRcmdTypeData=n,t.sGameDepot||(t.sGameDepot=new e.MGBGameDepot);var r=t.sRcmdTypeData.games;return r&&t.sGameDepot.saveGames(r),!0},t.TAG="MGB_MGBRcmd4BigCard",t.sRcmdTypeData=null,t.sGameDepot=null,t}(e.MGBRcmd);e.MGBRcmd4BigCard=s}(a||(a={})),function(e){var s=function(o){function t(){var n=o!==null&&o.apply(this,arguments)||this;return n.mCurPos=0,n.mbGetStartPos=!1,n}return D(t,o),t.prototype.isDataCached=function(){return!!t.sRawJsonData},t.prototype.getRcmdType=function(){return e.MGBRcmdDefs.RCMDTYPE_GIFTBOX},t.prototype.saveData2Cache=function(n){return t._saveData2Cache(n)},t._saveData2Cache=function(n){if(!n)return!1;t.sRawJsonData=n,t.sGameDepot||(t.sGameDepot=new e.MGBGameDepot);var r=t.sRawJsonData.games;return r&&t.sGameDepot.saveGames(r),!0},t.prototype.getIconUrlCur=function(){var n=this.getRCmdGamePosCur(),r=t.sGameDepot.getItem(n);return r?r.iconUrl:(e.Log.i(t.TAG,"!game"),null)},t.prototype.jump=function(n){var r=this;n===void 0&&(n=null);var i=this.getRCmdGamePosCur(),d=t.sGameDepot.getItem(i);d?(MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_START,d.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_GIFTBOX),e.PlatformProxy.getInstance().skipGame(this.mPosId,d,{success:function(c){n&&n.success(c),MGRPT.minigame_common_ad.report(r.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_END,d.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_GIFTBOX)},fail:function(c){n&&n.fail(c)}})):e.Log.e(t.TAG,"jump failed. no game match.")},t.prototype.getRCmdGamePosCur=function(){return this.mbGetStartPos||(this.mCurPos=this.getStartPos(),this.mbGetStartPos=!0),this.mCurPos},t.prototype.next=function(){var n=this.getGameDestCount();n!=0?this.mCurPos=(this.mCurPos+1)%n:e.Log.e(t.TAG,"nGameCount == 0, can't goto next.")},t.prototype.getStartPos=function(){if(!t.sRawJsonData)return 0;var n=t.sRawJsonData.posconfig;if(!n)return e.Log.e(t.TAG,"!posConfig"),0;for(var r=0,i=n;r<i.length;r++){var d=i[r];if(d&&d.posid&&d.posid==this.mPosId)return d.start_pos?d.start_pos:0}return 0},t.prototype.getGameDestCount=function(){if(!t.sRawJsonData)return 0;var n=t.sRawJsonData.games;return n?n.length:0},t.fillCache=function(n){try{var r=JSON.parse(n)}catch(i){return void e.Log.e(t.TAG,"JSON.parse failed. cacheData:"+n)}t._saveData2Cache(r)},t.TAG="MGB_MGBRcmd4GiftBox",t.sRawJsonData=null,t.sGameDepot=null,t}(e.MGBRcmd);e.MGBRcmd4GiftBox=s}(a||(a={})),function(e){var s=function(o){function t(){var n=o!==null&&o.apply(this,arguments)||this;return n.mGameSelected=null,n}return D(t,o),t.prototype.getRcmdType=function(){return e.MGBRcmdDefs.RCMDTYPE_SCOREWALL},t.prototype.isDataCached=function(){return!!t.sRawJsonData},t.prototype.saveData2Cache=function(n){var r;return r=t._saveData2Cache(n),this._savePosIdCfg(),r},t._saveData2Cache=function(n){if(!n||t.sRawJsonData)return!1;t.sRawJsonData=n,t.sGameDepot||(t.sGameDepot=new e.MGBGameDepot);var r=t.sRawJsonData.games;r&&t.sGameDepot.saveGames(r);var i=t.sRawJsonData.img4flag;return i&&(t.sImg4Flags||(t.sImg4Flags=new e.MGBImg4Flag),t.sImg4Flags.saveImgUrls(i)),!0},t.fillCache=function(n){try{var r=JSON.parse(n)}catch(i){return void e.Log.e(t.TAG,"JSON.parse failed. cacheData:"+n)}t._saveData2Cache(r)},t.prototype.getSize=function(){return this.isDataCached()?(this._savePosIdCfg(),this.mGameSelected?Object.keys(this.mGameSelected).length:0):0},t.prototype.getGameInfo=function(n){if(!this.isDataCached())return null;this._savePosIdCfg();var r=this.getGameIdx(n);return t.sGameDepot.getItem(r)},t.prototype.jump=function(n,r){var i=this;if(r===void 0&&(r=null),!this.isDataCached())return!1;this._savePosIdCfg();var d=this.getGameIdx(n),c=t.sGameDepot.getItem(d);if(!c)return e.Log.e(t.TAG,"No Game. jump_idxGS["+n+"]_gameIdx["+d+"]"),!1;MGRPT.minigame_common_ad.report(this.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_START,c.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_SCOREWALL),e.PlatformProxy.getInstance().skipGame(this.mPosId,c,{success:function(A){r&&r.success(A),MGRPT.minigame_common_ad.report(i.mPosId,e.MGBAdAction.ACTION_RCMD_JUMPGAME_END,c.getGameId(),e.MGBAdDefs.ADTYPE_RCMD_SCOREWALL)},fail:function(A){r&&r.fail(A)}})},t.getFlagUrl=function(n){return n&&t.sImg4Flags?t.sImg4Flags.getImgUrl(n):null},t.prototype.getGameIdx=function(n){return n<0||!this.mGameSelected||n>=this.mGameSelected.length?-1:this.mGameSelected[n]},t.prototype._savePosIdCfg=function(){if(!(this.mGameSelected&&0<this.mGameSelected.length))if(this.isDataCached())if(this.mPosId){var n=t.sRawJsonData.posconfig;if(n)for(var r=0,i=n;r<i.length;r++){var d=i[r];if(d){var c=d.posid;if(c&&c==this.mPosId){var A=d.game_sel;return void(A&&this._saveGameSel(A))}}}else e.Log.e(t.TAG,"!aryPosCfg in MGBRcmd4ScoreWall")}else e.Log.e(t.TAG,"no mPosId in MGBRcmd4ScoreWall");else e.Log.e(t.TAG,"no DataCached in MGBRcmd4ScoreWall")},t.prototype._saveGameSel=function(n){n&&(this.mGameSelected&&0<this.mGameSelected.length?e.Log.i(t.TAG,"in _saveGameSel, this.mGameSelected saved."):(this.mGameSelected=n,e.Log.i(t.TAG,"_saveGameSel size:"+this.mGameSelected.length)))},t.TAG="MGB_MGBRcmd4ScoreWall",t.sRawJsonData=null,t.sGameDepot=null,t.sImg4Flags=null,t}(e.MGBRcmd);e.MGBRcmd4ScoreWall=s}(a||(a={})),function(e){var s=function(){function o(){}return o.RCMDTYPE_GIFTBOX=1,o.RCMDTYPE_BIGCARD=2,o.RCMDTYPE_SCOREWALL=3,o.HOST="https://piano-weixin-game.cmcm.com/pianotiles2/cfg/game_rcmd/",o}();e.MGBRcmdDefs=s}(a||(a={})),function(e){var s=function(){function o(t){this.name="",this.iconUrl="",this.gameidWX="",this.gameidQQ=0,this.bigimgURL="",this.title="",this.describe="",this.describe2="",this.flag="",this.mapRewards={},t&&(this.name=t.name,t.icon&&(this.iconUrl=t.icon),this.gameidWX=t.gameid_wx,this.gameidQQ=t.gameid_qq?Number(t.gameid_qq):0,t.big_img&&(this.bigimgURL=t.big_img),t.title&&(this.title=t.title),t.describe&&(this.describe=t.describe),t.describe2&&(this.describe2=t.describe2),t.rewards&&this._saveRewards(t.rewards),t.flag&&(this.flag=t.flag))}return o.prototype.getGameId=function(){var t=e.PlatformChecker.getPlatformType();return t==e.MGBAdDefs.PLATFORM_QQ?this.gameidQQ:t==e.MGBAdDefs.PLATFORM_WX?this.gameidWX:""},o.prototype._saveRewards=function(t){if(t)for(var n in t)this.mapRewards[n]=t[n],e.Log.i("[MGB_ROM] in _saveRewards, key:"+n+", count:"+t[n])},o}();e.MGBRcmdGame=s}(a||(a={})),function(e){var s=function(){function o(){this.mGameId4RCmd=0,this.mUrlRcmdDir=null}return o.inst=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype.init=function(t){var n=e.PlatformChecker.getPlatformType();e.PlatformProxy.getInstance().init(n),this.mGameId4RCmd=t},o.prototype.getGameId=function(){return this.mGameId4RCmd},o.prototype.setRcmdDataHost=function(t){this.mUrlRcmdDir=t},o.prototype.getRcmdDataHost=function(){return this.mUrlRcmdDir},o.sInst=null,o}();e.MGBRcmdModule=s}(a||(a={})),function(e){var s=function(){function o(){}return o.prototype.getPlatformType=function(){return this.isPlatformWX()?e.MGBAdDefs.PLATFORM_WX:this.isPlatformQQ()?e.MGBAdDefs.PLATFORM_QQ:this.isPlatformFB()?e.MGBAdDefs.PLATFORM_FB:this.isPlatformWeb()?e.MGBAdDefs.PLATFORM_WEB:"unknown_platform"},o.prototype.isPlatformWX=function(){return cc.sys.platform==cc.sys.WECHAT_GAME},o.prototype.isPlatformQQ=function(){return cc.sys.platform==cc.sys.QQ_PLAY},o.prototype.isPlatformWeb=function(){return cc.sys.platform==cc.sys.DESKTOP_BROWSER||cc.sys.platform==cc.sys.MOBILE_BROWSER},o.prototype.isPlatformFB=function(){return typeof FBInstant!="undefined"},o.prototype.setLocalItem=function(t,n){cc.sys.localStorage.setItem(t,n)},o.prototype.getLocalItem=function(t){return cc.sys.localStorage.getItem(t)},o.prototype.removeLocalItem=function(t){cc.sys.localStorage.removeItem(t)},o.prototype.clear=function(){},o}();e.GameEngine4CC=s}(a||(a={})),function(e){var s=function(){function o(){}return o.prototype.getPlatformType=function(){return this.isPlatformWX()?e.MGBAdDefs.PLATFORM_WX:this.isPlatformQQ()?e.MGBAdDefs.PLATFORM_QQ:this.isPlatformFB()?e.MGBAdDefs.PLATFORM_FB:this.isPlatformWeb()?e.MGBAdDefs.PLATFORM_WEB:"unknown_platform"},o.prototype.isPlatformWX=function(){if(Laya.Browser.onMiniGame)return!0},o.prototype.isPlatformQQ=function(){return!!(Laya.Browser.userAgent&&-1<Laya.Browser.userAgent.indexOf("limixiu"))},o.prototype.isPlatformWeb=function(){return!0},o.prototype.isPlatformFB=function(){return typeof FBInstant!="undefined"},o.prototype.setLocalItem=function(t,n){Laya.LocalStorage.setItem(t,n)},o.prototype.getLocalItem=function(t){return Laya.LocalStorage.getItem(t)},o.prototype.removeLocalItem=function(t){Laya.LocalStorage.removeItem(t)},o.prototype.clear=function(){Laya.LocalStorage.clear()},o}();e.GameEngine4LayaBox=s}(a||(a={})),function(e){var s=function(){function o(){}return o.getPlatformType=function(){return o.mPlatformTypeCur?o.mPlatformTypeCur:(o.prepareGECur(),o.mGameEngineCur?o.mPlatformTypeCur=o.mGameEngineCur.getPlatformType():"")},o.isPlatformWX=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformWX()},o.isPlatformQQ=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformQQ()},o.isPlatformWeb=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformWeb()},o.isPlatformFB=function(){return o.prepareGECur(),!!o.mGameEngineCur&&o.mGameEngineCur.isPlatformFB()},o.setLocalItem=function(t,n){o.prepareGECur(),o.mGameEngineCur&&o.mGameEngineCur.setLocalItem(t,n)},o.getLocalItem=function(t){o.prepareGECur(),o.mGameEngineCur&&o.mGameEngineCur.getLocalItem(t)},o.removeLocalItem=function(t){o.prepareGECur(),o.mGameEngineCur&&o.mGameEngineCur.removeLocalItem(t)},o.clear=function(){o.prepareGECur(),o.mGameEngineCur&&o.clear()},o.prepareGECur=function(){if(!o.mGameEngineCur){var t=o.getCurEngineType();o.setCurGameEngine(t)}},o.setCurGameEngine=function(t){if(!this.mGameEngineCur&&t&&t.length!=0)switch(t){case e.MGBAdDefs.GETYPE_CC:this.mGameEngineCur=new e.GameEngine4CC;break;case e.MGBAdDefs.GETYPE_LAYABOX:this.mGameEngineCur=new e.GameEngine4LayaBox}},o.getCurEngineType=function(){return typeof Laya!="undefined"&&Laya.LocalStorage!==void 0?e.MGBAdDefs.GETYPE_LAYABOX:typeof cc!="undefined"&&cc.sys!==void 0?e.MGBAdDefs.GETYPE_CC:""},o.mGameEngineCur=null,o.mPlatformTypeCur=null,o}();e.GameEngineProxy=s}(a||(a={})),function(e){var s=function(){function o(){this.mMapObject=new Map}return o.prototype.setNum=function(t,n){this.mMapObject.set(t,n)},o.prototype.getNum=function(t,n){if(!this.mMapObject.has(t))return n;var r=this.mMapObject.get(t);return r==null||typeof r!="number"?n:r},o.prototype.setStr=function(t,n){this.mMapObject.set(t,n)},o.prototype.getStr=function(t,n){if(!this.mMapObject.has(t))return n;var r=this.mMapObject.get(t);return r==null||typeof r!="string"?n:r},o.prototype.setObject=function(t,n){this.mMapObject.set(t,n)},o.prototype.getObject=function(t,n){return this.mMapObject.has(t)?this.mMapObject.get(t):n},o}();e.Params=s}(a||(a={})),function(e){var s=function(){this.brand="",this.model="",this.pixelRatio=0,this.screenWidth=0,this.screenHeight=0,this.windowWidth=0,this.windowHeight=0,this.statusBarHeight=0,this.language="",this.version="",this.system="",this.platform="",this.fontSizeSetting=0,this.SDKVersion="",this.benchmarkLevel=1};e.PlatformInfo=s;var o=function(){};e.LaunchOption=o}(a||(a={})),function(e){var s=function(){function o(){}return o.ACTION_UNKNOWN=0,o.ACTION_SHOW_SUCCESS=1,o.ACTION_CLICK=2,o.ACTION_SHOW_FAILED=3,o.ACTION_SHOW_BEGIN=4,o.ACTION_SELECTOR_FETCH_START=20,o.ACTION_SELECTOR_FETCH_SUCCESS=21,o.ACTION_SELECTOR_FETCH_FAILED=22,o.ACTION_SELECTOR_LOAD_START=40,o.ACTION_SELECTOR_LOAD_SUCCESS=41,o.ACTION_SELECTOR_LOAD_FAILED=42,o.ACTION_AP_FETCH_START=100,o.ACTION_AP_FETCH_SUCCESS=101,o.ACTION_AP_FETCH_FAILED=102,o.ACTION_AP_LOAD_START=120,o.ACTION_AP_LOAD_SUCCESS=121,o.ACTION_AP_LOAD_FAILED=122,o.ACTION_NOT_TO_LOAD=123,o.ACTION_WXRV_CLOSE_CLICK_NOT_END=150,o.ACTION_WXRV_CLOSE_CLICK_END=151,o.ACTION_WXRV_SHOW_TRYAGAIN=152,o.ACTION_WXRV_ONADERROR=153,o.ACTION_RCMD_LOAD_FROM_NET_START=501,o.ACTION_RCMD_LOAD_FROM_NET_SUCCESS=502,o.ACTION_RCMD_LOAD_FROM_NET_FAILED=503,o.ACTION_RCMD_LOAD_FROM_LOCAL_START=511,o.ACTION_RCMD_LOAD_FROM_LOCAL_SUCCESS=512,o.ACTION_RCMD_LOAD_FROM_LOCAL_FAILED=513,o.ACTION_RCMD_JUMPGAME_START=10002,o.ACTION_RCMD_JUMPGAME_END=551,o.ACTION_BUTTON_SHOW=10001,o.ACTION_BUTTON_CLICK=10002,o}();e.MGBAdAction=s}(a||(a={})),function(e){var s=function(){function o(){this.mAdCache=new Array}return o.prototype.getSize=function(){return this.removeInvalidCache(),this.mAdCache==null?0:this.mAdCache.length},o.prototype.pushBack=function(t){this.mAdCache.push(t)},o.prototype.popFront=function(){return this.mAdCache.pop()},o.prototype.removeInvalidCache=function(){if(this.mAdCache!=null&&this.mAdCache.length!=0)for(var t=!1,n=0,r=(t=!1,this.mAdCache.length);n<r;t?n:n++){var i=this.mAdCache[n];i!=null&&i.isCurValid()?t=!1:(this.mAdCache.splice(n,1),t=!0)}},o}();e.MGBAdCache=s}(a||(a={})),function(e){var s=function(){function o(){this.mMapId2APCreator=new Map,this.mMapId2ASCreator=new Map,this.TAG="MGB_AdCompFactory"}return o.getInstance=function(){return o.sInst!=null?o.sInst:o.sInst=new o},o.prototype.regAPCreator=function(t,n){this.mMapId2APCreator.set(t,n)},o.prototype.createAP=function(t){if(t==null||!this.mMapId2APCreator.has(t))return e.Log.e(this.TAG,"apName is not registered to MGBAdCompFactory."),null;var n=this.mMapId2APCreator.get(t);return n==null?null:n.createNewAdProvider()},o.prototype.getAPCreator=function(t){if(!this.mMapId2APCreator.has(t))return null;this.mMapId2APCreator.get(t)},o.prototype.regASCreator=function(t,n){this.mMapId2ASCreator.set(t,n)},o.prototype.createAS=function(t,n){if(t==null||!this.mMapId2ASCreator.has(t))return null;var r=this.mMapId2ASCreator.get(t);return r==null?null:r.createNewAdSelector(n)},o.prototype.getASCreator=function(t){if(!this.mMapId2ASCreator.has(t))return null;this.mMapId2ASCreator.get(t)},o.sInst=null,o}();e.MGBAdCompFactory=s}(a||(a={})),function(e){var s=function(){function o(t){this.mPosIdCfg=null,this.mAdSelector=null,this.mAdLast=null,this.TAG="MGB_AdDepot",this.mPosIdCfg=t}return o.prototype.doLoad=function(t,n){return this.prepareAdSelector(),this.mAdSelector==null?e.MGBAdErrCode.ADERR_DEPOT_LOAD_NO_ADSELECTOR:(t==null&&(t=new e.ParamAdLoad),this.destoryLastAd(),this.mAdSelector.loadAd(t,n))},o.prototype.doFetch=function(t,n){if(this.prepareAdSelector(),this.mAdSelector==null)return new e.ResultFetchAd(e.MGBAdErrCode.ADERR_DEPOT_FETCH_NO_ADSELECTOR);t==null&&(t=new e.ParamAdFetch),this.destoryLastAd();var r=this.mAdSelector.fetchAd(t,n);return r!=null&&r.mAdErrCode==e.MGBAdErrCode.ADERR_SUCCESS&&(this.mAdLast=r.getAd()),r},o.prototype.prepareAdSelector=function(){if(this.mAdSelector==null&&this.mPosIdCfg!=null){var t=this.mPosIdCfg.getStr(e.MGBAdPosIdCfg.KEY_ADSELECTOR_NAME,"");t!=null&&t.length!=0||e.Log.e(this.TAG,"posId: asName == null"),this.mAdSelector=e.MGBAdCompFactory.getInstance().createAS(t,this.mPosIdCfg)}},o.prototype.getCacheSize=function(){return this.prepareAdSelector(),this.mAdSelector==null?(e.Log.e("MGB_DEBUG","MGBAdDepot.getCacheSize: this.mAdSelector == null"),0):this.mAdSelector.getCacheSize()},o.prototype.destoryLastAd=function(){this.mAdLast!=null&&(this.mAdLast.destroy(),this.mAdLast=null)},o.prototype.getAdType=function(){return this.prepareAdSelector(),this.mAdSelector?this.mAdSelector.getCurSelAdType():e.MGBAdDefs.ADTYPE_UNKNOWN},o}();e.MGBAdDepot=s}(a||(a={})),function(e){var s=function(o){function t(){var n=o.call(this)||this;return n.TAG="MGB_AdEnvCfg",n.mPlatformType=null,n.mPlatformInfo=null,n.mInitTime=Date.now(),n.mPlatformType=e.PlatformChecker.getPlatformType(),e.PlatformProxy.getInstance().init(n.mPlatformType),e.Log.i(n.TAG,"PlatformProxy.init: "+n.mPlatformType),n.mPlatformInfo=e.PlatformProxy.getInstance().getPlatformInfo(),e.Log.i(n.TAG,"[platform]: "+JSON.stringify(n.mPlatformInfo)),n}return D(t,o),t.prototype.getPlatformType=function(){return this.mPlatformType},t.prototype.getPlatformInfo=function(){return this.mPlatformInfo},t}(e.Params);e.MGBAdEnvCfg=s}(a||(a={})),function(e){var s=function(){function o(){}return o.ADERR_UNKNOWN=-1,o.ADERR_SUCCESS=0,o.ADERR_LOADING=1,o.ADERR_DEPOT_LOAD_NO_ADSELECTOR=40,o.ADERR_DEPOT_FETCH_NO_ADSELECTOR=41,o.ADERR_AS_FETCH_NO_ADPROVIDER=60,o.ADERR_AS_LOAD_NO_ADPROVIDER=61,o.ADERR_AS_FETCH_NO_POSIDCFG=62,o.ADERR_AS_LOAD_NO_POSIDCFG=63,o.ADERR_AP_LOAD_NO_NATIVEPOSID=100,o.ADERR_AP_LOAD_NO_POSIDCFG=101,o.ADERR_AP_LOAD_WXBH_ONERROR=102,o.ADERR_AP_LOAD_ARGS_ERROR=103,o.ADERR_AP_FETCH_NO_NATIVEPOSID=120,o.ADERR_AP_FETCH_NO_POSIDCFG=121,o.ADERR_AP_FETCH_NOAD_INCACHE=122,o.ADERR_AP_FETCH_ARGS_ERROR=123,o.ADERR_ADMODULE_INITED=140,o.ADERR_ADMODULE_INIT_NO_LISTPOSCFG=141,o.ADERR_ADMODULE_INIT_NO_ADENVCFG=142,o.ADERR_ADMODULE_FETCH_NO_ADDEPOT=151,o.ADERR_ADMODULE_LOAD_NO_ADDEPOT=161,o.ADERR_ADMODULE_PLATFORM_INTERCEPT=162,o.ADERR_ADM_EXIT_SCENE=163,o.ADERR_AP4WXBANNER_LOAD_NO_ADHANDLER=500,o.ADERR_AP4WXBANNER_LOAD_NO_API=501,o.ADERR_AP4WXVIDEO_LOAD_NO_ADHANDLER=550,o.ADERR_AP4WXVIDEO_NOT_SUPPORT=551,o.ADERR_AP4WXVIDEO_FETCH_NO_ADHANDLER=552,o}();e.MGBAdErrCode=s}(a||(a={})),function(e){var s=function(){function o(t){this.TAG="MGB_AdInterceptor",this.VALID_WXAD_SDKVERSION="2.0.4",this.mbEnableAdOutSide=!0,this.mPlatformType=t}return o.prototype.switch4Ad=function(t){(this.mbEnableAdOutSide=t)?e.Log.w(this.TAG,"MGBAdSDK will be enable, ^_^"):e.Log.w(this.TAG,"MGBAdSDK will be disable, =.=!!")},o.prototype.intercept=function(){if(!this.mbEnableAdOutSide)return e.Log.e(this.TAG,"MGBAd SDK is disable"),!0;switch(this.mPlatformType){case e.MGBAdDefs.PLATFORM_WX:return!this.isWXSDKVersionValid();case e.MGBAdDefs.PLATFORM_QQ:return!1;case e.MGBAdDefs.PLATFORM_FB:return!this.isFaceBookAdAPISupported()}return!0},o.prototype.isFaceBookAdAPISupported=function(){var t=this;if(!this.mFaceBookVideoAPI)return!0;var n=FBInstant.getSupportedAPIs();return n&&n.forEach(function(r){if(r==="getRewardedVideoAsync")return t.mFaceBookVideoAPI=r,!0}),!1},o.prototype.isWXSDKVersionValid=function(){return wx.getSystemInfoSync().SDKVersion>=this.VALID_WXAD_SDKVERSION},o}();e.MGBAdInterceptor=s}(a||(a={})),function(e){var s=function(o){function t(n){var r=o.call(this)||this;return r.setStr(t.KEY_POSID,n),r.setStr(e.MGBAdPosIdCfg.KEY_ADSELECTOR_NAME,e.MGBAdSelector4Auto.ASNAME),r}return D(t,o),t.prototype.getPosId=function(){return this.getStr(t.KEY_POSID,"")},t.prototype.getNativePosId=function(){var n=this.getStr(t.KEY_ADPROVIDER_NATIVE_POSID,"");return n&&0<n.length?n:e.PlatformProxy.getInstance().getNativePosId(this)},t.KEY_POSID=1,t.KEY_ADTYPE=2,t.KEY_ADPROVIDER_NATIVE_POSID=11,t.KEY_ADPROVIDER_NAME=12,t.KEY_ADSELECTOR_NAME=21,t.KEY_AP4WXBANNER_LOAD_WIDTH=101,t.KEY_AP4WXBANNER_POS_ADAPTER=102,t.KEY_AP4QQVIDEO_TYPE=103,t.KEY_NATIVE_POSID_WX=201,t.KEY_NATIVE_POSID_QQ=202,t.KEY_NATIVE_POSID_FB=203,t.KEY_NATIVE_POSID_OPPO=204,t}(e.Params);e.MGBAdPosIdCfg=s}(a||(a={})),function(e){var s=function(){function o(t){this.mMapId2Cfg=new Map,this.addAdPosIdCfgList(t)}return o.prototype.addAdPosIdCfgList=function(t){if(t!=null&&t.length!=0)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i!=null){var d=i.getPosId();d!=null&&this.mMapId2Cfg.set(d,i)}}},o.prototype.getPosIdCfg=function(t){return t==null?null:this.mMapId2Cfg.has(t)?this.mMapId2Cfg.get(t):null},o}();e.MGBAdPosIdCfgDepot=s}(a||(a={})),function(e){var s=function(){function o(){this.mMapId2Time=new Map}return o.prototype.MGBAdShowRecord=function(){},o.getInstance=function(){return o.sInst?o.sInst:o.sInst=new o},o.prototype.isShowAdTooMuch=function(t){if(!t)return!1;var n,r=Date.now();return n=r-this.getAdPosLastShowTime(t)<2e3,this.saveAdPosLastShowTime(t,r),n&&e.Log.i("MGB_DEBUG","["+t+"], show ad too much."),n},o.prototype.getAdPosLastShowTime=function(t){return this.mMapId2Time.has(t)?this.mMapId2Time.get(t):0},o.prototype.saveAdPosLastShowTime=function(t,n){this.mMapId2Time&&this.mMapId2Time.set(t,n)},o.sInst=null,o}();e.MGBAdShowRecord=s}(a||(a={})),function(e){var s=function(o){function t(){return o!==null&&o.apply(this,arguments)||this}return D(t,o),t}(e.Params);e.ParamAdFetch=s}(a||(a={})),function(e){var s=function(o){function t(){return o!==null&&o.apply(this,arguments)||this}return D(t,o),t}(e.Params);e.ParamAdLoad=s}(a||(a={})),function(e){var s=function(){function o(t){this.mAd=null,this.mAdErrCode=e.MGBAdErrCode.ADERR_UNKNOWN,this.mAdErrCode=t}return o.prototype.fillAd=function(t){return this.mAd=t,this},o.prototype.getAd=function(){return this.mAd},o}();e.ResultFetchAd=s}(a||(a={})),function(e){var s=function(){function o(){}return o.getPlatformType=function(){return e.GameEngineProxy.getPlatformType()},o.isPlatformWX=function(){return e.GameEngineProxy.isPlatformWX()},o.isPlatformQQ=function(){return e.GameEngineProxy.isPlatformQQ()},o.isPlatformWeb=function(){return e.GameEngineProxy.isPlatformWeb()},o.isPlatformFB=function(){return e.GameEngineProxy.isPlatformFB()},o}();e.PlatformChecker=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_PlatformImpl4FB"}return o.prototype.getLaunchParameter=function(){var t=new e.LaunchOption;return FBInstant.getEntryPointData()||e.Log.w(this.TAG,"no launch options associated with current entry point"),t},o.prototype.request=function(t,n){var r=this;e.Log.i(this.TAG,"facebook reqeust params: "+JSON.stringify(t));var i=new XMLHttpRequest;for(var d in i.open(t.method,t.url),t.header)i.setRequestHeader(d,t.header[d]);i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE)if(e.Log.i(r.TAG,"facebook request, response code:",i.status),e.Log.i(r.TAG,"facebook request, response:",i.response),i.status==200){if(e.Log.i(r.TAG,"facebook request, succeed:",i.responseText),t.success){var c=i.status,A=i.getAllResponseHeaders();if(t.dataType=="json")try{t.success(c,JSON.parse(i.responseText),A)}catch(C){t.success(c,i.responseText,A)}else t.success(c,i.responseText,A)}}else e.Log.i(r.TAG,"facebook request, failed:",i.responseText),1<n?r.request(t,n-1):t.fail&&t.fail(i.status,i.responseText)},i.send(JSON.stringify(t.data))},o.prototype.getPlatformInfo=function(){var t=new e.PlatformInfo;t.language=FBInstant.getLocale(),t.platform=FBInstant.getPlatform(),t.SDKVersion=FBInstant.getSDKVersion();try{t.screenWidth=window.screen.width,t.screenHeight=window.screen.height}catch(n){e.Log.w(this.TAG,"exception occur while collecting platform info")}return t},o.prototype.setStorage=function(t,n){this.isLocalStorageAvailable()?window.localStorage.setItem(t,n):this.isSessionAvailable()?window.sessionStorage.setItem(t,n):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.getStorage=function(t){return this.isLocalStorageAvailable()?window.localStorage.getItem(t):this.isSessionAvailable()?window.sessionStorage.getItem(t):void e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.delStorage=function(t){this.isLocalStorageAvailable()?window.localStorage.removeItem(t):this.isSessionAvailable()?window.sessionStorage.removeItem(t):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.isSessionAvailable=function(){return!!window.sessionStorage},o.prototype.isLocalStorageAvailable=function(){return!!window.localStorage},o.prototype.skipGame=function(t,n){return!1},o.prototype.getNativePosId=function(t){return t?t.getStr(e.MGBAdPosIdCfg.KEY_NATIVE_POSID_FB,""):""},o}();e.PlatformImpl4FB=s}(a||(a={})),function(e){var s=function(){function o(){this.mbEnteredBackground=!1,this.init()}return o.prototype.init=function(){var t=function(){function n(r){this.TAG="MGB_PlatformImpl4QQ",this.platformImpl=null,this.platformImpl=r}return n.prototype.onLoad=function(r){},n.prototype.onMaximize=function(r){},n.prototype.onMinimize=function(r){},n.prototype.onEnterBackground=function(r){this.platformImpl.mbEnteredBackground=!0},n.prototype.onEnterForeground=function(r){this.platformImpl.mbEnteredBackground=!1},n.prototype.onClose=function(r){},n}();new BK.Game(new t(this))},o.prototype.getLaunchParameter=function(){var t=new e.LaunchOption;if(this.mbEnteredBackground)return t;var n=GameStatusInfo.gameParam;if(n){for(var r={},i=(n[0]==="?"?n.substr(1):n).split("&"),d=0;d<i.length;d++){var c=i[d].split("=");r[decodeURIComponent(c[0])]=decodeURIComponent(c[1]||"")}t.query=r}return t.shareTicket=GameStatusInfo.aioType.toString(),t},o.prototype.request=function(t,n){var r=this,i=t.method?t.method:"POST",d=new BK.HttpUtil(t.url);if(d.setHttpReferer("sqimg.qq.com"),d.setHttpMethod(i),t.header)for(var c in t.header)d.setHttpHeader(c,t.header[c]);if(t.data){var A=new BK.Buffer(0,!1);A.writeAsString(JSON.stringify(t.data),!1),d.setHttpRawBody(A)}d.requestAsync(function(C,p){var g=C.readAsString(!1);if(p==200){if(t.success)if(t.dataType=="json")try{t.success(p,JSON.parse(g),null)}catch(S){e.Log.e(o.TAG,"success 2. rsp:"+g),t.success(p,g,null)}else t.success(p,g,null)}else if(e.Log.e(o.TAG,"code("+p+") != 200"),0<n)r.request(t,n-1);else if(t.fail)if(t.dataType=="json")try{t.fail(p,JSON.parse(g))}catch(S){t.fail(p,g)}else t.fail(p,g)})},o.prototype.getPlatformInfo=function(){var t=new e.PlatformInfo;return t.version=GameStatusInfo.QQVer,t.system=GameStatusInfo.platform+" "+GameStatusInfo.osVersion,t.screenWidth=BK.Director.screenPixelSize.width,t.screenHeight=BK.Director.screenPixelSize.height,t.platform=GameStatusInfo.platform,t},o.prototype.setStorage=function(t,n){e.GameEngineProxy.setLocalItem(t,n)},o.prototype.getStorage=function(t){return e.GameEngineProxy.getLocalItem(t)},o.prototype.delStorage=function(t){e.GameEngineProxy.removeLocalItem(t)},o.prototype.skipGame=function(t,n,r){if(!BK.QQ.skipGame)return e.Log.i(o.TAG,"BK.QQ.skipGame undefined."),r&&r.fail&&r.fail(null),!1;var i=MGRPT.MGCroProTag.KEY_CROSS_PROMOTION_TAG,d=MGRPT.MGCmnRptModule.getCroProTag().fetch(),c=MGRPT.MGCmnRptModule.getInfocEnvCfg(),A={};return A[i]=d,A.cm_game_id=c.game_id,BK.QQ.skipGame(n.gameidQQ,JSON.stringify(A)),e.Log.i(o.TAG,"after call BK.QQ.skipGame. gameid_qq:"+n.gameidQQ),r&&r.success&&r.success(null),!0},o.getDataPath=function(){BK.FileUtil.isFileExist(o.DATA_DIR)||BK.FileUtil.makeDir(o.DATA_DIR);var t=o.DATA_DIR+GameStatusInfo.openId+"/";return BK.FileUtil.isFileExist(t)||BK.FileUtil.makeDir(t),t},o.prototype.getNativePosId=function(t){return t?t.getStr(e.MGBAdPosIdCfg.KEY_NATIVE_POSID_QQ,""):""},o.TAG="MGB_PlatformImpl4QQ",o.DATA_DIR="GameSandBox://data4ad/",o}();e.PlatformImpl4QQ=s}(a||(a={})),function(e){var s=function(){function o(){}return o.prototype.getLaunchParameter=function(){return wx.getLaunchOptionsSync()},o.prototype.login=function(t){wx.login({success:function(n){e.Log.i(o.TAG,"WX login success. # code:"+n.code)},fail:function(n){e.Log.i(o.TAG,"WX login failed. # code:"+n.code+", errmsg:"+n.errMsg)}})},o.prototype.getUserSetting=function(t){wx.getSetting({success:function(n){t.success&&t.success(n.authSetting)},fail:function(){t.fail&&t.fail()}})},o.prototype.request=function(t,n){var r=this;wx.request({url:t.url,data:t.data,header:t.header,method:t.method,dataType:t.dataType,success:function(i){i.statusCode!=200?t.fail&&t.fail(i.statusCode,i):i.data?t.success&&t.success(i.statusCode,i.data,i.header):t.fail&&t.fail(i.statusCode,i)},fail:function(){1<n?r.request(t,n-1):t.fail&&t.fail(-1,null)}})},o.prototype.getPlatformInfo=function(){return wx.getSystemInfoSync()},o.prototype.setStorage=function(t,n){wx.setStorageSync(t,n)},o.prototype.getStorage=function(t){return wx.getStorageSync(t)},o.prototype.delStorage=function(t){wx.removeStorageSync(t)},o.prototype.skipGame=function(t,n,r){if(!wx||!wx.navigateToMiniProgram)return e.Log.i(o.TAG,"wx.navigateToMiniProgram undefined."),!1;var i=MGRPT.MGCroProTag.KEY_CROSS_PROMOTION_TAG,d=MGRPT.MGCmnRptModule.getCroProTag().fetch(),c=MGRPT.MGCmnRptModule.getInfocEnvCfg(),A={};A[i]=d,A.cm_game_id=c.game_id;var C={appId:n.getGameId(),extraData:A,success:function(p){e.Log.i(o.TAG,"navigateToMiniProgram success(). res:"+JSON.stringify(p)),r&&r.success&&r.success(p)},fail:function(p){e.Log.i(o.TAG,"navigateToMiniProgram fail(). res:"+JSON.stringify(p)),r&&r.fail&&r.fail(p)},complete:function(p){e.Log.i(o.TAG,"navigateToMiniProgram complete(). res:"+JSON.stringify(p))}};return wx.navigateToMiniProgram(C),!0},o.prototype.getNativePosId=function(t){return t?t.getStr(e.MGBAdPosIdCfg.KEY_NATIVE_POSID_WX,""):""},o.TAG="MGB_PlatformImpl4WX",o}();e.PlatformImpl4WX=s}(a||(a={})),function(e){var s=function(){function o(){this.TAG="MGB_PlatformImpl4Web"}return o.prototype.getLaunchParameter=function(){return new e.LaunchOption},o.prototype.request=function(t,n){var r=this;e.Log.i(this.TAG,"reqeust params: "+t);var i=new XMLHttpRequest;for(var d in i.open(t.method,t.url),t.header)i.setRequestHeader(d,t.header[d]);i.onreadystatechange=function(){if(i.readyState==4)if(i.status==200){if(e.Log.i(r.TAG,"request, succeed:",i.responseText),t.success){var c=i.status,A=i.getAllResponseHeaders();if(t.dataType=="json")try{t.success(c,JSON.parse(i.responseText),A)}catch(C){t.success(c,i.responseText,A)}else t.success(c,i.responseText,A)}}else e.Log.i(r.TAG,"request, failed:",i.responseText),1<n?r.request(t,n-1):t.fail&&t.fail(i.status,i.responseText)},i.send(JSON.stringify(t.data))},o.prototype.getPlatformInfo=function(){var t=new e.PlatformInfo;t.platform="web";try{t.system=navigator.platform,t.model=navigator.appName,t.version=navigator.appVersion,t.language=navigator.language,t.screenWidth=window.screen.width,t.screenHeight=window.screen.height}catch(n){e.Log.w(this.TAG,"exception occur while collecting platform info")}return t},o.prototype.setStorage=function(t,n){this.isLocalStorageAvailable()?window.localStorage.setItem(t,n):this.isSessionAvailable()?window.sessionStorage.setItem(t,n):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.getStorage=function(t){return this.isLocalStorageAvailable()?window.localStorage.getItem(t):this.isSessionAvailable()?window.sessionStorage.getItem(t):void e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.delStorage=function(t){this.isLocalStorageAvailable()?window.localStorage.removeItem(t):this.isSessionAvailable()?window.sessionStorage.removeItem(t):e.Log.w(this.TAG,"storage api is unavailable")},o.prototype.isSessionAvailable=function(){return!!window.sessionStorage},o.prototype.isLocalStorageAvailable=function(){return!!window.localStorage},o.prototype.skipGame=function(t,n){return!1},o.prototype.getNativePosId=function(t){return""},o}();e.PlatformImpl4Web=s}(a||(a={})),function(e){var s=function(){function o(){this.mPlatformCur=null,this.mInfocEnvCfg=null}return o.getInstance=function(){return this.sInst!=null||(this.sInst=new o),this.sInst},o.prototype.init=function(t){if(!this.mPlatformCur)switch(t){case e.MGBAdDefs.PLATFORM_WX:this.mPlatformCur=new e.PlatformImpl4WX;break;case e.MGBAdDefs.PLATFORM_QQ:this.mPlatformCur=new e.PlatformImpl4QQ;break;case e.MGBAdDefs.PLATFORM_WEB:this.mPlatformCur=new e.PlatformImpl4Web;break;case e.MGBAdDefs.PLATFORM_FB:this.mPlatformCur=new e.PlatformImpl4FB}},o.prototype.request=function(t,n){n===void 0&&(n=3),this.mPlatformCur?this.mPlatformCur.request(t,n):t&&t.fail&&t.fail(0,null)},o.prototype.getPlatformInfo=function(){return this.mPlatformCur?this.mPlatformCur.getPlatformInfo():null},o.prototype.setStorage=function(t,n){if(!this.mPlatformCur)return null;this.mPlatformCur.setStorage(t,n)},o.prototype.getStorage=function(t){return this.mPlatformCur?this.mPlatformCur.getStorage(t):null},o.prototype.delStorage=function(t){if(!this.mPlatformCur)return null;this.mPlatformCur.delStorage(t)},o.prototype.skipGame=function(t,n,r){return r===void 0&&(r=null),!!this.mPlatformCur&&this.mPlatformCur.skipGame(t,n,r)},o.prototype.getNativePosId=function(t){return this.mPlatformCur?this.mPlatformCur.getNativePosId(t):""},o.sInst=null,o}();e.PlatformProxy=s}(a||(a={})),function(e){var s=function(t,n){this.key=null,this.value=null,this.key=t,this.value=n};e.Pair=s;var o=function(){function t(){this.arr=[]}return t.prototype.put=function(n,r){for(var i=0;i<this.arr.length;i++)if(this.arr[i].key===n)return void(this.arr[i].value=r);this.arr.push(new s(n,r))},t.prototype.get=function(n){for(var r=0;r<this.arr.length;r++)if(this.arr[r].key===n)return this.arr[r].value;return null},t.prototype.getPair=function(n){for(var r=0;r<this.arr.length;r++)if(this.arr[r].key===n)return this.arr[r];return null},t.prototype.remove=function(n){for(var r=0;r<this.arr.length;r++)if(this.arr[r].key===n)return void this.arr.splice(r,1)},t.prototype.clear=function(){this.arr=[]},t.prototype.size=function(){return this.arr.length},t.prototype.getPairs=function(){return this.arr},t}();e.Dictionary=o}(a||(a={})),function(e){var s=function(){function o(){}return o.i=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(n)):console.info(o.getPrefix(),t,n))},o.w=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(n)):console.warn(o.getPrefix(),t,n))},o.e=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(n)):console.error(o.getPrefix(),t,n))},o.f=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];o.isEnableLog()&&(e.PlatformChecker.getPlatformType()==e.MGBAdDefs.PLATFORM_QQ?BK.Script.log(1,1,t+this.GetOptionalMsg(n)):console.error(o.getPrefix(),t,n))},o.formatDateTime=function(){var t=new Date,n=t.getHours().toString(),r=t.getMinutes().toString(),i=t.getSeconds().toString(),d=t.getMilliseconds().toString();if(r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),d.length<3)for(var c=0;c<3-d.length;c++)d="0"+d;return n+":"+r+":"+i+" "+d},o.getPrefix=function(){return"["+o.formatDateTime()+"] "},o.GetOptionalMsg=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r="";for(var i in t)r+=" "+t[i];return r},o.enableLog=function(t){o.sEnable=t},o.isEnableLog=function(){return o.sEnable},o.sEnable=!0,o}();e.Log=s}(a||(a={})),function(e){var s=0,o="";function t(m){return i(n(A(m)))}function n(m){return p(g(C(m),8*m.length))}function r(m,u){var l=C(m);16<l.length&&(l=g(l,8*m.length));for(var h=Array(16),f=Array(16),_=0;_<16;_++)h[_]=909522486^l[_],f[_]=1549556828^l[_];var P=g(h.concat(C(u)),512+8*u.length);return p(g(f.concat(P),672))}function i(m){for(var u,l=s?"0123456789ABCDEF":"0123456789abcdef",h="",f=0;f<m.length;f++)u=m.charCodeAt(f),h+=l.charAt(u>>>4&15)+l.charAt(15&u);return h}function d(m){for(var u="",l=m.length,h=0;h<l;h+=3)for(var f=m.charCodeAt(h)<<16|(h+1<l?m.charCodeAt(h+1)<<8:0)|(h+2<l?m.charCodeAt(h+2):0),_=0;_<4;_++)8*h+6*_>8*m.length?u+=o:u+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(f>>>6*(3-_)&63);return u}function c(m,u){var l,h,f,_,P=u.length,I=Array(),E=Array(Math.ceil(m.length/2));for(l=0;l<E.length;l++)E[l]=m.charCodeAt(2*l)<<8|m.charCodeAt(2*l+1);for(;0<E.length;){for(_=Array(),l=f=0;l<E.length;l++)f=(f<<16)+E[l],f-=(h=Math.floor(f/P))*P,(0<_.length||0<h)&&(_[_.length]=h);I[I.length]=f,E=_}var T="";for(l=I.length-1;0<=l;l--)T+=u.charAt(I[l]);var O=Math.ceil(8*m.length/(Math.log(u.length)/Math.log(2)));for(l=T.length;l<O;l++)T=u[0]+T;return T}function A(m){for(var u,l,h="",f=-1;++f<m.length;)u=m.charCodeAt(f),l=f+1<m.length?m.charCodeAt(f+1):0,55296<=u&&u<=56319&&56320<=l&&l<=57343&&(u=65536+((1023&u)<<10)+(1023&l),f++),u<=127?h+=String.fromCharCode(u):u<=2047?h+=String.fromCharCode(192|u>>>6&31,128|63&u):u<=65535?h+=String.fromCharCode(224|u>>>12&15,128|u>>>6&63,128|63&u):u<=2097151&&(h+=String.fromCharCode(240|u>>>18&7,128|u>>>12&63,128|u>>>6&63,128|63&u));return h}function C(m){for(var u=Array(m.length>>2),l=0;l<u.length;l++)u[l]=0;for(l=0;l<8*m.length;l+=8)u[l>>5]|=(255&m.charCodeAt(l/8))<<24-l%32;return u}function p(m){for(var u="",l=0;l<32*m.length;l+=8)u+=String.fromCharCode(m[l>>5]>>>24-l%32&255);return u}function g(m,u){m[u>>5]|=128<<24-u%32,m[15+(u+64>>9<<4)]=u;for(var l,h=Array(80),f=1732584193,_=-271733879,P=-1732584194,I=271733878,E=-1009589776,T=0;T<m.length;T+=16){for(var O=f,L=_,v=P,w=I,F=E,R=0;R<80;R++){h[R]=R<16?m[T+R]:B(h[R-3]^h[R-8]^h[R-14]^h[R-16],1);var W=G(G(B(f,5),S(R,_,P,I)),G(G(E,h[R]),(l=R)<20?1518500249:l<40?1859775393:l<60?-1894007588:-899497514));E=I,I=P,P=B(_,30),_=f,f=W}f=G(f,O),_=G(_,L),P=G(P,v),I=G(I,w),E=G(E,F)}return Array(f,_,P,I,E)}function S(m,u,l,h){return m<20?u&l|~u&h:m<40?u^l^h:m<60?u&l|u&h|l&h:u^l^h}function G(m,u){var l=(65535&m)+(65535&u);return(m>>16)+(u>>16)+(l>>16)<<16|65535&l}function B(m,u){return m<<u|m>>>32-u}e.hex_sha1=t,e.b64_sha1=function(m){return d(n(A(m)))},e.any_sha1=function(m,u){return c(n(A(m)),u)},e.hex_hmac_sha1=function(m,u){return i(r(A(m),A(u)))},e.b64_hmac_sha1=function(m,u){return d(r(A(m),A(u)))},e.any_hmac_sha1=function(m,u,l){return c(r(A(m),A(u)),l)}}(a||(a={})),function(e){var s=function(){function o(){}return o.formatDate=function(t){var n=t.getFullYear(),r=t.getMonth()+1,i=r<10?"0"+r:r+"",d=t.getDate();return n+"-"+i+"-"+(d<10?"0"+d:d+"")},o}();e.TimeUtil=s}(a||(a={}))});N()})()})()})()})();})();
