(()=>{(function(){(function(){(function(){(function(){var W=function(O,S){return function(){return S||O((S={exports:{}}).exports,S),S.exports}},U=W(function(O){var S,v=O&&O.__extends||function(){var l=function(p,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var a in t)t.hasOwnProperty(a)&&(r[a]=t[a])})(p,e)};return function(p,e){function r(){this.constructor=p}l(p,e),p.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),M=O&&O.__awaiter||function(l,p,e,r){return new(e||(e=Promise))(function(t,a){function o(u){try{i(r.next(u))}catch(s){a(s)}}function n(u){try{i(r.throw(u))}catch(s){a(s)}}function i(u){u.done?t(u.value):new e(function(s){s(u.value)}).then(o,n)}i((r=r.apply(l,p||[])).next())})},X=O&&O.__generator||function(l,p){var e,r,t,a,o={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function n(i){return function(u){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(t=2&s[0]?r.return:s[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,s[1])).done)return t;switch(r=0,t&&(s=[2&s[0],t.value]),s[0]){case 0:case 1:t=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(t=0<(t=o.trys).length&&t[t.length-1])&&(s[0]===6||s[0]===2)){o=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){o.label=s[1];break}if(s[0]===6&&o.label<t[1]){o.label=t[1],t=s;break}if(t&&o.label<t[2]){o.label=t[2],o.ops.push(s);break}t[2]&&o.ops.pop(),o.trys.pop();continue}s=p.call(l,o)}catch(d){s=[6,d],r=0}finally{e=t=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([i,u])}}};(function(l){var p=function(){};(S||(S={})).Adapter=p})(),function(l){var p=function(){function e(){this.isLoadingUserInfo=!1,this.mUserCallback=[]}return e.prototype.init=function(r,t,a){},e.prototype.exitGame=function(r){r&&r(!0)},e.prototype.networkRequest=function(r){r.checkAuthorization==null&&(r.checkAuthorization=!0),l.WXHelper.networkRequest({url:r.url,data:r.data,header:r.header,method:r.method,dataType:r.checkAuthorization?"string":r.dataType,callback:function(t,a,o,n){if(t&&r.checkAuthorization){if(!n||!n.Authorization&&!n.authorization)return l.Platform.error("AdapterWX networkRequest, fail: Authorization is empty."),void r.callback(!1,a);var i="";if(l.CloudUtil.sPlayerInfo&&l.CloudUtil.sPlayerInfo.token?i=l.CloudUtil.sPlayerInfo.token:a&&a.result&&a.result.token&&r.url===l.CloudUtil.REGISTER_WX&&(i=a.result.token),i){if("CMCM "+l.hex_hmac_sha1(i,a)!==(n.Authorization?n.Authorization:n.authorization))return l.Platform.error("AdapterWX networkRequest, fail: Invalid authorization."),void r.callback(!1,a)}else l.Platform.warn("AdapterWX networkRequest, Local token is empty, this time skip verification.");l.Platform.log("AdapterWX networkRequest, The authorization is right.")}if(r.checkAuthorization&&r.dataType=="json"&&a)try{r.callback(t,JSON.parse(a))}catch(u){r.callback(t,a)}else r.callback(t,a)}})},e.prototype.reportScore=function(r,t,a,o,n){n===void 0&&(n=!1);var i={rankName:r,scoreValue:t,scoreData:a,isWeekRank:n,currentServerTime:l.CloudUtil.getCurrentServerTime()};l.WXHelper.postMessageToOpenData(l.WXHelper.MSG_REPORT_SCORE,i)},e.prototype.queryFriendsScore=function(r,t,a){a===void 0&&(a=!1)},e.prototype.saveWorldRank=function(r,t,a,o,n){n===void 0&&(n=!1),r=l.platform.getRankName(r,n),l.CloudStorageWXUtil.saveWorldRank(r,t,a,o)},e.prototype.queryWorldRank=function(r,t,a){a===void 0&&(a=!1),r=l.platform.getRankName(r,a),l.CloudStorageWXUtil.queryWorldRank(r,t)},e.prototype.queryTopWorldRank=function(r,t,a){a===void 0&&(a=!1),r=l.platform.getRankName(r,a),l.CloudStorageWXUtil.queryTopWorldRank(r,t)},e.prototype.queryShare=function(r){l.CloudUtil.queryShare(l.CloudUtil.SHARE_QUERY_WX,r)},e.prototype.reportShare=function(r,t,a,o){a===void 0&&(a=5),o===void 0&&(o=5),l.CloudUtil.reportShare(l.CloudUtil.SHARE_REPORT_WX,r,t,!0,a,o)},e.prototype.reportShareCompetition=function(r,t,a,o,n){a===void 0&&(a=3),o===void 0&&(o=99),n===void 0&&(n="2200"),l.CloudUtil.reportShare(l.CloudUtil.SHARE_REPORT_COMPETITION_WX,r,t,!0,a,o,n)},e.prototype.queryShareCompetition=function(r,t){l.CloudUtil.queryShare(l.CloudUtil.SHARE_QUERY_COMPETITION_WX,r,!0,t)},e.prototype.reportShareSkin=function(r,t,a,o){a===void 0&&(a=5),o===void 0&&(o=99),l.CloudUtil.reportShare(l.CloudUtil.SHARE_SKIN_REPORT_WX,r,t,!0,a,o)},e.prototype.queryShareSkin=function(r){l.CloudUtil.queryShare(l.CloudUtil.SHARE_SKIN_QUERY_WX,r)},e.prototype.reportShareHdReport=function(r,t,a,o,n){l.CloudUtil.reportShareHdReport(l.CloudUtil.SHARE_HD_REPORT_WX,r,t,n,!0,a,o)},e.prototype.shareHdQuery=function(r,t){l.CloudUtil.shareHdQuery(l.CloudUtil.SHARE_HD_QUERY_WX,r,t)},e.prototype.shareQueryBatch=function(r,t){l.CloudUtil.shareHdQueryBatch(l.CloudUtil.SHARE_HD_QUERY_WX_BATCH,r,t)},e.prototype.addItems=function(r,t){l.CloudUtil.addItems(l.CloudUtil.ASSET_ITEM_ADD,r,t)},e.prototype.queryItems=function(r){l.CloudUtil.queryItems(l.CloudUtil.ASSET_ITEM_QUERY,r)},e.prototype.applyGive=function(r,t){l.CloudUtil.applyGive(l.CloudUtil.REPACKAGE_APPLY_WX,r,t)},e.prototype.queryGive=function(r,t){l.CloudUtil.queryGive(l.CloudUtil.REPACKAGE_QUERY_WX,r,t)},e.prototype.acceptGive=function(r,t){l.CloudUtil.acceptGive(l.CloudUtil.REPACKAGE_ACCEPT_WX,r,t)},e.prototype.cancelGive=function(r,t){l.CloudUtil.cancelGive(l.CloudUtil.REPACKAGE_CANCEL_WX,r,t)},e.prototype.applyDemand=function(r,t){l.CloudUtil.applyDemand(l.CloudUtil.BILL_APPLY_WX,r,t)},e.prototype.queryDemand=function(r,t){l.CloudUtil.queryDemand(l.CloudUtil.BILL_QUERY_WX,r,t)},e.prototype.satisfyDemand=function(r,t){l.CloudUtil.satisfyDemand(l.CloudUtil.BILL_SATISFY_WX,r,t)},e.prototype.cancelDemand=function(r,t){l.CloudUtil.cancelDemand(l.CloudUtil.BILL_CANCEL_WX,r,t)},e.prototype.queryMusicPeopleNums=function(r,t){l.CloudUtil.queryMusicPeopleNums(l.CloudUtil.QUERY_MUSIC_PEOPLE_NUM_WX,r,t)},e.prototype.pushCommonMessage=function(r,t,a,o){l.CloudUtil.pushCommonMessage(r,{cancel:!1},t,a,o)},e.prototype.saveChallengeRank=function(r,t,a,o,n){l.CloudUtil.saveChallengeRank(l.CloudUtil.RANK_SAVE_WX,r,t,a,o,n)},e.prototype.queryChallengeSelf=function(r,t){l.CloudUtil.queryChallengeSelf(l.CloudUtil.RANK_QUERY_WX,r,t)},e.prototype.queryChallengeTop=function(r,t,a){l.CloudUtil.queryChallengeTop(l.CloudUtil.RANK_QUERY_TOP_WX,r,t,a)},e.prototype.queryChallengeTopSelf=function(r,t,a){l.CloudUtil.queryChallengeTopSelf(l.CloudUtil.RANK_QUERY_TOP_SELF_WX,r,t,a)},e.prototype.queryChallengeScore=function(r,t,a,o){l.CloudUtil.queryChallengeScore(l.CloudUtil.RANK_QUERY_SCORE_WX,r,t,a,o)},e.prototype.queryChallengeInfo=function(r,t){l.CloudUtil.queryChallengeInfo(l.CloudUtil.RANK_QUERY_INFO_WX,r,t)},e.prototype.checkInBlackList=function(r){l.CloudUtil.checkInBlackList(l.CloudUtil.CHALLENGE_COMPETITION_BLACK_LIST,r,!0)},e.prototype.queryChallengeSelfRecord=function(r,t,a,o,n){l.CloudUtil.queryChallengeSelfRecord(l.CloudUtil.RANK_QUERY_SELF_RECORD,r,t,a,o,n)},e.prototype.queryChallengeOtherRecord=function(r,t,a,o,n,i){l.CloudUtil.queryChallengeOtherRecord(l.CloudUtil.RANK_QUERY_OTHER_RECORD,r,t,a,o,n,i)},e.prototype.queryCooperationScore=function(r,t){l.CloudUtil.queryCooperationScore(l.CloudUtil.COOPERATION_QUERY_SCORE,r,t)},e.prototype.queryInvitationCode=function(r,t){l.CloudUtil.queryInvitationCode(l.CloudUtil.INVITATION_CODE,r,t)},e.prototype.getServerUserInfo=function(r){l.CloudUtil.getServerUserInfo(l.CloudUtil.USER_INFO_GET_WX,r)},e.prototype.uploadFile=function(r,t){t(-1,"")},e.prototype.queryUserInfoLevel=function(r,t){l.CloudUtil.queryUserInfoLevel(l.CloudUtil.QUERY_USER_INFO_LEVEL,r,t)},e.prototype.uploadPlayerFriends=function(r,t){},e}();l.AdapterWX=p}(S||(S={})),function(l){var p=function(e){function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.APPID="",t.DebugMode=!1,t}return v(r,e),r.prototype.init=function(t,a,o){this.APPID=t,this.DebugMode=o,this.DebugMode||l.CloudUtil.useFBServer()},r.prototype.networkRequest=function(t){l.Platform.log("NetworkUtils requestFB(platform), parameter:"+t.url);var a=new XMLHttpRequest;for(var o in a.open(t.method,t.url),t.header)a.setRequestHeader(o,t.header[o]);a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200)if(l.Platform.log("NetworkUtils requestFB(platform), success:"+a.responseText),t.dataType=="json")try{t.callback(!0,JSON.parse(a.responseText))}catch(n){t.callback(!0,a.responseText)}else t.callback(!0,a.responseText);else l.Platform.log("NetworkUtils requestFB(platform), fail:"+a.responseText),t.callback(!1,a.responseText)},a.send(JSON.stringify(t.data))},r.prototype.uploadPlayerFriends=function(t,a){l.CloudUtil.uploadPlayerFriends(l.CloudUtil.UPLOAD_PLAYER_FRINEDS_FB,t,a)},r}(l.AdapterWX);l.AdapterFB=p}(S||(S={})),function(l){var p=function(e){function r(){var t=e.call(this)||this;return l.CloudUtil.SERVER_ADDRESS_FB="http://10.12.32.113:8080/warty/",t}return v(r,e),r.prototype.queryFriendsScore=function(t,a){l.Platform.log("queryFriendsScore  rankName:   "+t);var o=new Array;if(o.push("4214be78-5713-5f63-9a7e-test111111"),o.push("4214be78-5713-5f63-9a7e-test22222222"),o.push("4214be78-5713-5f63-9a7e-test33333333"),o&&o.length!=0){for(var n=[],i=0;i<o.length;i++)n.push(o[i]);l.CloudStorageFBUtil.queryFriendsScore(t,n,a)}},r}(l.AdapterFB);l.AdapterWeb=p}(S||(S={})),function(l){var p=function(e){function r(){var t=e.call(this)||this;return t.DebugMode||l.CloudUtil.useTestServer(),t}return v(r,e),r}(l.AdapterWeb);l.AdapterCMPlay=p}(S||(S={})),function(l){var p=function(e){function r(){return e!==null&&e.apply(this,arguments)||this}return v(r,e),r.prototype.init=function(t,a,o){console.warn("AdapterH5SDK::init => appId("+t+") version("+a+")"),window.H5SDK.init({wxappid:t,gameVersion:a}),e.prototype.init.call(this,t,a,o)},r.prototype.exitGame=function(t){window.H5SDK.exitMiniProgram({success:function(){t(!0)},fail:function(){t(!1)}})},r}(l.AdapterWX);l.AdapterH5SDK=p}(S||(S={})),function(l){var p=function(e){function r(){return e!==null&&e.apply(this,arguments)||this}return v(r,e),r}(l.AdapterH5SDK);l.AdapterGameHall=p}(S||(S={})),function(l){var p=function(e){function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.APPID="",t.DebugMode=!1,t}return v(r,e),r.prototype.getCloudApi=function(t){return window.getQueryStringRegion("region")=="oversea"?r.SERVER_ADDRESS_QQ_OVERSEA+t:this.DebugMode?r.TEST_SERVER_ADDRESS_QQ+t:r.SERVER_ADDRESS_QQ+t},r.prototype.init=function(t,a,o){l.Platform.log("[AdapterQQ] GameStatusInfo "+JSON.stringify(GameStatusInfo)),this.APPID=t,this.DebugMode=o},r.prototype.exitGame=function(t){t&&t(!0)},r.prototype.networkRequest=function(t){var a=new BK.HttpUtil(t.url);if(t.method&&0<t.method.length?a.setHttpMethod(t.method):a.setHttpMethod(l.CloudUtil.METHOD_POST),t.header)for(var o in t.header)a.setHttpHeader(o,t.header[o]);if(t.data){var n=new BK.Buffer(0,!1);n.writeAsString(JSON.stringify(t.data),!1),a.setHttpRawBody(n)}a.requestAsync(function(i,u){var s=i.readAsString(!0);if(u==200){if(t.callback)if(t.dataType=="json")try{t.callback(!0,JSON.parse(s))}catch(d){t.callback(!1,s)}else t.callback(!0,s)}else t.callback&&t.callback(!1,s)})},r.prototype.uploadFile=function(t,a){if(l.CloudUtil.sPlayerInfo){l.Platform.log("[AdapterQQ] uploadFile "+t);var o=BK.FileUtil.readFile(t);if(o&&0<o.length){var n={playerid:l.CloudUtil.sPlayerInfo.playerId,gameid:l.CloudUtil.GAME_ID,timestamp:new Date().getTime(),file_length:o.length,file_md5:this.calcMd5Base64(o)},i="CMCM "+l.hex_hmac_sha1(l.CloudUtil.sPlayerInfo.token,JSON.stringify(n)),u=!1,s=setTimeout(function(){u=!0,a(-1,"upload request timeout")},5e3);this.networkRequest({url:this.getCloudApi(r.UPLOAD_FILE_QQ),data:n,header:{Authorization:i},method:l.CloudUtil.METHOD_POST,dataType:"json",callback:function(d,f){if(l.Platform.log("[AdapterQQ] uploadFile "+d+", "+JSON.stringify(f)),d&&f&&f.status==0){var R=new BK.HttpUtil(f.upload_url);for(var A in R.setHttpMethod("put"),f.header_elements)R.setHttpHeader(A,f.header_elements[A]),l.Platform.log("[AdapterQQ] networkRequest head: "+A+":"+f.header_elements[A]);R.setBodyCompatible(!1),R.setHttpRawBody(o),R.requestAsync(function(C,c){l.Platform.log("[AdapterQQ] uploadFile "+c+", "+C.readAsString(!0)),u||(clearTimeout(s),c==200?a(0,f.download_url):a(c,"COS server error"))})}else u||(clearTimeout(s),a(f.status,"CM server error"))}})}else a(-18002,"Local file read error")}else a(-18002,"Local file read error")},r.prototype.calcMd5Base64=function(t){for(var a=new Uint8Array(t.length),o=0;o<a.length;++o)a[o]=t.readUint8Buffer();var n=new l.Md5;n.appendByteArray(a);var i=n.end(!0);for(l.Platform.log("[AdapterQQ] md5_hex="+l.Md5._hex(i)),a=new Uint8Array(16),o=0;o<4;o++)a[4*o+0]=255&Number(i[o]),a[4*o+1]=Number(i[o])>>8&255,a[4*o+2]=Number(i[o])>>16&255,a[4*o+3]=Number(i[o])>>24&255;var u="",s=a.length;for(o=0;o<s;o+=3)for(var d=a[o]<<16|(o+1<s?a[o+1]<<8:0)|(o+2<s?a[o+2]:0),f=0;f<4;f++)8*o+6*f>8*a.length?u+="=":u+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>>6*(3-f)&63);return l.Platform.log("[AdapterQQ] md5_b64="+u),u},r.SERVER_ADDRESS_QQ_OVERSEA="https://h5game_oversea.cmcm.com/",r.SERVER_ADDRESS_QQ="https://minigame.cmcm.com/",r.TEST_SERVER_ADDRESS_QQ="https://pianotiles-minigame.cmcm.com/",r.REGISTER_QQ="warty/auth/register/mqq",r.UPLOAD_USERR_INFO_QQ="warty/auth/userinfo/mqq",r.SET_STORAGE_QQ="warty/storage/set",r.GET_STORAGE_QQ="warty/storage/get",r.GET_STORAGE_BATCH_QQ="warty/storage/batch_get",r.DEL_STORAGE_QQ="warty/storage/del",r.SHARE_REPORT_QQ="warty/share/report",r.SHARE_QUERY_QQ="warty/share/query",r.SHARE_SKIN_REPORT_QQ="warty/share/report/skin",r.SHARE_SKIN_QUERY_QQ="warty/share/query/skin",r.GET_SERVER_TIMESTAMP_QQ="common/time",r.UPLOAD_FILE_QQ="warty/storage/request_img_upload_auth",r.SAVE_WORLD_RANK_QQ="warty/rank/save",r.QUERY_WORLD_RANK_QQ="warty/rank/query",r.QUERY_TOP_WORLD_RANK_QQ="warty/rank/query_top",r.ASSET_ITEM_ADD_QQ="warty/item/scenes_call",r.ASSET_ITEM_QUERY_QQ="warty/item/get",r.REPACKAGE_APPLY_QQ="warty/item/redpackage_apply",r.REPACKAGE_QUERY_QQ="warty/item/redpackage_query",r.REPACKAGE_ACCEPT_QQ="warty/item/redpackage_get",r.REPACKAGE_CANCEL_QQ="warty/item/redpackage_cancel",r.BILL_APPLY_QQ="warty/item/splitbill_apply",r.BILL_QUERY_QQ="warty/item/splitbill_query",r.BILL_SATISFY_QQ="warty/item/splitbill_put",r.BILL_CANCEL_QQ="warty/item/splitbill_cancel",r}(l.AdapterWX);l.AdapterQQ=p}(S||(S={})),function(l){var p=function(e){function r(){return e!==null&&e.apply(this,arguments)||this}return v(r,e),r.prototype.networkRequest=function(t){l.Platform.log("NetworkUtils AdapterQQH5 requestQQH5(platform), parameter:"+t.url);var a=new XMLHttpRequest;for(var o in a.open(t.method,t.url),t.header)a.setRequestHeader(o,t.header[o]);a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200)if(l.Platform.log("NetworkUtils AdapterQQH5 requestQQH5(platform), success:"+a.responseText),t.dataType=="json")try{t.callback(!0,JSON.parse(a.responseText))}catch(n){t.callback(!0,a.responseText)}else t.callback(!0,a.responseText);else l.Platform.log("NetworkUtils AdapterQQH5 requestQQH5(platform), fail:"+a.responseText),t.callback(!1,a.responseText)},a.send(JSON.stringify(t.data))},r}(l.AdapterQQ);l.AdapterQQH5=p}(S||(S={})),function(l){var p=function(){this.type="",this.count=0};(S||(S={})).AssetItem=p}(),function(l){var p=function(){function e(){}return e.reportScore=function(r,t,a,o,n){if(n===void 0&&(n=!0),l.CloudUtil.sPlayerInfo){var i={playerid:l.CloudUtil.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:l.CloudUtil.GAME_ID,score_value:t,rank_name:r,score_data:a},u="CMCM "+l.hex_hmac_sha1(l.CloudUtil.sPlayerInfo.token,JSON.stringify(i));l.platform.networkRequest({url:l.CloudUtil.SCORE_REPORT_FB,data:i,header:{Authorization:u},method:l.CloudUtil.METHOD_POST,dataType:"json",callback:function(s,d){l.Platform.log("reportScore "+s+", data: "+d),s&&d?o(d.status==0):n&&d&&(d.statuscode==403||d.status==1001)?(l.CloudUtil.sPlayerInfo&&(l.CloudUtil.sPlayerInfo.playerId=void 0,l.CloudUtil.sPlayerInfo.token=void 0),e.reportScore(r,t,a,o,!1)):o(!1)}})}else o(!1)},e.queryFriendsScore=function(r,t,a,o){if(o===void 0&&(o=!0),l.CloudUtil.sPlayerInfo){l.Platform.log("queryFriendsScore == "+l.CloudUtil.sPlayerInfo.playerId);var n={playerid:l.CloudUtil.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:l.CloudUtil.GAME_ID,rank_name:r,query_ids:t},i="CMCM "+l.hex_hmac_sha1(l.CloudUtil.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:l.CloudUtil.SCORE_QUERY_FB,data:n,header:{Authorization:i},method:l.CloudUtil.METHOD_POST,dataType:"json",callback:function(u,s){u&&s&&s.rank_name&&s.result?a(s.status==0,s.rank_name,s.result):o&&s&&(s.statuscode==403||s.status==1001)?(l.CloudUtil.sPlayerInfo&&(l.CloudUtil.sPlayerInfo.playerId=void 0,l.CloudUtil.sPlayerInfo.token=void 0),e.queryFriendsScore(r,t,a,!1)):a(!1,r,null)}})}else a(!1,r,null)},e.saveWorldRank=function(r,t,a,o,n){n===void 0&&(n=!0),l.CloudUtil.saveWorldRank(l.CloudUtil.SAVE_WORLD_RANK_FB,r,t,a,o,n)},e.queryWorldRank=function(r,t,a){a===void 0&&(a=!0),l.CloudUtil.queryWorldRank(l.CloudUtil.QUERY_WORLD_RANK_FB,r,t,a)},e.queryTopWorldRank=function(r,t,a){a===void 0&&(a=!0),l.CloudUtil.queryTopWorldRank(l.CloudUtil.QUERY_WORLD_RANK_FB,r,t,a)},e}();l.CloudStorageFBUtil=p}(S||(S={})),function(l){var p=function(){function e(){}return e.saveWorldRank=function(r,t,a,o,n){n===void 0&&(n=!0),l.CloudUtil.saveWorldRank(l.CloudUtil.SAVE_WORLD_RANK_WX,r,t,a,o,n)},e.queryWorldRank=function(r,t,a){a===void 0&&(a=!0),l.CloudUtil.queryWorldRank(l.CloudUtil.QUERY_WORLD_RANK_WX,r,t,a)},e.queryTopWorldRank=function(r,t,a){a===void 0&&(a=!0),l.CloudUtil.queryTopWorldRank(l.CloudUtil.QUERY_TOP_WORLD_RANK_WX,r,t,a)},e.checkInBlackList=function(r){l.CloudUtil.checkInBlackList(l.CloudUtil.CHALLENGE_COMPETITION_BLACK_LIST,r,!0)},e}();l.CloudStorageWXUtil=p}(S||(S={})),function(l){var p=function(){function e(){}return e.useTestServer=function(){e.REGISTER_WX=(e.SERVER_ADDRESS_WX=(e.SERVER_ADDRESS_BASE_WX="https://pianotiles-minigame.cmcm.com/")+"warty/")+"auth/register/wx",e.REGISTER_H5SDK=e.SERVER_ADDRESS_WX+"auth/register/h5sdk",e.REGISTER_QQHALL=e.SERVER_ADDRESS_WX+"auth/register/gamehall",e.UPLOAD_USERR_INFO_WX=e.SERVER_ADDRESS_WX+"auth/userinfo/wx",e.SET_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/set",e.GET_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/get",e.DEL_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/del",e.SHARE_REPORT_WX=e.SERVER_ADDRESS_WX+"share/report",e.SHARE_QUERY_WX=e.SERVER_ADDRESS_WX+"share/query",e.SHARE_REPORT_COMPETITION_WX=e.SHARE_REPORT_WX+"/competition",e.SHARE_QUERY_COMPETITION_WX=e.SHARE_QUERY_WX+"/competition",e.SHARE_SKIN_REPORT_WX=e.SERVER_ADDRESS_WX+"share/report/skin",e.SHARE_SKIN_QUERY_WX=e.SERVER_ADDRESS_WX+"share/query/skin",e.SAVE_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/save",e.QUERY_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/query",e.QUERY_TOP_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/query_top",e.GET_SERVER_TIMESTAMP_WX=e.SERVER_ADDRESS_BASE_WX+"common/time",e.SHARE_HD_QUERY_WX=e.SERVER_ADDRESS_WX+"share/hd_query",e.SHARE_HD_QUERY_WX_BATCH=e.SERVER_ADDRESS_WX+"share/hd_query_batch",e.SHARE_HD_REPORT_WX=e.SERVER_ADDRESS_WX+"share/hd_report",e.QUERY_MUSIC_PEOPLE_NUM_WX=e.SERVER_ADDRESS_WX+"activity/query_info",e.RANK_SAVE_WX=e.SERVER_ADDRESS_WX+"rank/save",e.RANK_QUERY_WX=e.SERVER_ADDRESS_WX+"rank/query",e.RANK_QUERY_TOP_WX=e.SERVER_ADDRESS_WX+"rank/query_top",e.RANK_QUERY_TOP_SELF_WX=e.SERVER_ADDRESS_WX+"rank/query_top_self",e.RANK_QUERY_SCORE_WX=e.SERVER_ADDRESS_WX+"rank/query_score",e.RANK_QUERY_INFO_WX=e.SERVER_ADDRESS_WX+"rank/info",e.RANK_QUERY_SELF_RECORD=e.SERVER_ADDRESS_WX+"score/personal_record",e.RANK_QUERY_OTHER_RECORD=e.SERVER_ADDRESS_WX+"score/personal_record_query",e.COOPERATION_QUERY_SCORE=e.SERVER_ADDRESS_WX+"score/cooperation",e.CHALLENGE_COMPETITION_BLACK_LIST=e.SERVER_ADDRESS_WX+"blacklist/query",e.INVITATION_CODE=e.SERVER_ADDRESS_WX+"cooperation/invitation_code",e.USER_INFO_GET_WX=e.SERVER_ADDRESS_WX+"userinfo/get",e.QUERY_USER_INFO_LEVEL=e.SERVER_ADDRESS_WX+"userinfo/get_paino",e.UPLOAD_PLAYER_FRINEDS_FB=e.SERVER_ADDRESS_WX+"friend/report_relation"},e.useFBServer=function(){e.REGISTER_WX=(e.SERVER_ADDRESS_WX=(e.SERVER_ADDRESS_BASE_WX="https://pianotiles-fbgame.cmcm.com/")+"warty/")+"auth/register/wx",e.REGISTER_H5SDK=e.SERVER_ADDRESS_WX+"auth/register/h5sdk",e.REGISTER_QQHALL=e.SERVER_ADDRESS_WX+"auth/register/gamehall",e.UPLOAD_USERR_INFO_WX=e.SERVER_ADDRESS_WX+"auth/userinfo/wx",e.SET_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/set",e.GET_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/get",e.DEL_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/del",e.SHARE_REPORT_WX=e.SERVER_ADDRESS_WX+"share/report",e.SHARE_QUERY_WX=e.SERVER_ADDRESS_WX+"share/query",e.SHARE_REPORT_COMPETITION_WX=e.SHARE_REPORT_WX+"/competition",e.SHARE_QUERY_COMPETITION_WX=e.SHARE_QUERY_WX+"/competition",e.SHARE_SKIN_REPORT_WX=e.SERVER_ADDRESS_WX+"share/report/skin",e.SHARE_SKIN_QUERY_WX=e.SERVER_ADDRESS_WX+"share/query/skin",e.SAVE_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/save",e.QUERY_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/query",e.QUERY_TOP_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/query_top",e.GET_SERVER_TIMESTAMP_WX=e.SERVER_ADDRESS_BASE_WX+"common/time",e.SHARE_HD_QUERY_WX=e.SERVER_ADDRESS_WX+"share/hd_query",e.SHARE_HD_QUERY_WX_BATCH=e.SERVER_ADDRESS_WX+"share/hd_query_batch",e.SHARE_HD_REPORT_WX=e.SERVER_ADDRESS_WX+"share/hd_report",e.QUERY_MUSIC_PEOPLE_NUM_WX=e.SERVER_ADDRESS_WX+"activity/query_info",e.RANK_SAVE_WX=e.SERVER_ADDRESS_WX+"rank/save",e.RANK_QUERY_WX=e.SERVER_ADDRESS_WX+"rank/query",e.RANK_QUERY_TOP_WX=e.SERVER_ADDRESS_WX+"rank/query_top",e.RANK_QUERY_TOP_SELF_WX=e.SERVER_ADDRESS_WX+"rank/query_top_self",e.RANK_QUERY_SCORE_WX=e.SERVER_ADDRESS_WX+"rank/query_score",e.RANK_QUERY_INFO_WX=e.SERVER_ADDRESS_WX+"rank/info",e.RANK_QUERY_SELF_RECORD=e.SERVER_ADDRESS_WX+"score/personal_record",e.RANK_QUERY_OTHER_RECORD=e.SERVER_ADDRESS_WX+"score/personal_record_query",e.COOPERATION_QUERY_SCORE=e.SERVER_ADDRESS_WX+"score/cooperation",e.CHALLENGE_COMPETITION_BLACK_LIST=e.SERVER_ADDRESS_WX+"blacklist/query",e.INVITATION_CODE=e.SERVER_ADDRESS_WX+"cooperation/invitation_code",e.USER_INFO_GET_WX=e.SERVER_ADDRESS_WX+"userinfo/get",e.QUERY_USER_INFO_LEVEL=e.SERVER_ADDRESS_WX+"userinfo/get_paino",e.UPLOAD_PLAYER_FRINEDS_FB=e.SERVER_ADDRESS_WX+"friend/report_relation"},e.getCurrentServerTime=function(){var r=new Date().getTime()-e.sTimeDifference;return l.Platform.log("getServerTime:"+r),r},e.getYearWeekIndex=function(r){var t=new Date(r),a=new Date(t.getFullYear(),0,1),o=a.getDay(),n=1;o!=0&&(n=7-o+1),a=new Date(t.getFullYear(),0,1+n);var i=Math.ceil((t.valueOf()-a.valueOf())/864e5);return Math.ceil(i/7)+1},e.saveWorldRank=function(r,t,a,o,n,i){if(i===void 0&&(i=!0),e.sPlayerInfo){var u={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,score_value:a,rank_name:t,score_data:o},s="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(u));l.platform.networkRequest({url:r,data:u,header:{Authorization:s},method:e.METHOD_POST,dataType:"json",callback:function(d,f){n(!(!d||!f)&&f.status==0)}})}else n(!1)},e.queryWorldRank=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,rank_name:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s?a(s.status==0,s.top_rank,s.whole_rank,s.score_value,s.score_data):a(!1,0,0,0,null)}})}else a(!1,0,0,0,null)},e.queryTopWorldRank=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,rank_name:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s&&s.rank_list?a(s.status==0,s.rank_list):a(!1,null)}})}else a(!1,null)},e.reportShare=function(r,t,a,o,n,i,u){if(o===void 0&&(o=!0),n===void 0&&(n=5),i===void 0&&(i=5),u===void 0&&(u="0600"),e.sPlayerInfo){var s={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,inviter_playerid:t,max_inviter_count:n,max_invitee_count:i,share_refresh_hour:u},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){if(f&&R){var A=R.valid,C=R.info,c=R.count,_=R.inviter_nickname,E=R.inviter_avatar_url;a(R.status==0,A,C,c,_,E)}else a(!1,!1,"server status error"+R.statuscode,0,"","")}})}else a(!1,!1,"not playerID",0,"","")},e.queryShare=function(r,t,a,o){if(a===void 0&&(a=!0),o===void 0&&(o="0600"),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,share_refresh_hour:o},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s&&s.invitee_list?t(s.status==0,s.invitee_date,s.invitee_list):t(!1,"",null)}})}else t(!1,"",null)},e.addItems=function(r,t,a,o){if(o===void 0&&(o=!0),t&&t.length!=0)if(e.sPlayerInfo){for(var n={},i=0;i<t.length;i++){var u=t[i];n[u.type]=u.count}var s={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,affect_items:n},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){f&&R&&R.invitee_list?a(R.status==0,R.message,R.timestamp):a(!1,"",null)}})}else a(!1,"",null);else a(!1,"affectItems is null or size=0",null)},e.queryItems=function(r,t,a){if(a===void 0&&(a=!0),e.sPlayerInfo){var o={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID},n="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(o));l.platform.networkRequest({url:r,data:o,header:{Authorization:n},method:e.METHOD_POST,dataType:"json",callback:function(i,u){i&&u&&u.invitee_list?t(u.status==0,u.message,u.timestamp,u.items):t(!1,"",null,null)}})}else t(!1,"",null,null)},e.applyGive=function(r,t,a,o){if(o===void 0&&(o=!0),t&&t.length!=0)if(e.sPlayerInfo){for(var n={},i=0;i<t.length;i++){var u=t[i];n[u.type]=u.count}var s={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,items:n,category:0,number:1},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){if(f&&R){var A=R.message,C=R.timestamp,c=R.redpackage_id;a(R.status==0,A,C,c)}else a(!1,"server status error, statuscode="+R.statuscode,"0","")}})}else a(!1,"no playerInfo","0","");else a(!1,"affectItems is null or size=0",null,null)},e.queryGive=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,redpackage_id:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){if(u&&s){var d=s.message,f=s.timestamp,R=s.receivers;a(s.status==0,d,f,R)}else a(!1,"server status error, statuscode="+s.statuscode,"0",[])}})}else a(!1,"no playerInfo","0",[])},e.acceptGive=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,redpackage_id:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){if(u&&s){var d=s.message,f=s.timestamp;a(s.status==0,d,f,s.receive_items)}else a(!1,"server status error, statuscode="+s.statuscode,"0",null)}})}else a(!1,"no playerInfo","0",null)},e.cancelGive=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,redpackage_id:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){if(u&&s){var d=s.message,f=s.timestamp;a(s.status==0,d,f)}else a(!1,"server status error, statuscode="+s.statuscode,"0")}})}else a(!1,"no playerInfo","0")},e.applyDemand=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){for(var n={},i=0;i<t.length;i++){var u=t[i];n[u.type]=u.count}var s={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,items:n,number:1},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){if(f&&R){var A=R.message,C=R.timestamp;a(R.status==0,A,C,R.splitbill_id)}else a(!1,"server status error, statuscode="+R.statuscode,"0",null)}})}else a(!1,"no playerInfo","0",null)},e.queryDemand=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,splitbill_id:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){if(u&&s){var d=s.message,f=s.timestamp,R=s.presenters;a(s.status==0,d,f,R)}else a(!1,"server status error, statuscode="+s.statuscode,"0",[])}})}else a(!1,"no playerInfo","0",[])},e.satisfyDemand=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,splitbill_id:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){if(u&&s){var d=s.message,f=s.timestamp;a(s.status==0,d,f)}else a(!1,"server status error, statuscode="+s.statuscode,"0")}})}else a(!1,"no playerInfo","0")},e.cancelDemand=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,splitbill_id:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){if(u&&s){var d=s.message,f=s.timestamp;a(s.status==0,d,f)}else a(!1,"server status error, statuscode="+s.statuscode,"0")}})}else a(!1,"no playerInfo","0")},e.reportShareHdReport=function(r,t,a,o,n,i,u){if(n===void 0&&(n=!0),i===void 0&&(i=5),u===void 0&&(u=5),e.sPlayerInfo){var s={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),hdid:t,inviter_playerid:a,max_inviter_count:i,max_invitee_count:u},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){f&&R?o(R.status==0,R.valid,R.info,R.count,R.inviter_nickname,R.inviter_avatar_url):o(!1,!1,"",0,"","")}})}else o(!1,!1,"not playerID",0,"","")},e.shareHdQuery=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),hdid:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s&&s.invitee_list?a(s.status==0,s.invitee_list):a(!1,null)}})}else a(!1,null)},e.shareHdQueryBatch=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),hdids:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s&&s.hd_invitee_map?a(s.status==0,s.hd_invitee_map):o&&s&&(s.statuscode==403||s.status==1001)?(e.sPlayerInfo&&(e.sPlayerInfo.playerId=void 0,e.sPlayerInfo.token=void 0),e.shareHdQueryBatch(r,t,a,!1)):a(!1,null)}})}else a(!1,!1)},e.queryMusicPeopleNums=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n=[];t.forEach(function(s){n.push(s+"")});var i={playerid:e.sPlayerInfo.playerId,timestamp:new Date().getTime(),gameid:e.GAME_ID,activity_type:"hot_tune_challenge",activity_id:n},u="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(i));l.platform.networkRequest({url:r,data:i,header:{Authorization:u},method:e.METHOD_POST,dataType:"json",callback:function(s,d){s&&d?(s=d.status==0&&d.info&&d.info.hot_tune_challenge,a(!!s,s?d.info.hot_tune_challenge:null)):a(!1,null)}})}else a(!1,null)},e.pushCommonMessage=function(r,t,a,o,n){if(e.sPlayerInfo){a.playerid=e.sPlayerInfo.playerId,a.timestamp=new Date().getTime(),a.gameid=e.GAME_ID;var i=a,u="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(i));l.platform.networkRequest({url:r,data:i,header:{Authorization:u},method:e.METHOD_POST,dataType:"json",callback:function(s,d){s&&d?n(!0,d):n(!1,null)}})}else n(!1,null)},e.saveChallengeRank=function(r,t,a,o,n,i,u){if(u===void 0&&(u=!0),e.sPlayerInfo){var s={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_name:t,score_value:a,score_data:o,sort_type:n},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){i(!(!f||!R)&&R.status==0,R)}})}else i(!1,null)},e.queryChallengeSelf=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_name:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){a(!(!u||!s)&&s.status==0,s)}})}else a(!1,null)},e.queryChallengeTop=function(r,t,a,o,n){if(n===void 0&&(n=!0),e.sPlayerInfo){var i={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_name:t,top_count:a},u="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(i));l.platform.networkRequest({url:r,data:i,header:{Authorization:u},method:e.METHOD_POST,dataType:"json",callback:function(s,d){s&&d?o(d.status==0,d):o(!1,null)}})}else o(!1,null)},e.queryChallengeTopSelf=function(r,t,a,o,n){if(n===void 0&&(n=!0),e.sPlayerInfo){var i={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_name:t,top_count:a},u="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(i));l.platform.networkRequest({url:r,data:i,header:{Authorization:u},method:e.METHOD_POST,dataType:"json",callback:function(s,d){s&&d?o(d.status==0,d):o(!1,null)}})}else o(!1,null)},e.queryChallengeScore=function(r,t,a,o,n,i){if(i===void 0&&(i=!0),e.sPlayerInfo){var u={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_name:t,top_rank_list:a,whole_percent_list:o},s="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(u));l.platform.networkRequest({url:r,data:u,header:{Authorization:s},method:e.METHOD_POST,dataType:"json",callback:function(d,f){d&&f?n(f.status==0,f):n(!1,null)}})}else n(!1,null)},e.queryChallengeInfo=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_name:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s?a(s.status==0,s):a(!1,null)}})}else a(!1,null)},e.checkInBlackList=function(r,t,a){if(e.sPlayerInfo){var o={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:this.getCurrentServerTime()},n="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(o));l.platform.networkRequest({url:r,data:o,header:{Authorization:n},method:e.METHOD_POST,dataType:"json",callback:function(i,u){i&&u&&u.data?t(u.status==0,u.data.is_black):t(!1,null)}})}else t(!1,!1)},e.queryChallengeSelfRecord=function(r,t,a,o,n,i,u){if(u===void 0&&(u=!0),e.sPlayerInfo){var s={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_counts:t,rank_percent_counts:a,begin_time:o,end_time:n},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){f&&R?i(R.status==0,R):i(!1,null)}})}else i(!1,null)},e.queryChallengeOtherRecord=function(r,t,a,o,n,i,u){if(e.sPlayerInfo){var s={playerid:e.sPlayerInfo.playerId,query_playerid:t,gameid:e.GAME_ID,timestamp:new Date().getTime(),rank_counts:a,rank_percent_counts:o,begin_time:n,end_time:i},d="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(s));l.platform.networkRequest({url:r,data:s,header:{Authorization:d},method:e.METHOD_POST,dataType:"json",callback:function(f,R){f&&R?u(R.status==0,R):u(!1,null)}})}else u(!1,null)},e.queryCooperationScore=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),function_name:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s?a(s.status==0,s):a(!1,null)}})}else a(!1,null)},e.queryInvitationCode=function(r,t,a,o){if(o===void 0&&(o=!0),e.sPlayerInfo){var n={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),invitation_code:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){s?a(u,s):a(!1,null)}})}else a(!1,null)},e.getServerUserInfo=function(r,t,a){if(a===void 0&&(a=!0),e.sPlayerInfo){var o={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:this.getCurrentServerTime()},n="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(o));l.platform.networkRequest({url:r,data:o,header:{Authorization:n},method:e.METHOD_POST,dataType:"json",callback:function(i,u){i&&u?t(u.status==0,u):t(!1,null)}})}else t(!1,!1)},e.queryUserInfoLevel=function(r,t,a){if(e.sPlayerInfo){var o={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:new Date().getTime(),query_playerid:t},n="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(o));l.platform.networkRequest({url:r,data:o,header:{Authorization:n},method:e.METHOD_POST,dataType:"json",callback:function(i,u){i&&u?a(u.status==0,u):a(!1,null)}})}else a(!1,null)},e.uploadPlayerFriends=function(r,t,a,o){o===void 0&&(o=!0);var n={playerid:e.sPlayerInfo.playerId,gameid:e.GAME_ID,timestamp:this.getCurrentServerTime(),friend_ids:t},i="CMCM "+l.hex_hmac_sha1(e.sPlayerInfo.token,JSON.stringify(n));l.platform.networkRequest({url:r,data:n,header:{Authorization:i},method:e.METHOD_POST,dataType:"json",callback:function(u,s){u&&s?a(s.status==0,s):a(!1,null)}})},e.SERVER_ADDRESS_BASE_WX="https://minigame.cmcm.com/",e.SERVER_ADDRESS_BASE_OVERSEA="https://h5game_oversea.cmcm.com/",window.getQueryStringRegion("region")=="oversea"&&(e.SERVER_ADDRESS_BASE_WX=e.SERVER_ADDRESS_BASE_OVERSEA),e.REGISTER_WX=(e.SERVER_ADDRESS_WX=e.SERVER_ADDRESS_BASE_WX+"warty/")+"auth/register/wx",e.REGISTER_H5SDK=e.SERVER_ADDRESS_WX+"auth/register/h5sdk",e.REGISTER_QQHALL=e.SERVER_ADDRESS_WX+"auth/register/gamehall",e.UPLOAD_USERR_INFO_WX=e.SERVER_ADDRESS_WX+"auth/userinfo/wx",e.SET_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/set",e.GET_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/get",e.DEL_STORAGE_WX=e.SERVER_ADDRESS_WX+"storage/del",e.SHARE_REPORT_WX=e.SERVER_ADDRESS_WX+"share/report",e.SHARE_QUERY_WX=e.SERVER_ADDRESS_WX+"share/query",e.SHARE_REPORT_COMPETITION_WX=e.SHARE_REPORT_WX+"/competition",e.SHARE_QUERY_COMPETITION_WX=e.SHARE_QUERY_WX+"/competition",e.SHARE_SKIN_REPORT_WX=e.SERVER_ADDRESS_WX+"share/report/skin",e.SHARE_SKIN_QUERY_WX=e.SERVER_ADDRESS_WX+"share/query/skin",e.SAVE_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/save",e.QUERY_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/query",e.QUERY_TOP_WORLD_RANK_WX=e.SERVER_ADDRESS_WX+"rank/query_top",e.GET_SERVER_TIMESTAMP_WX=e.SERVER_ADDRESS_BASE_WX+"common/time",e.SHARE_HD_REPORT_WX=e.SERVER_ADDRESS_WX+"share/hd_report",e.SHARE_HD_QUERY_WX=e.SERVER_ADDRESS_WX+"share/hd_query",e.SHARE_HD_QUERY_WX_BATCH=e.SERVER_ADDRESS_WX+"share/hd_query_batch",e.QUERY_MUSIC_PEOPLE_NUM_WX=e.SERVER_ADDRESS_WX+"activity/query_info",e.QUERY_USER_INFO_LEVEL=e.SERVER_ADDRESS_WX+"userinfo/get_paino",e.ASSET_ITEM_ADD=e.SERVER_ADDRESS_WX+"item/scenes_call",e.ASSET_ITEM_QUERY=e.SERVER_ADDRESS_WX+"item/get",e.REPACKAGE_APPLY_WX=e.SERVER_ADDRESS_WX+"item/redpackage_apply",e.REPACKAGE_QUERY_WX=e.SERVER_ADDRESS_WX+"item/redpackage_query",e.REPACKAGE_ACCEPT_WX=e.SERVER_ADDRESS_WX+"item/redpackage_get",e.REPACKAGE_CANCEL_WX=e.SERVER_ADDRESS_WX+"item/redpackage_cancel",e.BILL_APPLY_WX=e.SERVER_ADDRESS_WX+"item/splitbill_apply",e.BILL_QUERY_WX=e.SERVER_ADDRESS_WX+"item/splitbill_query",e.BILL_SATISFY_WX=e.SERVER_ADDRESS_WX+"item/splitbill_put",e.BILL_CANCEL_WX=e.SERVER_ADDRESS_WX+"item/splitbill_cancel",e.RANK_SAVE_WX=e.SERVER_ADDRESS_WX+"rank/save",e.RANK_QUERY_WX=e.SERVER_ADDRESS_WX+"rank/query",e.RANK_QUERY_TOP_WX=e.SERVER_ADDRESS_WX+"rank/query_top",e.RANK_QUERY_TOP_SELF_WX=e.SERVER_ADDRESS_WX+"rank/query_top_self",e.RANK_QUERY_SCORE_WX=e.SERVER_ADDRESS_WX+"rank/query_score",e.RANK_QUERY_INFO_WX=e.SERVER_ADDRESS_WX+"rank/info",e.RANK_QUERY_SELF_RECORD=e.SERVER_ADDRESS_WX+"score/personal_record",e.RANK_QUERY_OTHER_RECORD=e.SERVER_ADDRESS_WX+"score/personal_record_query",e.COOPERATION_QUERY_SCORE=e.SERVER_ADDRESS_WX+"score/cooperation",e.CHALLENGE_COMPETITION_BLACK_LIST=e.SERVER_ADDRESS_WX+"blacklist/query",e.INVITATION_CODE=e.SERVER_ADDRESS_WX+"cooperation/invitation_code",e.USER_INFO_GET_WX=e.SERVER_ADDRESS_WX+"userinfo/get",e.SERVER_ADDRESS_BASE_FB="https://instantgame.cmcm.com/",e.REGISTER_FB=(e.SERVER_ADDRESS_FB="https://instantgame.cmcm.com/warty/")+"auth/register/fb",e.SET_STORAGE_FB=e.SERVER_ADDRESS_FB+"storage/dy/set",e.GET_STORAGE_FB=e.SERVER_ADDRESS_FB+"storage/dy/get",e.DEL_STORAGE_FB=e.SERVER_ADDRESS_FB+"storage/dy/del",e.SCORE_REPORT_FB=e.SERVER_ADDRESS_FB+"score/dy/report",e.SCORE_QUERY_FB=e.SERVER_ADDRESS_FB+"score/dy/query",e.GET_SERVER_TIMESTAMP_FB=e.SERVER_ADDRESS_BASE_FB+"common/time",e.UPLOAD_PLAYER_FRINEDS_FB=e.SERVER_ADDRESS_WX+"friend/report_relation",e.SAVE_WORLD_RANK_FB=(e.SERVER_ADDRESS_WORLD_RANK_FB="http://10.12.32.113:80/warty/")+"rank/save",e.QUERY_WORLD_RANK_FB=e.SERVER_ADDRESS_WORLD_RANK_FB+"rank/query",e.QUERY_TOP_WORLD_RANK_FB=e.SERVER_ADDRESS_WORLD_RANK_FB+"rank/query_top",e.METHOD_GET="GET",e.METHOD_HEAD="HEAD",e.METHOD_POST="POST",e.METHOD_PUT="PUT",e.METHOD_DELETE="DELETE",e.METHOD_TRACE="TRACE",e.METHOD_CONNECT="CONNECT",e.sTimeDifference=0,e}();l.CloudUtil=p}(S||(S={})),function(l){var p=function(){function e(){}return e.initializeAsync=function(r){FBInstant.initializeAsync().then(function(){e.sPlayerId=FBInstant.player.getID(),r&&r(!0)},function(t){r&&r(null)})},e.shareAsync=function(r,t,a,o,n){FBInstant.shareAsync({intent:r,image:t,text:a,data:o}).then(function(){n&&n(!0)},function(i){n(!1)})},e.getFriendsPlayerInfo=function(r){r&&(l.Platform.log("FBHelper: getFriendsPlayerInfo called"),FBInstant.player.getConnectedPlayersAsync().then(function(t){l.Platform.log("FBHelper: getConnectedPlayersAsync then "+t),r(t)}).catch(function(t){l.Platform.log("FBHelper: getConnectedPlayersAsync error: "+t),l.Platform.logObject(t)}))},e}();l.FBHelper=p}(S||(S={})),function(l){var p=function(){function e(){this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return e.hashStr=function(r,t){return t===void 0&&(t=!1),this.onePassHasher.start().appendStr(r).end(t)},e.hashAsciiStr=function(r,t){return t===void 0&&(t=!1),this.onePassHasher.start().appendAsciiStr(r).end(t)},e._hex=function(r){var t,a,o,n,i=e.hexChars,u=e.hexOut;for(n=0;n<4;n+=1)for(a=8*n,t=r[n],o=0;o<8;o+=2)u[a+1+o]=i.charAt(15&t),t>>>=4,u[a+0+o]=i.charAt(15&t),t>>>=4;return u.join("")},e._md5cycle=function(r,t){var a=r[0],o=r[1],n=r[2],i=r[3];o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&n|~o&i)+t[0]-680876936|0)<<7|a>>>25)+o|0)&o|~a&n)+t[1]-389564586|0)<<12|i>>>20)+a|0)&a|~i&o)+t[2]+606105819|0)<<17|n>>>15)+i|0)&i|~n&a)+t[3]-1044525330|0)<<22|o>>>10)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&n|~o&i)+t[4]-176418897|0)<<7|a>>>25)+o|0)&o|~a&n)+t[5]+1200080426|0)<<12|i>>>20)+a|0)&a|~i&o)+t[6]-1473231341|0)<<17|n>>>15)+i|0)&i|~n&a)+t[7]-45705983|0)<<22|o>>>10)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&n|~o&i)+t[8]+1770035416|0)<<7|a>>>25)+o|0)&o|~a&n)+t[9]-1958414417|0)<<12|i>>>20)+a|0)&a|~i&o)+t[10]-42063|0)<<17|n>>>15)+i|0)&i|~n&a)+t[11]-1990404162|0)<<22|o>>>10)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&n|~o&i)+t[12]+1804603682|0)<<7|a>>>25)+o|0)&o|~a&n)+t[13]-40341101|0)<<12|i>>>20)+a|0)&a|~i&o)+t[14]-1502002290|0)<<17|n>>>15)+i|0)&i|~n&a)+t[15]+1236535329|0)<<22|o>>>10)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&i|n&~i)+t[1]-165796510|0)<<5|a>>>27)+o|0)&n|o&~n)+t[6]-1069501632|0)<<9|i>>>23)+a|0)&o|a&~o)+t[11]+643717713|0)<<14|n>>>18)+i|0)&a|i&~a)+t[0]-373897302|0)<<20|o>>>12)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&i|n&~i)+t[5]-701558691|0)<<5|a>>>27)+o|0)&n|o&~n)+t[10]+38016083|0)<<9|i>>>23)+a|0)&o|a&~o)+t[15]-660478335|0)<<14|n>>>18)+i|0)&a|i&~a)+t[4]-405537848|0)<<20|o>>>12)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&i|n&~i)+t[9]+568446438|0)<<5|a>>>27)+o|0)&n|o&~n)+t[14]-1019803690|0)<<9|i>>>23)+a|0)&o|a&~o)+t[3]-187363961|0)<<14|n>>>18)+i|0)&a|i&~a)+t[8]+1163531501|0)<<20|o>>>12)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o&i|n&~i)+t[13]-1444681467|0)<<5|a>>>27)+o|0)&n|o&~n)+t[2]-51403784|0)<<9|i>>>23)+a|0)&o|a&~o)+t[7]+1735328473|0)<<14|n>>>18)+i|0)&a|i&~a)+t[12]-1926607734|0)<<20|o>>>12)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o^n^i)+t[5]-378558|0)<<4|a>>>28)+o|0)^o^n)+t[8]-2022574463|0)<<11|i>>>21)+a|0)^a^o)+t[11]+1839030562|0)<<16|n>>>16)+i|0)^i^a)+t[14]-35309556|0)<<23|o>>>9)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o^n^i)+t[1]-1530992060|0)<<4|a>>>28)+o|0)^o^n)+t[4]+1272893353|0)<<11|i>>>21)+a|0)^a^o)+t[7]-155497632|0)<<16|n>>>16)+i|0)^i^a)+t[10]-1094730640|0)<<23|o>>>9)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o^n^i)+t[13]+681279174|0)<<4|a>>>28)+o|0)^o^n)+t[0]-358537222|0)<<11|i>>>21)+a|0)^a^o)+t[3]-722521979|0)<<16|n>>>16)+i|0)^i^a)+t[6]+76029189|0)<<23|o>>>9)+n|0,o=((o+=((n=((n+=((i=((i+=((a=((a+=(o^n^i)+t[9]-640364487|0)<<4|a>>>28)+o|0)^o^n)+t[12]-421815835|0)<<11|i>>>21)+a|0)^a^o)+t[15]+530742520|0)<<16|n>>>16)+i|0)^i^a)+t[2]-995338651|0)<<23|o>>>9)+n|0,o=((o+=((i=((i+=(o^((a=((a+=(n^(o|~i))+t[0]-198630844|0)<<6|a>>>26)+o|0)|~n))+t[7]+1126891415|0)<<10|i>>>22)+a|0)^((n=((n+=(a^(i|~o))+t[14]-1416354905|0)<<15|n>>>17)+i|0)|~a))+t[5]-57434055|0)<<21|o>>>11)+n|0,o=((o+=((i=((i+=(o^((a=((a+=(n^(o|~i))+t[12]+1700485571|0)<<6|a>>>26)+o|0)|~n))+t[3]-1894986606|0)<<10|i>>>22)+a|0)^((n=((n+=(a^(i|~o))+t[10]-1051523|0)<<15|n>>>17)+i|0)|~a))+t[1]-2054922799|0)<<21|o>>>11)+n|0,o=((o+=((i=((i+=(o^((a=((a+=(n^(o|~i))+t[8]+1873313359|0)<<6|a>>>26)+o|0)|~n))+t[15]-30611744|0)<<10|i>>>22)+a|0)^((n=((n+=(a^(i|~o))+t[6]-1560198380|0)<<15|n>>>17)+i|0)|~a))+t[13]+1309151649|0)<<21|o>>>11)+n|0,o=((o+=((i=((i+=(o^((a=((a+=(n^(o|~i))+t[4]-145523070|0)<<6|a>>>26)+o|0)|~n))+t[11]-1120210379|0)<<10|i>>>22)+a|0)^((n=((n+=(a^(i|~o))+t[2]+718787259|0)<<15|n>>>17)+i|0)|~a))+t[9]-343485551|0)<<21|o>>>11)+n|0,r[0]=a+r[0]|0,r[1]=o+r[1]|0,r[2]=n+r[2]|0,r[3]=i+r[3]|0},e.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(e.stateIdentity),this},e.prototype.appendStr=function(r){var t,a,o=this._buffer8,n=this._buffer32,i=this._bufferLength;for(a=0;a<r.length;a+=1){if((t=r.charCodeAt(a))<128)o[i++]=t;else if(t<2048)o[i++]=192+(t>>>6),o[i++]=63&t|128;else if(t<55296||56319<t)o[i++]=224+(t>>>12),o[i++]=t>>>6&63|128,o[i++]=63&t|128;else{if(1114111<(t=1024*(t-55296)+(r.charCodeAt(++a)-56320)+65536))throw new Error("Unicode standard supports code points up to U+10FFFF");o[i++]=240+(t>>>18),o[i++]=t>>>12&63|128,o[i++]=t>>>6&63|128,o[i++]=63&t|128}64<=i&&(this._dataLength+=64,e._md5cycle(this._state,n),i-=64,n[0]=n[16])}return this._bufferLength=i,this},e.prototype.appendAsciiStr=function(r){for(var t,a=this._buffer8,o=this._buffer32,n=this._bufferLength,i=0;;){for(t=Math.min(r.length-i,64-n);t--;)a[n++]=r.charCodeAt(i++);if(n<64)break;this._dataLength+=64,e._md5cycle(this._state,o),n=0}return this._bufferLength=n,this},e.prototype.appendByteArray=function(r){for(var t,a=this._buffer8,o=this._buffer32,n=this._bufferLength,i=0;;){for(t=Math.min(r.length-i,64-n);t--;)a[n++]=r[i++];if(n<64)break;this._dataLength+=64,e._md5cycle(this._state,o),n=0}return this._bufferLength=n,this},e.prototype.getState=function(){var r=this._state;return{buffer:String.fromCharCode.apply(null,this._buffer8),buflen:this._bufferLength,length:this._dataLength,state:[r[0],r[1],r[2],r[3]]}},e.prototype.setState=function(r){var t,a=r.buffer,o=r.state,n=this._state;for(this._dataLength=r.length,this._bufferLength=r.buflen,n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],t=0;t<a.length;t+=1)this._buffer8[t]=a.charCodeAt(t)},e.prototype.end=function(r){r===void 0&&(r=!1);var t,a=this._bufferLength,o=this._buffer8,n=this._buffer32,i=1+(a>>2);if(this._dataLength+=a,o[a]=128,o[a+1]=o[a+2]=o[a+3]=0,n.set(e.buffer32Identity.subarray(i),i),55<a&&(e._md5cycle(this._state,n),n.set(e.buffer32Identity)),(t=8*this._dataLength)<=4294967295)n[14]=t;else{var u=t.toString(16).match(/(.*?)(.{0,8})$/);if(u===null)return;var s=parseInt(u[2],16),d=parseInt(u[1],16)||0;n[14]=s,n[15]=d}return e._md5cycle(this._state,n),r?this._state:e._hex(this._state)},e.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),e.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.hexChars="0123456789abcdef",e.hexOut=[],e.onePassHasher=new e,e}();(l.Md5=p).hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592"&&console.error("Md5 self test failed.")}(S||(S={})),function(l){var p=function(){function e(){this.isUseLocalTime=!1}return e.toJsonString=function(r){if(r==null||r==null)return"";try{return JSON.stringify(r)}catch(t){return""}},e.log=function(r){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e.isPrintLog&&(cc.sys.platform===cc.sys.QQ_PLAY?BK.Script.log(1,1,"[qqplay_release_log]  msg: "+r+" subst: "+this.toJsonString(t)):console.log(r,t))},e.warn=function(r){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e.isPrintLog&&(cc.sys.platform===cc.sys.QQ_PLAY?BK.Script.log(1,1,"[qqplay_release_log]  msg: "+r+" subst: "+this.toJsonString(t)):console.warn(r,t))},e.error=function(r){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e.isPrintLog&&(cc.sys.platform===cc.sys.QQ_PLAY?BK.Script.log(1,1,"[qqplay_release_log]  msg: "+r+" subst: "+this.toJsonString(t)):console.error(r,t))},e.printCallStack=function(){for(var r=0,t=arguments.callee;t=t.arguments.callee.caller,console.log(++r+": "+t),t;);},e.logObject=function(r){var t="";for(var a in r)t+=a+":"+r[a]+";   ";e.log(t)},e.doWait=function(r){return M(this,void 0,void 0,function(){return X(this,function(t){return[2,new Promise(function(a,o){setTimeout(function(){a()},r)})]})})},e.prototype.init=function(r,t,a,o,n,i,u){u&&(l.CloudUtil.useTestServer(),e.isPrintLog=!0),e.log("Platform::init appId("+r+") version("+t+") gameId("+a+") platform("+l.platform+")"),l.CloudUtil.GAME_ID=a,l.CloudUtil.sPlayerInfo=new l.PlayerInfo,l.CloudUtil.sPlayerInfo.playerId=n,l.CloudUtil.sPlayerInfo.token=i,e.mPlatformType=o,this.mAdapter=e.createAdapter(o),this.mAdapter.init(r,t,u)},e.prototype.exitGame=function(r){e.log("Platform::exitGame"),this.mAdapter&&this.mAdapter.exitGame(r)},e.prototype.networkRequest=function(r){if(this.mAdapter)return this.mAdapter.networkRequest(r);r.callback&&r.callback(!1,null)},e.prototype.reportScore=function(r,t,a,o,n){n===void 0&&(n=!1),this.mAdapter?this.mAdapter.reportScore(r,t,a,o,n):o&&o(!1)},e.prototype.queryFriendsScore=function(r,t,a){a===void 0&&(a=!1),this.mAdapter?this.mAdapter.queryFriendsScore(r,t,a):t&&t(!1,r,null)},e.prototype.saveWorldRank=function(r,t,a,o,n){n===void 0&&(n=!1),this.mAdapter?this.mAdapter.saveWorldRank(r,t,a,o,n):o&&o(!1)},e.prototype.queryWorldRank=function(r,t,a){a===void 0&&(a=!1),this.mAdapter?this.mAdapter.queryWorldRank(r,t,a):t&&t(!1,0,0,0,null)},e.prototype.queryTopWorldRank=function(r,t,a){a===void 0&&(a=!1),this.mAdapter?this.mAdapter.queryTopWorldRank(r,t,a):t&&t(!1,null)},e.prototype.getRankName=function(r,t){if(t){var a=l.CloudUtil.getCurrentServerTime();e.log("[cmg]getRankName, currentServerTime\uFF1A"+a);var o=new Date(a).getFullYear().toString(),n=l.CloudUtil.getYearWeekIndex(a);o.length==4&&(o=o.substr(2,2)),r="weekly_"+r+"_"+o+"_"+n.toString()}else r="ever_"+r;return e.log("[cmg]getRankName,rankName:"+r),r.toLocaleLowerCase()},e.prototype.reportShare=function(r,t,a,o){a===void 0&&(a=5),o===void 0&&(o=99),this.mAdapter?this.mAdapter.reportShare(r,t,a,o):t&&t(!1,!1,"adapter is null",0,"","")},e.prototype.queryShare=function(r){this.mAdapter?this.mAdapter.queryShare(r):r&&r(!1,"",null)},e.prototype.reportShareCompetition=function(r,t,a,o,n){a===void 0&&(a=3),o===void 0&&(o=99),n===void 0&&(n="2200"),this.mAdapter?this.mAdapter.reportShareCompetition(r,t,a,o,n):t&&t(!1,!1,"adapter is null",0,"","")},e.prototype.queryShareCompetition=function(r,t){t===void 0&&(t="2200"),this.mAdapter?this.mAdapter.queryShareCompetition(r,t):r&&r(!1,"",null)},e.prototype.reportShareSkin=function(r,t,a,o){this.mAdapter?this.mAdapter.reportShareSkin(r,t,a,o):t&&t(!1,!1,"adapter is null",0,"","")},e.prototype.queryShareSkin=function(r){this.mAdapter?this.mAdapter.queryShareSkin(r):r&&r(!1,"",null)},e.prototype.reportShareHdReport=function(r,t,a,o,n){this.mAdapter?this.mAdapter.reportShareHdReport(r,t,a,o,n):n&&n(!1,!1,"adapter is null",0,"","")},e.prototype.shareHdQuery=function(r,t){this.mAdapter?this.mAdapter.shareHdQuery(r,t):t&&t(!1,null)},e.prototype.shareQueryBatch=function(r,t){this.mAdapter?this.mAdapter.shareQueryBatch(r,t):t&&t(!1,null)},e.prototype.queryMusicPeopleNums=function(r,t){this.mAdapter?this.mAdapter.queryMusicPeopleNums(r,t):t&&t(!1,null)},e.prototype.addItems=function(r,t){this.mAdapter.addItems(r,t)},e.prototype.queryItems=function(r){this.mAdapter.queryItems(r)},e.prototype.applyGive=function(r,t){this.mAdapter.applyGive(r,t)},e.prototype.queryGive=function(r,t){this.mAdapter.queryGive(r,t)},e.prototype.acceptGive=function(r,t){this.mAdapter.acceptGive(r,t)},e.prototype.cancelGive=function(r,t){this.mAdapter.cancelGive(r,t)},e.prototype.applyDemand=function(r,t){this.mAdapter.applyDemand(r,t)},e.prototype.queryDemand=function(r,t){this.mAdapter.queryDemand(r,t)},e.prototype.satisfyDemand=function(r,t){this.mAdapter.satisfyDemand(r,t)},e.prototype.cancelDemand=function(r,t){this.mAdapter.cancelDemand(r,t)},e.prototype.pushCommonMessage=function(r,t,a,o){return this.mAdapter?this.mAdapter.pushCommonMessage(r,t,a,o):(o&&o(!1,null),null)},e.prototype.saveChallengeRank=function(r,t,a,o,n){this.mAdapter.saveChallengeRank(r,t,a,o,n)},e.prototype.queryChallengeSelf=function(r,t){this.mAdapter.queryChallengeSelf(r,t)},e.prototype.queryChallengeTop=function(r,t,a){this.mAdapter.queryChallengeTop(r,t,a)},e.prototype.queryChallengeTopSelf=function(r,t,a){this.mAdapter.queryChallengeTopSelf(r,t,a)},e.prototype.queryChallengeScore=function(r,t,a,o){this.mAdapter.queryChallengeScore(r,t,a,o)},e.prototype.queryChallengeInfo=function(r,t){this.mAdapter.queryChallengeInfo(r,t)},e.prototype.checkInBlackList=function(r){this.mAdapter.checkInBlackList(r)},e.createAdapter=function(r){switch(r){case e.PLATFORM_WECHAT:return new l.AdapterWX;case e.PLATFORM_FACEBOOK:return new l.AdapterFB;case e.PLATFORM_H5SDK:return new l.AdapterH5SDK;case e.PLATFORM_QQPLAY:return new l.AdapterQQ;case e.PLATFORM_QQHALL:return new l.AdapterGameHall;case e.PLATFORM_QQPLAY_H5:return new l.AdapterQQH5;case e.PLATFORM_CMPLAY:return new l.AdapterCMPlay;default:return new l.AdapterWeb}},e.prototype.queryChallengeSelfRecord=function(r,t,a,o,n){this.mAdapter.queryChallengeSelfRecord(r,t,a,o,n)},e.prototype.queryChallengeOtherRecord=function(r,t,a,o,n,i){this.mAdapter.queryChallengeOtherRecord(r,t,a,o,n,i)},e.prototype.queryCooperationScore=function(r,t){this.mAdapter.queryCooperationScore(r,t)},e.prototype.queryInvitationCode=function(r,t){this.mAdapter.queryInvitationCode(r,t)},e.prototype.getServerUserInfo=function(r){this.mAdapter.getServerUserInfo(r)},e.prototype.uploadFile=function(r,t){this.mAdapter?this.mAdapter.uploadFile(r,t):t&&t(-1,"")},e.prototype.queryUserInfoLevel=function(r,t){this.mAdapter.queryUserInfoLevel(r,t)},e.prototype.uploadPlayerFriends=function(r,t){this.mAdapter.uploadPlayerFriends(r,t)},e.PLATFORM_UNKNOWN=-1,e.PLATFORM_WEB=0,e.PLATFORM_WECHAT=1,e.PLATFORM_FACEBOOK=2,e.PLATFORM_H5SDK=3,e.PLATFORM_QQPLAY=4,e.PLATFORM_QQHALL=5,e.PLATFORM_QQPLAY_H5=6,e.PLATFORM_CMPLAY=7,e.isPrintLog=!1,e}();l.Platform=p,l.platform=new p}(S||(S={})),window.cmg=S,window.platform=S.platform,function(l){var p=0,e="";function r(c){return o(t(u(c)))}function t(c){return d(f(s(c),8*c.length))}function a(c,_){var E=s(c);16<E.length&&(E=f(E,8*c.length));for(var h=Array(16),y=Array(16),m=0;m<16;m++)h[m]=909522486^E[m],y[m]=1549556828^E[m];var g=f(h.concat(s(_)),512+8*_.length);return d(f(y.concat(g),672))}function o(c){for(var _,E=p?"0123456789ABCDEF":"0123456789abcdef",h="",y=0;y<c.length;y++)_=c.charCodeAt(y),h+=E.charAt(_>>>4&15)+E.charAt(15&_);return h}function n(c){for(var _="",E=c.length,h=0;h<E;h+=3)for(var y=c.charCodeAt(h)<<16|(h+1<E?c.charCodeAt(h+1)<<8:0)|(h+2<E?c.charCodeAt(h+2):0),m=0;m<4;m++)8*h+6*m>8*c.length?_+=e:_+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(y>>>6*(3-m)&63);return _}function i(c,_){var E,h,y,m,g=_.length,T=Array(),D=Array(Math.ceil(c.length/2));for(E=0;E<D.length;E++)D[E]=c.charCodeAt(2*E)<<8|c.charCodeAt(2*E+1);for(;0<D.length;){for(m=Array(),E=y=0;E<D.length;E++)y=(y<<16)+D[E],y-=(h=Math.floor(y/g))*g,(0<m.length||0<h)&&(m[m.length]=h);T[T.length]=y,D=m}var P="";for(E=T.length-1;0<=E;E--)P+=_.charAt(T[E]);var k=Math.ceil(8*c.length/(Math.log(_.length)/Math.log(2)));for(E=P.length;E<k;E++)P=_[0]+P;return P}function u(c){for(var _,E,h="",y=-1;++y<c.length;)_=c.charCodeAt(y),E=y+1<c.length?c.charCodeAt(y+1):0,55296<=_&&_<=56319&&56320<=E&&E<=57343&&(_=65536+((1023&_)<<10)+(1023&E),y++),_<=127?h+=String.fromCharCode(_):_<=2047?h+=String.fromCharCode(192|_>>>6&31,128|63&_):_<=65535?h+=String.fromCharCode(224|_>>>12&15,128|_>>>6&63,128|63&_):_<=2097151&&(h+=String.fromCharCode(240|_>>>18&7,128|_>>>12&63,128|_>>>6&63,128|63&_));return h}function s(c){for(var _=Array(c.length>>2),E=0;E<_.length;E++)_[E]=0;for(E=0;E<8*c.length;E+=8)_[E>>5]|=(255&c.charCodeAt(E/8))<<24-E%32;return _}function d(c){for(var _="",E=0;E<32*c.length;E+=8)_+=String.fromCharCode(c[E>>5]>>>24-E%32&255);return _}function f(c,_){c[_>>5]|=128<<24-_%32,c[15+(_+64>>9<<4)]=_;for(var E,h=Array(80),y=1732584193,m=-271733879,g=-1732584194,T=271733878,D=-1009589776,P=0;P<c.length;P+=16){for(var k=y,q=m,Q=g,N=T,w=D,I=0;I<80;I++){h[I]=I<16?c[P+I]:C(h[I-3]^h[I-8]^h[I-14]^h[I-16],1);var L=A(A(C(y,5),R(I,m,g,T)),A(A(D,h[I]),(E=I)<20?1518500249:E<40?1859775393:E<60?-1894007588:-899497514));D=T,T=g,g=C(m,30),m=y,y=L}y=A(y,k),m=A(m,q),g=A(g,Q),T=A(T,N),D=A(D,w)}return Array(y,m,g,T,D)}function R(c,_,E,h){return c<20?_&E|~_&h:c<40?_^E^h:c<60?_&E|_&h|E&h:_^E^h}function A(c,_){var E=(65535&c)+(65535&_);return(c>>16)+(_>>16)+(E>>16)<<16|65535&E}function C(c,_){return c<<_|c>>>32-_}l.hex_sha1=r,l.b64_sha1=function(c){return n(t(u(c)))},l.any_sha1=function(c,_){return i(t(u(c)),_)},l.hex_hmac_sha1=function(c,_){return o(a(u(c),u(_)))},l.b64_hmac_sha1=function(c,_){return n(a(u(c),u(_)))},l.any_hmac_sha1=function(c,_,E){return i(a(u(c),u(_)),E)}}(S||(S={})),function(l){var p=function(){};l.PlayerInfo=p;var e=function(){};l.UserInfo=e;var r=function(){};l.KVData=r;var t=function(){};l.LaunchOption=t;var a=function(){};l.MusicScore=a}(S||(S={})),function(l){var p=function(){function e(){}return e.compareVersion=function(r,t){for(var a=r.split("."),o=t.split("."),n=Math.max(a.length,o.length),i=0;i<n;i++){var u=i<a.length?parseInt(a[i]):0,s=i<o.length?parseInt(o[i]):0;if(u!==s)return s<u?1:-1}return 0},e}();l.Utility=p}(S||(S={})),function(l){var p=function(){function e(){}return e.postMessageToOpenData=function(r,t){this.sWXOpenDataContext==null&&(this.sWXOpenDataContext=wx.getOpenDataContext()),this.sWXOpenDataContext.postMessage({message:r,parameter:t})},e.networkRequest=function(r){l.Platform.log("WXHelper networkRequest, parameter:",r),wx.request({url:r.url,data:r.data,header:r.header,method:r.method,dataType:r.dataType,success:function(t){l.Platform.log("WXHelper networkRequest, complete:",t),r.callback&&(t.statusCode!=200?r.callback(!1,t,t.statusCode,t.header):t.data?r.callback(!0,t.data,t.statusCode,t.header):(l.Platform.error(t),r.callback(!1,t,t.statusCode,t.header)))},fail:function(){l.Platform.error("WXHelper networkRequest, fail"),r.callback&&r.callback(!1,null,-1,null)}})},e.MSG_REPORT_SCORE="msg_report_score",e.KEY_USER_INFO_AUTHORIZATION_STATE="key_user_info_authorization_state",e}();l.WXHelper=p}(S||(S={}))});U()})()})()})()})();})();
